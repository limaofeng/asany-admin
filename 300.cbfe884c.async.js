(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[300],{60300:function(V,O,u){"use strict";u.r(O);var I=u(86582),F=u(2824),R=u(93224),j=u(3182),U=u(94043),E=u.n(U),c=u(67294),A=u(73727),W=u(80129),N=u.n(W),w=u(28865),M=u(81303),K=u(50480),Z=u(75468),s=u(11974),$=u(88097),e=u(85893);function S(m){var f=m.data,y=m.history,p=m.onDelete,D=(0,c.useCallback)(function(){var v=(0,j.Z)(E().mark(function P(b){var C,x;return E().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return C="\u786E\u5B9A\u5220\u9664\u6D77\u62A5 \u201C".concat(b.name,"\u201D \u5417\uFF1F"),i.next=3,s.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:C}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(x=i.sent,x.isConfirmed){i.next=6;break}return i.abrupt("return");case 6:return i.next=8,p(b.id);case 8:s.FN.success("\u6D77\u62A5 \u201C".concat(b.name,"\u201D \u5220\u9664\u6210\u529F"),2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return i.stop()}},P)}));return function(P){return v.apply(this,arguments)}}(),[p]),_=(0,c.useCallback)(function(v){v.key=="view"?y.push("/website/landing/posters/".concat(f.id)):v.key=="delete"&&D(f)},[f,D,y]);return(0,e.jsx)(s.Lt,{overlay:(0,e.jsxs)(s.v2,{onClick:_,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold fs-8 w-125px py-4",children:[(0,e.jsx)(s.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"view"),(0,e.jsx)(s.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",children:(0,e.jsxs)(s.zx,{className:"fs-8",variant:"light",activeColor:"light-primary",children:["\u64CD\u4F5C",(0,e.jsx)(w.JO,{className:"svg-icon-5 ms-2 me-n1",name:"Duotune/arr072"})]})})}function z(m){var f,y,p=m.history,D=m.location,_=(0,c.useMemo)(function(){var a=m.location.query,n=a.q,r=(0,R.Z)(a,["q"]);return n&&(r.filter={name_contains:n}),r},[m.location]),v=(0,c.useMemo)(function(){if(!_.orderBy)return{order:"descend",field:"createdAt"};var a=_.orderBy.split("_"),n=(0,F.Z)(a,2),r=n[0],d=n[1];return{order:d=="desc"?"descend":"ascend",field:r}},[_.orderBy]),P=(0,M.a7)({refetchQueries:[M.my]}),b=(0,F.Z)(P,1),C=b[0],x=(0,M.Nd)({fetchPolicy:"cache-and-network",variables:_}),t=x.data,i=x.loading,l=x.previousData,k=(0,c.useMemo)(function(){return i?(l==null?void 0:l.total.totalCount)||0:(t==null?void 0:t.total.totalCount)||0},[t==null?void 0:t.total.totalCount,i,l==null?void 0:l.total]),H=(0,c.useMemo)(function(){return i?(l==null?void 0:l.landingPosters)||{total:0,current:1}:(t==null?void 0:t.landingPosters)||{total:0,current:1}},[t==null?void 0:t.landingPosters,i,l==null?void 0:l.landingPosters]),J=(0,c.useMemo)(function(){var a;if(i){var n;return((l==null||(n=l.landingPosters)===null||n===void 0?void 0:n.edges)||[]).map(function(r){return r.node})}return((t==null||(a=t.landingPosters)===null||a===void 0?void 0:a.edges)||[]).map(function(r){return r.node})},[t==null?void 0:t.landingPosters,i,l==null?void 0:l.landingPosters]),Q=(0,c.useCallback)(function(a){p.replace(D.pathname+"?"+N().stringify({q:a}))},[p,D.pathname]),Y=(0,c.useCallback)(function(a,n,r){var d,h={};if((d=_.filter)!==null&&d!==void 0&&d.name_contains){var o;h.q=(o=_.filter)===null||o===void 0?void 0:o.name_contains}r&&(h.orderBy=r.field+"_"+(r.order=="ascend"?"asc":"desc")),h.page=a.current,p.replace(D.pathname+"?"+N().stringify(h))},[p,D.pathname,(f=_.filter)===null||f===void 0?void 0:f.name_contains]),B=(0,c.useCallback)((0,j.Z)(E().mark(function a(){var n,r,d,h,o,T=arguments;return E().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:for(n=T.length,r=new Array(n),d=0;d<n;d++)r[d]=T[d];return g.next=3,C({variables:{ids:r}});case 3:return h=g.sent,o=h.data,g.abrupt("return",(o==null?void 0:o.deleteLandingPoster)||0);case 6:case"end":return g.stop()}},a)})),[C]),L=(0,c.useCallback)(function(a){return(0,j.Z)(E().mark(function n(){var r,d;return E().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return r="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(a.length," \u4E2A\u6D77\u62A5\u5417\uFF1F"),o.next=3,s.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:r}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(d=o.sent,d.isConfirmed){o.next=6;break}return o.abrupt("return");case 6:return o.next=8,B.apply(void 0,(0,I.Z)(a));case 8:s.FN.success("\u6D77\u62A5\u6279\u91CF\u5220\u9664\u6210\u529F",2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return o.stop()}},n)}))},[B]),G=(0,c.useMemo)(function(){return function(a){return(0,e.jsx)("div",{children:(0,e.jsx)(s.zx,{color:"success",onClick:L(a),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},[L]);return(0,e.jsxs)(Z.v,{footer:!1,children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap flex-stack pb-7",children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,e.jsxs)("h3",{className:"fw-bolder me-5",children:["\u6D77\u62A5 (",k,")"]}),(0,e.jsx)(s.II.Search,{placeholder:"\u641C\u7D22",onSearch:Q,defaultValue:(y=_.filter)===null||y===void 0?void 0:y.name_contains,className:"border-body bg-body w-250px"})]}),(0,e.jsx)(K.Z,{children:(0,e.jsx)("div",{className:"d-flex my-0",children:(0,e.jsx)(s.zx,{as:A.Link,to:"/website/landing/posters/new",children:"\u65B0\u5EFA\u6D77\u62A5"})})})]}),!k&&!i?(0,e.jsx)(s.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(s.HY,{title:"\u8FD8\u6CA1\u6709\u6D77\u62A5",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u6D77\u62A5\u8BD5\u8BD5",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(s.zx,{as:A.Link,variant:"primary",to:"/website/landing/posters/new",children:"\u65B0\u5EFA\u6D77\u62A5"})})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(s.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(s.Zb.Body,{children:(0,e.jsx)(s.bH,{overlayClassName:"bg-white bg-opacity-25",loading:i,children:(0,e.jsx)(s.iA,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(n){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:n}),"\u4E2A\u6D77\u62A5"]})},toolbar:G},noRowsRenderer:function(){return(0,e.jsx)(s.HY,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"name",title:"\u540D\u79F0",sorter:!0,sortOrder:v.field=="name"?v.order:void 0,render:function(n,r){return(0,e.jsx)("div",{className:"ps-2",children:(0,e.jsx)(A.Link,{className:"text-gray-700",to:"/website/landing/posters/".concat(r.id),children:n})})}},{key:"background",title:"\u80CC\u666F\u56FE",className:"w-100px",render:function(n){return n?(0,e.jsx)("div",{className:"d-flex w-30px justify-content-center",children:(0,e.jsx)("img",{src:"//api.asany.cn"+"/preview/".concat(n.id),className:"h-30px w-20px"})}):(0,e.jsx)(w.JO,{className:"svg-icon-2qx text-muted",name:"Bootstrap/file-image"})}},{key:"music",title:"\u80CC\u666F\u97F3\u4E50",className:"w-250px",render:function(n){return(0,e.jsx)("div",{className:"d-flex list-music-preview",children:n?(0,e.jsx)($.B,{uploadFile:n,status:"completed"}):"\u65E0"})}},{key:"createdAt",title:"\u521B\u5EFA\u65F6\u95F4",className:"w-150px",sorter:!0,sortOrder:v.field=="createdAt"?v.order:void 0},{key:"actions",title:"\u64CD\u4F5C",className:"w-150px",render:function(n,r){return(0,e.jsx)(S,{onDelete:B,history:m.history,data:r})}}],pagination:H,onChange:Y,dataSource:J})})})})})]})}O.default=z}}]);
