(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[2418],{92418:function(se,R,u){"use strict";u.r(R);var Z=u(86582),Q=u(93224),M=u(2824),O=u(3182),$=u(94043),E=u.n($),o=u(67294),T=u(28865),z=u(84059),H=u(80129),I=u.n(H),L=u(73727),F=u(250),J=u(50480),Y=u(75468),s=u(53704),e=u(85893);function G(c){var h=c.data,x=c.history,p=c.onDelete,f=c.onShowQRCode,b=c.baseUrl,P=(0,o.useCallback)(function(){var v=(0,O.Z)(E().mark(function y(j){var A,_;return E().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return A="\u786E\u5B9A\u5220\u9664\u6D3B\u52A8 \u201C".concat(j.name,"\u201D \u5417\uFF1F"),m.next=3,s.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:A}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(_=m.sent,_.isConfirmed){m.next=6;break}return m.abrupt("return");case 6:return m.next=8,p(j.id);case 8:s.FN.success("\u6D3B\u52A8 \u201C".concat(j.name,"\u201D \u5220\u9664\u6210\u529F"),2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return m.stop()}},y)}));return function(y){return v.apply(this,arguments)}}(),[p]),B=(0,o.useCallback)(function(v){v.key=="view"?x.push("".concat(b,"/").concat(h.id)):v.key=="delete"?P(h):v.key=="preview"&&f(location.protocol+"//47.103.119.188:8002/lps/"+h.id)},[b,h,P,x,f]);return(0,e.jsx)(s.Lt,{overlay:(0,e.jsxs)(s.v2,{onClick:B,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold fs-8 w-125px py-4",children:[(0,e.jsx)(s.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"view"),(0,e.jsx)(s.v2.Separator,{}),(0,e.jsx)(s.v2.Item,{className:"px-3",children:"\u9884\u89C8"},"preview"),(0,e.jsx)(s.v2.Separator,{}),(0,e.jsx)(s.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",children:(0,e.jsxs)(s.zx,{className:"fs-8",variant:"light",activeColor:"light-primary",children:["\u64CD\u4F5C",(0,e.jsx)(T.JO,{className:"svg-icon-5 ms-2 me-n1",name:"Duotune/arr072"})]})})}function V(c){var h,x,p=c.history,f=c.location,b=f.pathname,P=(0,o.useState)(),B=(0,M.Z)(P,2),v=B[0],y=B[1],j=(0,o.useCallback)(function(a){y(a)},[]),A=(0,o.useCallback)(function(){y(void 0)},[]),_=(0,o.useMemo)(function(){var a=c.location.query,n=a.q,r=(0,Q.Z)(a,["q"]);return n&&(r.filter={name_contains:n}),r},[c.location]),w=(0,o.useMemo)(function(){if(!_.orderBy)return{order:"descend",field:"createdAt"};var a=_.orderBy.split("_"),n=(0,M.Z)(a,2),r=n[0],d=n[1];return{order:d=="desc"?"descend":"ascend",field:r}},[_.orderBy]),m=(0,F.hD)({refetchQueries:[F.MZ]}),X=(0,M.Z)(m,1),U=X[0],k=(0,F.gr)({fetchPolicy:"cache-and-network",variables:_}),l=k.data,g=k.loading,t=k.previousData,W=(0,o.useMemo)(function(){return g?(t==null?void 0:t.total.totalCount)||0:(l==null?void 0:l.total.totalCount)||0},[l==null?void 0:l.total.totalCount,g,t==null?void 0:t.total]),q=(0,o.useMemo)(function(){return g?(t==null?void 0:t.landingPages)||{total:0,current:1}:(l==null?void 0:l.landingPages)||{total:0,current:1}},[l==null?void 0:l.landingPages,g,t==null?void 0:t.landingPages]),ee=(0,o.useMemo)(function(){var a;if(g){var n;return((t==null||(n=t.landingPages)===null||n===void 0?void 0:n.edges)||[]).map(function(r){return r.node})}return((l==null||(a=l.landingPages)===null||a===void 0?void 0:a.edges)||[]).map(function(r){return r.node})},[l==null?void 0:l.landingPages,g,t==null?void 0:t.landingPages]),ne=(0,o.useCallback)(function(a){p.replace(f.pathname+"?"+I().stringify({q:a}))},[p,f.pathname]),ae=(0,o.useCallback)(function(a,n,r){var d,C={};if((d=_.filter)!==null&&d!==void 0&&d.name_contains){var i;C.q=(i=_.filter)===null||i===void 0?void 0:i.name_contains}r&&(C.orderBy=r.field+"_"+(r.order=="ascend"?"asc":"desc")),C.page=a.current,p.replace(f.pathname+"?"+I().stringify(C))},[p,f.pathname,(h=_.filter)===null||h===void 0?void 0:h.name_contains]),N=(0,o.useCallback)((0,O.Z)(E().mark(function a(){var n,r,d,C,i,S=arguments;return E().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:for(n=S.length,r=new Array(n),d=0;d<n;d++)r[d]=S[d];return D.next=3,U({variables:{ids:r}});case 3:return C=D.sent,i=C.data,D.abrupt("return",(i==null?void 0:i.deleteLandingPage)||0);case 6:case"end":return D.stop()}},a)})),[U]),K=(0,o.useCallback)(function(a){return(0,O.Z)(E().mark(function n(){var r,d;return E().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(a.length," \u4E2A\u6D3B\u52A8\u5417\uFF1F"),i.next=3,s.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:r}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(d=i.sent,d.isConfirmed){i.next=6;break}return i.abrupt("return");case 6:return i.next=8,N.apply(void 0,(0,Z.Z)(a));case 8:s.FN.success("\u6D3B\u52A8\u6279\u91CF\u5220\u9664\u6210\u529F",2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return i.stop()}},n)}))},[N]),re=(0,o.useMemo)(function(){return function(a){return(0,e.jsx)("div",{children:(0,e.jsx)(s.zx,{color:"success",onClick:K(a),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},[K]);return(0,e.jsxs)(Y.v,{footer:!1,children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap flex-stack pb-7",children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,e.jsxs)("h3",{className:"fw-bolder me-5",children:["\u6D3B\u52A8 (",W,")"]}),(0,e.jsx)(s.II.Search,{onSearch:ne,defaultValue:(x=_.filter)===null||x===void 0?void 0:x.name_contains,placeholder:"\u641C\u7D22",className:"border-body bg-body w-250px"})]}),(0,e.jsx)(J.Z,{children:(0,e.jsx)("div",{className:"d-flex my-0"})})]}),!W&&!g?(0,e.jsx)(s.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(s.HY,{title:"\u8FD8\u6CA1\u6709\u6D3B\u52A8",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u6D3B\u52A8\u8BD5\u8BD5",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(s.zx,{as:L.Link,variant:"primary",to:"${baseUrl}/new",children:"\u65B0\u5EFA\u6D3B\u52A8"})})}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(s.Zb.Body,{children:(0,e.jsx)(s.bH,{overlayClassName:"bg-white bg-opacity-25",loading:g,children:(0,e.jsx)(s.iA,{hover:!0,rowKey:"id",noRowsRenderer:function(){return(0,e.jsx)(s.HY,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},rowSelection:{type:"checkbox",renderTitle:function(n){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:n}),"\u4E2A\u6D3B\u52A8"]})},toolbar:re},columns:[{key:"name",title:"\u540D\u79F0",sorter:!0,sortOrder:w.field=="name"?w.order:void 0,render:function(n,r){return(0,e.jsx)("div",{className:"ps-2",children:(0,e.jsx)(L.Link,{className:"text-gray-700",to:"".concat(b,"/").concat(r.id),children:n})})}},{key:"stores",title:"\u95E8\u5E97",render:function(n){return(0,e.jsxs)("div",{className:"d-flex tw-truncate overflow-hidden pe-2",children:[(0,e.jsx)("span",{className:"tw-text-ellipsis tw-truncate overflow-hidden",children:n.map(function(r){return r.name}).join(",")}),(0,e.jsxs)("span",{children:["\u5171 ",n.length," \u5BB6\u95E8\u5E97"]})]})}},{key:"poster",title:"\u6D77\u62A5",width:80,render:function(n){return n!=null&&n.background?(0,e.jsx)("div",{className:"d-flex w-30px justify-content-center",children:(0,e.jsx)("img",{src:"//47.103.119.188:8000"+"/preview/".concat(n.background.id),className:"h-30px w-20px"})}):(0,e.jsx)(T.JO,{className:"svg-icon-2qx text-muted",name:"Bootstrap/file-image"})}},{key:"actions",title:"\u64CD\u4F5C",width:100,render:function(n,r){return(0,e.jsx)(G,{baseUrl:b,onDelete:N,onShowQRCode:j,history:c.history,data:r})}}],pagination:q,onChange:ae,dataSource:ee})})})}),(0,e.jsxs)(s.u_,{title:"\u9884\u89C8\u4E8C\u7EF4\u7801",dialogClassName:"w-250px",onCancel:A,visible:!!v,okButtonProps:{style:{display:"none"}},children:[(0,e.jsx)("div",{className:"d-inline-block",children:!!v&&(0,e.jsx)(z.Qd,{size:200,value:v})}),(0,e.jsx)("span",{children:"\u4F7F\u7528\u624B\u673A\u626B\u7801\u4E8C\u7EF4\u7801\u9884\u89C8"})]})]})]})}R.default=V}}]);
