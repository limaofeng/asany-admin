!(function(){"use strict";var Ea=Object.defineProperty,Ta=Object.defineProperties;var Fa=Object.getOwnPropertyDescriptors;var Nn=Object.getOwnPropertySymbols,Ra=Object.getPrototypeOf,ka=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable,La=Reflect.get;var ps=Math.pow,Ns=(ve,de,ue)=>de in ve?Ea(ve,de,{enumerable:!0,configurable:!0,writable:!0,value:ue}):ve[de]=ue,vi=(ve,de)=>{for(var ue in de||(de={}))ka.call(de,ue)&&Ns(ve,ue,de[ue]);if(Nn)for(var ue of Nn(de))Pa.call(de,ue)&&Ns(ve,ue,de[ue]);return ve},qi=(ve,de)=>Ta(ve,Fa(de));var Ae=(ve,de,ue)=>(Ns(ve,typeof de!="symbol"?de+"":de,ue),ue),Os=(ve,de,ue)=>{if(!de.has(ve))throw TypeError("Cannot "+ue)};var t=(ve,de,ue)=>(Os(ve,de,"read from private field"),ue?ue.call(ve):de.get(ve)),f=(ve,de,ue)=>{if(de.has(ve))throw TypeError("Cannot add the same private member more than once");de instanceof WeakSet?de.add(ve):de.set(ve,ue)},P=(ve,de,ue,di)=>(Os(ve,de,"write to private field"),di?di.call(ve,ue):de.set(ve,ue),ue),ii=(ve,de,ue,di)=>({set _(ui){P(ve,de,ui,ue)},get _(){return t(ve,de,di)}}),E=(ve,de,ue)=>(Os(ve,de,"access private method"),ue),On=(ve,de,ue)=>La(Ra(ve),ue,de);var be=(ve,de,ue)=>new Promise((di,ui)=>{var ns=Ve=>{try{Ii(ue.next(Ve))}catch(Qt){ui(Qt)}},ni=Ve=>{try{Ii(ue.throw(Ve))}catch(Qt){ui(Qt)}},Ii=Ve=>Ve.done?di(Ve.value):Promise.resolve(Ve.value).then(ns,ni);Ii((ue=ue.apply(ve,de)).next())});(self.webpackChunk=self.webpackChunk||[]).push([[8541],{28541:function(ve,de,ue){ue.a(ve,function(di,ui){return be(this,null,function*(){try{let qe=function(ie){var Nt=Ve[ie];if(Nt!==void 0)return Nt.exports;var rt=Ve[ie]={exports:{}};return Ii[ie](rt,rt.exports,qe),rt.exports};ue.r(de),ue.d(de,{AbortException:function(){return Mr},AnnotationEditorLayer:function(){return Ir},AnnotationEditorParamsType:function(){return Dr},AnnotationEditorType:function(){return Nr},AnnotationEditorUIManager:function(){return Or},AnnotationLayer:function(){return Hr},AnnotationMode:function(){return Br},CMapCompressionType:function(){return zr},ColorPicker:function(){return Ur},DOMSVGFactory:function(){return Gr},DrawLayer:function(){return Xr},FeatureTest:function(){return Vr},GlobalWorkerOptions:function(){return $r},ImageKind:function(){return Yr},InvalidPDFException:function(){return jr},MissingPDFException:function(){return Wr},OPS:function(){return qr},Outliner:function(){return Kr},PDFDataRangeTransport:function(){return Qr},PDFDateString:function(){return Jr},PDFWorker:function(){return Zr},PasswordResponses:function(){return _r},PermissionFlag:function(){return ta},PixelsPerInch:function(){return ea},PromiseCapability:function(){return ia},RenderingCancelledException:function(){return sa},UnexpectedResponseException:function(){return na},Util:function(){return ra},VerbosityLevel:function(){return aa},XfaLayer:function(){return oa},build:function(){return la},createValidAbsoluteUrl:function(){return ha},fetchData:function(){return ca},getDocument:function(){return da},getFilenameFromUrl:function(){return ua},getPdfFilenameFromUrl:function(){return fa},getXfaPageViewport:function(){return pa},isDataScheme:function(){return ga},isPdfFile:function(){return ma},noContextMenu:function(){return ba},normalizeUnicode:function(){return Aa},renderTextLayer:function(){return va},setLayerDimensions:function(){return ya},shadow:function(){return Sa},updateTextLayer:function(){return wa},version:function(){return xa}});var ns=ue(48764).Buffer,ni=ue(34155),Ii={640:(ie,Nt,rt)=>{var le,qt,yi,ge,Hn,ae,Bn,xe,Ce,ke,M,n,i,d,p,o,h,g,w,D,L,J,tt,ht,at,zn,kt,gs,St,Hs,s,Bs,m,U,et,ft,Tt,Ft,jt,zs,Dt,Ht,y,Y,Un,ut,Us;rt.d(Nt,{AnnotationLayer:()=>se,FreeTextAnnotationElement:()=>mt,InkAnnotationElement:()=>Yt,StampAnnotationElement:()=>te});var u=rt(266),it=rt(473),k=rt(780);function q(At){return Math.floor(Math.max(0,Math.min(1,At))*255).toString(16).padStart(2,"0")}function lt(At){return Math.max(0,Math.min(255,255*At))}class Q{static CMYK_G([c,e,l,v]){return["G",1-Math.min(1,.3*c+.59*l+.11*e+v)]}static G_CMYK([c]){return["CMYK",0,0,0,1-c]}static G_RGB([c]){return["RGB",c,c,c]}static G_rgb([c]){return c=lt(c),[c,c,c]}static G_HTML([c]){const e=q(c);return`#${e}${e}${e}`}static RGB_G([c,e,l]){return["G",.3*c+.59*e+.11*l]}static RGB_rgb(c){return c.map(lt)}static RGB_HTML(c){return`#${c.map(q).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([c,e,l,v]){return["RGB",1-Math.min(1,c+v),1-Math.min(1,l+v),1-Math.min(1,e+v)]}static CMYK_rgb([c,e,l,v]){return[lt(1-Math.min(1,c+v)),lt(1-Math.min(1,l+v)),lt(1-Math.min(1,e+v))]}static CMYK_HTML(c){const e=this.CMYK_RGB(c).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([c,e,l]){const v=1-c,R=1-e,B=1-l,K=Math.min(v,R,B);return["CMYK",v,R,B,K]}}var H=rt(160);const A=1e3,z=9,N=new WeakSet;function T(At){return{width:At[2]-At[0],height:At[3]-At[1]}}class W{static create(c){switch(c.data.annotationType){case u.AnnotationType.LINK:return new O(c);case u.AnnotationType.TEXT:return new I(c);case u.AnnotationType.WIDGET:switch(c.data.fieldType){case"Tx":return new V(c);case"Btn":return c.data.radioButton?new C(c):c.data.checkBox?new X(c):new $(c);case"Ch":return new st(c);case"Sig":return new F(c)}return new G(c);case u.AnnotationType.POPUP:return new xt(c);case u.AnnotationType.FREETEXT:return new mt(c);case u.AnnotationType.LINE:return new wt(c);case u.AnnotationType.SQUARE:return new Ut(c);case u.AnnotationType.CIRCLE:return new Bt(c);case u.AnnotationType.POLYLINE:return new _t(c);case u.AnnotationType.CARET:return new Fe(c);case u.AnnotationType.INK:return new Yt(c);case u.AnnotationType.POLYGON:return new Kt(c);case u.AnnotationType.HIGHLIGHT:return new Jt(c);case u.AnnotationType.UNDERLINE:return new fe(c);case u.AnnotationType.SQUIGGLY:return new ne(c);case u.AnnotationType.STRIKEOUT:return new Xt(c);case u.AnnotationType.STAMP:return new te(c);case u.AnnotationType.FILEATTACHMENT:return new Gt(c);default:return new x(c)}}}const ee=class{constructor(c,{isRenderable:e=!1,ignoreBorder:l=!1,createQuadrilaterals:v=!1}={}){f(this,le,!1);this.isRenderable=e,this.data=c.data,this.layer=c.layer,this.linkService=c.linkService,this.downloadManager=c.downloadManager,this.imageResourcesPath=c.imageResourcesPath,this.renderForms=c.renderForms,this.svgFactory=c.svgFactory,this.annotationStorage=c.annotationStorage,this.enableScripting=c.enableScripting,this.hasJSActions=c.hasJSActions,this._fieldObjects=c.fieldObjects,this.parent=c.parent,e&&(this.container=this._createContainer(l)),v&&this._createQuadrilaterals()}static _hasPopupData({titleObj:c,contentsObj:e,richText:l}){return!!(c!=null&&c.str||e!=null&&e.str||l!=null&&l.str)}get hasPopupData(){return ee._hasPopupData(this.data)}_createContainer(c){const{data:e,parent:{page:l,viewport:v}}=this,R=document.createElement("section");R.setAttribute("data-annotation-id",e.id),this instanceof G||(R.tabIndex=A),R.style.zIndex=this.parent.zIndex++,this.data.popupRef&&R.setAttribute("aria-haspopup","dialog"),e.noRotate&&R.classList.add("norotate");const{pageWidth:B,pageHeight:K,pageX:pt,pageY:bt}=v.rawDims;if(!e.rect||this instanceof xt){const{rotation:$t}=e;return!e.hasOwnCanvas&&$t!==0&&this.setRotation($t,R),R}const{width:vt,height:Ot}=T(e.rect),Rt=u.Util.normalizeRect([e.rect[0],l.view[3]-e.rect[1]+l.view[1],e.rect[2],l.view[3]-e.rect[3]+l.view[1]]);if(!c&&e.borderStyle.width>0){R.style.borderWidth=`${e.borderStyle.width}px`;const $t=e.borderStyle.horizontalCornerRadius,zt=e.borderStyle.verticalCornerRadius;if($t>0||zt>0){const ce=`calc(${$t}px * var(--scale-factor)) / calc(${zt}px * var(--scale-factor))`;R.style.borderRadius=ce}else if(this instanceof C){const ce=`calc(${vt}px * var(--scale-factor)) / calc(${Ot}px * var(--scale-factor))`;R.style.borderRadius=ce}switch(e.borderStyle.style){case u.AnnotationBorderStyleType.SOLID:R.style.borderStyle="solid";break;case u.AnnotationBorderStyleType.DASHED:R.style.borderStyle="dashed";break;case u.AnnotationBorderStyleType.BEVELED:(0,u.warn)("Unimplemented border style: beveled");break;case u.AnnotationBorderStyleType.INSET:(0,u.warn)("Unimplemented border style: inset");break;case u.AnnotationBorderStyleType.UNDERLINE:R.style.borderBottomStyle="solid";break;default:break}const Zt=e.borderColor||null;Zt?(P(this,le,!0),R.style.borderColor=u.Util.makeHexColor(Zt[0]|0,Zt[1]|0,Zt[2]|0)):R.style.borderWidth=0}R.style.left=`${100*(Rt[0]-pt)/B}%`,R.style.top=`${100*(Rt[1]-bt)/K}%`;const{rotation:Ct}=e;return e.hasOwnCanvas||Ct===0?(R.style.width=`${100*vt/B}%`,R.style.height=`${100*Ot/K}%`):this.setRotation(Ct,R),R}setRotation(c,e=this.container){if(!this.data.rect)return;const{pageWidth:l,pageHeight:v}=this.parent.viewport.rawDims,{width:R,height:B}=T(this.data.rect);let K,pt;c%180===0?(K=100*R/l,pt=100*B/v):(K=100*B/l,pt=100*R/v),e.style.width=`${K}%`,e.style.height=`${pt}%`,e.setAttribute("data-main-rotation",(360-c)%360)}get _commonActions(){const c=(e,l,v)=>{const R=v.detail[e],B=R[0],K=R.slice(1);v.target.style[l]=Q[`${B}_HTML`](K),this.annotationStorage.setValue(this.data.id,{[l]:Q[`${B}_rgb`](K)})};return(0,u.shadow)(this,"_commonActions",{display:e=>{const{display:l}=e.detail,v=l%2===1;this.container.style.visibility=v?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:v,noPrint:l===1||l===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:l}=e.detail;this.container.style.visibility=l?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:l,noView:l})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{c("bgColor","backgroundColor",e)},fillColor:e=>{c("fillColor","backgroundColor",e)},fgColor:e=>{c("fgColor","color",e)},textColor:e=>{c("textColor","color",e)},borderColor:e=>{c("borderColor","borderColor",e)},strokeColor:e=>{c("strokeColor","borderColor",e)},rotation:e=>{const l=e.detail.rotation;this.setRotation(l),this.annotationStorage.setValue(this.data.id,{rotation:l})}})}_dispatchEventFromSandbox(c,e){const l=this._commonActions;for(const v of Object.keys(e.detail)){const R=c[v]||l[v];R==null||R(e)}}_setDefaultPropertiesFromJS(c){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const l=this._commonActions;for(const[v,R]of Object.entries(e)){const B=l[v];if(B){const K={detail:{[v]:R},target:c};B(K),delete e[v]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:c}=this.data;if(!c)return;const[e,l,v,R]=this.data.rect;if(c.length===1){const[,{x:zt,y:Zt},{x:ce,y:Pe}]=c[0];if(v===zt&&R===Zt&&e===ce&&l===Pe)return}const{style:B}=this.container;let K;if(t(this,le)){const{borderColor:zt,borderWidth:Zt}=B;B.borderWidth=0,K=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${zt}" stroke-width="${Zt}">`],this.container.classList.add("hasBorder")}const pt=v-e,bt=R-l,{svgFactory:vt}=this,Ot=vt.createElement("svg");Ot.classList.add("quadrilateralsContainer"),Ot.setAttribute("width",0),Ot.setAttribute("height",0);const Rt=vt.createElement("defs");Ot.append(Rt);const Ct=vt.createElement("clipPath"),$t=`clippath_${this.data.id}`;Ct.setAttribute("id",$t),Ct.setAttribute("clipPathUnits","objectBoundingBox"),Rt.append(Ct);for(const[,{x:zt,y:Zt},{x:ce,y:Pe}]of c){const me=vt.createElement("rect"),He=(ce-e)/pt,Re=(R-Zt)/bt,Ie=(zt-ce)/pt,Oe=(Zt-Pe)/bt;me.setAttribute("x",He),me.setAttribute("y",Re),me.setAttribute("width",Ie),me.setAttribute("height",Oe),Ct.append(me),K==null||K.push(`<rect vector-effect="non-scaling-stroke" x="${He}" y="${Re}" width="${Ie}" height="${Oe}"/>`)}t(this,le)&&(K.push("</g></svg>')"),B.backgroundImage=K.join("")),this.container.append(Ot),this.container.style.clipPath=`url(#${$t})`}_createPopup(){const{container:c,data:e}=this;c.setAttribute("aria-haspopup","dialog");const l=new xt({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(l.render())}render(){(0,u.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(c,e=null){const l=[];if(this._fieldObjects){const v=this._fieldObjects[c];if(v)for(const{page:R,id:B,exportValues:K}of v){if(R===-1||B===e)continue;const pt=typeof K=="string"?K:null,bt=document.querySelector(`[data-element-id="${B}"]`);if(bt&&!N.has(bt)){(0,u.warn)(`_getElementsByName - element not allowed: ${B}`);continue}l.push({id:B,exportValue:pt,domElement:bt})}return l}for(const v of document.getElementsByName(c)){const{exportValue:R}=v,B=v.getAttribute("data-element-id");B!==e&&N.has(v)&&l.push({id:B,exportValue:R,domElement:v})}return l}show(){var c;this.container&&(this.container.hidden=!1),(c=this.popup)==null||c.maybeShow()}hide(){var c;this.container&&(this.container.hidden=!0),(c=this.popup)==null||c.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const c=this.getElementsToTriggerPopup();if(Array.isArray(c))for(const e of c)e.classList.add("highlightArea");else c.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:c,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("switchannotationeditormode",{source:this,mode:c,editId:e})})}};let x=ee;le=new WeakMap;class O extends x{constructor(e,l=null){super(e,{isRenderable:!0,ignoreBorder:!!(l!=null&&l.ignoreBorder),createQuadrilaterals:!0});f(this,qt);f(this,ge);f(this,ae);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:l}=this,v=document.createElement("a");v.setAttribute("data-element-id",e.id);let R=!1;return e.url?(l.addLinkAttributes(v,e.url,e.newWindow),R=!0):e.action?(this._bindNamedAction(v,e.action),R=!0):e.attachment?(E(this,ge,Hn).call(this,v,e.attachment,e.attachmentDest),R=!0):e.setOCGState?(E(this,ae,Bn).call(this,v,e.setOCGState),R=!0):e.dest?(this._bindLink(v,e.dest),R=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(v,e),R=!0),e.resetForm?(this._bindResetFormAction(v,e.resetForm),R=!0):this.isTooltipOnly&&!R&&(this._bindLink(v,""),R=!0)),this.container.classList.add("linkAnnotation"),R&&this.container.append(v),this.container}_bindLink(e,l){e.href=this.linkService.getDestinationHash(l),e.onclick=()=>(l&&this.linkService.goToDestination(l),!1),(l||l==="")&&E(this,qt,yi).call(this)}_bindNamedAction(e,l){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(l),!1),E(this,qt,yi).call(this)}_bindJSAction(e,l){e.href=this.linkService.getAnchorUrl("");const v=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const R of Object.keys(l.actions)){const B=v.get(R);B&&(e[B]=()=>{var K;return(K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l.id,name:R}}),!1})}e.onclick||(e.onclick=()=>!1),E(this,qt,yi).call(this)}_bindResetFormAction(e,l){const v=e.onclick;if(v||(e.href=this.linkService.getAnchorUrl("")),E(this,qt,yi).call(this),!this._fieldObjects){(0,u.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),v||(e.onclick=()=>!1);return}e.onclick=()=>{var Ot;v==null||v();const{fields:R,refs:B,include:K}=l,pt=[];if(R.length!==0||B.length!==0){const Rt=new Set(B);for(const Ct of R){const $t=this._fieldObjects[Ct]||[];for(const{id:zt}of $t)Rt.add(zt)}for(const Ct of Object.values(this._fieldObjects))for(const $t of Ct)Rt.has($t.id)===K&&pt.push($t)}else for(const Rt of Object.values(this._fieldObjects))pt.push(...Rt);const bt=this.annotationStorage,vt=[];for(const Rt of pt){const{id:Ct}=Rt;switch(vt.push(Ct),Rt.type){case"text":{const zt=Rt.defaultValue||"";bt.setValue(Ct,{value:zt});break}case"checkbox":case"radiobutton":{const zt=Rt.defaultValue===Rt.exportValues;bt.setValue(Ct,{value:zt});break}case"combobox":case"listbox":{const zt=Rt.defaultValue||"";bt.setValue(Ct,{value:zt});break}default:continue}const $t=document.querySelector(`[data-element-id="${Ct}"]`);if($t){if(!N.has($t)){(0,u.warn)(`_bindResetFormAction - element not allowed: ${Ct}`);continue}}else continue;$t.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ot=this.linkService.eventBus)==null||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:vt,name:"ResetForm"}})),!1}}}qt=new WeakSet,yi=function(){this.container.setAttribute("data-internal-link","")},ge=new WeakSet,Hn=function(e,l,v=null){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>{var R;return(R=this.downloadManager)==null||R.openOrDownloadData(l.content,l.filename,v),!1},E(this,qt,yi).call(this)},ae=new WeakSet,Bn=function(e,l){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(l),!1),E(this,qt,yi).call(this)};class I extends x{constructor(c){super(c,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const c=document.createElement("img");return c.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",c.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),c.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(c),this.container}}class G extends x{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(c){var e;this.data.hasOwnCanvas&&(((e=c.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(c.previousSibling.hidden=!0),c.hidden=!1)}_getKeyModifier(c){return u.FeatureTest.platform.isMac?c.metaKey:c.ctrlKey}_setEventListener(c,e,l,v,R){l.includes("mouse")?c.addEventListener(l,B=>{var K;(K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:v,value:R(B),shift:B.shiftKey,modifier:this._getKeyModifier(B)}})}):c.addEventListener(l,B=>{var K;if(l==="blur"){if(!e.focused||!B.relatedTarget)return;e.focused=!1}else if(l==="focus"){if(e.focused)return;e.focused=!0}R&&((K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:v,value:R(B)}}))})}_setEventListeners(c,e,l,v){var R,B,K;for(const[pt,bt]of l)(bt==="Action"||(R=this.data.actions)!=null&&R[bt])&&((bt==="Focus"||bt==="Blur")&&(e||(e={focused:!1})),this._setEventListener(c,e,pt,bt,v),bt==="Focus"&&!((B=this.data.actions)!=null&&B.Blur)?this._setEventListener(c,e,"blur","Blur",null):bt==="Blur"&&!((K=this.data.actions)!=null&&K.Focus)&&this._setEventListener(c,e,"focus","Focus",null))}_setBackgroundColor(c){const e=this.data.backgroundColor||null;c.style.backgroundColor=e===null?"transparent":u.Util.makeHexColor(e[0],e[1],e[2])}_setTextStyle(c){const e=["left","center","right"],{fontColor:l}=this.data.defaultAppearanceData,v=this.data.defaultAppearanceData.fontSize||z,R=c.style;let B;const K=2,pt=bt=>Math.round(10*bt)/10;if(this.data.multiLine){const bt=Math.abs(this.data.rect[3]-this.data.rect[1]-K),vt=Math.round(bt/(u.LINE_FACTOR*v))||1,Ot=bt/vt;B=Math.min(v,pt(Ot/u.LINE_FACTOR))}else{const bt=Math.abs(this.data.rect[3]-this.data.rect[1]-K);B=Math.min(v,pt(bt/u.LINE_FACTOR))}R.fontSize=`calc(${B}px * var(--scale-factor))`,R.color=u.Util.makeHexColor(l[0],l[1],l[2]),this.data.textAlignment!==null&&(R.textAlign=e[this.data.textAlignment])}_setRequired(c,e){e?c.setAttribute("required",!0):c.removeAttribute("required"),c.setAttribute("aria-required",e)}}class V extends G{constructor(c){const e=c.renderForms||c.data.hasOwnCanvas||!c.data.hasAppearance&&!!c.data.fieldValue;super(c,{isRenderable:e})}setPropertyOnSiblings(c,e,l,v){const R=this.annotationStorage;for(const B of this._getElementsByName(c.name,c.id))B.domElement&&(B.domElement[e]=l),R.setValue(B.id,{[v]:l})}render(){var v,R;const c=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let l=null;if(this.renderForms){const B=c.getValue(e,{value:this.data.fieldValue});let K=B.value||"";const pt=c.getValue(e,{charLimit:this.data.maxLen}).charLimit;pt&&K.length>pt&&(K=K.slice(0,pt));let bt=B.formattedValue||((v=this.data.textContent)==null?void 0:v.join(`
`))||null;bt&&this.data.comb&&(bt=bt.replaceAll(/\s+/g,""));const vt={userValue:K,formattedValue:bt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(l=document.createElement("textarea"),l.textContent=bt!=null?bt:K,this.data.doNotScroll&&(l.style.overflowY="hidden")):(l=document.createElement("input"),l.type="text",l.setAttribute("value",bt!=null?bt:K),this.data.doNotScroll&&(l.style.overflowX="hidden")),this.data.hasOwnCanvas&&(l.hidden=!0),N.add(l),l.setAttribute("data-element-id",e),l.disabled=this.data.readOnly,l.name=this.data.fieldName,l.tabIndex=A,this._setRequired(l,this.data.required),pt&&(l.maxLength=pt),l.addEventListener("input",Rt=>{c.setValue(e,{value:Rt.target.value}),this.setPropertyOnSiblings(l,"value",Rt.target.value,"value"),vt.formattedValue=null}),l.addEventListener("resetform",Rt=>{var $t;const Ct=($t=this.data.defaultFieldValue)!=null?$t:"";l.value=vt.userValue=Ct,vt.formattedValue=null});let Ot=Rt=>{const{formattedValue:Ct}=vt;Ct!=null&&(Rt.target.value=Ct),Rt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){l.addEventListener("focus",Ct=>{var zt;if(vt.focused)return;const{target:$t}=Ct;vt.userValue&&($t.value=vt.userValue),vt.lastCommittedValue=$t.value,vt.commitKey=1,(zt=this.data.actions)!=null&&zt.Focus||(vt.focused=!0)}),l.addEventListener("updatefromsandbox",Ct=>{this.showElementAndHideCanvas(Ct.target);const $t={value(zt){var Zt;vt.userValue=(Zt=zt.detail.value)!=null?Zt:"",c.setValue(e,{value:vt.userValue.toString()}),zt.target.value=vt.userValue},formattedValue(zt){const{formattedValue:Zt}=zt.detail;vt.formattedValue=Zt,Zt!=null&&zt.target!==document.activeElement&&(zt.target.value=Zt),c.setValue(e,{formattedValue:Zt})},selRange(zt){zt.target.setSelectionRange(...zt.detail.selRange)},charLimit:zt=>{var me;const{charLimit:Zt}=zt.detail,{target:ce}=zt;if(Zt===0){ce.removeAttribute("maxLength");return}ce.setAttribute("maxLength",Zt);let Pe=vt.userValue;!Pe||Pe.length<=Zt||(Pe=Pe.slice(0,Zt),ce.value=vt.userValue=Pe,c.setValue(e,{value:Pe}),(me=this.linkService.eventBus)==null||me.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Pe,willCommit:!0,commitKey:1,selStart:ce.selectionStart,selEnd:ce.selectionEnd}}))}};this._dispatchEventFromSandbox($t,Ct)}),l.addEventListener("keydown",Ct=>{var Zt;vt.commitKey=1;let $t=-1;if(Ct.key==="Escape"?$t=0:Ct.key==="Enter"&&!this.data.multiLine?$t=2:Ct.key==="Tab"&&(vt.commitKey=3),$t===-1)return;const{value:zt}=Ct.target;vt.lastCommittedValue!==zt&&(vt.lastCommittedValue=zt,vt.userValue=zt,(Zt=this.linkService.eventBus)==null||Zt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:zt,willCommit:!0,commitKey:$t,selStart:Ct.target.selectionStart,selEnd:Ct.target.selectionEnd}}))});const Rt=Ot;Ot=null,l.addEventListener("blur",Ct=>{var zt,Zt;if(!vt.focused||!Ct.relatedTarget)return;(zt=this.data.actions)!=null&&zt.Blur||(vt.focused=!1);const{value:$t}=Ct.target;vt.userValue=$t,vt.lastCommittedValue!==$t&&((Zt=this.linkService.eventBus)==null||Zt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:$t,willCommit:!0,commitKey:vt.commitKey,selStart:Ct.target.selectionStart,selEnd:Ct.target.selectionEnd}})),Rt(Ct)}),(R=this.data.actions)!=null&&R.Keystroke&&l.addEventListener("beforeinput",Ct=>{var Re;vt.lastCommittedValue=null;const{data:$t,target:zt}=Ct,{value:Zt,selectionStart:ce,selectionEnd:Pe}=zt;let me=ce,He=Pe;switch(Ct.inputType){case"deleteWordBackward":{const Ie=Zt.substring(0,ce).match(/\w*[^\w]*$/);Ie&&(me-=Ie[0].length);break}case"deleteWordForward":{const Ie=Zt.substring(ce).match(/^[^\w]*\w*/);Ie&&(He+=Ie[0].length);break}case"deleteContentBackward":ce===Pe&&(me-=1);break;case"deleteContentForward":ce===Pe&&(He+=1);break}Ct.preventDefault(),(Re=this.linkService.eventBus)==null||Re.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Zt,change:$t||"",willCommit:!1,selStart:me,selEnd:He}})}),this._setEventListeners(l,vt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ct=>Ct.target.value)}if(Ot&&l.addEventListener("blur",Ot),this.data.comb){const Ct=(this.data.rect[2]-this.data.rect[0])/pt;l.classList.add("comb"),l.style.letterSpacing=`calc(${Ct}px * var(--scale-factor) - 1ch)`}}else l=document.createElement("div"),l.textContent=this.data.fieldValue,l.style.verticalAlign="middle",l.style.display="table-cell",this.data.hasOwnCanvas&&(l.hidden=!0);return this._setTextStyle(l),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class F extends G{constructor(c){super(c,{isRenderable:!!c.data.hasOwnCanvas})}}class X extends G{constructor(c){super(c,{isRenderable:c.renderForms})}render(){const c=this.annotationStorage,e=this.data,l=e.id;let v=c.getValue(l,{value:e.exportValue===e.fieldValue}).value;typeof v=="string"&&(v=v!=="Off",c.setValue(l,{value:v})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const R=document.createElement("input");return N.add(R),R.setAttribute("data-element-id",l),R.disabled=e.readOnly,this._setRequired(R,this.data.required),R.type="checkbox",R.name=e.fieldName,v&&R.setAttribute("checked",!0),R.setAttribute("exportValue",e.exportValue),R.tabIndex=A,R.addEventListener("change",B=>{const{name:K,checked:pt}=B.target;for(const bt of this._getElementsByName(K,l)){const vt=pt&&bt.exportValue===e.exportValue;bt.domElement&&(bt.domElement.checked=vt),c.setValue(bt.id,{value:vt})}c.setValue(l,{value:pt})}),R.addEventListener("resetform",B=>{const K=e.defaultFieldValue||"Off";B.target.checked=K===e.exportValue}),this.enableScripting&&this.hasJSActions&&(R.addEventListener("updatefromsandbox",B=>{const K={value(pt){pt.target.checked=pt.detail.value!=="Off",c.setValue(l,{value:pt.target.checked})}};this._dispatchEventFromSandbox(K,B)}),this._setEventListeners(R,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.checked)),this._setBackgroundColor(R),this._setDefaultPropertiesFromJS(R),this.container.append(R),this.container}}class C extends G{constructor(c){super(c,{isRenderable:c.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const c=this.annotationStorage,e=this.data,l=e.id;let v=c.getValue(l,{value:e.fieldValue===e.buttonValue}).value;if(typeof v=="string"&&(v=v!==e.buttonValue,c.setValue(l,{value:v})),v)for(const B of this._getElementsByName(e.fieldName,l))c.setValue(B.id,{value:!1});const R=document.createElement("input");if(N.add(R),R.setAttribute("data-element-id",l),R.disabled=e.readOnly,this._setRequired(R,this.data.required),R.type="radio",R.name=e.fieldName,v&&R.setAttribute("checked",!0),R.tabIndex=A,R.addEventListener("change",B=>{const{name:K,checked:pt}=B.target;for(const bt of this._getElementsByName(K,l))c.setValue(bt.id,{value:!1});c.setValue(l,{value:pt})}),R.addEventListener("resetform",B=>{const K=e.defaultFieldValue;B.target.checked=K!=null&&K===e.buttonValue}),this.enableScripting&&this.hasJSActions){const B=e.buttonValue;R.addEventListener("updatefromsandbox",K=>{const pt={value:bt=>{const vt=B===bt.detail.value;for(const Ot of this._getElementsByName(bt.target.name)){const Rt=vt&&Ot.id===l;Ot.domElement&&(Ot.domElement.checked=Rt),c.setValue(Ot.id,{value:Rt})}}};this._dispatchEventFromSandbox(pt,K)}),this._setEventListeners(R,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],K=>K.target.checked)}return this._setBackgroundColor(R),this._setDefaultPropertiesFromJS(R),this.container.append(R),this.container}}class $ extends O{constructor(c){super(c,{ignoreBorder:c.data.hasAppearance})}render(){const c=super.render();c.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(c.title=this.data.alternativeText);const e=c.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",l=>{this._dispatchEventFromSandbox({},l)})),c}}class st extends G{constructor(c){super(c,{isRenderable:c.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const c=this.annotationStorage,e=this.data.id,l=c.getValue(e,{value:this.data.fieldValue}),v=document.createElement("select");N.add(v),v.setAttribute("data-element-id",e),v.disabled=this.data.readOnly,this._setRequired(v,this.data.required),v.name=this.data.fieldName,v.tabIndex=A;let R=this.data.combo&&this.data.options.length>0;this.data.combo||(v.size=this.data.options.length,this.data.multiSelect&&(v.multiple=!0)),v.addEventListener("resetform",vt=>{const Ot=this.data.defaultFieldValue;for(const Rt of v.options)Rt.selected=Rt.value===Ot});for(const vt of this.data.options){const Ot=document.createElement("option");Ot.textContent=vt.displayValue,Ot.value=vt.exportValue,l.value.includes(vt.exportValue)&&(Ot.setAttribute("selected",!0),R=!1),v.append(Ot)}let B=null;if(R){const vt=document.createElement("option");vt.value=" ",vt.setAttribute("hidden",!0),vt.setAttribute("selected",!0),v.prepend(vt),B=()=>{vt.remove(),v.removeEventListener("input",B),B=null},v.addEventListener("input",B)}const K=vt=>{const Ot=vt?"value":"textContent",{options:Rt,multiple:Ct}=v;return Ct?Array.prototype.filter.call(Rt,$t=>$t.selected).map($t=>$t[Ot]):Rt.selectedIndex===-1?null:Rt[Rt.selectedIndex][Ot]};let pt=K(!1);const bt=vt=>{const Ot=vt.target.options;return Array.prototype.map.call(Ot,Rt=>({displayValue:Rt.textContent,exportValue:Rt.value}))};return this.enableScripting&&this.hasJSActions?(v.addEventListener("updatefromsandbox",vt=>{const Ot={value(Rt){B==null||B();const Ct=Rt.detail.value,$t=new Set(Array.isArray(Ct)?Ct:[Ct]);for(const zt of v.options)zt.selected=$t.has(zt.value);c.setValue(e,{value:K(!0)}),pt=K(!1)},multipleSelection(Rt){v.multiple=!0},remove(Rt){const Ct=v.options,$t=Rt.detail.remove;Ct[$t].selected=!1,v.remove($t),Ct.length>0&&Array.prototype.findIndex.call(Ct,Zt=>Zt.selected)===-1&&(Ct[0].selected=!0),c.setValue(e,{value:K(!0),items:bt(Rt)}),pt=K(!1)},clear(Rt){for(;v.length!==0;)v.remove(0);c.setValue(e,{value:null,items:[]}),pt=K(!1)},insert(Rt){const{index:Ct,displayValue:$t,exportValue:zt}=Rt.detail.insert,Zt=v.children[Ct],ce=document.createElement("option");ce.textContent=$t,ce.value=zt,Zt?Zt.before(ce):v.append(ce),c.setValue(e,{value:K(!0),items:bt(Rt)}),pt=K(!1)},items(Rt){const{items:Ct}=Rt.detail;for(;v.length!==0;)v.remove(0);for(const $t of Ct){const{displayValue:zt,exportValue:Zt}=$t,ce=document.createElement("option");ce.textContent=zt,ce.value=Zt,v.append(ce)}v.options.length>0&&(v.options[0].selected=!0),c.setValue(e,{value:K(!0),items:bt(Rt)}),pt=K(!1)},indices(Rt){const Ct=new Set(Rt.detail.indices);for(const $t of Rt.target.options)$t.selected=Ct.has($t.index);c.setValue(e,{value:K(!0)}),pt=K(!1)},editable(Rt){Rt.target.disabled=!Rt.detail.editable}};this._dispatchEventFromSandbox(Ot,vt)}),v.addEventListener("input",vt=>{var Rt;const Ot=K(!0);c.setValue(e,{value:Ot}),vt.preventDefault(),(Rt=this.linkService.eventBus)==null||Rt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:pt,changeEx:Ot,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(v,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],vt=>vt.target.value)):v.addEventListener("input",function(vt){c.setValue(e,{value:K(!0)})}),this.data.combo&&this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class xt extends x{constructor(c){const{data:e,elements:l}=c;super(c,{isRenderable:x._hasPopupData(e)}),this.elements=l}render(){this.container.classList.add("popupAnnotation");const c=new _({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const l of this.elements)l.popup=c,e.push(l.data.id),l.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(l=>`${u.AnnotationPrefix}${l}`).join(",")),this.container}}class _{constructor({container:c,color:e,elements:l,titleObj:v,modificationDate:R,contentsObj:B,richText:K,parent:pt,rect:bt,parentRect:vt,open:Ot}){f(this,at);f(this,kt);f(this,St);f(this,s);f(this,xe,E(this,at,zn).bind(this));f(this,Ce,E(this,s,Bs).bind(this));f(this,ke,E(this,St,Hs).bind(this));f(this,M,E(this,kt,gs).bind(this));f(this,n,null);f(this,i,null);f(this,d,null);f(this,p,null);f(this,o,null);f(this,h,null);f(this,g,null);f(this,w,!1);f(this,D,null);f(this,L,null);f(this,J,null);f(this,tt,null);f(this,ht,!1);var Rt;P(this,i,c),P(this,tt,v),P(this,d,B),P(this,J,K),P(this,h,pt),P(this,n,e),P(this,L,bt),P(this,g,vt),P(this,o,l),P(this,p,it.PDFDateString.toDateObject(R)),this.trigger=l.flatMap(Ct=>Ct.getElementsToTriggerPopup());for(const Ct of this.trigger)Ct.addEventListener("click",t(this,M)),Ct.addEventListener("mouseenter",t(this,ke)),Ct.addEventListener("mouseleave",t(this,Ce)),Ct.classList.add("popupTriggerArea");for(const Ct of l)(Rt=Ct.container)==null||Rt.addEventListener("keydown",t(this,xe));t(this,i).hidden=!0,Ot&&E(this,kt,gs).call(this)}render(){if(t(this,D))return;const{page:{view:c},viewport:{rawDims:{pageWidth:e,pageHeight:l,pageX:v,pageY:R}}}=t(this,h),B=P(this,D,document.createElement("div"));if(B.className="popup",t(this,n)){const me=B.style.outlineColor=u.Util.makeHexColor(...t(this,n));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?B.style.backgroundColor=`color-mix(in srgb, ${me} 30%, white)`:B.style.backgroundColor=u.Util.makeHexColor(...t(this,n).map(Re=>Math.floor(.7*(255-Re)+Re)))}const K=document.createElement("span");K.className="header";const pt=document.createElement("h1");if(K.append(pt),{dir:pt.dir,str:pt.textContent}=t(this,tt),B.append(K),t(this,p)){const me=document.createElement("span");me.classList.add("popupDate"),me.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),me.setAttribute("data-l10n-args",JSON.stringify({date:t(this,p).toLocaleDateString(),time:t(this,p).toLocaleTimeString()})),K.append(me)}const bt=t(this,d),vt=t(this,J);if(vt!=null&&vt.str&&(!(bt!=null&&bt.str)||bt.str===vt.str))H.XfaLayer.render({xfaHtml:vt.html,intent:"richText",div:B}),B.lastChild.classList.add("richText","popupContent");else{const me=this._formatContents(bt);B.append(me)}let Ot=!!t(this,g),Rt=Ot?t(this,g):t(this,L);for(const me of t(this,o))if(!Rt||u.Util.intersect(me.data.rect,Rt)!==null){Rt=me.data.rect,Ot=!0;break}const Ct=u.Util.normalizeRect([Rt[0],c[3]-Rt[1]+c[1],Rt[2],c[3]-Rt[3]+c[1]]),$t=5,zt=Ot?Rt[2]-Rt[0]+$t:0,Zt=Ct[0]+zt,ce=Ct[1],{style:Pe}=t(this,i);Pe.left=`${100*(Zt-v)/e}%`,Pe.top=`${100*(ce-R)/l}%`,t(this,i).append(B)}_formatContents({str:c,dir:e}){const l=document.createElement("p");l.classList.add("popupContent"),l.dir=e;const v=c.split(/(?:\r\n?|\n)/);for(let R=0,B=v.length;R<B;++R){const K=v[R];l.append(document.createTextNode(K)),R<B-1&&l.append(document.createElement("br"))}return l}forceHide(){P(this,ht,this.isVisible),t(this,ht)&&(t(this,i).hidden=!0)}maybeShow(){t(this,ht)&&(P(this,ht,!1),t(this,i).hidden=!1)}get isVisible(){return t(this,i).hidden===!1}}xe=new WeakMap,Ce=new WeakMap,ke=new WeakMap,M=new WeakMap,n=new WeakMap,i=new WeakMap,d=new WeakMap,p=new WeakMap,o=new WeakMap,h=new WeakMap,g=new WeakMap,w=new WeakMap,D=new WeakMap,L=new WeakMap,J=new WeakMap,tt=new WeakMap,ht=new WeakMap,at=new WeakSet,zn=function(c){c.altKey||c.shiftKey||c.ctrlKey||c.metaKey||(c.key==="Enter"||c.key==="Escape"&&t(this,w))&&E(this,kt,gs).call(this)},kt=new WeakSet,gs=function(){P(this,w,!t(this,w)),t(this,w)?(E(this,St,Hs).call(this),t(this,i).addEventListener("click",t(this,M)),t(this,i).addEventListener("keydown",t(this,xe))):(E(this,s,Bs).call(this),t(this,i).removeEventListener("click",t(this,M)),t(this,i).removeEventListener("keydown",t(this,xe)))},St=new WeakSet,Hs=function(){t(this,D)||this.render(),this.isVisible?t(this,w)&&t(this,i).classList.add("focused"):(t(this,i).hidden=!1,t(this,i).style.zIndex=parseInt(t(this,i).style.zIndex)+1e3)},s=new WeakSet,Bs=function(){t(this,i).classList.remove("focused"),!(t(this,w)||!this.isVisible)&&(t(this,i).hidden=!0,t(this,i).style.zIndex=parseInt(t(this,i).style.zIndex)-1e3)};class mt extends x{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0}),this.textContent=c.data.textContent,this.textPosition=c.data.textPosition,this.annotationEditorType=u.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const c=document.createElement("div");c.classList.add("annotationTextContent"),c.setAttribute("role","comment");for(const e of this.textContent){const l=document.createElement("span");l.textContent=e,c.append(l)}this.container.append(c)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class wt extends x{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});f(this,m,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:l,height:v}=T(e.rect),R=this.svgFactory.create(l,v,!0),B=P(this,m,this.svgFactory.createElement("svg:line"));return B.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),B.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),B.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),B.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),B.setAttribute("stroke-width",e.borderStyle.width||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),R.append(B),this.container.append(R),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,m)}addHighlightArea(){this.container.classList.add("highlightArea")}}m=new WeakMap;class Ut extends x{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});f(this,U,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:l,height:v}=T(e.rect),R=this.svgFactory.create(l,v,!0),B=e.borderStyle.width,K=P(this,U,this.svgFactory.createElement("svg:rect"));return K.setAttribute("x",B/2),K.setAttribute("y",B/2),K.setAttribute("width",l-B),K.setAttribute("height",v-B),K.setAttribute("stroke-width",B||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),R.append(K),this.container.append(R),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,U)}addHighlightArea(){this.container.classList.add("highlightArea")}}U=new WeakMap;class Bt extends x{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});f(this,et,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:l,height:v}=T(e.rect),R=this.svgFactory.create(l,v,!0),B=e.borderStyle.width,K=P(this,et,this.svgFactory.createElement("svg:ellipse"));return K.setAttribute("cx",l/2),K.setAttribute("cy",v/2),K.setAttribute("rx",l/2-B/2),K.setAttribute("ry",v/2-B/2),K.setAttribute("stroke-width",B||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),R.append(K),this.container.append(R),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,et)}addHighlightArea(){this.container.classList.add("highlightArea")}}et=new WeakMap;class _t extends x{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});f(this,ft,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:l,height:v}=T(e.rect),R=this.svgFactory.create(l,v,!0);let B=[];for(const pt of e.vertices){const bt=pt.x-e.rect[0],vt=e.rect[3]-pt.y;B.push(bt+","+vt)}B=B.join(" ");const K=P(this,ft,this.svgFactory.createElement(this.svgElementName));return K.setAttribute("points",B),K.setAttribute("stroke-width",e.borderStyle.width||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),R.append(K),this.container.append(R),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,ft)}addHighlightArea(){this.container.classList.add("highlightArea")}}ft=new WeakMap;class Kt extends _t{constructor(c){super(c),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Fe extends x{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Yt extends x{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});f(this,Tt,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=u.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:l,height:v}=T(e.rect),R=this.svgFactory.create(l,v,!0);for(const B of e.inkLists){let K=[];for(const bt of B){const vt=bt.x-e.rect[0],Ot=e.rect[3]-bt.y;K.push(`${vt},${Ot}`)}K=K.join(" ");const pt=this.svgFactory.createElement(this.svgElementName);t(this,Tt).push(pt),pt.setAttribute("points",K),pt.setAttribute("stroke-width",e.borderStyle.width||1),pt.setAttribute("stroke","transparent"),pt.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),R.append(pt)}return this.container.append(R),this.container}getElementsToTriggerPopup(){return t(this,Tt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Tt=new WeakMap;class Jt extends x{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class fe extends x{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ne extends x{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Xt extends x{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class te extends x{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Gt extends x{constructor(e){var R;super(e,{isRenderable:!0});f(this,jt);f(this,Ft,null);const{filename:l,content:v}=this.data.file;this.filename=(0,it.getFilenameFromUrl)(l,!0),this.content=v,(R=this.linkService.eventBus)==null||R.dispatch("fileattachmentannotation",{source:this,filename:l,content:v})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:l}=this;let v;l.hasAppearance||l.fillAlpha===0?v=document.createElement("div"):(v=document.createElement("img"),v.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(l.name)?"paperclip":"pushpin"}.svg`,l.fillAlpha&&l.fillAlpha<1&&(v.style=`filter: opacity(${Math.round(l.fillAlpha*100)}%);`)),v.addEventListener("dblclick",E(this,jt,zs).bind(this)),P(this,Ft,v);const{isMac:R}=u.FeatureTest.platform;return e.addEventListener("keydown",B=>{B.key==="Enter"&&(R?B.metaKey:B.ctrlKey)&&E(this,jt,zs).call(this)}),!l.popupRef&&this.hasPopupData?this._createPopup():v.classList.add("popupTriggerArea"),e.append(v),e}getElementsToTriggerPopup(){return t(this,Ft)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ft=new WeakMap,jt=new WeakSet,zs=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};class se{constructor({div:c,accessibilityManager:e,annotationCanvasMap:l,page:v,viewport:R}){f(this,Y);f(this,ut);f(this,Dt,null);f(this,Ht,null);f(this,y,new Map);this.div=c,P(this,Dt,e),P(this,Ht,l),this.page=v,this.viewport=R,this.zIndex=0}render(c){return be(this,null,function*(){const{annotations:e}=c,l=this.div;(0,it.setLayerDimensions)(l,this.viewport);const v=new Map,R={data:null,layer:l,linkService:c.linkService,downloadManager:c.downloadManager,imageResourcesPath:c.imageResourcesPath||"",renderForms:c.renderForms!==!1,svgFactory:new it.DOMSVGFactory,annotationStorage:c.annotationStorage||new k.AnnotationStorage,enableScripting:c.enableScripting===!0,hasJSActions:c.hasJSActions,fieldObjects:c.fieldObjects,parent:this,elements:null};for(const B of e){if(B.noHTML)continue;const K=B.annotationType===u.AnnotationType.POPUP;if(K){const vt=v.get(B.id);if(!vt)continue;R.elements=vt}else{const{width:vt,height:Ot}=T(B.rect);if(vt<=0||Ot<=0)continue}R.data=B;const pt=W.create(R);if(!pt.isRenderable)continue;if(!K&&B.popupRef){const vt=v.get(B.popupRef);vt?vt.push(pt):v.set(B.popupRef,[pt])}pt.annotationEditorType>0&&t(this,y).set(pt.data.id,pt);const bt=pt.render();B.hidden&&(bt.style.visibility="hidden"),E(this,Y,Un).call(this,bt,B.id)}E(this,ut,Us).call(this)})}update({viewport:c}){const e=this.div;this.viewport=c,(0,it.setLayerDimensions)(e,{rotation:c.rotation}),E(this,ut,Us).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(t(this,y).values())}getEditableAnnotation(c){return t(this,y).get(c)}}Dt=new WeakMap,Ht=new WeakMap,y=new WeakMap,Y=new WeakSet,Un=function(c,e){var v;const l=c.firstChild||c;l.id=`${u.AnnotationPrefix}${e}`,this.div.append(c),(v=t(this,Dt))==null||v.moveElementInDOM(this.div,c,l,!1)},ut=new WeakSet,Us=function(){if(!t(this,Ht))return;const c=this.div;for(const[e,l]of t(this,Ht)){const v=c.querySelector(`[data-annotation-id="${e}"]`);if(!v)continue;const{firstChild:R}=v;R?R.nodeName==="CANVAS"?R.replaceWith(l):R.before(l):v.append(l)}t(this,Ht).clear()}},780:(ie,Nt,rt)=>{var H,A,z,Gn,T;rt.d(Nt,{AnnotationStorage:()=>lt,PrintAnnotationStorage:()=>Q,SerializableEmpty:()=>q});var u=rt(266),it=rt(115),k=rt(825);const q=Object.freeze({map:null,hash:"",transfer:void 0});class lt{constructor(){f(this,z);f(this,H,!1);f(this,A,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(x,O){const I=t(this,A).get(x);return I===void 0?O:Object.assign(O,I)}getRawValue(x){return t(this,A).get(x)}remove(x){if(t(this,A).delete(x),t(this,A).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const O of t(this,A).values())if(O instanceof it.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(x,O){const I=t(this,A).get(x);let G=!1;if(I!==void 0)for(const[V,F]of Object.entries(O))I[V]!==F&&(G=!0,I[V]=F);else G=!0,t(this,A).set(x,O);G&&E(this,z,Gn).call(this),O instanceof it.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(O.constructor._type)}has(x){return t(this,A).has(x)}getAll(){return t(this,A).size>0?(0,u.objectFromMap)(t(this,A)):null}setAll(x){for(const[O,I]of Object.entries(x))this.setValue(O,I)}get size(){return t(this,A).size}resetModified(){t(this,H)&&(P(this,H,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Q(this)}get serializable(){if(t(this,A).size===0)return q;const x=new Map,O=new k.MurmurHash3_64,I=[],G=Object.create(null);let V=!1;for(const[F,X]of t(this,A)){const C=X instanceof it.AnnotationEditor?X.serialize(!1,G):X;C&&(x.set(F,C),O.update(`${F}:${JSON.stringify(C)}`),V||(V=!!C.bitmap))}if(V)for(const F of x.values())F.bitmap&&I.push(F.bitmap);return x.size>0?{map:x,hash:O.hexdigest(),transfer:I}:q}}H=new WeakMap,A=new WeakMap,z=new WeakSet,Gn=function(){t(this,H)||(P(this,H,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class Q extends lt{constructor(O){super();f(this,T,void 0);const{map:I,hash:G,transfer:V}=O.serializable,F=structuredClone(I,V?{transfer:V}:null);P(this,T,{map:F,hash:G,transfer:V})}get print(){(0,u.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,T)}}T=new WeakMap},406:(ie,Nt,rt)=>{rt.a(ie,(u,it)=>be(this,null,function*(){var X,C,$,st,Ri,_,ms,wt,Ut,Bt,_t,Kt,bs,Yt,Jt,fe,ne,Xt,As,Gt,se,Gs,ee,qt;try{let ke=function(S){var Ie,Oe;if(typeof S=="string"||S instanceof URL?S={url:S}:(0,k.isArrayBuffer)(S)&&(S={data:S}),typeof S!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!S.url&&!S.data&&!S.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const s=new d,{docId:a}=s,m=S.url?n(S.url):null,U=S.data?i(S.data):null,et=S.httpHeaders||null,ft=S.withCredentials===!0,Tt=(Ie=S.password)!=null?Ie:null,Ft=S.range instanceof p?S.range:null,jt=Number.isInteger(S.rangeChunkSize)&&S.rangeChunkSize>0?S.rangeChunkSize:he;let Vt=S.worker instanceof D?S.worker:null;const Dt=S.verbosity,Ht=typeof S.docBaseUrl=="string"&&!(0,lt.isDataScheme)(S.docBaseUrl)?S.docBaseUrl:null,y=typeof S.cMapUrl=="string"?S.cMapUrl:null,Y=S.cMapPacked!==!1,ct=S.CMapReaderFactory||we,ut=typeof S.standardFontDataUrl=="string"?S.standardFontDataUrl:null,Pt=S.StandardFontDataFactory||Ce,At=S.stopAtErrors!==!0,c=Number.isInteger(S.maxImageSize)&&S.maxImageSize>-1?S.maxImageSize:-1,e=S.isEvalSupported!==!1,l=typeof S.isOffscreenCanvasSupported=="boolean"?S.isOffscreenCanvasSupported:!k.isNodeJS,v=Number.isInteger(S.canvasMaxAreaInBytes)?S.canvasMaxAreaInBytes:-1,R=typeof S.disableFontFace=="boolean"?S.disableFontFace:k.isNodeJS,B=S.fontExtraProperties===!0,K=S.enableXfa===!0,pt=S.ownerDocument||globalThis.document,bt=S.disableRange===!0,vt=S.disableStream===!0,Ot=S.disableAutoFetch===!0,Rt=S.pdfBug===!0,Ct=Ft?Ft.length:(Oe=S.length)!=null?Oe:NaN,$t=typeof S.useSystemFonts=="boolean"?S.useSystemFonts:!k.isNodeJS&&!R,zt=typeof S.useWorkerFetch=="boolean"?S.useWorkerFetch:ct===lt.DOMCMapReaderFactory&&Pt===lt.DOMStandardFontDataFactory&&y&&ut&&(0,lt.isValidFetchUrl)(y,document.baseURI)&&(0,lt.isValidFetchUrl)(ut,document.baseURI),Zt=S.canvasFactory||new ae({ownerDocument:pt}),ce=S.filterFactory||new xe({docId:a,ownerDocument:pt}),Pe=null;(0,k.setVerbosityLevel)(Dt);const me={canvasFactory:Zt,filterFactory:ce};if(zt||(me.cMapReaderFactory=new ct({baseUrl:y,isCompressed:Y}),me.standardFontDataFactory=new Pt({baseUrl:ut})),!Vt){const Ke={verbosity:Dt,port:z.GlobalWorkerOptions.workerPort};Vt=Ke.port?D.fromPort(Ke):new D(Ke),s._worker=Vt}const He={docId:a,apiVersion:"4.0.379",data:U,password:Tt,disableAutoFetch:Ot,rangeChunkSize:jt,length:Ct,docBaseUrl:Ht,enableXfa:K,evaluatorOptions:{maxImageSize:c,disableFontFace:R,ignoreErrors:At,isEvalSupported:e,isOffscreenCanvasSupported:l,canvasMaxAreaInBytes:v,fontExtraProperties:B,useSystemFonts:$t,cMapUrl:zt?y:null,standardFontDataUrl:zt?ut:null}},Re={ignoreErrors:At,isEvalSupported:e,disableFontFace:R,fontExtraProperties:B,enableXfa:K,ownerDocument:pt,disableAutoFetch:Ot,pdfBug:Rt,styleElement:Pe};return Vt.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");const Ke=M(Vt,He),$e=new Promise(function(Di){let re;Ft?re=new x.PDFDataTransportStream({length:Ct,initialData:Ft.initialData,progressiveDone:Ft.progressiveDone,contentDispositionFilename:Ft.contentDispositionFilename,disableRange:bt,disableStream:vt},Ft):U||(re=(ze=>k.isNodeJS?new G.PDFNodeStream(ze):(0,lt.isValidFetchUrl)(ze.url)?new O.PDFFetchStream(ze):new I.PDFNetworkStream(ze))({url:m,length:Ct,httpHeaders:et,withCredentials:ft,rangeChunkSize:jt,disableRange:bt,disableStream:vt})),Di(re)});return Promise.all([Ke,$e]).then(function([Di,re]){if(s.destroyed)throw new Error("Loading aborted");const ye=new N.MessageHandler(a,Di,Vt.port),ze=new L(ye,s,re,Re,me);s._transport=ze,ye.send("Ready",null)})}).catch(s._capability.reject),s},n=function(S){if(S instanceof URL)return S.href;try{return new URL(S,window.location).href}catch(s){if(k.isNodeJS&&typeof S=="string")return S}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},i=function(S){if(k.isNodeJS&&typeof ns!="undefined"&&S instanceof ns)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(S instanceof Uint8Array&&S.byteLength===S.buffer.byteLength)return S;if(typeof S=="string")return(0,k.stringToBytes)(S);if(typeof S=="object"&&!isNaN(S==null?void 0:S.length)||(0,k.isArrayBuffer)(S))return new Uint8Array(S);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")};rt.d(Nt,{PDFDataRangeTransport:()=>p,PDFWorker:()=>D,build:()=>yt,getDocument:()=>ke,version:()=>at});var k=rt(266),q=rt(780),lt=rt(473),Q=rt(742),H=rt(738),A=rt(250),z=rt(368),N=rt(694),T=rt(472),W=rt(890),x=rt(92),O=rt(171),I=rt(474),G=rt(498),V=rt(521),F=u([H,G]);[H,G]=F.then?(yield F)():F;const he=65536,ge=100,Wt=5e3,ae=k.isNodeJS?H.NodeCanvasFactory:lt.DOMCanvasFactory,we=k.isNodeJS?H.NodeCMapReaderFactory:lt.DOMCMapReaderFactory,xe=k.isNodeJS?H.NodeFilterFactory:lt.DOMFilterFactory,Ce=k.isNodeJS?H.NodeStandardFontDataFactory:lt.DOMStandardFontDataFactory;function M(S,s){return be(this,null,function*(){if(S.destroyed)throw new Error("Worker was destroyed");const a=yield S.messageHandler.sendWithPromise("GetDocRequest",s,s.data?[s.data.buffer]:null);if(S.destroyed)throw new Error("Worker was destroyed");return a})}const kt=class{constructor(){this._capability=new k.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ii(kt,X)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return be(this,null,function*(){var s,a,m;this.destroyed=!0;try{(s=this._worker)!=null&&s.port&&(this._worker._pendingDestroy=!0),yield(a=this._transport)==null?void 0:a.destroy()}catch(U){throw(m=this._worker)!=null&&m.port&&delete this._worker._pendingDestroy,U}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}};let d=kt;X=new WeakMap,f(d,X,0);class p{constructor(s,a,m=!1,U=null){this.length=s,this.initialData=a,this.progressiveDone=m,this.contentDispositionFilename=U,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new k.PromiseCapability}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,a){for(const m of this._rangeListeners)m(s,a)}onDataProgress(s,a){this._readyCapability.promise.then(()=>{for(const m of this._progressListeners)m(s,a)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(const a of this._progressiveReadListeners)a(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,a){(0,k.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class o{constructor(s,a){this._pdfInfo=s,this._transport=a}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,k.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class h{constructor(s,a,m,U=!1){f(this,st);f(this,_);f(this,C,null);f(this,$,!1);this._pageIndex=s,this._pageInfo=a,this._transport=m,this._stats=U?new lt.StatTimer:null,this._pdfBug=U,this.commonObjs=m.commonObjs,this.objs=new J,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:a=this.rotate,offsetX:m=0,offsetY:U=0,dontFlip:et=!1}={}){return new lt.PageViewport({viewBox:this.view,scale:s,rotation:a,offsetX:m,offsetY:U,dontFlip:et})}getAnnotations({intent:s="display"}={}){const a=this._transport.getRenderingIntent(s);return this._transport.getAnnotations(this._pageIndex,a.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,k.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return be(this,null,function*(){var s;return((s=this._transport._htmlForXfa)==null?void 0:s.children[this._pageIndex])||null})}render({canvasContext:s,viewport:a,intent:m="display",annotationMode:U=k.AnnotationMode.ENABLE,transform:et=null,background:ft=null,optionalContentConfigPromise:Tt=null,annotationCanvasMap:Ft=null,pageColors:jt=null,printAnnotationStorage:Vt=null}){var Pt,At;(Pt=this._stats)==null||Pt.time("Overall");const Dt=this._transport.getRenderingIntent(m,U,Vt);P(this,$,!1),E(this,_,ms).call(this),Tt||(Tt=this._transport.getOptionalContentConfig());let Ht=this._intentStates.get(Dt.cacheKey);Ht||(Ht=Object.create(null),this._intentStates.set(Dt.cacheKey,Ht)),Ht.streamReaderCancelTimeout&&(clearTimeout(Ht.streamReaderCancelTimeout),Ht.streamReaderCancelTimeout=null);const y=!!(Dt.renderingIntent&k.RenderingIntentFlag.PRINT);Ht.displayReadyCapability||(Ht.displayReadyCapability=new k.PromiseCapability,Ht.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(At=this._stats)==null||At.time("Page Request"),this._pumpOperatorList(Dt));const Y=c=>{var e,l;Ht.renderTasks.delete(ct),(this._maybeCleanupAfterRender||y)&&P(this,$,!0),E(this,st,Ri).call(this,!y),c?(ct.capability.reject(c),this._abortOperatorList({intentState:Ht,reason:c instanceof Error?c:new Error(c)})):ct.capability.resolve(),(e=this._stats)==null||e.timeEnd("Rendering"),(l=this._stats)==null||l.timeEnd("Overall")},ct=new ht({callback:Y,params:{canvasContext:s,viewport:a,transform:et,background:ft},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Ft,operatorList:Ht.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!y,pdfBug:this._pdfBug,pageColors:jt});(Ht.renderTasks||(Ht.renderTasks=new Set)).add(ct);const ut=ct.task;return Promise.all([Ht.displayReadyCapability.promise,Tt]).then(([c,e])=>{var l;if(this.destroyed){Y();return}(l=this._stats)==null||l.time("Rendering"),ct.initializeGraphics({transparency:c,optionalContentConfig:e}),ct.operatorListChanged()}).catch(Y),ut}getOperatorList({intent:s="display",annotationMode:a=k.AnnotationMode.ENABLE,printAnnotationStorage:m=null}={}){var Ft;function U(){ft.operatorList.lastChunk&&(ft.opListReadCapability.resolve(ft.operatorList),ft.renderTasks.delete(Tt))}const et=this._transport.getRenderingIntent(s,a,m,!0);let ft=this._intentStates.get(et.cacheKey);ft||(ft=Object.create(null),this._intentStates.set(et.cacheKey,ft));let Tt;return ft.opListReadCapability||(Tt=Object.create(null),Tt.operatorListChanged=U,ft.opListReadCapability=new k.PromiseCapability,(ft.renderTasks||(ft.renderTasks=new Set)).add(Tt),ft.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Ft=this._stats)==null||Ft.time("Page Request"),this._pumpOperatorList(et)),ft.opListReadCapability.promise}streamTextContent({includeMarkedContent:s=!1,disableNormalization:a=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:s===!0,disableNormalization:a===!0},{highWaterMark:100,size(U){return U.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(m=>V.XfaText.textContent(m));const a=this.streamTextContent(s);return new Promise(function(m,U){function et(){ft.read().then(function({value:Ft,done:jt}){if(jt){m(Tt);return}Object.assign(Tt.styles,Ft.styles),Tt.items.push(...Ft.items),et()},U)}const ft=a.getReader(),Tt={items:[],styles:Object.create(null)};et()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const s=[];for(const a of this._intentStates.values())if(this._abortOperatorList({intentState:a,reason:new Error("Page was destroyed."),force:!0}),!a.opListReadCapability)for(const m of a.renderTasks)s.push(m.completed),m.cancel();return this.objs.clear(),P(this,$,!1),E(this,_,ms).call(this),Promise.all(s)}cleanup(s=!1){P(this,$,!0);const a=E(this,st,Ri).call(this,!1);return s&&a&&this._stats&&(this._stats=new lt.StatTimer),a}_startRenderPage(s,a){var U,et;const m=this._intentStates.get(a);m&&((U=this._stats)==null||U.timeEnd("Page Request"),(et=m.displayReadyCapability)==null||et.resolve(s))}_renderPageChunk(s,a){for(let m=0,U=s.length;m<U;m++)a.operatorList.fnArray.push(s.fnArray[m]),a.operatorList.argsArray.push(s.argsArray[m]);a.operatorList.lastChunk=s.lastChunk,a.operatorList.separateAnnots=s.separateAnnots;for(const m of a.renderTasks)m.operatorListChanged();s.lastChunk&&E(this,st,Ri).call(this,!0)}_pumpOperatorList({renderingIntent:s,cacheKey:a,annotationStorageSerializable:m}){const{map:U,transfer:et}=m,Tt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:a,annotationStorage:U},et).getReader(),Ft=this._intentStates.get(a);Ft.streamReader=Tt;const jt=()=>{Tt.read().then(({value:Vt,done:Dt})=>{if(Dt){Ft.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Vt,Ft),jt())},Vt=>{if(Ft.streamReader=null,!this._transport.destroyed){if(Ft.operatorList){Ft.operatorList.lastChunk=!0;for(const Dt of Ft.renderTasks)Dt.operatorListChanged();E(this,st,Ri).call(this,!0)}if(Ft.displayReadyCapability)Ft.displayReadyCapability.reject(Vt);else if(Ft.opListReadCapability)Ft.opListReadCapability.reject(Vt);else throw Vt}})};jt()}_abortOperatorList({intentState:s,reason:a,force:m=!1}){if(s.streamReader){if(s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null),!m){if(s.renderTasks.size>0)return;if(a instanceof lt.RenderingCancelledException){let U=ge;a.extraDelay>0&&a.extraDelay<1e3&&(U+=a.extraDelay),s.streamReaderCancelTimeout=setTimeout(()=>{s.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:s,reason:a,force:!0})},U);return}}if(s.streamReader.cancel(new k.AbortException(a.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(const[U,et]of this._intentStates)if(et===s){this._intentStates.delete(U);break}this.cleanup()}}}get stats(){return this._stats}}C=new WeakMap,$=new WeakMap,st=new WeakSet,Ri=function(s=!1){if(E(this,_,ms).call(this),!t(this,$)||this.destroyed)return!1;if(s)return P(this,C,setTimeout(()=>{P(this,C,null),E(this,st,Ri).call(this,!1)},Wt)),!1;for(const{renderTasks:a,operatorList:m}of this._intentStates.values())if(a.size>0||!m.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),P(this,$,!1),!0},_=new WeakSet,ms=function(){t(this,C)&&(clearTimeout(t(this,C)),P(this,C,null))};class g{constructor(){f(this,wt,new Set);f(this,Ut,Promise.resolve())}postMessage(s,a){const m={data:structuredClone(s,a?{transfer:a}:null)};t(this,Ut).then(()=>{for(const U of t(this,wt))U.call(this,m)})}addEventListener(s,a){t(this,wt).add(a)}removeEventListener(s,a){t(this,wt).delete(a)}terminate(){t(this,wt).clear()}}wt=new WeakMap,Ut=new WeakMap;const w={isWorkerDisabled:!1,fakeWorkerId:0};k.isNodeJS&&(w.isWorkerDisabled=!0,(Bt=z.GlobalWorkerOptions).workerSrc||(Bt.workerSrc="./pdf.worker.mjs")),w.isSameOrigin=function(S,s){let a;try{if(a=new URL(S),!a.origin||a.origin==="null")return!1}catch(U){return!1}const m=new URL(s,a);return a.origin===m.origin},w.createCDNWrapper=function(S){const s=`await import("${S}");`;return URL.createObjectURL(new Blob([s],{type:"text/javascript"}))};const dt=class{constructor({name:s=null,port:a=null,verbosity:m=(0,k.getVerbosityLevel)()}={}){var U;if(this.name=s,this.destroyed=!1,this.verbosity=m,this._readyCapability=new k.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,a){if((U=t(dt,_t))!=null&&U.has(a))throw new Error("Cannot use more than one PDFWorker per port.");(t(dt,_t)||P(dt,_t,new WeakMap)).set(a,this),this._initializeFromPort(a);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new N.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!w.isWorkerDisabled&&!t(dt,Kt,bs)){let{workerSrc:s}=dt;try{w.isSameOrigin(window.location.href,s)||(s=w.createCDNWrapper(new URL(s,window.location).href));const a=new Worker(s,{type:"module"}),m=new N.MessageHandler("main","worker",a),U=()=>{a.removeEventListener("error",et),m.destroy(),a.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},et=()=>{this._webWorker||U()};a.addEventListener("error",et),m.on("test",Tt=>{if(a.removeEventListener("error",et),this.destroyed){U();return}Tt?(this._messageHandler=m,this._port=a,this._webWorker=a,this._readyCapability.resolve(),m.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),m.destroy(),a.terminate())}),m.on("ready",Tt=>{if(a.removeEventListener("error",et),this.destroyed){U();return}try{ft()}catch(Ft){this._setupFakeWorker()}});const ft=()=>{const Tt=new Uint8Array;m.send("test",Tt,[Tt.buffer])};ft();return}catch(a){(0,k.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){w.isWorkerDisabled||((0,k.warn)("Setting up fake worker."),w.isWorkerDisabled=!0),dt._setupFakeWorkerGlobal.then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const a=new g;this._port=a;const m=`fake${w.fakeWorkerId++}`,U=new N.MessageHandler(m+"_worker",m,a);s.setup(U,a);const et=new N.MessageHandler(m,m+"_worker",a);this._messageHandler=et,this._readyCapability.resolve(),et.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){var s;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(s=t(dt,_t))==null||s.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){var m;if(!(s!=null&&s.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const a=(m=t(this,_t))==null?void 0:m.get(s.port);if(a){if(a._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return a}return new dt(s)}static get workerSrc(){if(z.GlobalWorkerOptions.workerSrc)return z.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const s=()=>be(this,null,function*(){return t(this,Kt,bs)?t(this,Kt,bs):(yield import(this.workerSrc)).WorkerMessageHandler});return(0,k.shadow)(this,"_setupFakeWorkerGlobal",s())}};let D=dt;_t=new WeakMap,Kt=new WeakSet,bs=function(){var s;try{return((s=globalThis.pdfjsWorker)==null?void 0:s.WorkerMessageHandler)||null}catch(a){return null}},f(D,Kt),f(D,_t,void 0);class L{constructor(s,a,m,U,et){f(this,Xt);f(this,Yt,new Map);f(this,Jt,new Map);f(this,fe,new Map);f(this,ne,null);this.messageHandler=s,this.loadingTask=a,this.commonObjs=new J,this.fontLoader=new Q.FontLoader({ownerDocument:U.ownerDocument,styleElement:U.styleElement}),this._params=U,this.canvasFactory=et.canvasFactory,this.filterFactory=et.filterFactory,this.cMapReaderFactory=et.cMapReaderFactory,this.standardFontDataFactory=et.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=m,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new k.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,k.shadow)(this,"annotationStorage",new q.AnnotationStorage)}getRenderingIntent(s,a=k.AnnotationMode.ENABLE,m=null,U=!1){let et=k.RenderingIntentFlag.DISPLAY,ft=q.SerializableEmpty;switch(s){case"any":et=k.RenderingIntentFlag.ANY;break;case"display":break;case"print":et=k.RenderingIntentFlag.PRINT;break;default:(0,k.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(a){case k.AnnotationMode.DISABLE:et+=k.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case k.AnnotationMode.ENABLE:break;case k.AnnotationMode.ENABLE_FORMS:et+=k.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case k.AnnotationMode.ENABLE_STORAGE:et+=k.RenderingIntentFlag.ANNOTATIONS_STORAGE,ft=(et&k.RenderingIntentFlag.PRINT&&m instanceof q.PrintAnnotationStorage?m:this.annotationStorage).serializable;break;default:(0,k.warn)(`getRenderingIntent - invalid annotationMode: ${a}`)}return U&&(et+=k.RenderingIntentFlag.OPLIST),{renderingIntent:et,cacheKey:`${et}_${ft.hash}`,annotationStorageSerializable:ft}}destroy(){var m;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new k.PromiseCapability,(m=t(this,ne))==null||m.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const U of t(this,Jt).values())s.push(U._destroy());t(this,Jt).clear(),t(this,fe).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const a=this.messageHandler.sendWithPromise("Terminate",null);return s.push(a),Promise.all(s).then(()=>{var U;this.commonObjs.clear(),this.fontLoader.clear(),t(this,Yt).clear(),this.filterFactory.destroy(),(U=this._networkStream)==null||U.cancelAllRequests(new k.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:s,loadingTask:a}=this;s.on("GetReader",(m,U)=>{(0,k.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=et=>{this._lastProgress={loaded:et.loaded,total:et.total}},U.onPull=()=>{this._fullReader.read().then(function({value:et,done:ft}){if(ft){U.close();return}(0,k.assert)(et instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),U.enqueue(new Uint8Array(et),1,[et])}).catch(et=>{U.error(et)})},U.onCancel=et=>{this._fullReader.cancel(et),U.ready.catch(ft=>{if(!this.destroyed)throw ft})}}),s.on("ReaderHeadersReady",m=>{const U=new k.PromiseCapability,et=this._fullReader;return et.headersReady.then(()=>{var ft;(!et.isStreamingSupported||!et.isRangeSupported)&&(this._lastProgress&&((ft=a.onProgress)==null||ft.call(a,this._lastProgress)),et.onProgress=Tt=>{var Ft;(Ft=a.onProgress)==null||Ft.call(a,{loaded:Tt.loaded,total:Tt.total})}),U.resolve({isStreamingSupported:et.isStreamingSupported,isRangeSupported:et.isRangeSupported,contentLength:et.contentLength})},U.reject),U.promise}),s.on("GetRangeReader",(m,U)=>{(0,k.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const et=this._networkStream.getRangeReader(m.begin,m.end);if(!et){U.close();return}U.onPull=()=>{et.read().then(function({value:ft,done:Tt}){if(Tt){U.close();return}(0,k.assert)(ft instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),U.enqueue(new Uint8Array(ft),1,[ft])}).catch(ft=>{U.error(ft)})},U.onCancel=ft=>{et.cancel(ft),U.ready.catch(Tt=>{if(!this.destroyed)throw Tt})}}),s.on("GetDoc",({pdfInfo:m})=>{this._numPages=m.numPages,this._htmlForXfa=m.htmlForXfa,delete m.htmlForXfa,a._capability.resolve(new o(m,this))}),s.on("DocException",function(m){let U;switch(m.name){case"PasswordException":U=new k.PasswordException(m.message,m.code);break;case"InvalidPDFException":U=new k.InvalidPDFException(m.message);break;case"MissingPDFException":U=new k.MissingPDFException(m.message);break;case"UnexpectedResponseException":U=new k.UnexpectedResponseException(m.message,m.status);break;case"UnknownErrorException":U=new k.UnknownErrorException(m.message,m.details);break;default:(0,k.unreachable)("DocException - expected a valid Error.")}a._capability.reject(U)}),s.on("PasswordRequest",m=>{if(P(this,ne,new k.PromiseCapability),a.onPassword){const U=et=>{et instanceof Error?t(this,ne).reject(et):t(this,ne).resolve({password:et})};try{a.onPassword(U,m.code)}catch(et){t(this,ne).reject(et)}}else t(this,ne).reject(new k.PasswordException(m.message,m.code));return t(this,ne).promise}),s.on("DataLoaded",m=>{var U;(U=a.onProgress)==null||U.call(a,{loaded:m.length,total:m.length}),this.downloadInfoCapability.resolve(m)}),s.on("StartRenderPage",m=>{if(this.destroyed)return;t(this,Jt).get(m.pageIndex)._startRenderPage(m.transparency,m.cacheKey)}),s.on("commonobj",([m,U,et])=>{var ft;if(this.destroyed||this.commonObjs.has(m))return null;switch(U){case"Font":const Tt=this._params;if("error"in et){const Dt=et.error;(0,k.warn)(`Error during font loading: ${Dt}`),this.commonObjs.resolve(m,Dt);break}const Ft=Tt.pdfBug&&((ft=globalThis.FontInspector)!=null&&ft.enabled)?(Dt,Ht)=>globalThis.FontInspector.fontAdded(Dt,Ht):null,jt=new Q.FontFaceObject(et,{isEvalSupported:Tt.isEvalSupported,disableFontFace:Tt.disableFontFace,ignoreErrors:Tt.ignoreErrors,inspectFont:Ft});this.fontLoader.bind(jt).catch(Dt=>s.sendWithPromise("FontFallback",{id:m})).finally(()=>{!Tt.fontExtraProperties&&jt.data&&(jt.data=null),this.commonObjs.resolve(m,jt)});break;case"CopyLocalImage":const{imageRef:Vt}=et;(0,k.assert)(Vt,"The imageRef must be defined.");for(const Dt of t(this,Jt).values())for(const[,Ht]of Dt.objs)if(Ht.ref===Vt)return Ht.dataLen?(this.commonObjs.resolve(m,structuredClone(Ht)),Ht.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(m,et);break;default:throw new Error(`Got unknown common object type ${U}`)}return null}),s.on("obj",([m,U,et,ft])=>{var Ft;if(this.destroyed)return;const Tt=t(this,Jt).get(U);if(!Tt.objs.has(m)){if(Tt._intentStates.size===0){(Ft=ft==null?void 0:ft.bitmap)==null||Ft.close();return}switch(et){case"Image":Tt.objs.resolve(m,ft),(ft==null?void 0:ft.dataLen)>k.MAX_IMAGE_SIZE_TO_CACHE&&(Tt._maybeCleanupAfterRender=!0);break;case"Pattern":Tt.objs.resolve(m,ft);break;default:throw new Error(`Got unknown object type ${et}`)}}}),s.on("DocProgress",m=>{var U;this.destroyed||(U=a.onProgress)==null||U.call(a,{loaded:m.loaded,total:m.total})}),s.on("FetchBuiltInCMap",m=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(m):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",m=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(m):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var m,U;this.annotationStorage.size<=0&&(0,k.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:s,transfer:a}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:s,filename:(U=(m=this._fullReader)==null?void 0:m.filename)!=null?U:null},a).finally(()=>{this.annotationStorage.resetModified()})}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));const a=s-1,m=t(this,fe).get(a);if(m)return m;const U=this.messageHandler.sendWithPromise("GetPage",{pageIndex:a}).then(et=>{if(this.destroyed)throw new Error("Transport destroyed");const ft=new h(a,et,this,this._params.pdfBug);return t(this,Jt).set(a,ft),ft});return t(this,fe).set(a,U),U}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,a){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:a})}getFieldObjects(){return E(this,Xt,As).call(this,"GetFieldObjects")}hasJSActions(){return E(this,Xt,As).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return E(this,Xt,As).call(this,"GetDocJSActions")}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new W.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const s="GetMetadata",a=t(this,Yt).get(s);if(a)return a;const m=this.messageHandler.sendWithPromise(s,null).then(U=>{var et,ft,Tt,Ft;return{info:U[0],metadata:U[1]?new T.Metadata(U[1]):null,contentDispositionFilename:(ft=(et=this._fullReader)==null?void 0:et.filename)!=null?ft:null,contentLength:(Ft=(Tt=this._fullReader)==null?void 0:Tt.contentLength)!=null?Ft:null}});return t(this,Yt).set(s,m),m}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(s=!1){return be(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(const a of t(this,Jt).values())if(!a.cleanup())throw new Error(`startCleanup: Page ${a.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),t(this,Yt).clear(),this.filterFactory.destroy(!0)}})}get loadingParams(){const{disableAutoFetch:s,enableXfa:a}=this._params;return(0,k.shadow)(this,"loadingParams",{disableAutoFetch:s,enableXfa:a})}}Yt=new WeakMap,Jt=new WeakMap,fe=new WeakMap,ne=new WeakMap,Xt=new WeakSet,As=function(s,a=null){const m=t(this,Yt).get(s);if(m)return m;const U=this.messageHandler.sendWithPromise(s,a);return t(this,Yt).set(s,U),U};class J{constructor(){f(this,se);f(this,Gt,Object.create(null))}get(s,a=null){if(a){const U=E(this,se,Gs).call(this,s);return U.capability.promise.then(()=>a(U.data)),null}const m=t(this,Gt)[s];if(!(m!=null&&m.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${s}.`);return m.data}has(s){var m;const a=t(this,Gt)[s];return(m=a==null?void 0:a.capability.settled)!=null?m:!1}resolve(s,a=null){const m=E(this,se,Gs).call(this,s);m.data=a,m.capability.resolve()}clear(){var s;for(const a in t(this,Gt)){const{data:m}=t(this,Gt)[a];(s=m==null?void 0:m.bitmap)==null||s.close()}P(this,Gt,Object.create(null))}*[Symbol.iterator](){for(const s in t(this,Gt)){const{capability:a,data:m}=t(this,Gt)[s];a.settled&&(yield[s,m])}}}Gt=new WeakMap,se=new WeakSet,Gs=function(s){var a;return(a=t(this,Gt))[s]||(a[s]={capability:new k.PromiseCapability,data:null})};class tt{constructor(s){f(this,ee,null);P(this,ee,s),this.onContinue=null}get promise(){return t(this,ee).capability.promise}cancel(s=0){t(this,ee).cancel(null,s)}get separateAnnots(){const{separateAnnots:s}=t(this,ee).operatorList;if(!s)return!1;const{annotationCanvasMap:a}=t(this,ee);return s.form||s.canvas&&(a==null?void 0:a.size)>0}}ee=new WeakMap;const St=class{constructor({callback:s,params:a,objs:m,commonObjs:U,annotationCanvasMap:et,operatorList:ft,pageIndex:Tt,canvasFactory:Ft,filterFactory:jt,useRequestAnimationFrame:Vt=!1,pdfBug:Dt=!1,pageColors:Ht=null}){this.callback=s,this.params=a,this.objs=m,this.commonObjs=U,this.annotationCanvasMap=et,this.operatorListIdx=null,this.operatorList=ft,this._pageIndex=Tt,this.canvasFactory=Ft,this.filterFactory=jt,this._pdfBug=Dt,this.pageColors=Ht,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Vt===!0&&typeof window!="undefined",this.cancelled=!1,this.capability=new k.PromiseCapability,this.task=new tt(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=a.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:a}){var Tt,Ft;if(this.cancelled)return;if(this._canvas){if(t(St,qt).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(St,qt).add(this._canvas)}this._pdfBug&&((Tt=globalThis.StepperManager)!=null&&Tt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:m,viewport:U,transform:et,background:ft}=this.params;this.gfx=new A.CanvasGraphics(m,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:a},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:et,viewport:U,transparency:s,background:ft}),this.operatorListIdx=0,this.graphicsReady=!0,(Ft=this.graphicsReadyCallback)==null||Ft.call(this)}cancel(s=null,a=0){var m;this.running=!1,this.cancelled=!0,(m=this.gfx)==null||m.endDrawing(),t(St,qt).delete(this._canvas),this.callback(s||new lt.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,a))}operatorListChanged(){var s;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(s=this.stepper)==null||s.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return be(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(St,qt).delete(this._canvas),this.callback())))})}};let ht=St;qt=new WeakMap,f(ht,qt,new WeakSet);const at="4.0.379",yt="9e14d04fd";it()}catch(he){it(he)}}))},822:(ie,Nt,rt)=>{rt.d(Nt,{BaseCMapReaderFactory:()=>q,BaseCanvasFactory:()=>k,BaseFilterFactory:()=>it,BaseSVGFactory:()=>Q,BaseStandardFontDataFactory:()=>lt});var u=rt(266);class it{constructor(){this.constructor===it&&(0,u.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(A){return"none"}addHCMFilter(A,z){return"none"}addHighlightHCMFilter(A,z,N,T){return"none"}destroy(A=!1){}}class k{constructor(){this.constructor===k&&(0,u.unreachable)("Cannot initialize BaseCanvasFactory.")}create(A,z){if(A<=0||z<=0)throw new Error("Invalid canvas size");const N=this._createCanvas(A,z);return{canvas:N,context:N.getContext("2d")}}reset(A,z,N){if(!A.canvas)throw new Error("Canvas is not specified");if(z<=0||N<=0)throw new Error("Invalid canvas size");A.canvas.width=z,A.canvas.height=N}destroy(A){if(!A.canvas)throw new Error("Canvas is not specified");A.canvas.width=0,A.canvas.height=0,A.canvas=null,A.context=null}_createCanvas(A,z){(0,u.unreachable)("Abstract method `_createCanvas` called.")}}class q{constructor({baseUrl:A=null,isCompressed:z=!0}){this.constructor===q&&(0,u.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=A,this.isCompressed=z}fetch(z){return be(this,arguments,function*({name:A}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!A)throw new Error("CMap name must be specified.");const N=this.baseUrl+A+(this.isCompressed?".bcmap":""),T=this.isCompressed?u.CMapCompressionType.BINARY:u.CMapCompressionType.NONE;return this._fetchData(N,T).catch(W=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${N}`)})})}_fetchData(A,z){(0,u.unreachable)("Abstract method `_fetchData` called.")}}class lt{constructor({baseUrl:A=null}){this.constructor===lt&&(0,u.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=A}fetch(z){return be(this,arguments,function*({filename:A}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!A)throw new Error("Font filename must be specified.");const N=`${this.baseUrl}${A}`;return this._fetchData(N).catch(T=>{throw new Error(`Unable to load font data at: ${N}`)})})}_fetchData(A){(0,u.unreachable)("Abstract method `_fetchData` called.")}}class Q{constructor(){this.constructor===Q&&(0,u.unreachable)("Cannot initialize BaseSVGFactory.")}create(A,z,N=!1){if(A<=0||z<=0)throw new Error("Invalid SVG dimensions");const T=this._createSVG("svg:svg");return T.setAttribute("version","1.1"),N||(T.setAttribute("width",`${A}px`),T.setAttribute("height",`${z}px`)),T.setAttribute("preserveAspectRatio","none"),T.setAttribute("viewBox",`0 0 ${A} ${z}`),T}createElement(A){if(typeof A!="string")throw new Error("Invalid SVG element type");return this._createSVG(A)}_createSVG(A){(0,u.unreachable)("Abstract method `_createSVG` called.")}}},250:(ie,Nt,rt)=>{var ae,Xs,xe,Vs;rt.d(Nt,{CanvasGraphics:()=>ge});var u=rt(266),it=rt(473);const k={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function q(M,n){if(!n)return;const i=n[2]-n[0],d=n[3]-n[1],p=new Path2D;p.rect(n[0],n[1],i,d),M.clip(p)}class lt{constructor(){this.constructor===lt&&(0,u.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,u.unreachable)("Abstract method `getPattern` called.")}}class Q extends lt{constructor(n){super(),this._type=n[1],this._bbox=n[2],this._colorStops=n[3],this._p0=n[4],this._p1=n[5],this._r0=n[6],this._r1=n[7],this.matrix=null}_createGradient(n){let i;this._type==="axial"?i=n.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=n.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const d of this._colorStops)i.addColorStop(d[0],d[1]);return i}getPattern(n,i,d,p){let o;if(p===k.STROKE||p===k.FILL){const h=i.current.getClippedPathBoundingBox(p,(0,it.getCurrentTransform)(n))||[0,0,0,0],g=Math.ceil(h[2]-h[0])||1,w=Math.ceil(h[3]-h[1])||1,D=i.cachedCanvases.getCanvas("pattern",g,w,!0),L=D.context;L.clearRect(0,0,L.canvas.width,L.canvas.height),L.beginPath(),L.rect(0,0,L.canvas.width,L.canvas.height),L.translate(-h[0],-h[1]),d=u.Util.transform(d,[1,0,0,1,h[0],h[1]]),L.transform(...i.baseTransform),this.matrix&&L.transform(...this.matrix),q(L,this._bbox),L.fillStyle=this._createGradient(L),L.fill(),o=n.createPattern(D.canvas,"no-repeat");const J=new DOMMatrix(d);o.setTransform(J)}else q(n,this._bbox),o=this._createGradient(n);return o}}function H(M,n,i,d,p,o,h,g){const w=n.coords,D=n.colors,L=M.data,J=M.width*4;let tt;w[i+1]>w[d+1]&&(tt=i,i=d,d=tt,tt=o,o=h,h=tt),w[d+1]>w[p+1]&&(tt=d,d=p,p=tt,tt=h,h=g,g=tt),w[i+1]>w[d+1]&&(tt=i,i=d,d=tt,tt=o,o=h,h=tt);const ht=(w[i]+n.offsetX)*n.scaleX,at=(w[i+1]+n.offsetY)*n.scaleY,yt=(w[d]+n.offsetX)*n.scaleX,kt=(w[d+1]+n.offsetY)*n.scaleY,dt=(w[p]+n.offsetX)*n.scaleX,St=(w[p+1]+n.offsetY)*n.scaleY;if(at>=St)return;const S=D[o],s=D[o+1],a=D[o+2],m=D[h],U=D[h+1],et=D[h+2],ft=D[g],Tt=D[g+1],Ft=D[g+2],jt=Math.round(at),Vt=Math.round(St);let Dt,Ht,y,Y,ct,ut,Pt,At;for(let c=jt;c<=Vt;c++){if(c<kt){const B=c<at?0:(at-c)/(at-kt);Dt=ht-(ht-yt)*B,Ht=S-(S-m)*B,y=s-(s-U)*B,Y=a-(a-et)*B}else{let B;c>St?B=1:kt===St?B=0:B=(kt-c)/(kt-St),Dt=yt-(yt-dt)*B,Ht=m-(m-ft)*B,y=U-(U-Tt)*B,Y=et-(et-Ft)*B}let e;c<at?e=0:c>St?e=1:e=(at-c)/(at-St),ct=ht-(ht-dt)*e,ut=S-(S-ft)*e,Pt=s-(s-Tt)*e,At=a-(a-Ft)*e;const l=Math.round(Math.min(Dt,ct)),v=Math.round(Math.max(Dt,ct));let R=J*c+l*4;for(let B=l;B<=v;B++)e=(Dt-B)/(Dt-ct),e<0?e=0:e>1&&(e=1),L[R++]=Ht-(Ht-ut)*e|0,L[R++]=y-(y-Pt)*e|0,L[R++]=Y-(Y-At)*e|0,L[R++]=255}}function A(M,n,i){const d=n.coords,p=n.colors;let o,h;switch(n.type){case"lattice":const g=n.verticesPerRow,w=Math.floor(d.length/g)-1,D=g-1;for(o=0;o<w;o++){let L=o*g;for(let J=0;J<D;J++,L++)H(M,i,d[L],d[L+1],d[L+g],p[L],p[L+1],p[L+g]),H(M,i,d[L+g+1],d[L+1],d[L+g],p[L+g+1],p[L+1],p[L+g])}break;case"triangles":for(o=0,h=d.length;o<h;o+=3)H(M,i,d[o],d[o+1],d[o+2],p[o],p[o+1],p[o+2]);break;default:throw new Error("illegal figure")}}class z extends lt{constructor(n){super(),this._coords=n[2],this._colors=n[3],this._figures=n[4],this._bounds=n[5],this._bbox=n[7],this._background=n[8],this.matrix=null}_createMeshCanvas(n,i,d){const g=Math.floor(this._bounds[0]),w=Math.floor(this._bounds[1]),D=Math.ceil(this._bounds[2])-g,L=Math.ceil(this._bounds[3])-w,J=Math.min(Math.ceil(Math.abs(D*n[0]*1.1)),3e3),tt=Math.min(Math.ceil(Math.abs(L*n[1]*1.1)),3e3),ht=D/J,at=L/tt,yt={coords:this._coords,colors:this._colors,offsetX:-g,offsetY:-w,scaleX:1/ht,scaleY:1/at},kt=J+2*2,dt=tt+2*2,St=d.getCanvas("mesh",kt,dt,!1),S=St.context,s=S.createImageData(J,tt);if(i){const m=s.data;for(let U=0,et=m.length;U<et;U+=4)m[U]=i[0],m[U+1]=i[1],m[U+2]=i[2],m[U+3]=255}for(const m of this._figures)A(s,m,yt);return S.putImageData(s,2,2),{canvas:St.canvas,offsetX:g-2*ht,offsetY:w-2*at,scaleX:ht,scaleY:at}}getPattern(n,i,d,p){q(n,this._bbox);let o;if(p===k.SHADING)o=u.Util.singularValueDecompose2dScale((0,it.getCurrentTransform)(n));else if(o=u.Util.singularValueDecompose2dScale(i.baseTransform),this.matrix){const g=u.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*g[0],o[1]*g[1]]}const h=this._createMeshCanvas(o,p===k.SHADING?null:this._background,i.cachedCanvases);return p!==k.SHADING&&(n.setTransform(...i.baseTransform),this.matrix&&n.transform(...this.matrix)),n.translate(h.offsetX,h.offsetY),n.scale(h.scaleX,h.scaleY),n.createPattern(h.canvas,"no-repeat")}}class N extends lt{getPattern(){return"hotpink"}}function T(M){switch(M[0]){case"RadialAxial":return new Q(M);case"Mesh":return new z(M);case"Dummy":return new N}throw new Error(`Unknown IR type: ${M[0]}`)}const W={COLORED:1,UNCOLORED:2},Wt=class{constructor(n,i,d,p,o){this.operatorList=n[2],this.matrix=n[3]||[1,0,0,1,0,0],this.bbox=n[4],this.xstep=n[5],this.ystep=n[6],this.paintType=n[7],this.tilingType=n[8],this.color=i,this.ctx=d,this.canvasGraphicsFactory=p,this.baseTransform=o}createPatternCanvas(n){const i=this.operatorList,d=this.bbox,p=this.xstep,o=this.ystep,h=this.paintType,g=this.tilingType,w=this.color,D=this.canvasGraphicsFactory;(0,u.info)("TilingType: "+g);const L=d[0],J=d[1],tt=d[2],ht=d[3],at=u.Util.singularValueDecompose2dScale(this.matrix),yt=u.Util.singularValueDecompose2dScale(this.baseTransform),kt=[at[0]*yt[0],at[1]*yt[1]],dt=this.getSizeAndScale(p,this.ctx.canvas.width,kt[0]),St=this.getSizeAndScale(o,this.ctx.canvas.height,kt[1]),S=n.cachedCanvases.getCanvas("pattern",dt.size,St.size,!0),s=S.context,a=D.createCanvasGraphics(s);a.groupLevel=n.groupLevel,this.setFillAndStrokeStyleToContext(a,h,w);let m=L,U=J,et=tt,ft=ht;return L<0&&(m=0,et+=Math.abs(L)),J<0&&(U=0,ft+=Math.abs(J)),s.translate(-(dt.scale*m),-(St.scale*U)),a.transform(dt.scale,0,0,St.scale,0,0),s.save(),this.clipBbox(a,m,U,et,ft),a.baseTransform=(0,it.getCurrentTransform)(a.ctx),a.executeOperatorList(i),a.endDrawing(),{canvas:S.canvas,scaleX:dt.scale,scaleY:St.scale,offsetX:m,offsetY:U}}getSizeAndScale(n,i,d){n=Math.abs(n);const p=Math.max(Wt.MAX_PATTERN_SIZE,i);let o=Math.ceil(n*d);return o>=p?o=p:d=o/n,{scale:d,size:o}}clipBbox(n,i,d,p,o){const h=p-i,g=o-d;n.ctx.rect(i,d,h,g),n.current.updateRectMinMax((0,it.getCurrentTransform)(n.ctx),[i,d,p,o]),n.clip(),n.endPath()}setFillAndStrokeStyleToContext(n,i,d){const p=n.ctx,o=n.current;switch(i){case W.COLORED:const h=this.ctx;p.fillStyle=h.fillStyle,p.strokeStyle=h.strokeStyle,o.fillColor=h.fillStyle,o.strokeColor=h.strokeStyle;break;case W.UNCOLORED:const g=u.Util.makeHexColor(d[0],d[1],d[2]);p.fillStyle=g,p.strokeStyle=g,o.fillColor=g,o.strokeColor=g;break;default:throw new u.FormatError(`Unsupported paint type: ${i}`)}}getPattern(n,i,d,p){let o=d;p!==k.SHADING&&(o=u.Util.transform(o,i.baseTransform),this.matrix&&(o=u.Util.transform(o,this.matrix)));const h=this.createPatternCanvas(i);let g=new DOMMatrix(o);g=g.translate(h.offsetX,h.offsetY),g=g.scale(1/h.scaleX,1/h.scaleY);const w=n.createPattern(h.canvas,"repeat");return w.setTransform(g),w}};let x=Wt;Ae(x,"MAX_PATTERN_SIZE",3e3);function O(M){switch(M.kind){case ImageKind.GRAYSCALE_1BPP:return I(M);case ImageKind.RGB_24BPP:return G(M)}return null}function I({src:M,srcPos:n=0,dest:i,width:d,height:p,nonBlackColor:o=4294967295,inverseDecode:h=!1}){const g=u.FeatureTest.isLittleEndian?4278190080:255,[w,D]=h?[o,g]:[g,o],L=d>>3,J=d&7,tt=M.length;i=new Uint32Array(i.buffer);let ht=0;for(let at=0;at<p;at++){for(const kt=n+L;n<kt;n++){const dt=n<tt?M[n]:255;i[ht++]=dt&128?D:w,i[ht++]=dt&64?D:w,i[ht++]=dt&32?D:w,i[ht++]=dt&16?D:w,i[ht++]=dt&8?D:w,i[ht++]=dt&4?D:w,i[ht++]=dt&2?D:w,i[ht++]=dt&1?D:w}if(J===0)continue;const yt=n<tt?M[n++]:255;for(let kt=0;kt<J;kt++)i[ht++]=yt&1<<7-kt?D:w}return{srcPos:n,destPos:ht}}function G({src:M,srcPos:n=0,dest:i,destPos:d=0,width:p,height:o}){let h=0;const g=M.length>>2,w=new Uint32Array(M.buffer,n,g);if(FeatureTest.isLittleEndian){for(;h<g-2;h+=3,d+=4){const D=w[h],L=w[h+1],J=w[h+2];i[d]=D|4278190080,i[d+1]=D>>>24|L<<8|4278190080,i[d+2]=L>>>16|J<<16|4278190080,i[d+3]=J>>>8|4278190080}for(let D=h*4,L=M.length;D<L;D+=3)i[d++]=M[D]|M[D+1]<<8|M[D+2]<<16|4278190080}else{for(;h<g-2;h+=3,d+=4){const D=w[h],L=w[h+1],J=w[h+2];i[d]=D|255,i[d+1]=D<<24|L>>>8|255,i[d+2]=L<<16|J>>>16|255,i[d+3]=J<<8|255}for(let D=h*4,L=M.length;D<L;D+=3)i[d++]=M[D]<<24|M[D+1]<<16|M[D+2]<<8|255}return{srcPos:n,destPos:d}}function V(M,n){if(FeatureTest.isLittleEndian)for(let i=0,d=M.length;i<d;i++)n[i]=M[i]*65793|4278190080;else for(let i=0,d=M.length;i<d;i++)n[i]=M[i]*16843008|255}const F=16,X=100,C=4096,$=15,st=10,xt=1e3,_=16;function mt(M,n){if(M._removeMirroring)throw new Error("Context is already forwarding operations.");M.__originalSave=M.save,M.__originalRestore=M.restore,M.__originalRotate=M.rotate,M.__originalScale=M.scale,M.__originalTranslate=M.translate,M.__originalTransform=M.transform,M.__originalSetTransform=M.setTransform,M.__originalResetTransform=M.resetTransform,M.__originalClip=M.clip,M.__originalMoveTo=M.moveTo,M.__originalLineTo=M.lineTo,M.__originalBezierCurveTo=M.bezierCurveTo,M.__originalRect=M.rect,M.__originalClosePath=M.closePath,M.__originalBeginPath=M.beginPath,M._removeMirroring=()=>{M.save=M.__originalSave,M.restore=M.__originalRestore,M.rotate=M.__originalRotate,M.scale=M.__originalScale,M.translate=M.__originalTranslate,M.transform=M.__originalTransform,M.setTransform=M.__originalSetTransform,M.resetTransform=M.__originalResetTransform,M.clip=M.__originalClip,M.moveTo=M.__originalMoveTo,M.lineTo=M.__originalLineTo,M.bezierCurveTo=M.__originalBezierCurveTo,M.rect=M.__originalRect,M.closePath=M.__originalClosePath,M.beginPath=M.__originalBeginPath,delete M._removeMirroring},M.save=function(){n.save(),this.__originalSave()},M.restore=function(){n.restore(),this.__originalRestore()},M.translate=function(d,p){n.translate(d,p),this.__originalTranslate(d,p)},M.scale=function(d,p){n.scale(d,p),this.__originalScale(d,p)},M.transform=function(d,p,o,h,g,w){n.transform(d,p,o,h,g,w),this.__originalTransform(d,p,o,h,g,w)},M.setTransform=function(d,p,o,h,g,w){n.setTransform(d,p,o,h,g,w),this.__originalSetTransform(d,p,o,h,g,w)},M.resetTransform=function(){n.resetTransform(),this.__originalResetTransform()},M.rotate=function(d){n.rotate(d),this.__originalRotate(d)},M.clip=function(d){n.clip(d),this.__originalClip(d)},M.moveTo=function(i,d){n.moveTo(i,d),this.__originalMoveTo(i,d)},M.lineTo=function(i,d){n.lineTo(i,d),this.__originalLineTo(i,d)},M.bezierCurveTo=function(i,d,p,o,h,g){n.bezierCurveTo(i,d,p,o,h,g),this.__originalBezierCurveTo(i,d,p,o,h,g)},M.rect=function(i,d,p,o){n.rect(i,d,p,o),this.__originalRect(i,d,p,o)},M.closePath=function(){n.closePath(),this.__originalClosePath()},M.beginPath=function(){n.beginPath(),this.__originalBeginPath()}}class wt{constructor(n){this.canvasFactory=n,this.cache=Object.create(null)}getCanvas(n,i,d){let p;return this.cache[n]!==void 0?(p=this.cache[n],this.canvasFactory.reset(p,i,d)):(p=this.canvasFactory.create(i,d),this.cache[n]=p),p}delete(n){delete this.cache[n]}clear(){for(const n in this.cache){const i=this.cache[n];this.canvasFactory.destroy(i),delete this.cache[n]}}}function Ut(M,n,i,d,p,o,h,g,w,D){const[L,J,tt,ht,at,yt]=(0,it.getCurrentTransform)(M);if(J===0&&tt===0){const St=h*L+at,S=Math.round(St),s=g*ht+yt,a=Math.round(s),m=(h+w)*L+at,U=Math.abs(Math.round(m)-S)||1,et=(g+D)*ht+yt,ft=Math.abs(Math.round(et)-a)||1;return M.setTransform(Math.sign(L),0,0,Math.sign(ht),S,a),M.drawImage(n,i,d,p,o,0,0,U,ft),M.setTransform(L,J,tt,ht,at,yt),[U,ft]}if(L===0&&ht===0){const St=g*tt+at,S=Math.round(St),s=h*J+yt,a=Math.round(s),m=(g+D)*tt+at,U=Math.abs(Math.round(m)-S)||1,et=(h+w)*J+yt,ft=Math.abs(Math.round(et)-a)||1;return M.setTransform(0,Math.sign(J),Math.sign(tt),0,S,a),M.drawImage(n,i,d,p,o,0,0,ft,U),M.setTransform(L,J,tt,ht,at,yt),[ft,U]}M.drawImage(n,i,d,p,o,h,g,w,D);const kt=Math.hypot(L,J),dt=Math.hypot(tt,ht);return[kt*w,dt*D]}function Bt(M){const{width:n,height:i}=M;if(n>xt||i>xt)return null;const d=1e3,p=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=n+1;let h=new Uint8Array(o*(i+1)),g,w,D;const L=n+7&-8;let J=new Uint8Array(L*i),tt=0;for(const dt of M.data){let St=128;for(;St>0;)J[tt++]=dt&St?0:255,St>>=1}let ht=0;for(tt=0,J[tt]!==0&&(h[0]=1,++ht),w=1;w<n;w++)J[tt]!==J[tt+1]&&(h[w]=J[tt]?2:1,++ht),tt++;for(J[tt]!==0&&(h[w]=2,++ht),g=1;g<i;g++){tt=g*L,D=g*o,J[tt-L]!==J[tt]&&(h[D]=J[tt]?1:8,++ht);let dt=(J[tt]?4:0)+(J[tt-L]?8:0);for(w=1;w<n;w++)dt=(dt>>2)+(J[tt+1]?4:0)+(J[tt-L+1]?8:0),p[dt]&&(h[D+w]=p[dt],++ht),tt++;if(J[tt-L]!==J[tt]&&(h[D+w]=J[tt]?2:4,++ht),ht>d)return null}for(tt=L*(i-1),D=g*o,J[tt]!==0&&(h[D]=8,++ht),w=1;w<n;w++)J[tt]!==J[tt+1]&&(h[D+w]=J[tt]?4:8,++ht),tt++;if(J[tt]!==0&&(h[D+w]=4,++ht),ht>d)return null;const at=new Int32Array([0,o,-1,0,-o,0,0,0,1]),yt=new Path2D;for(g=0;ht&&g<=i;g++){let dt=g*o;const St=dt+n;for(;dt<St&&!h[dt];)dt++;if(dt===St)continue;yt.moveTo(dt%o,g);const S=dt;let s=h[dt];do{const a=at[s];do dt+=a;while(!h[dt]);const m=h[dt];m!==5&&m!==10?(s=m,h[dt]=0):(s=m&51*s>>4,h[dt]&=s>>2|s<<2),yt.lineTo(dt%o,dt/o|0),h[dt]||--ht}while(S!==dt);--g}return J=null,h=null,function(dt){dt.save(),dt.scale(1/n,-1/i),dt.translate(0,-i),dt.fill(yt),dt.beginPath(),dt.restore()}}class _t{constructor(n,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=u.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=u.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=u.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,n,i])}clone(){const n=Object.create(this);return n.clipBox=this.clipBox.slice(),n}setCurrentPoint(n,i){this.x=n,this.y=i}updatePathMinMax(n,i,d){[i,d]=u.Util.applyTransform([i,d],n),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,d),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,d)}updateRectMinMax(n,i){const d=u.Util.applyTransform(i,n),p=u.Util.applyTransform(i.slice(2),n),o=u.Util.applyTransform([i[0],i[3]],n),h=u.Util.applyTransform([i[2],i[1]],n);this.minX=Math.min(this.minX,d[0],p[0],o[0],h[0]),this.minY=Math.min(this.minY,d[1],p[1],o[1],h[1]),this.maxX=Math.max(this.maxX,d[0],p[0],o[0],h[0]),this.maxY=Math.max(this.maxY,d[1],p[1],o[1],h[1])}updateScalingPathMinMax(n,i){u.Util.scaleMinMax(n,i),this.minX=Math.min(this.minX,i[0]),this.maxX=Math.max(this.maxX,i[1]),this.minY=Math.min(this.minY,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(n,i,d,p,o,h,g,w,D,L){const J=u.Util.bezierBoundingBox(i,d,p,o,h,g,w,D);if(L){L[0]=Math.min(L[0],J[0],J[2]),L[1]=Math.max(L[1],J[0],J[2]),L[2]=Math.min(L[2],J[1],J[3]),L[3]=Math.max(L[3],J[1],J[3]);return}this.updateRectMinMax(n,J)}getPathBoundingBox(n=k.FILL,i=null){const d=[this.minX,this.minY,this.maxX,this.maxY];if(n===k.STROKE){i||(0,u.unreachable)("Stroke bounding box must include transform.");const p=u.Util.singularValueDecompose2dScale(i),o=p[0]*this.lineWidth/2,h=p[1]*this.lineWidth/2;d[0]-=o,d[1]-=h,d[2]+=o,d[3]+=h}return d}updateClipFromPath(){const n=u.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(n||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(n){this.clipBox=n,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(n=k.FILL,i=null){return u.Util.intersect(this.clipBox,this.getPathBoundingBox(n,i))}}function Kt(M,n){if(typeof ImageData!="undefined"&&n instanceof ImageData){M.putImageData(n,0,0);return}const i=n.height,d=n.width,p=i%_,o=(i-p)/_,h=p===0?o:o+1,g=M.createImageData(d,_);let w=0,D;const L=n.data,J=g.data;let tt,ht,at,yt;if(n.kind===u.ImageKind.GRAYSCALE_1BPP){const kt=L.byteLength,dt=new Uint32Array(J.buffer,0,J.byteLength>>2),St=dt.length,S=d+7>>3,s=4294967295,a=u.FeatureTest.isLittleEndian?4278190080:255;for(tt=0;tt<h;tt++){for(at=tt<o?_:p,D=0,ht=0;ht<at;ht++){const m=kt-w;let U=0;const et=m>S?d:m*8-7,ft=et&-8;let Tt=0,Ft=0;for(;U<ft;U+=8)Ft=L[w++],dt[D++]=Ft&128?s:a,dt[D++]=Ft&64?s:a,dt[D++]=Ft&32?s:a,dt[D++]=Ft&16?s:a,dt[D++]=Ft&8?s:a,dt[D++]=Ft&4?s:a,dt[D++]=Ft&2?s:a,dt[D++]=Ft&1?s:a;for(;U<et;U++)Tt===0&&(Ft=L[w++],Tt=128),dt[D++]=Ft&Tt?s:a,Tt>>=1}for(;D<St;)dt[D++]=0;M.putImageData(g,0,tt*_)}}else if(n.kind===u.ImageKind.RGBA_32BPP){for(ht=0,yt=d*_*4,tt=0;tt<o;tt++)J.set(L.subarray(w,w+yt)),w+=yt,M.putImageData(g,0,ht),ht+=_;tt<h&&(yt=d*p*4,J.set(L.subarray(w,w+yt)),M.putImageData(g,0,ht))}else if(n.kind===u.ImageKind.RGB_24BPP)for(at=_,yt=d*at,tt=0;tt<h;tt++){for(tt>=o&&(at=p,yt=d*at),D=0,ht=yt;ht--;)J[D++]=L[w++],J[D++]=L[w++],J[D++]=L[w++],J[D++]=255;M.putImageData(g,0,tt*_)}else throw new Error(`bad image kind: ${n.kind}`)}function Fe(M,n){if(n.bitmap){M.drawImage(n.bitmap,0,0);return}const i=n.height,d=n.width,p=i%_,o=(i-p)/_,h=p===0?o:o+1,g=M.createImageData(d,_);let w=0;const D=n.data,L=g.data;for(let J=0;J<h;J++){const tt=J<o?_:p;({srcPos:w}=I({src:D,srcPos:w,dest:L,width:d,height:tt,nonBlackColor:0})),M.putImageData(g,0,J*_)}}function Yt(M,n){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const d of i)M[d]!==void 0&&(n[d]=M[d]);M.setLineDash!==void 0&&(n.setLineDash(M.getLineDash()),n.lineDashOffset=M.lineDashOffset)}function Jt(M){if(M.strokeStyle=M.fillStyle="#000000",M.fillRule="nonzero",M.globalAlpha=1,M.lineWidth=1,M.lineCap="butt",M.lineJoin="miter",M.miterLimit=10,M.globalCompositeOperation="source-over",M.font="10px sans-serif",M.setLineDash!==void 0&&(M.setLineDash([]),M.lineDashOffset=0),!u.isNodeJS){const{filter:n}=M;n!=="none"&&n!==""&&(M.filter="none")}}function fe(M,n,i,d){const p=M.length;for(let o=3;o<p;o+=4){const h=M[o];if(h===0)M[o-3]=n,M[o-2]=i,M[o-1]=d;else if(h<255){const g=255-h;M[o-3]=M[o-3]*h+n*g>>8,M[o-2]=M[o-2]*h+i*g>>8,M[o-1]=M[o-1]*h+d*g>>8}}}function ne(M,n,i){const d=M.length,p=1/255;for(let o=3;o<d;o+=4){const h=i?i[M[o]]:M[o];n[o]=n[o]*h*p|0}}function Xt(M,n,i){const d=M.length;for(let p=3;p<d;p+=4){const o=M[p-3]*77+M[p-2]*152+M[p-1]*28;n[p]=i?n[p]*i[o>>8]>>8:n[p]*o>>16}}function te(M,n,i,d,p,o,h,g,w,D,L){const J=!!o,tt=J?o[0]:0,ht=J?o[1]:0,at=J?o[2]:0,yt=p==="Luminosity"?Xt:ne,dt=Math.min(d,Math.ceil(1048576/i));for(let St=0;St<d;St+=dt){const S=Math.min(dt,d-St),s=M.getImageData(g-D,St+(w-L),i,S),a=n.getImageData(g,St+w,i,S);J&&fe(s.data,tt,ht,at),yt(s.data,a.data,h),n.putImageData(a,g,St+w)}}function Gt(M,n,i,d){const p=d[0],o=d[1],h=d[2]-p,g=d[3]-o;h===0||g===0||(te(n.context,i,h,g,n.subtype,n.backdrop,n.transferMap,p,o,n.offsetX,n.offsetY),M.save(),M.globalAlpha=1,M.globalCompositeOperation="source-over",M.setTransform(1,0,0,1,0,0),M.drawImage(i.canvas,0,0),M.restore())}function se(M,n){const i=u.Util.singularValueDecompose2dScale(M);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const d=Math.fround((globalThis.devicePixelRatio||1)*it.PixelsPerInch.PDF_TO_CSS_UNITS);return n!==void 0?n:i[0]<=d||i[1]<=d}const le=["butt","round","square"],ee=["miter","round","bevel"],qt={},he={},ke=class{constructor(n,i,d,p,o,{optionalContentConfig:h,markedContentStack:g=null},w,D){f(this,ae);f(this,xe);this.ctx=n,this.current=new _t(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=d,this.canvasFactory=p,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=g||[],this.optionalContentConfig=h,this.cachedCanvases=new wt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=w,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=D,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(n,i=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):i}beginDrawing({transform:n,viewport:i,transparency:d=!1,background:p=null}){const o=this.ctx.canvas.width,h=this.ctx.canvas.height,g=this.ctx.fillStyle;if(this.ctx.fillStyle=p||"#ffffff",this.ctx.fillRect(0,0,o,h),this.ctx.fillStyle=g,d){const w=this.cachedCanvases.getCanvas("transparent",o,h);this.compositeCtx=this.ctx,this.transparentCanvas=w.canvas,this.ctx=w.context,this.ctx.save(),this.ctx.transform(...(0,it.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Jt(this.ctx),n&&(this.ctx.transform(...n),this.outputScaleX=n[0],this.outputScaleY=n[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=(0,it.getCurrentTransform)(this.ctx)}executeOperatorList(n,i,d,p){const o=n.argsArray,h=n.fnArray;let g=i||0;const w=o.length;if(w===g)return g;const D=w-g>st&&typeof d=="function",L=D?Date.now()+$:0;let J=0;const tt=this.commonObjs,ht=this.objs;let at;for(;;){if(p!==void 0&&g===p.nextBreakPoint)return p.breakIt(g,d),g;if(at=h[g],at!==u.OPS.dependency)this[at].apply(this,o[g]);else for(const yt of o[g]){const kt=yt.startsWith("g_")?tt:ht;if(!kt.has(yt))return kt.get(yt,d),g}if(g++,g===w)return g;if(D&&++J>st){if(Date.now()>L)return d(),g;J=0}}}endDrawing(){E(this,ae,Xs).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const n of this._cachedBitmapsMap.values()){for(const i of n.values())typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);n.clear()}this._cachedBitmapsMap.clear(),E(this,xe,Vs).call(this)}_scaleImage(n,i){const d=n.width,p=n.height;let o=Math.max(Math.hypot(i[0],i[1]),1),h=Math.max(Math.hypot(i[2],i[3]),1),g=d,w=p,D="prescale1",L,J;for(;o>2&&g>1||h>2&&w>1;){let tt=g,ht=w;o>2&&g>1&&(tt=g>=16384?Math.floor(g/2)-1||1:Math.ceil(g/2),o/=g/tt),h>2&&w>1&&(ht=w>=16384?Math.floor(w/2)-1||1:Math.ceil(w)/2,h/=w/ht),L=this.cachedCanvases.getCanvas(D,tt,ht),J=L.context,J.clearRect(0,0,tt,ht),J.drawImage(n,0,0,g,w,0,0,tt,ht),n=L.canvas,g=tt,w=ht,D=D==="prescale1"?"prescale2":"prescale1"}return{img:n,paintWidth:g,paintHeight:w}}_createMaskCanvas(n){const i=this.ctx,{width:d,height:p}=n,o=this.current.fillColor,h=this.current.patternFill,g=(0,it.getCurrentTransform)(i);let w,D,L,J;if((n.bitmap||n.data)&&n.count>1){const et=n.bitmap||n.data.buffer;D=JSON.stringify(h?g:[g.slice(0,4),o]),w=this._cachedBitmapsMap.get(et),w||(w=new Map,this._cachedBitmapsMap.set(et,w));const ft=w.get(D);if(ft&&!h){const Tt=Math.round(Math.min(g[0],g[2])+g[4]),Ft=Math.round(Math.min(g[1],g[3])+g[5]);return{canvas:ft,offsetX:Tt,offsetY:Ft}}L=ft}L||(J=this.cachedCanvases.getCanvas("maskCanvas",d,p),Fe(J.context,n));let tt=u.Util.transform(g,[1/d,0,0,-1/p,0,0]);tt=u.Util.transform(tt,[1,0,0,1,0,-p]);const[ht,at,yt,kt]=u.Util.getAxialAlignedBoundingBox([0,0,d,p],tt),dt=Math.round(yt-ht)||1,St=Math.round(kt-at)||1,S=this.cachedCanvases.getCanvas("fillCanvas",dt,St),s=S.context,a=ht,m=at;s.translate(-a,-m),s.transform(...tt),L||(L=this._scaleImage(J.canvas,(0,it.getCurrentTransformInverse)(s)),L=L.img,w&&h&&w.set(D,L)),s.imageSmoothingEnabled=se((0,it.getCurrentTransform)(s),n.interpolate),Ut(s,L,0,0,L.width,L.height,0,0,d,p),s.globalCompositeOperation="source-in";const U=u.Util.transform((0,it.getCurrentTransformInverse)(s),[1,0,0,1,-a,-m]);return s.fillStyle=h?o.getPattern(i,this,U,k.FILL):o,s.fillRect(0,0,d,p),w&&!h&&(this.cachedCanvases.delete("fillCanvas"),w.set(D,S.canvas)),{canvas:S.canvas,offsetX:Math.round(a),offsetY:Math.round(m)}}setLineWidth(n){n!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=n,this.ctx.lineWidth=n}setLineCap(n){this.ctx.lineCap=le[n]}setLineJoin(n){this.ctx.lineJoin=ee[n]}setMiterLimit(n){this.ctx.miterLimit=n}setDash(n,i){const d=this.ctx;d.setLineDash!==void 0&&(d.setLineDash(n),d.lineDashOffset=i)}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[i,d]of n)switch(i){case"LW":this.setLineWidth(d);break;case"LC":this.setLineCap(d);break;case"LJ":this.setLineJoin(d);break;case"ML":this.setMiterLimit(d);break;case"D":this.setDash(d[0],d[1]);break;case"RI":this.setRenderingIntent(d);break;case"FL":this.setFlatness(d);break;case"Font":this.setFont(d[0],d[1]);break;case"CA":this.current.strokeAlpha=d;break;case"ca":this.current.fillAlpha=d,this.ctx.globalAlpha=d;break;case"BM":this.ctx.globalCompositeOperation=d;break;case"SMask":this.current.activeSMask=d?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(d);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const n=this.inSMaskMode;this.current.activeSMask&&!n?this.beginSMaskMode():!this.current.activeSMask&&n&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const n=this.ctx.canvas.width,i=this.ctx.canvas.height,d="smaskGroupAt"+this.groupLevel,p=this.cachedCanvases.getCanvas(d,n,i);this.suspendedCtx=this.ctx,this.ctx=p.context;const o=this.ctx;o.setTransform(...(0,it.getCurrentTransform)(this.suspendedCtx)),Yt(this.suspendedCtx,o),mt(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Yt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(n){if(!this.current.activeSMask)return;n?(n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n[2]=Math.ceil(n[2]),n[3]=Math.ceil(n[3])):n=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,d=this.suspendedCtx;Gt(d,i,this.ctx,n),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Yt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Yt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(n,i,d,p,o,h){this.ctx.transform(n,i,d,p,o,h),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(n,i,d){const p=this.ctx,o=this.current;let h=o.x,g=o.y,w,D;const L=(0,it.getCurrentTransform)(p),J=L[0]===0&&L[3]===0||L[1]===0&&L[2]===0,tt=J?d.slice(0):null;for(let ht=0,at=0,yt=n.length;ht<yt;ht++)switch(n[ht]|0){case u.OPS.rectangle:h=i[at++],g=i[at++];const kt=i[at++],dt=i[at++],St=h+kt,S=g+dt;p.moveTo(h,g),kt===0||dt===0?p.lineTo(St,S):(p.lineTo(St,g),p.lineTo(St,S),p.lineTo(h,S)),J||o.updateRectMinMax(L,[h,g,St,S]),p.closePath();break;case u.OPS.moveTo:h=i[at++],g=i[at++],p.moveTo(h,g),J||o.updatePathMinMax(L,h,g);break;case u.OPS.lineTo:h=i[at++],g=i[at++],p.lineTo(h,g),J||o.updatePathMinMax(L,h,g);break;case u.OPS.curveTo:w=h,D=g,h=i[at+4],g=i[at+5],p.bezierCurveTo(i[at],i[at+1],i[at+2],i[at+3],h,g),o.updateCurvePathMinMax(L,w,D,i[at],i[at+1],i[at+2],i[at+3],h,g,tt),at+=6;break;case u.OPS.curveTo2:w=h,D=g,p.bezierCurveTo(h,g,i[at],i[at+1],i[at+2],i[at+3]),o.updateCurvePathMinMax(L,w,D,h,g,i[at],i[at+1],i[at+2],i[at+3],tt),h=i[at+2],g=i[at+3],at+=4;break;case u.OPS.curveTo3:w=h,D=g,h=i[at+2],g=i[at+3],p.bezierCurveTo(i[at],i[at+1],h,g,h,g),o.updateCurvePathMinMax(L,w,D,i[at],i[at+1],h,g,h,g,tt),at+=4;break;case u.OPS.closePath:p.closePath();break}J&&o.updateScalingPathMinMax(L,tt),o.setCurrentPoint(h,g)}closePath(){this.ctx.closePath()}stroke(n=!0){const i=this.ctx,d=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof d=="object"&&(d!=null&&d.getPattern)?(i.save(),i.strokeStyle=d.getPattern(i,this,(0,it.getCurrentTransformInverse)(i),k.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),n&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(n=!0){const i=this.ctx,d=this.current.fillColor,p=this.current.patternFill;let o=!1;p&&(i.save(),i.fillStyle=d.getPattern(i,this,(0,it.getCurrentTransformInverse)(i),k.FILL),o=!0);const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),o&&i.restore(),n&&this.consumePath(h)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=qt}eoClip(){this.pendingClip=he}beginText(){this.current.textMatrix=u.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const n=this.pendingTextPaths,i=this.ctx;if(n===void 0){i.beginPath();return}i.save(),i.beginPath();for(const d of n)i.setTransform(...d.transform),i.translate(d.x,d.y),d.addToPath(i,d.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(n){this.current.charSpacing=n}setWordSpacing(n){this.current.wordSpacing=n}setHScale(n){this.current.textHScale=n/100}setLeading(n){this.current.leading=-n}setFont(n,i){var L;const d=this.commonObjs.get(n),p=this.current;if(!d)throw new Error(`Can't find font for ${n}`);if(p.fontMatrix=d.fontMatrix||u.FONT_IDENTITY_MATRIX,(p.fontMatrix[0]===0||p.fontMatrix[3]===0)&&(0,u.warn)("Invalid font matrix for font "+n),i<0?(i=-i,p.fontDirection=-1):p.fontDirection=1,this.current.font=d,this.current.fontSize=i,d.isType3Font)return;const o=d.loadedName||"sans-serif",h=((L=d.systemFontInfo)==null?void 0:L.css)||`"${o}", ${d.fallbackName}`;let g="normal";d.black?g="900":d.bold&&(g="bold");const w=d.italic?"italic":"normal";let D=i;i<F?D=F:i>X&&(D=X),this.current.fontSizeScale=i/D,this.ctx.font=`${w} ${g} ${D}px ${h}`}setTextRenderingMode(n){this.current.textRenderingMode=n}setTextRise(n){this.current.textRise=n}moveText(n,i){this.current.x=this.current.lineX+=n,this.current.y=this.current.lineY+=i}setLeadingMoveText(n,i){this.setLeading(-i),this.moveText(n,i)}setTextMatrix(n,i,d,p,o,h){this.current.textMatrix=[n,i,d,p,o,h],this.current.textMatrixScale=Math.hypot(n,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(n,i,d,p){const o=this.ctx,h=this.current,g=h.font,w=h.textRenderingMode,D=h.fontSize/h.fontSizeScale,L=w&u.TextRenderingMode.FILL_STROKE_MASK,J=!!(w&u.TextRenderingMode.ADD_TO_PATH_FLAG),tt=h.patternFill&&!g.missingFile;let ht;(g.disableFontFace||J||tt)&&(ht=g.getPathGenerator(this.commonObjs,n)),g.disableFontFace||tt?(o.save(),o.translate(i,d),o.beginPath(),ht(o,D),p&&o.setTransform(...p),(L===u.TextRenderingMode.FILL||L===u.TextRenderingMode.FILL_STROKE)&&o.fill(),(L===u.TextRenderingMode.STROKE||L===u.TextRenderingMode.FILL_STROKE)&&o.stroke(),o.restore()):((L===u.TextRenderingMode.FILL||L===u.TextRenderingMode.FILL_STROKE)&&o.fillText(n,i,d),(L===u.TextRenderingMode.STROKE||L===u.TextRenderingMode.FILL_STROKE)&&o.strokeText(n,i,d)),J&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,it.getCurrentTransform)(o),x:i,y:d,fontSize:D,addToPath:ht})}get isFontSubpixelAAEnabled(){const{context:n}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);n.scale(1.5,1),n.fillText("I",0,10);const i=n.getImageData(0,0,10,10).data;let d=!1;for(let p=3;p<i.length;p+=4)if(i[p]>0&&i[p]<255){d=!0;break}return(0,u.shadow)(this,"isFontSubpixelAAEnabled",d)}showText(n){const i=this.current,d=i.font;if(d.isType3Font)return this.showType3Text(n);const p=i.fontSize;if(p===0)return;const o=this.ctx,h=i.fontSizeScale,g=i.charSpacing,w=i.wordSpacing,D=i.fontDirection,L=i.textHScale*D,J=n.length,tt=d.vertical,ht=tt?1:-1,at=d.defaultVMetrics,yt=p*i.fontMatrix[0],kt=i.textRenderingMode===u.TextRenderingMode.FILL&&!d.disableFontFace&&!i.patternFill;o.save(),o.transform(...i.textMatrix),o.translate(i.x,i.y+i.textRise),D>0?o.scale(L,-1):o.scale(L,1);let dt;if(i.patternFill){o.save();const m=i.fillColor.getPattern(o,this,(0,it.getCurrentTransformInverse)(o),k.FILL);dt=(0,it.getCurrentTransform)(o),o.restore(),o.fillStyle=m}let St=i.lineWidth;const S=i.textMatrixScale;if(S===0||St===0){const m=i.textRenderingMode&u.TextRenderingMode.FILL_STROKE_MASK;(m===u.TextRenderingMode.STROKE||m===u.TextRenderingMode.FILL_STROKE)&&(St=this.getSinglePixelWidth())}else St/=S;if(h!==1&&(o.scale(h,h),St/=h),o.lineWidth=St,d.isInvalidPDFjsFont){const m=[];let U=0;for(const et of n)m.push(et.unicode),U+=et.width;o.fillText(m.join(""),0,0),i.x+=U*yt*L,o.restore(),this.compose();return}let s=0,a;for(a=0;a<J;++a){const m=n[a];if(typeof m=="number"){s+=ht*m*p/1e3;continue}let U=!1;const et=(m.isSpace?w:0)+g,ft=m.fontChar,Tt=m.accent;let Ft,jt,Vt=m.width;if(tt){const Ht=m.vmetric||at,y=-(m.vmetric?Ht[1]:Vt*.5)*yt,Y=Ht[2]*yt;Vt=Ht?-Ht[0]:Vt,Ft=y/h,jt=(s+Y)/h}else Ft=s/h,jt=0;if(d.remeasure&&Vt>0){const Ht=o.measureText(ft).width*1e3/p*h;if(Vt<Ht&&this.isFontSubpixelAAEnabled){const y=Vt/Ht;U=!0,o.save(),o.scale(y,1),Ft/=y}else Vt!==Ht&&(Ft+=(Vt-Ht)/2e3*p/h)}if(this.contentVisible&&(m.isInFont||d.missingFile)){if(kt&&!Tt)o.fillText(ft,Ft,jt);else if(this.paintChar(ft,Ft,jt,dt),Tt){const Ht=Ft+p*Tt.offset.x/h,y=jt-p*Tt.offset.y/h;this.paintChar(Tt.fontChar,Ht,y,dt)}}const Dt=tt?Vt*yt-et*D:Vt*yt+et*D;s+=Dt,U&&o.restore()}tt?i.y-=s:i.x+=s*L,o.restore(),this.compose()}showType3Text(n){const i=this.ctx,d=this.current,p=d.font,o=d.fontSize,h=d.fontDirection,g=p.vertical?1:-1,w=d.charSpacing,D=d.wordSpacing,L=d.textHScale*h,J=d.fontMatrix||u.FONT_IDENTITY_MATRIX,tt=n.length,ht=d.textRenderingMode===u.TextRenderingMode.INVISIBLE;let at,yt,kt,dt;if(!(ht||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...d.textMatrix),i.translate(d.x,d.y),i.scale(L,h),at=0;at<tt;++at){if(yt=n[at],typeof yt=="number"){dt=g*yt*o/1e3,this.ctx.translate(dt,0),d.x+=dt*L;continue}const St=(yt.isSpace?D:0)+w,S=p.charProcOperatorList[yt.operatorListId];if(!S){(0,u.warn)(`Type3 character "${yt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=yt,this.save(),i.scale(o,o),i.transform(...J),this.executeOperatorList(S),this.restore()),kt=u.Util.applyTransform([yt.width,0],J)[0]*o+St,i.translate(kt,0),d.x+=kt*L}i.restore(),this.processingType3=null}}setCharWidth(n,i){}setCharWidthAndBounds(n,i,d,p,o,h){this.ctx.rect(d,p,o-d,h-p),this.ctx.clip(),this.endPath()}getColorN_Pattern(n){let i;if(n[0]==="TilingPattern"){const d=n[1],p=this.baseTransform||(0,it.getCurrentTransform)(this.ctx),o={createCanvasGraphics:h=>new ke(h,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new x(n,d,this.ctx,o,p)}else i=this._getPattern(n[1],n[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(n,i,d){const p=u.Util.makeHexColor(n,i,d);this.ctx.strokeStyle=p,this.current.strokeColor=p}setFillRGBColor(n,i,d){const p=u.Util.makeHexColor(n,i,d);this.ctx.fillStyle=p,this.current.fillColor=p,this.current.patternFill=!1}_getPattern(n,i=null){let d;return this.cachedPatterns.has(n)?d=this.cachedPatterns.get(n):(d=T(this.getObject(n)),this.cachedPatterns.set(n,d)),i&&(d.matrix=i),d}shadingFill(n){if(!this.contentVisible)return;const i=this.ctx;this.save();const d=this._getPattern(n);i.fillStyle=d.getPattern(i,this,(0,it.getCurrentTransformInverse)(i),k.SHADING);const p=(0,it.getCurrentTransformInverse)(i);if(p){const{width:o,height:h}=i.canvas,[g,w,D,L]=u.Util.getAxialAlignedBoundingBox([0,0,o,h],p);this.ctx.fillRect(g,w,D-g,L-w)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,u.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,u.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(n,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(n)&&n.length===6&&this.transform(...n),this.baseTransform=(0,it.getCurrentTransform)(this.ctx),i)){const d=i[2]-i[0],p=i[3]-i[1];this.ctx.rect(i[0],i[1],d,p),this.current.updateRectMinMax((0,it.getCurrentTransform)(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(n){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;n.isolated||(0,u.info)("TODO: Support non-isolated groups."),n.knockout&&(0,u.warn)("Knockout groups not supported.");const d=(0,it.getCurrentTransform)(i);if(n.matrix&&i.transform(...n.matrix),!n.bbox)throw new Error("Bounding box is required.");let p=u.Util.getAxialAlignedBoundingBox(n.bbox,(0,it.getCurrentTransform)(i));const o=[0,0,i.canvas.width,i.canvas.height];p=u.Util.intersect(p,o)||[0,0,0,0];const h=Math.floor(p[0]),g=Math.floor(p[1]);let w=Math.max(Math.ceil(p[2])-h,1),D=Math.max(Math.ceil(p[3])-g,1),L=1,J=1;w>C&&(L=w/C,w=C),D>C&&(J=D/C,D=C),this.current.startNewPathAndClipBox([0,0,w,D]);let tt="groupAt"+this.groupLevel;n.smask&&(tt+="_smask_"+this.smaskCounter++%2);const ht=this.cachedCanvases.getCanvas(tt,w,D),at=ht.context;at.scale(1/L,1/J),at.translate(-h,-g),at.transform(...d),n.smask?this.smaskStack.push({canvas:ht.canvas,context:at,offsetX:h,offsetY:g,scaleX:L,scaleY:J,subtype:n.smask.subtype,backdrop:n.smask.backdrop,transferMap:n.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(h,g),i.scale(L,J),i.save()),Yt(i,at),this.ctx=at,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(n){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,d=this.groupStack.pop();if(this.ctx=d,this.ctx.imageSmoothingEnabled=!1,n.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const p=(0,it.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...p);const o=u.Util.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],p);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(n,i,d,p,o){if(E(this,ae,Xs).call(this),Jt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(i)&&i.length===4){const h=i[2]-i[0],g=i[3]-i[1];if(o&&this.annotationCanvasMap){d=d.slice(),d[4]-=i[0],d[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=h,i[3]=g;const[w,D]=u.Util.singularValueDecompose2dScale((0,it.getCurrentTransform)(this.ctx)),{viewportScale:L}=this,J=Math.ceil(h*this.outputScaleX*L),tt=Math.ceil(g*this.outputScaleY*L);this.annotationCanvas=this.canvasFactory.create(J,tt);const{canvas:ht,context:at}=this.annotationCanvas;this.annotationCanvasMap.set(n,ht),this.annotationCanvas.savedCtx=this.ctx,this.ctx=at,this.ctx.save(),this.ctx.setTransform(w,0,0,-D,0,g*D),Jt(this.ctx)}else Jt(this.ctx),this.ctx.rect(i[0],i[1],h,g),this.ctx.clip(),this.endPath()}this.current=new _t(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...d),this.transform(...p)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),E(this,xe,Vs).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(n){if(!this.contentVisible)return;const i=n.count;n=this.getObject(n.data,n),n.count=i;const d=this.ctx,p=this.processingType3;if(p&&(p.compiled===void 0&&(p.compiled=Bt(n)),p.compiled)){p.compiled(d);return}const o=this._createMaskCanvas(n),h=o.canvas;d.save(),d.setTransform(1,0,0,1,0,0),d.drawImage(h,o.offsetX,o.offsetY),d.restore(),this.compose()}paintImageMaskXObjectRepeat(n,i,d=0,p=0,o,h){if(!this.contentVisible)return;n=this.getObject(n.data,n);const g=this.ctx;g.save();const w=(0,it.getCurrentTransform)(g);g.transform(i,d,p,o,0,0);const D=this._createMaskCanvas(n);g.setTransform(1,0,0,1,D.offsetX-w[4],D.offsetY-w[5]);for(let L=0,J=h.length;L<J;L+=2){const tt=u.Util.transform(w,[i,d,p,o,h[L],h[L+1]]),[ht,at]=u.Util.applyTransform([0,0],tt);g.drawImage(D.canvas,ht,at)}g.restore(),this.compose()}paintImageMaskXObjectGroup(n){if(!this.contentVisible)return;const i=this.ctx,d=this.current.fillColor,p=this.current.patternFill;for(const o of n){const{data:h,width:g,height:w,transform:D}=o,L=this.cachedCanvases.getCanvas("maskCanvas",g,w),J=L.context;J.save();const tt=this.getObject(h,o);Fe(J,tt),J.globalCompositeOperation="source-in",J.fillStyle=p?d.getPattern(J,this,(0,it.getCurrentTransformInverse)(i),k.FILL):d,J.fillRect(0,0,g,w),J.restore(),i.save(),i.transform(...D),i.scale(1,-1),Ut(i,L.canvas,0,0,g,w,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(n){if(!this.contentVisible)return;const i=this.getObject(n);if(!i){(0,u.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(n,i,d,p){if(!this.contentVisible)return;const o=this.getObject(n);if(!o){(0,u.warn)("Dependent image isn't ready yet");return}const h=o.width,g=o.height,w=[];for(let D=0,L=p.length;D<L;D+=2)w.push({transform:[i,0,0,d,p[D],p[D+1]],x:0,y:0,w:h,h:g});this.paintInlineImageXObjectGroup(o,w)}applyTransferMapsToCanvas(n){return this.current.transferMaps!=="none"&&(n.filter=this.current.transferMaps,n.drawImage(n.canvas,0,0),n.filter="none"),n.canvas}applyTransferMapsToBitmap(n){if(this.current.transferMaps==="none")return n.bitmap;const{bitmap:i,width:d,height:p}=n,o=this.cachedCanvases.getCanvas("inlineImage",d,p),h=o.context;return h.filter=this.current.transferMaps,h.drawImage(i,0,0),h.filter="none",o.canvas}paintInlineImageXObject(n){if(!this.contentVisible)return;const i=n.width,d=n.height,p=this.ctx;if(this.save(),!u.isNodeJS){const{filter:g}=p;g!=="none"&&g!==""&&(p.filter="none")}p.scale(1/i,-1/d);let o;if(n.bitmap)o=this.applyTransferMapsToBitmap(n);else if(typeof HTMLElement=="function"&&n instanceof HTMLElement||!n.data)o=n;else{const w=this.cachedCanvases.getCanvas("inlineImage",i,d).context;Kt(w,n),o=this.applyTransferMapsToCanvas(w)}const h=this._scaleImage(o,(0,it.getCurrentTransformInverse)(p));p.imageSmoothingEnabled=se((0,it.getCurrentTransform)(p),n.interpolate),Ut(p,h.img,0,0,h.paintWidth,h.paintHeight,0,-d,i,d),this.compose(),this.restore()}paintInlineImageXObjectGroup(n,i){if(!this.contentVisible)return;const d=this.ctx;let p;if(n.bitmap)p=n.bitmap;else{const o=n.width,h=n.height,w=this.cachedCanvases.getCanvas("inlineImage",o,h).context;Kt(w,n),p=this.applyTransferMapsToCanvas(w)}for(const o of i)d.save(),d.transform(...o.transform),d.scale(1,-1),Ut(d,p,o.x,o.y,o.w,o.h,0,-1,1,1),d.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(n){}markPointProps(n,i){}beginMarkedContent(n){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(n,i){n==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const d=this.ctx;this.pendingClip&&(i||(this.pendingClip===he?d.clip("evenodd"):d.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),d.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const n=(0,it.getCurrentTransform)(this.ctx);if(n[1]===0&&n[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(n[0]),Math.abs(n[3]));else{const i=Math.abs(n[0]*n[3]-n[2]*n[1]),d=Math.hypot(n[0],n[2]),p=Math.hypot(n[1],n[3]);this._cachedGetSinglePixelWidth=Math.max(d,p)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:n}=this.current,{a:i,b:d,c:p,d:o}=this.ctx.getTransform();let h,g;if(d===0&&p===0){const w=Math.abs(i),D=Math.abs(o);if(w===D)if(n===0)h=g=1/w;else{const L=w*n;h=g=L<1?1/L:1}else if(n===0)h=1/w,g=1/D;else{const L=w*n,J=D*n;h=L<1?1/L:1,g=J<1?1/J:1}}else{const w=Math.abs(i*o-d*p),D=Math.hypot(i,d),L=Math.hypot(p,o);if(n===0)h=L/w,g=D/w;else{const J=n*w;h=L>J?L/J:1,g=D>J?D/J:1}}this._cachedScaleForStroking[0]=h,this._cachedScaleForStroking[1]=g}return this._cachedScaleForStroking}rescaleAndStroke(n){const{ctx:i}=this,{lineWidth:d}=this.current,[p,o]=this.getScaleForStroking();if(i.lineWidth=d||1,p===1&&o===1){i.stroke();return}const h=i.getLineDash();if(n&&i.save(),i.scale(p,o),h.length>0){const g=Math.max(p,o);i.setLineDash(h.map(w=>w/g)),i.lineDashOffset/=g}i.stroke(),n&&i.restore()}isContentVisible(){for(let n=this.markedContentStack.length-1;n>=0;n--)if(!this.markedContentStack[n].visible)return!1;return!0}};let ge=ke;ae=new WeakSet,Xs=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},xe=new WeakSet,Vs=function(){if(this.pageColors){const n=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(n!=="none"){const i=this.ctx.filter;this.ctx.filter=n,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}};for(const M in u.OPS)ge.prototype[M]!==void 0&&(ge.prototype[u.OPS[M]]=ge.prototype[M])},473:(ie,Nt,rt)=>{var Kt,Fe,Yt,Jt,fe,ne,Xt,te,Gt,se,le,ee,ki,he,Pi,Wt,$s,we,vs,Ce,ys,M,Ki,i,Qi;rt.d(Nt,{DOMCMapReaderFactory:()=>A,DOMCanvasFactory:()=>Q,DOMFilterFactory:()=>lt,DOMSVGFactory:()=>N,DOMStandardFontDataFactory:()=>z,PDFDateString:()=>st,PageViewport:()=>T,PixelsPerInch:()=>q,RenderingCancelledException:()=>W,StatTimer:()=>V,fetchData:()=>H,getColorValues:()=>mt,getCurrentTransform:()=>wt,getCurrentTransformInverse:()=>Ut,getFilenameFromUrl:()=>I,getPdfFilenameFromUrl:()=>G,getRGB:()=>_,getXfaPageViewport:()=>xt,isDataScheme:()=>x,isPdfFile:()=>O,isValidFetchUrl:()=>F,noContextMenu:()=>X,setLayerDimensions:()=>Bt});var u=rt(822),it=rt(266);const k="http://www.w3.org/2000/svg",_t=class{};let q=_t;Ae(q,"CSS",96),Ae(q,"PDF",72),Ae(q,"PDF_TO_CSS_UNITS",_t.CSS/_t.PDF);class lt extends u.BaseFilterFactory{constructor({docId:h,ownerDocument:g=globalThis.document}={}){super();f(this,ee);f(this,he);f(this,Wt);f(this,we);f(this,Ce);f(this,M);f(this,i);f(this,Kt,void 0);f(this,Fe,void 0);f(this,Yt,void 0);f(this,Jt,void 0);f(this,fe,void 0);f(this,ne,void 0);f(this,Xt,void 0);f(this,te,void 0);f(this,Gt,void 0);f(this,se,void 0);f(this,le,0);P(this,Yt,h),P(this,Jt,g)}addFilter(h){if(!h)return"none";let g=t(this,ee,ki).get(h);if(g)return g;let w,D,L,J;if(h.length===1){const yt=h[0],kt=new Array(256);for(let dt=0;dt<256;dt++)kt[dt]=yt[dt]/255;J=w=D=L=kt.join(",")}else{const[yt,kt,dt]=h,St=new Array(256),S=new Array(256),s=new Array(256);for(let a=0;a<256;a++)St[a]=yt[a]/255,S[a]=kt[a]/255,s[a]=dt[a]/255;w=St.join(","),D=S.join(","),L=s.join(","),J=`${w}${D}${L}`}if(g=t(this,ee,ki).get(J),g)return t(this,ee,ki).set(h,g),g;const tt=`g_${t(this,Yt)}_transfer_map_${ii(this,le)._++}`,ht=`url(#${tt})`;t(this,ee,ki).set(h,ht),t(this,ee,ki).set(J,ht);const at=E(this,we,vs).call(this,tt);return E(this,M,Ki).call(this,w,D,L,at),ht}addHCMFilter(h,g){var kt;const w=`${h}-${g}`;if(t(this,ne)===w)return t(this,Xt);if(P(this,ne,w),P(this,Xt,"none"),(kt=t(this,fe))==null||kt.remove(),!h||!g)return t(this,Xt);const D=E(this,i,Qi).call(this,h);h=it.Util.makeHexColor(...D);const L=E(this,i,Qi).call(this,g);if(g=it.Util.makeHexColor(...L),t(this,he,Pi).style.color="",h==="#000000"&&g==="#ffffff"||h===g)return t(this,Xt);const J=new Array(256);for(let dt=0;dt<=255;dt++){const St=dt/255;J[dt]=St<=.03928?St/12.92:ps((St+.055)/1.055,2.4)}const tt=J.join(","),ht=`g_${t(this,Yt)}_hcm_filter`,at=P(this,te,E(this,we,vs).call(this,ht));E(this,M,Ki).call(this,tt,tt,tt,at),E(this,Wt,$s).call(this,at);const yt=(dt,St)=>{const S=D[dt]/255,s=L[dt]/255,a=new Array(St+1);for(let m=0;m<=St;m++)a[m]=S+m/St*(s-S);return a.join(",")};return E(this,M,Ki).call(this,yt(0,5),yt(1,5),yt(2,5),at),P(this,Xt,`url(#${ht})`),t(this,Xt)}addHighlightHCMFilter(h,g,w,D){var s;const L=`${h}-${g}-${w}-${D}`;if(t(this,Gt)===L)return t(this,se);if(P(this,Gt,L),P(this,se,"none"),(s=t(this,te))==null||s.remove(),!h||!g)return t(this,se);const[J,tt]=[h,g].map(E(this,i,Qi).bind(this));let ht=Math.round(.2126*J[0]+.7152*J[1]+.0722*J[2]),at=Math.round(.2126*tt[0]+.7152*tt[1]+.0722*tt[2]),[yt,kt]=[w,D].map(E(this,i,Qi).bind(this));at<ht&&([ht,at,yt,kt]=[at,ht,kt,yt]),t(this,he,Pi).style.color="";const dt=(a,m,U)=>{const et=new Array(256),ft=(at-ht)/U,Tt=a/255,Ft=(m-a)/(255*U);let jt=0;for(let Vt=0;Vt<=U;Vt++){const Dt=Math.round(ht+Vt*ft),Ht=Tt+Vt*Ft;for(let y=jt;y<=Dt;y++)et[y]=Ht;jt=Dt+1}for(let Vt=jt;Vt<256;Vt++)et[Vt]=et[jt-1];return et.join(",")},St=`g_${t(this,Yt)}_hcm_highlight_filter`,S=P(this,te,E(this,we,vs).call(this,St));return E(this,Wt,$s).call(this,S),E(this,M,Ki).call(this,dt(yt[0],kt[0],5),dt(yt[1],kt[1],5),dt(yt[2],kt[2],5),S),P(this,se,`url(#${St})`),t(this,se)}destroy(h=!1){h&&(t(this,Xt)||t(this,se))||(t(this,Fe)&&(t(this,Fe).parentNode.parentNode.remove(),P(this,Fe,null)),t(this,Kt)&&(t(this,Kt).clear(),P(this,Kt,null)),P(this,le,0))}}Kt=new WeakMap,Fe=new WeakMap,Yt=new WeakMap,Jt=new WeakMap,fe=new WeakMap,ne=new WeakMap,Xt=new WeakMap,te=new WeakMap,Gt=new WeakMap,se=new WeakMap,le=new WeakMap,ee=new WeakSet,ki=function(){return t(this,Kt)||P(this,Kt,new Map)},he=new WeakSet,Pi=function(){if(!t(this,Fe)){const h=t(this,Jt).createElement("div"),{style:g}=h;g.visibility="hidden",g.contain="strict",g.width=g.height=0,g.position="absolute",g.top=g.left=0,g.zIndex=-1;const w=t(this,Jt).createElementNS(k,"svg");w.setAttribute("width",0),w.setAttribute("height",0),P(this,Fe,t(this,Jt).createElementNS(k,"defs")),h.append(w),w.append(t(this,Fe)),t(this,Jt).body.append(h)}return t(this,Fe)},Wt=new WeakSet,$s=function(h){const g=t(this,Jt).createElementNS(k,"feColorMatrix");g.setAttribute("type","matrix"),g.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),h.append(g)},we=new WeakSet,vs=function(h){const g=t(this,Jt).createElementNS(k,"filter");return g.setAttribute("color-interpolation-filters","sRGB"),g.setAttribute("id",h),t(this,he,Pi).append(g),g},Ce=new WeakSet,ys=function(h,g,w){const D=t(this,Jt).createElementNS(k,g);D.setAttribute("type","discrete"),D.setAttribute("tableValues",w),h.append(D)},M=new WeakSet,Ki=function(h,g,w,D){const L=t(this,Jt).createElementNS(k,"feComponentTransfer");D.append(L),E(this,Ce,ys).call(this,L,"feFuncR",h),E(this,Ce,ys).call(this,L,"feFuncG",g),E(this,Ce,ys).call(this,L,"feFuncB",w)},i=new WeakSet,Qi=function(h){return t(this,he,Pi).style.color=h,_(getComputedStyle(t(this,he,Pi)).getPropertyValue("color"))};class Q extends u.BaseCanvasFactory{constructor({ownerDocument:o=globalThis.document}={}){super(),this._document=o}_createCanvas(o,h){const g=this._document.createElement("canvas");return g.width=o,g.height=h,g}}function H(p,o="text"){return be(this,null,function*(){if(F(p,document.baseURI)){const h=yield fetch(p);if(!h.ok)throw new Error(h.statusText);switch(o){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"json":return h.json()}return h.text()}return new Promise((h,g)=>{const w=new XMLHttpRequest;w.open("GET",p,!0),w.responseType=o,w.onreadystatechange=()=>{if(w.readyState===XMLHttpRequest.DONE){if(w.status===200||w.status===0){let D;switch(o){case"arraybuffer":case"blob":case"json":D=w.response;break;default:D=w.responseText;break}if(D){h(D);return}}g(new Error(w.statusText))}},w.send(null)})})}class A extends u.BaseCMapReaderFactory{_fetchData(o,h){return H(o,this.isCompressed?"arraybuffer":"text").then(g=>({cMapData:g instanceof ArrayBuffer?new Uint8Array(g):(0,it.stringToBytes)(g),compressionType:h}))}}class z extends u.BaseStandardFontDataFactory{_fetchData(o){return H(o,"arraybuffer").then(h=>new Uint8Array(h))}}class N extends u.BaseSVGFactory{_createSVG(o){return document.createElementNS(k,o)}}class T{constructor({viewBox:o,scale:h,rotation:g,offsetX:w=0,offsetY:D=0,dontFlip:L=!1}){this.viewBox=o,this.scale=h,this.rotation=g,this.offsetX=w,this.offsetY=D;const J=(o[2]+o[0])/2,tt=(o[3]+o[1])/2;let ht,at,yt,kt;switch(g%=360,g<0&&(g+=360),g){case 180:ht=-1,at=0,yt=0,kt=1;break;case 90:ht=0,at=1,yt=1,kt=0;break;case 270:ht=0,at=-1,yt=-1,kt=0;break;case 0:ht=1,at=0,yt=0,kt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}L&&(yt=-yt,kt=-kt);let dt,St,S,s;ht===0?(dt=Math.abs(tt-o[1])*h+w,St=Math.abs(J-o[0])*h+D,S=(o[3]-o[1])*h,s=(o[2]-o[0])*h):(dt=Math.abs(J-o[0])*h+w,St=Math.abs(tt-o[1])*h+D,S=(o[2]-o[0])*h,s=(o[3]-o[1])*h),this.transform=[ht*h,at*h,yt*h,kt*h,dt-ht*h*J-yt*h*tt,St-at*h*J-kt*h*tt],this.width=S,this.height=s}get rawDims(){const{viewBox:o}=this;return(0,it.shadow)(this,"rawDims",{pageWidth:o[2]-o[0],pageHeight:o[3]-o[1],pageX:o[0],pageY:o[1]})}clone({scale:o=this.scale,rotation:h=this.rotation,offsetX:g=this.offsetX,offsetY:w=this.offsetY,dontFlip:D=!1}={}){return new T({viewBox:this.viewBox.slice(),scale:o,rotation:h,offsetX:g,offsetY:w,dontFlip:D})}convertToViewportPoint(o,h){return it.Util.applyTransform([o,h],this.transform)}convertToViewportRectangle(o){const h=it.Util.applyTransform([o[0],o[1]],this.transform),g=it.Util.applyTransform([o[2],o[3]],this.transform);return[h[0],h[1],g[0],g[1]]}convertToPdfPoint(o,h){return it.Util.applyInverseTransform([o,h],this.transform)}}class W extends it.BaseException{constructor(o,h=0){super(o,"RenderingCancelledException"),this.extraDelay=h}}function x(p){const o=p.length;let h=0;for(;h<o&&p[h].trim()==="";)h++;return p.substring(h,h+5).toLowerCase()==="data:"}function O(p){return typeof p=="string"&&/\.pdf$/i.test(p)}function I(p,o=!1){return o||([p]=p.split(/[#?]/,1)),p.substring(p.lastIndexOf("/")+1)}function G(p,o="document.pdf"){if(typeof p!="string")return o;if(x(p))return(0,it.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),o;const h=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,g=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,w=h.exec(p);let D=g.exec(w[1])||g.exec(w[2])||g.exec(w[3]);if(D&&(D=D[0],D.includes("%")))try{D=g.exec(decodeURIComponent(D))[0]}catch(L){}return D||o}class V{constructor(){Ae(this,"started",Object.create(null));Ae(this,"times",[])}time(o){o in this.started&&(0,it.warn)(`Timer is already running for ${o}`),this.started[o]=Date.now()}timeEnd(o){o in this.started||(0,it.warn)(`Timer has not been started for ${o}`),this.times.push({name:o,start:this.started[o],end:Date.now()}),delete this.started[o]}toString(){const o=[];let h=0;for(const{name:g}of this.times)h=Math.max(g.length,h);for(const{name:g,start:w,end:D}of this.times)o.push(`${g.padEnd(h)} ${D-w}ms
`);return o.join("")}}function F(p,o){try{const{protocol:h}=o?new URL(p,o):new URL(p);return h==="http:"||h==="https:"}catch(h){return!1}}function X(p){p.preventDefault()}function C(p){console.log("Deprecated API usage: "+p)}let $;class st{static toDateObject(o){if(!o||typeof o!="string")return null;$||($=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const h=$.exec(o);if(!h)return null;const g=parseInt(h[1],10);let w=parseInt(h[2],10);w=w>=1&&w<=12?w-1:0;let D=parseInt(h[3],10);D=D>=1&&D<=31?D:1;let L=parseInt(h[4],10);L=L>=0&&L<=23?L:0;let J=parseInt(h[5],10);J=J>=0&&J<=59?J:0;let tt=parseInt(h[6],10);tt=tt>=0&&tt<=59?tt:0;const ht=h[7]||"Z";let at=parseInt(h[8],10);at=at>=0&&at<=23?at:0;let yt=parseInt(h[9],10)||0;return yt=yt>=0&&yt<=59?yt:0,ht==="-"?(L+=at,J+=yt):ht==="+"&&(L-=at,J-=yt),new Date(Date.UTC(g,w,D,L,J,tt))}}function xt(p,{scale:o=1,rotation:h=0}){const{width:g,height:w}=p.attributes.style,D=[0,0,parseInt(g),parseInt(w)];return new T({viewBox:D,scale:o,rotation:h})}function _(p){if(p.startsWith("#")){const o=parseInt(p.slice(1),16);return[(o&16711680)>>16,(o&65280)>>8,o&255]}return p.startsWith("rgb(")?p.slice(4,-1).split(",").map(o=>parseInt(o)):p.startsWith("rgba(")?p.slice(5,-1).split(",").map(o=>parseInt(o)).slice(0,3):((0,it.warn)(`Not a valid color format: "${p}"`),[0,0,0])}function mt(p){const o=document.createElement("span");o.style.visibility="hidden",document.body.append(o);for(const h of p.keys()){o.style.color=h;const g=window.getComputedStyle(o).color;p.set(h,_(g))}o.remove()}function wt(p){const{a:o,b:h,c:g,d:w,e:D,f:L}=p.getTransform();return[o,h,g,w,D,L]}function Ut(p){const{a:o,b:h,c:g,d:w,e:D,f:L}=p.getTransform().invertSelf();return[o,h,g,w,D,L]}function Bt(p,o,h=!1,g=!0){if(o instanceof T){const{pageWidth:w,pageHeight:D}=o.rawDims,{style:L}=p,J=it.FeatureTest.isCSSRoundSupported,tt=`var(--scale-factor) * ${w}px`,ht=`var(--scale-factor) * ${D}px`,at=J?`round(${tt}, 1px)`:`calc(${tt})`,yt=J?`round(${ht}, 1px)`:`calc(${ht})`;!h||o.rotation%180===0?(L.width=at,L.height=yt):(L.width=yt,L.height=at)}g&&p.setAttribute("data-main-rotation",o.rotation)}},423:(ie,Nt,rt)=>{var q,lt,Q,H,Ys,z,js,T,Ws;rt.d(Nt,{DrawLayer:()=>k});var u=rt(473),it=rt(266);const x=class{constructor({pageIndex:I}){f(this,z);f(this,q,null);f(this,lt,0);f(this,Q,new Map);this.pageIndex=I}setParent(I){if(!t(this,q)){P(this,q,I);return}if(t(this,q)!==I){if(t(this,Q).size>0)for(const G of t(this,Q).values())G.remove(),I.append(G);P(this,q,I)}}static get _svgFactory(){return(0,it.shadow)(this,"_svgFactory",new u.DOMSVGFactory)}highlight({outlines:I,box:G},V,F){var Bt;const X=ii(this,lt)._++,C=E(this,z,js).call(this,G);C.classList.add("highlight");const $=x._svgFactory.createElement("defs");C.append($);const st=x._svgFactory.createElement("path");$.append(st);const xt=`path_p${this.pageIndex}_${X}`;st.setAttribute("id",xt),st.setAttribute("d",E(Bt=x,T,Ws).call(Bt,I));const _=x._svgFactory.createElement("clipPath");$.append(_);const mt=`clip_${xt}`;_.setAttribute("id",mt),_.setAttribute("clipPathUnits","objectBoundingBox");const wt=x._svgFactory.createElement("use");_.append(wt),wt.setAttribute("href",`#${xt}`),wt.classList.add("clip");const Ut=x._svgFactory.createElement("use");return C.append(Ut),C.setAttribute("fill",V),C.setAttribute("fill-opacity",F),Ut.setAttribute("href",`#${xt}`),t(this,Q).set(X,C),{id:X,clipPathId:`url(#${mt})`}}highlightOutline({outlines:I,box:G}){var _;const V=ii(this,lt)._++,F=E(this,z,js).call(this,G);F.classList.add("highlightOutline");const X=x._svgFactory.createElement("defs");F.append(X);const C=x._svgFactory.createElement("path");X.append(C);const $=`path_p${this.pageIndex}_${V}`;C.setAttribute("id",$),C.setAttribute("d",E(_=x,T,Ws).call(_,I)),C.setAttribute("vector-effect","non-scaling-stroke");const st=x._svgFactory.createElement("use");F.append(st),st.setAttribute("href",`#${$}`);const xt=st.cloneNode();return F.append(xt),st.classList.add("mainOutline"),xt.classList.add("secondaryOutline"),t(this,Q).set(V,F),V}updateBox(I,G){var V;E(V=x,H,Ys).call(V,t(this,Q).get(I),G)}rotate(I,G){t(this,Q).get(I).setAttribute("data-main-rotation",G)}changeColor(I,G){t(this,Q).get(I).setAttribute("fill",G)}changeOpacity(I,G){t(this,Q).get(I).setAttribute("fill-opacity",G)}addClass(I,G){t(this,Q).get(I).classList.add(G)}removeClass(I,G){t(this,Q).get(I).classList.remove(G)}remove(I){t(this,q)!==null&&(t(this,Q).get(I).remove(),t(this,Q).delete(I))}destroy(){P(this,q,null);for(const I of t(this,Q).values())I.remove();t(this,Q).clear()}};let k=x;q=new WeakMap,lt=new WeakMap,Q=new WeakMap,H=new WeakSet,Ys=function(I,{x:G,y:V,width:F,height:X}){const{style:C}=I;C.top=`${100*V}%`,C.left=`${100*G}%`,C.width=`${100*F}%`,C.height=`${100*X}%`},z=new WeakSet,js=function(I){var V;const G=x._svgFactory.create(1,1,!0);return t(this,q).append(G),E(V=x,H,Ys).call(V,G,I),G},T=new WeakSet,Ws=function(I){const G=[];for(const V of I){let[F,X]=V;G.push(`M${F} ${X}`);for(let C=2;C<V.length;C+=2){const $=V[C],st=V[C+1];$===F?(G.push(`V${st}`),X=st):st===X&&(G.push(`H${$}`),F=$)}G.push("Z")}return G.join(" ")},f(k,H),f(k,T)},629:(ie,Nt,rt)=>{var x,O,I,G,V,F,X,C,$,st,Xn,_,Vn,wt,$n,Bt,Ji,Kt,qs,Yt,Yn,fe,Ks,te,Gt,se,le,ee,qt,he,ge,Wt,ae,we,Qs,Ce,jn,M,Js,i,Ss,p,Zs,h,Wn,w,qn,J,tt,ht,at,yt,kt,dt,St,S,s,a,m,U,et,ft,Tt,Kn,jt,Qn,Dt,Jn,y,Zn,ct,_s,Pt,_n,c,tn,l,tr,R,er,K,ir,bt,sr,Ot,nr,Ct,si,zt,en,ce,ws,me,xs,Re,Li,Oe,sn,$e,Cs,re,rr,ze,nn,rs,ar,as,or,Ni,rn,Si,Es,ri,Mi,Me,De,ai,Qe,oi,wi,Je,fi,Ye,Ge,Oi,pi,Zi,gi,_i,xi,Ts,Hi,an,os,lr,ls,hr,Bi,on,Ci,Fs,hs,cr,mi,Ei,Ze,zi,cs,Ui,_e,Gi,Be,li,Ti,Fi,ti,oe,hi,Xi,ln,Vi,hn,bi,ts,$i,cn,Yi,dn;rt.d(Nt,{AnnotationEditorLayer:()=>W});var u=rt(266),it=rt(115),k=rt(812),q=rt(640);const Xt=class extends it.AnnotationEditor{constructor(r){super(qi(vi({},r),{name:"freeTextEditor"}));f(this,st);f(this,_);f(this,wt);f(this,Bt);f(this,Kt);f(this,Yt);f(this,fe);f(this,x,this.editorDivBlur.bind(this));f(this,O,this.editorDivFocus.bind(this));f(this,I,this.editorDivInput.bind(this));f(this,G,this.editorDivKeydown.bind(this));f(this,V,void 0);f(this,F,"");f(this,X,`${this.id}-editor`);f(this,C,void 0);f(this,$,null);P(this,V,r.color||Xt._defaultColor||it.AnnotationEditor._defaultLineColor),P(this,C,r.fontSize||Xt._defaultFontSize)}static get _keyboardManager(){const r=Xt.prototype,b=ot=>ot.isEmpty(),j=k.AnnotationEditorUIManager.TRANSLATE_SMALL,Z=k.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,u.shadow)(this,"_keyboardManager",new k.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],r.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],r.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],r._translateEmpty,{args:[-j,0],checker:b}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],r._translateEmpty,{args:[-Z,0],checker:b}],[["ArrowRight","mac+ArrowRight"],r._translateEmpty,{args:[j,0],checker:b}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],r._translateEmpty,{args:[Z,0],checker:b}],[["ArrowUp","mac+ArrowUp"],r._translateEmpty,{args:[0,-j],checker:b}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],r._translateEmpty,{args:[0,-Z],checker:b}],[["ArrowDown","mac+ArrowDown"],r._translateEmpty,{args:[0,j],checker:b}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],r._translateEmpty,{args:[0,Z],checker:b}]]))}static initialize(r){it.AnnotationEditor.initialize(r,{strings:["pdfjs-free-text-default-content"]});const b=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(b.getPropertyValue("--freetext-padding"))}static updateDefaultParams(r,b){switch(r){case u.AnnotationEditorParamsType.FREETEXT_SIZE:Xt._defaultFontSize=b;break;case u.AnnotationEditorParamsType.FREETEXT_COLOR:Xt._defaultColor=b;break}}updateParams(r,b){switch(r){case u.AnnotationEditorParamsType.FREETEXT_SIZE:E(this,st,Xn).call(this,b);break;case u.AnnotationEditorParamsType.FREETEXT_COLOR:E(this,_,Vn).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.FREETEXT_SIZE,Xt._defaultFontSize],[u.AnnotationEditorParamsType.FREETEXT_COLOR,Xt._defaultColor||it.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[u.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,C)],[u.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,V)]]}_translateEmpty(r,b){this._uiManager.translateSelectedEditors(r,b,!0)}getInitialTranslation(){const r=this.parentScale;return[-Xt._internalPadding*r,-(Xt._internalPadding+t(this,C))*r]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(u.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,G)),this.editorDiv.addEventListener("focus",t(this,O)),this.editorDiv.addEventListener("blur",t(this,x)),this.editorDiv.addEventListener("input",t(this,I)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,X)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,G)),this.editorDiv.removeEventListener("focus",t(this,O)),this.editorDiv.removeEventListener("blur",t(this,x)),this.editorDiv.removeEventListener("input",t(this,I)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(r){this._focusEventsAllowed&&(super.focusin(r),r.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var r;if(this.width){E(this,fe,Ks).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const r=t(this,F),b=P(this,F,E(this,wt,$n).call(this).trimEnd());if(r===b)return;const j=Z=>{if(P(this,F,Z),!Z){this.remove();return}E(this,Kt,qs).call(this),this._uiManager.rebuild(this),E(this,Bt,Ji).call(this)};this.addCommands({cmd:()=>{j(b)},undo:()=>{j(r)},mustExec:!1}),E(this,Bt,Ji).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(r){this.enterInEditMode()}keydown(r){r.target===this.div&&r.key==="Enter"&&(this.enterInEditMode(),r.preventDefault())}editorDivKeydown(r){Xt._keyboardManager.exec(this,r)}editorDivFocus(r){this.isEditing=!0}editorDivBlur(r){this.isEditing=!1}editorDivInput(r){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let r,b;this.width&&(r=this.x,b=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,X)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),it.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(Z=>{var ot;return(ot=this.editorDiv)==null?void 0:ot.setAttribute("default-content",Z)}),this.editorDiv.contentEditable=!0;const{style:j}=this.editorDiv;if(j.fontSize=`calc(${t(this,C)}px * var(--scale-factor))`,j.color=t(this,V),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,k.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Z,ot]=this.parentDimensions;if(this.annotationElementId){const{position:Et}=t(this,$);let[Lt,gt]=this.getInitialTranslation();[Lt,gt]=this.pageTranslationToScreen(Lt,gt);const[Mt,It]=this.pageDimensions,[pe,Se]=this.pageTranslation;let Ee,Te;switch(this.rotation){case 0:Ee=r+(Et[0]-pe)/Mt,Te=b+this.height-(Et[1]-Se)/It;break;case 90:Ee=r+(Et[0]-pe)/Mt,Te=b-(Et[1]-Se)/It,[Lt,gt]=[gt,-Lt];break;case 180:Ee=r-this.width+(Et[0]-pe)/Mt,Te=b-(Et[1]-Se)/It,[Lt,gt]=[-Lt,-gt];break;case 270:Ee=r+(Et[0]-pe-this.height*It)/Mt,Te=b+(Et[1]-Se-this.width*Mt)/It,[Lt,gt]=[-gt,Lt];break}this.setAt(Ee*Z,Te*ot,Lt,gt)}else this.setAt(r*Z,b*ot,this.width*Z,this.height*ot);E(this,Kt,qs).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(r,b,j){let Z=null;if(r instanceof q.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Et,fontColor:Lt},rect:gt,rotation:Mt,id:It},textContent:pe,textPosition:Se,parent:{page:{pageNumber:Ee}}}=r;if(!pe||pe.length===0)return null;Z=r={annotationType:u.AnnotationEditorType.FREETEXT,color:Array.from(Lt),fontSize:Et,value:pe.join(`
`),position:Se,pageIndex:Ee-1,rect:gt,rotation:Mt,id:It,deleted:!1}}const ot=super.deserialize(r,b,j);return P(ot,C,r.fontSize),P(ot,V,u.Util.makeHexColor(...r.color)),P(ot,F,r.value),ot.annotationElementId=r.id||null,P(ot,$,Z),ot}serialize(r=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const b=Xt._internalPadding*this.parentScale,j=this.getRect(b,b),Z=it.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,V)),ot={annotationType:u.AnnotationEditorType.FREETEXT,color:Z,fontSize:t(this,C),value:t(this,F),pageIndex:this.pageIndex,rect:j,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return r?ot:this.annotationElementId&&!E(this,Yt,Yn).call(this,ot)?null:(ot.id=this.annotationElementId,ot)}};let lt=Xt;x=new WeakMap,O=new WeakMap,I=new WeakMap,G=new WeakMap,V=new WeakMap,F=new WeakMap,X=new WeakMap,C=new WeakMap,$=new WeakMap,st=new WeakSet,Xn=function(r){const b=Z=>{this.editorDiv.style.fontSize=`calc(${Z}px * var(--scale-factor))`,this.translate(0,-(Z-t(this,C))*this.parentScale),P(this,C,Z),E(this,Bt,Ji).call(this)},j=t(this,C);this.addCommands({cmd:()=>{b(r)},undo:()=>{b(j)},mustExec:!0,type:u.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},_=new WeakSet,Vn=function(r){const b=t(this,V);this.addCommands({cmd:()=>{P(this,V,this.editorDiv.style.color=r)},undo:()=>{P(this,V,this.editorDiv.style.color=b)},mustExec:!0,type:u.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},wt=new WeakSet,$n=function(){const r=this.editorDiv.getElementsByTagName("div");if(r.length===0)return this.editorDiv.innerText;const b=[];for(const j of r)b.push(j.innerText.replace(/\r\n?|\n/,""));return b.join(`
`)},Bt=new WeakSet,Ji=function(){const[r,b]=this.parentDimensions;let j;if(this.isAttachedToDOM)j=this.div.getBoundingClientRect();else{const{currentLayer:Z,div:ot}=this,Et=ot.style.display;ot.style.display="hidden",Z.div.append(this.div),j=ot.getBoundingClientRect(),ot.remove(),ot.style.display=Et}this.rotation%180===this.parentRotation%180?(this.width=j.width/r,this.height=j.height/b):(this.width=j.height/r,this.height=j.width/b),this.fixAndSetPosition()},Kt=new WeakSet,qs=function(){if(this.editorDiv.replaceChildren(),!!t(this,F))for(const r of t(this,F).split(`
`)){const b=document.createElement("div");b.append(r?document.createTextNode(r):document.createElement("br")),this.editorDiv.append(b)}},Yt=new WeakSet,Yn=function(r){const{value:b,fontSize:j,color:Z,rect:ot,pageIndex:Et}=t(this,$);return r.value!==b||r.fontSize!==j||r.rect.some((Lt,gt)=>Math.abs(Lt-ot[gt])>=1)||r.color.some((Lt,gt)=>Lt!==Z[gt])||r.pageIndex!==Et},fe=new WeakSet,Ks=function(r=!1){if(!this.annotationElementId)return;if(E(this,Bt,Ji).call(this),!r&&(this.width===0||this.height===0)){setTimeout(()=>E(this,fe,Ks).call(this,!0),0);return}const b=Xt._internalPadding*this.parentScale;t(this,$).rect=this.getRect(b,b)},Ae(lt,"_freeTextDefaultContent",""),Ae(lt,"_internalPadding",0),Ae(lt,"_defaultColor",null),Ae(lt,"_defaultFontSize",10),Ae(lt,"_type","freetext"),Ae(lt,"_editorType",u.AnnotationEditorType.FREETEXT);var Q=rt(97),H=rt(405);const L=class extends it.AnnotationEditor{constructor(r){var b;super(qi(vi({},r),{name:"highlightEditor"}));f(this,we);f(this,Ce);f(this,M);f(this,i);f(this,h);f(this,w);f(this,te,void 0);f(this,Gt,null);f(this,se,null);f(this,le,null);f(this,ee,null);f(this,qt,null);f(this,he,null);f(this,ge,null);f(this,Wt,void 0);f(this,ae,null);L._defaultColor||(L._defaultColor=((b=this._uiManager.highlightColors)==null?void 0:b.values().next().value)||"#fff066"),this.color=r.color||L._defaultColor,P(this,Wt,r.opacity||L._defaultOpacity),P(this,te,r.boxes||null),this._isDraggable=!1,E(this,we,Qs).call(this),E(this,i,Ss).call(this),this.rotate(this.rotation)}static initialize(r){it.AnnotationEditor.initialize(r)}static updateDefaultParams(r,b){switch(r){case u.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:L._defaultColor=b;break}}get toolbarPosition(){return t(this,ge)}updateParams(r,b){switch(r){case u.AnnotationEditorParamsType.HIGHLIGHT_COLOR:E(this,Ce,jn).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,L._defaultColor]]}get propertiesToUpdate(){return[[u.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||L._defaultColor]]}addEditToolbar(){return be(this,null,function*(){const r=yield On(L.prototype,this,"addEditToolbar").call(this);return r?(this._uiManager.highlightColors&&(P(this,se,new Q.ColorPicker({editor:this})),r.addColorPicker(t(this,se))),r):null})}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(0)}getRect(r,b){return super.getRect(r,b,0)}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){super.remove(),E(this,M,Js).call(this)}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(E(this,i,Ss).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(r){var j;let b=!1;this.parent&&!r?E(this,M,Js).call(this):r&&(E(this,i,Ss).call(this,r),b=!this.parent&&((j=this.div)==null?void 0:j.classList.contains("selectedEditor"))),super.setParent(r),b&&this.select()}rotate(r){var j,Z;const{drawLayer:b}=this.parent;b.rotate(t(this,he),r),b.rotate(t(this,ae),r),b.updateBox(t(this,he),E(j=L,p,Zs).call(j,this,r)),b.updateBox(t(this,ae),E(Z=L,p,Zs).call(Z,t(this,le).box,r))}render(){if(this.div)return this.div;const r=super.render(),b=P(this,ee,document.createElement("div"));r.append(b),b.className="internal",b.style.clipPath=t(this,Gt);const[j,Z]=this.parentDimensions;return this.setDims(this.width*j,this.height*Z),(0,k.bindEvents)(this,t(this,ee),["pointerover","pointerleave"]),this.enableEditing(),r}pointerover(){this.parent.drawLayer.addClass(t(this,ae),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,ae),"hovered")}select(){var r,b;super.select(),(r=this.parent)==null||r.drawLayer.removeClass(t(this,ae),"hovered"),(b=this.parent)==null||b.drawLayer.addClass(t(this,ae),"selected")}unselect(){var r;super.unselect(),(r=this.parent)==null||r.drawLayer.removeClass(t(this,ae),"selected")}static deserialize(r,b,j){var pe;const Z=super.deserialize(r,b,j),{rect:ot,color:Et,quadPoints:Lt}=r;Z.color=u.Util.makeHexColor(...Et),P(Z,Wt,r.opacity);const[gt,Mt]=Z.pageDimensions;Z.width=(ot[2]-ot[0])/gt,Z.height=(ot[3]-ot[1])/Mt;const It=P(Z,te,[]);for(let Se=0;Se<Lt.length;Se+=8)It.push({x:Lt[4]/gt,y:1-Lt[Se+5]/Mt,width:(Lt[Se+2]-Lt[Se])/gt,height:(Lt[Se+5]-Lt[Se+1])/Mt});return E(pe=Z,we,Qs).call(pe),Z}serialize(r=!1){if(this.isEmpty()||r)return null;const b=this.getRect(0,0),j=it.AnnotationEditor._colorManager.convert(this.color);return{annotationType:u.AnnotationEditorType.HIGHLIGHT,color:j,opacity:t(this,Wt),quadPoints:E(this,h,Wn).call(this),outlines:E(this,w,qn).call(this),pageIndex:this.pageIndex,rect:b,rotation:0,structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};let A=L;te=new WeakMap,Gt=new WeakMap,se=new WeakMap,le=new WeakMap,ee=new WeakMap,qt=new WeakMap,he=new WeakMap,ge=new WeakMap,Wt=new WeakMap,ae=new WeakMap,we=new WeakSet,Qs=function(){const r=new H.Outliner(t(this,te),.001);P(this,qt,r.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,qt).box;const b=new H.Outliner(t(this,te),.0025,.001,this._uiManager.direction==="ltr");P(this,le,b.getOutlines());const{lastPoint:j}=t(this,le).box;P(this,ge,[(j[0]-this.x)/this.width,(j[1]-this.y)/this.height])},Ce=new WeakSet,jn=function(r){const b=this.color;this.addCommands({cmd:()=>{var j;this.color=r,this.parent.drawLayer.changeColor(t(this,he),r),(j=t(this,se))==null||j.updateColor(r)},undo:()=>{var j;this.color=b,this.parent.drawLayer.changeColor(t(this,he),b),(j=t(this,se))==null||j.updateColor(b)},mustExec:!0,type:u.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},M=new WeakSet,Js=function(){t(this,he)===null||!this.parent||(this.parent.drawLayer.remove(t(this,he)),P(this,he,null),this.parent.drawLayer.remove(t(this,ae)),P(this,ae,null))},i=new WeakSet,Ss=function(r=this.parent){t(this,he)===null&&({id:ii(this,he)._,clipPathId:ii(this,Gt)._}=r.drawLayer.highlight(t(this,qt),this.color,t(this,Wt)),t(this,ee)&&(t(this,ee).style.clipPath=t(this,Gt)),P(this,ae,r.drawLayer.highlightOutline(t(this,le))))},p=new WeakSet,Zs=function({x:r,y:b,width:j,height:Z},ot){switch(ot){case 90:return{x:1-b-Z,y:r,width:Z,height:j};case 180:return{x:1-r-j,y:1-b-Z,width:j,height:Z};case 270:return{x:b,y:1-r-j,width:Z,height:j}}return{x:r,y:b,width:j,height:Z}},h=new WeakSet,Wn=function(){const[r,b]=this.pageDimensions,j=t(this,te),Z=new Array(j.length*8);let ot=0;for(const{x:Et,y:Lt,width:gt,height:Mt}of j){const It=Et*r,pe=(1-Lt-Mt)*b;Z[ot]=Z[ot+4]=It,Z[ot+1]=Z[ot+3]=pe,Z[ot+2]=Z[ot+6]=It+gt*r,Z[ot+5]=Z[ot+7]=pe+Mt*b,ot+=8}return Z},w=new WeakSet,qn=function(){const[r,b]=this.pageDimensions,j=this.width*r,Z=this.height*b,ot=this.x*r,Et=(1-this.y-this.height)*b,Lt=[];for(const gt of t(this,qt).outlines){const Mt=new Array(gt.length);for(let It=0;It<gt.length;It+=2)Mt[It]=ot+gt[It]*j,Mt[It+1]=Et+(1-gt[It+1])*Z;Lt.push(Mt)}return Lt},f(A,p),Ae(A,"_defaultColor",null),Ae(A,"_defaultOpacity",1),Ae(A,"_l10nPromise"),Ae(A,"_type","highlight"),Ae(A,"_editorType",u.AnnotationEditorType.HIGHLIGHT);var z=rt(473);const Le=class extends it.AnnotationEditor{constructor(r){super(qi(vi({},r),{name:"inkEditor"}));f(this,Tt);f(this,jt);f(this,Dt);f(this,y);f(this,ct);f(this,Pt);f(this,c);f(this,l);f(this,R);f(this,K);f(this,bt);f(this,Ot);f(this,Ct);f(this,zt);f(this,ce);f(this,me);f(this,Re);f(this,Oe);f(this,$e);f(this,as);f(this,Ni);f(this,Si);f(this,ri);f(this,J,0);f(this,tt,0);f(this,ht,this.canvasPointermove.bind(this));f(this,at,this.canvasPointerleave.bind(this));f(this,yt,this.canvasPointerup.bind(this));f(this,kt,this.canvasPointerdown.bind(this));f(this,dt,null);f(this,St,new Path2D);f(this,S,!1);f(this,s,!1);f(this,a,!1);f(this,m,null);f(this,U,0);f(this,et,0);f(this,ft,null);this.color=r.color||null,this.thickness=r.thickness||null,this.opacity=r.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(r){it.AnnotationEditor.initialize(r)}static updateDefaultParams(r,b){switch(r){case u.AnnotationEditorParamsType.INK_THICKNESS:Le._defaultThickness=b;break;case u.AnnotationEditorParamsType.INK_COLOR:Le._defaultColor=b;break;case u.AnnotationEditorParamsType.INK_OPACITY:Le._defaultOpacity=b/100;break}}updateParams(r,b){switch(r){case u.AnnotationEditorParamsType.INK_THICKNESS:E(this,Tt,Kn).call(this,b);break;case u.AnnotationEditorParamsType.INK_COLOR:E(this,jt,Qn).call(this,b);break;case u.AnnotationEditorParamsType.INK_OPACITY:E(this,Dt,Jn).call(this,b);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.INK_THICKNESS,Le._defaultThickness],[u.AnnotationEditorParamsType.INK_COLOR,Le._defaultColor||it.AnnotationEditor._defaultLineColor],[u.AnnotationEditorParamsType.INK_OPACITY,Math.round(Le._defaultOpacity*100)]]}get propertiesToUpdate(){var r;return[[u.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Le._defaultThickness],[u.AnnotationEditorParamsType.INK_COLOR,this.color||Le._defaultColor||it.AnnotationEditor._defaultLineColor],[u.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((r=this.opacity)!=null?r:Le._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(E(this,ce,ws).call(this),E(this,me,xs).call(this)),this.isAttachedToDOM||(this.parent.add(this),E(this,Re,Li).call(this)),E(this,ri,Mi).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,dt)&&(clearTimeout(t(this,dt)),P(this,dt,null)),t(this,m).disconnect(),P(this,m,null),super.remove())}setParent(r){!this.parent&&r?this._uiManager.removeShouldRescale(this):this.parent&&r===null&&this._uiManager.addShouldRescale(this),super.setParent(r)}onScaleChanging(){const[r,b]=this.parentDimensions,j=this.width*r,Z=this.height*b;this.setDimensions(j,Z)}enableEditMode(){t(this,S)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,kt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,kt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,S)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),P(this,S,!0),this.div.classList.add("disabled"),E(this,ri,Mi).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(r){this._focusEventsAllowed&&(super.focusin(r),this.enableEditMode())}canvasPointerdown(r){r.button!==0||!this.isInEditMode()||t(this,S)||(this.setInForeground(),r.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),E(this,Pt,_n).call(this,r.offsetX,r.offsetY))}canvasPointermove(r){r.preventDefault(),E(this,c,tn).call(this,r.offsetX,r.offsetY)}canvasPointerup(r){r.preventDefault(),E(this,zt,en).call(this,r)}canvasPointerleave(r){E(this,zt,en).call(this,r)}get isResizable(){return!this.isEmpty()&&t(this,S)}render(){if(this.div)return this.div;let r,b;this.width&&(r=this.x,b=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[j,Z,ot,Et]=E(this,y,Zn).call(this);if(this.setAt(j,Z,0,0),this.setDims(ot,Et),E(this,ce,ws).call(this),this.width){const[Lt,gt]=this.parentDimensions;this.setAspectRatio(this.width*Lt,this.height*gt),this.setAt(r*Lt,b*gt,this.width*Lt,this.height*gt),P(this,a,!0),E(this,Re,Li).call(this),this.setDims(this.width*Lt,this.height*gt),E(this,Ct,si).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return E(this,me,xs).call(this),this.div}setDimensions(r,b){const j=Math.round(r),Z=Math.round(b);if(t(this,U)===j&&t(this,et)===Z)return;P(this,U,j),P(this,et,Z),this.canvas.style.visibility="hidden";const[ot,Et]=this.parentDimensions;this.width=r/ot,this.height=b/Et,this.fixAndSetPosition(),t(this,S)&&E(this,Oe,sn).call(this,r,b),E(this,Re,Li).call(this),E(this,Ct,si).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(r,b,j){var Ai,je,We;if(r instanceof q.InkAnnotationElement)return null;const Z=super.deserialize(r,b,j);Z.thickness=r.thickness,Z.color=u.Util.makeHexColor(...r.color),Z.opacity=r.opacity;const[ot,Et]=Z.pageDimensions,Lt=Z.width*ot,gt=Z.height*Et,Mt=Z.parentScale,It=r.thickness/2;P(Z,S,!0),P(Z,U,Math.round(Lt)),P(Z,et,Math.round(gt));const{paths:pe,rect:Se,rotation:Ee}=r;for(let{bezier:Ne}of pe){Ne=E(Ai=Le,rs,ar).call(Ai,Ne,Se,Ee);const ci=[];Z.paths.push(ci);let ji=Mt*(Ne[0]-It),Wi=Mt*(Ne[1]-It);for(let Xe=2,Is=Ne.length;Xe<Is;Xe+=6){const Ds=Mt*(Ne[Xe]-It),us=Mt*(Ne[Xe+1]-It),fs=Mt*(Ne[Xe+2]-It),Ca=Mt*(Ne[Xe+3]-It),In=Mt*(Ne[Xe+4]-It),Dn=Mt*(Ne[Xe+5]-It);ci.push([[ji,Wi],[Ds,us],[fs,Ca],[In,Dn]]),ji=In,Wi=Dn}const ds=E(this,re,rr).call(this,ci);Z.bezierPath2D.push(ds)}const Te=E(je=Z,Ni,rn).call(je);return P(Z,tt,Math.max(it.AnnotationEditor.MIN_SIZE,Te[2]-Te[0])),P(Z,J,Math.max(it.AnnotationEditor.MIN_SIZE,Te[3]-Te[1])),E(We=Z,Oe,sn).call(We,Lt,gt),Z}serialize(){if(this.isEmpty())return null;const r=this.getRect(0,0),b=it.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:u.AnnotationEditorType.INK,color:b,thickness:this.thickness,opacity:this.opacity,paths:E(this,as,or).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,r),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};let N=Le;J=new WeakMap,tt=new WeakMap,ht=new WeakMap,at=new WeakMap,yt=new WeakMap,kt=new WeakMap,dt=new WeakMap,St=new WeakMap,S=new WeakMap,s=new WeakMap,a=new WeakMap,m=new WeakMap,U=new WeakMap,et=new WeakMap,ft=new WeakMap,Tt=new WeakSet,Kn=function(r){const b=this.thickness;this.addCommands({cmd:()=>{this.thickness=r,E(this,ri,Mi).call(this)},undo:()=>{this.thickness=b,E(this,ri,Mi).call(this)},mustExec:!0,type:u.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},jt=new WeakSet,Qn=function(r){const b=this.color;this.addCommands({cmd:()=>{this.color=r,E(this,Ct,si).call(this)},undo:()=>{this.color=b,E(this,Ct,si).call(this)},mustExec:!0,type:u.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Dt=new WeakSet,Jn=function(r){r/=100;const b=this.opacity;this.addCommands({cmd:()=>{this.opacity=r,E(this,Ct,si).call(this)},undo:()=>{this.opacity=b,E(this,Ct,si).call(this)},mustExec:!0,type:u.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},y=new WeakSet,Zn=function(){const{parentRotation:r,parentDimensions:[b,j]}=this;switch(r){case 90:return[0,j,j,b];case 180:return[b,j,b,j];case 270:return[b,0,j,b];default:return[0,0,b,j]}},ct=new WeakSet,_s=function(){const{ctx:r,color:b,opacity:j,thickness:Z,parentScale:ot,scaleFactor:Et}=this;r.lineWidth=Z*ot/Et,r.lineCap="round",r.lineJoin="round",r.miterLimit=10,r.strokeStyle=`${b}${(0,k.opacityToHex)(j)}`},Pt=new WeakSet,_n=function(r,b){var j;this.canvas.addEventListener("contextmenu",z.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,at)),this.canvas.addEventListener("pointermove",t(this,ht)),this.canvas.addEventListener("pointerup",t(this,yt)),this.canvas.removeEventListener("pointerdown",t(this,kt)),this.isEditing=!0,t(this,a)||(P(this,a,!0),E(this,Re,Li).call(this),this.thickness||(this.thickness=Le._defaultThickness),this.color||(this.color=Le._defaultColor||it.AnnotationEditor._defaultLineColor),(j=this.opacity)!=null||(this.opacity=Le._defaultOpacity)),this.currentPath.push([r,b]),P(this,s,!1),E(this,ct,_s).call(this),P(this,ft,()=>{E(this,K,ir).call(this),t(this,ft)&&window.requestAnimationFrame(t(this,ft))}),window.requestAnimationFrame(t(this,ft))},c=new WeakSet,tn=function(r,b){const[j,Z]=this.currentPath.at(-1);if(this.currentPath.length>1&&r===j&&b===Z)return;const ot=this.currentPath;let Et=t(this,St);if(ot.push([r,b]),P(this,s,!0),ot.length<=2){Et.moveTo(...ot[0]),Et.lineTo(r,b);return}ot.length===3&&(P(this,St,Et=new Path2D),Et.moveTo(...ot[0])),E(this,bt,sr).call(this,Et,...ot.at(-3),...ot.at(-2),r,b)},l=new WeakSet,tr=function(){if(this.currentPath.length===0)return;const r=this.currentPath.at(-1);t(this,St).lineTo(...r)},R=new WeakSet,er=function(r,b){P(this,ft,null),r=Math.min(Math.max(r,0),this.canvas.width),b=Math.min(Math.max(b,0),this.canvas.height),E(this,c,tn).call(this,r,b),E(this,l,tr).call(this);let j;if(this.currentPath.length!==1)j=E(this,Ot,nr).call(this);else{const gt=[r,b];j=[[gt,gt.slice(),gt.slice(),gt]]}const Z=t(this,St),ot=this.currentPath;this.currentPath=[],P(this,St,new Path2D);const Et=()=>{this.allRawPaths.push(ot),this.paths.push(j),this.bezierPath2D.push(Z),this.rebuild()},Lt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(E(this,ce,ws).call(this),E(this,me,xs).call(this)),E(this,ri,Mi).call(this))};this.addCommands({cmd:Et,undo:Lt,mustExec:!0})},K=new WeakSet,ir=function(){if(!t(this,s))return;P(this,s,!1);const r=Math.ceil(this.thickness*this.parentScale),b=this.currentPath.slice(-3),j=b.map(It=>It[0]),Z=b.map(It=>It[1]),ot=Math.min(...j)-r,Et=Math.max(...j)+r,Lt=Math.min(...Z)-r,gt=Math.max(...Z)+r,{ctx:Mt}=this;Mt.save(),Mt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const It of this.bezierPath2D)Mt.stroke(It);Mt.stroke(t(this,St)),Mt.restore()},bt=new WeakSet,sr=function(r,b,j,Z,ot,Et,Lt){const gt=(b+Z)/2,Mt=(j+ot)/2,It=(Z+Et)/2,pe=(ot+Lt)/2;r.bezierCurveTo(gt+2*(Z-gt)/3,Mt+2*(ot-Mt)/3,It+2*(Z-It)/3,pe+2*(ot-pe)/3,It,pe)},Ot=new WeakSet,nr=function(){const r=this.currentPath;if(r.length<=2)return[[r[0],r[0],r.at(-1),r.at(-1)]];const b=[];let j,[Z,ot]=r[0];for(j=1;j<r.length-2;j++){const[Se,Ee]=r[j],[Te,Ai]=r[j+1],je=(Se+Te)/2,We=(Ee+Ai)/2,Ne=[Z+2*(Se-Z)/3,ot+2*(Ee-ot)/3],ci=[je+2*(Se-je)/3,We+2*(Ee-We)/3];b.push([[Z,ot],Ne,ci,[je,We]]),[Z,ot]=[je,We]}const[Et,Lt]=r[j],[gt,Mt]=r[j+1],It=[Z+2*(Et-Z)/3,ot+2*(Lt-ot)/3],pe=[gt+2*(Et-gt)/3,Mt+2*(Lt-Mt)/3];return b.push([[Z,ot],It,pe,[gt,Mt]]),b},Ct=new WeakSet,si=function(){if(this.isEmpty()){E(this,$e,Cs).call(this);return}E(this,ct,_s).call(this);const{canvas:r,ctx:b}=this;b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,r.width,r.height),E(this,$e,Cs).call(this);for(const j of this.bezierPath2D)b.stroke(j)},zt=new WeakSet,en=function(r){this.canvas.removeEventListener("pointerleave",t(this,at)),this.canvas.removeEventListener("pointermove",t(this,ht)),this.canvas.removeEventListener("pointerup",t(this,yt)),this.canvas.addEventListener("pointerdown",t(this,kt)),t(this,dt)&&clearTimeout(t(this,dt)),P(this,dt,setTimeout(()=>{P(this,dt,null),this.canvas.removeEventListener("contextmenu",z.noContextMenu)},10)),E(this,R,er).call(this,r.offsetX,r.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ce=new WeakSet,ws=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},me=new WeakSet,xs=function(){P(this,m,new ResizeObserver(r=>{const b=r[0].contentRect;b.width&&b.height&&this.setDimensions(b.width,b.height)})),t(this,m).observe(this.div)},Re=new WeakSet,Li=function(){if(!t(this,a))return;const[r,b]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*r),this.canvas.height=Math.ceil(this.height*b),E(this,$e,Cs).call(this)},Oe=new WeakSet,sn=function(r,b){const j=E(this,Si,Es).call(this),Z=(r-j)/t(this,tt),ot=(b-j)/t(this,J);this.scaleFactor=Math.min(Z,ot)},$e=new WeakSet,Cs=function(){const r=E(this,Si,Es).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+r,this.translationY*this.scaleFactor+r)},re=new WeakSet,rr=function(r){const b=new Path2D;for(let j=0,Z=r.length;j<Z;j++){const[ot,Et,Lt,gt]=r[j];j===0&&b.moveTo(...ot),b.bezierCurveTo(Et[0],Et[1],Lt[0],Lt[1],gt[0],gt[1])}return b},ze=new WeakSet,nn=function(r,b,j){const[Z,ot,Et,Lt]=b;switch(j){case 0:for(let gt=0,Mt=r.length;gt<Mt;gt+=2)r[gt]+=Z,r[gt+1]=Lt-r[gt+1];break;case 90:for(let gt=0,Mt=r.length;gt<Mt;gt+=2){const It=r[gt];r[gt]=r[gt+1]+Z,r[gt+1]=It+ot}break;case 180:for(let gt=0,Mt=r.length;gt<Mt;gt+=2)r[gt]=Et-r[gt],r[gt+1]+=ot;break;case 270:for(let gt=0,Mt=r.length;gt<Mt;gt+=2){const It=r[gt];r[gt]=Et-r[gt+1],r[gt+1]=Lt-It}break;default:throw new Error("Invalid rotation")}return r},rs=new WeakSet,ar=function(r,b,j){const[Z,ot,Et,Lt]=b;switch(j){case 0:for(let gt=0,Mt=r.length;gt<Mt;gt+=2)r[gt]-=Z,r[gt+1]=Lt-r[gt+1];break;case 90:for(let gt=0,Mt=r.length;gt<Mt;gt+=2){const It=r[gt];r[gt]=r[gt+1]-ot,r[gt+1]=It-Z}break;case 180:for(let gt=0,Mt=r.length;gt<Mt;gt+=2)r[gt]=Et-r[gt],r[gt+1]-=ot;break;case 270:for(let gt=0,Mt=r.length;gt<Mt;gt+=2){const It=r[gt];r[gt]=Lt-r[gt+1],r[gt+1]=Et-It}break;default:throw new Error("Invalid rotation")}return r},as=new WeakSet,or=function(r,b,j,Z){var Mt,It;const ot=[],Et=this.thickness/2,Lt=r*b+Et,gt=r*j+Et;for(const pe of this.paths){const Se=[],Ee=[];for(let Te=0,Ai=pe.length;Te<Ai;Te++){const[je,We,Ne,ci]=pe[Te],ji=r*je[0]+Lt,Wi=r*je[1]+gt,ds=r*We[0]+Lt,Xe=r*We[1]+gt,Is=r*Ne[0]+Lt,Ds=r*Ne[1]+gt,us=r*ci[0]+Lt,fs=r*ci[1]+gt;Te===0&&(Se.push(ji,Wi),Ee.push(ji,Wi)),Se.push(ds,Xe,Is,Ds,us,fs),Ee.push(ds,Xe),Te===Ai-1&&Ee.push(us,fs)}ot.push({bezier:E(Mt=Le,ze,nn).call(Mt,Se,Z,this.rotation),points:E(It=Le,ze,nn).call(It,Ee,Z,this.rotation)})}return ot},Ni=new WeakSet,rn=function(){let r=1/0,b=-1/0,j=1/0,Z=-1/0;for(const ot of this.paths)for(const[Et,Lt,gt,Mt]of ot){const It=u.Util.bezierBoundingBox(...Et,...Lt,...gt,...Mt);r=Math.min(r,It[0]),j=Math.min(j,It[1]),b=Math.max(b,It[2]),Z=Math.max(Z,It[3])}return[r,j,b,Z]},Si=new WeakSet,Es=function(){return t(this,S)?Math.ceil(this.thickness*this.parentScale):0},ri=new WeakSet,Mi=function(r=!1){if(this.isEmpty())return;if(!t(this,S)){E(this,Ct,si).call(this);return}const b=E(this,Ni,rn).call(this),j=E(this,Si,Es).call(this);P(this,tt,Math.max(it.AnnotationEditor.MIN_SIZE,b[2]-b[0])),P(this,J,Math.max(it.AnnotationEditor.MIN_SIZE,b[3]-b[1]));const Z=Math.ceil(j+t(this,tt)*this.scaleFactor),ot=Math.ceil(j+t(this,J)*this.scaleFactor),[Et,Lt]=this.parentDimensions;this.width=Z/Et,this.height=ot/Lt,this.setAspectRatio(Z,ot);const gt=this.translationX,Mt=this.translationY;this.translationX=-b[0],this.translationY=-b[1],E(this,Re,Li).call(this),E(this,Ct,si).call(this),P(this,U,Z),P(this,et,ot),this.setDims(Z,ot);const It=r?j/this.scaleFactor/2:0;this.translate(gt-this.translationX-It,Mt-this.translationY-It)},f(N,re),f(N,ze),f(N,rs),Ae(N,"_defaultColor",null),Ae(N,"_defaultOpacity",1),Ae(N,"_defaultThickness",1),Ae(N,"_type","ink"),Ae(N,"_editorType",u.AnnotationEditorType.INK);const Ms=class extends it.AnnotationEditor{constructor(r){super(qi(vi({},r),{name:"stampEditor"}));f(this,pi);f(this,gi);f(this,xi);f(this,Hi);f(this,os);f(this,ls);f(this,Bi);f(this,Ci);f(this,hs);f(this,Me,null);f(this,De,null);f(this,ai,null);f(this,Qe,null);f(this,oi,null);f(this,wi,"");f(this,Je,null);f(this,fi,null);f(this,Ye,null);f(this,Ge,!1);f(this,Oi,!1);P(this,Qe,r.bitmapUrl),P(this,oi,r.bitmapFile)}static initialize(r){it.AnnotationEditor.initialize(r)}static get supportedTypes(){const r=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,u.shadow)(this,"supportedTypes",r.map(b=>`image/${b}`))}static get supportedTypesStr(){return(0,u.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(r){return this.supportedTypes.includes(r)}static paste(r,b){b.pasteEditor(u.AnnotationEditorType.STAMP,{bitmapFile:r.getAsFile()})}remove(){var r,b;t(this,De)&&(P(this,Me,null),this._uiManager.imageManager.deleteId(t(this,De)),(r=t(this,Je))==null||r.remove(),P(this,Je,null),(b=t(this,fi))==null||b.disconnect(),P(this,fi,null),t(this,Ye)&&(clearTimeout(t(this,Ye)),P(this,Ye,null))),super.remove()}rebuild(){if(!this.parent){t(this,De)&&E(this,xi,Ts).call(this);return}super.rebuild(),this.div!==null&&(t(this,De)&&E(this,xi,Ts).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,ai)||t(this,Me)||t(this,Qe)||t(this,oi))}get isResizable(){return!0}render(){if(this.div)return this.div;let r,b;if(this.width&&(r=this.x,b=this.y),super.render(),this.div.hidden=!0,t(this,Me)?E(this,Hi,an).call(this):E(this,xi,Ts).call(this),this.width){const[j,Z]=this.parentDimensions;this.setAt(r*j,b*Z,this.width*j,this.height*Z)}return this.div}getImageForAltText(){return t(this,Je)}static deserialize(r,b,j){if(r instanceof q.StampAnnotationElement)return null;const Z=super.deserialize(r,b,j),{rect:ot,bitmapUrl:Et,bitmapId:Lt,isSvg:gt,accessibilityData:Mt}=r;Lt&&j.imageManager.isValidId(Lt)?P(Z,De,Lt):P(Z,Qe,Et),P(Z,Ge,gt);const[It,pe]=Z.pageDimensions;return Z.width=(ot[2]-ot[0])/It,Z.height=(ot[3]-ot[1])/pe,Mt&&(Z.altTextData=Mt),Z}serialize(r=!1,b=null){if(this.isEmpty())return null;const j={annotationType:u.AnnotationEditorType.STAMP,bitmapId:t(this,De),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,Ge),structTreeParentId:this._structTreeParentId};if(r)return j.bitmapUrl=E(this,Ci,Fs).call(this,!0),j.accessibilityData=this.altTextData,j;const{decorative:Z,altText:ot}=this.altTextData;if(!Z&&ot&&(j.accessibilityData={type:"Figure",alt:ot}),b===null)return j;b.stamps||(b.stamps=new Map);const Et=t(this,Ge)?(j.rect[2]-j.rect[0])*(j.rect[3]-j.rect[1]):null;if(!b.stamps.has(t(this,De)))b.stamps.set(t(this,De),{area:Et,serialized:j}),j.bitmap=E(this,Ci,Fs).call(this,!1);else if(t(this,Ge)){const Lt=b.stamps.get(t(this,De));Et>Lt.area&&(Lt.area=Et,Lt.serialized.bitmap.close(),Lt.serialized.bitmap=E(this,Ci,Fs).call(this,!1))}return j}};let T=Ms;Me=new WeakMap,De=new WeakMap,ai=new WeakMap,Qe=new WeakMap,oi=new WeakMap,wi=new WeakMap,Je=new WeakMap,fi=new WeakMap,Ye=new WeakMap,Ge=new WeakMap,Oi=new WeakMap,pi=new WeakSet,Zi=function(r,b=!1){if(!r){this.remove();return}P(this,Me,r.bitmap),b||(P(this,De,r.id),P(this,Ge,r.isSvg)),r.file&&P(this,wi,r.file.name),E(this,Hi,an).call(this)},gi=new WeakSet,_i=function(){P(this,ai,null),this._uiManager.enableWaiting(!1),t(this,Je)&&this.div.focus()},xi=new WeakSet,Ts=function(){if(t(this,De)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,De)).then(b=>E(this,pi,Zi).call(this,b,!0)).finally(()=>E(this,gi,_i).call(this));return}if(t(this,Qe)){const b=t(this,Qe);P(this,Qe,null),this._uiManager.enableWaiting(!0),P(this,ai,this._uiManager.imageManager.getFromUrl(b).then(j=>E(this,pi,Zi).call(this,j)).finally(()=>E(this,gi,_i).call(this)));return}if(t(this,oi)){const b=t(this,oi);P(this,oi,null),this._uiManager.enableWaiting(!0),P(this,ai,this._uiManager.imageManager.getFromFile(b).then(j=>E(this,pi,Zi).call(this,j)).finally(()=>E(this,gi,_i).call(this)));return}const r=document.createElement("input");r.type="file",r.accept=Ms.supportedTypesStr,P(this,ai,new Promise(b=>{r.addEventListener("change",()=>be(this,null,function*(){if(!r.files||r.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const j=yield this._uiManager.imageManager.getFromFile(r.files[0]);E(this,pi,Zi).call(this,j)}b()})),r.addEventListener("cancel",()=>{this.remove(),b()})}).finally(()=>E(this,gi,_i).call(this))),r.click()},Hi=new WeakSet,an=function(){const{div:r}=this;let{width:b,height:j}=t(this,Me);const[Z,ot]=this.pageDimensions,Et=.75;if(this.width)b=this.width*Z,j=this.height*ot;else if(b>Et*Z||j>Et*ot){const It=Math.min(Et*Z/b,Et*ot/j);b*=It,j*=It}const[Lt,gt]=this.parentDimensions;this.setDims(b*Lt/Z,j*gt/ot),this._uiManager.enableWaiting(!1);const Mt=P(this,Je,document.createElement("canvas"));r.append(Mt),r.hidden=!1,E(this,Bi,on).call(this,b,j),E(this,hs,cr).call(this),t(this,Oi)||(this.parent.addUndoableEditor(this),P(this,Oi,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton(),t(this,wi)&&Mt.setAttribute("aria-label",t(this,wi))},os=new WeakSet,lr=function(r,b){var Et;const[j,Z]=this.parentDimensions;this.width=r/j,this.height=b/Z,this.setDims(r,b),(Et=this._initialOptions)!=null&&Et.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,Ye)!==null&&clearTimeout(t(this,Ye)),P(this,Ye,setTimeout(()=>{P(this,Ye,null),E(this,Bi,on).call(this,r,b)},200))},ls=new WeakSet,hr=function(r,b){const{width:j,height:Z}=t(this,Me);let ot=j,Et=Z,Lt=t(this,Me);for(;ot>2*r||Et>2*b;){const gt=ot,Mt=Et;ot>2*r&&(ot=ot>=16384?Math.floor(ot/2)-1:Math.ceil(ot/2)),Et>2*b&&(Et=Et>=16384?Math.floor(Et/2)-1:Math.ceil(Et/2));const It=new OffscreenCanvas(ot,Et);It.getContext("2d").drawImage(Lt,0,0,gt,Mt,0,0,ot,Et),Lt=It.transferToImageBitmap()}return Lt},Bi=new WeakSet,on=function(r,b){r=Math.ceil(r),b=Math.ceil(b);const j=t(this,Je);if(!j||j.width===r&&j.height===b)return;j.width=r,j.height=b;const Z=t(this,Ge)?t(this,Me):E(this,ls,hr).call(this,r,b),ot=j.getContext("2d");ot.filter=this._uiManager.hcmFilter,ot.drawImage(Z,0,0,Z.width,Z.height,0,0,r,b)},Ci=new WeakSet,Fs=function(r){if(r){if(t(this,Ge)){const Z=this._uiManager.imageManager.getSvgUrl(t(this,De));if(Z)return Z}const b=document.createElement("canvas");return{width:b.width,height:b.height}=t(this,Me),b.getContext("2d").drawImage(t(this,Me),0,0),b.toDataURL()}if(t(this,Ge)){const[b,j]=this.pageDimensions,Z=Math.round(this.width*b*z.PixelsPerInch.PDF_TO_CSS_UNITS),ot=Math.round(this.height*j*z.PixelsPerInch.PDF_TO_CSS_UNITS),Et=new OffscreenCanvas(Z,ot);return Et.getContext("2d").drawImage(t(this,Me),0,0,t(this,Me).width,t(this,Me).height,0,0,Z,ot),Et.transferToImageBitmap()}return structuredClone(t(this,Me))},hs=new WeakSet,cr=function(){P(this,fi,new ResizeObserver(r=>{const b=r[0].contentRect;b.width&&b.height&&E(this,os,lr).call(this,b.width,b.height)})),t(this,fi).observe(this.div)},Ae(T,"_type","stamp"),Ae(T,"_editorType",u.AnnotationEditorType.STAMP);const ei=class{constructor({uiManager:nt,pageIndex:r,div:b,accessibilityManager:j,annotationLayer:Z,drawLayer:ot,textLayer:Et,viewport:Lt,l10n:gt}){f(this,Xi);f(this,Vi);f(this,bi);f(this,$i);f(this,Yi);f(this,mi,void 0);f(this,Ei,!1);f(this,Ze,null);f(this,zi,this.pointerup.bind(this));f(this,cs,this.pointerUpAfterSelection.bind(this));f(this,Ui,this.pointerdown.bind(this));f(this,_e,null);f(this,Gi,this.selectionStart.bind(this));f(this,Be,new Map);f(this,li,!1);f(this,Ti,!1);f(this,Fi,!1);f(this,ti,null);f(this,oe,void 0);const Mt=[...t(ei,hi).values()];if(!ei._initialized){ei._initialized=!0;for(const It of Mt)It.initialize(gt)}nt.registerEditorTypes(Mt),P(this,oe,nt),this.pageIndex=r,this.div=b,P(this,mi,j),P(this,Ze,Z),this.viewport=Lt,P(this,ti,Et),this.drawLayer=ot,t(this,oe).addLayer(this)}get isEmpty(){return t(this,Be).size===0}updateToolbar(nt){t(this,oe).updateToolbar(nt)}updateMode(nt=t(this,oe).getMode()){switch(E(this,Yi,dn).call(this),nt){case u.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;case u.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case u.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}if(nt!==u.AnnotationEditorType.NONE){const{classList:r}=this.div;for(const b of t(ei,hi).values())r.toggle(`${b._type}Editing`,nt===b._editorType);this.div.hidden=!1}}addInkEditorIfNeeded(nt){if(t(this,oe).getMode()!==u.AnnotationEditorType.INK)return;if(!nt){for(const b of t(this,Be).values())if(b.isEmpty()){b.setInBackground();return}}E(this,bi,ts).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(nt){t(this,oe).setEditingState(nt)}addCommands(nt){t(this,oe).addCommands(nt)}togglePointerEvents(nt=!1){this.div.classList.toggle("disabled",!nt)}enable(){this.togglePointerEvents(!0);const nt=new Set;for(const b of t(this,Be).values())b.enableEditing(),b.annotationElementId&&nt.add(b.annotationElementId);if(!t(this,Ze))return;const r=t(this,Ze).getEditableAnnotations();for(const b of r){if(b.hide(),t(this,oe).isDeletedAnnotationElement(b.data.id)||nt.has(b.data.id))continue;const j=this.deserialize(b);j&&(this.addOrRebuild(j),j.enableEditing())}}disable(){var b;P(this,Fi,!0),this.togglePointerEvents(!1);const nt=new Set;for(const j of t(this,Be).values()){if(j.disableEditing(),!j.annotationElementId||j.serialize()!==null){nt.add(j.annotationElementId);continue}(b=this.getEditableAnnotation(j.annotationElementId))==null||b.show(),j.remove()}if(t(this,Ze)){const j=t(this,Ze).getEditableAnnotations();for(const Z of j){const{id:ot}=Z.data;nt.has(ot)||t(this,oe).isDeletedAnnotationElement(ot)||Z.show()}}E(this,Yi,dn).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const j of t(ei,hi).values())r.remove(`${j._type}Editing`);this.disableTextSelection(),P(this,Fi,!1)}getEditableAnnotation(nt){var r;return((r=t(this,Ze))==null?void 0:r.getEditableAnnotation(nt))||null}setActiveEditor(nt){t(this,oe).getActive()!==nt&&t(this,oe).setActiveEditor(nt)}enableTextSelection(){var nt;(nt=t(this,ti))!=null&&nt.div&&document.addEventListener("selectstart",t(this,Gi))}disableTextSelection(){var nt;(nt=t(this,ti))!=null&&nt.div&&document.removeEventListener("selectstart",t(this,Gi))}enableClick(){this.div.addEventListener("pointerdown",t(this,Ui)),this.div.addEventListener("pointerup",t(this,zi))}disableClick(){this.div.removeEventListener("pointerdown",t(this,Ui)),this.div.removeEventListener("pointerup",t(this,zi))}attach(nt){t(this,Be).set(nt.id,nt);const{annotationElementId:r}=nt;r&&t(this,oe).isDeletedAnnotationElement(r)&&t(this,oe).removeDeletedAnnotationElement(nt)}detach(nt){var r;t(this,Be).delete(nt.id),(r=t(this,mi))==null||r.removePointerInTextLayer(nt.contentDiv),!t(this,Fi)&&nt.annotationElementId&&t(this,oe).addDeletedAnnotationElement(nt)}remove(nt){this.detach(nt),t(this,oe).removeEditor(nt),nt.div.remove(),nt.isAttachedToDOM=!1,t(this,Ti)||this.addInkEditorIfNeeded(!1)}changeParent(nt){var r;nt.parent!==this&&(nt.annotationElementId&&(t(this,oe).addDeletedAnnotationElement(nt.annotationElementId),it.AnnotationEditor.deleteAnnotationElement(nt),nt.annotationElementId=null),this.attach(nt),(r=nt.parent)==null||r.detach(nt),nt.setParent(this),nt.div&&nt.isAttachedToDOM&&(nt.div.remove(),this.div.append(nt.div)))}add(nt){if(this.changeParent(nt),t(this,oe).addEditor(nt),this.attach(nt),!nt.isAttachedToDOM){const r=nt.render();this.div.append(r),nt.isAttachedToDOM=!0}nt.fixAndSetPosition(),nt.onceAdded(),t(this,oe).addToAnnotationStorage(nt)}moveEditorInDOM(nt){var b;if(!nt.isAttachedToDOM)return;const{activeElement:r}=document;nt.div.contains(r)&&!t(this,_e)&&(nt._focusEventsAllowed=!1,P(this,_e,setTimeout(()=>{P(this,_e,null),nt.div.contains(document.activeElement)?nt._focusEventsAllowed=!0:(nt.div.addEventListener("focusin",()=>{nt._focusEventsAllowed=!0},{once:!0}),r.focus())},0))),nt._structTreeParentId=(b=t(this,mi))==null?void 0:b.moveElementInDOM(this.div,nt.div,nt.contentDiv,!0)}addOrRebuild(nt){nt.needsToBeRebuilt()?(nt.parent||(nt.parent=this),nt.rebuild()):this.add(nt)}addUndoableEditor(nt){const r=()=>nt._uiManager.rebuild(nt),b=()=>{nt.remove()};this.addCommands({cmd:r,undo:b,mustExec:!1})}getNextId(){return t(this,oe).getId()}canCreateNewEmptyEditor(){var nt;return(nt=t(this,Xi,ln))==null?void 0:nt.canCreateNewEmptyEditor()}pasteEditor(nt,r){t(this,oe).updateToolbar(nt),t(this,oe).updateMode(nt);const{offsetX:b,offsetY:j}=E(this,$i,cn).call(this),Z=this.getNextId(),ot=E(this,Vi,hn).call(this,vi({parent:this,id:Z,x:b,y:j,uiManager:t(this,oe),isCentered:!0},r));ot&&this.add(ot)}deserialize(nt){var r,b;return((b=t(ei,hi).get((r=nt.annotationType)!=null?r:nt.annotationEditorType))==null?void 0:b.deserialize(nt,this,t(this,oe)))||null}addNewEditor(){E(this,bi,ts).call(this,E(this,$i,cn).call(this),!0)}setSelected(nt){t(this,oe).setSelected(nt)}toggleSelected(nt){t(this,oe).toggleSelected(nt)}isSelected(nt){return t(this,oe).isSelected(nt)}unselect(nt){t(this,oe).unselect(nt)}selectionStart(nt){var r;(r=t(this,ti))==null||r.div.addEventListener("pointerup",t(this,cs),{once:!0})}pointerUpAfterSelection(nt){var It;const r=document.getSelection();if(r.rangeCount===0)return;const b=r.getRangeAt(0);if(b.collapsed||!((It=t(this,ti))!=null&&It.div.contains(b.commonAncestorContainer)))return;const{x:j,y:Z,width:ot,height:Et}=t(this,ti).div.getBoundingClientRect(),Lt=b.getClientRects();let gt;switch(this.viewport.rotation){case 90:gt=(pe,Se,Ee,Te)=>({x:(Se-Z)/Et,y:1-(pe+Ee-j)/ot,width:Te/Et,height:Ee/ot});break;case 180:gt=(pe,Se,Ee,Te)=>({x:1-(pe+Ee-j)/ot,y:1-(Se+Te-Z)/Et,width:Ee/ot,height:Te/Et});break;case 270:gt=(pe,Se,Ee,Te)=>({x:1-(Se+Te-Z)/Et,y:(pe-j)/ot,width:Te/Et,height:Ee/ot});break;default:gt=(pe,Se,Ee,Te)=>({x:(pe-j)/ot,y:(Se-Z)/Et,width:Ee/ot,height:Te/Et});break}const Mt=[];for(const{x:pe,y:Se,width:Ee,height:Te}of Lt)Ee===0||Te===0||Mt.push(gt(pe,Se,Ee,Te));Mt.length!==0&&E(this,bi,ts).call(this,nt,!1,{boxes:Mt}),r.empty()}pointerup(nt){const{isMac:r}=u.FeatureTest.platform;if(!(nt.button!==0||nt.ctrlKey&&r)&&nt.target===this.div&&t(this,li)){if(P(this,li,!1),!t(this,Ei)){P(this,Ei,!0);return}if(t(this,oe).getMode()===u.AnnotationEditorType.STAMP){t(this,oe).unselectAll();return}E(this,bi,ts).call(this,nt,!1)}}pointerdown(nt){if(t(this,oe).getMode()===u.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,li)){P(this,li,!1);return}const{isMac:r}=u.FeatureTest.platform;if(nt.button!==0||nt.ctrlKey&&r||nt.target!==this.div)return;P(this,li,!0);const b=t(this,oe).getActive();P(this,Ei,!b||b.isEmpty())}findNewParent(nt,r,b){const j=t(this,oe).findParent(r,b);return j===null||j===this?!1:(j.changeParent(nt),!0)}destroy(){var nt,r;((nt=t(this,oe).getActive())==null?void 0:nt.parent)===this&&(t(this,oe).commitOrRemove(),t(this,oe).setActiveEditor(null)),t(this,_e)&&(clearTimeout(t(this,_e)),P(this,_e,null));for(const b of t(this,Be).values())(r=t(this,mi))==null||r.removePointerInTextLayer(b.contentDiv),b.setParent(null),b.isAttachedToDOM=!1,b.div.remove();this.div=null,t(this,Be).clear(),t(this,oe).removeLayer(this)}render({viewport:nt}){this.viewport=nt,(0,z.setLayerDimensions)(this.div,nt);for(const r of t(this,oe).getEditors(this.pageIndex))this.add(r);this.updateMode()}update({viewport:nt}){t(this,oe).commitOrRemove();const r=this.viewport.rotation,b=nt.rotation;if(this.viewport=nt,(0,z.setLayerDimensions)(this.div,{rotation:b}),r!==b)for(const j of t(this,Be).values())j.rotate(b);this.updateMode()}get pageDimensions(){const{pageWidth:nt,pageHeight:r}=this.viewport.rawDims;return[nt,r]}};let W=ei;mi=new WeakMap,Ei=new WeakMap,Ze=new WeakMap,zi=new WeakMap,cs=new WeakMap,Ui=new WeakMap,_e=new WeakMap,Gi=new WeakMap,Be=new WeakMap,li=new WeakMap,Ti=new WeakMap,Fi=new WeakMap,ti=new WeakMap,oe=new WeakMap,hi=new WeakMap,Xi=new WeakSet,ln=function(){return t(ei,hi).get(t(this,oe).getMode())},Vi=new WeakSet,hn=function(nt){const r=t(this,Xi,ln);return r?new r.prototype.constructor(nt):null},bi=new WeakSet,ts=function(nt,r,b={}){const j=this.getNextId(),Z=E(this,Vi,hn).call(this,vi({parent:this,id:j,x:nt.offsetX,y:nt.offsetY,uiManager:t(this,oe),isCentered:r},b));return Z&&this.add(Z),Z},$i=new WeakSet,cn=function(){const{x:nt,y:r,width:b,height:j}=this.div.getBoundingClientRect(),Z=Math.max(0,nt),ot=Math.max(0,r),Et=Math.min(window.innerWidth,nt+b),Lt=Math.min(window.innerHeight,r+j),gt=(Z+Et)/2-nt,Mt=(ot+Lt)/2-r,[It,pe]=this.viewport.rotation%180===0?[gt,Mt]:[Mt,gt];return{offsetX:It,offsetY:pe}},Yi=new WeakSet,dn=function(){P(this,Ti,!0);for(const nt of t(this,Be).values())nt.isEmpty()&&nt.remove();P(this,Ti,!1)},Ae(W,"_initialized",!1),f(W,hi,new Map([lt,N,T,A].map(nt=>[nt._editorType,nt])))},97:(ie,Nt,rt)=>{var lt,Q,H,A,z,N,T,W,x,O,un,G,fn,F,dr,C,ur;rt.d(Nt,{ColorPicker:()=>q});var u=rt(266),it=rt(812),k=rt(473);const st=class{constructor({editor:_=null,uiManager:mt=null}){f(this,O);f(this,G);f(this,F);f(this,C);f(this,lt,E(this,F,dr).bind(this));f(this,Q,null);f(this,H,null);f(this,A,void 0);f(this,z,null);f(this,N,!1);f(this,T,!1);f(this,W,void 0);f(this,x,null);var wt;P(this,T,!_),P(this,x,(_==null?void 0:_._uiManager)||mt),P(this,W,t(this,x)._eventBus),P(this,A,(_==null?void 0:_.color)||((wt=t(this,x))==null?void 0:wt.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,u.shadow)(this,"_keyboardManager",new it.KeyboardManager([[["Escape","mac+Escape"],st.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],st.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],st.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],st.prototype._moveToPrevious],[["Home","mac+Home"],st.prototype._moveToBeginning],[["End","mac+End"],st.prototype._moveToEnd]]))}renderButton(){const _=P(this,Q,document.createElement("button"));_.className="colorPicker",_.tabIndex="0",_.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),_.setAttribute("aria-haspopup",!0),_.addEventListener("click",E(this,C,ur).bind(this));const mt=P(this,H,document.createElement("span"));return mt.className="swatch",mt.style.backgroundColor=t(this,A),_.append(mt),_}renderMainDropdown(){const _=P(this,z,E(this,O,un).call(this,u.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR));return _.setAttribute("aria-orientation","horizontal"),_.setAttribute("aria-labelledby","highlightColorPickerLabel"),_}_colorSelectFromKeyboard(_){const mt=_.target.getAttribute("data-color");mt&&E(this,G,fn).call(this,mt,_)}_moveToNext(_){var mt,wt;if(_.target===t(this,Q)){(mt=t(this,z).firstChild)==null||mt.focus();return}(wt=_.target.nextSibling)==null||wt.focus()}_moveToPrevious(_){var mt;(mt=_.target.previousSibling)==null||mt.focus()}_moveToBeginning(){var _;(_=t(this,z).firstChild)==null||_.focus()}_moveToEnd(){var _;(_=t(this,z).lastChild)==null||_.focus()}hideDropdown(){var _;(_=t(this,z))==null||_.classList.add("hidden")}_hideDropdownFromKeyboard(){t(this,T)||!t(this,z)||t(this,z).classList.contains("hidden")||(this.hideDropdown(),t(this,Q).removeEventListener("keydown",t(this,lt)),t(this,Q).focus({preventScroll:!0,focusVisible:t(this,N)}))}updateColor(_){if(t(this,H)&&(t(this,H).style.backgroundColor=_),!t(this,z))return;const mt=t(this,x).highlightColors.values();for(const wt of t(this,z).children)wt.setAttribute("aria-selected",mt.next().value===_)}destroy(){var _,mt;(_=t(this,Q))==null||_.remove(),P(this,Q,null),P(this,H,null),(mt=t(this,z))==null||mt.remove(),P(this,z,null)}};let q=st;lt=new WeakMap,Q=new WeakMap,H=new WeakMap,A=new WeakMap,z=new WeakMap,N=new WeakMap,T=new WeakMap,W=new WeakMap,x=new WeakMap,O=new WeakSet,un=function(_){const mt=document.createElement("div");mt.addEventListener("contextmenu",k.noContextMenu),mt.className="dropdown",mt.role="listbox",mt.setAttribute("aria-multiselectable",!1),mt.setAttribute("aria-orientation","vertical"),mt.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[wt,Ut]of t(this,x).highlightColors){const Bt=document.createElement("button");Bt.tabIndex="0",Bt.role="option",Bt.setAttribute("data-color",Ut),Bt.title=wt,Bt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${wt}`);const _t=document.createElement("span");Bt.append(_t),_t.className="swatch",_t.style.backgroundColor=Ut,Bt.setAttribute("aria-selected",Ut===t(this,A)),Bt.addEventListener("click",E(this,G,fn).bind(this,_,Ut)),mt.append(Bt)}return mt.addEventListener("keydown",t(this,lt)),mt},G=new WeakSet,fn=function(_,mt,wt){wt.stopPropagation(),t(this,W).dispatch("switchannotationeditorparams",{source:this,type:_,value:mt})},F=new WeakSet,dr=function(_){st._keyboardManager.exec(this,_)},C=new WeakSet,ur=function(_){if(t(this,z)&&!t(this,z).classList.contains("hidden")){this.hideDropdown();return}if(t(this,Q).addEventListener("keydown",t(this,lt)),P(this,N,_.detail===0),t(this,z)){t(this,z).classList.remove("hidden");return}const mt=P(this,z,E(this,O,un).call(this,u.AnnotationEditorParamsType.HIGHLIGHT_COLOR));t(this,Q).append(mt)}},115:(ie,Nt,rt)=>{var A,z,N,T,W,x,O,I,pn,F,X,C,$,st,fr,_,pr,wt,gr,Bt,Rs,Kt,mr,Yt,gn,ne,Xt,te,Gt,se,le,ee,qt,he,ge,Wt,ae,we,xe,Ce,ke,M,mn,i,bn,p,An,h,vn,w,br,L,Ar,tt,yn,at,Sn,kt,wn,St,vr,s,yr,m,Sr,et,wr,Tt,xn,jt,es;rt.d(Nt,{AnnotationEditor:()=>Q});var u=rt(812),it=rt(266),k=rt(473);const V=class{constructor(y){f(this,I);f(this,A,"");f(this,z,!1);f(this,N,null);f(this,T,null);f(this,W,null);f(this,x,!1);f(this,O,null);P(this,O,y)}static initialize(y){V._l10nPromise||(V._l10nPromise=y)}render(){return be(this,null,function*(){const y=P(this,N,document.createElement("button"));y.className="altText";const Y=yield V._l10nPromise.get("pdfjs-editor-alt-text-button-label");y.textContent=Y,y.setAttribute("aria-label",Y),y.tabIndex="0",y.addEventListener("contextmenu",k.noContextMenu),y.addEventListener("pointerdown",ut=>ut.stopPropagation());const ct=ut=>{ut.preventDefault(),t(this,O)._uiManager.editAltText(t(this,O))};return y.addEventListener("click",ct,{capture:!0}),y.addEventListener("keydown",ut=>{ut.target===y&&ut.key==="Enter"&&(P(this,x,!0),ct(ut))}),yield E(this,I,pn).call(this),y})}finish(){t(this,N)&&(t(this,N).focus({focusVisible:t(this,x)}),P(this,x,!1))}get data(){return{altText:t(this,A),decorative:t(this,z)}}set data({altText:y,decorative:Y}){t(this,A)===y&&t(this,z)===Y||(P(this,A,y),P(this,z,Y),E(this,I,pn).call(this))}toggle(y=!1){t(this,N)&&(!y&&t(this,W)&&(clearTimeout(t(this,W)),P(this,W,null)),t(this,N).disabled=!y)}destroy(){var y;(y=t(this,N))==null||y.remove(),P(this,N,null),P(this,T,null)}};let q=V;A=new WeakMap,z=new WeakMap,N=new WeakMap,T=new WeakMap,W=new WeakMap,x=new WeakMap,O=new WeakMap,I=new WeakSet,pn=function(){return be(this,null,function*(){var ut;const y=t(this,N);if(!y)return;if(!t(this,A)&&!t(this,z)){y.classList.remove("done"),(ut=t(this,T))==null||ut.remove();return}y.classList.add("done"),V._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(Pt=>{y.setAttribute("aria-label",Pt)});let Y=t(this,T);if(!Y){P(this,T,Y=document.createElement("span")),Y.className="tooltip",Y.setAttribute("role","tooltip");const Pt=Y.id=`alt-text-tooltip-${t(this,O).id}`;y.setAttribute("aria-describedby",Pt);const At=100;y.addEventListener("mouseenter",()=>{P(this,W,setTimeout(()=>{P(this,W,null),t(this,T).classList.add("show"),t(this,O)._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:t(this,O).editorType,data:{action:"alt_text_tooltip"}}})},At))}),y.addEventListener("mouseleave",()=>{var c;t(this,W)&&(clearTimeout(t(this,W)),P(this,W,null)),(c=t(this,T))==null||c.classList.remove("show")})}Y.innerText=t(this,z)?yield V._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,A),Y.parentNode||y.append(Y);const ct=t(this,O).getImageForAltText();ct==null||ct.setAttribute("aria-describedby",Y.id)})},Ae(q,"_l10nPromise",null);const fe=class{constructor(y){f(this,_);f(this,wt);f(this,Bt);f(this,Kt);f(this,Yt);f(this,F,null);f(this,X,null);f(this,C,void 0);f(this,$,null);P(this,C,y)}render(){const y=P(this,F,document.createElement("div"));y.className="editToolbar",y.addEventListener("contextmenu",k.noContextMenu),y.addEventListener("pointerdown",E(fe,st,fr));const Y=P(this,$,document.createElement("div"));Y.className="buttons",y.append(Y);const ct=t(this,C).toolbarPosition;if(ct){const{style:ut}=y,Pt=t(this,C)._uiManager.direction==="ltr"?1-ct[0]:ct[0];ut.insetInlineEnd=`${100*Pt}%`,ut.top=`calc(${100*ct[1]}% + var(--editor-toolbar-vert-offset))`}return E(this,Kt,mr).call(this),y}hide(){var y;t(this,F).classList.add("hidden"),(y=t(this,X))==null||y.hideDropdown()}show(){t(this,F).classList.remove("hidden")}addAltTextButton(y){E(this,Bt,Rs).call(this,y),t(this,$).prepend(y,t(this,Yt,gn))}addColorPicker(y){P(this,X,y);const Y=y.renderButton();E(this,Bt,Rs).call(this,Y),t(this,$).prepend(Y,t(this,Yt,gn))}remove(){var y;t(this,F).remove(),(y=t(this,X))==null||y.destroy(),P(this,X,null)}};let lt=fe;F=new WeakMap,X=new WeakMap,C=new WeakMap,$=new WeakMap,st=new WeakSet,fr=function(y){y.stopPropagation()},_=new WeakSet,pr=function(y){t(this,C)._focusEventsAllowed=!1,y.preventDefault(),y.stopPropagation()},wt=new WeakSet,gr=function(y){t(this,C)._focusEventsAllowed=!0,y.preventDefault(),y.stopPropagation()},Bt=new WeakSet,Rs=function(y){y.addEventListener("focusin",E(this,_,pr).bind(this),{capture:!0}),y.addEventListener("focusout",E(this,wt,gr).bind(this),{capture:!0}),y.addEventListener("contextmenu",k.noContextMenu)},Kt=new WeakSet,mr=function(){const y=document.createElement("button");y.className="delete",y.tabIndex=0,y.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,C).editorType}-button`),E(this,Bt,Rs).call(this,y),y.addEventListener("click",Y=>{t(this,C)._uiManager.delete()}),t(this,$).append(y)},Yt=new WeakSet,gn=function(){const y=document.createElement("div");return y.className="divider",y},f(lt,st);const Dt=class{constructor(y){f(this,M);f(this,i);f(this,h);f(this,w);f(this,L);f(this,tt);f(this,at);f(this,kt);f(this,St);f(this,s);f(this,m);f(this,et);f(this,Tt);f(this,jt);f(this,ne,null);f(this,Xt,null);f(this,te,!1);f(this,Gt,null);f(this,se,null);f(this,le,this.focusin.bind(this));f(this,ee,this.focusout.bind(this));f(this,qt,null);f(this,he,"");f(this,ge,!1);f(this,Wt,!1);f(this,ae,!1);f(this,we,!1);f(this,xe,null);Ae(this,"_initialOptions",Object.create(null));Ae(this,"_uiManager",null);Ae(this,"_focusEventsAllowed",!0);Ae(this,"_l10nPromise",null);f(this,Ce,!1);f(this,ke,Dt._zIndex++);this.constructor===Dt&&(0,it.unreachable)("Cannot initialize AnnotationEditor."),this.parent=y.parent,this.id=y.id,this.width=this.height=null,this.pageIndex=y.parent.pageIndex,this.name=y.name,this.div=null,this._uiManager=y.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=y.isCentered,this._structTreeParentId=null;const{rotation:Y,rawDims:{pageWidth:ct,pageHeight:ut,pageX:Pt,pageY:At}}=this.parent.viewport;this.rotation=Y,this.pageRotation=(360+Y-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[ct,ut],this.pageTranslation=[Pt,At];const[c,e]=this.parentDimensions;this.x=y.x/c,this.y=y.y/e,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const y=Dt.prototype._resizeWithKeyboard,Y=u.AnnotationEditorUIManager.TRANSLATE_SMALL,ct=u.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,it.shadow)(this,"_resizerKeyboardManager",new u.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],y,{args:[-Y,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],y,{args:[-ct,0]}],[["ArrowRight","mac+ArrowRight"],y,{args:[Y,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],y,{args:[ct,0]}],[["ArrowUp","mac+ArrowUp"],y,{args:[0,-Y]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],y,{args:[0,-ct]}],[["ArrowDown","mac+ArrowDown"],y,{args:[0,Y]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],y,{args:[0,ct]}],[["Escape","mac+Escape"],Dt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,it.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(y){const Y=new H({id:y.parent.getNextId(),parent:y.parent,uiManager:y._uiManager});Y.annotationElementId=y.annotationElementId,Y.deleted=!0,Y._uiManager.addToAnnotationStorage(Y)}static initialize(y,Y=null){if(Dt._l10nPromise||(Dt._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(ut=>[ut,y.get(ut.replaceAll(/([A-Z])/g,Pt=>`-${Pt.toLowerCase()}`))]))),Y!=null&&Y.strings)for(const ut of Y.strings)Dt._l10nPromise.set(ut,y.get(ut));if(Dt._borderLineWidth!==-1)return;const ct=getComputedStyle(document.documentElement);Dt._borderLineWidth=parseFloat(ct.getPropertyValue("--outline-width"))||0}static updateDefaultParams(y,Y){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(y){return!1}static paste(y,Y){(0,it.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,Ce)}set _isDraggable(y){var Y;P(this,Ce,y),(Y=this.div)==null||Y.classList.toggle("draggable",y)}get isEnterHandled(){return!0}center(){const[y,Y]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Y/(y*2),this.y+=this.width*y/(Y*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Y/(y*2),this.y-=this.width*y/(Y*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(y){this._uiManager.addCommands(y)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,ke)}setParent(y){y!==null?(this.pageIndex=y.pageIndex,this.pageDimensions=y.pageDimensions):E(this,jt,es).call(this),this.parent=y}focusin(y){this._focusEventsAllowed&&(t(this,ge)?P(this,ge,!1):this.parent.setSelected(this))}focusout(y){var ct;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Y=y.relatedTarget;Y!=null&&Y.closest(`#${this.id}`)||(y.preventDefault(),(ct=this.parent)!=null&&ct.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(y,Y,ct,ut){const[Pt,At]=this.parentDimensions;[ct,ut]=this.screenToPageTranslation(ct,ut),this.x=(y+ct)/Pt,this.y=(Y+ut)/At,this.fixAndSetPosition()}translate(y,Y){E(this,M,mn).call(this,this.parentDimensions,y,Y)}translateInPage(y,Y){E(this,M,mn).call(this,this.pageDimensions,y,Y),this.div.scrollIntoView({block:"nearest"})}drag(y,Y){const[ct,ut]=this.parentDimensions;if(this.x+=y/ct,this.y+=Y/ut,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:l,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,l,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:Pt,y:At}=this;const[c,e]=E(this,i,bn).call(this);Pt+=c,At+=e,this.div.style.left=`${(100*Pt).toFixed(2)}%`,this.div.style.top=`${(100*At).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(y=this.rotation){const[Y,ct]=this.pageDimensions;let{x:ut,y:Pt,width:At,height:c}=this;switch(At*=Y,c*=ct,ut*=Y,Pt*=ct,y){case 0:ut=Math.max(0,Math.min(Y-At,ut)),Pt=Math.max(0,Math.min(ct-c,Pt));break;case 90:ut=Math.max(0,Math.min(Y-c,ut)),Pt=Math.min(ct,Math.max(At,Pt));break;case 180:ut=Math.min(Y,Math.max(At,ut)),Pt=Math.min(ct,Math.max(c,Pt));break;case 270:ut=Math.min(Y,Math.max(c,ut)),Pt=Math.max(0,Math.min(ct-At,Pt));break}this.x=ut/=Y,this.y=Pt/=ct;const[e,l]=E(this,i,bn).call(this);ut+=e,Pt+=l;const{style:v}=this.div;v.left=`${(100*ut).toFixed(2)}%`,v.top=`${(100*Pt).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(y,Y){var ct;return E(ct=Dt,p,An).call(ct,y,Y,this.parentRotation)}pageTranslationToScreen(y,Y){var ct;return E(ct=Dt,p,An).call(ct,y,Y,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:y,pageDimensions:[Y,ct]}=this,ut=Y*y,Pt=ct*y;return it.FeatureTest.isCSSRoundSupported?[Math.round(ut),Math.round(Pt)]:[ut,Pt]}setDims(y,Y){const[ct,ut]=this.parentDimensions;this.div.style.width=`${(100*y/ct).toFixed(2)}%`,t(this,te)||(this.div.style.height=`${(100*Y/ut).toFixed(2)}%`)}fixDims(){const{style:y}=this.div,{height:Y,width:ct}=y,ut=ct.endsWith("%"),Pt=!t(this,te)&&Y.endsWith("%");if(ut&&Pt)return;const[At,c]=this.parentDimensions;ut||(y.width=`${(100*parseFloat(ct)/At).toFixed(2)}%`),!t(this,te)&&!Pt&&(y.height=`${(100*parseFloat(Y)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var y;(y=t(this,Xt))==null||y.finish()}addEditToolbar(){return be(this,null,function*(){return t(this,qt)||t(this,ae)?t(this,qt):(P(this,qt,new lt(this)),this.div.append(t(this,qt).render()),t(this,Xt)&&t(this,qt).addAltTextButton(yield t(this,Xt).render()),t(this,qt))})}removeEditToolbar(){var y;t(this,qt)&&(t(this,qt).remove(),P(this,qt,null),(y=t(this,Xt))==null||y.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}addAltTextButton(){return be(this,null,function*(){t(this,Xt)||(q.initialize(Dt._l10nPromise),P(this,Xt,new q(this)),yield this.addEditToolbar())})}get altTextData(){var y;return(y=t(this,Xt))==null?void 0:y.data}set altTextData(y){t(this,Xt)&&(t(this,Xt).data=y)}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,le)),this.div.addEventListener("focusout",t(this,ee));const[y,Y]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Y/y).toFixed(2)}%`,this.div.style.maxHeight=`${(100*y/Y).toFixed(2)}%`);const[ct,ut]=this.getInitialTranslation();return this.translate(ct,ut),(0,u.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(y){const{isMac:Y}=it.FeatureTest.platform;if(y.button!==0||y.ctrlKey&&Y){y.preventDefault();return}if(P(this,ge,!0),this._isDraggable){E(this,St,vr).call(this,y);return}E(this,kt,wn).call(this,y)}moveInDOM(){t(this,xe)&&clearTimeout(t(this,xe)),P(this,xe,setTimeout(()=>{var y;P(this,xe,null),(y=this.parent)==null||y.moveEditorInDOM(this)},0))}_setParentAndPosition(y,Y,ct){y.changeParent(this),this.x=Y,this.y=ct,this.fixAndSetPosition()}getRect(y,Y,ct=this.rotation){const ut=this.parentScale,[Pt,At]=this.pageDimensions,[c,e]=this.pageTranslation,l=y/ut,v=Y/ut,R=this.x*Pt,B=this.y*At,K=this.width*Pt,pt=this.height*At;switch(ct){case 0:return[R+l+c,At-B-v-pt+e,R+l+K+c,At-B-v+e];case 90:return[R+v+c,At-B+l+e,R+v+pt+c,At-B+l+K+e];case 180:return[R-l-K+c,At-B+v+e,R-l+c,At-B+v+pt+e];case 270:return[R-v-pt+c,At-B-l-K+e,R-v+c,At-B-l+e];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(y,Y){const[ct,ut,Pt,At]=y,c=Pt-ct,e=At-ut;switch(this.rotation){case 0:return[ct,Y-At,c,e];case 90:return[ct,Y-ut,e,c];case 180:return[Pt,Y-ut,c,e];case 270:return[Pt,Y-At,e,c];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){P(this,ae,!0)}disableEditMode(){P(this,ae,!1)}isInEditMode(){return t(this,ae)}shouldGetKeyboardEvents(){return t(this,we)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var y,Y;(y=this.div)==null||y.addEventListener("focusin",t(this,le)),(Y=this.div)==null||Y.addEventListener("focusout",t(this,ee))}rotate(y){}serialize(y=!1,Y=null){(0,it.unreachable)("An editor must be serializable")}static deserialize(y,Y,ct){const ut=new this.prototype.constructor({parent:Y,id:Y.getNextId(),uiManager:ct});ut.rotation=y.rotation;const[Pt,At]=ut.pageDimensions,[c,e,l,v]=ut.getRectInCurrentCoords(y.rect,At);return ut.x=c/Pt,ut.y=e/At,ut.width=l/Pt,ut.height=v/At,ut}remove(){this.div.removeEventListener("focusin",t(this,le)),this.div.removeEventListener("focusout",t(this,ee)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,xe)&&(clearTimeout(t(this,xe)),P(this,xe,null)),E(this,jt,es).call(this),this.removeEditToolbar()}get isResizable(){return!1}makeResizable(){this.isResizable&&(E(this,w,br).call(this),t(this,Gt).classList.remove("hidden"),(0,u.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(y){if(!this.isResizable||y.target!==this.div||y.key!=="Enter")return;this._uiManager.setSelected(this),P(this,se,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const Y=t(this,Gt).children;if(!t(this,ne)){P(this,ne,Array.from(Y));const At=E(this,s,yr).bind(this),c=E(this,m,Sr).bind(this);for(const e of t(this,ne)){const l=e.getAttribute("data-resizer-name");e.setAttribute("role","spinbutton"),e.addEventListener("keydown",At),e.addEventListener("blur",c),e.addEventListener("focus",E(this,et,wr).bind(this,l)),Dt._l10nPromise.get(`pdfjs-editor-resizer-label-${l}`).then(v=>e.setAttribute("aria-label",v))}}const ct=t(this,ne)[0];let ut=0;for(const At of Y){if(At===ct)break;ut++}const Pt=(360-this.rotation+this.parentRotation)%360/90*(t(this,ne).length/4);if(Pt!==ut){if(Pt<ut)for(let c=0;c<ut-Pt;c++)t(this,Gt).append(t(this,Gt).firstChild);else if(Pt>ut)for(let c=0;c<Pt-ut;c++)t(this,Gt).firstChild.before(t(this,Gt).lastChild);let At=0;for(const c of Y){const l=t(this,ne)[At++].getAttribute("data-resizer-name");Dt._l10nPromise.get(`pdfjs-editor-resizer-label-${l}`).then(v=>c.setAttribute("aria-label",v))}}E(this,Tt,xn).call(this,0),P(this,we,!0),t(this,Gt).firstChild.focus({focusVisible:!0}),y.preventDefault(),y.stopImmediatePropagation()}_resizeWithKeyboard(y,Y){t(this,we)&&E(this,at,Sn).call(this,t(this,he),{movementX:y,movementY:Y})}_stopResizingWithKeyboard(){E(this,jt,es).call(this),this.div.focus()}select(){var y,Y;if(this.makeResizable(),(y=this.div)==null||y.classList.add("selectedEditor"),!t(this,qt)){this.addEditToolbar().then(()=>{var ct,ut;(ct=this.div)!=null&&ct.classList.contains("selectedEditor")&&((ut=t(this,qt))==null||ut.show())});return}(Y=t(this,qt))==null||Y.show()}unselect(){var y,Y,ct,ut;(y=t(this,Gt))==null||y.classList.add("hidden"),(Y=this.div)==null||Y.classList.remove("selectedEditor"),(ct=this.div)!=null&&ct.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus(),(ut=t(this,qt))==null||ut.hide()}updateParams(y,Y){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,Wt)}set isEditing(y){P(this,Wt,y),this.parent&&(y?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(y,Y){P(this,te,!0);const ct=y/Y,{style:ut}=this.div;ut.aspectRatio=ct,ut.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}};let Q=Dt;ne=new WeakMap,Xt=new WeakMap,te=new WeakMap,Gt=new WeakMap,se=new WeakMap,le=new WeakMap,ee=new WeakMap,qt=new WeakMap,he=new WeakMap,ge=new WeakMap,Wt=new WeakMap,ae=new WeakMap,we=new WeakMap,xe=new WeakMap,Ce=new WeakMap,ke=new WeakMap,M=new WeakSet,mn=function([y,Y],ct,ut){[ct,ut]=this.screenToPageTranslation(ct,ut),this.x+=ct/y,this.y+=ut/Y,this.fixAndSetPosition()},i=new WeakSet,bn=function(){const[y,Y]=this.parentDimensions,{_borderLineWidth:ct}=Dt,ut=ct/y,Pt=ct/Y;switch(this.rotation){case 90:return[-ut,Pt];case 180:return[ut,Pt];case 270:return[ut,-Pt];default:return[-ut,-Pt]}},p=new WeakSet,An=function(y,Y,ct){switch(ct){case 90:return[Y,-y];case 180:return[-y,-Y];case 270:return[-Y,y];default:return[y,Y]}},h=new WeakSet,vn=function(y){switch(y){case 90:{const[Y,ct]=this.pageDimensions;return[0,-Y/ct,ct/Y,0]}case 180:return[-1,0,0,-1];case 270:{const[Y,ct]=this.pageDimensions;return[0,Y/ct,-ct/Y,0]}default:return[1,0,0,1]}},w=new WeakSet,br=function(){if(t(this,Gt))return;P(this,Gt,document.createElement("div")),t(this,Gt).classList.add("resizers");const y=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const Y of y){const ct=document.createElement("div");t(this,Gt).append(ct),ct.classList.add("resizer",Y),ct.setAttribute("data-resizer-name",Y),ct.addEventListener("pointerdown",E(this,L,Ar).bind(this,Y)),ct.addEventListener("contextmenu",k.noContextMenu),ct.tabIndex=-1}this.div.prepend(t(this,Gt))},L=new WeakSet,Ar=function(y,Y){var pt;Y.preventDefault();const{isMac:ct}=it.FeatureTest.platform;if(Y.button!==0||Y.ctrlKey&&ct)return;(pt=t(this,Xt))==null||pt.toggle(!1);const ut=E(this,at,Sn).bind(this,y),Pt=this._isDraggable;this._isDraggable=!1;const At={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",ut,At);const c=this.x,e=this.y,l=this.width,v=this.height,R=this.parent.div.style.cursor,B=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Y.target).cursor;const K=()=>{var bt;this.parent.togglePointerEvents(!0),(bt=t(this,Xt))==null||bt.toggle(!0),this._isDraggable=Pt,window.removeEventListener("pointerup",K),window.removeEventListener("blur",K),window.removeEventListener("pointermove",ut,At),this.parent.div.style.cursor=R,this.div.style.cursor=B,E(this,tt,yn).call(this,c,e,l,v)};window.addEventListener("pointerup",K),window.addEventListener("blur",K)},tt=new WeakSet,yn=function(y,Y,ct,ut){const Pt=this.x,At=this.y,c=this.width,e=this.height;Pt===y&&At===Y&&c===ct&&e===ut||this.addCommands({cmd:()=>{this.width=c,this.height=e,this.x=Pt,this.y=At;const[l,v]=this.parentDimensions;this.setDims(l*c,v*e),this.fixAndSetPosition()},undo:()=>{this.width=ct,this.height=ut,this.x=y,this.y=Y;const[l,v]=this.parentDimensions;this.setDims(l*ct,v*ut),this.fixAndSetPosition()},mustExec:!0})},at=new WeakSet,Sn=function(y,Y){const[ct,ut]=this.parentDimensions,Pt=this.x,At=this.y,c=this.width,e=this.height,l=Dt.MIN_SIZE/ct,v=Dt.MIN_SIZE/ut,R=re=>Math.round(re*1e4)/1e4,B=E(this,h,vn).call(this,this.rotation),K=(re,ye)=>[B[0]*re+B[2]*ye,B[1]*re+B[3]*ye],pt=E(this,h,vn).call(this,360-this.rotation),bt=(re,ye)=>[pt[0]*re+pt[2]*ye,pt[1]*re+pt[3]*ye];let vt,Ot,Rt=!1,Ct=!1;switch(y){case"topLeft":Rt=!0,vt=(re,ye)=>[0,0],Ot=(re,ye)=>[re,ye];break;case"topMiddle":vt=(re,ye)=>[re/2,0],Ot=(re,ye)=>[re/2,ye];break;case"topRight":Rt=!0,vt=(re,ye)=>[re,0],Ot=(re,ye)=>[0,ye];break;case"middleRight":Ct=!0,vt=(re,ye)=>[re,ye/2],Ot=(re,ye)=>[0,ye/2];break;case"bottomRight":Rt=!0,vt=(re,ye)=>[re,ye],Ot=(re,ye)=>[0,0];break;case"bottomMiddle":vt=(re,ye)=>[re/2,ye],Ot=(re,ye)=>[re/2,0];break;case"bottomLeft":Rt=!0,vt=(re,ye)=>[0,ye],Ot=(re,ye)=>[re,0];break;case"middleLeft":Ct=!0,vt=(re,ye)=>[0,ye/2],Ot=(re,ye)=>[re,ye/2];break}const $t=vt(c,e),zt=Ot(c,e);let Zt=K(...zt);const ce=R(Pt+Zt[0]),Pe=R(At+Zt[1]);let me=1,He=1,[Re,Ie]=this.screenToPageTranslation(Y.movementX,Y.movementY);if([Re,Ie]=bt(Re/ct,Ie/ut),Rt){const re=Math.hypot(c,e);me=He=Math.max(Math.min(Math.hypot(zt[0]-$t[0]-Re,zt[1]-$t[1]-Ie)/re,1/c,1/e),l/c,v/e)}else Ct?me=Math.max(l,Math.min(1,Math.abs(zt[0]-$t[0]-Re)))/c:He=Math.max(v,Math.min(1,Math.abs(zt[1]-$t[1]-Ie)))/e;const Oe=R(c*me),Ke=R(e*He);Zt=K(...Ot(Oe,Ke));const $e=ce-Zt[0],Di=Pe-Zt[1];this.width=Oe,this.height=Ke,this.x=$e,this.y=Di,this.setDims(ct*Oe,ut*Ke),this.fixAndSetPosition()},kt=new WeakSet,wn=function(y){const{isMac:Y}=it.FeatureTest.platform;y.ctrlKey&&!Y||y.shiftKey||y.metaKey&&Y?this.parent.toggleSelected(this):this.parent.setSelected(this)},St=new WeakSet,vr=function(y){const Y=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let ct,ut;Y&&(ct={passive:!0,capture:!0},ut=At=>{const[c,e]=this.screenToPageTranslation(At.movementX,At.movementY);this._uiManager.dragSelectedEditors(c,e)},window.addEventListener("pointermove",ut,ct));const Pt=()=>{window.removeEventListener("pointerup",Pt),window.removeEventListener("blur",Pt),Y&&window.removeEventListener("pointermove",ut,ct),P(this,ge,!1),this._uiManager.endDragSession()||E(this,kt,wn).call(this,y)};window.addEventListener("pointerup",Pt),window.addEventListener("blur",Pt)},s=new WeakSet,yr=function(y){Dt._resizerKeyboardManager.exec(this,y)},m=new WeakSet,Sr=function(y){var Y;t(this,we)&&((Y=y.relatedTarget)==null?void 0:Y.parentNode)!==t(this,Gt)&&E(this,jt,es).call(this)},et=new WeakSet,wr=function(y){P(this,he,t(this,we)?y:"")},Tt=new WeakSet,xn=function(y){if(t(this,ne))for(const Y of t(this,ne))Y.tabIndex=y},jt=new WeakSet,es=function(){if(P(this,we,!1),E(this,Tt,xn).call(this,-1),t(this,se)){const{savedX:y,savedY:Y,savedWidth:ct,savedHeight:ut}=t(this,se);E(this,tt,yn).call(this,y,Y,ct,ut),P(this,se,null)}},f(Q,p),Ae(Q,"_borderLineWidth",-1),Ae(Q,"_colorManager",new u.ColorManager),Ae(Q,"_zIndex",1);class H extends Q{constructor(y){super(y),this.annotationElementId=y.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},405:(ie,Nt,rt)=>{var it,k,q,lt,xr,H,ks,z,Cr,T,Er,x,Cn;rt.d(Nt,{Outliner:()=>u});class u{constructor(G,V=0,F=0,X=!0){f(this,lt);f(this,H);f(this,z);f(this,T);f(this,x);f(this,it,void 0);f(this,k,[]);f(this,q,[]);let C=1/0,$=-1/0,st=1/0,xt=-1/0;const mt=ps(10,-4);for(const{x:Yt,y:Jt,width:fe,height:ne}of G){const Xt=Math.floor((Yt-V)/mt)*mt,te=Math.ceil((Yt+fe+V)/mt)*mt,Gt=Math.floor((Jt-V)/mt)*mt,se=Math.ceil((Jt+ne+V)/mt)*mt,le=[Xt,Gt,se,!0],ee=[te,Gt,se,!1];t(this,k).push(le,ee),C=Math.min(C,Xt),$=Math.max($,te),st=Math.min(st,Gt),xt=Math.max(xt,se)}const wt=$-C+2*F,Ut=xt-st+2*F,Bt=C-F,_t=st-F,Kt=t(this,k).at(X?-1:-2),Fe=[Kt[0],Kt[2]];for(const Yt of t(this,k)){const[Jt,fe,ne]=Yt;Yt[0]=(Jt-Bt)/wt,Yt[1]=(fe-_t)/Ut,Yt[2]=(ne-_t)/Ut}P(this,it,{x:Bt,y:_t,width:wt,height:Ut,lastPoint:Fe})}getOutlines(){t(this,k).sort((V,F)=>V[0]-F[0]||V[1]-F[1]||V[2]-F[2]);const G=[];for(const V of t(this,k))V[3]?(G.push(...E(this,x,Cn).call(this,V)),E(this,z,Cr).call(this,V)):(E(this,T,Er).call(this,V),G.push(...E(this,x,Cn).call(this,V)));return E(this,lt,xr).call(this,G)}}it=new WeakMap,k=new WeakMap,q=new WeakMap,lt=new WeakSet,xr=function(G){const V=[],F=new Set;for(const $ of G){const[st,xt,_]=$;V.push([st,xt,$],[st,_,$])}V.sort(($,st)=>$[1]-st[1]||$[0]-st[0]);for(let $=0,st=V.length;$<st;$+=2){const xt=V[$][2],_=V[$+1][2];xt.push(_),_.push(xt),F.add(xt),F.add(_)}const X=[];let C;for(;F.size>0;){const $=F.values().next().value;let[st,xt,_,mt,wt]=$;F.delete($);let Ut=st,Bt=xt;for(C=[st,_],X.push(C);;){let _t;if(F.has(mt))_t=mt;else if(F.has(wt))_t=wt;else break;F.delete(_t),[st,xt,_,mt,wt]=_t,Ut!==st&&(C.push(Ut,Bt,st,Bt===xt?xt:_),Ut=st),Bt=Bt===xt?_:xt}C.push(Ut,Bt)}return{outlines:X,box:t(this,it)}},H=new WeakSet,ks=function(G){const V=t(this,q);let F=0,X=V.length-1;for(;F<=X;){const C=F+X>>1,$=V[C][0];if($===G)return C;$<G?F=C+1:X=C-1}return X+1},z=new WeakSet,Cr=function([,G,V]){const F=E(this,H,ks).call(this,G);t(this,q).splice(F,0,[G,V])},T=new WeakSet,Er=function([,G,V]){const F=E(this,H,ks).call(this,G);for(let X=F;X<t(this,q).length;X++){const[C,$]=t(this,q)[X];if(C!==G)break;if(C===G&&$===V){t(this,q).splice(X,1);return}}for(let X=F-1;X>=0;X--){const[C,$]=t(this,q)[X];if(C!==G)break;if(C===G&&$===V){t(this,q).splice(X,1);return}}},x=new WeakSet,Cn=function(G){const[V,F,X]=G,C=[[V,F,X]],$=E(this,H,ks).call(this,X);for(let st=0;st<$;st++){const[xt,_]=t(this,q)[st];for(let mt=0,wt=C.length;mt<wt;mt++){const[,Ut,Bt]=C[mt];if(!(_<=Ut||Bt<=xt)){if(Ut>=xt){if(Bt>_)C[mt][1]=_;else{if(wt===1)return[];C.splice(mt,1),mt--,wt--}continue}C[mt][2]=xt,Bt>_&&C.push([V,_,Bt])}}}return C}},812:(ie,Nt,rt)=>{var T,W,x,O,I,En,F,X,C,$,st,Tr,mt,wt,Ut,Bt,_t,Kt,Fe,Yt,Jt,fe,ne,Xt,te,Gt,se,le,ee,qt,he,ge,Wt,ae,we,xe,Ce,ke,M,n,i,d,p,o,h,g,w,D,L,J,Fr,ht,Tn,yt,Fn,dt,Ps,S,Rn,a,kn,U,Ue,ft,is,Ft,Rr,Vt,kr,Ht,Pn,Y,ss,ut,Ln;rt.d(Nt,{AnnotationEditorUIManager:()=>N,ColorManager:()=>z,KeyboardManager:()=>A,bindEvents:()=>k,opacityToHex:()=>q});var u=rt(266),it=rt(473);function k(c,e,l){for(const v of l)e.addEventListener(v,c[v].bind(c))}function q(c){return Math.round(Math.min(255,Math.max(1,255*c))).toString(16).padStart(2,"0")}class lt{constructor(){f(this,T,0)}getId(){return`${u.AnnotationEditorPrefix}${ii(this,T)._++}`}}T=new WeakMap;const V=class{constructor(){f(this,I);f(this,W,(0,u.getUuid)());f(this,x,0);f(this,O,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',v=new OffscreenCanvas(1,3).getContext("2d"),R=new Image;R.src=e;const B=R.decode().then(()=>(v.drawImage(R,0,0,1,1,0,0,1,3),new Uint32Array(v.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,u.shadow)(this,"_isSVGFittingCanvas",B)}getFromFile(e){return be(this,null,function*(){const{lastModified:l,name:v,size:R,type:B}=e;return E(this,I,En).call(this,`${l}_${v}_${R}_${B}`,e)})}getFromUrl(e){return be(this,null,function*(){return E(this,I,En).call(this,e,e)})}getFromId(e){return be(this,null,function*(){t(this,O)||P(this,O,new Map);const l=t(this,O).get(e);return l?l.bitmap?(l.refCounter+=1,l):l.file?this.getFromFile(l.file):this.getFromUrl(l.url):null})}getSvgUrl(e){const l=t(this,O).get(e);return l!=null&&l.isSvg?l.svgUrl:null}deleteId(e){t(this,O)||P(this,O,new Map);const l=t(this,O).get(e);l&&(l.refCounter-=1,l.refCounter===0&&(l.bitmap=null))}isValidId(e){return e.startsWith(`image_${t(this,W)}_`)}};let Q=V;W=new WeakMap,x=new WeakMap,O=new WeakMap,I=new WeakSet,En=function(e,l){return be(this,null,function*(){t(this,O)||P(this,O,new Map);let v=t(this,O).get(e);if(v===null)return null;if(v!=null&&v.bitmap)return v.refCounter+=1,v;try{v||(v={bitmap:null,id:`image_${t(this,W)}_${ii(this,x)._++}`,refCounter:0,isSvg:!1});let R;if(typeof l=="string"?(v.url=l,R=yield(0,it.fetchData)(l,"blob")):R=v.file=l,R.type==="image/svg+xml"){const B=V._isSVGFittingCanvas,K=new FileReader,pt=new Image,bt=new Promise((vt,Ot)=>{pt.onload=()=>{v.bitmap=pt,v.isSvg=!0,vt()},K.onload=()=>be(this,null,function*(){const Rt=v.svgUrl=K.result;pt.src=(yield B)?`${Rt}#svgView(preserveAspectRatio(none))`:Rt}),pt.onerror=K.onerror=Ot});K.readAsDataURL(R),yield bt}else v.bitmap=yield createImageBitmap(R);v.refCounter=1}catch(R){console.error(R),v=null}return t(this,O).set(e,v),v&&t(this,O).set(v.id,v),v})};class H{constructor(e=128){f(this,F,[]);f(this,X,!1);f(this,C,void 0);f(this,$,-1);P(this,C,e)}add({cmd:e,undo:l,mustExec:v,type:R=NaN,overwriteIfSameType:B=!1,keepUndo:K=!1}){if(v&&e(),t(this,X))return;const pt={cmd:e,undo:l,type:R};if(t(this,$)===-1){t(this,F).length>0&&(t(this,F).length=0),P(this,$,0),t(this,F).push(pt);return}if(B&&t(this,F)[t(this,$)].type===R){K&&(pt.undo=t(this,F)[t(this,$)].undo),t(this,F)[t(this,$)]=pt;return}const bt=t(this,$)+1;bt===t(this,C)?t(this,F).splice(0,1):(P(this,$,bt),bt<t(this,F).length&&t(this,F).splice(bt)),t(this,F).push(pt)}undo(){t(this,$)!==-1&&(P(this,X,!0),t(this,F)[t(this,$)].undo(),P(this,X,!1),P(this,$,t(this,$)-1))}redo(){t(this,$)<t(this,F).length-1&&(P(this,$,t(this,$)+1),P(this,X,!0),t(this,F)[t(this,$)].cmd(),P(this,X,!1))}hasSomethingToUndo(){return t(this,$)!==-1}hasSomethingToRedo(){return t(this,$)<t(this,F).length-1}destroy(){P(this,F,null)}}F=new WeakMap,X=new WeakMap,C=new WeakMap,$=new WeakMap;class A{constructor(e){f(this,st);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:l}=u.FeatureTest.platform;for(const[v,R,B={}]of e)for(const K of v){const pt=K.startsWith("mac+");l&&pt?(this.callbacks.set(K.slice(4),{callback:R,options:B}),this.allKeys.add(K.split("+").at(-1))):!l&&!pt&&(this.callbacks.set(K,{callback:R,options:B}),this.allKeys.add(K.split("+").at(-1)))}}exec(e,l){if(!this.allKeys.has(l.key))return;const v=this.callbacks.get(E(this,st,Tr).call(this,l));if(!v)return;const{callback:R,options:{bubbles:B=!1,args:K=[],checker:pt=null}}=v;pt&&!pt(e,l)||(R.bind(e,...K,l)(),B||(l.stopPropagation(),l.preventDefault()))}}st=new WeakSet,Tr=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const l=this.buffer.join("+");return this.buffer.length=0,l};const _=class{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,it.getColorValues)(e),(0,u.shadow)(this,"_colors",e)}convert(e){const l=(0,it.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return l;for(const[v,R]of this._colors)if(R.every((B,K)=>B===l[K]))return _._colorsMapping.get(v);return l}getHexCode(e){const l=this._colors.get(e);return l?u.Util.makeHexColor(...l):e}};let z=_;Ae(z,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));const At=class{constructor(e,l,v,R,B,K,pt){f(this,J);f(this,ht);f(this,yt);f(this,dt);f(this,S);f(this,a);f(this,U);f(this,ft);f(this,Ft);f(this,Vt);f(this,Ht);f(this,Y);f(this,ut);f(this,mt,null);f(this,wt,new Map);f(this,Ut,new Map);f(this,Bt,null);f(this,_t,null);f(this,Kt,new H);f(this,Fe,0);f(this,Yt,new Set);f(this,Jt,null);f(this,fe,null);f(this,ne,new Set);f(this,Xt,null);f(this,te,null);f(this,Gt,null);f(this,se,new lt);f(this,le,!1);f(this,ee,!1);f(this,qt,null);f(this,he,null);f(this,ge,u.AnnotationEditorType.NONE);f(this,Wt,new Set);f(this,ae,null);f(this,we,this.blur.bind(this));f(this,xe,this.focus.bind(this));f(this,Ce,this.copy.bind(this));f(this,ke,this.cut.bind(this));f(this,M,this.paste.bind(this));f(this,n,this.keydown.bind(this));f(this,i,this.onEditingAction.bind(this));f(this,d,this.onPageChanging.bind(this));f(this,p,this.onScaleChanging.bind(this));f(this,o,this.onRotationChanging.bind(this));f(this,h,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});f(this,g,[0,0]);f(this,w,null);f(this,D,null);f(this,L,null);P(this,D,e),P(this,L,l),P(this,Bt,v),this._eventBus=R,this._eventBus._on("editingaction",t(this,i)),this._eventBus._on("pagechanging",t(this,d)),this._eventBus._on("scalechanging",t(this,p)),this._eventBus._on("rotationchanging",t(this,o)),P(this,_t,B.annotationStorage),P(this,Xt,B.filterFactory),P(this,ae,K),P(this,Gt,pt||null),this.viewParameters={realScale:it.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const e=At.prototype,l=K=>t(K,D).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&K.hasSomethingToControl(),v=(K,{target:pt})=>{if(pt instanceof HTMLInputElement){const{type:bt}=pt;return bt!=="text"&&bt!=="number"}return!0},R=this.TRANSLATE_SMALL,B=this.TRANSLATE_BIG;return(0,u.shadow)(this,"_keyboardManager",new A([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:v}],[["ctrl+z","mac+meta+z"],e.undo,{checker:v}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:v}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:v}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(K,{target:pt})=>!(pt instanceof HTMLButtonElement)&&t(K,D).contains(pt)&&!K.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:K=>t(K,D).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-R,0],checker:l}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-B,0],checker:l}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[R,0],checker:l}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[B,0],checker:l}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-R],checker:l}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-B],checker:l}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,R],checker:l}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,B],checker:l}]]))}destroy(){var e;E(this,dt,Ps).call(this),E(this,ht,Tn).call(this),this._eventBus._off("editingaction",t(this,i)),this._eventBus._off("pagechanging",t(this,d)),this._eventBus._off("scalechanging",t(this,p)),this._eventBus._off("rotationchanging",t(this,o));for(const l of t(this,Ut).values())l.destroy();t(this,Ut).clear(),t(this,wt).clear(),t(this,ne).clear(),P(this,mt,null),t(this,Wt).clear(),t(this,Kt).destroy(),(e=t(this,Bt))==null||e.destroy(),t(this,te)&&(clearTimeout(t(this,te)),P(this,te,null)),t(this,w)&&(clearTimeout(t(this,w)),P(this,w,null))}get hcmFilter(){return(0,u.shadow)(this,"hcmFilter",t(this,ae)?t(this,Xt).addHCMFilter(t(this,ae).foreground,t(this,ae).background):"none")}get direction(){return(0,u.shadow)(this,"direction",getComputedStyle(t(this,D)).direction)}get highlightColors(){return(0,u.shadow)(this,"highlightColors",t(this,Gt)?new Map(t(this,Gt).split(",").map(e=>e.split("=").map(l=>l.trim()))):null)}setMainHighlightColorPicker(e){P(this,he,e)}editAltText(e){var l;(l=t(this,Bt))==null||l.editAltText(this,e)}onPageChanging({pageNumber:e}){P(this,Fe,e-1)}focusMainContainer(){t(this,D).focus()}findParent(e,l){for(const v of t(this,Ut).values()){const{x:R,y:B,width:K,height:pt}=v.div.getBoundingClientRect();if(e>=R&&e<=R+K&&l>=B&&l<=B+pt)return v}return null}disableUserSelect(e=!1){t(this,L).classList.toggle("noUserSelect",e)}addShouldRescale(e){t(this,ne).add(e)}removeShouldRescale(e){t(this,ne).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*it.PixelsPerInch.PDF_TO_CSS_UNITS;for(const l of t(this,ne))l.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&t(this,_t)&&!t(this,_t).has(e.id)&&t(this,_t).setValue(e.id,e)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const l of t(this,Wt))if(l.div.contains(e)){P(this,qt,[l,e]),l._focusEventsAllowed=!1;break}}focus(){if(!t(this,qt))return;const[e,l]=t(this,qt);P(this,qt,null),l.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),l.focus()}addEditListeners(){E(this,yt,Fn).call(this),E(this,S,Rn).call(this)}removeEditListeners(){E(this,dt,Ps).call(this),E(this,a,kn).call(this)}copy(e){var v;if(e.preventDefault(),(v=t(this,mt))==null||v.commitOrRemove(),!this.hasSelection)return;const l=[];for(const R of t(this,Wt)){const B=R.serialize(!0);B&&l.push(B)}l.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(l))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:l}=e;for(const B of l.items)for(const K of t(this,fe))if(K.isHandlingMimeForPasting(B.type)){K.paste(B,this.currentLayer);return}let v=l.getData("application/pdfjs");if(!v)return;try{v=JSON.parse(v)}catch(B){(0,u.warn)(`paste: "${B.message}".`);return}if(!Array.isArray(v))return;this.unselectAll();const R=this.currentLayer;try{const B=[];for(const bt of v){const vt=R.deserialize(bt);if(!vt)return;B.push(vt)}const K=()=>{for(const bt of B)E(this,Ht,Pn).call(this,bt);E(this,ut,Ln).call(this,B)},pt=()=>{for(const bt of B)bt.remove()};this.addCommands({cmd:K,undo:pt,mustExec:!0})}catch(B){(0,u.warn)(`paste: "${B.message}".`)}}keydown(e){this.isEditorHandlingKeyboard||At._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}setEditingState(e){e?(E(this,J,Fr).call(this),E(this,yt,Fn).call(this),E(this,S,Rn).call(this),E(this,U,Ue).call(this,{isEditing:t(this,ge)!==u.AnnotationEditorType.NONE,isEmpty:E(this,Y,ss).call(this),hasSomethingToUndo:t(this,Kt).hasSomethingToUndo(),hasSomethingToRedo:t(this,Kt).hasSomethingToRedo(),hasSelectedEditor:!1})):(E(this,ht,Tn).call(this),E(this,dt,Ps).call(this),E(this,a,kn).call(this),E(this,U,Ue).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!t(this,fe)){P(this,fe,e);for(const l of t(this,fe))E(this,ft,is).call(this,l.defaultPropertiesToUpdate)}}getId(){return t(this,se).getId()}get currentLayer(){return t(this,Ut).get(t(this,Fe))}getLayer(e){return t(this,Ut).get(e)}get currentPageIndex(){return t(this,Fe)}addLayer(e){t(this,Ut).set(e.pageIndex,e),t(this,le)?e.enable():e.disable()}removeLayer(e){t(this,Ut).delete(e.pageIndex)}updateMode(e,l=null,v=!1){if(t(this,ge)!==e){if(P(this,ge,e),e===u.AnnotationEditorType.NONE){this.setEditingState(!1),E(this,Vt,kr).call(this);return}this.setEditingState(!0),E(this,Ft,Rr).call(this),this.unselectAll();for(const R of t(this,Ut).values())R.updateMode(e);if(!l&&v){this.addNewEditorFromKeyboard();return}if(l){for(const R of t(this,wt).values())if(R.annotationElementId===l){this.setSelected(R),R.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==t(this,ge)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,l){var v;if(t(this,fe)){switch(e){case u.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case u.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(v=t(this,he))==null||v.updateColor(l);break}for(const R of t(this,Wt))R.updateParams(e,l);for(const R of t(this,fe))R.updateDefaultParams(e,l)}}enableWaiting(e=!1){if(t(this,ee)!==e){P(this,ee,e);for(const l of t(this,Ut).values())e?l.disableClick():l.enableClick(),l.div.classList.toggle("waiting",e)}}getEditors(e){const l=[];for(const v of t(this,wt).values())v.pageIndex===e&&l.push(v);return l}getEditor(e){return t(this,wt).get(e)}addEditor(e){t(this,wt).set(e.id,e)}removeEditor(e){var l;e.div.contains(document.activeElement)&&(t(this,te)&&clearTimeout(t(this,te)),P(this,te,setTimeout(()=>{this.focusMainContainer(),P(this,te,null)},0))),t(this,wt).delete(e.id),this.unselect(e),(!e.annotationElementId||!t(this,Yt).has(e.annotationElementId))&&((l=t(this,_t))==null||l.remove(e.id))}addDeletedAnnotationElement(e){t(this,Yt).add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return t(this,Yt).has(e)}removeDeletedAnnotationElement(e){t(this,Yt).delete(e.annotationElementId),e.deleted=!1}setActiveEditor(e){t(this,mt)!==e&&(P(this,mt,e),e&&E(this,ft,is).call(this,e.propertiesToUpdate))}toggleSelected(e){if(t(this,Wt).has(e)){t(this,Wt).delete(e),e.unselect(),E(this,U,Ue).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,Wt).add(e),e.select(),E(this,ft,is).call(this,e.propertiesToUpdate),E(this,U,Ue).call(this,{hasSelectedEditor:!0})}setSelected(e){for(const l of t(this,Wt))l!==e&&l.unselect();t(this,Wt).clear(),t(this,Wt).add(e),e.select(),E(this,ft,is).call(this,e.propertiesToUpdate),E(this,U,Ue).call(this,{hasSelectedEditor:!0})}isSelected(e){return t(this,Wt).has(e)}get firstSelectedEditor(){return t(this,Wt).values().next().value}unselect(e){e.unselect(),t(this,Wt).delete(e),E(this,U,Ue).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,Wt).size!==0}get isEnterHandled(){return t(this,Wt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,Kt).undo(),E(this,U,Ue).call(this,{hasSomethingToUndo:t(this,Kt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:E(this,Y,ss).call(this)})}redo(){t(this,Kt).redo(),E(this,U,Ue).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,Kt).hasSomethingToRedo(),isEmpty:E(this,Y,ss).call(this)})}addCommands(e){t(this,Kt).add(e),E(this,U,Ue).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:E(this,Y,ss).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...t(this,Wt)],l=()=>{for(const R of e)R.remove()},v=()=>{for(const R of e)E(this,Ht,Pn).call(this,R)};this.addCommands({cmd:l,undo:v,mustExec:!0})}commitOrRemove(){var e;(e=t(this,mt))==null||e.commitOrRemove()}hasSomethingToControl(){return t(this,mt)||this.hasSelection}selectAll(){for(const e of t(this,Wt))e.commit();E(this,ut,Ln).call(this,t(this,wt).values())}unselectAll(){if(!(t(this,mt)&&(t(this,mt).commitOrRemove(),t(this,ge)!==u.AnnotationEditorType.NONE))&&this.hasSelection){for(const e of t(this,Wt))e.unselect();t(this,Wt).clear(),E(this,U,Ue).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,l,v=!1){if(v||this.commitOrRemove(),!this.hasSelection)return;t(this,g)[0]+=e,t(this,g)[1]+=l;const[R,B]=t(this,g),K=[...t(this,Wt)],pt=1e3;t(this,w)&&clearTimeout(t(this,w)),P(this,w,setTimeout(()=>{P(this,w,null),t(this,g)[0]=t(this,g)[1]=0,this.addCommands({cmd:()=>{for(const bt of K)t(this,wt).has(bt.id)&&bt.translateInPage(R,B)},undo:()=>{for(const bt of K)t(this,wt).has(bt.id)&&bt.translateInPage(-R,-B)},mustExec:!1})},pt));for(const bt of K)bt.translateInPage(e,l)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),P(this,Jt,new Map);for(const e of t(this,Wt))t(this,Jt).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,Jt))return!1;this.disableUserSelect(!1);const e=t(this,Jt);P(this,Jt,null);let l=!1;for(const[{x:R,y:B,pageIndex:K},pt]of e)pt.newX=R,pt.newY=B,pt.newPageIndex=K,l||(l=R!==pt.savedX||B!==pt.savedY||K!==pt.savedPageIndex);if(!l)return!1;const v=(R,B,K,pt)=>{if(t(this,wt).has(R.id)){const bt=t(this,Ut).get(pt);bt?R._setParentAndPosition(bt,B,K):(R.pageIndex=pt,R.x=B,R.y=K)}};return this.addCommands({cmd:()=>{for(const[R,{newX:B,newY:K,newPageIndex:pt}]of e)v(R,B,K,pt)},undo:()=>{for(const[R,{savedX:B,savedY:K,savedPageIndex:pt}]of e)v(R,B,K,pt)},mustExec:!0}),!0}dragSelectedEditors(e,l){if(t(this,Jt))for(const v of t(this,Jt).keys())v.drag(e,l)}rebuild(e){if(e.parent===null){const l=this.getLayer(e.pageIndex);l?(l.changeParent(e),l.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||t(this,Wt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return t(this,mt)===e}getActive(){return t(this,mt)}getMode(){return t(this,ge)}get imageManager(){return(0,u.shadow)(this,"imageManager",new Q)}};let N=At;mt=new WeakMap,wt=new WeakMap,Ut=new WeakMap,Bt=new WeakMap,_t=new WeakMap,Kt=new WeakMap,Fe=new WeakMap,Yt=new WeakMap,Jt=new WeakMap,fe=new WeakMap,ne=new WeakMap,Xt=new WeakMap,te=new WeakMap,Gt=new WeakMap,se=new WeakMap,le=new WeakMap,ee=new WeakMap,qt=new WeakMap,he=new WeakMap,ge=new WeakMap,Wt=new WeakMap,ae=new WeakMap,we=new WeakMap,xe=new WeakMap,Ce=new WeakMap,ke=new WeakMap,M=new WeakMap,n=new WeakMap,i=new WeakMap,d=new WeakMap,p=new WeakMap,o=new WeakMap,h=new WeakMap,g=new WeakMap,w=new WeakMap,D=new WeakMap,L=new WeakMap,J=new WeakSet,Fr=function(){window.addEventListener("focus",t(this,xe)),window.addEventListener("blur",t(this,we))},ht=new WeakSet,Tn=function(){window.removeEventListener("focus",t(this,xe)),window.removeEventListener("blur",t(this,we))},yt=new WeakSet,Fn=function(){window.addEventListener("keydown",t(this,n))},dt=new WeakSet,Ps=function(){window.removeEventListener("keydown",t(this,n))},S=new WeakSet,Rn=function(){document.addEventListener("copy",t(this,Ce)),document.addEventListener("cut",t(this,ke)),document.addEventListener("paste",t(this,M))},a=new WeakSet,kn=function(){document.removeEventListener("copy",t(this,Ce)),document.removeEventListener("cut",t(this,ke)),document.removeEventListener("paste",t(this,M))},U=new WeakSet,Ue=function(e){Object.entries(e).some(([v,R])=>t(this,h)[v]!==R)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,h),e)})},ft=new WeakSet,is=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Ft=new WeakSet,Rr=function(){if(!t(this,le)){P(this,le,!0);for(const e of t(this,Ut).values())e.enable()}},Vt=new WeakSet,kr=function(){if(this.unselectAll(),t(this,le)){P(this,le,!1);for(const e of t(this,Ut).values())e.disable()}},Ht=new WeakSet,Pn=function(e){const l=t(this,Ut).get(e.pageIndex);l?l.addOrRebuild(e):this.addEditor(e)},Y=new WeakSet,ss=function(){if(t(this,wt).size===0)return!0;if(t(this,wt).size===1)for(const e of t(this,wt).values())return e.isEmpty();return!1},ut=new WeakSet,Ln=function(e){t(this,Wt).clear();for(const l of e)l.isEmpty()||(t(this,Wt).add(l),l.select());E(this,U,Ue).call(this,{hasSelectedEditor:!0})},Ae(N,"TRANSLATE_SMALL",1),Ae(N,"TRANSLATE_BIG",10)},171:(ie,Nt,rt)=>{rt.d(Nt,{PDFFetchStream:()=>Q});var u=rt(266),it=rt(253);function k(z,N,T){return{method:"GET",headers:z,signal:T.signal,mode:"cors",credentials:N?"include":"same-origin",redirect:"follow"}}function q(z){const N=new Headers;for(const T in z){const W=z[T];W!==void 0&&N.append(T,W)}return N}function lt(z){return z instanceof Uint8Array?z.buffer:z instanceof ArrayBuffer?z:((0,u.warn)(`getArrayBuffer - unexpected data format: ${z}`),new Uint8Array(z).buffer)}class Q{constructor(N){this.source=N,this.isHttp=/^https?:/i.test(N.url),this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N,T;return(T=(N=this._fullRequestReader)==null?void 0:N._loaded)!=null?T:0}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new H(this),this._fullRequestReader}getRangeReader(N,T){if(T<=this._progressiveDataLength)return null;const W=new A(this,N,T);return this._rangeRequestReaders.push(W),W}cancelAllRequests(N){var T;(T=this._fullRequestReader)==null||T.cancel(N);for(const W of this._rangeRequestReaders.slice(0))W.cancel(N)}}class H{constructor(N){this._stream=N,this._reader=null,this._loaded=0,this._filename=null;const T=N.source;this._withCredentials=T.withCredentials||!1,this._contentLength=T.length,this._headersCapability=new u.PromiseCapability,this._disableRange=T.disableRange||!1,this._rangeChunkSize=T.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!T.disableStream,this._isRangeSupported=!T.disableRange,this._headers=q(this._stream.httpHeaders);const W=T.url;fetch(W,k(this._headers,this._withCredentials,this._abortController)).then(x=>{if(!(0,it.validateResponseStatus)(x.status))throw(0,it.createResponseStatusError)(x.status,W);this._reader=x.body.getReader(),this._headersCapability.resolve();const O=V=>x.headers.get(V),{allowRangeRequests:I,suggestedLength:G}=(0,it.validateRangeRequestCapabilities)({getResponseHeader:O,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=I,this._contentLength=G||this._contentLength,this._filename=(0,it.extractFilenameFromHeader)(O),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new u.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return be(this,null,function*(){var W;yield this._headersCapability.promise;const{value:N,done:T}=yield this._reader.read();return T?{value:N,done:T}:(this._loaded+=N.byteLength,(W=this.onProgress)==null||W.call(this,{loaded:this._loaded,total:this._contentLength}),{value:lt(N),done:!1})})}cancel(N){var T;(T=this._reader)==null||T.cancel(N),this._abortController.abort()}}class A{constructor(N,T,W){this._stream=N,this._reader=null,this._loaded=0;const x=N.source;this._withCredentials=x.withCredentials||!1,this._readCapability=new u.PromiseCapability,this._isStreamingSupported=!x.disableStream,this._abortController=new AbortController,this._headers=q(this._stream.httpHeaders),this._headers.append("Range",`bytes=${T}-${W-1}`);const O=x.url;fetch(O,k(this._headers,this._withCredentials,this._abortController)).then(I=>{if(!(0,it.validateResponseStatus)(I.status))throw(0,it.createResponseStatusError)(I.status,O);this._readCapability.resolve(),this._reader=I.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return be(this,null,function*(){var W;yield this._readCapability.promise;const{value:N,done:T}=yield this._reader.read();return T?{value:N,done:T}:(this._loaded+=N.byteLength,(W=this.onProgress)==null||W.call(this,{loaded:this._loaded}),{value:lt(N),done:!1})})}cancel(N){var T;(T=this._reader)==null||T.cancel(N),this._abortController.abort()}}},742:(ie,Nt,rt)=>{var q;rt.d(Nt,{FontFaceObject:()=>k,FontLoader:()=>it});var u=rt(266);class it{constructor({ownerDocument:Q=globalThis.document,styleElement:H=null}){f(this,q,new Set);this._document=Q,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(Q){this.nativeFontFaces.add(Q),this._document.fonts.add(Q)}removeNativeFontFace(Q){this.nativeFontFaces.delete(Q),this._document.fonts.delete(Q)}insertRule(Q){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const H=this.styleElement.sheet;H.insertRule(Q,H.cssRules.length)}clear(){for(const Q of this.nativeFontFaces)this._document.fonts.delete(Q);this.nativeFontFaces.clear(),t(this,q).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(A){return be(this,arguments,function*({systemFontInfo:Q,_inspectFont:H}){if(!(!Q||t(this,q).has(Q.loadedName))){if((0,u.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:z,src:N,style:T}=Q,W=new FontFace(z,N,T);this.addNativeFontFace(W);try{yield W.load(),t(this,q).add(z),H==null||H(Q)}catch(x){(0,u.warn)(`Cannot load system font: ${Q.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(W)}return}(0,u.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(Q){return be(this,null,function*(){if(Q.attached||Q.missingFile&&!Q.systemFontInfo)return;if(Q.attached=!0,Q.systemFontInfo){yield this.loadSystemFont(Q);return}if(this.isFontLoadingAPISupported){const A=Q.createNativeFontFace();if(A){this.addNativeFontFace(A);try{yield A.loaded}catch(z){throw(0,u.warn)(`Failed to load font '${A.family}': '${z}'.`),Q.disableFontFace=!0,z}}return}const H=Q.createFontFaceRule();if(H){if(this.insertRule(H),this.isSyncFontLoadingSupported)return;yield new Promise(A=>{const z=this._queueLoadingCallback(A);this._prepareFontLoadEvent(Q,z)})}})}get isFontLoadingAPISupported(){var H;const Q=!!((H=this._document)!=null&&H.fonts);return(0,u.shadow)(this,"isFontLoadingAPISupported",Q)}get isSyncFontLoadingSupported(){let Q=!1;return(u.isNodeJS||typeof navigator!="undefined"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(Q=!0),(0,u.shadow)(this,"isSyncFontLoadingSupported",Q)}_queueLoadingCallback(Q){function H(){for((0,u.assert)(!z.done,"completeRequest() cannot be called twice."),z.done=!0;A.length>0&&A[0].done;){const N=A.shift();setTimeout(N.callback,0)}}const{loadingRequests:A}=this,z={done:!1,complete:H,callback:Q};return A.push(z),z}get _loadTestFont(){const Q=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,u.shadow)(this,"_loadTestFont",Q)}_prepareFontLoadEvent(Q,H){function A(mt,wt){return mt.charCodeAt(wt)<<24|mt.charCodeAt(wt+1)<<16|mt.charCodeAt(wt+2)<<8|mt.charCodeAt(wt+3)&255}function z(mt,wt,Ut,Bt){const _t=mt.substring(0,wt),Kt=mt.substring(wt+Ut);return _t+Bt+Kt}let N,T;const W=this._document.createElement("canvas");W.width=1,W.height=1;const x=W.getContext("2d");let O=0;function I(mt,wt){if(++O>30){(0,u.warn)("Load test font never loaded."),wt();return}if(x.font="30px "+mt,x.fillText(".",0,20),x.getImageData(0,0,1,1).data[3]>0){wt();return}setTimeout(I.bind(null,mt,wt))}const G=`lt${Date.now()}${this.loadTestFontId++}`;let V=this._loadTestFont;V=z(V,976,G.length,G);const X=16,C=1482184792;let $=A(V,X);for(N=0,T=G.length-3;N<T;N+=4)$=$-C+A(G,N)|0;N<G.length&&($=$-C+A(G+"XXX",N)|0),V=z(V,X,4,(0,u.string32)($));const st=`url(data:font/opentype;base64,${btoa(V)});`,xt=`@font-face {font-family:"${G}";src:${st}}`;this.insertRule(xt);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const mt of[Q.loadedName,G]){const wt=this._document.createElement("span");wt.textContent="Hi",wt.style.fontFamily=mt,_.append(wt)}this._document.body.append(_),I(G,()=>{_.remove(),H.complete()})}}q=new WeakMap;class k{constructor(Q,{isEvalSupported:H=!0,disableFontFace:A=!1,ignoreErrors:z=!1,inspectFont:N=null}){this.compiledGlyphs=Object.create(null);for(const T in Q)this[T]=Q[T];this.isEvalSupported=H!==!1,this.disableFontFace=A===!0,this.ignoreErrors=z===!0,this._inspectFont=N}createNativeFontFace(){var H;if(!this.data||this.disableFontFace)return null;let Q;if(!this.cssFontInfo)Q=new FontFace(this.loadedName,this.data,{});else{const A={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(A.style=`oblique ${this.cssFontInfo.italicAngle}deg`),Q=new FontFace(this.cssFontInfo.fontFamily,this.data,A)}return(H=this._inspectFont)==null||H.call(this,this),Q}createFontFaceRule(){var z;if(!this.data||this.disableFontFace)return null;const Q=(0,u.bytesToString)(this.data),H=`url(data:${this.mimetype};base64,${btoa(Q)});`;let A;if(!this.cssFontInfo)A=`@font-face {font-family:"${this.loadedName}";src:${H}}`;else{let N=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(N+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),A=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${N}src:${H}}`}return(z=this._inspectFont)==null||z.call(this,this,H),A}getPathGenerator(Q,H){if(this.compiledGlyphs[H]!==void 0)return this.compiledGlyphs[H];let A;try{A=Q.get(this.loadedName+"_path_"+H)}catch(z){if(!this.ignoreErrors)throw z;return(0,u.warn)(`getPathGenerator - ignoring character: "${z}".`),this.compiledGlyphs[H]=function(N,T){}}if(this.isEvalSupported&&u.FeatureTest.isEvalSupported){const z=[];for(const N of A){const T=N.args!==void 0?N.args.join(","):"";z.push("c.",N.cmd,"(",T,`);
`)}return this.compiledGlyphs[H]=new Function("c","size",z.join(""))}return this.compiledGlyphs[H]=function(z,N){for(const T of A)T.cmd==="scale"&&(T.args=[N,-N]),z[T.cmd].apply(z,T.args)}}}},472:(ie,Nt,rt)=>{var k,q;rt.d(Nt,{Metadata:()=>it});var u=rt(266);class it{constructor({parsedData:Q,rawData:H}){f(this,k,void 0);f(this,q,void 0);P(this,k,Q),P(this,q,H)}getRaw(){return t(this,q)}get(Q){var H;return(H=t(this,k).get(Q))!=null?H:null}getAll(){return(0,u.objectFromMap)(t(this,k))}has(Q){return t(this,k).has(Q)}}k=new WeakMap,q=new WeakMap},474:(ie,Nt,rt)=>{rt.d(Nt,{PDFNetworkStream:()=>H});var u=rt(266),it=rt(253);const k=200,q=206;function lt(N){const T=N.response;return typeof T!="string"?T:(0,u.stringToBytes)(T).buffer}class Q{constructor(T,W={}){this.url=T,this.isHttp=/^https?:/i.test(T),this.httpHeaders=this.isHttp&&W.httpHeaders||Object.create(null),this.withCredentials=W.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(T,W,x){const O={begin:T,end:W};for(const I in x)O[I]=x[I];return this.request(O)}requestFull(T){return this.request(T)}request(T){const W=new XMLHttpRequest,x=this.currXhrId++,O=this.pendingRequests[x]={xhr:W};W.open("GET",this.url),W.withCredentials=this.withCredentials;for(const I in this.httpHeaders){const G=this.httpHeaders[I];G!==void 0&&W.setRequestHeader(I,G)}return this.isHttp&&"begin"in T&&"end"in T?(W.setRequestHeader("Range",`bytes=${T.begin}-${T.end-1}`),O.expectedStatus=q):O.expectedStatus=k,W.responseType="arraybuffer",T.onError&&(W.onerror=function(I){T.onError(W.status)}),W.onreadystatechange=this.onStateChange.bind(this,x),W.onprogress=this.onProgress.bind(this,x),O.onHeadersReceived=T.onHeadersReceived,O.onDone=T.onDone,O.onError=T.onError,O.onProgress=T.onProgress,W.send(null),x}onProgress(T,W){var O;const x=this.pendingRequests[T];x&&((O=x.onProgress)==null||O.call(x,W))}onStateChange(T,W){var F,X,C;const x=this.pendingRequests[T];if(!x)return;const O=x.xhr;if(O.readyState>=2&&x.onHeadersReceived&&(x.onHeadersReceived(),delete x.onHeadersReceived),O.readyState!==4||!(T in this.pendingRequests))return;if(delete this.pendingRequests[T],O.status===0&&this.isHttp){(F=x.onError)==null||F.call(x,O.status);return}const I=O.status||k;if(!(I===k&&x.expectedStatus===q)&&I!==x.expectedStatus){(X=x.onError)==null||X.call(x,O.status);return}const V=lt(O);if(I===q){const $=O.getResponseHeader("Content-Range"),st=/bytes (\d+)-(\d+)\/(\d+)/.exec($);x.onDone({begin:parseInt(st[1],10),chunk:V})}else V?x.onDone({begin:0,chunk:V}):(C=x.onError)==null||C.call(x,O.status)}getRequestXhr(T){return this.pendingRequests[T].xhr}isPendingRequest(T){return T in this.pendingRequests}abortRequest(T){const W=this.pendingRequests[T].xhr;delete this.pendingRequests[T],W.abort()}}class H{constructor(T){this._source=T,this._manager=new Q(T.url,{httpHeaders:T.httpHeaders,withCredentials:T.withCredentials}),this._rangeChunkSize=T.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(T){const W=this._rangeRequestReaders.indexOf(T);W>=0&&this._rangeRequestReaders.splice(W,1)}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new A(this._manager,this._source),this._fullRequestReader}getRangeReader(T,W){const x=new z(this._manager,T,W);return x.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(x),x}cancelAllRequests(T){var W;(W=this._fullRequestReader)==null||W.cancel(T);for(const x of this._rangeRequestReaders.slice(0))x.cancel(T)}}class A{constructor(T,W){this._manager=T;const x={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=W.url,this._fullRequestId=T.requestFull(x),this._headersReceivedCapability=new u.PromiseCapability,this._disableRange=W.disableRange||!1,this._contentLength=W.length,this._rangeChunkSize=W.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const T=this._fullRequestId,W=this._manager.getRequestXhr(T),x=G=>W.getResponseHeader(G),{allowRangeRequests:O,suggestedLength:I}=(0,it.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});O&&(this._isRangeSupported=!0),this._contentLength=I||this._contentLength,this._filename=(0,it.extractFilenameFromHeader)(x),this._isRangeSupported&&this._manager.abortRequest(T),this._headersReceivedCapability.resolve()}_onDone(T){if(T&&(this._requests.length>0?this._requests.shift().resolve({value:T.chunk,done:!1}):this._cachedChunks.push(T.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const W of this._requests)W.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(T){this._storedError=(0,it.createResponseStatusError)(T,this._url),this._headersReceivedCapability.reject(this._storedError);for(const W of this._requests)W.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(T){var W;(W=this.onProgress)==null||W.call(this,{loaded:T.loaded,total:T.lengthComputable?T.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){return be(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=new u.PromiseCapability;return this._requests.push(T),T.promise})}cancel(T){this._done=!0,this._headersReceivedCapability.reject(T);for(const W of this._requests)W.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class z{constructor(T,W,x){this._manager=T;const O={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=T.url,this._requestId=T.requestRange(W,x,O),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var T;(T=this.onClosed)==null||T.call(this,this)}_onDone(T){const W=T.chunk;this._requests.length>0?this._requests.shift().resolve({value:W,done:!1}):this._queuedChunk=W,this._done=!0;for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(T){this._storedError=(0,it.createResponseStatusError)(T,this._url);for(const W of this._requests)W.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(T){var W;this.isStreamingSupported||(W=this.onProgress)==null||W.call(this,{loaded:T.loaded})}get isStreamingSupported(){return!1}read(){return be(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const W=this._queuedChunk;return this._queuedChunk=null,{value:W,done:!1}}if(this._done)return{value:void 0,done:!0};const T=new u.PromiseCapability;return this._requests.push(T),T.promise})}cancel(T){this._done=!0;for(const W of this._requests)W.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},253:(ie,Nt,rt)=>{rt.d(Nt,{createResponseStatusError:()=>Q,extractFilenameFromHeader:()=>lt,validateRangeRequestCapabilities:()=>q,validateResponseStatus:()=>H});var u=rt(266);function it(A){let z=!0,N=T("filename\\*","i").exec(A);if(N){N=N[1];let F=I(N);return F=unescape(F),F=G(F),F=V(F),x(F)}if(N=O(A),N){const F=V(N);return x(F)}if(N=T("filename","i").exec(A),N){N=N[1];let F=I(N);return F=V(F),x(F)}function T(F,X){return new RegExp("(?:^|;)\\s*"+F+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',X)}function W(F,X){if(F){if(!/^[\x00-\xFF]+$/.test(X))return X;try{const C=new TextDecoder(F,{fatal:!0}),$=(0,u.stringToBytes)(X);X=C.decode($),z=!1}catch(C){}}return X}function x(F){return z&&/[\x80-\xff]/.test(F)&&(F=W("utf-8",F),z&&(F=W("iso-8859-1",F))),F}function O(F){const X=[];let C;const $=T("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(C=$.exec(F))!==null;){let[,xt,_,mt]=C;if(xt=parseInt(xt,10),xt in X){if(xt===0)break;continue}X[xt]=[_,mt]}const st=[];for(let xt=0;xt<X.length&&xt in X;++xt){let[_,mt]=X[xt];mt=I(mt),_&&(mt=unescape(mt),xt===0&&(mt=G(mt))),st.push(mt)}return st.join("")}function I(F){if(F.startsWith('"')){const X=F.slice(1).split('\\"');for(let C=0;C<X.length;++C){const $=X[C].indexOf('"');$!==-1&&(X[C]=X[C].slice(0,$),X.length=C+1),X[C]=X[C].replaceAll(/\\(.)/g,"$1")}F=X.join('"')}return F}function G(F){const X=F.indexOf("'");if(X===-1)return F;const C=F.slice(0,X),st=F.slice(X+1).replace(/^[^']*'/,"");return W(C,st)}function V(F){return!F.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(F)?F:F.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(X,C,$,st){if($==="q"||$==="Q")return st=st.replaceAll("_"," "),st=st.replaceAll(/=([0-9a-fA-F]{2})/g,function(xt,_){return String.fromCharCode(parseInt(_,16))}),W(C,st);try{st=atob(st)}catch(xt){}return W(C,st)})}return""}var k=rt(473);function q({getResponseHeader:A,isHttp:z,rangeChunkSize:N,disableRange:T}){const W={allowRangeRequests:!1,suggestedLength:void 0},x=parseInt(A("Content-Length"),10);return!Number.isInteger(x)||(W.suggestedLength=x,x<=2*N)||T||!z||A("Accept-Ranges")!=="bytes"||(A("Content-Encoding")||"identity")!=="identity"||(W.allowRangeRequests=!0),W}function lt(A){const z=A("Content-Disposition");if(z){let N=it(z);if(N.includes("%"))try{N=decodeURIComponent(N)}catch(T){}if((0,k.isPdfFile)(N))return N}return null}function Q(A,z){return A===404||A===0&&z.startsWith("file:")?new u.MissingPDFException('Missing PDF "'+z+'".'):new u.UnexpectedResponseException(`Unexpected server response (${A}) while retrieving PDF "${z}".`,A)}function H(A){return A===200||A===206}},498:(ie,Nt,rt)=>{rt.a(ie,(u,it)=>be(this,null,function*(){try{let N=function(X){const C=A.parse(X);return C.protocol==="file:"||C.host?C:/^[a-z]:[/\\]/i.test(X)?A.parse(`file:///${X}`):(C.host||(C.protocol="file:"),C)},O=function(X,C){return{protocol:X.protocol,auth:X.auth,host:X.hostname,port:X.port,path:X.path,method:"GET",headers:C}};rt.d(Nt,{PDFNodeStream:()=>T});var k=rt(266),q=rt(253);let lt,Q,H,A;k.isNodeJS&&(lt=yield import("fs"),Q=yield import("http"),H=yield import("https"),A=yield import("url"));const z=/^file:\/\/\/[a-zA-Z]:\//;class T{constructor(C){this.source=C,this.url=N(C.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&C.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var C,$;return($=(C=this._fullRequestReader)==null?void 0:C._loaded)!=null?$:0}getFullReader(){return(0,k.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new V(this):new I(this),this._fullRequestReader}getRangeReader(C,$){if($<=this._progressiveDataLength)return null;const st=this.isFsUrl?new F(this,C,$):new G(this,C,$);return this._rangeRequestReaders.push(st),st}cancelAllRequests(C){var $;($=this._fullRequestReader)==null||$.cancel(C);for(const st of this._rangeRequestReaders.slice(0))st.cancel(C)}}class W{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null;const $=C.source;this._contentLength=$.length,this._loaded=0,this._filename=null,this._disableRange=$.disableRange||!1,this._rangeChunkSize=$.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!$.disableStream,this._isRangeSupported=!$.disableRange,this._readableStream=null,this._readCapability=new k.PromiseCapability,this._headersCapability=new k.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return be(this,null,function*(){var st;if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=new k.PromiseCapability,this.read()):(this._loaded+=C.length,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(C).buffer,done:!1})})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",$=>{this._error($)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new k.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class x{constructor(C){this._url=C.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new k.PromiseCapability;const $=C.source;this._isStreamingSupported=!$.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return be(this,null,function*(){var st;if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const C=this._readableStream.read();return C===null?(this._readCapability=new k.PromiseCapability,this.read()):(this._loaded+=C.length,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded}),{value:new Uint8Array(C).buffer,done:!1})})}cancel(C){if(!this._readableStream){this._error(C);return}this._readableStream.destroy(C)}_error(C){this._storedError=C,this._readCapability.resolve()}_setReadableStream(C){this._readableStream=C,C.on("readable",()=>{this._readCapability.resolve()}),C.on("end",()=>{C.destroy(),this._done=!0,this._readCapability.resolve()}),C.on("error",$=>{this._error($)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class I extends W{constructor(C){super(C);const $=st=>{if(st.statusCode===404){const wt=new k.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=wt,this._headersCapability.reject(wt);return}this._headersCapability.resolve(),this._setReadableStream(st);const xt=wt=>this._readableStream.headers[wt.toLowerCase()],{allowRangeRequests:_,suggestedLength:mt}=(0,q.validateRangeRequestCapabilities)({getResponseHeader:xt,isHttp:C.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=mt||this._contentLength,this._filename=(0,q.extractFilenameFromHeader)(xt)};this._request=null,this._url.protocol==="http:"?this._request=Q.request(O(this._url,C.httpHeaders),$):this._request=H.request(O(this._url,C.httpHeaders),$),this._request.on("error",st=>{this._storedError=st,this._headersCapability.reject(st)}),this._request.end()}}class G extends x{constructor(C,$,st){super(C),this._httpHeaders={};for(const _ in C.httpHeaders){const mt=C.httpHeaders[_];mt!==void 0&&(this._httpHeaders[_]=mt)}this._httpHeaders.Range=`bytes=${$}-${st-1}`;const xt=_=>{if(_.statusCode===404){const mt=new k.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=mt;return}this._setReadableStream(_)};this._request=null,this._url.protocol==="http:"?this._request=Q.request(O(this._url,this._httpHeaders),xt):this._request=H.request(O(this._url,this._httpHeaders),xt),this._request.on("error",_=>{this._storedError=_}),this._request.end()}}class V extends W{constructor(C){super(C);let $=decodeURIComponent(this._url.path);z.test(this._url.href)&&($=$.replace(/^\//,"")),lt.lstat($,(st,xt)=>{if(st){st.code==="ENOENT"&&(st=new k.MissingPDFException(`Missing PDF "${$}".`)),this._storedError=st,this._headersCapability.reject(st);return}this._contentLength=xt.size,this._setReadableStream(lt.createReadStream($)),this._headersCapability.resolve()})}}class F extends x{constructor(C,$,st){super(C);let xt=decodeURIComponent(this._url.path);z.test(this._url.href)&&(xt=xt.replace(/^\//,"")),this._setReadableStream(lt.createReadStream(xt,{start:$,end:st-1}))}}it()}catch(lt){it(lt)}}),1)},738:(ie,Nt,rt)=>{rt.a(ie,(u,it)=>be(this,null,function*(){try{rt.d(Nt,{NodeCMapReaderFactory:()=>T,NodeCanvasFactory:()=>N,NodeFilterFactory:()=>z,NodeStandardFontDataFactory:()=>W});var k=rt(822),q=rt(266);let lt,Q,H;if(q.isNodeJS){lt=yield import("fs");try{Q=yield import("canvas")}catch(x){}try{H=yield import("path2d-polyfill")}catch(x){}}const A=function(x){return new Promise((O,I)=>{lt.readFile(x,(G,V)=>{if(G||!V){I(new Error(G));return}O(new Uint8Array(V))})})};class z extends k.BaseFilterFactory{}class N extends k.BaseCanvasFactory{_createCanvas(O,I){return Q.createCanvas(O,I)}}class T extends k.BaseCMapReaderFactory{_fetchData(O,I){return A(O).then(G=>({cMapData:G,compressionType:I}))}}class W extends k.BaseStandardFontDataFactory{_fetchData(O){return A(O)}}it()}catch(lt){it(lt)}}),1)},890:(ie,Nt,rt)=>{var Q,H,A,z,N,T,Mn;rt.d(Nt,{OptionalContentConfig:()=>lt});var u=rt(266),it=rt(825);const k=Symbol("INTERNAL");class q{constructor(O,I){f(this,Q,!0);this.name=O,this.intent=I}get visible(){return t(this,Q)}_setVisible(O,I){O!==k&&(0,u.unreachable)("Internal method `_setVisible` called."),P(this,Q,I)}}Q=new WeakMap;class lt{constructor(O){f(this,T);f(this,H,null);f(this,A,new Map);f(this,z,null);f(this,N,null);if(this.name=null,this.creator=null,O!==null){this.name=O.name,this.creator=O.creator,P(this,N,O.order);for(const I of O.groups)t(this,A).set(I.id,new q(I.name,I.intent));if(O.baseState==="OFF")for(const I of t(this,A).values())I._setVisible(k,!1);for(const I of O.on)t(this,A).get(I)._setVisible(k,!0);for(const I of O.off)t(this,A).get(I)._setVisible(k,!1);P(this,z,this.getHash())}}isVisible(O){if(t(this,A).size===0)return!0;if(!O)return(0,u.warn)("Optional content group not defined."),!0;if(O.type==="OCG")return t(this,A).has(O.id)?t(this,A).get(O.id).visible:((0,u.warn)(`Optional content group not found: ${O.id}`),!0);if(O.type==="OCMD"){if(O.expression)return E(this,T,Mn).call(this,O.expression);if(!O.policy||O.policy==="AnyOn"){for(const I of O.ids){if(!t(this,A).has(I))return(0,u.warn)(`Optional content group not found: ${I}`),!0;if(t(this,A).get(I).visible)return!0}return!1}else if(O.policy==="AllOn"){for(const I of O.ids){if(!t(this,A).has(I))return(0,u.warn)(`Optional content group not found: ${I}`),!0;if(!t(this,A).get(I).visible)return!1}return!0}else if(O.policy==="AnyOff"){for(const I of O.ids){if(!t(this,A).has(I))return(0,u.warn)(`Optional content group not found: ${I}`),!0;if(!t(this,A).get(I).visible)return!0}return!1}else if(O.policy==="AllOff"){for(const I of O.ids){if(!t(this,A).has(I))return(0,u.warn)(`Optional content group not found: ${I}`),!0;if(t(this,A).get(I).visible)return!1}return!0}return(0,u.warn)(`Unknown optional content policy ${O.policy}.`),!0}return(0,u.warn)(`Unknown group type ${O.type}.`),!0}setVisibility(O,I=!0){if(!t(this,A).has(O)){(0,u.warn)(`Optional content group not found: ${O}`);return}t(this,A).get(O)._setVisible(k,!!I),P(this,H,null)}get hasInitialVisibility(){return t(this,z)===null||this.getHash()===t(this,z)}getOrder(){return t(this,A).size?t(this,N)?t(this,N).slice():[...t(this,A).keys()]:null}getGroups(){return t(this,A).size>0?(0,u.objectFromMap)(t(this,A)):null}getGroup(O){return t(this,A).get(O)||null}getHash(){if(t(this,H)!==null)return t(this,H);const O=new it.MurmurHash3_64;for(const[I,G]of t(this,A))O.update(`${I}:${G.visible}`);return P(this,H,O.hexdigest())}}H=new WeakMap,A=new WeakMap,z=new WeakMap,N=new WeakMap,T=new WeakSet,Mn=function(O){const I=O.length;if(I<2)return!0;const G=O[0];for(let V=1;V<I;V++){const F=O[V];let X;if(Array.isArray(F))X=E(this,T,Mn).call(this,F);else if(t(this,A).has(F))X=t(this,A).get(F).visible;else return(0,u.warn)(`Optional content group not found: ${F}`),!0;switch(G){case"And":if(!X)return!1;break;case"Or":if(X)return!0;break;case"Not":return!X;default:return!0}}return G==="And"}},739:(ie,Nt,rt)=>{rt.d(Nt,{renderTextLayer:()=>x,updateTextLayer:()=>O});var u=rt(266),it=rt(473);const k=1e5,q=30,lt=.8,Q=new Map;function H(I,G){let V;if(G&&u.FeatureTest.isOffscreenCanvasSupported)V=new OffscreenCanvas(I,I).getContext("2d",{alpha:!1});else{const F=document.createElement("canvas");F.width=F.height=I,V=F.getContext("2d",{alpha:!1})}return V}function A(I,G){const V=Q.get(I);if(V)return V;const F=H(q,G);F.font=`${q}px ${I}`;const X=F.measureText("");let C=X.fontBoundingBoxAscent,$=Math.abs(X.fontBoundingBoxDescent);if(C){const xt=C/(C+$);return Q.set(I,xt),F.canvas.width=F.canvas.height=0,xt}F.strokeStyle="red",F.clearRect(0,0,q,q),F.strokeText("g",0,0);let st=F.getImageData(0,0,q,q).data;$=0;for(let xt=st.length-1-3;xt>=0;xt-=4)if(st[xt]>0){$=Math.ceil(xt/4/q);break}F.clearRect(0,0,q,q),F.strokeText("A",0,q),st=F.getImageData(0,0,q,q).data,C=0;for(let xt=0,_=st.length;xt<_;xt+=4)if(st[xt]>0){C=q-Math.floor(xt/4/q);break}if(F.canvas.width=F.canvas.height=0,C){const xt=C/(C+$);return Q.set(I,xt),xt}return Q.set(I,lt),lt}function z(I,G,V){const F=document.createElement("span"),X={angle:0,canvasWidth:0,hasText:G.str!=="",hasEOL:G.hasEOL,fontSize:0};I._textDivs.push(F);const C=u.Util.transform(I._transform,G.transform);let $=Math.atan2(C[1],C[0]);const st=V[G.fontName];st.vertical&&($+=Math.PI/2);const xt=I._fontInspectorEnabled&&st.fontSubstitution||st.fontFamily,_=Math.hypot(C[2],C[3]),mt=_*A(xt,I._isOffscreenCanvasSupported);let wt,Ut;$===0?(wt=C[4],Ut=C[5]-mt):(wt=C[4]+mt*Math.sin($),Ut=C[5]-mt*Math.cos($));const Bt="calc(var(--scale-factor)*",_t=F.style;I._container===I._rootContainer?(_t.left=`${(100*wt/I._pageWidth).toFixed(2)}%`,_t.top=`${(100*Ut/I._pageHeight).toFixed(2)}%`):(_t.left=`${Bt}${wt.toFixed(2)}px)`,_t.top=`${Bt}${Ut.toFixed(2)}px)`),_t.fontSize=`${Bt}${_.toFixed(2)}px)`,_t.fontFamily=xt,X.fontSize=_,F.setAttribute("role","presentation"),F.textContent=G.str,F.dir=G.dir,I._fontInspectorEnabled&&(F.dataset.fontName=st.fontSubstitutionLoadedName||G.fontName),$!==0&&(X.angle=$*(180/Math.PI));let Kt=!1;if(G.str.length>1)Kt=!0;else if(G.str!==" "&&G.transform[0]!==G.transform[3]){const Fe=Math.abs(G.transform[0]),Yt=Math.abs(G.transform[3]);Fe!==Yt&&Math.max(Fe,Yt)/Math.min(Fe,Yt)>1.5&&(Kt=!0)}Kt&&(X.canvasWidth=st.vertical?G.height:G.width),I._textDivProperties.set(F,X),I._isReadableStream&&I._layoutText(F)}function N(I){const{div:G,scale:V,properties:F,ctx:X,prevFontSize:C,prevFontFamily:$}=I,{style:st}=G;let xt="";if(F.canvasWidth!==0&&F.hasText){const{fontFamily:_}=st,{canvasWidth:mt,fontSize:wt}=F;(C!==wt||$!==_)&&(X.font=`${wt*V}px ${_}`,I.prevFontSize=wt,I.prevFontFamily=_);const{width:Ut}=X.measureText(G.textContent);Ut>0&&(xt=`scaleX(${mt*V/Ut})`)}F.angle!==0&&(xt=`rotate(${F.angle}deg) ${xt}`),xt.length>0&&(st.transform=xt)}function T(I){if(I._canceled)return;const G=I._textDivs,V=I._capability;if(G.length>k){V.resolve();return}if(!I._isReadableStream)for(const X of G)I._layoutText(X);V.resolve()}class W{constructor({textContentSource:G,container:V,viewport:F,textDivs:X,textDivProperties:C,textContentItemsStr:$,isOffscreenCanvasSupported:st}){var Ut;this._textContentSource=G,this._isReadableStream=G instanceof ReadableStream,this._container=this._rootContainer=V,this._textDivs=X||[],this._textContentItemsStr=$||[],this._isOffscreenCanvasSupported=st,this._fontInspectorEnabled=!!((Ut=globalThis.FontInspector)!=null&&Ut.enabled),this._reader=null,this._textDivProperties=C||new WeakMap,this._canceled=!1,this._capability=new u.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:F.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:H(0,st)};const{pageWidth:xt,pageHeight:_,pageX:mt,pageY:wt}=F.rawDims;this._transform=[1,0,0,-1,-mt,wt+_],this._pageWidth=xt,this._pageHeight=_,(0,it.setLayerDimensions)(V,F),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new u.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new u.AbortException("TextLayer task cancelled."))}_processItems(G,V){for(const F of G){if(F.str===void 0){if(F.type==="beginMarkedContentProps"||F.type==="beginMarkedContent"){const X=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),F.id!==null&&this._container.setAttribute("id",`${F.id}`),X.append(this._container)}else F.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(F.str),z(this,F,V)}}_layoutText(G){const V=this._layoutTextParams.properties=this._textDivProperties.get(G);if(this._layoutTextParams.div=G,N(this._layoutTextParams),V.hasText&&this._container.append(G),V.hasEOL){const F=document.createElement("br");F.setAttribute("role","presentation"),this._container.append(F)}}_render(){const G=new u.PromiseCapability;let V=Object.create(null);if(this._isReadableStream){const F=()=>{this._reader.read().then(({value:X,done:C})=>{if(C){G.resolve();return}Object.assign(V,X.styles),this._processItems(X.items,V),F()},G.reject)};this._reader=this._textContentSource.getReader(),F()}else if(this._textContentSource){const{items:F,styles:X}=this._textContentSource;this._processItems(F,X),G.resolve()}else throw new Error('No "textContentSource" parameter specified.');G.promise.then(()=>{V=null,T(this)},this._capability.reject)}}function x(I){const G=new W(I);return G._render(),G}function O({container:I,viewport:G,textDivs:V,textDivProperties:F,isOffscreenCanvasSupported:X,mustRotate:C=!0,mustRescale:$=!0}){if(C&&(0,it.setLayerDimensions)(I,{rotation:G.rotation}),$){const st=H(0,X),_={prevFontSize:null,prevFontFamily:null,div:null,scale:G.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:st};for(const mt of V)_.properties=F.get(mt),_.div=mt,N(_)}}},92:(ie,Nt,rt)=>{rt.d(Nt,{PDFDataTransportStream:()=>k});var u=rt(266),it=rt(473);class k{constructor({length:H,initialData:A,progressiveDone:z=!1,contentDispositionFilename:N=null,disableRange:T=!1,disableStream:W=!1},x){if((0,u.assert)(x,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=z,this._contentDispositionFilename=N,(A==null?void 0:A.length)>0){const O=A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength?A.buffer:new Uint8Array(A).buffer;this._queuedChunks.push(O)}this._pdfDataRangeTransport=x,this._isStreamingSupported=!W,this._isRangeSupported=!T,this._contentLength=H,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((O,I)=>{this._onReceiveData({begin:O,chunk:I})}),this._pdfDataRangeTransport.addProgressListener((O,I)=>{this._onProgress({loaded:O,total:I})}),this._pdfDataRangeTransport.addProgressiveReadListener(O=>{this._onReceiveData({chunk:O})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:H,chunk:A}){const z=A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength?A.buffer:new Uint8Array(A).buffer;if(H===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(z):this._queuedChunks.push(z);else{const N=this._rangeReaders.some(function(T){return T._begin!==H?!1:(T._enqueue(z),!0)});(0,u.assert)(N,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var H,A;return(A=(H=this._fullRequestReader)==null?void 0:H._loaded)!=null?A:0}_onProgress(H){var A,z,N,T;H.total===void 0?(z=(A=this._rangeReaders[0])==null?void 0:A.onProgress)==null||z.call(A,{loaded:H.loaded}):(T=(N=this._fullRequestReader)==null?void 0:N.onProgress)==null||T.call(N,{loaded:H.loaded,total:H.total})}_onProgressiveDone(){var H;(H=this._fullRequestReader)==null||H.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(H){const A=this._rangeReaders.indexOf(H);A>=0&&this._rangeReaders.splice(A,1)}getFullReader(){(0,u.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const H=this._queuedChunks;return this._queuedChunks=null,new q(this,H,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(H,A){if(A<=this._progressiveDataLength)return null;const z=new lt(this,H,A);return this._pdfDataRangeTransport.requestDataRange(H,A),this._rangeReaders.push(z),z}cancelAllRequests(H){var A;(A=this._fullRequestReader)==null||A.cancel(H);for(const z of this._rangeReaders.slice(0))z.cancel(H);this._pdfDataRangeTransport.abort()}}class q{constructor(H,A,z=!1,N=null){this._stream=H,this._done=z||!1,this._filename=(0,it.isPdfFile)(N)?N:null,this._queuedChunks=A||[],this._loaded=0;for(const T of this._queuedChunks)this._loaded+=T.byteLength;this._requests=[],this._headersReady=Promise.resolve(),H._fullRequestReader=this,this.onProgress=null}_enqueue(H){this._done||(this._requests.length>0?this._requests.shift().resolve({value:H,done:!1}):this._queuedChunks.push(H),this._loaded+=H.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return be(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const H=new u.PromiseCapability;return this._requests.push(H),H.promise})}cancel(H){this._done=!0;for(const A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class lt{constructor(H,A,z){this._stream=H,this._begin=A,this._end=z,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(H){if(!this._done){if(this._requests.length===0)this._queuedChunk=H;else{this._requests.shift().resolve({value:H,done:!1});for(const z of this._requests)z.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return be(this,null,function*(){if(this._queuedChunk){const A=this._queuedChunk;return this._queuedChunk=null,{value:A,done:!1}}if(this._done)return{value:void 0,done:!0};const H=new u.PromiseCapability;return this._requests.push(H),H.promise})}cancel(H){this._done=!0;for(const A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},368:(ie,Nt,rt)=>{rt.d(Nt,{GlobalWorkerOptions:()=>u});const u=Object.create(null);u.workerPort=null,u.workerSrc=""},160:(ie,Nt,rt)=>{rt.d(Nt,{XfaLayer:()=>it});var u=rt(521);class it{static setupStorage(q,lt,Q,H,A){const z=H.getValue(lt,{value:null});switch(Q.name){case"textarea":if(z.value!==null&&(q.textContent=z.value),A==="print")break;q.addEventListener("input",N=>{H.setValue(lt,{value:N.target.value})});break;case"input":if(Q.attributes.type==="radio"||Q.attributes.type==="checkbox"){if(z.value===Q.attributes.xfaOn?q.setAttribute("checked",!0):z.value===Q.attributes.xfaOff&&q.removeAttribute("checked"),A==="print")break;q.addEventListener("change",N=>{H.setValue(lt,{value:N.target.checked?N.target.getAttribute("xfaOn"):N.target.getAttribute("xfaOff")})})}else{if(z.value!==null&&q.setAttribute("value",z.value),A==="print")break;q.addEventListener("input",N=>{H.setValue(lt,{value:N.target.value})})}break;case"select":if(z.value!==null){q.setAttribute("value",z.value);for(const N of Q.children)N.attributes.value===z.value?N.attributes.selected=!0:N.attributes.hasOwnProperty("selected")&&delete N.attributes.selected}q.addEventListener("input",N=>{const T=N.target.options,W=T.selectedIndex===-1?"":T[T.selectedIndex].value;H.setValue(lt,{value:W})});break}}static setAttributes({html:q,element:lt,storage:Q=null,intent:H,linkService:A}){const{attributes:z}=lt,N=q instanceof HTMLAnchorElement;z.type==="radio"&&(z.name=`${z.name}-${H}`);for(const[T,W]of Object.entries(z))if(W!=null)switch(T){case"class":W.length&&q.setAttribute(T,W.join(" "));break;case"dataId":break;case"id":q.setAttribute("data-element-id",W);break;case"style":Object.assign(q.style,W);break;case"textContent":q.textContent=W;break;default:(!N||T!=="href"&&T!=="newWindow")&&q.setAttribute(T,W)}N&&A.addLinkAttributes(q,z.href,z.newWindow),Q&&z.dataId&&this.setupStorage(q,z.dataId,lt,Q)}static render(q){var O,I;const lt=q.annotationStorage,Q=q.linkService,H=q.xfaHtml,A=q.intent||"display",z=document.createElement(H.name);H.attributes&&this.setAttributes({html:z,element:H,intent:A,linkService:Q});const N=A!=="richText",T=q.div;if(T.append(z),q.viewport){const G=`matrix(${q.viewport.transform.join(",")})`;T.style.transform=G}N&&T.setAttribute("class","xfaLayer xfaFont");const W=[];if(H.children.length===0){if(H.value){const G=document.createTextNode(H.value);z.append(G),N&&u.XfaText.shouldBuildText(H.name)&&W.push(G)}return{textDivs:W}}const x=[[H,-1,z]];for(;x.length>0;){const[G,V,F]=x.at(-1);if(V+1===G.children.length){x.pop();continue}const X=G.children[++x.at(-1)[1]];if(X===null)continue;const{name:C}=X;if(C==="#text"){const st=document.createTextNode(X.value);W.push(st),F.append(st);continue}const $=(O=X==null?void 0:X.attributes)!=null&&O.xmlns?document.createElementNS(X.attributes.xmlns,C):document.createElement(C);if(F.append($),X.attributes&&this.setAttributes({html:$,element:X,storage:lt,intent:A,linkService:Q}),((I=X.children)==null?void 0:I.length)>0)x.push([X,-1,$]);else if(X.value){const st=document.createTextNode(X.value);N&&u.XfaText.shouldBuildText(C)&&W.push(st),$.append(st)}}for(const G of T.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))G.setAttribute("readOnly",!0);return{textDivs:W}}static update(q){const lt=`matrix(${q.viewport.transform.join(",")})`;q.div.style.transform=lt,q.div.hidden=!1}}},521:(ie,Nt,rt)=>{rt.d(Nt,{XfaText:()=>u});class u{static textContent(k){const q=[],lt={items:q,styles:Object.create(null)};function Q(H){var N;if(!H)return;let A=null;const z=H.name;if(z==="#text")A=H.value;else if(u.shouldBuildText(z))(N=H==null?void 0:H.attributes)!=null&&N.textContent?A=H.attributes.textContent:H.value&&(A=H.value);else return;if(A!==null&&q.push({str:A}),!!H.children)for(const T of H.children)Q(T)}return Q(k),lt}static shouldBuildText(k){return!(k==="textarea"||k==="input"||k==="option"||k==="select")}}},907:(ie,Nt,rt)=>{rt.a(ie,(u,it)=>be(this,null,function*(){try{rt.d(Nt,{AbortException:()=>k.AbortException,AnnotationEditorLayer:()=>H.AnnotationEditorLayer,AnnotationEditorParamsType:()=>k.AnnotationEditorParamsType,AnnotationEditorType:()=>k.AnnotationEditorType,AnnotationEditorUIManager:()=>A.AnnotationEditorUIManager,AnnotationLayer:()=>z.AnnotationLayer,AnnotationMode:()=>k.AnnotationMode,CMapCompressionType:()=>k.CMapCompressionType,ColorPicker:()=>N.ColorPicker,DOMSVGFactory:()=>lt.DOMSVGFactory,DrawLayer:()=>T.DrawLayer,FeatureTest:()=>k.FeatureTest,GlobalWorkerOptions:()=>W.GlobalWorkerOptions,ImageKind:()=>k.ImageKind,InvalidPDFException:()=>k.InvalidPDFException,MissingPDFException:()=>k.MissingPDFException,OPS:()=>k.OPS,Outliner:()=>x.Outliner,PDFDataRangeTransport:()=>q.PDFDataRangeTransport,PDFDateString:()=>lt.PDFDateString,PDFWorker:()=>q.PDFWorker,PasswordResponses:()=>k.PasswordResponses,PermissionFlag:()=>k.PermissionFlag,PixelsPerInch:()=>lt.PixelsPerInch,PromiseCapability:()=>k.PromiseCapability,RenderingCancelledException:()=>lt.RenderingCancelledException,UnexpectedResponseException:()=>k.UnexpectedResponseException,Util:()=>k.Util,VerbosityLevel:()=>k.VerbosityLevel,XfaLayer:()=>O.XfaLayer,build:()=>q.build,createValidAbsoluteUrl:()=>k.createValidAbsoluteUrl,fetchData:()=>lt.fetchData,getDocument:()=>q.getDocument,getFilenameFromUrl:()=>lt.getFilenameFromUrl,getPdfFilenameFromUrl:()=>lt.getPdfFilenameFromUrl,getXfaPageViewport:()=>lt.getXfaPageViewport,isDataScheme:()=>lt.isDataScheme,isPdfFile:()=>lt.isPdfFile,noContextMenu:()=>lt.noContextMenu,normalizeUnicode:()=>k.normalizeUnicode,renderTextLayer:()=>Q.renderTextLayer,setLayerDimensions:()=>lt.setLayerDimensions,shadow:()=>k.shadow,updateTextLayer:()=>Q.updateTextLayer,version:()=>q.version});var k=rt(266),q=rt(406),lt=rt(473),Q=rt(739),H=rt(629),A=rt(812),z=rt(640),N=rt(97),T=rt(423),W=rt(368),x=rt(405),O=rt(160),I=u([q]);q=(I.then?(yield I)():I)[0];const G="4.0.379",V="9e14d04fd";it()}catch(G){it(G)}}))},694:(ie,Nt,rt)=>{var Q,Pr,A,Lr,N,Ls;rt.d(Nt,{MessageHandler:()=>lt});var u=rt(266);const it={UNKNOWN:0,DATA:1,ERROR:2},k={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function q(W){switch(W instanceof Error||typeof W=="object"&&W!==null||(0,u.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),W.name){case"AbortException":return new u.AbortException(W.message);case"MissingPDFException":return new u.MissingPDFException(W.message);case"PasswordException":return new u.PasswordException(W.message,W.code);case"UnexpectedResponseException":return new u.UnexpectedResponseException(W.message,W.status);case"UnknownErrorException":return new u.UnknownErrorException(W.message,W.details);default:return new u.UnknownErrorException(W.message,W.toString())}}class lt{constructor(x,O,I){f(this,Q);f(this,A);f(this,N);this.sourceName=x,this.targetName=O,this.comObj=I,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=G=>{const V=G.data;if(V.targetName!==this.sourceName)return;if(V.stream){E(this,A,Lr).call(this,V);return}if(V.callback){const X=V.callbackId,C=this.callbackCapabilities[X];if(!C)throw new Error(`Cannot resolve callback ${X}`);if(delete this.callbackCapabilities[X],V.callback===it.DATA)C.resolve(V.data);else if(V.callback===it.ERROR)C.reject(q(V.reason));else throw new Error("Unexpected callback case");return}const F=this.actionHandler[V.action];if(!F)throw new Error(`Unknown action from worker: ${V.action}`);if(V.callbackId){const X=this.sourceName,C=V.sourceName;new Promise(function($){$(F(V.data))}).then(function($){I.postMessage({sourceName:X,targetName:C,callback:it.DATA,callbackId:V.callbackId,data:$})},function($){I.postMessage({sourceName:X,targetName:C,callback:it.ERROR,callbackId:V.callbackId,reason:q($)})});return}if(V.streamId){E(this,Q,Pr).call(this,V);return}F(V.data)},I.addEventListener("message",this._onComObjOnMessage)}on(x,O){const I=this.actionHandler;if(I[x])throw new Error(`There is already an actionName called "${x}"`);I[x]=O}send(x,O,I){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,data:O},I)}sendWithPromise(x,O,I){const G=this.callbackId++,V=new u.PromiseCapability;this.callbackCapabilities[G]=V;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,callbackId:G,data:O},I)}catch(F){V.reject(F)}return V.promise}sendWithStream(x,O,I,G){const V=this.streamId++,F=this.sourceName,X=this.targetName,C=this.comObj;return new ReadableStream({start:$=>{const st=new u.PromiseCapability;return this.streamControllers[V]={controller:$,startCall:st,pullCall:null,cancelCall:null,isClosed:!1},C.postMessage({sourceName:F,targetName:X,action:x,streamId:V,data:O,desiredSize:$.desiredSize},G),st.promise},pull:$=>{const st=new u.PromiseCapability;return this.streamControllers[V].pullCall=st,C.postMessage({sourceName:F,targetName:X,stream:k.PULL,streamId:V,desiredSize:$.desiredSize}),st.promise},cancel:$=>{(0,u.assert)($ instanceof Error,"cancel must have a valid reason");const st=new u.PromiseCapability;return this.streamControllers[V].cancelCall=st,this.streamControllers[V].isClosed=!0,C.postMessage({sourceName:F,targetName:X,stream:k.CANCEL,streamId:V,reason:q($)}),st.promise}},I)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}Q=new WeakSet,Pr=function(x){const O=x.streamId,I=this.sourceName,G=x.sourceName,V=this.comObj,F=this,X=this.actionHandler[x.action],C={enqueue($,st=1,xt){if(this.isCancelled)return;const _=this.desiredSize;this.desiredSize-=st,_>0&&this.desiredSize<=0&&(this.sinkCapability=new u.PromiseCapability,this.ready=this.sinkCapability.promise),V.postMessage({sourceName:I,targetName:G,stream:k.ENQUEUE,streamId:O,chunk:$},xt)},close(){this.isCancelled||(this.isCancelled=!0,V.postMessage({sourceName:I,targetName:G,stream:k.CLOSE,streamId:O}),delete F.streamSinks[O])},error($){(0,u.assert)($ instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,V.postMessage({sourceName:I,targetName:G,stream:k.ERROR,streamId:O,reason:q($)}))},sinkCapability:new u.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:x.desiredSize,ready:null};C.sinkCapability.resolve(),C.ready=C.sinkCapability.promise,this.streamSinks[O]=C,new Promise(function($){$(X(x.data,C))}).then(function(){V.postMessage({sourceName:I,targetName:G,stream:k.START_COMPLETE,streamId:O,success:!0})},function($){V.postMessage({sourceName:I,targetName:G,stream:k.START_COMPLETE,streamId:O,reason:q($)})})},A=new WeakSet,Lr=function(x){const O=x.streamId,I=this.sourceName,G=x.sourceName,V=this.comObj,F=this.streamControllers[O],X=this.streamSinks[O];switch(x.stream){case k.START_COMPLETE:x.success?F.startCall.resolve():F.startCall.reject(q(x.reason));break;case k.PULL_COMPLETE:x.success?F.pullCall.resolve():F.pullCall.reject(q(x.reason));break;case k.PULL:if(!X){V.postMessage({sourceName:I,targetName:G,stream:k.PULL_COMPLETE,streamId:O,success:!0});break}X.desiredSize<=0&&x.desiredSize>0&&X.sinkCapability.resolve(),X.desiredSize=x.desiredSize,new Promise(function(C){var $;C(($=X.onPull)==null?void 0:$.call(X))}).then(function(){V.postMessage({sourceName:I,targetName:G,stream:k.PULL_COMPLETE,streamId:O,success:!0})},function(C){V.postMessage({sourceName:I,targetName:G,stream:k.PULL_COMPLETE,streamId:O,reason:q(C)})});break;case k.ENQUEUE:if((0,u.assert)(F,"enqueue should have stream controller"),F.isClosed)break;F.controller.enqueue(x.chunk);break;case k.CLOSE:if((0,u.assert)(F,"close should have stream controller"),F.isClosed)break;F.isClosed=!0,F.controller.close(),E(this,N,Ls).call(this,F,O);break;case k.ERROR:(0,u.assert)(F,"error should have stream controller"),F.controller.error(q(x.reason)),E(this,N,Ls).call(this,F,O);break;case k.CANCEL_COMPLETE:x.success?F.cancelCall.resolve():F.cancelCall.reject(q(x.reason)),E(this,N,Ls).call(this,F,O);break;case k.CANCEL:if(!X)break;new Promise(function(C){var $;C(($=X.onCancel)==null?void 0:$.call(X,q(x.reason)))}).then(function(){V.postMessage({sourceName:I,targetName:G,stream:k.CANCEL_COMPLETE,streamId:O,success:!0})},function(C){V.postMessage({sourceName:I,targetName:G,stream:k.CANCEL_COMPLETE,streamId:O,reason:q(C)})}),X.sinkCapability.reject(q(x.reason)),X.isCancelled=!0,delete this.streamSinks[O];break;default:throw new Error("Unexpected stream case")}},N=new WeakSet,Ls=function(x,O){return be(this,null,function*(){var I,G,V;yield Promise.allSettled([(I=x.startCall)==null?void 0:I.promise,(G=x.pullCall)==null?void 0:G.promise,(V=x.cancelCall)==null?void 0:V.promise]),delete this.streamControllers[O]})}},825:(ie,Nt,rt)=>{rt.d(Nt,{MurmurHash3_64:()=>lt});var u=rt(266);const it=3285377520,k=4294901760,q=65535;class lt{constructor(H){this.h1=H?H&4294967295:it,this.h2=H?H&4294967295:it}update(H){let A,z;if(typeof H=="string"){A=new Uint8Array(H.length*2),z=0;for(let $=0,st=H.length;$<st;$++){const xt=H.charCodeAt($);xt<=255?A[z++]=xt:(A[z++]=xt>>>8,A[z++]=xt&255)}}else if((0,u.isArrayBuffer)(H))A=H.slice(),z=A.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const N=z>>2,T=z-N*4,W=new Uint32Array(A.buffer,0,N);let x=0,O=0,I=this.h1,G=this.h2;const V=3432918353,F=461845907,X=V&q,C=F&q;for(let $=0;$<N;$++)$&1?(x=W[$],x=x*V&k|x*X&q,x=x<<15|x>>>17,x=x*F&k|x*C&q,I^=x,I=I<<13|I>>>19,I=I*5+3864292196):(O=W[$],O=O*V&k|O*X&q,O=O<<15|O>>>17,O=O*F&k|O*C&q,G^=O,G=G<<13|G>>>19,G=G*5+3864292196);switch(x=0,T){case 3:x^=A[N*4+2]<<16;case 2:x^=A[N*4+1]<<8;case 1:x^=A[N*4],x=x*V&k|x*X&q,x=x<<15|x>>>17,x=x*F&k|x*C&q,N&1?I^=x:G^=x}this.h1=I,this.h2=G}hexdigest(){let H=this.h1,A=this.h2;return H^=A>>>1,H=H*3981806797&k|H*36045&q,A=A*4283543511&k|((A<<16|H>>>16)*2950163797&k)>>>16,H^=A>>>1,H=H*444984403&k|H*60499&q,A=A*3301882366&k|((A<<16|H>>>16)*3120437893&k)>>>16,H^=A>>>1,(H>>>0).toString(16).padStart(8,"0")+(A>>>0).toString(16).padStart(8,"0")}}},266:(ie,Nt,rt)=>{var St;rt.d(Nt,{AbortException:()=>Wt,AnnotationBorderStyleType:()=>C,AnnotationEditorParamsType:()=>W,AnnotationEditorPrefix:()=>N,AnnotationEditorType:()=>T,AnnotationMode:()=>z,AnnotationPrefix:()=>dt,AnnotationType:()=>G,BaseException:()=>Gt,CMapCompressionType:()=>mt,FONT_IDENTITY_MATRIX:()=>k,FeatureTest:()=>i,FormatError:()=>ge,IDENTITY_MATRIX:()=>it,ImageKind:()=>I,InvalidPDFException:()=>ee,LINE_FACTOR:()=>lt,MAX_IMAGE_SIZE_TO_CACHE:()=>q,MissingPDFException:()=>qt,OPS:()=>wt,PasswordException:()=>se,PasswordResponses:()=>Ut,PermissionFlag:()=>x,PromiseCapability:()=>tt,RenderingIntentFlag:()=>A,TextRenderingMode:()=>O,UnexpectedResponseException:()=>he,UnknownErrorException:()=>le,Util:()=>p,VerbosityLevel:()=>_,assert:()=>fe,bytesToString:()=>ae,createValidAbsoluteUrl:()=>Xt,getUuid:()=>kt,getVerbosityLevel:()=>Kt,info:()=>Fe,isArrayBuffer:()=>D,isNodeJS:()=>u,normalizeUnicode:()=>yt,objectFromMap:()=>ke,setVerbosityLevel:()=>_t,shadow:()=>te,string32:()=>xe,stringToBytes:()=>we,unreachable:()=>Jt,warn:()=>Yt});const u=typeof ni=="object"&&ni+""=="[object process]"&&!ni.versions.nw&&!(ni.versions.electron&&ni.type&&ni.type!=="browser"),it=[1,0,0,1,0,0],k=[.001,0,0,.001,0,0],q=1e7,lt=1.35,H=.35/lt,A={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},z={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},N="pdfjs_internal_editor_",T={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},W={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32},x={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},O={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},I={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},G={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},V={GROUP:"Group",REPLY:"R"},F={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},X={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},C={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},$={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},st={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},xt={O:"PageOpen",C:"PageClose"},_={ERRORS:0,WARNINGS:1,INFOS:5},mt={NONE:0,BINARY:1},wt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},Ut={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Bt=_.WARNINGS;function _t(S){Number.isInteger(S)&&(Bt=S)}function Kt(){return Bt}function Fe(S){Bt>=_.INFOS&&console.log(`Info: ${S}`)}function Yt(S){Bt>=_.WARNINGS&&console.log(`Warning: ${S}`)}function Jt(S){throw new Error(S)}function fe(S,s){S||Jt(s)}function ne(S){switch(S==null?void 0:S.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Xt(S,s=null,a=null){if(!S)return null;try{if(a&&typeof S=="string"){if(a.addDefaultProtocol&&S.startsWith("www.")){const U=S.match(/\./g);(U==null?void 0:U.length)>=2&&(S=`http://${S}`)}if(a.tryConvertEncoding)try{S=g(S)}catch(U){}}const m=s?new URL(S,s):new URL(S);if(ne(m))return m}catch(m){}return null}function te(S,s,a,m=!1){return Object.defineProperty(S,s,{value:a,enumerable:!m,configurable:!0,writable:!1}),a}const Gt=function(){function s(a,m){this.constructor===s&&Jt("Cannot initialize BaseException."),this.message=a,this.name=m}return s.prototype=new Error,s.constructor=s,s}();class se extends Gt{constructor(s,a){super(s,"PasswordException"),this.code=a}}class le extends Gt{constructor(s,a){super(s,"UnknownErrorException"),this.details=a}}class ee extends Gt{constructor(s){super(s,"InvalidPDFException")}}class qt extends Gt{constructor(s){super(s,"MissingPDFException")}}class he extends Gt{constructor(s,a){super(s,"UnexpectedResponseException"),this.status=a}}class ge extends Gt{constructor(s){super(s,"FormatError")}}class Wt extends Gt{constructor(s){super(s,"AbortException")}}function ae(S){(typeof S!="object"||(S==null?void 0:S.length)===void 0)&&Jt("Invalid argument for bytesToString");const s=S.length,a=8192;if(s<a)return String.fromCharCode.apply(null,S);const m=[];for(let U=0;U<s;U+=a){const et=Math.min(U+a,s),ft=S.subarray(U,et);m.push(String.fromCharCode.apply(null,ft))}return m.join("")}function we(S){typeof S!="string"&&Jt("Invalid argument for stringToBytes");const s=S.length,a=new Uint8Array(s);for(let m=0;m<s;++m)a[m]=S.charCodeAt(m)&255;return a}function xe(S){return String.fromCharCode(S>>24&255,S>>16&255,S>>8&255,S&255)}function Ce(S){return Object.keys(S).length}function ke(S){const s=Object.create(null);for(const[a,m]of S)s[a]=m;return s}function M(){const S=new Uint8Array(4);return S[0]=1,new Uint32Array(S.buffer,0,1)[0]===1}function n(){try{return new Function(""),!0}catch(S){return!1}}class i{static get isLittleEndian(){return te(this,"isLittleEndian",M())}static get isEvalSupported(){return te(this,"isEvalSupported",n())}static get isOffscreenCanvasSupported(){return te(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas!="undefined")}static get platform(){return typeof navigator!="undefined"&&typeof(navigator==null?void 0:navigator.platform)=="string"?te(this,"platform",{isMac:navigator.platform.includes("Mac")}):te(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var s,a;return te(this,"isCSSRoundSupported",(a=(s=globalThis.CSS)==null?void 0:s.supports)==null?void 0:a.call(s,"width: round(1.5px, 1px)"))}}const d=[...Array(256).keys()].map(S=>S.toString(16).padStart(2,"0"));class p{static makeHexColor(s,a,m){return`#${d[s]}${d[a]}${d[m]}`}static scaleMinMax(s,a){let m;s[0]?(s[0]<0&&(m=a[0],a[0]=a[1],a[1]=m),a[0]*=s[0],a[1]*=s[0],s[3]<0&&(m=a[2],a[2]=a[3],a[3]=m),a[2]*=s[3],a[3]*=s[3]):(m=a[0],a[0]=a[2],a[2]=m,m=a[1],a[1]=a[3],a[3]=m,s[1]<0&&(m=a[2],a[2]=a[3],a[3]=m),a[2]*=s[1],a[3]*=s[1],s[2]<0&&(m=a[0],a[0]=a[1],a[1]=m),a[0]*=s[2],a[1]*=s[2]),a[0]+=s[4],a[1]+=s[4],a[2]+=s[5],a[3]+=s[5]}static transform(s,a){return[s[0]*a[0]+s[2]*a[1],s[1]*a[0]+s[3]*a[1],s[0]*a[2]+s[2]*a[3],s[1]*a[2]+s[3]*a[3],s[0]*a[4]+s[2]*a[5]+s[4],s[1]*a[4]+s[3]*a[5]+s[5]]}static applyTransform(s,a){const m=s[0]*a[0]+s[1]*a[2]+a[4],U=s[0]*a[1]+s[1]*a[3]+a[5];return[m,U]}static applyInverseTransform(s,a){const m=a[0]*a[3]-a[1]*a[2],U=(s[0]*a[3]-s[1]*a[2]+a[2]*a[5]-a[4]*a[3])/m,et=(-s[0]*a[1]+s[1]*a[0]+a[4]*a[1]-a[5]*a[0])/m;return[U,et]}static getAxialAlignedBoundingBox(s,a){const m=this.applyTransform(s,a),U=this.applyTransform(s.slice(2,4),a),et=this.applyTransform([s[0],s[3]],a),ft=this.applyTransform([s[2],s[1]],a);return[Math.min(m[0],U[0],et[0],ft[0]),Math.min(m[1],U[1],et[1],ft[1]),Math.max(m[0],U[0],et[0],ft[0]),Math.max(m[1],U[1],et[1],ft[1])]}static inverseTransform(s){const a=s[0]*s[3]-s[1]*s[2];return[s[3]/a,-s[1]/a,-s[2]/a,s[0]/a,(s[2]*s[5]-s[4]*s[3])/a,(s[4]*s[1]-s[5]*s[0])/a]}static singularValueDecompose2dScale(s){const a=[s[0],s[2],s[1],s[3]],m=s[0]*a[0]+s[1]*a[2],U=s[0]*a[1]+s[1]*a[3],et=s[2]*a[0]+s[3]*a[2],ft=s[2]*a[1]+s[3]*a[3],Tt=(m+ft)/2,Ft=Math.sqrt(ps(m+ft,2)-4*(m*ft-et*U))/2,jt=Tt+Ft||1,Vt=Tt-Ft||1;return[Math.sqrt(jt),Math.sqrt(Vt)]}static normalizeRect(s){const a=s.slice(0);return s[0]>s[2]&&(a[0]=s[2],a[2]=s[0]),s[1]>s[3]&&(a[1]=s[3],a[3]=s[1]),a}static intersect(s,a){const m=Math.max(Math.min(s[0],s[2]),Math.min(a[0],a[2])),U=Math.min(Math.max(s[0],s[2]),Math.max(a[0],a[2]));if(m>U)return null;const et=Math.max(Math.min(s[1],s[3]),Math.min(a[1],a[3])),ft=Math.min(Math.max(s[1],s[3]),Math.max(a[1],a[3]));return et>ft?null:[m,et,U,ft]}static bezierBoundingBox(s,a,m,U,et,ft,Tt,Ft){const jt=[],Vt=[[],[]];let Dt,Ht,y,Y,ct,ut,Pt,At;for(let v=0;v<2;++v){if(v===0?(Ht=6*s-12*m+6*et,Dt=-3*s+9*m-9*et+3*Tt,y=3*m-3*s):(Ht=6*a-12*U+6*ft,Dt=-3*a+9*U-9*ft+3*Ft,y=3*U-3*a),Math.abs(Dt)<1e-12){if(Math.abs(Ht)<1e-12)continue;Y=-y/Ht,0<Y&&Y<1&&jt.push(Y);continue}Pt=Ht*Ht-4*y*Dt,At=Math.sqrt(Pt),!(Pt<0)&&(ct=(-Ht+At)/(2*Dt),0<ct&&ct<1&&jt.push(ct),ut=(-Ht-At)/(2*Dt),0<ut&&ut<1&&jt.push(ut))}let c=jt.length,e;const l=c;for(;c--;)Y=jt[c],e=1-Y,Vt[0][c]=e*e*e*s+3*e*e*Y*m+3*e*Y*Y*et+Y*Y*Y*Tt,Vt[1][c]=e*e*e*a+3*e*e*Y*U+3*e*Y*Y*ft+Y*Y*Y*Ft;return Vt[0][l]=s,Vt[1][l]=a,Vt[0][l+1]=Tt,Vt[1][l+1]=Ft,Vt[0].length=Vt[1].length=l+2,[Math.min(...Vt[0]),Math.min(...Vt[1]),Math.max(...Vt[0]),Math.max(...Vt[1])]}}const o=null;function h(S){if(S[0]>="\xEF"){let a;if(S[0]==="\xFE"&&S[1]==="\xFF"?(a="utf-16be",S.length%2===1&&(S=S.slice(0,-1))):S[0]==="\xFF"&&S[1]==="\xFE"?(a="utf-16le",S.length%2===1&&(S=S.slice(0,-1))):S[0]==="\xEF"&&S[1]==="\xBB"&&S[2]==="\xBF"&&(a="utf-8"),a)try{const m=new TextDecoder(a,{fatal:!0}),U=we(S),et=m.decode(U);return et.includes("\x1B")?et.replaceAll(/\x1b[^\x1b]*(?:\x1b|$)/g,""):et}catch(m){Yt(`stringToPDFString: "${m}".`)}}const s=[];for(let a=0,m=S.length;a<m;a++){const U=S.charCodeAt(a);if(U===27){for(;++a<m&&S.charCodeAt(a)!==27;);continue}const et=o[U];s.push(et?String.fromCharCode(et):S.charAt(a))}return s.join("")}function g(S){return decodeURIComponent(escape(S))}function w(S){return unescape(encodeURIComponent(S))}function D(S){return typeof S=="object"&&(S==null?void 0:S.byteLength)!==void 0}function L(S,s){if(S.length!==s.length)return!1;for(let a=0,m=S.length;a<m;a++)if(S[a]!==s[a])return!1;return!0}function J(S=new Date){return[S.getUTCFullYear().toString(),(S.getUTCMonth()+1).toString().padStart(2,"0"),S.getUTCDate().toString().padStart(2,"0"),S.getUTCHours().toString().padStart(2,"0"),S.getUTCMinutes().toString().padStart(2,"0"),S.getUTCSeconds().toString().padStart(2,"0")].join("")}class tt{constructor(){f(this,St,!1);this.promise=new Promise((s,a)=>{this.resolve=m=>{P(this,St,!0),s(m)},this.reject=m=>{P(this,St,!0),a(m)}})}get settled(){return t(this,St)}}St=new WeakMap;let ht=null,at=null;function yt(S){return ht||(ht=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,at=new Map([["\uFB05","\u017Ft"]])),S.replaceAll(ht,(s,a,m)=>a?a.normalize("NFKC"):at.get(m))}function kt(){if(typeof crypto!="undefined"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const S=new Uint8Array(32);if(typeof crypto!="undefined"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(S);else for(let s=0;s<32;s++)S[s]=Math.floor(Math.random()*255);return ae(S)}const dt="pdfjs_internal_id_"}},Ve={};(()=>{var ie=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",Nt=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",rt=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",u=k=>{k&&k.d<1&&(k.d=1,k.forEach(q=>q.r--),k.forEach(q=>q.r--?q.r++:q()))},it=k=>k.map(q=>{if(q!==null&&typeof q=="object"){if(q[ie])return q;if(q.then){var lt=[];lt.d=0,q.then(A=>{Q[Nt]=A,u(lt)},A=>{Q[rt]=A,u(lt)});var Q={};return Q[ie]=A=>A(lt),Q}}var H={};return H[ie]=A=>{},H[Nt]=q,H});qe.a=(k,q,lt)=>{var Q;lt&&((Q=[]).d=-1);var H=new Set,A=k.exports,z,N,T,W=new Promise((x,O)=>{T=O,N=x});W[Nt]=A,W[ie]=x=>(Q&&x(Q),H.forEach(x),W.catch(O=>{})),k.exports=W,q(x=>{z=it(x);var O,I=()=>z.map(V=>{if(V[rt])throw V[rt];return V[Nt]}),G=new Promise(V=>{O=()=>V(I),O.r=0;var F=X=>X!==Q&&!H.has(X)&&(H.add(X),X&&!X.d&&(O.r++,X.push(O)));z.map(X=>X[ie](F))});return O.r?G:I()},x=>(x?T(W[rt]=x):N(A),u(Q))),Q&&Q.d<0&&(Q.d=0)}})(),qe.d=(ie,Nt)=>{for(var rt in Nt)qe.o(Nt,rt)&&!qe.o(ie,rt)&&Object.defineProperty(ie,rt,{enumerable:!0,get:Nt[rt]})},qe.o=(ie,Nt)=>Object.prototype.hasOwnProperty.call(ie,Nt);var Qt=qe(907);Qt=globalThis.pdfjsLib=yield globalThis.pdfjsLibPromise=Qt;var Mr=Qt.AbortException,Ir=Qt.AnnotationEditorLayer,Dr=Qt.AnnotationEditorParamsType,Nr=Qt.AnnotationEditorType,Or=Qt.AnnotationEditorUIManager,Hr=Qt.AnnotationLayer,Br=Qt.AnnotationMode,zr=Qt.CMapCompressionType,Ur=Qt.ColorPicker,Gr=Qt.DOMSVGFactory,Xr=Qt.DrawLayer,Vr=Qt.FeatureTest,$r=Qt.GlobalWorkerOptions,Yr=Qt.ImageKind,jr=Qt.InvalidPDFException,Wr=Qt.MissingPDFException,qr=Qt.OPS,Kr=Qt.Outliner,Qr=Qt.PDFDataRangeTransport,Jr=Qt.PDFDateString,Zr=Qt.PDFWorker,_r=Qt.PasswordResponses,ta=Qt.PermissionFlag,ea=Qt.PixelsPerInch,ia=Qt.PromiseCapability,sa=Qt.RenderingCancelledException,na=Qt.UnexpectedResponseException,ra=Qt.Util,aa=Qt.VerbosityLevel,oa=Qt.XfaLayer,la=Qt.build,ha=Qt.createValidAbsoluteUrl,ca=Qt.fetchData,da=Qt.getDocument,ua=Qt.getFilenameFromUrl,fa=Qt.getPdfFilenameFromUrl,pa=Qt.getXfaPageViewport,ga=Qt.isDataScheme,ma=Qt.isPdfFile,ba=Qt.noContextMenu,Aa=Qt.normalizeUnicode,va=Qt.renderTextLayer,ya=Qt.setLayerDimensions,Sa=Qt.shadow,wa=Qt.updateTextLayer,xa=Qt.version;ui()}catch(qe){ui(qe)}})},1)}}]);
}());