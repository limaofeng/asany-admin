(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[5867],{89887:function(H,y,u){"use strict";var g=u(64219),s=u(16477),e=u(39428),A=u(3182),v=u(2824),r=u(67294),b=u(28865),x=u(94184),P=u.n(x),j=u(30381),f=u.n(j),B=u(7020),N=u(8845),i=u(33442),S=u(23183),n=u(51186),t=u(85893);function K(l){var a=l.article,D=l.categoryTreeData,c=l.onChangeCategory,m=l.baseUrl,O=(0,r.useState)(),I=(0,v.Z)(O,2),o=I[0],p=I[1],M=(0,r.useCallback)(function(C){p(C)},[]),T=(0,r.useCallback)(function(C){return C.isAfter(f()())},[]),W=(0,r.useCallback)(function(C){return{disabledHours:function(){if(!(o||C).isSame(f()(),"days"))return[];for(var h=[],R=f()().hours()+1;R<24;R++)h.push(R);return h},disabledMinutes:function(h){if(!(o||C).isSame(f()(),"days"))return[];if(!C.set("hours",h).isSame(f()(),"hours"))return[];for(var R=[],Y=f()().minutes()+1;Y<60;Y++)R.push(Y);return R}}},[o]),E=(0,N.eU)(),U=(0,v.Z)(E,1),_=U[0],Z=(0,i.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",content:(0,t.jsxs)(t.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,t.jsx)("strong",{children:a==null?void 0:a.title}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})},(0,A.Z)((0,e.Z)().mark(function C(){return(0,e.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,_({variables:{id:a.id}});case 2:case"end":return h.stop()}},C)}))),L=(0,v.Z)(Z,1),F=L[0],w=(0,r.useCallback)((0,A.Z)((0,e.Z)().mark(function C(){return(0,e.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,F();case 2:if(!h.sent){h.next=4;break}B.m8.replace("".concat(m,"/cms/categories/").concat(a.category.id,"/articles"));case 4:case"end":return h.stop()}},C)})),[F,m,a]);return(0,t.jsxs)("div",{className:"d-flex flex-column gap-7 gap-lg-10 w-100 w-lg-300px mb-7",children:[(0,t.jsxs)(n.Zb,{flush:!0,children:[(0,t.jsxs)(n.Zb.Header,{className:"ribbon ribbon-top ribbon-vertical",children:[!!(a!=null&&a.status)&&(a==null?void 0:a.status)!=="DRAFT"&&(0,t.jsx)("div",{className:P()("ribbon-label",{"bg-primary":(a==null?void 0:a.status)=="PUBLISHED","bg-success":(a==null?void 0:a.status)=="SCHEDULED","bg-danger":(a==null?void 0:a.status)=="INACTIVE"}),children:d(a.status)}),(0,t.jsx)(n.Zb.Title,{children:"\u6587\u7AE0\u8BBE\u7F6E"})]}),(0,t.jsxs)(n.Zb.Body,{className:" pt-0",children:[(0,t.jsx)(n.l0.Item,{name:"image",className:"text-center",children:(0,t.jsx)(n.gq.Image,{width:240,height:150,className:"mb-3",space:"Ohc2OaZ4",accept:".png, .jpg, .jpeg",backgroundImage:"/assets/media/svg/files/blank-image.svg"})}),(0,t.jsx)("div",{className:"text-muted fs-7 mb-6",children:"\u8BBE\u7F6E\u6587\u7AE0\u5C01\u9762\u56FE\u3002\u4EC5\u63A5\u53D7 *.png\u3001*.jpg \u548C *.jpeg \u683C\u5F0F\u7684\u56FE\u7247"}),(0,t.jsx)(n.l0.Item,{className:"mb-3",label:"\u6240\u5C5E\u680F\u76EE",name:["category","id"],rules:[{required:!0,message:"\u6240\u5C5E\u680F\u76EE\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,t.jsx)(s.Z,{onChange:c,style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:D,placeholder:"\u9009\u62E9\u680F\u76EE",treeDefaultExpandAll:!0,transitionName:""})}),(0,t.jsx)("div",{className:"text-muted fs-7 mb-6",children:"\u60A8\u7684\u6587\u7AE0\u5FC5\u987B\u53D1\u5E03\u5728\u4E00\u4E2A\u680F\u76EE\u4E2D"}),(0,t.jsx)(n.l0.Item,{name:"publishedAt",label:"\u53D1\u5E03\u65F6\u95F4",className:"mb-6",children:(0,t.jsx)(S.Z,{onChange:M,disabled:(a==null?void 0:a.status)=="SCHEDULED",disabledDate:T,disabledTime:W})}),(0,t.jsx)(n.l0.Item,{name:"summary",label:"\u6458\u8981",className:"mb-6",children:(0,t.jsx)(n.II.TextArea,{autoSize:{minRows:6}})}),(0,t.jsx)(n.l0.Item,{name:"authors",label:"\u4F5C\u8005",children:(0,t.jsx)(n.II,{})})]})]}),a&&(0,t.jsx)(n.Zb,{flush:!0,className:"py-4",children:(0,t.jsxs)(n.Zb.Body,{children:[(0,t.jsx)(n.zx,{onClick:w,className:"mb-3",variant:"light-danger",icon:(0,t.jsx)(b.JO,{className:"svg-icon-2",name:"Bootstrap/trash"}),children:"\u5220\u9664"}),(0,t.jsx)("div",{className:"text-muted fs-7 mb-6",children:"\u6587\u7AE0\u5220\u9664\u540E\uFF0C\u4E0D\u53EF\u6062\u590D"})]})})]})}function d(l){return l=="PUBLISHED"?"\u5DF2\u53D1\u5E03":l=="SCHEDULED"?"\u8BA1\u5212\u4E2D":"\u5DF2\u5931\u6548"}y.Z=K},23183:function(H,y,u){"use strict";var g=u(39002),s=u(68351),e=u(53400),A=u(41505),v=u(85893);function r(b){var x=b.value,P=b.onChange,j=b.disabled,f=b.disabledDate,B=b.disabledTime;return(0,v.jsxs)("div",{children:[(0,v.jsx)(A.Z,{getPopupContainer:function(i){return i.parentNode},transitionName:"",allowClear:!1,dropdownClassName:"article-publish-dropdown-published-at",placement:"topLeft",value:x,disabled:j,onChange:P,disabledDate:f,style:{width:136}}),(0,v.jsx)(s.Z,{className:"ms-3",style:{width:88},allowClear:!1,getPopupContainer:function(i){return i.parentNode},transitionName:"",placeholder:"",value:x,disabled:j,onChange:P,disabledTime:B,format:"HH:mm",placement:"topLeft"})]})}y.Z=r},33043:function(H,y,u){"use strict";u.d(y,{aE:function(){return v},LQ:function(){return P},SF:function(){return f},H5:function(){return K}});var g=u(5618),s=u(51186),e=u(85893);function A(){return(0,e.jsxs)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:[(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",children:[(0,e.jsx)(s.l0.Item,{name:"subtitle",className:"mb-8 mw-400px",label:"\u526F\u6807\u9898",children:(0,e.jsx)(s.II,{})}),(0,e.jsx)(s.l0.Item,{className:"mb-3",label:"\u6807\u7B7E",name:"tags",children:(0,e.jsx)(g.ZP,{})}),(0,e.jsx)(s.l0.Item,{name:"source",className:"mb-8 mw-400px",label:"\u6765\u6E90",children:(0,e.jsx)(s.II,{})})]}),(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",title:"\u66F4\u591A\u529F\u80FD",bodyClassName:"pt-0",children:[(0,e.jsx)(s.l0.Item,{className:"mb-8",name:"xx",children:(0,e.jsx)(s.XZ,{value:"1",solid:!0,label:"\u542F\u7528\u8BC4\u8BBA"})}),(0,e.jsx)(s.l0.Item,{className:"mb-8",name:"x2",children:(0,e.jsx)(s.XZ,{value:"1",solid:!0,label:"\u5141\u8BB8\u6536\u85CF"})})]}),(0,e.jsx)(s.Zb,{flush:!0,className:"py-4",title:"\u5143\u6570\u636E",bodyClassName:"pt-0",children:"123145"})]})}var v=A,r=u(67294),b=u(28865);function x(d){var l=d.queueUpload,a=(0,r.useCallback)(function(D){var c;(c=l.current)===null||c===void 0||c.browse(D)},[l]);return(0,e.jsxs)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:[(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",children:[(0,e.jsx)(s.l0.Item,{className:"mb-8",name:"title",label:"\u6807\u9898",required:!0,help:"\u6807\u9898\u662F\u5FC5\u9700\u7684",rules:[{required:!0,message:"\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(s.II,{placeholder:"\u6587\u7AE0\u6807\u9898",className:"mw-400px"})}),(0,e.jsx)(s.l0.Item,{name:["body","text"],label:"\u6B63\u6587",help:"\u60A8\u53EF\u4EE5\u9009\u62E9\u9002\u5408\u81EA\u5DF1\u7684\uFF0C\u7F16\u8F91\u65B9\u5F0F",children:(0,e.jsx)(s.Bn,{className:"h-300px"})})]}),(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",title:"\u9644\u4EF6",bodyClassName:"pt-0",children:[(0,e.jsx)(s.l0.Item,{name:"attachments",noStyle:!0,children:(0,e.jsx)(s.gq.Queue,{ref:l,namespace:"email"})}),(0,e.jsx)(s.zx,{variant:"light-primary",className:"me-3 mt-4",onClick:a,icon:(0,e.jsx)(b.JO,{className:"svg-icon-2",name:"Duotune/com008"}),children:"\u6DFB\u52A0\u9644\u4EF6"})]})]})}var P=x;function j(){return(0,e.jsx)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",title:"SEO",bodyClassName:"pt-0",children:[(0,e.jsx)(s.l0.Item,{name:["meta","seo","title"],className:"mb-8",label:"\u6807\u9898",help:"\u8BBE\u7F6E\u5143\u6570\u636E\u6807\u9898, \u5EFA\u8BAE\u5173\u952E\u8BCD\u8981\u7B80\u5355, \u51C6\u786E",children:(0,e.jsx)(s.II,{className:"mw-400px"})}),(0,e.jsx)(s.l0.Item,{name:["meta","seo","description"],className:"mb-8",label:"\u63CF\u8FF0",help:"\u8BBE\u7F6E\u5143\u6570\u636E\u63CF\u8FF0, \u4EE5\u63D0\u9AD8\u6392\u540D",children:(0,e.jsx)(s.Bn,{className:"h-300px"})}),(0,e.jsx)(s.l0.Item,{name:["meta","seo","keywords"],label:"\u5173\u952E\u5B57",help:(0,e.jsxs)(e.Fragment,{children:["\u8BBE\u7F6E\u680F\u76EE\u76F8\u5173\u7684\u5173\u952E\u5B57\u5217\u8868\u3002\u901A\u8FC7\u5728\u6BCF\u4E2A\u5173\u952E\u5B57\u4E4B\u95F4\u6DFB\u52A0",(0,e.jsx)("code",{children:","}),"\u6765\u5206\u9694\u5173\u952E\u5B57"]}),children:(0,e.jsx)(g.ZP,{className:"form-control"})})]})})}var f=j,B=u(2824),N=u(30381),i=u.n(N),S=u(23183);function n(d){var l=d.status,a=d.submitting,D=d.onPublish,c=d.publishedAt,m=d.setPublishedAt,O=(0,r.useState)("publish"),I=(0,B.Z)(O,2),o=I[0],p=I[1],M=(0,r.useCallback)(function(_){p(function(Z){return Z==_.target.value?Z:(["schedule","reschedule"].includes(_.target.value)&&c.isBefore(i()())&&m(i()()),_.target.value)})},[c,m]),T=(0,r.useCallback)(function(_){m(_)},[m]),W=(0,r.useCallback)(function(){D(o)},[D,o]);(0,r.useEffect)(function(){l=="DRAFT"?p("publish"):l=="PUBLISHED"?p("update"):l=="SCHEDULED"&&p("reschedule")},[l]);var E=(0,r.useCallback)(function(_){return _.isBefore(i()())&&!_.isSame(i()(),"days")},[]),U=(0,r.useCallback)(function(_){return{disabledHours:function(){if(!c.isSame(i()(),"days"))return[];for(var L=[],F=0;F<i()().hours();F++)L.push(F);return L},disabledMinutes:function(L){if(!c.isSame(i()(),"days"))return[];if(!_.set("hours",L).isSame(i()(),"hours"))return[];for(var F=[],w=0;w<i()().minutes();w++)F.push(w);return F}}},[c]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"publish-popover-content",children:(0,e.jsxs)(s.Y8.Group,{value:o,onChange:M,children:[l=="PUBLISHED"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(s.Y8,{className:"align-items-start",solid:!0,inputClassName:"me-3",value:"unpublish",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u53D6\u6D88\u53D1\u5E03"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u5C06\u6587\u7AE0\u8BBE\u7F6E\u4E3A\u8349\u7A3F\u72B6\u6001"})]}),(0,e.jsx)("div",{className:"my-4"}),(0,e.jsxs)(s.Y8,{className:"align-items-start",solid:!0,inputClassName:"me-3",value:"update",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u5DF2\u53D1\u5E03"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u516C\u5F00\u663E\u793A\u8FD9\u7BC7\u6587\u7AE0"})]})]}),l=="SCHEDULED"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(s.Y8,{className:"align-items-start",solid:!0,inputClassName:"me-3",value:"revert_to_draft",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u6062\u590D\u4E3A\u8349\u7A3F"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u4E0D\u518D\u53D1\u5E03"})]}),(0,e.jsx)("div",{className:"my-4"}),(0,e.jsxs)(s.Y8,{solid:!0,className:"align-items-start",inputClassName:"me-3",value:"reschedule",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u5B9A\u65F6\u53D1\u5E03"}),(0,e.jsx)("div",{className:"my-2",children:(0,e.jsx)(S.Z,{disabledDate:E,disabledTime:U,value:c,onChange:T})}),(0,e.jsx)("div",{className:"form-item-help",children:"\u8BBE\u7F6E\u4E00\u4E2A\u65F6\u95F4, \u5C06\u5728\u672A\u6765\u81EA\u52A8\u53D1\u5E03\u3002"})]})]}),l=="DRAFT"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(s.Y8,{className:"align-items-start",solid:!0,inputClassName:"me-3",value:"publish",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u7ACB\u5373\u53D1\u5E03"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u7ACB\u5373\u53D1\u5E03\u6B64\u6587\u7AE0"})]}),(0,e.jsx)("div",{className:"my-4"}),(0,e.jsxs)(s.Y8,{solid:!0,className:"align-items-start",inputClassName:"me-3",value:"schedule",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u5B9A\u65F6\u53D1\u5E03"}),(0,e.jsx)("div",{className:"my-2",children:(0,e.jsx)(S.Z,{disabledDate:E,disabledTime:U,value:c,onChange:T})}),(0,e.jsx)("div",{className:"form-item-help",children:"\u8BBE\u7F6E\u4E00\u4E2A\u65F6\u95F4, \u5C06\u5728\u672A\u6765\u81EA\u52A8\u53D1\u5E03\u3002"})]})]})]})}),(0,e.jsx)(s.Z0,{style:"solid"}),(0,e.jsxs)("div",{className:"publish-popover-footer d-flex justify-content-end",children:[(0,e.jsx)(s.zx,{onClick:d.onClose,disabled:a,className:"me-2",variant:"light",children:"\u53D6\u6D88"}),(0,e.jsxs)(s.zx,{loading:a,onClick:W,children:[o=="publish"&&(a?"\u53D1\u5E03\u4E2D...":"\u53D1\u5E03"),o=="schedule"&&(a?"\u5B9A\u65F6\u53D1\u5E03\u4E2D...":"\u5B9A\u65F6\u53D1\u5E03"),o=="update"&&(a?"\u66F4\u65B0\u4E2D...":"\u66F4\u65B0"),o=="unpublish"&&(a?"\u53D6\u6D88\u53D1\u5E03\u4E2D...":"\u53D6\u6D88\u53D1\u5E03"),o=="reschedule"&&(a?"\u66F4\u65B0\u4E2D...":"\u91CD\u8BBE\u53D1\u5E03\u65F6\u95F4"),o=="revert_to_draft"&&(a?"\u53D6\u6D88\u4E2D...":"\u53D6\u6D88\u81EA\u52A8\u53D1\u5E03")]})]})]})}function t(d){var l=d.article,a=d.submitting,D=d.onPublish,c=d.publishedAt,m=d.setPublishedAt,O=d.onCancel,I=(0,r.useState)(!1),o=(0,B.Z)(I,2),p=o[0],M=o[1],T=(0,r.useCallback)(function(){M(!1)},[M]),W=(0,r.useCallback)(function(_){a||M(_)},[a]),E=(l==null?void 0:l.status)||"DRAFT",U=(0,r.useMemo)(function(){return E==="DRAFT"?"\u53D1\u5E03\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F":E==="PUBLISHED"?"\u66F4\u65B0\u6587\u7AE0\u72B6\u6001":E==="SCHEDULED"?"\u9884\u8BA1\u5C06\u5728"+i()(l==null?void 0:l.publishedAt).fromNow()+"\u53D1\u5E03":"\u91CD\u65B0\u53D1\u5E03"},[l==null?void 0:l.publishedAt,E]);return(0,r.useEffect)(function(){!p&&O()},[O,p]),(0,e.jsx)(s.J2,{stopPropagation:!0,visible:p,overlayClassName:"overlay-no-arrow article-publish-dropdown-content",title:U,content:(0,e.jsx)(n,{status:E,submitting:a,onClose:T,onPublish:D,publishedAt:c,setPublishedAt:m}),placement:"top-end",onVisibleChange:W,children:(0,e.jsxs)(s.zx,{className:"pe-2",children:[E==="DRAFT"&&"\u53D1\u5E03",E==="PUBLISHED"&&"\u66F4\u65B0",E==="SCHEDULED"&&"\u66F4\u65B0",(0,e.jsx)(b.JO,{name:"Bootstrap/chevron-down",className:"ms-2 svg-icon-6"})]})})}var K=t},33442:function(H,y,u){"use strict";var g=u(39428),s=u(11849),e=u(3182),A=u(67294),v=u(51186),r=u(25496);function b(x,P){var j=(0,A.useRef)(!1),f=(0,A.useCallback)((0,e.Z)((0,g.Z)().mark(function B(){var N,i;return(0,g.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return N=x.width,n.next=3,v.u_.confirm((0,s.Z)((0,s.Z)({},x),{},{width:N,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!j.current},preConfirm:function(){var t=(0,e.Z)((0,g.Z)().mark(function d(){var l,a,D;return(0,g.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return j.current=!0,m.prev=1,l=document.querySelector(".swal2-confirm"),l.textContent="\u5220\u9664\u4E2D...",a=document.createElement("span"),a.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),l.appendChild(a),m.next=9,(0,r.gw)(P(),350);case 9:D=m.sent,console.log(D);case 11:return m.prev=11,j.current=!1,m.finish(11);case 14:case"end":return m.stop()}},d,null,[[1,,11,14]])}));function K(){return t.apply(this,arguments)}return K}()}));case 3:if(i=n.sent,i.isConfirmed){n.next=6;break}return n.abrupt("return",!1);case 6:return v.FN.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),n.abrupt("return",!0);case 8:case"end":return n.stop()}},B)})),[P,x]);return[f]}y.Z=b}}]);
