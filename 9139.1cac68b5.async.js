(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[9139],{7347:function(Me,se,n){"use strict";n.d(se,{Z:function(){return jt}});var h=n(2824),s=n(67294),ce=n(54406),w=n(28865),V=n(94184),t=n.n(V),_=n(25719),z=n(39428),q=n(3182),p=n(1861),A=n(51084),o=n(17818),e=n(85893),R=function(u,a){var d,i=u.data,I=u.fetchMoreData,f=u.hasMore,C=u.children,N=u.loading,B=u.holdHeight,G=B===void 0?30:B,ee=(0,s.useRef)(null),F=(d=ee.current)===null||d===void 0?void 0:d.osInstance(),W=(0,s.useRef)({scrollTop:0,contentHeight:0});(0,s.useImperativeHandle)(a,function(){return F},[F]);var ne=(0,s.useCallback)(function(){var D=(0,q.Z)((0,z.Z)().mark(function k(de){var x;return(0,z.Z)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(x=G!=null?G:30,W.current.contentHeight=de.target.scrollHeight,W.current.scrollTop=de.target.scrollTop,!(de.target.scrollTop<x)){te.next=7;break}if(!(N||!f)){te.next=6;break}return te.abrupt("return");case 6:requestAnimationFrame(I);case 7:case"end":return te.stop()}},k)}));return function(k){return D.apply(this,arguments)}}(),[I,f,G,N]),ie=(0,A.P)(500,ne);return(0,e.jsxs)(p.E,{ref:ee,className:"d-flex h-100 flex-column custom-scrollbar pe-9 pt-8",options:{scrollbars:{autoHide:"scroll"},callbacks:{onScroll:ie,onContentSizeChanged:function(k){if(!!k){if(!F){setTimeout(function(){var x,P;(x=ee.current)===null||x===void 0||(P=x.osInstance())===null||P===void 0||P.scroll({y:"100%"})});return}if(F.scroll().max.y==0)F.scroll({y:"100%"});else if(W.current.contentHeight){var de=k.height-W.current.contentHeight;F.scroll({y:de+W.current.scrollTop})}}}}},children:[C,f?(0,e.jsx)("div",{className:t()("scroll-view-spin","d-flex align-items-center justify-content-center","fs-6",{"flex-column-fluid":i.length===0,"h-40px":i.length!==0}),children:(0,e.jsx)(o.yC,{tip:"\u52A0\u8F7D\u4E2D...",indicator:"Loading",size:"small"})}):(0,e.jsx)("div",{className:"con_nomore",children:"\u6CA1\u6709\u66F4\u591A\u5566~"})]})},y=s.forwardRef(R),g=n(29044),L=n(77333),U=n(26490),ue=n(70407),Ae=n(81117),r=n(52152),ke=[r.Nw.TEXTMESSAGE,r.Nw.ATTEXTMESSAGE],Ie=[r.Nw.PICTUREMESSAGE,r.Nw.VIDEOMESSAGE,r.Nw.FILEMESSAGE],ye=function(u){var a,d,i,I,f=u.msg,C=u.isSelf,N=u.children,B=(0,s.useState)(!1),G=(0,h.Z)(B,2),ee=G[0],F=G[1],W=["Copy","Translate","Reply","Forward"],ne=(0,g.Z)(),ie=(0,h.Z)(ne,2),D=ie[1],k=function(){L.Z.emit(U.Oo,"forward",JSON.stringify(f))},de=function(){L.Z.emit(U.rl,!0)},x=function(){L.Z.emit(U.cu,f)},P=(0,s.useCallback)(function(){ue.im.revokeMessage(JSON.stringify(f)).then(function(Q){L.Z.emit(U.rF,f.clientMsgID),console.log("res",Q)}).catch(function(Q){return o.FN.error("\u64A4\u56DE\u6D88\u606F\u5931\u8D25\uFF01",Q)})},[f]),te=(0,s.useCallback)(function(){console.log("msg",f),ue.im.deleteMessageFromLocalStorage(JSON.stringify(f)).then(function(Q){L.Z.emit(U.Cd,f.clientMsgID),console.log("res",Q)}).catch(function(Q){return o.FN.error("\u5220\u9664\u6D88\u606F\u5931\u8D25\uFF01"+Q.message)})},[f]),Ee=(0,s.useCallback)((0,q.Z)((0,z.Z)().mark(function Q(){var Y;return(0,z.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return F(!1),Z.next=3,o.u_.confirm({title:"\u5220\u9664\u6D88\u606F",content:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("p",{className:"tip-confirm",children:"\u786E\u5B9A\u5220\u9664\u8BE5\u6D88\u606F\u5417\uFF1F"})}),icon:"info",okText:"\u5220\u9664"});case 3:Y=Z.sent,Y.isConfirmed&&te();case 5:case"end":return Z.stop()}},Q)})),[te]),ve=(0,s.useCallback)(function(){var Q="";switch(f.contentType){case r.Nw.PICTUREMESSAGE:Q=f.pictureElem.sourcePicture.url;break;case r.Nw.VIDEOMESSAGE:Q=f.videoElem.videoUrl;break;case r.Nw.FILEMESSAGE:Q=f.fileElem.sourceUrl;break;default:break}var Y=Q.lastIndexOf("/"),Le=Q.slice(Y+1);(0,Ae.$2)(Q,Le)},[f.contentType,(a=f.fileElem)===null||a===void 0?void 0:a.sourceUrl,(d=f.pictureElem)===null||d===void 0||(i=d.sourcePicture)===null||i===void 0?void 0:i.url,(I=f.videoElem)===null||I===void 0?void 0:I.videoUrl]),De=(0,s.useMemo)(function(){return[{id:"Translate",title:"\u7FFB\u8BD1",icon:"Bootstrap/translate",method:function(){},hidden:!0},{id:"Forward",title:"\u8F6C\u53D1",icon:"Bootstrap/arrow-up-right-square",method:k,hidden:!1},{id:"Copy",title:"\u590D\u5236",icon:"Bootstrap/clipboard2",method:function(){var Y=f.contentType===r.Nw.ATTEXTMESSAGE?f.atElem.text:f.content;D(Y),o.FN.success("\u590D\u5236\u6210\u529F\uFF01"),F(!1)},hidden:!1},{id:"Multiple",title:"\u591A\u9009",icon:"Bootstrap/list-check",method:de,hidden:!1},{id:"Reply",title:"\u5F15\u7528",icon:"Bootstrap/chat-quote",method:x,hidden:!1},{id:"Revoke",title:"\u64A4\u56DE",icon:"Bootstrap/arrow-90deg-down",method:P,hidden:!1},{id:"Delete",title:"\u5220\u9664",icon:"Bootstrap/trash",method:Ee,hidden:!1},{id:"Download",title:"\u4E0B\u8F7D",icon:"Bootstrap/download",method:ve,hidden:!1}]},[D,Ee,ve,k,f.atElem.text,f.content,f.contentType,x,P]),Be=function(Y){return!ke.includes(f.contentType)&&W.includes(Y.id)&&(Y.hidden=!0),Y.id==="Download"&&!Ie.includes(f.contentType)&&(Y.hidden=!0),!C&&Y.id==="Revoke"&&(Y.hidden=!0),!Y.hidden&&(0,e.jsx)(o.v2.Item,{icon:(0,e.jsx)(w.JO,{name:Y.icon,className:"svg-icon-6"}),className:"px-3",onClick:Y.method,children:Y.title},Y.id)};return(0,e.jsx)(o.J2,{trigger:"contextMenu",visible:ee,onVisibleChange:F,content:(0,e.jsx)(o.v2,{className:"menu-sub show menu-sub-dropdown show menu-gray-600 menu-state-bg-light-primary fw-bold fs-8 w-125px py-2",children:De.map(Be)}),overlayClassName:"overlay-no-arrow msg_item_menu_popover",children:(0,e.jsx)("div",{className:t()("chat_bg_msg_content py-3",{"ps-4 pe-8":!C,"ps-8 pe-4":C}),children:N})})},Ne=ye,$=n(11849),Ce=n(42532),me=n(96522),v=n(12968),je=n(68356),Ge=n(6366),lt=n(7020),ct=n(30381),ut=n.n(ct),dt=n(94335),ze=n.n(dt);function At(M){var u=M.options;return console.log("options",u),(0,e.jsx)("div",{children:"VideoPlayer"})}var $e=n(1787),vt=n.n($e),pe=n(35792),ft=[{context:"[\u6655]",src:""}],mt=function(u){var a=u.msg,d=u.audio,i=u.curCve,I=u.selfID,f=(0,s.useState)(!1),C=(0,h.Z)(f,2),N=C[0],B=C[1],G=(0,lt.tT)("open-im.contacts",function(Z){var O=Z.state;return O.groupMemberList}),ee=(0,s.useRef)(null),F=(0,s.useState)({}),W=(0,h.Z)(F,2),ne=W[0],ie=W[1],D=(0,s.useRef)();(0,s.useEffect)(function(){var Z;B(i?(0,pe.vJ)(i):!1),((Z=ee.current)===null||Z===void 0?void 0:Z.clientHeight)>60&&ie({paddingBottom:"16px",paddingRight:"8px"})},[i]);var k=function(O){return I===O},de=function(O){return ut()(a.sendTime).format(O?"HH:mm":"YYYY-MM-DD HH:mm")},x=function(O,m){L.Z.emit(U.a7,O,m)},P=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"chat_bg_msg_content_time";return(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:de(0),children:(0,e.jsx)("div",{className:O,children:de(1)})})},te=function(O){var m=O;return ft.map(function(ae){var H=m.indexOf(ae.context);H>-1&&(m=m.replaceAll(ae.context,'<img style="padding-right:2px" width="24px" src='.concat(ae.src," />")))}),m},Ee=function(O){var m=O,ae=/@\S+\s/g,H=m.match(ae);return H==null||H.map(function(X){var he=G.find(function(Pe){return Pe.userID===X.slice(1,-1)});he?m=m.replaceAll(X,`<span onclick='userClick("`.concat(he.userID.replace(".","-"),`")' style="color:#428be5;cursor: pointer;"> @`).concat(he.nickname," </span>")):m=m.replaceAll(X,`<span onclick="userClick('`.concat(X.slice(1,-1),`')" style="color:#428be5;cursor: pointer;"> `).concat(X,"</span>"))}),m},ve=function(O){var m=O.replaceAll("\\n","<br>");return m.replaceAll(`
`,"<br>")},De=function(O){var m=O,ae=/[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:._\+-~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:_\+.~#?&\/\/=]*)/g,H=m.match(ae);return H==null||H.map(function(X){m=m.replaceAll(X,`<a onclick="urlClick('`.concat(X,`')" href="javascript:;">`).concat(X,"</a>"))}),m},Be=function(O){switch(O.contentType){case r.Nw.TEXTMESSAGE:var m=ve(De(Ee(te(O.content))));return(0,e.jsx)("div",{className:"content",dangerouslySetInnerHTML:{__html:m}});case r.Nw.ATTEXTMESSAGE:return Ee(O.atElem.text);case r.Nw.PICTUREMESSAGE:return(0,e.jsx)(je.Z,{width:60,src:O.pictureElem.sourcePicture.url});default:return""}},Q=function(O){var m;d.current.src=O,(m=d.current)===null||m===void 0||m.play()},Y=function(O){D.current=O,O.on("waiting",function(){console.log("player is waiting")}),O.on("dispose",function(){console.log("player will dispose")})},Le=function(){var O,m;switch(a.contentType){case r.Nw.TEXTMESSAGE:var ae=a.content;return ae=te(ae),ae=De(ae),ae=ve(ae),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{ref:ee,style:ne,className:"chat_bg_msg_content_text ".concat(N?"":"nick_magin"),children:(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:ae}})}),P()]});case r.Nw.ATTEXTMESSAGE:var H=a.atElem.text;return H=te(H),H=Ee(H),H=De(H),H=ve(H),(0,e.jsxs)("div",{style:ne,className:"chat_bg_msg_content_text ".concat(N?"":"nick_magin"),children:[(0,e.jsx)("div",{style:{display:"inline-block"},dangerouslySetInnerHTML:{__html:H}}),P()]});case r.Nw.PICTUREMESSAGE:return(0,e.jsxs)("div",{className:"chat_bg_msg_content_pic ".concat(N?"":"nick_magin"),children:[(0,e.jsx)(je.Z,{placeholder:!0,height:200,src:(O=a.pictureElem.snapshotPicture.url)!==null&&O!==void 0?O:a.pictureElem.sourcePicture.url,preview:{visible:!1},fallback:"data:image/png;base64,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"}),P("pic_msg_time")]});case r.Nw.VOICEMESSAGE:var X=k(a.sendID),he=X?{paddingLeft:"4px"}:{paddingRight:"4px"},Pe=X?vt():ze();return(0,e.jsxs)("div",{style:ne,className:"chat_bg_msg_content_text chat_bg_msg_content_voice ".concat(N?"":"nick_magin"),children:[(0,e.jsxs)("div",{style:{flexDirection:X?"row-reverse":"row"},onClick:function(){return Q(a.soundElem.sourceUrl)},children:[(0,e.jsx)("img",{style:he,src:Pe,alt:""}),"".concat(a.soundElem.duration," ''")]}),P()]});case r.Nw.FILEMESSAGE:var be=a.fileElem,Ke=be.fileName.slice(be.fileName.lastIndexOf(".")+1);return(0,e.jsxs)("div",{className:"chat_bg_msg_content_text chat_bg_msg_content_file ".concat(N?"":"nick_magin"),children:[(0,e.jsxs)("div",{className:"file_container",children:[(0,e.jsx)("img",{src:(0,Ae.Sv)(Ke),alt:""}),(0,e.jsxs)("div",{className:"file_info",children:[(0,e.jsx)("div",{children:be.fileName}),(0,e.jsx)("div",{children:(0,Ae.RD)(be.fileSize)})]})]}),P()]});case r.Nw.VIDEOMESSAGE:var Ve={width:240,controls:!0,playbackRates:[.5,1,1.25,1.5,2],responsive:!0,fluid:!0,sources:[{src:a.videoElem.videoUrl,type:"video/mp4"}]};return(0,e.jsxs)("div",{className:"chat_bg_msg_content_video ".concat(N?"":"nick_magin"),children:[(0,e.jsx)(At,{options:Ve,onReady:Y}),P("video_msg_time")]});case r.Nw.QUOTEMESSAGE:var ot=a.quoteElem.quoteMessage,Qe=a.quoteElem.text;return Qe=ve(De(te(Qe))),(0,e.jsxs)("div",{style:ne,className:"chat_bg_msg_content_text chat_bg_msg_content_qute ".concat(N?"":"nick_magin"),children:[(0,e.jsxs)("div",{className:"qute_content",children:[(0,e.jsx)("div",{children:"".concat("Reply"+a.quoteElem.quoteMessage.senderNickname,":")}),Be(ot)]}),(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:Qe}}),P()]});case r.Nw.MERGERMESSAGE:var Ue=a.mergeElem;return(0,e.jsxs)("div",{style:ne,onClick:function(){return x(Ue,a.sendID)},className:"chat_bg_msg_content_text chat_bg_msg_content_mer ".concat(N?"":"nick_magin"),children:[(0,e.jsx)("div",{className:"title",children:Ue.title}),(0,e.jsx)("div",{className:"content",children:(m=Ue.abstractList)===null||m===void 0?void 0:m.map(function(S){return(0,e.jsx)("div",{className:"item",children:S},S)})}),P()]});case r.Nw.CARDMESSAGE:var Fe=JSON.parse(a.content);return(0,e.jsxs)("div",{style:ne,className:"chat_bg_msg_content_text chat_bg_msg_content_card ".concat(N?"":"nick_magin"),children:[(0,e.jsx)("div",{className:"title",children:"IDCard"}),(0,e.jsxs)("div",{className:"desc",children:[(0,e.jsx)(o.mN.Avatar,{src:Fe.faceURL,size:35}),(0,e.jsx)("div",{className:"card_nick",children:Fe.nickname})]}),P()]});case r.Nw.LOCATIONMESSAGE:var fe=a.locationElem,Xe={longitude:fe.longitude,latitude:fe.latitude};return(0,e.jsxs)("div",{className:"chat_bg_msg_content_map ".concat(N?"":"nick_magin"),children:[(0,e.jsx)(Ge.D5,{protocol:"https",center:Xe,amapkey:"dcdc861728801ee3410f67f6a487d3fa",children:(0,e.jsx)(Ge.Jx,{position:Xe})}),P("pic_msg_time")]});default:return(0,e.jsx)("div",{className:"chat_bg_msg_content_text ".concat(N?"":"nick_magin"),children:"UnsupportedMessage"})}};return Le()},qe=mt,Ye=[r.Nw.TEXTMESSAGE,r.Nw.ATTEXTMESSAGE,r.Nw.PICTUREMESSAGE,r.Nw.VIDEOMESSAGE,r.Nw.VOICEMESSAGE,r.Nw.CARDMESSAGE,r.Nw.FILEMESSAGE,r.Nw.LOCATIONMESSAGE],et=function(u){var a=u.msg,d=u.selfID,i=u.curCve,I=u.mutilSelect,f=u.className,C=(0,s.useState)(!1),N=(0,h.Z)(C,2),B=N[0],G=N[1],ee=(0,s.useRef)(null),F=(0,s.useRef)(null),W=(0,Ce.Z)(F),ne=(0,h.Z)(W,1),ie=ne[0],D=(0,s.useMemo)(function(){return d==a.sendID},[d,a.sendID]),k=(0,s.useMemo)(function(){return!i||!(0,pe.vJ)(i)},[i]);(0,s.useEffect)(function(){B&&G(!1)},[I]);var de=function(ve,De){a.isRead=!0,ue.im.markC2CMessageAsRead({userID:ve,msgIDList:[De]})};(0,s.useEffect)(function(){ie&&i.userID===a.sendID&&!a.isRead&&de(a.sendID,a.clientMsgID)},[ie,i]);var x=(0,s.useCallback)(function(){switch(a.status){case 1:return(0,e.jsx)(e.Fragment,{children:"loading..."});case 2:return i&&(0,pe.vJ)(i)?a.isRead?"\u5DF2\u8BFB":"\u672A\u8BFB":null;case 3:return(0,e.jsx)(e.Fragment,{});default:return null}},[i,a.isRead,a.status]),P=function(){I&&Ye.includes(a.contentType)&&(L.Z.emit(U.Co,!B,a),G(function(ve){return!ve}))},te=function(){(0,pe.vJ)(i)||L.Z.emit(U.oJ,a.sendID,a.senderNickname)};return(0,me.Z)(te,ee,{onClick:function(){},delay:500}),(0,e.jsx)("div",{ref:F,onClick:P,className:t()("msg-item d-flex mb-10",f,{"justify-content-start":!D,"justify-content-end":D,"mt-4":D}),children:(0,e.jsxs)("div",{className:t()("d-flex align-items-start",{"flex-column":k,"flex-row-reverse":D&&!k,"flex-row":!D&&!k}),children:[(0,e.jsxs)("div",{className:t()("d-flex align-items-center mb-2"),children:[(0,e.jsx)(o.mN.Avatar,{className:t()({"me-4":!D&&!k,"ms-4":D&&!k}),light:!0,size:40,alt:a.senderNickname,src:a.senderFaceUrl}),k&&(0,e.jsxs)("div",{className:"ms-3",children:[(0,e.jsx)("a",{href:"#",className:"fs-5 fw-bold text-gray-900 text-hover-primary me-1",children:a.senderNickname}),(0,e.jsx)("span",{className:"text-muted fs-7 mb-1",children:"2 mins"})]})]}),(0,e.jsxs)("div",{className:t()("msg-item-content rounded text-dark fw-semibold mw-lg-400px text-start",{"bg-light-info":!D,"bg-light-primary":D}),children:[(0,e.jsx)(Ne,{msg:a,isSelf:D,children:(0,e.jsx)(qe,(0,$.Z)({},u))},a.clientMsgID),D&&(0,e.jsx)("div",{style:{color:a.isRead?"#999":"#428BE5"},className:"self_msg_chat_flag",children:x()})]})]})})},Ze=et,Et=n(23761);function gt(M){var u,a=(0,s.useRef)(null),d=M.merID,i=M.msgList,I=M.loadMore,f=M.hasMore,C=M.curCve,N=M.loading,B=(0,s.useState)(!1),G=(0,h.Z)(B,2),ee=G[0],F=G[1],W=(u=(0,Et.o)().data)===null||u===void 0?void 0:u.uid,ne=Object.values(r.j7),ie=function(P){F(P)};(0,s.useEffect)(function(){return L.Z.on(U.rl,ie),function(){L.Z.off(U.rl,ie)}},[]);var D=(0,s.useCallback)(function(x){return x===W},[W]),k=(0,s.useCallback)(function(x){var P,te;if(x.contentType==r.j7.REVOKEMESSAGE||x.contentType==r.j7.ADVANCEREVOKEMESSAGE){var Ee=x.sendID,ve=(0,pe.vJ)(C)?C==null?void 0:C.showName:x.senderNickname;if(x.contentType==r.j7.ADVANCEREVOKEMESSAGE){var De=JSON.parse(x.content);ve=De.revokerNickname,Ee=De.revokerID}return(0,e.jsxs)(e.Fragment,{children:[D(Ee)?"\u4F60":(0,e.jsx)("b",{children:ve}),"\u64A4\u56DE\u4E86\u4E00\u6761\u6D88\u606F"]})}switch(x.contentType){case r.j7.FRIENDADDED:return"AlreadyFriend";case r.j7.GROUPCREATED:var Be=JSON.parse(x.notificationElem.detail),Q=Be.opUser;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("b",{children:D(Q.userID)?"You":Q.nickname}),"GroupCreated"]});case r.j7.GROUPINFOUPDATED:var Y=JSON.parse(x.notificationElem.detail),Le=Y.opUser;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("b",{children:D(Le.userID)?"You":Le.nickname}),"ModifiedGroup"]});case r.j7.GROUPOWNERTRANSFERRED:var Z=JSON.parse(x.notificationElem.detail),O=Z.opUser,m=Z.newGroupOwner;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("b",{children:D(O.userID)?"You":O.nickname}),"TransferTo",(0,e.jsx)("b",{children:D(m.userID)?"You":m.nickname})]});case r.j7.MEMBERQUIT:var ae=JSON.parse(x.notificationElem.detail),H=ae.quitUser;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("b",{children:D(H.userID)?"You":H.nickname}),"QuitedGroup"]});case r.j7.MEMBERINVITED:var X=JSON.parse(x.notificationElem.detail),he=X.opUser,Pe=(P=X.invitedUserList)!==null&&P!==void 0?P:[],be=[];return Pe.forEach(function(fe){return be.push((0,e.jsx)("b",{children:D(fe.userID)?"You":fe.nickname+" "},fe.userID))}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("b",{children:D(he.userID)?"You":he.nickname}),"Invited",be.map(function(fe){return fe}),"IntoGroup"]});case r.j7.MEMBERKICKED:var Ke=JSON.parse(x.notificationElem.detail),Ve=Ke.opUser,ot=(te=Ke.kickedUserList)!==null&&te!==void 0?te:[],Qe=[];return ot.forEach(function(fe){return Qe.push((0,e.jsx)("b",{children:D(fe.userID)?"You":fe.nickname},fe.userID))}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("b",{children:D(Ve.userID)?"You":Ve.nickname}),"Kicked",Qe.map(function(fe){return fe}),"OutGroup"]});case r.j7.MEMBERENTER:var Ue=JSON.parse(x.notificationElem.detail),Fe=Ue.entrantUser;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("b",{children:D(Fe.userID)?"You":Fe.nickname}),"JoinedGroup"]});default:return JSON.parse(x.content).defaultTips}},[C,D]),de=(0,s.useCallback)(function(){I(C==null?void 0:C.userID,C==null?void 0:C.groupID,i[i.length-1])},[C==null?void 0:C.groupID,C==null?void 0:C.userID,I,i]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y,{holdHeight:40,ref:M.scrollbar,loading:N,data:i,fetchMoreData:de,hasMore:f,children:i==null?void 0:i.map(function(x,P){return ne.includes(x.contentType)?(0,e.jsx)("div",{className:t()("chat_bg_tips",{"mb-6":P==0}),children:k(x)},x.clientMsgID):(0,e.jsx)(Ze,{audio:a,mutilSelect:ee,msg:x,selfID:d!=null?d:W,curCve:C},x.clientMsgID)})}),(0,e.jsx)("audio",{ref:a})]})}var tt=gt;function nt(){return(0,e.jsx)("div",{className:"d-flex align-items-center justify-content-center h-100",children:(0,e.jsx)("img",{src:"/assets/media/illustrations/dozzy-1/12.png",className:"mw-100 h-200px h-sm-325px"})})}var at=nt,Oe=n(86582),We=n(3930),rt=n(93224),st=n(69610),it=n(54941),l=n(81306),c=n(6298),j=n(64063),J=n.n(j),Se=["tagName","html","innerRef"];function xe(M){return M&&M.replace(/&nbsp;|\u202F|\u00A0/g," ")}function we(M){var u=document.createTextNode("");M.appendChild(u);var a=document.activeElement===M;if(u!==null&&u.nodeValue!==null&&a){var d=window.getSelection();if(d!==null){var i=document.createRange();i.setStart(u,u.nodeValue.length),i.collapse(!0),d.removeAllRanges(),d.addRange(i)}M instanceof HTMLElement&&M.focus()}}var Je=function(M){(0,l.Z)(a,M);var u=(0,c.Z)(a);function a(){var d;(0,st.Z)(this,a);for(var i=arguments.length,I=new Array(i),f=0;f<i;f++)I[f]=arguments[f];return d=u.call.apply(u,[this].concat(I)),d.lastHtml=d.props.html,d.el=typeof d.props.innerRef=="function"?{current:null}:s.createRef(),d.getEl=function(){return(d.props.innerRef&&typeof d.props.innerRef!="function"?d.props.innerRef:d.el).current},d.emitChange=function(C){var N=d.getEl();if(!!N){var B=N.innerHTML;if(d.props.onChange&&B!==d.lastHtml){var G=Object.assign({},C,{target:{value:B}});d.props.onChange(G)}d.lastHtml=B}},d}return(0,it.Z)(a,[{key:"render",value:function(){var i=this,I=this.props,f=I.tagName,C=I.html,N=I.innerRef,B=(0,rt.Z)(I,Se);return s.createElement(f||"div",(0,$.Z)((0,$.Z)({},B),{},{ref:typeof N=="function"?function(G){N(G),i.el.current=G}:N||this.el,onInput:this.emitChange,onBlur:this.props.onBlur||this.emitChange,onKeyUp:this.props.onKeyUp||this.emitChange,onKeyDown:this.props.onKeyDown||this.emitChange,contentEditable:!this.props.disabled,dangerouslySetInnerHTML:{__html:C}}),this.props.children)}},{key:"shouldComponentUpdate",value:function(i){var I=this.props,f=this.getEl();return!f||xe(i.html)!==xe(f.innerHTML)?!0:I.disabled!==i.disabled||I.tagName!==i.tagName||I.className!==i.className||I.innerRef!==i.innerRef||I.placeholder!==i.placeholder||!J()(I.style,i.style)}},{key:"componentDidUpdate",value:function(){var i=this.getEl();!i||(this.props.html!==i.innerHTML&&(i.innerHTML=this.props.html),this.lastHtml=this.props.html,we(i))}}]),a}(s.Component),He=function(u,a){var d=new FileReader;d.onload=function(i){var I,f=(I=i.target)===null||I===void 0?void 0:I.result;a(f)},d.readAsDataURL(u)},oe=function(u){var a=u,d=/\<img.*?\">/g,i=a.match(d);return i&&i.length>0&&i.map(function(I){a=a.replaceAll(I,"")}),a},Re=function(u){var a=u,d=(0,Oe.Z)(Array.from(document.getElementsByClassName("face_el")));return d.length>0&&d.map(function(i){a=a.replaceAll(i.outerHTML,i.alt)}),a},Ct=function(u){var a=u;return a.slice(-4)==="<br>"&&(a=a.slice(0,-4)),a=a.replaceAll("<br>",`
`),a},Te=function(){var u=(0,Oe.Z)(Array.from(document.getElementsByClassName("screenshot_el")));u.length>0&&(u[u.length-1].alt="last",u.map(function(){var a=(0,q.Z)((0,z.Z)().mark(function d(i){var I;return(0,z.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:I=(0,Ae._x)(i.src),console.log(I);case 2:case"end":return C.stop()}},d)}));return function(d){return a.apply(this,arguments)}}()))};function Mt(M){var u=M.curCve,a=M.sendMsg,d=(0,s.useRef)(null),i=(0,s.useRef)(null),I=(0,s.useState)(""),f=(0,h.Z)(I,2),C=f[0],N=f[1],B=(0,We.Z)(C),G=(0,s.useState)(),ee=(0,h.Z)(G,2),F=ee[0],W=ee[1],ne=(0,s.useState)([]),ie=(0,h.Z)(ne,2),D=ie[0],k=ie[1],de=(0,lt.tT)("open-im.contacts",function(S){var E=S.state;return E.groupMemberList}),x=(0,s.useState)(!1),P=(0,h.Z)(x,2),te=P[0],Ee=P[1],ve=(0,We.Z)(te),De=(0,s.useState)([]),Be=(0,h.Z)(De,2),Q=Be[0],Y=Be[1],Le=function(E,b){ue.im.typingStatusUpdate({recvID:E,msgTip:b})},Z=(0,s.useCallback)(function(){(0,pe.vJ)(u)&&(d.current&&clearTimeout(d.current),d.current=setTimeout(function(){Le(u.userID,"yes")},2e3))},[u]),O=function(){var S=(0,q.Z)((0,z.Z)().mark(function E(b){var T,K,re;return(0,z.Z)().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:T=(b.originalEvent||b).clipboardData,T&&T.items[0].type.indexOf("image")===-1?(b.preventDefault(),K=T.getData("text/plain")||"",document.execCommand("insertText",!1,K)):T&&T.items[0].type.indexOf("image")>-1&&(b.preventDefault(),re=T.items[0].getAsFile(),He(re,function(_e){var ht='<img style="vertical-align:bottom" class="screenshot_el" src="'.concat(_e,'" alt="" >');document.execCommand("insertHTML",!1,ht)}));case 2:case"end":return ge.stop()}},E)}));return function(b){return S.apply(this,arguments)}}(),m=(0,s.useRef)({curCve:u,msgContent:C,latestContent:B,atList:D,groupMemberList:de,replyMsg:F,draftSaved:!1});m.current.msgContent=C,m.current.curCve=u,m.current.latestContent=B,m.current.atList=D,m.current.groupMemberList=de,m.current.replyMsg=F;var ae=(0,s.useCallback)(function(S,E){var b=m.current.atList,T=m.current.latestContent,K=m.current.replyMsg;if(K&&W(void 0),b.findIndex(function(le){return le.id===S})===-1){var re='<b class="at_el" data_id="'.concat(S,'" data_name="').concat(E,'" contenteditable="false" style="color:#428be5"> @').concat(E,"</b>");k([].concat((0,Oe.Z)(b),[{id:S,name:E,tag:re}])),N(T.current+re),(0,Ae.RT)(i.current.el)}},[]),H=(0,s.useCallback)(function(S){var E=S,b=m.current.atList;return b.map(function(T){E=E.replaceAll(T.tag,"@".concat(T.id," "))}),E},[]),X=(0,s.useCallback)(function(S){var E=m.current.latestContent,b=m.current.atList;if(S.draftText!=E.current&&(S.draftText!==""||E.current!=="")){m.current.draftSaved=!0;var T=E.current;T=Re(T);var K={conversationID:S.conversationID,draftText:b.length>0?H(T):T};ue.im.setConversationDraft(K).then(function(re){console.warn(re)}).catch(function(re){console.warn(re)}).finally(function(){N("")})}},[H]),he=(0,s.useCallback)(function(){m.current.latestContent.current="",N(""),W(void 0),k([]),Ee(!1),X(u)},[u,X]),Pe=(0,s.useCallback)(function(){var S=(0,q.Z)((0,z.Z)().mark(function E(b){var T,K;return(0,z.Z)().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.next=2,ue.im.createTextMessage(b);case 2:T=le.sent,K=T.data,a(K,r.Nw.TEXTMESSAGE),he();case 6:case"end":return le.stop()}},E)}));return function(E){return S.apply(this,arguments)}}(),[he,a]),be=(0,s.useCallback)(function(){var S=(0,q.Z)((0,z.Z)().mark(function E(b){var T,K,re;return(0,z.Z)().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return T={text:b,atUserIDList:D.map(function(_e){return _e.id})},ge.next=3,ue.im.createTextAtMessage(T);case 3:K=ge.sent,re=K.data,a(re,r.Nw.ATTEXTMESSAGE),he();case 7:case"end":return ge.stop()}},E)}));return function(E){return S.apply(this,arguments)}}(),[D,he,a]),Ke=(0,s.useCallback)(function(){var S=(0,q.Z)((0,z.Z)().mark(function E(b){var T,K;return(0,z.Z)().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.next=2,ue.im.createQuoteMessage({text:b,message:JSON.stringify(F)});case 2:T=le.sent,K=T.data,a(K,r.Nw.QUOTEMESSAGE),he();case 6:case"end":return le.stop()}},E)}));return function(E){return S.apply(this,arguments)}}(),[he,F,a]),Ve=(0,s.useCallback)(function(S){var E=B.current;if(E=oe(Re(E)),E=Ct(E),Te(),E!=="")switch(S){case"text":Pe(E);break;case"at":be(H(E));break;case"quote":Ke(E);break;default:break}},[B,H,Ke,be,Pe]),ot=(0,s.useCallback)(function(S){S.key==="Enter"&&S.metaKey&&(S.preventDefault(),(0,Ae.Tf)(),(0,Ae.RT)(i.current.el)),S.key==="Enter"&&!S.metaKey&&(S.preventDefault(),B.current&&!ve.current&&(Ee(!0),Ve(F?"quote":D.length>0?"at":"text")))},[D.length,B,ve,F,Ve]),Qe=(0,s.useCallback)(function(S){N(S.target.value);var E=(0,Oe.Z)(Array.from(document.getElementsByClassName("at_el"))),b=[];E.map(function(T){var K,re;return b.push({id:(K=T.attributes.getNamedItem("data_id"))===null||K===void 0?void 0:K.value,name:(re=T.attributes.getNamedItem("data_name"))===null||re===void 0?void 0:re.value,tag:T.outerHTML})}),k(b),Z()},[Z]),Ue=(0,s.useCallback)(function(S){var E=S;return ft.map(function(b){var T=E.indexOf(b.context);if(T>-1){var K='<img class="face_el" alt="'.concat(b.context,'" style="padding-right:2px" width="24px" src="').concat(b.src,'">');E=E.replaceAll(b.context,K)}}),E},[]),Fe=(0,s.useCallback)(function(S){var E=S,b=/@\S+\s/g,T=E.match(b),K=[],re=m.current.groupMemberList;return T==null||T.map(function(le){var ge=re.find(function(ht){return ht.userID===le.slice(1,-1)});if(ge){var _e='<b class="at_el" data_id="'.concat(ge.userID,'" data_name="').concat(ge.nickname,'" contenteditable="false" style="color:#428be5"> @').concat(ge.nickname,"</b>");E=E.replaceAll(le,_e),K.push({id:ge.userID,name:ge.nickname,tag:_e})}}),k(K),E},[]),fe=(0,s.useCallback)(function(S){N(Ue(Fe(S)))},[Fe,Ue]);(0,s.useEffect)(function(){m.current.draftSaved=!1;var S=m.current.atList;return S.length>0&&k([]),u.draftText!==""?fe(u.draftText):N(""),Y([]),function(){m.current.draftSaved||X(u)}},[u,fe,X]);var Xe=(0,s.useCallback)(function(S,E){var b=(0,Oe.Z)(Q);if(S)b=[].concat((0,Oe.Z)(b),[E]);else{var T=b.findIndex(function(K){return K.clientMsgID===E.clientMsgID});b.splice(T,1)}Y(b)},[Q]);return(0,s.useEffect)(function(){return L.Z.on(U.Co,Xe),function(){L.Z.off(U.Co,Xe)}},[Xe]),(0,s.useEffect)(function(){return L.Z.on(U.oJ,ae),L.Z.on(U.jf,X),function(){L.Z.off(U.oJ,ae),L.Z.off(U.jf,X)}},[ae,X]),(0,e.jsxs)("div",{className:"pt-4 ps-8 h-100 d-flex flex-column",children:[(0,e.jsxs)("div",{className:"d-flex flex-row mb-2",children:[(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u8868\u60C5",children:(0,e.jsx)(o.zx,{variant:!1,icon:(0,e.jsx)(w.JO,{name:"Bootstrap/emoji-smile",className:"svg-icon-2"}),activeColor:"secondary",className:"me-1"})}),(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u53D1\u9001\u540D\u7247",children:(0,e.jsx)(o.zx,{variant:!1,icon:(0,e.jsx)(w.JO,{name:"Bootstrap/person-badge",className:"svg-icon-2"}),activeColor:"secondary",className:"me-1"})}),(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u53D1\u9001\u6587\u4EF6",children:(0,e.jsx)(o.zx,{variant:!1,icon:(0,e.jsx)(w.JO,{name:"Bootstrap/folder-plus",className:"svg-icon-2"}),activeColor:"secondary",className:"me-1"})}),(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u53D1\u9001\u56FE\u7247",children:(0,e.jsx)(o.zx,{variant:!1,icon:(0,e.jsx)(w.JO,{name:"Bootstrap/card-image",className:"svg-icon-2"}),activeColor:"secondary",className:"me-1"})}),(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u53D1\u9001\u89C6\u9891",children:(0,e.jsx)(o.zx,{variant:!1,icon:(0,e.jsx)(w.JO,{name:"Bootstrap/film",className:"svg-icon-2"}),activeColor:"secondary",className:"me-1"})})]}),(0,e.jsxs)("div",{className:"ps-3 flex-row-fluid position-relative",children:[(0,e.jsx)(Je,{style:{paddingTop:F?"32px":"4px"},placeholder:"\u53D1\u9001\u7ED9 ".concat(u.showName),className:"h-100",ref:i,html:C,onChange:Qe,onKeyDown:ot,onPaste:O}),(0,e.jsxs)("div",{className:"chat-msg-actions d-flex flex-row position-absolute",children:[(0,e.jsxs)("div",{className:"d-flex flex-row align-items-center fs-10 text-gray-500 me-6",children:[(0,e.jsx)(w.JO,{name:"Bootstrap/arrow-return-left",className:"svg-icon-7 me-2"})," \u53D1\u9001",(0,e.jsx)("span",{className:"mx-3",children:"/"}),(0,e.jsx)(w.JO,{name:"Bootstrap/command",className:"svg-icon-7 me-2"})," \u6362\u884C"]}),(0,e.jsx)(o.zx,{className:"px-5",children:"\u53D1\u9001"})]})]})]})}var It=Mt,Nt=n(18071),Dt=function(u){var a=u.userId,d=u.typing,i=(0,_.ED)({variables:{id:a},fetchPolicy:"cache-and-network"}),I=(0,h.Z)(i,2),f=I[0],C=I[1],N=C.data,B=C.refetch,G=N==null?void 0:N.user.onlineStatus.status,ee=N==null?void 0:N.user.onlineStatus.detailPlatformStatus,F=(0,s.useMemo)(function(){if(G=="online"){var ne="";return ee==null||ee.map(function(ie){ie.status==="online"&&(ne+="".concat(ie.platform,"/"))}),"".concat(ne.slice(0,-1)," \u5728\u7EBF")}return"\u79BB\u7EBF"},[G,ee]),W=(0,s.useRef)(G);return W.current=G,(0,s.useEffect)(function(){W.current!="online"&&B()},[f,B,d]),(0,e.jsxs)("div",{className:"mb-0 lh-1 d-flex flex-row align-items-center",children:[(0,e.jsx)(o.Ct,{color:G=="online"?"primary":"secondary",shape:"circle",className:"w-10px h-10px me-1"}),(0,e.jsx)("span",{className:"fs-7 fw-semibold text-muted",children:F})]})},pt=function(){return(0,e.jsx)(e.Fragment,{})},xt=105,Rt=350;function St(M){return Math.min(Rt,Math.max(xt,M))}function Tt(M){var u=M.msgList,a=M.loadMore,d=M.hasMore,i=M.curCve,I=M.loading,f=M.sendMsg,C=M.scrollbar,N=M.typing,B=M.onBack,G=(0,s.useRef)({height:200}),ee=(0,s.useReducer)(function(k){return k+1},0),F=(0,h.Z)(ee,2),W=F[1],ne=(0,s.useMemo)(function(){return i&&(0,pe.vJ)(i)},[i]),ie=(0,s.useCallback)(function(k){G.current.height+=k,W()},[]),D=(0,s.useCallback)(function(){G.current.height=St(G.current.height)},[]);return(0,e.jsx)(Nt.vs,{className:"app-chat-main background-transparent",contentClassName:"px-0",footer:!1,header:!1,children:(0,e.jsxs)(o.Zb,{className:"card chat_messenger",id:"kt_chat_messenger",children:[i&&(0,e.jsxs)(o.Zb.Header,{id:"kt_chat_messenger_header",children:[(0,e.jsxs)(o.Zb.Title,{className:"d-flex align-items-center",children:[(0,e.jsx)(o.mN.Avatar,{light:!0,size:45,alt:i==null?void 0:i.showName,src:i==null?void 0:i.faceURL}),(0,e.jsxs)("div",{className:"ms-5 d-flex justify-content-center flex-column me-3",children:[(0,e.jsx)("a",{href:"#",className:"fs-4 fw-bold text-gray-900 text-hover-primary me-1 mb-2 lh-1",children:i.showName}),(0,e.jsxs)("div",{className:"d-flex flex-row align-items-center",children:[ne?(0,e.jsx)(Dt,{userId:i.userID,typing:!!N}):(0,e.jsx)(pt,{}),N&&(0,e.jsx)("span",{className:"mb-0 lh-1 ms-4 fs-7 fw-semibold text-muted",children:"\u6B63\u5728\u8F93\u5165..."})]})]})]}),(0,e.jsxs)(o.Zb.Toolbar,{children:[(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u6587\u4EF6",children:(0,e.jsx)(o.zx,{className:"me-4",icon:(0,e.jsx)(w.JO,{name:"Bootstrap/folder",className:"svg-icon-2"}),variant:!1,activeColor:"light-primary"})}),(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u804A\u5929\u8BB0\u5F55",children:(0,e.jsx)(o.zx,{className:"me-4",icon:(0,e.jsx)(w.JO,{name:"Bootstrap/list-ul",className:"svg-icon-2"}),variant:!1,activeColor:"light-primary"})}),(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u6DFB\u52A0\u6210\u5458",children:(0,e.jsx)(o.zx,{className:"me-4",icon:(0,e.jsx)(w.JO,{name:"Bootstrap/person-plus",className:"svg-icon-2"}),variant:!1,activeColor:"light-primary"})}),(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u804A\u5929\u8BBE\u7F6E",children:(0,e.jsx)(o.zx,{className:t()({"me-4":!!B}),icon:(0,e.jsx)(w.JO,{name:"Bootstrap/gear",className:"svg-icon-2"}),variant:!1,activeColor:"light-primary"})}),B&&(0,e.jsx)(o.u,{placement:"bottom",inverse:!0,title:"\u8FD4\u56DE\u6D88\u606F\u5217\u8868",children:(0,e.jsx)(o.zx,{onClick:B,icon:(0,e.jsx)(w.JO,{name:"Bootstrap/arrow-return-left",className:"svg-icon-2"}),variant:!1,activeColor:"light-primary"})})]})]}),(0,e.jsx)(o.Zb.Body,{className:"pe-0 py-0 overflow-hidden",id:"kt_chat_messenger_body",children:i?(0,e.jsx)(tt,{loadMore:a,loading:I,msgList:u,hasMore:d,curCve:i,scrollbar:C}):(0,e.jsx)(at,{})}),i&&(0,e.jsx)(o.Zb.Footer,{className:"p-0",id:"kt_chat_messenger_footer",children:(0,e.jsx)(ce.w_,{style:{height:St(G.current.height)},direction:"y",onResize:ie,onResizeEnd:D,children:(0,e.jsx)(It,{curCve:i,sendMsg:f})})})]})})}var jt=Tt},17554:function(Me,se,n){"use strict";n.d(se,{Z:function(){return h.Z}});var h=n(7347)},26603:function(Me,se,n){"use strict";n.d(se,{Z:function(){return R}});var h=n(1861),s=n(67294),ce=n(7020),w=n(94184),V=n.n(w),t=n(81117),_=n(35792),z=n(90711),q=n(17818),p=n(85893);function A(y){var g=y.data,L=y.onClick,U=y.curCve,ue=(0,ce.tT)("@@initialState",function(Ne){var $,Ce;return($=Ne.initialState)===null||$===void 0||(Ce=$.currentUser)===null||Ce===void 0?void 0:Ce.uid}),Ae=function($){if($==="")return $;var Ce=JSON.parse($);if(g.draftText!==""){var me=g.draftText,v=/\<img.*?\">/g,je=me.match(v);return je&&je.length>0&&je.map(function(Ge){me=me.replaceAll(Ge,"Picture")}),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{className:"text-warning me-1",children:"[\u8349\u7A3F]"}),me]})}return(0,_.LF)(Ce,ue)},r=function($){return $===z.VP.Nomal},ke=r(g==null?void 0:g.recvMsgOpt)?Ae(g.latestMsg):g.unreadCount>0?"[".concat(g.unreadCount+"Piece","] ").concat(Ae(g.latestMsg)):Ae(g.latestMsg),Ie=function($){var Ce=(0,t.p6)($),me=(0,t.p6)($+864e5),v=(0,t.p6)(new Date().getTime());return Ce[3]===v[3]?Ce[4]:me[3]===v[3]?"\u6628\u5929":Ce[3]},ye=(0,s.useCallback)(function(){L(g)},[g,L]);return(0,p.jsxs)("div",{className:V()("cve-item d-flex flex-stack py-4 mb-1",{active:(U==null?void 0:U.conversationID)==g.conversationID}),onClick:ye,children:[(0,p.jsxs)("div",{className:"d-flex align-items-center",children:[(0,p.jsx)(q.mN.Avatar,{size:45,alt:g.showName,light:!0,badge:(0,p.jsx)(q.Ct,{dot:!r(g==null?void 0:g.recvMsgOpt)&&g.unreadCount>0,color:"danger",shape:"circle",className:"start-100",count:r(g==null?void 0:g.recvMsgOpt)?g.unreadCount:null})}),(0,p.jsxs)("div",{className:"ms-5",children:[(0,p.jsx)("a",{href:"#",className:"fs-5 fw-bold text-gray-900 text-hover-primary mb-2",children:g.showName}),(0,p.jsx)("div",{className:"fw-semibold text-muted cve_msg",children:ke})]})]}),(0,p.jsx)("div",{className:"d-flex flex-column align-items-end ms-2",children:(0,p.jsx)("span",{className:"text-muted fs-7 mb-1",children:Ie(g.latestMsgSendTime)})})]})}var o=A;function e(y){var g=y.curCve,L=y.cves,U=y.onItemClick;return(0,p.jsx)(h.E,{className:"d-flex flex-column custom-scrollbar px-2 cve-list",options:{scrollbars:{autoHide:"scroll"}},children:(0,p.jsx)(q.Zb,{flush:!0,className:"py-0 px-2 background-transparent",bodyClassName:"pt-5 pb-0 px-1 cve-list",children:L.map(function(ue){return(0,p.jsx)(o,{onClick:U,cveList:L,data:ue,curCve:g},ue.conversationID)})})})}var R=e},67491:function(Me,se,n){"use strict";var h=n(2824),s=n(67294),ce=n(28865),w=n(94184),V=n.n(w),t=n(17818),_=n(85893);function z(q){var p=q.onSearch,A=q.className,o=(0,s.useState)(""),e=(0,h.Z)(o,2),R=e[0],y=e[1],g=(0,s.useCallback)(function(L){y(L.target.value),p(L.target.value)},[p]);return(0,_.jsxs)("div",{className:V()("cve-searchbar ps-6 pe-6 d-flex justify-content-sm-between align-items-center",A),children:[(0,_.jsx)(t.II.Search,{solid:!0,size:"lg",boxClassName:"flex-row-fluid me-2",value:R,onChange:g,placeholder:"\u641C\u7D22..."}),(0,_.jsx)("a",{className:V()("cve-searchbar-actions"),children:(0,_.jsx)(ce.JO,{className:V()("svg-icon-2x svg-icon-dark"),name:"Duotune/arr087"})})]})}se.Z=z},25719:function(Me,se,n){"use strict";n.d(se,{ED:function(){return q}});var h=n(11849),s=n(20310),ce=n(49704),w=n(38460),V,t={},_=(0,ce.Ps)(V||(V=(0,s.Z)([`
    query getUserOnlineStatus($id: ID!) {
  user(id: $id) {
    id
    name
    onlineStatus {
      status
      detailPlatformStatus {
        platform
        status
      }
    }
  }
}
    `])));function z(p){var A=_objectSpread(_objectSpread({},t),p);return Apollo.useQuery(_,A)}function q(p){var A=(0,h.Z)((0,h.Z)({},t),p);return w.t(_,A)}},43606:function(Me,se,n){"use strict";n.d(se,{RJ:function(){return Ae}});var h=n(25719),s=n(39428),ce=n(3182),w=n(11849),V=n(86582),t=n(67294),_=n(7020),z=n(74857),q=n(28761),p=n(44115),A=n(70407),o=n(35792),e=n(77333),R=n(26490),y=n(52152),g=n(17818),L=function(){return(Math.random()*36).toString(36).slice(2)+new Date().getTime().toString()},U=function(ke,Ie){return new Promise(function(ye,Ne){A.im.getOneConversation({sourceID:ke,sessionType:Ie}).then(function($){return ye(JSON.parse($.data))}).catch(function($){return Ne($)})})};function ue(){var r=(0,_.tT)("open-im.cve",function(l){var c=l.state;return c.curCve}),ke=(0,_.tT)("open-im.cve",function(l){var c=l.state;return c.cveInitLoading}),Ie=(0,_.tT)("open-im.cve",function(l){var c=l.actions;return c.setCurCve}),ye=(0,_.tT)("open-im.cve",function(l){var c=l.state;return c.cves}),Ne=(0,_.tT)("@@initialState",function(l){var c,j=l.initialState;return j==null||(c=j.currentUser)===null||c===void 0?void 0:c.uid}),$=(0,_.tT)("open-im.contacts",function(l){var c=l.actions;return c.getGroupInfo}),Ce=(0,_.tT)("open-im.contacts",function(l){var c=l.actions;return c.getGroupMemberList}),me=[],v=(0,z.Z)({historyMsgList:[],firstLoad:!1,typing:!1,hasMore:!0,merModal:!1,merData:void 0,searchStatus:!1,searchCve:[]}),je=(0,t.useRef)(null),Ge=(0,q.Z)(A.im.getHistoryMessageList,{manual:!0,onSuccess:At,onError:function(c){return console.log("GetChatRecordFailed",c)}}),lt=Ge.loading,ct=Ge.run,ut=Ge.cancel,dt=(0,t.useRef)(),ze=(0,t.useCallback)(function(l){var c;(c=dt.current)===null||c===void 0||c.scroll({y:"100%"},l!=null?l:350)},[]);function At(l){if(JSON.parse(l.data).length===0){v.hasMore=!1;return}JSON.stringify(v.historyMsgList[v.historyMsgList.length-1])==JSON.stringify(JSON.parse(l.data).reverse()[0])&&v.historyMsgList.pop(),v.historyMsgList=[].concat((0,V.Z)(v.historyMsgList),(0,V.Z)(JSON.parse(l.data).reverse())),v.firstLoad||(v.firstLoad=!0,setTimeout(function(){return ze(0)})),v.hasMore=!(JSON.parse(l.data).length<20)}var $e=(0,t.useCallback)(function(l,c,j){var J,Se={userID:l!=null?l:"",groupID:c!=null?c:"",count:20,startClientMsgID:(J=j==null?void 0:j.clientMsgID)!==null&&J!==void 0?J:""};ct(Se)},[ct]),vt=(0,t.useCallback)(function(l,c){A.im.markC2CMessageAsRead({userID:l,msgIDList:c})},[]),pe=(0,t.useCallback)(function(l,c){l.unreadCount===0&&!c||((0,o.vJ)(l)?vt(l.userID,[]):A.im.markGroupMessageHasRead(l.groupID))},[vt]),ft=(0,t.useCallback)(function(l){l?(v.searchStatus=!0,v.searchCve=ye.filter(function(c){return c.conversationID.indexOf(l)>-1||c.showName.indexOf(l)>-1})):(v.searchCve=[],v.searchStatus=!1)},[ye,v]),mt=(0,t.useCallback)(function(l){if(!(0,o.vJ)(l)){$(l.groupID);var c={groupID:l.groupID,offset:0,filter:0,count:2e3};Ce(c)}},[$,Ce]),qe=(0,t.useCallback)(function(l){l.conversationID!==(r==null?void 0:r.conversationID)&&(r&&e.Z.emit(R.jf,r),v.historyMsgList=[],v.firstLoad=!1,Ie(l),v.hasMore=!0,mt(l),ut(),$e(l.userID,l.groupID),pe(l))},[r,$e,mt,pe,ut,v,Ie]),Ye=(0,t.useCallback)(function(l,c,j){me.map(function(J){if(J.oid===l.operationID){var Se=v.historyMsgList.findIndex(function(xe){return xe.clientMsgID===(J==null?void 0:J.mid)});Se!==-1&&(J.flag=!0,j?v.historyMsgList[Se].status=3:v.historyMsgList[Se]=JSON.parse(l.data))}}),c===y.Nw.MERGERMESSAGE&&g.FN.success("ForwardSuccessTip"),ze()},[me,v.historyMsgList,ze]),et=(0,t.useCallback)(function(l,c,j,J){var Se=L();if(j&&(r==null?void 0:r.userID)===j||J&&(r==null?void 0:r.groupID)===J||!j&&!J){var xe=JSON.parse(l),we={oid:Se,mid:xe.clientMsgID,flag:!1};me=[].concat((0,V.Z)(me),[we]),xe.status=2,v.historyMsgList=[xe].concat((0,V.Z)(v.historyMsgList)),setTimeout(function(){var oe=me.find(function(Re){return Re.mid===xe.clientMsgID});oe&&!oe.flag&&v.historyMsgList.find(function(Re){Re.clientMsgID===oe.mid&&(Re.status=1)})},2e3),ze()}var Je={title:"\u4F60\u6709\u4E00\u6761\u65B0\u6D88\u606F",desc:"",ex:"",iOSPushSound:"+1",iOSBadgeCount:!0},He={recvID:j!=null?j:r.userID,groupID:J!=null?J:r.groupID,offlinePushInfo:Je,message:l};me=me.filter(function(oe){return!oe.flag}),y.Dw.includes(c)?A.im.sendMessageNotOss(He,Se).then(function(oe){return Ye(oe,c)}).catch(function(oe){return Ye(oe,c,!0)}):A.im.sendMessage(He,Se).then(function(oe){return Ye(oe,c)}).catch(function(oe){return Ye(oe,c,!0)})},[r]),Ze=(0,t.useCallback)(function(l,c){U(l,c).then(function(j){return qe(j)}).catch(function(j){g.FN.error("\u83B7\u53D6\u4F1A\u8BDD\u5931\u8D25\uFF01"),console.error(j)})},[qe]),Et=(0,t.useCallback)(function(l){var c=l.sendID===(r==null?void 0:r.userID)||l.sendID===Ne&&l.recvID===(r==null?void 0:r.userID);return l.sessionType===y.FF.SINGLECVE?c:l.groupID===(r==null?void 0:r.groupID)},[r==null?void 0:r.groupID,r==null?void 0:r.userID,Ne]),gt=(0,t.useCallback)(function(){v.typing=!0,je.current&&clearTimeout(je.current),je.current=setTimeout(function(){v.typing=!1},1e3)},[v]),tt=(0,t.useCallback)(function(l){var c=JSON.parse(l.data);c.contentType!==y.Nw.TYPINGMESSAGE&&c.sendID!==Ne&&(0,o.sc)(c,function(j,J){Ze(j,J),window.focus()}),r&&Et(c)&&(c.contentType===y.Nw.TYPINGMESSAGE?gt():(c.contentType===y.Nw.REVOKEMESSAGE?v.historyMsgList=[c].concat((0,V.Z)(v.historyMsgList.filter(function(j){return j.clientMsgID!==c.content}))):v.historyMsgList=[c].concat((0,V.Z)(v.historyMsgList)),pe(r,1)))},[Ze,r,Et,pe,v,Ne,gt]),nt=(0,t.useCallback)(function(l){var c=v.historyMsgList.findIndex(function(j){return j.clientMsgID===l.data});c>-1&&v.historyMsgList.splice(c,1)},[v]),at=(0,t.useCallback)(function(l){JSON.parse(l.data).map(function(c){c.msgIDList.map(function(j){v.historyMsgList.find(function(J){J.clientMsgID===j&&(J.isRead=!0)})})})},[v]),Oe=(0,t.useCallback)(function(){Ie(null)},[Ie]),We=(0,t.useCallback)(function(l){var c=v.historyMsgList.findIndex(function(J){return J.clientMsgID===l}),j=(0,V.Z)(v.historyMsgList);j.splice(c,1),v.historyMsgList=j,g.FN.success("\u5220\u9664\u6D88\u606F\u6210\u529F\uFF01")},[v]),rt=(0,t.useCallback)(function(l){var c=v.historyMsgList.findIndex(function(j){return j.clientMsgID===l});v.historyMsgList[c].contentType=y.j7.REVOKEMESSAGE},[v]),st=(0,t.useCallback)(function(l,c){v.merData=(0,w.Z)((0,w.Z)({},l),{},{sender:c}),v.merModal=!0},[v]),it=(0,t.useCallback)(function(l,c,j){j.map(function(){var J=(0,ce.Z)((0,s.Z)().mark(function Se(xe){var we,Je,He,oe,Re;return(0,s.Z)().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(He=(we=xe.userID)!==null&&we!==void 0?we:"",oe=(Je=xe.groupID)!==null&&Je!==void 0?Je:"",c!==y.Nw.MERGERMESSAGE){Te.next=8;break}return Te.next=5,A.im.createMergerMessage(l);case 5:Re=Te.sent,Te.next=11;break;case 8:return Te.next=10,A.im.createForwardMessage(l);case 10:Re=Te.sent;case 11:et(Re.data,c,He,oe),e.Z.emit(R.rl,!1);case 13:case"end":return Te.stop()}},Se)}));return function(Se){return J.apply(this,arguments)}}())},[et]);return(0,t.useEffect)(function(){return A.im.on(p.l2.ONRECVMESSAGEREVOKED,nt),A.im.on(p.l2.ONRECVC2CREADRECEIPT,at),function(){A.im.off(p.l2.ONRECVMESSAGEREVOKED,nt),A.im.off(p.l2.ONRECVC2CREADRECEIPT,at)}},[at,nt]),(0,t.useEffect)(function(){return e.Z.on(R.$F,Oe),e.Z.on(R.Cd,We),e.Z.on(R.rF,rt),e.Z.on(R.a7,st),function(){e.Z.off(R.$F,Oe),e.Z.off(R.Cd,We),e.Z.off(R.rF,rt),e.Z.off(R.a7,st)}},[We,st,Oe,rt]),(0,t.useEffect)(function(){return e.Z.on(R.jA,it),e.Z.on(R.$M,Ze),A.im.on(p.l2.ONRECVNEWMESSAGE,tt),function(){e.Z.off(R.jA,it),e.Z.off(R.$M,Ze),A.im.off(p.l2.ONRECVNEWMESSAGE,tt)}},[Ze,r,tt,it]),(0,t.useEffect)(function(){return function(){Ie(null)}},[Ie]),{rs:v,cveList:ye,loading:lt,cveLoading:ke,curCve:r,setCurCve:Ie,handleCveSearch:ft,handleItemClick:qe,scrollbar:dt,getHistoryMsg:$e,sendMsg:et}}var Ae=ue},26490:function(Me,se,n){"use strict";n.d(se,{$M:function(){return s},$F:function(){return ce},Cd:function(){return t},jf:function(){return _},rF:function(){return z},cu:function(){return q},Oo:function(){return p},jA:function(){return A},rl:function(){return o},Co:function(){return e},a7:function(){return R},oJ:function(){return y}});var h="UPDATEFRIENDCARD",s="TOASSIGNCVE",ce="RESETCVE",w="OPENSINGLEMODAL",V="OPENGROUPMODAL",t="DELETEMESSAGE",_="ISSETDRAFT",z="REVOKEMSG",q="REPLAYMSG",p="FORWARDANDMERMSG",A="SENDFORWARDMSG",o="MUTILMSG",e="MUTILMSGCHANGE",R="MERMSGMODAL",y="ATSTATEUPDATE",g="ANTDLOCALCHANGE",L="APPLICATIONTYPEUPDATE",U="CLEARSEARCHINPUT"},52152:function(Me,se,n){"use strict";n.d(se,{Nw:function(){return h},j7:function(){return s},Dw:function(){return w},FF:function(){return V}});var h;(function(t){t[t.TEXTMESSAGE=101]="TEXTMESSAGE",t[t.PICTUREMESSAGE=102]="PICTUREMESSAGE",t[t.VOICEMESSAGE=103]="VOICEMESSAGE",t[t.VIDEOMESSAGE=104]="VIDEOMESSAGE",t[t.FILEMESSAGE=105]="FILEMESSAGE",t[t.ATTEXTMESSAGE=106]="ATTEXTMESSAGE",t[t.MERGERMESSAGE=107]="MERGERMESSAGE",t[t.CARDMESSAGE=108]="CARDMESSAGE",t[t.LOCATIONMESSAGE=109]="LOCATIONMESSAGE",t[t.CUSTOMMESSAGE=110]="CUSTOMMESSAGE",t[t.REVOKEMESSAGE=111]="REVOKEMESSAGE",t[t.HASREADRECEIPTMESSAGE=112]="HASREADRECEIPTMESSAGE",t[t.TYPINGMESSAGE=113]="TYPINGMESSAGE",t[t.QUOTEMESSAGE=114]="QUOTEMESSAGE"})(h||(h={}));var s;(function(t){t[t.REVOKEMESSAGE=111]="REVOKEMESSAGE",t[t.ADVANCEREVOKEMESSAGE=118]="ADVANCEREVOKEMESSAGE",t[t.FRIENDAPPLICATIONAPPROVED=1201]="FRIENDAPPLICATIONAPPROVED",t[t.FRIENDAPPLICATIONREJECTED=1202]="FRIENDAPPLICATIONREJECTED",t[t.FRIENDAPPLICATIONADDED=1203]="FRIENDAPPLICATIONADDED",t[t.FRIENDADDED=1204]="FRIENDADDED",t[t.FRIENDDELETED=1205]="FRIENDDELETED",t[t.FRIENDREMARKSET=1206]="FRIENDREMARKSET",t[t.BLACKADDED=1207]="BLACKADDED",t[t.BLACKDELETED=1208]="BLACKDELETED",t[t.SELFINFOUPDATED=1303]="SELFINFOUPDATED",t[t.GROUPCREATED=1501]="GROUPCREATED",t[t.GROUPINFOUPDATED=1502]="GROUPINFOUPDATED",t[t.JOINGROUPAPPLICATIONADDED=1503]="JOINGROUPAPPLICATIONADDED",t[t.MEMBERQUIT=1504]="MEMBERQUIT",t[t.GROUPAPPLICATIONACCEPTED=1505]="GROUPAPPLICATIONACCEPTED",t[t.GROUPAPPLICATIONREJECTED=1506]="GROUPAPPLICATIONREJECTED",t[t.GROUPOWNERTRANSFERRED=1507]="GROUPOWNERTRANSFERRED",t[t.MEMBERKICKED=1508]="MEMBERKICKED",t[t.MEMBERINVITED=1509]="MEMBERINVITED",t[t.MEMBERENTER=1510]="MEMBERENTER"})(s||(s={}));var ce=[h.TEXTMESSAGE,h.ATTEXTMESSAGE,h.CARDMESSAGE,h.MERGERMESSAGE,h.LOCATIONMESSAGE,h.CUSTOMMESSAGE,h.REVOKEMESSAGE,h.HASREADRECEIPTMESSAGE,h.TYPINGMESSAGE,h.QUOTEMESSAGE],w=[h.PICTUREMESSAGE,h.VIDEOMESSAGE,h.VOICEMESSAGE,h.FILEMESSAGE],V;(function(t){t[t.SINGLECVE=1]="SINGLECVE",t[t.GROUPCVE=2]="GROUPCVE"})(V||(V={}))},77333:function(Me,se,n){"use strict";var h=n(17187),s=n.n(h),ce=new h.EventEmitter;ce.setMaxListeners(12),se.Z=ce},81117:function(Me,se,n){"use strict";n.d(se,{RT:function(){return ce},p6:function(){return w},$2:function(){return V},RD:function(){return t},Sv:function(){return _},Tf:function(){return z},_x:function(){return q}});var h=n(9669),s=n.n(h),ce=function(A){var o=window.getSelection(),e=document.createRange();e.selectNodeContents(A.current),e.collapse(!1),o==null||o.removeAllRanges(),o==null||o.addRange(e)},w=function(A){var o=new Date(A),e=o.getFullYear(),R=o.getMonth()+1,y=o.getDate(),g=o.getHours(),L=o.getMinutes();L.toString().length===1&&(L="0"+L);var U=o.getSeconds();U.toString().length===1&&(U="0"+U);var ue=e+"-"+R+"-"+y,Ae=g+":"+L;return[e,R,y,ue,Ae]},V=function(A,o){s().get(A,{headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"blob"}).then(function(e){var R=new Blob([e.data]),y=o,g=document.createElement("a");g.download=y,g.style.display="none",g.href=URL.createObjectURL(R),document.body.appendChild(g),g.click(),URL.revokeObjectURL(g.href),document.body.removeChild(g)}).catch(function(e){console.log(e)})},t=function(A){if(A===0)return"0 B";var o=1024,e=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],R=Math.floor(Math.log(A)/Math.log(o));return(A/Math.pow(o,R)).toPrecision(3)+" "+e[R]},_=function(A){var o=["jpeg","tiff","png","gif","jpg","gif"],e=["ppt","pptx"],R=["xlsx","xls"],y=["doc","docx"],g=["rar","zip"];return o.includes(A)?"file_pic":e.includes(A)?"file_ppt":R.includes(A)?"file_xslx":y.includes(A)?"file_world":g.includes(A)?"file_zip":A==="pdf"?"file_pdf":"file_unknow"},z=function(){var A=window.getSelection(),o=A.getRangeAt(0),e=document.createElement("br"),R=document.createTextNode("\xA0");o.deleteContents(),o.insertNode(e),o.collapse(!1),o.insertNode(R),o.selectNodeContents(R),A.removeAllRanges(),A.addRange(o),document.execCommand("delete")},q=function(A){for(var o=A.split(","),e=o[0].match(/:(.*?);/)[1],R=atob(o[1]),y=R.length,g=new Uint8Array(y);y--;)g[y]=R.charCodeAt(y);return new File([g],"screenshot".concat(Date.now(),".png"),{type:e})}},1787:function(Me){Me.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAUCAYAAABWMrcvAAAAAXNSR0IArs4c6QAAAk5JREFUOE+N081LFHEYB/Dvd9wMk0p3dsid1fIkduhUl0jIoDckDx2MOnSKPCU6o5KBkCG9ic4u1CUr6FQHQyqK3CCMBAPpXwjsZWdNZ3YxJXHNeWLH3HZTqzk+z3z4/p7fPEP8+dSPBvS9ezoo/JCw1KE1fQDML5Y3p7ZvKfWegKgXoM+2Qhf/iiqNzyWCklEh9wnQkbTU2HogW8sl6ebMXQrPeSLNyZh2byOQQ3pb6gDojYFy37a08/mgwkgfpAJJDpS/Xa37SRHTfSGQukBxoPrTjbL0ajNiuqaI9BMykohqDTlU0TKnKZsWbQB3bCt0YbWht7pHUIQRQF4vzCtN6cHgbA6FDeekQgx75PHkgBrPS5kApHJhibWpW+q3/CMzbDqXFODaYkYizm0tmwi9NbWTRTIp9HrtAe1ythZuc3aT0gSv6AF1w7lOokvmM6X2oP7dR4Z7lJQ4oDQmrOBzf27DGQexH8JhRgynG0TvD2Xzjq/9W6cLkTQmLM1HuuH2gdJOsJO6kTpNeo+WPTk0FdPe+EdpT+9SZHlSwCu2pfbk5mmSYgwxQ910qyDyEfTXpit3e+bMe4LhxYDUOn3aXMFF+NGmOwZ4NYqEqr9EubCS5h6jJy9BxjMB71Q+9D+ubsw0knwG4GrCCnXn0oxUJ+HdFMi4HdXqCjZiBTpZ1CDgiWRUHfkNncOesGwqpj5egyqN2aAwM5H1IjxjR0NP/7nlv2arAvAKQA2EZ+1o8OF6sOAnzL4QbHG3lQS8niVRhqZj6rv/QhsdKb/+E7En8byRi/iIAAAAAElFTkSuQmCC"},94335:function(Me){Me.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAATCAYAAABLN4eXAAAAAXNSR0IArs4c6QAAAiBJREFUOE+Fk0toU1EQhv+5oVINKrgIJAQtuCgkEHLPCQaFiiLYik+KXehKUHErIhWUYgUXFR8rV4orF4LFlaX4AhUqLpIzN5vEIgFfKZKNaEBKQ3JGTkkgMaQ9y5/5ZuafmUPo87TWEwB2GmPuAGh0hlE/SCl1i4gmAbwDcMIY86cd2xdyAUqpi0TkKuWr1er+SqWy7PQ1IRegtT4H4AGAR8aY8z2Q7/t7XaIgCN53tq21figiZ621I4VC4UNXJaXUPIAxEbkcBMG9NphMJrcNDg5+AbBgjDncBWmttwKYFZEDnueN5fP5121QKXWfiC5Ya2M9nrLZ7JZGo7EoIhVm3tUBjRLRCxEZJ631dgBnRGSWmT+1zN8AMAVgyBjz3Wm+78c8z1sCcJWUUs+IaFxEPjLzntaojxDRcwCjxphXTovFYpui0ehfADOu0iURuQ3gLjO7Zbr99ECpVCoyMDBQtdZOrXpKJBIbSqVSvaP/aSK6bq0dCoLgm9PT6fS+UCj01lp7qmcQw8PDm8Ph8CKAn8ycaSfSWs+IyGS9Xt/RBbWAp84LgEPM/NJB8Xh8YyQS+UpEn40xI//vaUFE3DCuMLPzufqUUjeJ6JqIHGXmuS4ok8mcbDabv4MgeNMBjBHRnIjMM/OxdQ82nU4fD4VCT0RkaWVlJVssFn+tCWmtT4vIY+fD87yDuVzux7r/yff93UQ0UavVpsvlcq3z6v8BSUzmcN/zXjIAAAAASUVORK5CYII="}}]);
