"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7284],{7284:function(Zt,ht,A){A.r(ht),A.d(ht,{default:function(){return Vt}});var jt=A(73588),kt=A(52677),Nt=A.n(kt),At=A(5574),ft=A.n(At),dt=A(67294),Gt=A(93719),pt={name:"drag"},it={name:"space"},W={name:"handle"},F={name:"center"};const{abs:mt,max:k,min:N}=Math;function vt(t){return[+t[0],+t[1]]}function at(t){return[vt(t[0]),vt(t[1])]}var $={name:"x",handles:["w","e"].map(H),input:function(t,p){return t==null?null:[[+t[0],p[0][1]],[+t[1],p[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},q={name:"y",handles:["n","s"].map(H),input:function(t,p){return t==null?null:[[p[0][0],+t[0]],[p[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Dt={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(H),input:function(t){return t==null?null:at(t)},output:function(t){return t}},X={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},yt={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},gt={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},zt={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Mt={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function H(t){return{type:t}}function St(t){return!t.ctrlKey&&!t.button}function Tt(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Xt(){return navigator.maxTouchPoints||"ontouchstart"in this}function ot(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Yt(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Wt(t){var p=t.__brush;return p?p.dim.output(p.selection):null}function Ft(){return lt($)}function Ht(){return lt(q)}function It(){return lt(Dt)}function lt(t){var p=Tt,K=St,I=Xt,Y=!0,S=dispatch("start","brush","end"),z=6,Z;function u(e){var r=e.property("__brush",et).selectAll(".overlay").data([H("overlay")]);r.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",X.overlay).merge(r).each(function(){var n=ot(this).extent;select(this).attr("x",n[0][0]).attr("y",n[0][1]).attr("width",n[1][0]-n[0][0]).attr("height",n[1][1]-n[0][1])}),e.selectAll(".selection").data([H("selection")]).enter().append("rect").attr("class","selection").attr("cursor",X.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=e.selectAll(".handle").data(t.handles,function(n){return n.type});i.exit().remove(),i.enter().append("rect").attr("class",function(n){return"handle handle--"+n.type}).attr("cursor",function(n){return X[n.type]}),e.each(P).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",_).filter(I).on("touchstart.brush",_).on("touchmove.brush",ut).on("touchend.brush touchcancel.brush",tt).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}u.move=function(e,r,i){e.tween?e.on("start.brush",function(n){C(this,arguments).beforestart().start(n)}).on("interrupt.brush end.brush",function(n){C(this,arguments).end(n)}).tween("brush",function(){var n=this,a=n.__brush,o=C(n,arguments),m=a.selection,M=t.input(typeof r=="function"?r.apply(this,arguments):r,a.extent),l=interpolate(m,M);function v(c){a.selection=c===1&&M===null?null:l(c),P.call(n),o.brush()}return m!==null&&M!==null?v:v(1)}):e.each(function(){var n=this,a=arguments,o=n.__brush,m=t.input(typeof r=="function"?r.apply(n,a):r,o.extent),M=C(n,a).beforestart();interrupt(n),o.selection=m===null?null:m,P.call(n),M.start(i).brush(i).end(i)})},u.clear=function(e,r){u.move(e,null,r)};function P(){var e=select(this),r=ot(this).selection;r?(e.selectAll(".selection").style("display",null).attr("x",r[0][0]).attr("y",r[0][1]).attr("width",r[1][0]-r[0][0]).attr("height",r[1][1]-r[0][1]),e.selectAll(".handle").style("display",null).attr("x",function(i){return i.type[i.type.length-1]==="e"?r[1][0]-z/2:r[0][0]-z/2}).attr("y",function(i){return i.type[0]==="s"?r[1][1]-z/2:r[0][1]-z/2}).attr("width",function(i){return i.type==="n"||i.type==="s"?r[1][0]-r[0][0]+z:z}).attr("height",function(i){return i.type==="e"||i.type==="w"?r[1][1]-r[0][1]+z:z})):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function C(e,r,i){var n=e.__brush.emitter;return n&&(!i||!n.clean)?n:new O(e,r,i)}function O(e,r,i){this.that=e,this.args=r,this.state=e.__brush,this.active=0,this.clean=i}O.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(e,r){return this.starting?(this.starting=!1,this.emit("start",e,r)):this.emit("brush",e),this},brush:function(e,r){return this.emit("brush",e,r),this},end:function(e,r){return--this.active===0&&(delete this.state.emitter,this.emit("end",e,r)),this},emit:function(e,r,i){var n=select(this.that).datum();S.call(e,this.that,new BrushEvent(e,{sourceEvent:r,target:u,selection:t.output(this.state.selection),mode:i,dispatch:S}),n)}};function _(e){if(Z&&!e.touches||!K.apply(this,arguments))return;var r=this,i=e.target.__data__.type,n=(Y&&e.metaKey?i="overlay":i)==="selection"?pt:Y&&e.altKey?F:W,a=t===q?null:zt[i],o=t===$?null:Mt[i],m=ot(r),M=m.extent,l=m.selection,v=M[0][0],c,y,R=M[0][1],g,b,V=M[1][0],w,x,B=M[1][1],E,j,h=0,f=0,ct,nt=a&&o&&Y&&e.shiftKey,rt,st,D=Array.from(e.touches||[e],s=>{const d=s.identifier;return s=pointer(s,r),s.point0=s.slice(),s.identifier=d,s});interrupt(r);var J=C(r,arguments,!0).beforestart();if(i==="overlay"){l&&(ct=!0);const s=[D[0],D[1]||D[0]];m.selection=l=[[c=t===q?v:N(s[0][0],s[1][0]),g=t===$?R:N(s[0][1],s[1][1])],[w=t===q?V:k(s[0][0],s[1][0]),E=t===$?B:k(s[0][1],s[1][1])]],D.length>1&&G(e)}else c=l[0][0],g=l[0][1],w=l[1][0],E=l[1][1];y=c,b=g,x=w,j=E;var bt=select(r).attr("pointer-events","none"),Q=bt.selectAll(".overlay").attr("cursor",X[i]);if(e.touches)J.moved=xt,J.ended=Et;else{var wt=select(e.view).on("mousemove.brush",xt,!0).on("mouseup.brush",Et,!0);Y&&wt.on("keydown.brush",Bt,!0).on("keyup.brush",Lt,!0),dragDisable(e.view)}P.call(r),J.start(e,n.name);function xt(s){for(const d of s.changedTouches||[s])for(const U of D)U.identifier===d.identifier&&(U.cur=pointer(d,r));if(nt&&!rt&&!st&&D.length===1){const d=D[0];mt(d.cur[0]-d[0])>mt(d.cur[1]-d[1])?st=!0:rt=!0}for(const d of D)d.cur&&(d[0]=d.cur[0],d[1]=d.cur[1]);ct=!0,noevent(s),G(s)}function G(s){const d=D[0],U=d.point0;var L;switch(h=d[0]-U[0],f=d[1]-U[1],n){case it:case pt:{a&&(h=k(v-c,N(V-w,h)),y=c+h,x=w+h),o&&(f=k(R-g,N(B-E,f)),b=g+f,j=E+f);break}case W:{D[1]?(a&&(y=k(v,N(V,D[0][0])),x=k(v,N(V,D[1][0])),a=1),o&&(b=k(R,N(B,D[0][1])),j=k(R,N(B,D[1][1])),o=1)):(a<0?(h=k(v-c,N(V-c,h)),y=c+h,x=w):a>0&&(h=k(v-w,N(V-w,h)),y=c,x=w+h),o<0?(f=k(R-g,N(B-g,f)),b=g+f,j=E):o>0&&(f=k(R-E,N(B-E,f)),b=g,j=E+f));break}case F:{a&&(y=k(v,N(V,c-h*a)),x=k(v,N(V,w+h*a))),o&&(b=k(R,N(B,g-f*o)),j=k(R,N(B,E+f*o)));break}}x<y&&(a*=-1,L=c,c=w,w=L,L=y,y=x,x=L,i in yt&&Q.attr("cursor",X[i=yt[i]])),j<b&&(o*=-1,L=g,g=E,E=L,L=b,b=j,j=L,i in gt&&Q.attr("cursor",X[i=gt[i]])),m.selection&&(l=m.selection),rt&&(y=l[0][0],x=l[1][0]),st&&(b=l[0][1],j=l[1][1]),(l[0][0]!==y||l[0][1]!==b||l[1][0]!==x||l[1][1]!==j)&&(m.selection=[[y,b],[x,j]],P.call(r),J.brush(s,n.name))}function Et(s){if(nopropagation(s),s.touches){if(s.touches.length)return;Z&&clearTimeout(Z),Z=setTimeout(function(){Z=null},500)}else dragEnable(s.view,ct),wt.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);bt.attr("pointer-events","all"),Q.attr("cursor",X.overlay),m.selection&&(l=m.selection),Yt(l)&&(m.selection=null,P.call(r)),J.end(s,n.name)}function Bt(s){switch(s.keyCode){case 16:{nt=a&&o;break}case 18:{n===W&&(a&&(w=x-h*a,c=y+h*a),o&&(E=j-f*o,g=b+f*o),n=F,G(s));break}case 32:{(n===W||n===F)&&(a<0?w=x-h:a>0&&(c=y-h),o<0?E=j-f:o>0&&(g=b-f),n=it,Q.attr("cursor",X.selection),G(s));break}default:return}noevent(s)}function Lt(s){switch(s.keyCode){case 16:{nt&&(rt=st=nt=!1,G(s));break}case 18:{n===F&&(a<0?w=x:a>0&&(c=y),o<0?E=j:o>0&&(g=b),n=W,G(s));break}case 32:{n===it&&(s.altKey?(a&&(w=x-h*a,c=y+h*a),o&&(E=j-f*o,g=b+f*o),n=F):(a<0?w=x:a>0&&(c=y),o<0?E=j:o>0&&(g=b),n=W),Q.attr("cursor",X[i]),G(s));break}default:return}noevent(s)}}function ut(e){C(this,arguments).moved(e)}function tt(e){C(this,arguments).ended(e)}function et(){var e=this.__brush||{selection:null};return e.extent=at(p.apply(this,arguments)),e.dim=t,e}return u.extent=function(e){return arguments.length?(p=typeof e=="function"?e:constant(at(e)),u):p},u.filter=function(e){return arguments.length?(K=typeof e=="function"?e:constant(!!e),u):K},u.touchable=function(e){return arguments.length?(I=typeof e=="function"?e:constant(!!e),u):I},u.handleSize=function(e){return arguments.length?(z=+e,u):z},u.keyModifiers=function(e){return arguments.length?(Y=!!e,u):Y},u.on=function(){var e=S.on.apply(S,arguments);return e===S?u:e},u}var Ct=A(9524),Jt=A(76665),Kt=A(78099),Pt=A(88828),T=A(85893);function Ot(t){var p=t.width,K=t.height,I=(0,dt.useState)(null),Y=ft()(I,2),S=Y[0],z=Y[1];if((0,dt.useEffect)(function(){Nt()(t.data)==="object"&&z(t.data),fetch(t.data).then(function(n){return n.json()}).then(function(n){z(n)})},[]),!S)return null;var Z=S.properties.centroid,u=Ct.Z(S),P=u[0],C=u[1],O=(0,Kt.ZP)().center(S.properties.center).scale(1),_=(0,Pt.Z)().projection(O),ut=S.features,tt=O(P),et=O(C),e=Math.abs(et[0]-tt[0]),r=Math.abs(et[1]-tt[1]),i=Math.min(p/e,K/r)*.9;return O.scale(i).translate([p/2,K/2]).center(Z),(0,T.jsx)("div",{className:"w-full h-full",children:(0,T.jsxs)("svg",{width:p,height:K,children:[(0,T.jsx)("g",{className:"features",children:ut.map(function(n,a){console.log(n.properties.code,n);var o=n.properties.center?O(n.properties.center):[0,0],m=ft()(o,2),M=m[0],l=m[1];console.log("center",n.properties.center,M,l);var v=_(n)||"";return v.includes("NaN")&&(console.error("\u8DEF\u5F84\u6570\u636E\u5305\u542B NaN",v,n),v=v.replace(/NaN/g,"250"),console.log("\u66FF\u6362\u540E\u7684\u8DEF\u5F84\u6570\u636E",v)),(0,T.jsxs)("g",{className:"feature multipolygon",children:[n.properties.center&&(0,T.jsx)("circle",{cx:M,cy:l,r:"3",fill:"#444"}),(0,T.jsx)("path",{d:v,fill:"#2caffe",stroke:"#333",strokeWidth:"0.5",opacity:"0.5"},a)]},n.properties.code||n.properties.name)})}),(0,T.jsx)("g",{className:"plot"}),(0,T.jsx)("rect",{className:"plot-bg",x:"0",y:"0",width:p,height:K,fill:"none"})]})})}function Rt(){return(0,T.jsx)(jt.vs,{header:!1,footer:!1,children:(0,T.jsx)(Ot,{data:"/geo/china/china.json",width:1260,height:500})})}var Vt=Rt}}]);
