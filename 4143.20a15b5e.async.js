"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4143,267],{51253:function(me,z,a){a.d(z,{GP:function(){return c.Z},Hk:function(){return ue},xx:function(){return w.x}});var H=a(74958),c=a(5166),w=a(19260),F=a(68400),l=a.n(F),f=a(67294),W=a(93967),G=a.n(W),q=a(94589),i=a(97857),$=a.n(i),_=a(46027),ee=a(35908),B=a(42687),ae=a(2721),R=a(5574),ne=a.n(R),se=a(96486),O=a(85893),K={aside:{minimize:!1,width:280}},k=f.createContext({state:K,dispatch:function(){}}),M=function(t){return t.AsideToggle="ASIDE_TOGGLE",t.AsideWidth="ASIDE_WIDTH",t}({});function e(t,s){switch(s.type){case"ASIDE_TOGGLE":return t.aside.minimize=!t.aside.minimize,$()({},t);case"ASIDE_WIDTH":return t.aside.width=s.payload,$()({},t);default:throw new Error}}var te=function(s){var d=(0,f.useReducer)(e,(0,se.cloneDeep)(K)),m=ne()(d,2),o=m[0],v=m[1];return(0,O.jsx)(k.Provider,{value:{state:o,dispatch:v},children:s.children})},X=function(){return(0,f.useContext)(k)},le=a(65495);function Q(t){var s=X(),d=s.dispatch,m=s.state.aside.minimize,o=(0,f.useCallback)(function(){d({type:M.AsideToggle})},[d]);return(0,O.jsx)(ae.Button,{style:$()({marginBottom:"1.35rem",zIndex:105},t.style),onClick:o,activeColor:"primary",className:G()("micro-app-aside-toggle","btn-icon bg-body btn-color-gray-700 rounded-2 position-absolute translate-middle bottom-0 shadow-sm d-none d-lg-flex",t.className,{active:m}),children:(0,O.jsx)(_.JO,{name:"Duotune/arr063",className:"svg-icon-2 rotate-180"})})}var ie={"drawer drawer-start":{maxWidth:992}};function Z(t){var s=t.className,d=t.header,m=t.children,o=t.collapsible,v=o===void 0?!0:o,x=t.width,b=x===void 0?280:x,C=(0,B.$Y)(),h=X(),A=h.dispatch;(0,f.useEffect)(function(){C.aside.width(b+100),A({type:M.AsideWidth,payload:b})},[C.aside,A,b]);var g=(0,ee.CN)(ie),E=(0,B.BK)(function(j){return j.aside.drawer});return(0,O.jsxs)("div",{className:G()("app-aside aside",s,g,{"drawer-on":E}),children:[(0,O.jsx)(le.Z,{children:(0,O.jsx)(c.Z,{header:d,resizeable:!0,className:"app-sidebar",children:m})}),v&&(0,O.jsx)(Q,{className:"start-100 end-0"})]})}Z.Toggle=Q;var re=Z,V,oe=q.ZP.div(V||(V=l()([`
  --root-aside-width: `,`;
  --met-aside-width: `,`;
`])),function(t){return t.minimize?"100px":"".concat(t.width,"px")},function(t){return t.minimize?"100px":"".concat(t.width,"px")});function ce(t){var s=t.children,d=t.className,m=X(),o=m.state.aside,v=o.minimize,x=o.width,b=(0,f.useCallback)(function(C){C.preventDefault()},[]);return(0,O.jsx)(oe,{minimize:v,width:x,className:G()("micro-app-container page-full-content",d,{"aside-minimize":v}),onContextMenu:b,children:s})}function Y(t){var s=t.children,d=t.className;return(0,O.jsx)(te,{children:(0,O.jsx)(ce,{className:d,children:s})})}Y.Sidebar=re;var ue=Y},5028:function(me,z,a){a.r(z),a.d(z,{default:function(){return t}});var H=a(97857),c=a.n(H),w=a(5574),F=a.n(w),l=a(67294),f=a(46027),W=a(12845),G=a(1861),q=a(51253),i=a(2721),$=a(64599),_=a.n($),ee=a(15009),B=a.n(ee),ae=a(99289),R=a.n(ae),ne=a(75275),se=a(93967),O=a.n(se),K=a(96486),k=a(74600),M=a(92623),e=a(85893),te=a(34155);function X(s){var d=s.onClose,m=s.visible,o=s.user,v=s.namespace,x=s.name,b=s.mode,C=(0,k.hI)(),h=F()(C,1),A=h[0],g=i.Form.useForm(),E=(0,l.useRef)(null);(0,l.useEffect)(function(){var L;m&&(g.setFieldsValue({name:x}),(L=E.current)===null||L===void 0||L.focus(),te.nextTick(function(){var D;(D=E.current)===null||D===void 0||D.select()}))},[m]);var j=(0,l.useCallback)(R()(B()().mark(function L(){var D;return B()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g.validateFields();case 2:if(D=r.sent,b!=="create"){r.next=6;break}return r.next=6,A({variables:{name:D.name,namespace:v}});case 6:d();case 7:case"end":return r.stop()}},L)})),[g,b,d,A,v]),S=(0,l.useCallback)(function(){d()},[d]);return(0,e.jsxs)(i.Modal,{centered:!0,visible:m,dialogClassName:"modal-dialog-small w-400px",onCancel:S,onOk:j,header:!1,closable:!1,okButtonProps:{className:"btn-xs"},cancelButtonProps:{className:"btn-xs"},children:[(0,e.jsxs)("div",{className:"modal-dialog-header d-flex",children:[(0,e.jsx)("div",{className:"modal-dialog-icon",children:(0,e.jsx)(f.JO,{className:"svg-icon-5x",name:"Duotune/fil012"})}),(0,e.jsxs)("div",{className:"modal-dialog-instructions",children:[(0,e.jsx)("div",{className:"modal-dialog-title",children:b==="create"?"\u65B0\u5EFA\u6587\u4EF6\u5939":"\u4FEE\u6539\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"modal-dialog-description",children:b==="create"?(0,e.jsxs)(e.Fragment,{children:['\u4E3A\u8D26\u53F7 " ',o,' " \u521B\u5EFA\u9876\u5C42\u6587\u4EF6\u5939']}):(0,e.jsxs)(e.Fragment,{children:['\u4FEE\u6539\u8D26\u53F7 " ',o,' " \u4E2D ',x," \u6587\u4EF6\u5939\u7684\u540D\u79F0"]})})]})]}),(0,e.jsx)(i.Form,{form:g,layout:"horizontal",initialValues:{name:x},size:"xs",children:(0,e.jsx)("div",{className:"d-flex last flex-row flex-center",children:(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(i.Form.Item,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u5B57"}],name:"name",label:"\u540D\u79F0",children:(0,e.jsx)(i.Input,{ref:E})})})})})]})}var le=X;function Q(s){var d=s.user,m=s.onSuccess,o=s.selectedKey,v=(0,l.useState)(),x=F()(v,2),b=x[0],C=x[1],h=(0,l.useCallback)(function(){C(void 0)},[]),A=(0,l.useCallback)(R()(B()().mark(function E(){return B()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:C("#custom"),m();case 2:case"end":return S.stop()}},E)})),[m]),g=(0,l.useCallback)(R()(B()().mark(function E(){return B()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:console.log(o),m();case 2:case"end":return S.stop()}},E)})),[o,m]);return(0,e.jsxs)("div",{className:"settings-mailbox-footer",children:[(0,e.jsx)("a",{onClick:A,children:(0,e.jsx)(f.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:g,children:(0,e.jsx)(f.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})}),(0,e.jsx)(le,{mode:"create",visible:!!b,user:d,namespace:b,onClose:h})]})}var ie=Q,Z=[{key:"#private",title:"\u9ED8\u8BA4\u6587\u4EF6\u5939",children:[]},{key:"#smart",title:"\u667A\u80FD\u6587\u4EF6\u5939",children:[]},{key:"#custom",title:"\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939",children:[]}];function re(s){var d=s.user,m=(0,l.useRef)(null),o=(0,k.Tt)(),v=o.data,x=(0,l.useState)(),b=F()(x,1),C=b[0],h=(0,l.useState)(s.mailboxes),A=F()(h,2),g=A[0],E=A[1],j=(0,k.mf)({updateQueries:{mailUser:function(N,n){var p=n.mutationResult;return c()(c()({},N),{},{mailUser:c()(c()({},N.mailUser),{},{settings:c()(c()({},N.mailUser.settings),{},{mailboxes:p.data.mailboxes})})})}}}),S=F()(j,1),L=S[0],D=(0,l.useCallback)(function(){var u=R()(B()().mark(function N(n){return B()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:console.log(n);case 1:case"end":return U.stop()}},N)}));return function(N){return u.apply(this,arguments)}}(),[]),J=(0,l.useCallback)(function(u){console.log(u)},[]),r=(0,l.useCallback)(function(u){u.preventDefault(),u.stopPropagation(),console.log("handleChange",u.target.checked,u.target.value),L({variables:{mailboxes:[u.target.value],mode:u.target.checked?"ADD":"REMOVE"}})},[L]),P=(0,l.useMemo)(function(){if(!(v!=null&&v.mailboxes))return(0,K.cloneDeep)(Z);var u=(0,K.cloneDeep)(Z),N=_()(v.mailboxes),n;try{var p=function(){var y=n.value,T=u.find(function(de){return de.key===y.namespace});if(y.name==="Outbox"||y.name==="INBOX")return 0;if(!(T!=null&&T.children))return console.warn("\u9519\u8BEF\u7684\u547D\u540D\u7A7A\u95F4",T),0;T.children.push(c()(c()({},y),{},{type:"mailbox",key:y.id,title:y.name}))},U;for(N.s();!(n=N.n()).done;)U=p()}catch(I){N.e(I)}finally{N.f()}return u[0].children=u[0].children.map(function(I){var y=M.GG.findIndex(function(de){return de.id===I.name}),T=M.GG[y];return console.log("details",T,y,I.name,I.id,I,u),c()(c()({},I),{},{zindex:y,title:T.name,icon:T.name})}).sort(function(I,y){return I.zindex-y.zindex}),u.filter(function(I){var y;return(y=I.children)===null||y===void 0?void 0:y.length})},[v==null?void 0:v.mailboxes]);return(0,l.useEffect)(function(){E(s.mailboxes)},[s.mailboxes]),(0,e.jsxs)("div",{className:"settings-mailbox-container",children:[(0,e.jsx)("div",{className:"settings-mailbox-notes",children:"\u8BBE\u7F6E\u9ED8\u8BA4\u6587\u4EF6\u5939\u7684\u663E\u793A\u4E0E\u9690\u85CF\uFF0C\u5E76\u53EF\u4EE5\u6DFB\u52A0\u81EA\u5B9A\u4E49\u7684\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"d-flex",children:(0,e.jsxs)(ne.fQ,{tag:(0,e.jsx)("div",{ref:m,className:O()("flex-left settings-mailbox",{editing:!1})}),name:"MAIL_PREFERENCES",handler:J,children:[(0,e.jsxs)("div",{className:"settings-mailbox-header d-flex",children:[(0,e.jsx)("div",{className:"field-folder",children:"\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"field-favorites",children:"\u6536\u85CF"})]}),(0,e.jsx)(G.E,{className:"settings-mailbox-body custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(i.TreeList,{className:"mailbox-treelist",rowKey:"id",expandedKeys:["#private","#smart","#custom"],draggable:!1,iconRender:function(N,n){if(!n.isDirectory)return""},columns:[{key:"title",title:"\u540D\u79F0",width:"auto",render:function(N){return(0,e.jsx)("div",{className:"title d-flex",children:(0,e.jsx)("span",{className:"text-gray-800",children:N})})}},{key:"actions",title:"\u64CD\u4F5C",className:"min-w-100px",render:function(N,n){return n.type==="directory"?(0,e.jsx)("div",{}):(0,e.jsx)(i.Checkbox,{value:n.namespace+"."+n.name,checked:g.includes(n.namespace+"."+n.name),onChange:r,className:"mailbox-check",size:"sm"})}}],dataSource:P})}),(0,e.jsx)(ie,{user:d,onSuccess:D,selectedKey:C})]})})]})}var V=re;function oe(s){var d=s.visible,m=s.onCancel,o=s.mailUser,v=(0,l.useState)(!1),x=F()(v,2),b=x[0],C=x[1],h=(0,l.useState)("mailbox"),A=F()(h,2),g=A[0],E=A[1],j=(0,l.useCallback)(function(){C(!0)},[]),S=(0,l.useCallback)(function(D){E(D)},[]),L=(0,l.useMemo)(function(){return o!=null&&o.settings?o.settings:{mailboxes:[]}},[o]);return(0,e.jsx)(i.Modal,{centered:!0,maskClosable:!1,visible:d,onCancel:m,onOk:j,confirmLoading:b,scroll:!1,dialogClassName:"mw-750px mail-preferences",header:(0,e.jsx)(i.Modal.Header,{children:(0,e.jsxs)(i.Nav,{onSelect:S,selectedKey:g,children:[(0,e.jsx)(i.Nav.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(i.Nav.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(f.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u901A\u7528"})})]})},"general"),(0,e.jsx)(i.Nav.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(i.Nav.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(f.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u8D26\u53F7"})})]})},"account"),(0,e.jsx)(i.Nav.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(i.Nav.Link,{className:"btn d-flex flex-column btn-active-light-success",children:[(0,e.jsx)(f.ZP,{name:"Duotune/fil012",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u6587\u4EF6\u5939"})})]})},"mailbox"),(0,e.jsx)(i.Nav.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(i.Nav.Link,{className:"btn d-flex flex-column btn-active-light-dark",children:[(0,e.jsx)(f.ZP,{name:"Duotune/art008",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u7B7E\u540D"})})]})},"signature"),(0,e.jsx)(i.Nav.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(i.Nav.Link,{className:"btn d-flex flex-column btn-active-light-warning",children:[(0,e.jsx)(f.ZP,{name:"Duotune/art008",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u6A21\u7248"})})]})},"template")]})}),footer:!1,children:(0,e.jsx)(V,{user:o==null?void 0:o.name,mailboxes:L.mailboxes})})}var ce=oe;function Y(s){var d=s.onAction;return(0,e.jsx)("div",{className:"email-sidebar-footer",children:(0,e.jsx)("span",{className:"mail-settings",onClick:d,children:"\u504F\u597D\u8BBE\u7F6E"})})}function ue(){var s,d=(0,l.useState)(!1),m=F()(d,2),o=m[0],v=m[1],x=(0,W.useMatch)({path:"/mail/:folder",end:!1}),b=(0,l.useMemo)(function(){return x!=null&&x.params.folder?[x.params.folder]:[]},[x]),C=(0,k.FW)({fetchPolicy:"cache-and-network"}),h=C.data,A=(0,k.Tt)({fetchPolicy:"cache-and-network"}),g=A.data,E=(0,k.c3)({fetchPolicy:"cache-and-network"}),j=E.data,S=(0,l.useCallback)(function(){v(!1)},[]),L=(0,l.useCallback)(function(){v(!0)},[]),D=(0,l.useMemo)(function(){if(!(h!=null&&h.mailUser)||!(g!=null&&g.mailboxes)){var r=M.LJ.INBOX,P=M.LJ.Outbox;return{inbox:c()(c()({},r),{},{title:r.name,key:r.id.toLowerCase()}),outbox:c()(c()({},P),{},{title:P.name,key:P.id.toLowerCase()}),private:M.GG.filter(function(n){return!["Outbox","INBOX"].includes(n.id)}).map(function(n){return c()(c()({},n),{},{title:n.name,key:n.id.toLowerCase(),count:0})}),smart:[],custom:[]}}var u=g.mailboxes.map(function(n){if(n.namespace==="#private"){var p=M.GG.findIndex(function(U){return U.id===n.name});return c()(c()({},n),{},{index:p,title:M.GG[p].name,icon:M.GG[p].icon,key:n.name.toLowerCase()})}return c()(c()({},n),{},{title:n.name,index:0,icon:void 0,key:n.name.toLowerCase()})}).filter(function(n){var p;return["Outbox","INBOX"].includes(n.name)?!0:h==null||(p=h.mailUser)===null||p===void 0||(p=p.settings)===null||p===void 0?void 0:p.mailboxes.includes(n.namespace+"."+n.name)}).sort(function(n,p){return n.index-p.index}),N=u.filter(function(n){return n.namespace==="#private"});return{inbox:N.find(function(n){return n.name==="INBOX"}),outbox:N.find(function(n){return n.name==="Outbox"}),private:N.filter(function(n){return!["Outbox","INBOX"].includes(n.name)}),smart:u.filter(function(n){return n.namespace==="#smart"}),custom:u.filter(function(n){return n.namespace==="#custom"})}},[h==null?void 0:h.mailUser,g==null?void 0:g.mailboxes]),J=(0,l.useMemo)(function(){var r;return(j==null||(r=j.inbox)===null||r===void 0?void 0:r.unread)||0},[j==null||(s=j.inbox)===null||s===void 0?void 0:s.unread]);return(0,e.jsxs)(q.GP,{width:280,collapsible:!1,className:"email-sidebar-aside",children:[(0,e.jsxs)("div",{className:"email-sidebar",children:[(0,e.jsx)(i.Button,{as:W.Link,to:"/mail/compose",className:"email-compose text-uppercase",children:"\u5199\u4FE1"}),(0,e.jsx)(G.E,{className:"email-sidebar-body custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsxs)(i.Menu,{className:"menu-title-gray-600 menu-icon-gray-400 menu-state-bg menu-state-primary menu-state-icon-primary menu-state-bullet-primary mb-10",accordion:!1,rounded:!0,selectable:"AllMenu",selectedKeys:b,children:[(0,e.jsx)(i.Menu.Item,{url:"/mail/inbox",titleClassName:"fw-bolder",icon:(0,e.jsx)(f.JO,{className:"svg-icon-2 me-3",name:"Duotune/com010"}),badge:!!J&&(0,e.jsx)(i.Badge,{size:"sm",lightStyle:M.LJ.INBOX.badge,children:J}),children:D.inbox.title},"inbox"),(0,e.jsx)(i.Menu.Section,{children:"\u6587\u4EF6\u5939"}),D.private.map(function(r){var P,u=(P=M.LJ[r.name])===null||P===void 0?void 0:P.badge;return(0,e.jsx)(i.Menu.Item,{className:"mb-1",url:"/mail/".concat(r.key),titleClassName:"fw-bolder",icon:(0,e.jsx)(f.JO,{className:"svg-icon-2 me-3",name:r.icon}),badge:!!u&&!!r.count&&(0,e.jsx)(i.Badge,{size:"sm",lightStyle:u,children:r.count}),children:r.title},r.key)}),D.custom.length&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(i.Menu.Section,{children:"\u81EA\u5B9A\u4E49"}),D.custom.map(function(r){return(0,e.jsx)(i.Menu.Item,{className:"mb-1",url:"/mail/".concat(r.key),titleClassName:"fw-bolder",children:r.title},r.key)})]})]})}),(0,e.jsx)(Y,{onAction:L})]}),(0,e.jsx)(ce,{mailUser:h==null?void 0:h.mailUser,visible:o,onCancel:S})]})}var t=ue},92623:function(me,z,a){a.d(z,{GG:function(){return w},LJ:function(){return c},ss:function(){return F}});var H=a(5618),c={INBOX:{id:"INBOX",name:"\u6536\u4EF6\u7BB1",icon:"Duotune/com010",badge:"success"},Sent:{id:"Sent",name:"\u5DF2\u53D1\u9001",icon:"Duotune/gen016"},Drafts:{id:"Drafts",name:"\u8349\u7A3F",icon:"Duotune/gen009",badge:"primary"},Archive:{id:"Archive",name:"\u5F52\u6863",icon:"Duotune/lay010"},Spam:{id:"Spam",name:"\u5783\u573E\u90AE\u4EF6",icon:"Duotune/gen044"},Trash:{id:"Trash",name:"\u56DE\u6536\u7AD9",icon:"Duotune/gen027",badge:"warning"},Outbox:{id:"Outbox",name:"\u53D1\u4EF6\u7BB1",icon:"Duotune/gen027"},Later:{id:"Later",name:"\u5F85\u529E",icon:"Duotune/gen027"},Blocked:{id:"Blocked",name:"\u5DF2\u5C4F\u853D",icon:"Duotune/gen027"}},w=Object.keys(c).map(function(l){return c[l]});function F(l){var f=(0,H.N8)(l);return f.name||f.address&&f.address.substring(0,f.address.indexOf("@"))}}}]);
