"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5054,1836],{51253:function(F,z,n){n.d(z,{GP:function(){return y.Z},Hk:function(){return A},xx:function(){return p.x}});var w=n(74958),y=n(5166),p=n(19260),g=n(68400),h=n.n(g),D=n(62435),O=n(93967),L=n.n(O),k=n(94589),b=n(97857),W=n.n(b),r=n(46027),N=n(42687),$=n(13757),K=n(5574),R=n.n(K),m=n(96486),u=n(86074),i={aside:{minimize:!1,width:280}},l=D.createContext({state:i,dispatch:function(){}}),M=function(o){return o.AsideToggle="ASIDE_TOGGLE",o.AsideWidth="ASIDE_WIDTH",o}({});function x(o,j){switch(j.type){case"ASIDE_TOGGLE":return o.aside.minimize=!o.aside.minimize,W()({},o);case"ASIDE_WIDTH":return o.aside.width=j.payload,W()({},o);default:throw new Error}}var S=function(j){var I=(0,D.useReducer)(x,(0,m.cloneDeep)(i)),T=R()(I,2),c=T[0],P=T[1];return(0,u.jsx)(l.Provider,{value:{state:c,dispatch:P},children:j.children})},E=function(){return(0,D.useContext)(l)},C=n(65495);function d(o){var j=E(),I=j.dispatch,T=j.state.aside.minimize,c=(0,D.useCallback)(function(){I({type:M.AsideToggle})},[I]);return(0,u.jsx)($.Button,{style:W()({marginBottom:"1.35rem",zIndex:105},o.style),onClick:c,activeColor:"primary",className:L()("micro-app-aside-toggle","btn-icon bg-body btn-color-gray-700 rounded-2 position-absolute translate-middle bottom-0 shadow-sm d-none d-lg-flex",o.className,{active:T}),children:(0,u.jsx)(r.JO,{name:"Duotune/arr063",className:"svg-icon-2 rotate-180"})})}function e(o){var j=o.className,I=o.header,T=o.children,c=o.collapsible,P=c===void 0?!0:c,B=o.width,U=B===void 0?280:B,Q=(0,N.$Y)(),G=E(),H=G.dispatch;return(0,D.useEffect)(function(){Q.aside.width(U+100),H({type:M.AsideWidth,payload:U})},[Q.aside,H,U]),(0,u.jsxs)("div",{className:L()("app-aside aside",j),children:[(0,u.jsx)(C.Z,{children:(0,u.jsx)(y.Z,{header:I,resizeable:!0,className:"app-sidebar",children:T})}),P&&(0,u.jsx)(d,{className:"start-100 end-0"})]})}e.Toggle=d;var t=e,a,v=k.ZP.div(a||(a=h()([`
  --root-aside-width: `,`;
  --met-aside-width: `,`;
`])),function(o){return o.minimize?"100px":"".concat(o.width,"px")},function(o){return o.minimize?"100px":"".concat(o.width,"px")});function f(o){var j=o.children,I=o.className,T=E(),c=T.state.aside,P=c.minimize,B=c.width,U=(0,D.useCallback)(function(Q){Q.preventDefault()},[]);return(0,u.jsx)(v,{minimize:P,width:B,className:L()("micro-app-container page-full-content",I,{"aside-minimize":P}),onContextMenu:U,children:j})}function s(o){var j=o.children,I=o.className;return(0,u.jsx)(S,{children:(0,u.jsx)(f,{className:I,children:j})})}s.Sidebar=t;var A=s},42687:function(F,z,n){n.d(z,{$Y:function(){return r},BK:function(){return $},aM:function(){return R}});var w=n(5574),y=n.n(w),p=n(97857),g=n.n(p),h=n(62435),D=n(86074),O=h.createContext({getState:function(){return{routes:[]}},subscribe:function(){},dispatch:function(){}}),L=function(u,i){return i?i.type==="ASIDE_MINIMIZE"?g()(g()({},u),{},{aside:g()(g()({},u.aside),{},{minimize:!!i.payload})}):i.type==="ASIDE_WIDTH"?g()(g()({},u),{},{aside:g()(g()({},u.aside),{},{width:i.payload})}):i.type==="ASIDE_COLLAPSIBLE"?g()(g()({},u),{},{aside:g()(g()({},u.aside),{},{collapsible:i.payload})}):u:u},k=function(u){return g()({},u)};function b(m){var u=(0,h.useReducer)(L,m,k),i=y()(u,2),l=i[0],M=i[1],x=(0,h.useState)([]),S=y()(x,1),E=S[0],C=function(A){return function(){var o=E.indexOf(A);o>-1&&E.splice(o,1)}},d=(0,h.useCallback)(function(s){return E.unshift(s),C(s)},[E]),e=(0,h.useCallback)(function(){E.forEach(function(s){return s()})},[E]),t={getState:function(){return l},dispatch:M,subscribe:d},a=(0,h.useState)(t),v=y()(a,1),f=v[0];return(0,h.useEffect)(function(){f.getState=function(){return l},e()},[l]),f}var W=function(u,i){return u===i};function r(){var m=(0,h.useContext)(O),u=(0,h.useRef)({aside:{get state(){return m.getState().aside},width:function(l){m.dispatch({type:"ASIDE_WIDTH",payload:l})},minimize:function(l){m.dispatch({type:"ASIDE_MINIMIZE",payload:l})},collapsible:function(l){m.dispatch({type:"ASIDE_COLLAPSIBLE",payload:l})}}});return u.current}function N(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W,i=(0,h.useContext)(O),l=(0,h.useReducer)(function(d){return d+1},0),M=y()(l,2),x=M[1],S=(0,h.useRef)(),E=m(i.getState());function C(){var d=m(i.getState());u(d,S.current)||(S.current=d,x())}return(0,h.useEffect)(function(){return i.subscribe(C)},[]),E}function $(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;return N(m,u)}function K(){var m=useContext(O);return m.dispatch}function R(m){var u=m.children,i=m.state,l=b(i);return(0,h.useMemo)(function(){return(0,D.jsx)(O.Provider,{value:l,children:u})},[u,l])}},96414:function(F,z,n){n.d(z,{dI:function(){return C},rB:function(){return E}});var w=n(5574),y=n.n(w),p=n(62435),g={USERS_LIST:"users-list"};function h(d){return d!=null&&d!==""}function D(d,e){var t=useState(d),a=_slicedToArray(t,2),v=a[0],f=a[1];return useEffect(function(){var s=setTimeout(function(){f(d)},e);return function(){clearTimeout(s)}},[d,e]),v}var O=n(72004),L=n.n(O),k=n(12444),b=n.n(k),W=n(9783),r=n.n(W),N=n(8606),$=L()(function d(){var e=this;b()(this,d),r()(this,"menu",null),r()(this,"element",null),r()(this,"getParamName",function(t){var a=document.body.hasAttribute("data-kt-name"),v=a?a+"_":"";return"kt_"+v+"theme_mode_"+t}),r()(this,"getMode",function(){var t,a=e.getParamName("value"),v=e.getMenuMode(),f="light";if(!localStorage)return f;var s=localStorage.getItem(a);if(s)return s;var A=(t=e.element)===null||t===void 0?void 0:t.getAttribute("data-theme");return A||(v?v==="system"?e.getSystemMode():v:f)}),r()(this,"setMode",function(t,a){var v,f,s,A=t,o=a;if(!(A!=="light"&&A!=="dark")){var j=e.getParamName("value"),I=e.getParamName("menu");o==="system"&&e.getSystemMode()!==A&&(A=e.getSystemMode()),o||(o=A);var T=((v=e.menu)===null||v===void 0?void 0:v.querySelector('[data-kt-element="mode"][data-kt-value="'+o+'"]'))||null;(f=e.element)===null||f===void 0||f.setAttribute("data-kt-theme-mode-switching","true"),(s=e.element)===null||s===void 0||s.setAttribute("data-theme",A);var c=e;setTimeout(function(){var P;(P=c.element)===null||P===void 0||P.removeAttribute("data-kt-theme-mode-switching")},300),localStorage&&localStorage.setItem(j,A),T&&localStorage&&(localStorage.setItem(I,o),e.setActiveMenuItem(T)),e.flipImages()}}),r()(this,"getMenuMode",function(){var t,a=e.getParamName("menu"),v=(t=e.menu)===null||t===void 0?void 0:t.querySelector('.active[data-kt-element="mode"]'),f=v==null?void 0:v.getAttribute("data-kt-value");if(f)return f;if(!a)return"";var s=localStorage?localStorage.getItem(a):null;return s||""}),r()(this,"getSystemMode",function(){return window.matchMedia("(prefers-color-scheme: dark)")?"dark":"light"}),r()(this,"initMode",function(){e.setMode(e.getMode(),e.getMenuMode()),e.element&&N.EventHandlerUtil.trigger(e.element,"kt.thememode.init")}),r()(this,"setActiveMenuItem",function(t){var a,v=e.getParamName("menu"),f=t.getAttribute("data-kt-value"),s=(a=e.menu)===null||a===void 0?void 0:a.querySelector('.active[data-kt-element="mode"]');s&&s.classList.remove("active"),t.classList.add("active"),localStorage&&f&&v&&localStorage.setItem(v,f)}),r()(this,"handleMenu",function(){var t;(t=e.menu)===null||t===void 0||(t=t.querySelectorAll('[data-kt-element="mode"]'))===null||t===void 0||t.forEach(function(a){a.addEventListener("click",function(v){v.preventDefault();var f=a.getAttribute("data-kt-value"),s=f==="system"?e.getSystemMode():f;s&&e.setMode(s,f)})})}),r()(this,"flipImages",function(){var t;(t=document.querySelectorAll("[data-kt-img-dark]"))===null||t===void 0||t.forEach(function(a){a.tagName==="IMG"?e.getMode()==="dark"&&a.hasAttribute("data-kt-img-dark")?(a.setAttribute("data-kt-img-light",a.getAttribute("src")||""),a.setAttribute("src",a.getAttribute("data-kt-img-dark")||"")):e.getMode()==="light"&&a.hasAttribute("data-kt-img-light")&&(a.setAttribute("data-kt-img-dark",a.getAttribute("src")||""),a.setAttribute("src",a.getAttribute("data-kt-img-light")||"")):e.getMode()==="dark"&&a.hasAttribute("data-kt-img-dark")?(a.setAttribute("data-kt-img-light",a.getAttribute("src")||""),a.style.backgroundImage="url('"+a.getAttribute("data-kt-img-dark")+"')"):e.getMode()==="light"&&a.hasAttribute("data-kt-img-light")&&(a.setAttribute("data-kt-img-dark",a.getAttribute("src")||""),a.style.backgroundImage="url('"+a.getAttribute("data-kt-img-light")+"')")})}),r()(this,"on",function(t,a){if(e.element)return N.EventHandlerUtil.on(e.element,t,a)}),r()(this,"off",function(t,a){if(e.element)return N.EventHandlerUtil.off(e.element,t,a)}),r()(this,"init",function(){e.menu=document.querySelector('[data-kt-element="theme-mode-menu"]'),e.element=document.documentElement,e.initMode(),e.menu&&e.handleMenu()})}),K=new $,R=n(86074),m=K.getSystemMode(),u=function(e){var t=e!=="system"?e:m,a="/media/patterns/header-bg"+(t==="light"?".jpg":"-dark.png");document.body.style.backgroundImage='url("'.concat(toAbsoluteUrl(a),'")')},i="kt_theme_mode_value",l="kt_theme_mode_menu",M=function(e){if(!localStorage)return"light";var t=localStorage.getItem(e);return!t||t==="light"?"light":t==="dark"?"dark":"system"},x={mode:M(i),menuMode:M(l),updateMode:function(e){},updateMenuMode:function(e){}},S=(0,p.createContext)({mode:x.mode,menuMode:x.menuMode,updateMode:function(e){},updateMenuMode:function(e){}}),E=function(){return(0,p.useContext)(S)},C=function(e){var t=e.children,a=(0,p.useState)(x.mode),v=y()(a,2),f=v[0],s=v[1],A=(0,p.useState)(x.menuMode),o=y()(A,2),j=o[0],I=o[1],T=function(B){var U=B==="system"?m:B;s(U),localStorage&&localStorage.setItem(i,U),document.documentElement.setAttribute("data-theme",U),K.init()},c=function(B){I(B),localStorage&&localStorage.setItem(l,B)};return(0,p.useEffect)(function(){T(f),c(j)},[]),(0,R.jsx)(S.Provider,{value:{mode:f,menuMode:j,updateMode:T,updateMenuMode:c},children:t})}},52680:function(F,z,n){n.d(z,{v7:function(){return C},_$:function(){return u},F6:function(){return $}});var w=n(97857),y=n.n(w),p=n(68400),g=n.n(p),h=n(75063),D=n(37887),O=n(73359),L,k,b,W,r={},N=(0,h.Ps)(L||(L=g()([`
    query websites {
  websites {
    id
    name
    description
  }
}
    `])));function $(e){var t=y()(y()({},r),e);return D.a(N,t)}function K(e){var t=_objectSpread(_objectSpread({},r),e);return Apollo.useLazyQuery(N,t)}function R(e){var t=_objectSpread(_objectSpread({},r),e);return Apollo.useSuspenseQuery(N,t)}var m=(0,h.Ps)(k||(k=g()([`
    query website($id: ID!) {
  website(id: $id) {
    id
    name
    description
    channel {
      id
    }
    application {
      id
    }
  }
}
    `])));function u(e){var t=y()(y()({},r),e);return D.a(m,t)}function i(e){var t=_objectSpread(_objectSpread({},r),e);return Apollo.useLazyQuery(m,t)}function l(e){var t=_objectSpread(_objectSpread({},r),e);return Apollo.useSuspenseQuery(m,t)}var M=(0,h.Ps)(b||(b=g()([`
    mutation createWebsite($input: WebsiteCreateInput!) {
  createWebsite(input: $input) {
    id
    name
  }
}
    `])));function x(e){var t=_objectSpread(_objectSpread({},r),e);return Apollo.useMutation(M,t)}var S=(0,h.Ps)(W||(W=g()([`
    query websiteArticleCategories($id: ID!) {
  categories: articleCategories(where: {parent: {id: $id, subColumns: true}}) {
    id
    icon
    name
    fullName
    path
    index
    level
    image
    storeTemplate {
      id
    }
    parent {
      id
    }
  }
}
    `])));function E(e){var t=_objectSpread(_objectSpread({},r),e);return Apollo.useQuery(S,t)}function C(e){var t=y()(y()({},r),e);return O.t(S,t)}function d(e){var t=_objectSpread(_objectSpread({},r),e);return Apollo.useSuspenseQuery(S,t)}},22294:function(F,z,n){n.r(z),n.d(z,{default:function(){return u}});var w=n(5574),y=n.n(w),p=n(62435),g=n(96974),h=n(51253),D=n(97857),O=n.n(D),L=n(39711),k=n(46027),b=n(13757),W=n(12708),r=n(86074);function N(i,l){return i.children&&i.children.length?(0,r.jsx)(b.Menu.SubMenu,{url:"/websites/".concat(l,"/cms/categories/").concat(i.id,"/articles"),bullet:!0,icon:i.icon,title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"flex-row-fluid",children:i.name}),(0,r.jsx)(b.Tooltip,{title:"\u680F\u76EE\u8BBE\u7F6E",children:(0,r.jsx)("div",{children:(0,r.jsx)(L.rU,{onClick:function(x){return x.stopPropagation()},className:"category-setting me-2 text-primary",to:"/websites/".concat(l,"/cms/categories/").concat(i.id),children:(0,r.jsx)(k.JO,{name:"Bootstrap/gear",className:"svg-icon-primary"})})})})]}),children:(i.children||[]).map(function(M){return N(M,l)})},"category_".concat(i.id)):(0,r.jsx)(b.Menu.Item,{url:"/websites/".concat(l,"/cms/categories/").concat(i.id,"/articles"),bullet:!0,icon:i.icon,title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"flex-row-fluid",children:i.name}),(0,r.jsx)(b.Tooltip,{title:"\u680F\u76EE\u8BBE\u7F6E",children:(0,r.jsx)(L.rU,{onClick:function(x){return x.stopPropagation()},className:"category-setting me-4 text-primary",to:"/websites/".concat(l,"/cms/categories/").concat(i.id),children:(0,r.jsx)(k.JO,{name:"Bootstrap/gear",className:"svg-icon-primary"})})})]})},"category_".concat(i.id))}function $(i){var l=i.id,M=i.location,x=i.loading,S=i.website,E=(0,g.s0)(),C=(0,p.useMemo)(function(){return(0,W.G_)(i.categories.map(function(c){return O()({},c)}),{idKey:"id",childrenKey:"children",pidKey:"parent.id",sort:function(P,B){return P.index-B.index}})},[i.categories]),d=(0,p.useMemo)(function(){var c=(0,g.LX)("/websites/:sid/cms/categories/:cid",M.pathname);if(c)return"category_".concat(c.params.cid);var P=(0,g.LX)("/websites/:sid/files",M.pathname);return P?"files":"my-drive"},[M.pathname]),e=(0,p.useState)(d),t=y()(e,2),a=t[0],v=t[1],f=(0,p.useState)(C.map(function(c){return c.id})),s=y()(f,2),A=s[0],o=s[1];(0,p.useEffect)(function(){d&&v(d)},[d]);var j=(0,p.useCallback)(function(c){console.log("selectedKey",c.key),v(c.key)},[]),I=(0,p.useCallback)(function(){var c;a.startsWith("category_")&&(c=a.split("_")[1]),E("/websites/".concat(l,"/cms/categories/new")+(c?"?parent_category_id=".concat(c):""))},[history,l,a]),T=(0,p.useCallback)(function(c){o(c)},[]);return(0,p.useEffect)(function(){o(C.map(function(c){return"category_".concat(c.id)}))},[C.map(function(c){return c.id}).join(",")]),(0,r.jsxs)(b.BlockUI,{zIndex:10,className:"my-5 p-5",overlayClassName:"bg-white bg-opacity-25",loading:!1,children:[(0,r.jsx)("div",{children:(0,r.jsx)("h1",{className:"text-gray-800 fw-bold mx-5",children:(S==null?void 0:S.name)||" "})}),(0,r.jsxs)(b.Menu,{fit:!0,accordion:!1,selectable:"AllMenu",className:"menu-title-gray-600 menu-icon-gray-400 menu-state-primary menu-state-icon-primary menu-state-bullet-primary menu-arrow-gray-500 fw-bold fs-6 px-6 my-5 my-lg-0",selectedKeys:a?[a]:[],onSelect:j,openKeys:A,onOpenChange:T,children:[(0,r.jsxs)(b.Menu.Section,{className:"pt-8 pb-0 flex-row-fluid align-items-center",contentClassName:"d-flex flex-row-fluid",sectionClassName:"d-flex flex-row-fluid",children:[(0,r.jsxs)("span",{className:"text-muted text-uppercase fs-8 ls-1 align-items-center d-flex flex-row-fluid",children:["\u680F\u76EE ",x&&" - loading..."]}),(0,r.jsx)(b.Button,{icon:(0,r.jsx)(k.JO,{style:{marginRight:".2rem"},name:"Duotune/arr087",className:""}),size:"sm",variant:"white",className:"py-1 px-3 me-n4",onClick:I,children:"\u65B0\u589E"})]}),C.map(function(c){return N(c,l)}),(0,r.jsx)(b.Menu.Section,{children:"\u8BBE\u7F6E"}),(0,r.jsx)(b.Menu.Item,{bullet:!0,icon:"",title:"\u901A\u7528\u8BBE\u7F6E",url:"/websites/".concat(l,"/settings/general")},"settings_general"),(0,r.jsx)(b.Menu.Item,{bullet:!0,icon:"",title:"\u6587\u4EF6\u7BA1\u7406",url:"/websites/".concat(l,"/files")},"files"),(0,r.jsx)(b.Menu.Item,{bullet:!0,icon:"",title:"\u5BFC\u822A\u83DC\u5355",url:"/websites/".concat(l,"/settings/navigation")},"settings_navigation")]})]})}var K=$,R=n(52680);function m(){var i=(0,g.UO)(),l=i.sid,M=(0,g.TH)(),x=(0,R._$)({fetchPolicy:"cache-and-network",variables:{id:l}}),S=x.data,E=x.loading,C=S==null?void 0:S.website,d=C==null?void 0:C.channel.id,e=(0,R.v7)({fetchPolicy:"cache-and-network"}),t=y()(e,2),a=t[0],v=t[1],f=v.data,s=f===void 0?{categories:[]}:f,A=v.loading,o=(0,p.useMemo)(function(){return!(s!=null&&s.categories)||!s.categories.length?[]:s.categories},[s==null?void 0:s.categories]);return(0,p.useEffect)(function(){d&&a({variables:{id:d}})},[a,d]),(0,r.jsxs)(h.Hk,{className:"micro-app-website",children:[(0,r.jsx)(h.Hk.Sidebar,{children:(0,r.jsx)(K,{website:C,categories:o,location:M,id:l,loading:E||A})}),d&&!A&&(0,r.jsx)(g.j3,{context:{rootCategoryId:d,categories:o,baseUrl:"/websites/"+l}})]})}var u=m}}]);
