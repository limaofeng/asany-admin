"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9452,1836],{51253:function(We,Pe,r){r.d(Pe,{GP:function(){return ce.Z},Hk:function(){return fe},xx:function(){return Ee.x}});var we=r(74958),ce=r(5166),Ee=r(19260),f=r(68400),te=r.n(f),O=r(62435),he=r(93967),F=r.n(he),Ie=r(94589),De=r(97857),a=r.n(De),de=r(46027),Be=r(42687),ue=r(13757),Ye=r(5574),ie=r.n(Ye),Q=r(96486),x=r(86074),X={aside:{minimize:!1,width:280}},s=O.createContext({state:X,dispatch:function(){}}),Me=function(M){return M.AsideToggle="ASIDE_TOGGLE",M.AsideWidth="ASIDE_WIDTH",M}({});function je(M,B){switch(B.type){case"ASIDE_TOGGLE":return M.aside.minimize=!M.aside.minimize,a()({},M);case"ASIDE_WIDTH":return M.aside.width=B.payload,a()({},M);default:throw new Error}}var Ae=function(B){var pe=(0,O.useReducer)(je,(0,Q.cloneDeep)(X)),ge=ie()(pe,2),Se=ge[0],be=ge[1];return(0,x.jsx)(s.Provider,{value:{state:Se,dispatch:be},children:B.children})},e=function(){return(0,O.useContext)(s)},Re=r(65495);function J(M){var B=e(),pe=B.dispatch,ge=B.state.aside.minimize,Se=(0,O.useCallback)(function(){pe({type:Me.AsideToggle})},[pe]);return(0,x.jsx)(ue.Button,{style:a()({marginBottom:"1.35rem",zIndex:105},M.style),onClick:Se,activeColor:"primary",className:F()("micro-app-aside-toggle","btn-icon bg-body btn-color-gray-700 rounded-2 position-absolute translate-middle bottom-0 shadow-sm d-none d-lg-flex",M.className,{active:ge}),children:(0,x.jsx)(de.JO,{name:"Duotune/arr063",className:"svg-icon-2 rotate-180"})})}function c(M){var B=M.className,pe=M.header,ge=M.children,Se=M.collapsible,be=Se===void 0?!0:Se,Ne=M.width,Te=Ne===void 0?280:Ne,Oe=(0,Be.$Y)(),$e=e(),Ue=$e.dispatch;return(0,O.useEffect)(function(){Oe.aside.width(Te+100),Ue({type:Me.AsideWidth,payload:Te})},[Oe.aside,Ue,Te]),(0,x.jsxs)("div",{className:F()("app-aside aside",B),children:[(0,x.jsx)(Re.Z,{children:(0,x.jsx)(ce.Z,{header:pe,resizeable:!0,className:"app-sidebar",children:ge})}),be&&(0,x.jsx)(J,{className:"start-100 end-0"})]})}c.Toggle=J;var j=c,g,_=Ie.ZP.div(g||(g=te()([`
  --root-aside-width: `,`;
  --met-aside-width: `,`;
`])),function(M){return M.minimize?"100px":"".concat(M.width,"px")},function(M){return M.minimize?"100px":"".concat(M.width,"px")});function E(M){var B=M.children,pe=M.className,ge=e(),Se=ge.state.aside,be=Se.minimize,Ne=Se.width,Te=(0,O.useCallback)(function(Oe){Oe.preventDefault()},[]);return(0,x.jsx)(_,{minimize:be,width:Ne,className:F()("micro-app-container page-full-content",pe,{"aside-minimize":be}),onContextMenu:Te,children:B})}function Z(M){var B=M.children,pe=M.className;return(0,x.jsx)(Ae,{children:(0,x.jsx)(E,{className:pe,children:B})})}Z.Sidebar=j;var fe=Z},42687:function(We,Pe,r){r.d(Pe,{$Y:function(){return de},BK:function(){return ue},aM:function(){return ie}});var we=r(5574),ce=r.n(we),Ee=r(97857),f=r.n(Ee),te=r(62435),O=r(86074),he=te.createContext({getState:function(){return{routes:[]}},subscribe:function(){},dispatch:function(){}}),F=function(x,X){return X?X.type==="ASIDE_MINIMIZE"?f()(f()({},x),{},{aside:f()(f()({},x.aside),{},{minimize:!!X.payload})}):X.type==="ASIDE_WIDTH"?f()(f()({},x),{},{aside:f()(f()({},x.aside),{},{width:X.payload})}):X.type==="ASIDE_COLLAPSIBLE"?f()(f()({},x),{},{aside:f()(f()({},x.aside),{},{collapsible:X.payload})}):x:x},Ie=function(x){return f()({},x)};function De(Q){var x=(0,te.useReducer)(F,Q,Ie),X=ce()(x,2),s=X[0],Me=X[1],je=(0,te.useState)([]),Ae=ce()(je,1),e=Ae[0],Re=function(fe){return function(){var M=e.indexOf(fe);M>-1&&e.splice(M,1)}},J=(0,te.useCallback)(function(Z){return e.unshift(Z),Re(Z)},[e]),c=(0,te.useCallback)(function(){e.forEach(function(Z){return Z()})},[e]),j={getState:function(){return s},dispatch:Me,subscribe:J},g=(0,te.useState)(j),_=ce()(g,1),E=_[0];return(0,te.useEffect)(function(){E.getState=function(){return s},c()},[s]),E}var a=function(x,X){return x===X};function de(){var Q=(0,te.useContext)(he),x=(0,te.useRef)({aside:{get state(){return Q.getState().aside},width:function(s){Q.dispatch({type:"ASIDE_WIDTH",payload:s})},minimize:function(s){Q.dispatch({type:"ASIDE_MINIMIZE",payload:s})},collapsible:function(s){Q.dispatch({type:"ASIDE_COLLAPSIBLE",payload:s})}}});return x.current}function Be(Q){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a,X=(0,te.useContext)(he),s=(0,te.useReducer)(function(J){return J+1},0),Me=ce()(s,2),je=Me[1],Ae=(0,te.useRef)(),e=Q(X.getState());function Re(){var J=Q(X.getState());x(J,Ae.current)||(Ae.current=J,je())}return(0,te.useEffect)(function(){return X.subscribe(Re)},[]),e}function ue(Q){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a;return Be(Q,x)}function Ye(){var Q=useContext(he);return Q.dispatch}function ie(Q){var x=Q.children,X=Q.state,s=De(X);return(0,te.useMemo)(function(){return(0,O.jsx)(he.Provider,{value:s,children:x})},[x,s])}},96414:function(We,Pe,r){r.d(Pe,{dI:function(){return Re},rB:function(){return e}});var we=r(5574),ce=r.n(we),Ee=r(62435),f={USERS_LIST:"users-list"};function te(J){return J!=null&&J!==""}function O(J,c){var j=useState(J),g=_slicedToArray(j,2),_=g[0],E=g[1];return useEffect(function(){var Z=setTimeout(function(){E(J)},c);return function(){clearTimeout(Z)}},[J,c]),_}var he=r(72004),F=r.n(he),Ie=r(12444),De=r.n(Ie),a=r(9783),de=r.n(a),Be=r(8606),ue=F()(function J(){var c=this;De()(this,J),de()(this,"menu",null),de()(this,"element",null),de()(this,"getParamName",function(j){var g=document.body.hasAttribute("data-kt-name"),_=g?g+"_":"";return"kt_"+_+"theme_mode_"+j}),de()(this,"getMode",function(){var j,g=c.getParamName("value"),_=c.getMenuMode(),E="light";if(!localStorage)return E;var Z=localStorage.getItem(g);if(Z)return Z;var fe=(j=c.element)===null||j===void 0?void 0:j.getAttribute("data-theme");return fe||(_?_==="system"?c.getSystemMode():_:E)}),de()(this,"setMode",function(j,g){var _,E,Z,fe=j,M=g;if(!(fe!=="light"&&fe!=="dark")){var B=c.getParamName("value"),pe=c.getParamName("menu");M==="system"&&c.getSystemMode()!==fe&&(fe=c.getSystemMode()),M||(M=fe);var ge=((_=c.menu)===null||_===void 0?void 0:_.querySelector('[data-kt-element="mode"][data-kt-value="'+M+'"]'))||null;(E=c.element)===null||E===void 0||E.setAttribute("data-kt-theme-mode-switching","true"),(Z=c.element)===null||Z===void 0||Z.setAttribute("data-theme",fe);var Se=c;setTimeout(function(){var be;(be=Se.element)===null||be===void 0||be.removeAttribute("data-kt-theme-mode-switching")},300),localStorage&&localStorage.setItem(B,fe),ge&&localStorage&&(localStorage.setItem(pe,M),c.setActiveMenuItem(ge)),c.flipImages()}}),de()(this,"getMenuMode",function(){var j,g=c.getParamName("menu"),_=(j=c.menu)===null||j===void 0?void 0:j.querySelector('.active[data-kt-element="mode"]'),E=_==null?void 0:_.getAttribute("data-kt-value");if(E)return E;if(!g)return"";var Z=localStorage?localStorage.getItem(g):null;return Z||""}),de()(this,"getSystemMode",function(){return window.matchMedia("(prefers-color-scheme: dark)")?"dark":"light"}),de()(this,"initMode",function(){c.setMode(c.getMode(),c.getMenuMode()),c.element&&Be.EventHandlerUtil.trigger(c.element,"kt.thememode.init")}),de()(this,"setActiveMenuItem",function(j){var g,_=c.getParamName("menu"),E=j.getAttribute("data-kt-value"),Z=(g=c.menu)===null||g===void 0?void 0:g.querySelector('.active[data-kt-element="mode"]');Z&&Z.classList.remove("active"),j.classList.add("active"),localStorage&&E&&_&&localStorage.setItem(_,E)}),de()(this,"handleMenu",function(){var j;(j=c.menu)===null||j===void 0||(j=j.querySelectorAll('[data-kt-element="mode"]'))===null||j===void 0||j.forEach(function(g){g.addEventListener("click",function(_){_.preventDefault();var E=g.getAttribute("data-kt-value"),Z=E==="system"?c.getSystemMode():E;Z&&c.setMode(Z,E)})})}),de()(this,"flipImages",function(){var j;(j=document.querySelectorAll("[data-kt-img-dark]"))===null||j===void 0||j.forEach(function(g){g.tagName==="IMG"?c.getMode()==="dark"&&g.hasAttribute("data-kt-img-dark")?(g.setAttribute("data-kt-img-light",g.getAttribute("src")||""),g.setAttribute("src",g.getAttribute("data-kt-img-dark")||"")):c.getMode()==="light"&&g.hasAttribute("data-kt-img-light")&&(g.setAttribute("data-kt-img-dark",g.getAttribute("src")||""),g.setAttribute("src",g.getAttribute("data-kt-img-light")||"")):c.getMode()==="dark"&&g.hasAttribute("data-kt-img-dark")?(g.setAttribute("data-kt-img-light",g.getAttribute("src")||""),g.style.backgroundImage="url('"+g.getAttribute("data-kt-img-dark")+"')"):c.getMode()==="light"&&g.hasAttribute("data-kt-img-light")&&(g.setAttribute("data-kt-img-dark",g.getAttribute("src")||""),g.style.backgroundImage="url('"+g.getAttribute("data-kt-img-light")+"')")})}),de()(this,"on",function(j,g){if(c.element)return Be.EventHandlerUtil.on(c.element,j,g)}),de()(this,"off",function(j,g){if(c.element)return Be.EventHandlerUtil.off(c.element,j,g)}),de()(this,"init",function(){c.menu=document.querySelector('[data-kt-element="theme-mode-menu"]'),c.element=document.documentElement,c.initMode(),c.menu&&c.handleMenu()})}),Ye=new ue,ie=r(86074),Q=Ye.getSystemMode(),x=function(c){var j=c!=="system"?c:Q,g="/media/patterns/header-bg"+(j==="light"?".jpg":"-dark.png");document.body.style.backgroundImage='url("'.concat(toAbsoluteUrl(g),'")')},X="kt_theme_mode_value",s="kt_theme_mode_menu",Me=function(c){if(!localStorage)return"light";var j=localStorage.getItem(c);return!j||j==="light"?"light":j==="dark"?"dark":"system"},je={mode:Me(X),menuMode:Me(s),updateMode:function(c){},updateMenuMode:function(c){}},Ae=(0,Ee.createContext)({mode:je.mode,menuMode:je.menuMode,updateMode:function(c){},updateMenuMode:function(c){}}),e=function(){return(0,Ee.useContext)(Ae)},Re=function(c){var j=c.children,g=(0,Ee.useState)(je.mode),_=ce()(g,2),E=_[0],Z=_[1],fe=(0,Ee.useState)(je.menuMode),M=ce()(fe,2),B=M[0],pe=M[1],ge=function(Ne){var Te=Ne==="system"?Q:Ne;Z(Te),localStorage&&localStorage.setItem(X,Te),document.documentElement.setAttribute("data-theme",Te),Ye.init()},Se=function(Ne){pe(Ne),localStorage&&localStorage.setItem(s,Ne)};return(0,Ee.useEffect)(function(){ge(E),Se(B)},[]),(0,ie.jsx)(Ae.Provider,{value:{mode:E,menuMode:B,updateMode:ge,updateMenuMode:Se},children:j})}},48943:function(We,Pe,r){r.r(Pe),r.d(Pe,{default:function(){return Sa}});var we=r(9783),ce=r.n(we),Ee=r(15009),f=r.n(Ee),te=r(99289),O=r.n(te),he=r(5574),F=r.n(he),Ie=r(64599),De=r.n(Ie),a=r(62435),de=r(49972),Be=r(24689),ue=r(12845),Ye=r(93967),ie=r.n(Ye),Q=r(30381),x=r.n(Q),X=r(51253),s=r(13757),Me=r(12708),je=r(19632),Ae=r.n(je),e=r(86074);function Re(u){var i=u.calendarSets,t=u.onAction,d=(0,ue.useModel)("calendar",function(h){return h.state.calendarSet}),l=(0,ue.useModel)("calendar",function(h){return h.setCalendarSet}),D=(0,a.useCallback)(function(h){if(h.startsWith("calendar-set-"))l(h.substring(13));else return t(h),!1;return!0},[t,l]),S=(0,a.useMemo)(function(){return[{value:"calendar-set-all",label:"\u5168\u90E8\u65E5\u5386"}].concat(Ae()(i.map(function(h){return{value:"calendar-set-".concat(h.id),label:h.name}})),[{type:"separator"},{value:"manage-calendars",label:"\u7BA1\u7406\u65E5\u5386"}])},[i]);return(0,e.jsx)("div",{className:"calendar-sidebar-footer",children:(0,e.jsx)(s.Select,{onChange:D,placement:"topCenter",value:"calendar-set-".concat(d),options:S})})}var J=Re,c=r(46027);function j(){var u=(0,a.useRef)(null),i=(0,a.useState)(!1),t=F()(i,2),d=t[0],l=t[1],D=(0,a.useState)(""),S=F()(D,2),h=S[0],T=S[1],U=(0,ue.useModel)("calendar",function(p){var o=p.state;return o.selectedDay||new Date}),C=(0,ue.useModel)("calendar",function(p){return p.state.state==="new"}),N=(0,ue.useModel)("calendar",function(p){return p.changeState}),L=(0,a.useCallback)(function(){var p;(p=u.current)===null||p===void 0||p.focus()},[]),n=(0,a.useCallback)(function(){l(!0)},[]),m=(0,a.useCallback)(function(){var p=document.getElementsByClassName("main-calendar")[0];p==null||p.focus(),N("none"),T(""),l(!1)},[N]),q=(0,a.useCallback)(function(p){p.key==="Escape"&&m()},[m]),P=(0,a.useCallback)(function(p){if(T(p.target.value),!p.target.value){N("none");return}!C&&N("new",U)},[N,C,U]),I=(0,a.useCallback)(function(){var p;(p=u.current)!==null&&p!==void 0&&p.value||m()},[m]);return(0,a.useEffect)(function(){var p;if(!C){T(""),l(!1);return}var o=document.activeElement,H=!!o&&(o.tagName==="INPUT"||o.tagName==="SELECT"||o.tagName==="TEXTAREA"||o.contentEditable&&o.contentEditable==="true");H||((p=u.current)===null||p===void 0||p.focus(),T(x()(U).format("YYYY-MM-DD")))},[C,U]),(0,e.jsxs)("div",{className:ie()("calendar-event-header",{"event-header-state-new":C}),children:[(0,e.jsx)("div",{className:ie()("calendar-event-header-left"),children:(0,e.jsx)(s.Input,{onFocus:n,onBlur:I,ref:u,value:h,onChange:P,solid:!0,placeholder:"\u65B0\u5EFA\u65E5\u7A0B",onKeyUp:q})}),(0,e.jsx)("a",{className:ie()("calendar-event-header-right",{"calendar-event-new-icon":!(d||C)}),onClick:d||C?m:L,children:(0,e.jsx)(c.ZP,{className:ie()({"svg-icon-1":d||C,"svg-icon-2x svg-icon-dark":!(d||C)}),name:d||C?"Duotune/arr088":"Duotune/arr087"})})]})}var g=j,_=r(97857),E=r.n(_),Z=r(13769),fe=r.n(Z),M=r(52035),B=r(55760);function pe(u){var i=(0,B.V7)({fetchPolicy:"cache-and-network"}),t=i.data,d=(0,a.useMemo)(function(){return t!=null&&t.calendars?t.calendars.filter(function(l){return l.type==="SUNRISE"}).map(function(l){return E()(E()({},l),{},{label:l.name,value:l.id})}):[]},[t==null?void 0:t.calendars]);return(0,e.jsx)(s.Select,E()(E()({},u),{},{options:d,itemRender:function(D,S){var h=D.color,T=(0,e.jsx)("div",{style:{backgroundColor:h,width:12,height:12,marginRight:8,border:"1px solid ".concat((0,M.r5)(h)),borderRadius:6,display:"inline-block"}});return S?(0,e.jsxs)(e.Fragment,{children:[a.cloneElement(T,{style:E()(E()({},T.props.style),{},{marginRight:5})}),D.label]}):(0,e.jsxs)(e.Fragment,{children:[T,D.label]})}}))}var ge=pe,Se=["calendar","alert"],be=s.Input.TextArea,Ne=[{label:"\u65E0",value:"none",scope:["all-day","general"],remind:{alert:"NONE"}},{type:"separator",scope:["all-day","general"]},{label:"\u65E5\u7A0B\u5F53\u5929 (\u4E0A\u5348 8:00)",value:"on time of event",scope:["all-day"],remind:{alert:"ON_TIME_OF_EVENT"}},{label:"1 \u5929\u524D (\u4E0A\u5348 8:00)",value:"1 day before 8:00",scope:["all-day"],remind:{alert:"DAYS_BEFORE",times:1}},{label:"2 \u5929\u524D (\u4E0A\u5348 8:00)",value:"2 day before 8:00",scope:["all-day"],remind:{alert:"DAYS_BEFORE",times:2}},{label:"\u65E5\u7A0B\u53D1\u751F\u65F6",value:"at time of event",scope:["general"],remind:{alert:"AT_TIME_OF_EVENT"}},{label:"1 \u5206\u949F\u524D",value:"1 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:1}},{label:"5 \u5206\u949F\u524D",value:"5 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:5}},{label:"10 \u5206\u949F\u524D",value:"10 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:10}},{label:"15 \u5206\u949F\u524D",value:"15 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:15}},{label:"30 \u5206\u949F\u524D",value:"30 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:30}},{label:"45 \u5206\u949F\u524D",value:"45 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:45}},{label:"1 \u5C0F\u65F6\u524D",value:"1 hour before",scope:["general"],remind:{alert:"HOURS_BEFORE",times:1}},{label:"2 \u5C0F\u65F6\u524D",value:"2 hour before",scope:["general"],remind:{alert:"HOURS_BEFORE",times:2}},{label:"1 \u5929\u524D",value:"1 day before",scope:["general"],remind:{alert:"DAYS_BEFORE",times:1}},{label:"2 \u5929\u524D",value:"2 day before",scope:["general"],remind:{alert:"DAYS_BEFORE",times:2}},{type:"separator",scope:["all-day","general"]},{label:"\u81EA\u5B9A\u4E49",value:"custom",scope:[]}];function Te(u){var i=u.visible,t=u.calendarSets,d=u.onSuccess,l=(0,a.useRef)({title:"\u6D4B\u8BD5",allDay:!0,color:"none",alert:"none",starts:"2022-01-19",ends:"2022-01-19"}),D=(0,a.useState)(!1),S=F()(D,2),h=S[0],T=S[1],U=(0,ue.useModel)("calendar",function(o){var H=o.state;return x()(H.selectedDay||new Date).format("YYYY-MM-DD")}),C=(0,ue.useModel)("calendar",function(o){return o.state.state==="new"}),N=(0,ue.useModel)("calendar",function(o){return o.state.calendarSet}),L=(0,B.wO)(),n=F()(L,1),m=n[0];l.current.starts=U,l.current.ends=U;var q=(0,a.useCallback)(function(){T(function(o){return!o})},[]),P=(0,a.useCallback)(function(o){if(o.key==="Escape"){var H;(H=document.querySelector(".calendar-event-header input"))===null||H===void 0||H.focus()}},[]),I=s.Form.useForm();(0,a.useEffect)(function(){if(!l.current.calendar)if(N==="all")l.current.calendar=null;else{var o;l.current.calendar=(o=t.find(function(H){return H.id===N}))===null||o===void 0||(o=o.defaultCalendar)===null||o===void 0?void 0:o.id}I.setFieldsValue(l.current)},[N,t,I]);var p=(0,a.useCallback)(function(){var o=O()(f()().mark(function H(W){var le,z,A,Y,oe,V,y;return f()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return z=W.calendar,A=W.alert,Y=fe()(W,Se),oe=(le=Ne.find(function(K){return K.value===A}))===null||le===void 0?void 0:le.remind,R.next=4,m({variables:{calendar:z,input:E()(E()({},Y),{},{remind:oe||{alert:"NONE"}})}});case 4:V=R.sent,y=V.data,d(y==null?void 0:y.event);case 7:case"end":return R.stop()}},H)}));return function(H){return o.apply(this,arguments)}}(),[m,d]);return(0,a.useEffect)(function(){C&&I.setFieldsValue(l.current)},[C,I]),(0,e.jsx)("div",{className:ie()("calendar-new-event-container",{invisible:!i}),children:(0,e.jsx)("div",{className:"calendar-new-event",children:(0,e.jsx)(s.Form,{onFinish:p,form:I,onKeyUp:P,layout:"horizontal",initialValues:l.current,children:(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsx)(s.Form.Item,{name:"title",noStyle:!0,children:(0,e.jsx)(s.Input,{solid:!0,placeholder:"\u65B0\u5EFA\u65E5\u7A0B"})})}),(0,e.jsx)("li",{children:(0,e.jsx)(s.Form.Item,{name:"allDay",valuePropName:"checked",label:"\u5168\u5929",children:(0,e.jsx)(s.Checkbox,{})})}),(0,e.jsx)("li",{children:(0,e.jsx)(s.Form.Item,{noStyle:!0,dependencies:["allDay"],children:function(){return(0,e.jsx)(s.Form.Item,{name:"starts",label:"\u5F00\u59CB\u65F6\u95F4",children:(0,e.jsx)(s.DatePicker,{solid:!0,timePicker:!I.getFieldValue("allDay"),format:I.getFieldValue("allDay")?"YYYY-MM-DD":"YYYY-MM-DD A HH:mm"})})}})}),(0,e.jsx)("li",{children:(0,e.jsx)(s.Form.Item,{noStyle:!0,dependencies:["allDay","starts"],children:function(){return(0,e.jsx)(s.Form.Item,{name:"ends",label:"\u7ED3\u675F\u65F6\u95F4",children:(0,e.jsx)(s.DatePicker,{solid:!0,minDate:I.getFieldValue("starts"),timePicker:!I.getFieldValue("allDay"),format:I.getFieldValue("allDay")?"YYYY-MM-DD":"YYYY-MM-DD A HH:mm"})})}})}),(0,e.jsx)("li",{children:(0,e.jsx)(s.Form.Item,{name:"calendar",label:"\u65E5\u5386",children:(0,e.jsx)(ge,{solid:!0})})}),(0,e.jsx)("li",{children:(0,e.jsx)(s.Form.Item,{noStyle:!0,dependencies:["allDay"],children:function(){return(0,e.jsx)(s.Form.Item,{name:"alert",label:"\u63D0\u9192",children:(0,e.jsx)(s.Select,{solid:!0,options:Ne.filter(function(H){return H.scope.includes(I.getFieldValue("allDay")?"all-day":"general")})})})}})}),(0,e.jsx)("li",{className:ie()({invisible:!h}),children:(0,e.jsx)(s.Form.Item,{noStyle:!0,children:(0,e.jsx)(s.Input,{solid:!0,placeholder:"\u8BBE\u7F6E\u94FE\u63A5"})})}),(0,e.jsx)("li",{className:ie()({invisible:!h}),children:(0,e.jsx)(s.Form.Item,{noStyle:!0,children:(0,e.jsx)(be,{autoSize:!0,solid:!0,placeholder:"\u5907\u6CE8"})})}),(0,e.jsxs)("li",{className:"event-actions",children:[(0,e.jsx)(c.ZP,{onClick:q,className:"toggle-more svg-icon-1",name:h?"Bootstrap/chevron-compact-up":"Bootstrap/chevron-compact-down"}),(0,e.jsx)(s.Form.Item,{noStyle:!0,dependencies:["title"],children:function(){return(0,e.jsx)(s.Button,{htmlType:"submit",disabled:!I.getFieldValue("title"),className:"event-btn-add rounded-2",children:"\u6DFB\u52A0\u65E5\u7A0B"})}})]})]})})})})}var Oe=Te,$e=r(16085),Ue=r(69293),Ve=r(75275),Ze=r(59197),Ge=r(96486),Qe=r(38932),_e=a.forwardRef(function(u,i){var t=u.closeDropdown,d=u.onAction,l=u.accounts,D=(0,a.useCallback)(function(S){t(),S.keyPath.startsWith("new-calendar")?d("new",S.key):S.keyPath.startsWith("new-calendar-subscription")&&d("subscribe")},[t,d]);return(0,e.jsxs)(s.Menu,{className:"menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-150px py-2",ref:i,dropdown:!0,onSelect:D,selectedKeys:[],children:[(0,e.jsx)(s.Menu.SubMenu,{title:"\u65B0\u589E\u65E5\u5386",className:"px-2",bodyClassName:"py-2 w-150px",offset:[-6.5,0],children:l.map(function(S){return(0,e.jsx)(s.Menu.Item,{title:S.name,className:"px-2"},S.id)})},"new-calendar"),(0,e.jsx)(s.Menu.Separator,{className:"mx-1"}),(0,e.jsx)(s.Menu.Item,{className:"px-2",children:"\u65B0\u589E\u65E5\u5386\u8BA2\u9605"},"new-calendar-subscription")]})});function qe(u){var i=u.onSuccess,t=u.selectedItem,d=u.onEdit,l=(0,B.Bo)(),D=F()(l,1),S=D[0],h=(0,B.Cn)(),T=F()(h,1),U=T[0],C=(0,B.e)({fetchPolicy:"cache-and-network"}),N=C.data,L=(0,a.useMemo)(function(){return N!=null&&N.calendarAccounts?N.calendarAccounts||[]:[]},[N==null?void 0:N.calendarAccounts]),n=(0,a.useCallback)(function(){var P=O()(f()().mark(function I(p,o){var H,W;return f()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(console.log(p,o),p!=="new"){z.next=7;break}return z.next=4,S({variables:{input:{account:o}}});case 4:H=z.sent,W=H.data,i(W==null?void 0:W.createCalendar);case 7:case"end":return z.stop()}},I)}));return function(I,p){return P.apply(this,arguments)}}(),[S,i]),m=(0,a.useCallback)(function(){t&&d(t.id,"modal")},[d,t]),q=(0,a.useCallback)(O()(f()().mark(function P(){var I;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(t){o.next=2;break}return o.abrupt("return");case 2:return o.next=4,s.Modal.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u65E5\u5386\u5417\uFF1F",content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u65E5\u5386\u201C<strong>".concat(t.name,"</strong>\u201D\u5417\uFF1F\u8FD9\u4E5F\u5C06\u5220\u9664\u6B64\u65E5\u5386\u4E0A\u7684\u6240\u6709\u4E8B\u4EF6\u3002"),okText:"\u5220 \u9664",cancelClassName:"btn btn-secondary btn-sm",okClassName:"btn btn-danger btn-sm"});case 4:if(I=o.sent,I.isConfirmed){o.next=7;break}return o.abrupt("return");case 7:return o.next=9,U({variables:{id:t.id}});case 9:i();case 10:case"end":return o.stop()}},P)})),[U,t,i]);return(0,e.jsxs)("div",{className:"calendars-footer",children:[(0,e.jsx)(s.Dropdown,{overlay:(0,e.jsx)(_e,{onAction:n,accounts:L}),placement:"bottomLeft",children:(0,e.jsx)("a",{children:(0,e.jsx)(c.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})})}),(0,e.jsx)("a",{onClick:q,className:ie()({disabled:!t}),children:(0,e.jsx)(c.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:m,className:ie()({disabled:!t}),children:(0,e.jsx)(c.ZP,{name:"Bootstrap/gear-fill",className:"svg-icon-7"})})]})}var ea=qe,Ke=r(34155),aa=a.forwardRef(function(u,i){var t=u.data,d=u.onSelect,l=u.onEdit,D=u.onCheck,S=u.editing,h=u.actived,T=u.checked,U=u.drag,C=u.indicator,N=u.onShortcut,L=(0,a.useState)(t.name),n=F()(L,2),m=n[0],q=n[1],P=(0,a.useRef)(null),I=(0,B.wg)(),p=F()(I,1),o=p[0],H=(0,a.useCallback)(function(){d(t.id)},[t.id,d]),W=(0,a.useCallback)(function(k){q(k.target.value)},[]),le=(0,a.useMemo)(function(){return(0,Ge.debounce)(function(){var k=O()(f()().mark(function R(K){return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,o({variables:{id:t.id,input:{name:K}}});case 2:case"end":return v.stop()}},R)}));return function(R){return k.apply(this,arguments)}}(),250)},[o,t.id]),z=(0,a.useCallback)(O()(f()().mark(function k(){return f()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:l(),t.name!==m&&le(m);case 2:case"end":return K.stop()}},k)})),[t.name,l,le,m]),A=(0,a.useCallback)(function(k,R){if(R){var K;(K=P.current)===null||K===void 0||K.focus(),Ke.nextTick(function(){var v;(v=P.current)===null||v===void 0||v.select()})}else if(k){var b;(b=P.current)===null||b===void 0||(b=b.offsetParent)===null||b===void 0||(b=b.parentElement)===null||b===void 0||(b=b.parentElement)===null||b===void 0||b.focus()}},[]);(0,a.useEffect)(function(){S&&A(h,S)},[h,S,A]);var Y=(0,a.useCallback)(function(k){k.stopPropagation(),A(!0)},[A]),oe=(0,a.useCallback)(function(k){D(t.id,k.target.checked)},[t,D]),V=(0,a.useCallback)(function(){l(t.id,"modal")},[t.id,l]),y=(0,a.useCallback)(function(){var k=O()(f()().mark(function R(K){return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:K==="EXIT"?(l(),q(t.name)):K==="ENTER"?(l(),t.name!==m&&le(m)):N(K);case 1:case"end":return v.stop()}},R)}));return function(R){return k.apply(this,arguments)}}(),[t.name,l,N,le,m]);return(0,e.jsxs)(Ve.fQ,{tag:(0,e.jsx)("li",{ref:U(i),onClick:H,onDoubleClick:V,className:ie()("calendar-list-item",{active:h,editing:S,"indicator-drag-over-bottom":C>0,"indicator-drag-over-top":C<0})}),name:"CALENDAR_PREFERENCES",handler:y,children:[(0,e.jsx)(s.Checkbox,{style:{backgroundColor:t.color,borderColor:h?(0,M.tG)(t.color,80):(0,M.r5)(t.color)},checked:T,onClick:Y,onChange:oe,className:"calendar-check",size:"sm"}),(0,e.jsxs)("div",{className:"calendar-list-item-btn",children:[(0,e.jsx)("span",{className:"input-state-view",children:m}),(0,e.jsx)("input",{className:"input-state-edit calendar-name",ref:P,onChange:W,onBlur:z,value:m}),t._type==="SUBSCRIPTION"&&(0,e.jsx)("span",{className:"calendar-type",children:"\u8BA2\u9605"})]})]})});function ta(u){var i=u.onClose,t=u.visible,d=u.data,l=(0,B.wg)(),D=F()(l,1),S=D[0],h=s.Form.useForm(),T=(0,a.useState)(d==null?void 0:d.color),U=F()(T,2),C=U[0],N=U[1],L=(0,a.useState)(!1),n=F()(L,2),m=n[0],q=n[1],P=(0,a.useRef)(null),I=(0,a.useRef)(null),p=(0,a.useMemo)(function(){return[{value:"#ff3d33",label:"\u7EA2\u8272"},{value:"#fc8328",label:"\u6A59\u8272"},{value:"#ffcc00",label:"\u9EC4\u8272"},{value:"#63da38",label:"\u7EFF\u8272"},{value:"#1badf8",label:"\u84DD\u8272"},{value:"#cc73e1",label:"\u7D2B\u8272"},{value:"#a67a63",label:"\u68D5\u8272"},{type:"separator"},{value:"other",label:"\u5176\u4ED6"}]},[]),o=(0,a.useMemo)(function(){return C&&p.some(function(A){return A.value===C})?C:"other"},[p,C]);(0,a.useEffect)(function(){var A;t&&(N(d==null?void 0:d.color),h.setFieldsValue(d),(A=P.current)===null||A===void 0||A.focus(),Ke.nextTick(function(){var Y;(Y=P.current)===null||Y===void 0||Y.select()}))},[t]),(0,Ue.Z)(I,function(){q(!1)});var H=(0,a.useCallback)(function(A){A==="other"?q(!0):N(A)},[N]),W=(0,a.useCallback)(O()(f()().mark(function A(){var Y;return f()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return Y=h.getFieldsValue(),V.next=3,S({variables:{id:d.id,input:E()({color:C},Y)}});case 3:i();case 4:case"end":return V.stop()}},A)})),[C,d,h,i,S]),le=(0,a.useCallback)(function(){i(),q(!1)},[i]),z=(0,a.useCallback)(function(A){var Y=A.hex;N(Y)},[]);return(0,e.jsx)(s.Modal,{centered:!0,visible:t,dialogClassName:"modal-dialog-concise-style modal-dialog-small w-400px",onCancel:le,onOk:W,header:!1,closable:!1,okButtonProps:{className:"btn-xs"},cancelButtonProps:{className:"btn-xs"},children:(0,e.jsxs)(s.Form,{form:h,layout:"horizontal",initialValues:E()({},d),size:"xs",children:[(0,e.jsxs)("div",{className:"d-flex flex-row flex-center",children:[(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(s.Form.Item,{name:"name",label:"\u540D\u79F0",children:(0,e.jsx)(s.Input,{ref:P,className:"calendar-name"})})}),(0,e.jsx)("div",{className:"d-flex flex-column-auto flex-center",children:(0,e.jsxs)("div",{className:"asany-form-item",children:[(0,e.jsx)(s.Select,{value:o,size:"xs",onChange:H,placement:"bottomCenter",itemRender:function(Y,oe){var V=Y.value==="other"?C||(d==null?void 0:d.color):Y.value;if(!V)return(0,e.jsx)(e.Fragment,{});var y=(0,e.jsx)("div",{style:{backgroundColor:V,width:20,height:14,marginRight:8,border:"1px solid ".concat((0,M.r5)(V)),display:"inline-block"}});return oe?a.cloneElement(y,{style:E()(E()({},y.props.style),{},{marginRight:5})}):(0,e.jsxs)(e.Fragment,{children:[y,Y.label]})},options:p}),(0,e.jsx)(s.Popover,{visible:m,overlayClassName:"popover-content-body",content:(0,e.jsx)("div",{ref:I,children:(0,e.jsx)($e.xS,{presetColors:p.filter(function(A){return A.value!=="other"&&A.type!=="separator"}).map(function(A){return{color:A.value,title:A.label}}),color:C,onChangeComplete:z,onChange:z,width:"220px"})}),children:(0,e.jsx)("div",{})})]})})]}),(d==null?void 0:d.type)==="SUBSCRIPTION"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(s.Form.Item,{name:"url",label:"\u5730\u5740",children:(0,e.jsx)(s.Input,{})})}),(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(s.Form.Item,{name:"refresh",label:"\u5237\u65B0",children:(0,e.jsx)(s.Select,{className:"w-100px",placement:"bottomCenter",options:[{value:"NEVER",label:"\u4ECE\u4E0D"},{value:"EVERY_5_MINUTES",label:"\u6BCF5\u5206\u949F"},{value:"EVERY_15_MINUTES",label:"\u6BCF15\u5206\u949F"},{value:"EVERY_HOVER",label:"\u6BCF\u5C0F\u65F6"},{value:"EVERY_DAY",label:"\u6BCF\u5929"},{value:"EVERY_WEEK",label:"\u6BCF\u5468"}]})})})]}),(0,e.jsxs)("div",{className:"d-flex flex-row flex-center",children:[(0,e.jsx)("div",{className:"d-flex flex-column-auto flex-center",style:{width:56}}),(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(s.Form.Item,{name:"ignoreAlerts",valuePropName:"checked",children:(0,e.jsx)(s.Checkbox,{label:"\u5FFD\u7565\u63D0\u9192"})})})]})]})})}function na(u){var i=u.refresh,t=u.calendarSet,d=(0,B.wg)(),l=F()(d,1),D=l[0],S=(0,B.wN)(),h=F()(S,1),T=h[0],U=(0,B.DM)(),C=F()(U,1),N=C[0],L=(0,B.V7)({fetchPolicy:"cache-and-network"}),n=L.data,m=L.refetch,q=(0,a.useState)(),P=F()(q,2),I=P[0],p=P[1],o=(0,a.useState)(),H=F()(o,2),W=H[0],le=H[1],z=(0,a.useState)((t==null?void 0:t.calendars.map(function(w){return w.id}))||[]),A=F()(z,2),Y=A[0],oe=A[1],V=(0,a.useRef)(null),y=(0,a.useRef)({checkedKeys:[],calendars:[]});y.current.checkedKeys=Y,y.current.activeKey=I,y.current.editing=W,y.current.calendarSet=t,y.current.calendars=(n==null?void 0:n.calendars)||[];var k=(0,a.useCallback)(function(w){w&&p(w),le(void 0),Ke.nextTick(function(){var ae;(ae=V.current)===null||ae===void 0||ae.focus()})},[]),R=(0,a.useCallback)(function(w){w!==y.current.activeKey&&k(w)},[k]),K=(0,a.useCallback)(function(){var w=O()(f()().mark(function ae($){var ye,G=arguments;return f()().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:ye=G.length>1&&G[1]!==void 0?G[1]:"modal",$?le({key:$,type:ye}):k();case 2:case"end":return Ce.stop()}},ae)}));return function(ae){return w.apply(this,arguments)}}(),[k]),b=(0,a.useMemo)(function(){if(!(n!=null&&n.calendars))return[];var w=[],ae=De()(n.calendars),$;try{var ye=function(){var re=$.value,Ce=E()(E()({},re),{},{key:re.id,actived:I===re.id,editing:(W==null?void 0:W.key)===re.id&&(W==null?void 0:W.type)==="inline",checked:Y.some(function(xe){return xe===re.id}),_type:re.type});delete Ce.type;var Le=w.find(function(xe){return xe.id===re.account.id});Le?Le==null||Le.calendars.push(Ce):w.push(E()(E()({},re.account),{},{calendars:[Ce]}))};for(ae.s();!($=ae.n()).done;)ye()}catch(G){ae.e(G)}finally{ae.f()}return w.sort(function(G,re){return G.index-re.index})},[I,Y,n==null?void 0:n.calendars,W==null?void 0:W.key,W==null?void 0:W.type]),v=(0,a.useCallback)(function(){var w=O()(f()().mark(function ae($){return f()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,m();case 2:$&&(p($.id),le({type:"inline",key:$.id}));case 3:case"end":return G.stop()}},ae)}));return function(ae){return w.apply(this,arguments)}}(),[m]),ee=(0,a.useCallback)(function(){},[]),ne=(0,a.useCallback)(function(){var w=O()(f()().mark(function ae($){var ye,G,re,Ce;return f()().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return ye=(0,Qe.y)($.node._rect,$.node,$.dragNode,$.dropPosition,$.node.index),G=$.node.pos,re=ye-Number(G[G.length-1]),Ce=$.node.index,re===-1?Ce--:re===1&&Ce++,xe.next=7,D({variables:{id:$.dragNode.key,input:{index:Math.max(Ce,0)+1}}});case 7:m();case 8:case"end":return xe.stop()}},ae)}));return function(ae){return w.apply(this,arguments)}}(),[m,D]),me=(0,a.useCallback)(function(w){var ae;return((ae=y.current.editing)===null||ae===void 0?void 0:ae.key)!==w.id},[]),se=(0,a.useCallback)(function(w){return!isNaN(w.dropPosition)},[]),ke=(0,a.useCallback)(function(w){var ae=y.current,$=ae.calendars,ye=ae.activeKey,G=$.findIndex(function(re){return re.id===ye});w==="PREVIOUS"?k($[Math.max(G-1,0)].id):w==="NEXT"?p($[Math.min(G+1,$.length-1)].id):w==="ENTER"?le({key:ye,type:"inline"}):w==="EXIT"&&k()},[k]),ve=(0,a.useCallback)(function(){k()},[k]),Fe=(0,a.useCallback)(function(){var w=O()(f()().mark(function ae($,ye){var G,re,Ce;return f()().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(re=(G=y.current.calendarSet)===null||G===void 0?void 0:G.id,Ce=y.current.checkedKeys,console.log("handleChange",$,ye,re),!ye){xe.next=9;break}return oe([].concat(Ae()(Ce),[$])),xe.next=7,T({variables:{id:$,set:re}});case 7:xe.next=12;break;case 9:return oe(Ce.filter(function(ya){return ya!==$})),xe.next=12,N({variables:{id:$,set:re}});case 12:i();case 13:case"end":return xe.stop()}},ae)}));return function(ae,$){return w.apply(this,arguments)}}(),[i,T,N]);return(0,a.useEffect)(function(){oe((t==null?void 0:t.calendars.map(function(w){return w.id}))||[])},[t==null?void 0:t.calendars]),(0,e.jsxs)(Ve.fQ,{tag:(0,e.jsx)("div",{ref:V,className:ie()("calendar-list",{editing:!!W})}),handler:ke,name:"CALENDAR_PREFERENCES",children:[(0,e.jsxs)("div",{className:"calendar-list-notes",children:["\u201C",t==null?void 0:t.name,"\u201D\u65E5\u5386\u96C6\u7684\u65E5\u5386\u548C\u4EFB\u52A1\u5217\u8868\u3002"]}),(0,e.jsxs)("div",{className:"calendar-list-content",children:[(0,e.jsx)("div",{className:"calendars-header",children:"\u6211\u7684\u65E5\u5386"}),(0,e.jsx)("div",{className:"calendars-body scroll-y",children:b.map(function(w){return(0,e.jsxs)("div",{className:"calendars-group",children:[(0,e.jsx)("div",{className:"calendars-group-header",children:"\u6211\u7684\u65E5\u5386"}),(0,e.jsx)("div",{className:"calendars-group-body",children:(0,e.jsx)(Ze.ZP,{onChange:ee,tag:"ul",mode:"indicator",onDrop:ne,draggable:me,allowDrop:se,className:"calendar-sets-list",items:w.calendars,rerender:!1,itemRender:function($,ye){var G=$.data,re=$.index;return(0,a.createElement)(aa,E()(E()({},$),{},{ref:ye,actived:G.actived,editing:G.editing,checked:G.checked,onCheck:Fe,key:G.id,data:G,index:re,onSelect:R,onEdit:K,onShortcut:ke}))}})})]},w.id)})}),(0,e.jsx)(ea,{onSuccess:v,selectedItem:y.current.calendars.find(function(w){return w.id===I}),onEdit:K})]}),(0,e.jsx)(ta,{data:y.current.calendars.find(function(w){return w.id===I}),visible:(W==null?void 0:W.type)==="modal",onClose:ve})]})}var ra=na;function la(u){var i=u.onSuccess,t=u.selectedKey,d=(0,B.Xy)(),l=F()(d,1),D=l[0],S=(0,B.yM)(),h=F()(S,1),T=h[0],U=(0,a.useCallback)(O()(f()().mark(function N(){var L,n;return f()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,D();case 2:L=q.sent,n=L.data,i(n==null?void 0:n.createCalendarSet);case 5:case"end":return q.stop()}},N)})),[D,i]),C=(0,a.useCallback)(O()(f()().mark(function N(){return f()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,T({variables:{id:t}});case 2:i();case 3:case"end":return n.stop()}},N)})),[T,t,i]);return(0,e.jsxs)("div",{className:"calendar-sets-footer",children:[(0,e.jsx)("a",{onClick:U,children:(0,e.jsx)(c.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:C,children:(0,e.jsx)(c.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})})]})}var sa=la,ze=r(34155),ua=a.forwardRef(function(u,i){var t=u.data,d=u.editing,l=u.actived,D=u.onSelect,S=u.onEdit,h=u.drag,T=u.indicator,U=(0,B.f4)(),C=F()(U,1),N=C[0],L=(0,a.useState)(t.name),n=F()(L,2),m=n[0],q=n[1],P=(0,a.useRef)(null),I=(0,a.useCallback)(function(){D(t.id)},[t.id,D]),p=(0,a.useCallback)(function(){S(t.id)},[t.id,S]),o=(0,a.useMemo)(function(){return(0,Ge.debounce)(function(){var z=O()(f()().mark(function A(Y){return f()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,N({variables:{id:t.id,input:{name:Y}}});case 2:case"end":return V.stop()}},A)}));return function(A){return z.apply(this,arguments)}}(),250)},[N,t.id]),H=(0,a.useCallback)(O()(f()().mark(function z(){return f()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(S(),t.name===m){Y.next=4;break}return Y.next=4,o(m);case 4:case"end":return Y.stop()}},z)})),[t.name,S,o,m]),W=(0,a.useCallback)(function(z){q(z.target.value)},[]);(0,a.useEffect)(function(){var z;d&&((z=P.current)===null||z===void 0||z.focus(),ze.nextTick(function(){var A;(A=P.current)===null||A===void 0||A.select()}))},[d]);var le=(0,a.useCallback)(function(){var z=O()(f()().mark(function A(Y){return f()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(Y!=="EXIT"){V.next=5;break}S(),q(t.name),V.next=10;break;case 5:if(Y!=="ENTER"){V.next=10;break}if(S(),t.name===m){V.next=10;break}return V.next=10,o(m);case 10:case"end":return V.stop()}},A)}));return function(A){return z.apply(this,arguments)}}(),[t.name,S,o,m]);return(0,e.jsx)(Ve.fQ,{tag:(0,e.jsx)("li",{ref:h(i),onClick:I,onDoubleClick:p,className:ie()("calendarset-item",{active:l,"indicator-drag-over-bottom":T>0,"indicator-drag-over-top":T<0})}),name:"CALENDAR_PREFERENCES",handler:le,children:(0,e.jsxs)("div",{className:"calendarset-item-btn",children:[(0,e.jsx)("span",{className:"input-state-view",children:m}),(0,e.jsx)("input",{className:"input-state-edit",ref:P,onChange:W,onBlur:H,value:m})]})})});function ia(u){var i=u.data,t=i===void 0?[]:i,d=u.refresh,l=u.onSelect,D=(0,B.f4)(),S=F()(D,1),h=S[0],T=(0,ue.useModel)("calendar",function(y){return y.state.calendarSet}),U=(0,a.useRef)(null),C=(0,a.useRef)({calendarSets:[]}),N=(0,a.useState)(),L=F()(N,2),n=L[0],m=L[1],q=(0,a.useState)(),P=F()(q,2),I=P[0],p=P[1];C.current.activeKey=n,C.current.editing=I,C.current.calendarSets=t;var o=(0,a.useCallback)(function(y){y!==C.current.activeKey&&(m(y),ze.nextTick(function(){var k;(k=U.current)===null||k===void 0||k.focus()}))},[]),H=(0,a.useCallback)(function(){var y=O()(f()().mark(function k(R){return f()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,d();case 2:R?(m(R.id),p(R.id)):t.length&&m(t[0].id);case 3:case"end":return b.stop()}},k)}));return function(k){return y.apply(this,arguments)}}(),[t,d]),W=(0,a.useCallback)(function(){var y=O()(f()().mark(function k(R){return f()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:p(R),R||ze.nextTick(function(){var v;(v=U.current)===null||v===void 0||v.focus()});case 2:case"end":return b.stop()}},k)}));return function(k){return y.apply(this,arguments)}}(),[]);(0,a.useEffect)(function(){if(t.length&&!t.some(function(k){return k.id===n})){var y=T==="all"?t[0].id:String(T);m(y)}},[n,t,T]),(0,a.useEffect)(function(){n&&l(n)},[n,l]);var le=(0,a.useCallback)(function(y){var k=C.current,R=k.calendarSets,K=k.activeKey,b=R.findIndex(function(v){return v.id===K});y==="PREVIOUS"?m(R[Math.max(b-1,0)].id):y==="NEXT"?m(R[Math.min(b+1,R.length-1)].id):y==="ENTER"?p(n):y==="EXIT"&&p(void 0)},[n]),z=(0,a.useCallback)(function(){},[]),A=(0,a.useMemo)(function(){return t.map(function(y){return E()(E()({},y),{},{key:y.id,actived:n===y.id,editing:I===y.id})})},[n,t,I]),Y=(0,a.useCallback)(function(){var y=O()(f()().mark(function k(R){var K,b,v,ee;return f()().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return K=(0,Qe.y)(R.node._rect,R.node,R.dragNode,R.dropPosition,R.node.index),b=R.node.pos,v=K-Number(b[b.length-1]),ee=R.node.index,v===-1?ee--:v===1&&ee++,me.next=7,h({variables:{id:R.dragNode.key,input:{index:Math.max(ee,0)+1}}});case 7:d();case 8:case"end":return me.stop()}},k)}));return function(k){return y.apply(this,arguments)}}(),[d,h]),oe=(0,a.useCallback)(function(y){return C.current.editing!==y.id},[]),V=(0,a.useCallback)(function(y){return!isNaN(y.dropPosition)},[]);return(0,e.jsxs)(Ve.fQ,{tag:(0,e.jsx)("div",{ref:U,className:ie()("flex-left calendar-sets",{editing:!!I})}),name:"CALENDAR_PREFERENCES",handler:le,children:[(0,e.jsx)("div",{className:"calendar-sets-header",children:"\u65E5\u5386\u96C6"}),(0,e.jsx)("div",{className:"calendar-sets-body scroll-y",children:(0,e.jsx)(Ze.ZP,{onChange:z,tag:"ul",mode:"indicator",draggable:oe,onDrop:Y,allowDrop:V,className:"calendar-sets-list",items:A,rerender:!1,itemRender:function(k,R){var K=k.data,b=k.index;return(0,a.createElement)(ua,E()(E()({},k),{},{ref:R,actived:K.actived,editing:K.editing,key:K.id,data:K,index:b,onSelect:o,onEdit:W}))}})}),(0,e.jsx)(sa,{onSuccess:H,selectedKey:n})]})}var da=ia;function ca(){var u,i=(0,B.f4)(),t=F()(i,1),d=t[0],l=(0,B.Dn)({fetchPolicy:"cache-and-network"}),D=l.data,S=l.refetch,h=D==null?void 0:D.calendarSets,T=s.Form.useForm(),U=(0,a.useState)(),C=F()(U,2),N=C[0],L=C[1],n=(0,a.useCallback)(function(P){L(P)},[]),m=(h||[]).find(function(P){return P.id===N});(0,a.useEffect)(function(){var P;T.setFieldsValue({defaultCalendar:m==null||(P=m.defaultCalendar)===null||P===void 0?void 0:P.id})},[m,T]);var q=(0,a.useCallback)(O()(f()().mark(function P(){var I;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(I=T.getFieldsValue(),m){o.next=3;break}return o.abrupt("return");case 3:return console.log("handleChange calendarSet",I),o.next=6,d({variables:{id:m.id,input:I}});case 6:case"end":return o.stop()}},P)})),[m,T,d]);return(0,e.jsxs)("div",{className:"settings-calendars",children:[(0,e.jsx)("div",{className:"settings-calendars-notes",children:"\u901A\u8FC7\u521B\u5EFA\u591A\u4E2A\u65E5\u5386\u96C6\u5FEB\u901F\u66F4\u6539\u663E\u793A\u7684\u65E5\u5386\u548C\u4EFB\u52A1\u5217\u8868\u3002\u4F8B\u5982\uFF0C\u60A8\u53EF\u80FD\u6709\u5355\u72EC\u7684\u5BB6\u5EAD\u548C\u5DE5\u4F5C\u65E5\u5386\u96C6\u3002"}),(0,e.jsxs)("div",{className:"d-flex",children:[(0,e.jsx)(da,{onSelect:n,data:h,refresh:S}),(0,e.jsxs)("div",{className:"settings-calendars-right flex-root",children:[(0,e.jsx)(ra,{refresh:S,calendarSet:m}),(0,e.jsx)("div",{className:"calendar-sets-settings",children:(0,e.jsx)(s.Form,{form:T,layout:"horizontal",size:"xs",initialValues:{defaultCalendar:m==null||(u=m.defaultCalendar)===null||u===void 0?void 0:u.id},onFieldsChange:q,children:(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(s.Form.Item,{name:"defaultCalendar",label:"\u9ED8\u8BA4\u65E5\u5386",children:(0,e.jsx)(ge,{solid:!0})})})})})]})]})]})}var oa=ca;function va(u){var i=u.visible,t=u.onCancel,d=(0,a.useState)(!1),l=F()(d,2),D=l[0],S=l[1],h=(0,a.useState)("calendars"),T=F()(h,2),U=T[0],C=T[1],N=(0,a.useCallback)(function(){S(!0)},[]),L=(0,a.useCallback)(function(n){C(n)},[]);return(0,e.jsx)(s.Modal,{centered:!0,maskClosable:!1,visible:i,onCancel:t,onOk:N,scroll:!1,confirmLoading:D,dialogClassName:"mw-750px calendar-preferences",header:(0,e.jsx)(s.Modal.Header,{children:(0,e.jsxs)(s.Nav,{onSelect:L,selectedKey:U,children:[(0,e.jsx)(s.Nav.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(s.Nav.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(c.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u5E38\u89C4"})})]})},"general"),(0,e.jsx)(s.Nav.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(s.Nav.Link,{className:"btn d-flex flex-column btn-active-light-success",children:[(0,e.jsx)(c.ZP,{name:"Duotune/gen014",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u65E5\u5386"})})]})},"calendars"),(0,e.jsx)(s.Nav.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(s.Nav.Link,{className:"btn d-flex flex-column btn-active-light-info",children:[(0,e.jsx)(c.ZP,{name:"Duotune/fil020",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u5929\u6C14"})})]})},"weather")]})}),footer:!1,children:(0,e.jsx)(oa,{})})}var fa=va,ma={months:["1 \u6708","2 \u6708","3 \u6708","4 \u6708","5 \u6708","6 \u6708","7 \u6708","8 \u6708","9 \u6708","10 \u6708","11 \u6708","12 \u6708"],weekDays:[{name:"\u661F\u671F\u5929",short:"\u5468\u65E5",isWeekend:!0},{name:"\u661F\u671F\u4E00",short:"\u5468\u4E00"},{name:"\u661F\u671F\u4E8C",short:"\u5468\u4E8C"},{name:"\u661F\u671F\u4E09",short:"\u5468\u4E09"},{name:"\u661F\u671F\u56DB",short:"\u5468\u56DB"},{name:"\u661F\u671F\u4E94",short:"\u5468\u4E94"},{name:"\u661F\u671F\u516D",short:"\u5468\u516D",isWeekend:!0}],weekStartingIndex:0,getToday:function(i){return i},toNativeDate:function(i){return new Date(i.year,i.month-1,i.day)},getMonthLength:function(i){return new Date(i.year,i.month,0).getDate()},transformDigit:function(i){return i},nextMonth:"Next Month",previousMonth:"Previous Month",openMonthSelector:"Open Month Selector",openYearSelector:"Open Year Selector",closeMonthSelector:"Close Month Selector",closeYearSelector:"Close Year Selector",defaultPlaceholder:"Select...",from:"from",to:"to",digitSeparator:",",yearLetterSkip:0,isRtl:!1};function ha(u,i){for(var t=0;t<7;t++){var d=u.clone().add(t,"days"),l=d.format("YYYY-MM-DD");i.has(l)?i.get(l).isWeather=!0:i.set(l,{key:l,date:d,events:[],isToDay:d.isSame(u,"date"),isWeather:!1})}}function Xe(u,i){var t=u.format("YYYY-MM-DD"),d=i.find(function(l){return l.isSelected});if(d){if(d.key===t)return i;d.isTemporary?i.splice(i.findIndex(function(l){return l.isTemporary}),1):i.find(function(l){return l.isSelected}).isSelected=!1}if(i.some(function(l){return l.key===t}))i.find(function(l){return l.key===t}).isSelected=!0;else return i.push({key:t,date:u,events:[],isToDay:u.isSame(x()(),"date"),isWeather:!1,isSelected:!0,isTemporary:!0}),i.sort(function(l,D){return l.date.toDate().getTime()-D.date.toDate().getTime()});return i}function He(u,i){var t=x()(),d=new Map,l=De()(u),D;try{for(l.s();!(D=l.n()).done;){var S=D.value,h=De()(S.dates),T;try{for(h.s();!(T=h.n()).done;){var U=T.value,C=x()(U),N=C.format("YYYY-MM-DD");if(d.has(N)){var L;(L=d.get(N))===null||L===void 0||L.events.push(S)}else d.set(N,{key:N,date:C,isToDay:C.isSame(t,"date"),events:[S],isWeather:!1})}}catch(n){h.e(n)}finally{h.f()}}}catch(n){l.e(n)}finally{l.f()}return ha(t,d),Xe(x()(i),Array.from(d.values()).sort(function(n,m){return n.date.toDate().getTime()-m.date.toDate().getTime()}))}var Je=[];function ga(){var u=(0,B.Dn)(),i=u.data,t=(0,ue.useModel)("calendar",function(v){var ee=v.state;return ee.calendarSet}),d=(0,ue.useModel)("calendar",function(v){return v.state.state==="new"}),l=(0,ue.useModel)("calendar",function(v){var ee=v.state;return ee.selectedDay||new Date}),D=(0,ue.useModel)("calendar",function(v){return v.setSelectedDay}),S=(0,ue.useModel)("calendar",function(v){return v.changeState}),h=(0,ue.useModel)("calendar",function(v){return v.state.fullCalendar}),T=(0,a.useState)(!1),U=F()(T,2),C=U[0],N=U[1],L=(0,a.useRef)(null),n=(0,a.useRef)({selectedDay:l,eventsWithDays:[]}),m=(0,a.useReducer)(function(v){return v+1},0),q=F()(m,2),P=q[1];n.current.calendarSet=t;var I=(0,B.Vk)({fetchPolicy:"cache-and-network"}),p=F()(I,2),o=p[0],H=p[1].refetch,W=(0,a.useCallback)(function(){N(!1)},[]),le=(0,a.useCallback)(function(v){v==="manage-calendars"&&N(!0)},[]),z=(0,a.useCallback)(function(v){v&&D(new Date(v.year,v.month-1,v.day))},[D]),A=(0,a.useCallback)(function(v){return function(){D(n.current.selectedDay=v)}},[D]),Y=(0,a.useCallback)(function(v){if(L.current){var ee=Array.from(document.getElementsByClassName("event-list-item")),ne=ee.find(function(ke){return x()(ke.dataset.date).isSame(x()(v),"date")});if(ne){var me=ne.getBoundingClientRect().top+L.current.scrollTop,se=L.current.getBoundingClientRect();L.current.scrollTo({top:me-se.top-6.5}),n.current.skipNextScroll=!0,setTimeout(function(){clearTimeout(n.current.timer)},120),P()}}},[]);(0,a.useEffect)(function(){o({variables:{date:l,days:60,calendarSet:t==="all"?void 0:t}}).then(function(v){var ee=v.data;n.current.eventsWithDays=He((ee==null?void 0:ee.events)||[],n.current.selectedDay),n.current.toDayOrNextEvent=n.current.eventsWithDays.find(function(ne){return ne.key===x()(n.current.selectedDay).format("YYYY-MM-DD")}),n.current.skipNextScroll=!0,P(),Y(l)})},[t,o]);var oe=(0,a.useCallback)(function(){var v=O()(f()().mark(function ee(ne){var me,se;return f()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return n.current.selectedDay=ne,n.current.eventsWithDays=Xe(x()(ne),n.current.eventsWithDays),n.current.toDayOrNextEvent=n.current.eventsWithDays.find(function(Fe){return Fe.key===x()(ne).format("YYYY-MM-DD")}),n.current.skipNextScroll=!0,P(),ve.next=7,(0,Me._v)(60);case 7:return Y(ne),ve.next=10,(0,Me._v)(60);case 10:if(n.current.selectedDay===ne){ve.next=12;break}return ve.abrupt("return");case 12:return ve.next=14,H({date:ne,days:60,calendarSet:n.current.calendarSet==="all"?void 0:n.current.calendarSet});case 14:return me=ve.sent,se=me.data,n.current.eventsWithDays=He(se.events,n.current.selectedDay),n.current.skipNextScroll=!0,P(),ve.next=21,(0,Me._v)(60);case 21:n.current.selectedDay===ne&&Y(ne);case 22:case"end":return ve.stop()}},ee)}));return function(ee){return v.apply(this,arguments)}}(),[]);(0,a.useEffect)(function(){n.current.selectedDay&&x()(n.current.selectedDay).isSame(l,"date")||n.current.eventsWithDays.length&&oe(l)},[l]);var V=(0,a.useCallback)(function(){if(L.current){if(n.current.skipNextScroll){n.current.skipNextScroll=!1;return}var v=Array.from(document.getElementsByClassName("event-list-item")),ee=L.current.getBoundingClientRect(),ne=v.find(function(se){if(se.dataset.temp==="true")return!1;var ke=se.getBoundingClientRect(),ve=se.getElementsByClassName("event-list")[0].getBoundingClientRect().height,Fe=ke.top-ee.top+ve+16;return Fe>0&&Fe<ke.height});if(ne){var me=n.current.eventsWithDays.find(function(se){return se.key===ne.dataset.date});me&&(n.current.eventsWithDays=n.current.eventsWithDays.filter(function(se){return!se.isTemporary}),n.current.eventsWithDays.forEach(function(se){se.isSelected=!1}),me.isSelected=!0,n.current.skipNextScroll=!0,n.current.toDayOrNextEvent=me,P(),clearTimeout(n.current.timer),n.current.timer=setTimeout(O()(f()().mark(function se(){var ke,ve;return f()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,H({date:me.date.toDate(),days:60,calendarSet:n.current.calendarSet==="all"?void 0:n.current.calendarSet});case 2:ke=w.sent,ve=ke.data,n.current.eventsWithDays=He(ve.events,n.current.selectedDay),n.current.skipNextScroll=!0,P();case 7:case"end":return w.stop()}},se)})),1e3),D(n.current.selectedDay=x()(ne.dataset.date).toDate()))}}},[D]),y=(0,a.useCallback)(function(v){var ee=document.getElementsByClassName("main-calendar")[0];ee==null||ee.focus(),S("none"),console.log("fullCalendar",h==null?void 0:h.getApi()),h==null||h.getApi().refetchEvents(),oe(new Date(v.datetime.starts))},[h,S,oe]),k=n.current,R=k.toDayOrNextEvent,K=k.eventsWithDays,b=K.find(function(v){return v.key===(R==null?void 0:R.key)});return(0,e.jsxs)(X.GP,{width:325,collapsible:!1,resizeable:!0,className:ie()("calendar-sidebar-bg",{"state-new-event":d}),children:[(0,e.jsxs)("div",{className:"calendar-sidebar",children:[(0,e.jsx)(g,{}),(0,e.jsx)(Oe,{visible:d,onSuccess:y,calendarSets:(i==null?void 0:i.calendarSets)||Je}),(0,e.jsx)(de.f,{locale:ma,value:{year:l.getFullYear(),month:l.getMonth()+1,day:l.getDate()},onChange:z,shouldHighlightWeekends:!0,colorPrimary:"#04c8c8"}),(0,e.jsxs)("div",{className:"calendar-day-list",children:[(0,e.jsxs)("div",{className:"event-list-header",children:[(0,e.jsxs)("h6",{children:[b!=null&&b.isToDay?"\u4ECA\u5929":(b==null?void 0:b.date.format("dddd"))||"\u4ECA\u5929",(0,e.jsx)("span",{className:"day-subtitle text-muted",children:(b==null?void 0:b.date.format("YYYY-MM-DD"))||x()().format("YYYY-MM-DD")})]}),!(b!=null&&b.events.length)&&(b==null?void 0:b.isSelected)&&(0,e.jsx)("div",{className:"onday-no-events text-muted",children:"\u6CA1\u6709\u4E8B\u4EF6"})]}),(0,e.jsx)("div",{ref:L,onScrollCapture:V,className:"event-list-body hover-scroll-y",children:K.map(function(v){var ee=v.key,ne=v.date,me=v.isToDay,se=v.events,ke=v.isSelected,ve=v.isTemporary;return(0,e.jsxs)("div",{className:"event-list-item","data-temp":ve,"data-date":ee,children:[(0,e.jsxs)("h6",{onClick:A(ne.toDate()),children:[me?"\u4ECA\u5929":ne.format("dddd"),(0,e.jsx)("span",{className:"day-subtitle text-muted",children:ne.format("YYYY-MM-DD")})]}),(0,e.jsx)("div",{className:ie()("event-list",ce()(ce()({},"is-empty",!se.length),"onday-no-events",!se.length&&ke)),children:se.map(function(Fe){return(0,e.jsx)(s.Popover,{content:(0,e.jsx)("div",{children:"12312313"}),children:(0,e.jsx)("span",{style:{backgroundColor:Fe.color},className:"event-day",children:Fe.title},Fe.id)},Fe.id)})})]},ee)})})]}),(0,e.jsx)(J,{calendarSets:(i==null?void 0:i.calendarSets)||Je,onAction:le})]}),(0,e.jsx)(fa,{visible:C,onCancel:W})]})}var pa=a.memo(ga),Sa=pa},38932:function(We,Pe,r){r.d(Pe,{f:function(){return Ee},y:function(){return f}});var we=r(19755),ce=r.n(we);function Ee(te){var O=parseInt(ce()(te).data("click-number")||0)+1;if(O===2)return clearTimeout(ce()(te).data("timer-reset")),ce()(te).data("click-number",0),!0;var he=setTimeout(function(){ce()(te).data("click-number",0),clearTimeout(he)},500);return ce()(te).data("click-number",O).data("timer-reset",he),!1}function f(te,O,he,F,Ie){var De=te.height/3/2,a=F<De&&F>-De&&(he==null?void 0:he.parentKey)!==O.id;return a?Ie:F>0?Ie+1:F<0?Ie-1:NaN}}}]);
