(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[5867],{89887:function(H,N,a){"use strict";var y=a(64219),s=a(16477),e=a(3182),D=a(2824),j=a(94043),i=a.n(j),c=a(67294),B=a(28865),g=a(94184),p=a.n(g),A=a(30381),v=a.n(A),M=a(43219),d=a(8845),I=a(33442),w=a(23183),n=a(53704),l=a(85893);function m(t){var u=t.article,o=t.categoryTreeData,P=t.onChangeCategory,_=t.baseUrl,T=(0,c.useState)(),E=(0,D.Z)(T,2),C=E[0],O=E[1],U=(0,c.useCallback)(function(x){O(x)},[]),W=(0,c.useCallback)(function(x){return x.isAfter(v()())},[]),f=(0,c.useCallback)(function(x){return{disabledHours:function(){if(!(C||x).isSame(v()(),"days"))return[];for(var h=[],K=v()().hours()+1;K<24;K++)h.push(K);return h},disabledMinutes:function(h){if(!(C||x).isSame(v()(),"days"))return[];if(!x.set("hours",h).isSame(v()(),"hours"))return[];for(var K=[],Y=v()().minutes()+1;Y<60;Y++)K.push(Y);return K}}},[C]),L=(0,d.eU)(),b=(0,D.Z)(L,1),S=b[0],Z=(0,I.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",content:(0,l.jsxs)(l.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,l.jsx)("strong",{children:u==null?void 0:u.title}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})},(0,e.Z)(i().mark(function x(){return i().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,S({variables:{id:u.id}});case 2:case"end":return h.stop()}},x)}))),F=(0,D.Z)(Z,1),R=F[0],z=(0,c.useCallback)((0,e.Z)(i().mark(function x(){return i().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,R();case 2:if(!h.sent){h.next=4;break}M.m8.replace("".concat(_,"/cms/categories/").concat(u.category.id,"/articles"));case 4:case"end":return h.stop()}},x)})),[R,_,u]);return(0,l.jsxs)("div",{className:"d-flex flex-column gap-7 gap-lg-10 w-100 w-lg-300px mb-7",children:[(0,l.jsxs)(n.Zb,{flush:!0,children:[(0,l.jsxs)(n.Zb.Header,{className:"ribbon ribbon-top ribbon-vertical",children:[!!(u!=null&&u.status)&&(u==null?void 0:u.status)!=="DRAFT"&&(0,l.jsx)("div",{className:p()("ribbon-label",{"bg-primary":(u==null?void 0:u.status)=="PUBLISHED","bg-success":(u==null?void 0:u.status)=="SCHEDULED","bg-danger":(u==null?void 0:u.status)=="INACTIVE"}),children:r(u.status)}),(0,l.jsx)(n.Zb.Title,{children:"\u6587\u7AE0\u8BBE\u7F6E"})]}),(0,l.jsxs)(n.Zb.Body,{className:" pt-0",children:[(0,l.jsx)(n.l0.Item,{name:"image",className:"text-center",children:(0,l.jsx)(n.gq.Image,{width:240,height:150,className:"mb-3",space:"Ohc2OaZ4",accept:".png, .jpg, .jpeg",backgroundImage:"/assets/media/svg/files/blank-image.svg"})}),(0,l.jsx)("div",{className:"text-muted fs-7 mb-6",children:"\u8BBE\u7F6E\u6587\u7AE0\u5C01\u9762\u56FE\u3002\u4EC5\u63A5\u53D7 *.png\u3001*.jpg \u548C *.jpeg \u683C\u5F0F\u7684\u56FE\u7247"}),(0,l.jsx)(n.l0.Item,{className:"mb-3",label:"\u6240\u5C5E\u680F\u76EE",name:["category","id"],rules:[{required:!0,message:"\u6240\u5C5E\u680F\u76EE\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,l.jsx)(s.Z,{onChange:P,style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:o,placeholder:"\u9009\u62E9\u680F\u76EE",treeDefaultExpandAll:!0,transitionName:""})}),(0,l.jsx)("div",{className:"text-muted fs-7 mb-6",children:"\u60A8\u7684\u6587\u7AE0\u5FC5\u987B\u53D1\u5E03\u5728\u4E00\u4E2A\u680F\u76EE\u4E2D"}),(0,l.jsx)(n.l0.Item,{name:"publishedAt",label:"\u53D1\u5E03\u65F6\u95F4",className:"mb-6",children:(0,l.jsx)(w.Z,{onChange:U,disabled:(u==null?void 0:u.status)=="SCHEDULED",disabledDate:W,disabledTime:f})}),(0,l.jsx)(n.l0.Item,{name:"summary",label:"\u6458\u8981",className:"mb-6",children:(0,l.jsx)(n.II.TextArea,{autoSize:{minRows:6}})}),(0,l.jsx)(n.l0.Item,{name:"authors",label:"\u4F5C\u8005",children:(0,l.jsx)(n.II,{})})]})]}),u&&(0,l.jsx)(n.Zb,{flush:!0,className:"py-4",children:(0,l.jsxs)(n.Zb.Body,{children:[(0,l.jsx)(n.zx,{onClick:z,className:"mb-3",variantStyle:"light",variant:"danger",icon:(0,l.jsx)(B.JO,{className:"svg-icon-2",name:"Bootstrap/trash"}),children:"\u5220\u9664"}),(0,l.jsx)("div",{className:"text-muted fs-7 mb-6",children:"\u6587\u7AE0\u5220\u9664\u540E\uFF0C\u4E0D\u53EF\u6062\u590D"})]})})]})}function r(t){return t=="PUBLISHED"?"\u5DF2\u53D1\u5E03":t=="SCHEDULED"?"\u8BA1\u5212\u4E2D":"\u5DF2\u5931\u6548"}N.Z=m},23183:function(H,N,a){"use strict";var y=a(39002),s=a(68351),e=a(53400),D=a(41505),j=a(85893);function i(c){var B=c.value,g=c.onChange,p=c.disabled,A=c.disabledDate,v=c.disabledTime;return(0,j.jsxs)("div",{children:[(0,j.jsx)(D.Z,{getPopupContainer:function(d){return d.parentNode},transitionName:"",allowClear:!1,dropdownClassName:"article-publish-dropdown-published-at",placement:"topLeft",value:B,disabled:p,onChange:g,disabledDate:A,style:{width:136}}),(0,j.jsx)(s.Z,{className:"ms-3",style:{width:88},allowClear:!1,getPopupContainer:function(d){return d.parentNode},transitionName:"",placeholder:"",value:B,disabled:p,onChange:g,disabledTime:v,format:"HH:mm",placement:"topLeft"})]})}N.Z=i},33043:function(H,N,a){"use strict";a.d(N,{aE:function(){return j},LQ:function(){return g},SF:function(){return A},H5:function(){return l}});var y=a(5618),s=a(53704),e=a(85893);function D(){return(0,e.jsxs)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:[(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",children:[(0,e.jsx)(s.l0.Item,{name:"subtitle",className:"mb-8 mw-400px",label:"\u526F\u6807\u9898",children:(0,e.jsx)(s.II,{})}),(0,e.jsx)(s.l0.Item,{className:"mb-3",label:"\u6807\u7B7E",name:"tags",children:(0,e.jsx)(y.ZP,{})}),(0,e.jsx)(s.l0.Item,{name:"source",className:"mb-8 mw-400px",label:"\u6765\u6E90",children:(0,e.jsx)(s.II,{})})]}),(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",title:"\u66F4\u591A\u529F\u80FD",bodyClassName:"pt-0",children:[(0,e.jsx)(s.l0.Item,{className:"mb-8",name:"xx",children:(0,e.jsx)(s.XZ,{value:"1",solid:!0,label:"\u542F\u7528\u8BC4\u8BBA"})}),(0,e.jsx)(s.l0.Item,{className:"mb-8",name:"x2",children:(0,e.jsx)(s.XZ,{value:"1",solid:!0,label:"\u5141\u8BB8\u6536\u85CF"})})]}),(0,e.jsx)(s.Zb,{flush:!0,className:"py-4",title:"\u5143\u6570\u636E",bodyClassName:"pt-0",children:"123145"})]})}var j=D,i=a(67294),c=a(28865);function B(m){var r=m.queueUpload,t=(0,i.useCallback)(function(u){var o;(o=r.current)===null||o===void 0||o.browse(u)},[r]);return(0,e.jsxs)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:[(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",children:[(0,e.jsx)(s.l0.Item,{className:"mb-8",name:"title",label:"\u6807\u9898",required:!0,help:"\u6807\u9898\u662F\u5FC5\u9700\u7684",rules:[{required:!0,message:"\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(s.II,{placeholder:"\u6587\u7AE0\u6807\u9898",className:"mw-400px"})}),(0,e.jsx)(s.l0.Item,{name:["body","text"],label:"\u6B63\u6587",help:"\u60A8\u53EF\u4EE5\u9009\u62E9\u9002\u5408\u81EA\u5DF1\u7684\uFF0C\u7F16\u8F91\u65B9\u5F0F",children:(0,e.jsx)(s.Bn,{className:"h-300px"})})]}),(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",title:"\u9644\u4EF6",bodyClassName:"pt-0",children:[(0,e.jsx)(s.l0.Item,{name:"attachments",noStyle:!0,children:(0,e.jsx)(s.gq.Queue,{ref:r,namespace:"email"})}),(0,e.jsx)(s.zx,{variantStyle:"light",variant:"primary",className:"me-3 mt-4",onClick:t,icon:(0,e.jsx)(c.JO,{className:"svg-icon-2",name:"Duotune/com008"}),children:"\u6DFB\u52A0\u9644\u4EF6"})]})]})}var g=B;function p(){return(0,e.jsx)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:(0,e.jsxs)(s.Zb,{flush:!0,className:"py-4",title:"SEO",bodyClassName:"pt-0",children:[(0,e.jsx)(s.l0.Item,{name:["meta","seo","title"],className:"mb-8",label:"\u6807\u9898",help:"\u8BBE\u7F6E\u5143\u6570\u636E\u6807\u9898, \u5EFA\u8BAE\u5173\u952E\u8BCD\u8981\u7B80\u5355, \u51C6\u786E",children:(0,e.jsx)(s.II,{className:"mw-400px"})}),(0,e.jsx)(s.l0.Item,{name:["meta","seo","description"],className:"mb-8",label:"\u63CF\u8FF0",help:"\u8BBE\u7F6E\u5143\u6570\u636E\u63CF\u8FF0, \u4EE5\u63D0\u9AD8\u6392\u540D",children:(0,e.jsx)(s.Bn,{className:"h-300px"})}),(0,e.jsx)(s.l0.Item,{name:["meta","seo","keywords"],label:"\u5173\u952E\u5B57",help:(0,e.jsxs)(e.Fragment,{children:["\u8BBE\u7F6E\u680F\u76EE\u76F8\u5173\u7684\u5173\u952E\u5B57\u5217\u8868\u3002\u901A\u8FC7\u5728\u6BCF\u4E2A\u5173\u952E\u5B57\u4E4B\u95F4\u6DFB\u52A0",(0,e.jsx)("code",{children:","}),"\u6765\u5206\u9694\u5173\u952E\u5B57"]}),children:(0,e.jsx)(y.ZP,{className:"form-control"})})]})})}var A=p,v=a(2824),M=a(30381),d=a.n(M),I=a(23183);function w(m){var r=m.status,t=m.submitting,u=m.onPublish,o=m.publishedAt,P=m.setPublishedAt,_=(0,i.useState)("publish"),T=(0,v.Z)(_,2),E=T[0],C=T[1],O=(0,i.useCallback)(function(b){C(function(S){return S==b.target.value?S:(["schedule","reschedule"].includes(b.target.value)&&o.isBefore(d()())&&P(d()()),b.target.value)})},[o,P]),U=(0,i.useCallback)(function(b){P(b)},[P]),W=(0,i.useCallback)(function(){u(E)},[u,E]);(0,i.useEffect)(function(){r=="DRAFT"?C("publish"):r=="PUBLISHED"?C("update"):r=="SCHEDULED"&&C("reschedule")},[r]);var f=(0,i.useCallback)(function(b){return b.isBefore(d()())&&!b.isSame(d()(),"days")},[]),L=(0,i.useCallback)(function(b){return{disabledHours:function(){if(!o.isSame(d()(),"days"))return[];for(var Z=[],F=0;F<d()().hours();F++)Z.push(F);return Z},disabledMinutes:function(Z){if(!o.isSame(d()(),"days"))return[];if(!b.set("hours",Z).isSame(d()(),"hours"))return[];for(var F=[],R=0;R<d()().minutes();R++)F.push(R);return F}}},[o]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"publish-popover-content",children:(0,e.jsxs)(s.Y8.Group,{value:E,onChange:O,children:[r=="PUBLISHED"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(s.Y8,{className:"align-items-start",solid:!0,inputClassName:"me-3",value:"unpublish",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u53D6\u6D88\u53D1\u5E03"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u5C06\u6587\u7AE0\u8BBE\u7F6E\u4E3A\u8349\u7A3F\u72B6\u6001"})]}),(0,e.jsx)("div",{className:"my-4"}),(0,e.jsxs)(s.Y8,{className:"align-items-start",solid:!0,inputClassName:"me-3",value:"update",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u5DF2\u53D1\u5E03"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u516C\u5F00\u663E\u793A\u8FD9\u7BC7\u6587\u7AE0"})]})]}),r=="SCHEDULED"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(s.Y8,{className:"align-items-start",solid:!0,inputClassName:"me-3",value:"revert_to_draft",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u6062\u590D\u4E3A\u8349\u7A3F"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u4E0D\u518D\u53D1\u5E03"})]}),(0,e.jsx)("div",{className:"my-4"}),(0,e.jsxs)(s.Y8,{solid:!0,className:"align-items-start",inputClassName:"me-3",value:"reschedule",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u5B9A\u65F6\u53D1\u5E03"}),(0,e.jsx)("div",{className:"my-2",children:(0,e.jsx)(I.Z,{disabledDate:f,disabledTime:L,value:o,onChange:U})}),(0,e.jsx)("div",{className:"form-item-help",children:"\u8BBE\u7F6E\u4E00\u4E2A\u65F6\u95F4, \u5C06\u5728\u672A\u6765\u81EA\u52A8\u53D1\u5E03\u3002"})]})]}),r=="DRAFT"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(s.Y8,{className:"align-items-start",solid:!0,inputClassName:"me-3",value:"publish",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u7ACB\u5373\u53D1\u5E03"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u7ACB\u5373\u53D1\u5E03\u6B64\u6587\u7AE0"})]}),(0,e.jsx)("div",{className:"my-4"}),(0,e.jsxs)(s.Y8,{solid:!0,className:"align-items-start",inputClassName:"me-3",value:"schedule",children:[(0,e.jsx)("div",{className:"fw-bolder text-gray-800",children:"\u5B9A\u65F6\u53D1\u5E03"}),(0,e.jsx)("div",{className:"my-2",children:(0,e.jsx)(I.Z,{disabledDate:f,disabledTime:L,value:o,onChange:U})}),(0,e.jsx)("div",{className:"form-item-help",children:"\u8BBE\u7F6E\u4E00\u4E2A\u65F6\u95F4, \u5C06\u5728\u672A\u6765\u81EA\u52A8\u53D1\u5E03\u3002"})]})]})]})}),(0,e.jsx)(s.Z0,{style:"solid"}),(0,e.jsxs)("div",{className:"publish-popover-footer d-flex justify-content-end",children:[(0,e.jsx)(s.zx,{onClick:m.onClose,disabled:t,className:"me-2",variant:"light",children:"\u53D6\u6D88"}),(0,e.jsxs)(s.zx,{loading:t,onClick:W,children:[E=="publish"&&(t?"\u53D1\u5E03\u4E2D...":"\u53D1\u5E03"),E=="schedule"&&(t?"\u5B9A\u65F6\u53D1\u5E03\u4E2D...":"\u5B9A\u65F6\u53D1\u5E03"),E=="update"&&(t?"\u66F4\u65B0\u4E2D...":"\u66F4\u65B0"),E=="unpublish"&&(t?"\u53D6\u6D88\u53D1\u5E03\u4E2D...":"\u53D6\u6D88\u53D1\u5E03"),E=="reschedule"&&(t?"\u66F4\u65B0\u4E2D...":"\u91CD\u8BBE\u53D1\u5E03\u65F6\u95F4"),E=="revert_to_draft"&&(t?"\u53D6\u6D88\u4E2D...":"\u53D6\u6D88\u81EA\u52A8\u53D1\u5E03")]})]})]})}function n(m){var r=m.article,t=m.submitting,u=m.onPublish,o=m.publishedAt,P=m.setPublishedAt,_=m.onCancel,T=(0,i.useState)(!1),E=(0,v.Z)(T,2),C=E[0],O=E[1],U=(0,i.useCallback)(function(){O(!1)},[O]),W=(0,i.useCallback)(function(b){t||O(b)},[t]),f=(r==null?void 0:r.status)||"DRAFT",L=(0,i.useMemo)(function(){return f==="DRAFT"?"\u53D1\u5E03\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F":f==="PUBLISHED"?"\u66F4\u65B0\u6587\u7AE0\u72B6\u6001":f==="SCHEDULED"?"\u9884\u8BA1\u5C06\u5728"+d()(r==null?void 0:r.publishedAt).fromNow()+"\u53D1\u5E03":"\u91CD\u65B0\u53D1\u5E03"},[r==null?void 0:r.publishedAt,f]);return(0,i.useEffect)(function(){!C&&_()},[_,C]),(0,e.jsx)(s.J2,{stopPropagation:!0,visible:C,overlayClassName:"overlay-no-arrow article-publish-dropdown-content",title:L,content:(0,e.jsx)(w,{status:f,submitting:t,onClose:U,onPublish:u,publishedAt:o,setPublishedAt:P}),placement:"top-end",onVisibleChange:W,children:(0,e.jsxs)(s.zx,{className:"pe-2",children:[f==="DRAFT"&&"\u53D1\u5E03",f==="PUBLISHED"&&"\u66F4\u65B0",f==="SCHEDULED"&&"\u66F4\u65B0",(0,e.jsx)(c.JO,{name:"Bootstrap/chevron-down",className:"ms-2 svg-icon-6"})]})})}var l=n},33442:function(H,N,a){"use strict";var y=a(11849),s=a(3182),e=a(94043),D=a.n(e),j=a(67294),i=a(53704),c=a(25496);function B(g,p){var A=(0,j.useRef)(!1),v=(0,j.useCallback)((0,s.Z)(D().mark(function M(){var d,I;return D().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d=g.width,n.next=3,i.u_.confirm((0,y.Z)((0,y.Z)({},g),{},{width:d,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!A.current},preConfirm:function(){var l=(0,s.Z)(D().mark(function r(){var t,u,o;return D().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return A.current=!0,_.prev=1,t=document.querySelector(".swal2-confirm"),t.textContent="\u5220\u9664\u4E2D...",u=document.createElement("span"),u.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),t.appendChild(u),_.next=9,(0,c.gw)(p(),350);case 9:o=_.sent,console.log(o);case 11:return _.prev=11,A.current=!1,_.finish(11);case 14:case"end":return _.stop()}},r,null,[[1,,11,14]])}));function m(){return l.apply(this,arguments)}return m}()}));case 3:if(I=n.sent,I.isConfirmed){n.next=6;break}return n.abrupt("return",!1);case 6:return i.FN.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),n.abrupt("return",!0);case 8:case"end":return n.stop()}},M)})),[p,g]);return[v]}N.Z=B}}]);
