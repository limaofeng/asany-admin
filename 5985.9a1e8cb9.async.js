(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[5985],{48775:function(Te,ge,C){"use strict";C.d(ge,{GP:function(){return Ce.Z},Hk:function(){return z}});var Ce=C(48655),W=C(39981),A=C(67294),pe=C(94184),ie=C.n(pe),p=C(28865),a=C(37334),me=C(2824),xe=C(11849),Q=C(96486),ue=C(85893),ne={aside:{minimize:!1}},ae=A.createContext({state:ne,dispatch:function(){}}),X;(function(G){G.AsideToggle="ASIDE_TOGGLE"})(X||(X={}));function Se(G,de){switch(de.type){case"ASIDE_TOGGLE":return G.aside.minimize=!G.aside.minimize,(0,xe.Z)({},G);default:throw new Error}}var d=function(de){var oe=(0,A.useReducer)(Se,(0,Q.cloneDeep)(ne)),ve=(0,me.Z)(oe,2),he=ve[0],ye=ve[1];return(0,ue.jsx)(ae.Provider,{value:{state:he,dispatch:ye},children:de.children})},e=function(){return(0,A.useContext)(ae)},je=C(53704);function ke(G){var de=G.children,oe=e(),ve=oe.dispatch,he=oe.state.aside.minimize,ye=(0,A.useCallback)(function(){ve({type:X.AsideToggle})},[ve]);return(0,ue.jsxs)("div",{className:ie()("app-aside aside"),children:[(0,ue.jsx)(a.Z,{children:(0,ue.jsx)(Ce.Z,{resizeable:!0,className:"app-sidebar",children:de})}),(0,ue.jsx)(je.zx,{style:{marginBottom:"1.35rem",zIndex:10},onClick:ye,activeColor:"primary",className:ie()("btn-icon bg-body btn-color-gray-700 rounded-2 position-absolute translate-middle start-100 end-0 bottom-0 shadow-sm d-none d-lg-flex",{active:he}),children:(0,ue.jsx)(p.JO,{name:"Duotune/arr063",className:"svg-icon-2 rotate-180"})})]})}var ce=ke;function De(G){var de=G.children,oe=G.className,ve=e(),he=ve.state.aside.minimize;return(0,ue.jsx)("div",{className:ie()("micro-app-container page-full-content",oe,{"aside-minimize":he}),children:de})}function be(G){var de=G.children,oe=G.className;return(0,ue.jsx)(d,{children:(0,ue.jsx)(De,{className:oe,children:de})})}be.Sidebar=ce;var z=be,Fe=C(61997)},84036:function(Te,ge,C){"use strict";C.r(ge),C.d(ge,{default:function(){return da}});var Ce=C(32059),W=C(3182),A=C(2824),pe=C(91220),ie=C(94043),p=C.n(ie),a=C(67294),me=C(49972),xe=C(94184),Q=C.n(xe),ue=C(30381),ne=C.n(ue),ae=C(43219),X=C(36467),Se=C(86582),d=C(53704),e=C(85893);function je(l){var s=l.calendarSets,n=l.onAction,i=(0,ae.tT)("calendar",function(v){return v.state.calendarSet}),t=(0,ae.tT)("calendar",function(v){return v.setCalendarSet}),b=(0,a.useCallback)(function(v){if(v.startsWith("calendar-set-"))t(v.substring("calendar-set-".length));else return n(v),!1;return!0},[n,t]),m=(0,a.useMemo)(function(){return[{value:"calendar-set-all",label:"\u5168\u90E8\u65E5\u5386"}].concat((0,Se.Z)(s.map(function(v){return{value:"calendar-set-".concat(v.id),label:v.name}})),[{type:"separator"},{value:"manage-calendars",label:"\u7BA1\u7406\u65E5\u5386"}])},[s]);return(0,e.jsx)("div",{className:"calendar-sidebar-footer",children:(0,e.jsx)(d.Ph,{onChange:b,placement:"topCenter",value:"calendar-set-".concat(i),options:m})})}var ke=je,ce=C(28865);function De(){var l=(0,a.useRef)(null),s=(0,a.useState)(!1),n=(0,A.Z)(s,2),i=n[0],t=n[1],b=(0,a.useState)(""),m=(0,A.Z)(b,2),v=m[0],j=m[1],F=(0,ae.tT)("calendar",function(f){var u=f.state;return u.selectedDay||new Date}),x=(0,ae.tT)("calendar",function(f){return f.state.state=="new"}),g=(0,ae.tT)("calendar",function(f){return f.changeState}),T=(0,a.useCallback)(function(){var f;(f=l.current)===null||f===void 0||f.focus()},[]),r=(0,a.useCallback)(function(){t(!0)},[]),o=(0,a.useCallback)(function(){var f=document.getElementsByClassName("main-calendar")[0];f==null||f.focus(),g("none"),j(""),t(!1)},[g]),L=(0,a.useCallback)(function(f){f.key=="Escape"&&o()},[o]),k=(0,a.useCallback)(function(f){if(j(f.target.value),!f.target.value){g("none");return}!x&&g("new",F)},[g,x,F]),N=(0,a.useCallback)(function(){var f;(f=l.current)!==null&&f!==void 0&&f.value||o()},[o]);return(0,a.useEffect)(function(){var f;if(!x){j(""),t(!1);return}var u=document.activeElement,Y=!!u&&(u.tagName==="INPUT"||u.tagName==="SELECT"||u.tagName==="TEXTAREA"||u.contentEditable&&u.contentEditable==="true");Y||((f=l.current)===null||f===void 0||f.focus(),j(ne()(F).format("YYYY-MM-DD")))},[x,F]),(0,e.jsxs)("div",{className:Q()("calendar-event-header",{"event-header-state-new":x}),children:[(0,e.jsx)("div",{className:Q()("calendar-event-header-left"),children:(0,e.jsx)(d.II,{onFocus:r,onBlur:N,ref:l,value:v,onChange:k,solid:!0,placeholder:"\u65B0\u5EFA\u65E5\u7A0B",onKeyUp:L})}),(0,e.jsx)("a",{className:Q()("calendar-event-header-right",{"calendar-event-new-icon":!(i||x)}),onClick:i||x?o:T,children:(0,e.jsx)(ce.ZP,{className:Q()({"svg-icon-1":i||x,"svg-icon-2x svg-icon-dark":!(i||x)}),name:i||x?"Duotune/arr088":"Duotune/arr087"})})]})}var be=De,z=C(11849),Fe=C(93224),G=C(94199);function de(l){var s=(0,X.V7)({fetchPolicy:"cache-and-network"}),n=s.data,i=(0,a.useMemo)(function(){return n!=null&&n.calendars?n.calendars.filter(function(t){return t.type==="SUNRISE"}).map(function(t){return(0,z.Z)((0,z.Z)({},t),{},{label:t.name,value:t.id})}):[]},[n==null?void 0:n.calendars]);return(0,e.jsx)(d.Ph,(0,z.Z)((0,z.Z)({},l),{},{options:i,itemRender:function(b,m){var v=b.color,j=(0,e.jsx)("div",{style:{backgroundColor:v,width:12,height:12,marginRight:8,border:"1px solid ".concat((0,G.r5)(v)),borderRadius:6,display:"inline-block"}});return m?(0,e.jsxs)(e.Fragment,{children:[a.cloneElement(j,{style:(0,z.Z)((0,z.Z)({},j.props.style),{},{marginRight:5})}),b.label]}):(0,e.jsxs)(e.Fragment,{children:[j,b.label]})}}))}var oe=de,ve=d.II.TextArea,he=[{label:"\u65E0",value:"none",scope:["all-day","general"],remind:{alert:"NONE"}},{type:"separator",scope:["all-day","general"]},{label:"\u65E5\u7A0B\u5F53\u5929 (\u4E0A\u5348 8:00)",value:"on time of event",scope:["all-day"],remind:{alert:"ON_TIME_OF_EVENT"}},{label:"1 \u5929\u524D (\u4E0A\u5348 8:00)",value:"1 day before 8:00",scope:["all-day"],remind:{alert:"DAYS_BEFORE",times:1}},{label:"2 \u5929\u524D (\u4E0A\u5348 8:00)",value:"2 day before 8:00",scope:["all-day"],remind:{alert:"DAYS_BEFORE",times:2}},{label:"\u65E5\u7A0B\u53D1\u751F\u65F6",value:"at time of event",scope:["general"],remind:{alert:"AT_TIME_OF_EVENT"}},{label:"1 \u5206\u949F\u524D",value:"1 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:1}},{label:"5 \u5206\u949F\u524D",value:"5 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:5}},{label:"10 \u5206\u949F\u524D",value:"10 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:10}},{label:"15 \u5206\u949F\u524D",value:"15 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:15}},{label:"30 \u5206\u949F\u524D",value:"30 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:30}},{label:"45 \u5206\u949F\u524D",value:"45 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:45}},{label:"1 \u5C0F\u65F6\u524D",value:"1 hour before",scope:["general"],remind:{alert:"HOURS_BEFORE",times:1}},{label:"2 \u5C0F\u65F6\u524D",value:"2 hour before",scope:["general"],remind:{alert:"HOURS_BEFORE",times:2}},{label:"1 \u5929\u524D",value:"1 day before",scope:["general"],remind:{alert:"DAYS_BEFORE",times:1}},{label:"2 \u5929\u524D",value:"2 day before",scope:["general"],remind:{alert:"DAYS_BEFORE",times:2}},{type:"separator",scope:["all-day","general"]},{label:"\u81EA\u5B9A\u4E49",value:"custom",scope:[]}];function ye(l){var s=l.visible,n=l.calendarSets,i=l.onSuccess,t=(0,a.useRef)({title:"\u6D4B\u8BD5",allDay:!0,color:"none",alert:"none",starts:"2022-01-19",ends:"2022-01-19"}),b=(0,a.useState)(!1),m=(0,A.Z)(b,2),v=m[0],j=m[1],F=(0,ae.tT)("calendar",function(u){var Y=u.state;return ne()(Y.selectedDay||new Date).format("YYYY-MM-DD")}),x=(0,ae.tT)("calendar",function(u){return u.state.state=="new"}),g=(0,ae.tT)("calendar",function(u){return u.state.calendarSet}),T=(0,X.wO)(),r=(0,A.Z)(T,1),o=r[0];t.current.starts=F,t.current.ends=F;var L=(0,a.useCallback)(function(){j(function(u){return!u})},[]),k=(0,a.useCallback)(function(u){if(u.key=="Escape"){var Y;(Y=document.querySelector(".calendar-event-header input"))===null||Y===void 0||Y.focus()}},[]),N=d.l0.useForm();(0,a.useEffect)(function(){if(!t.current.calendar)if(g=="all")t.current.calendar=null;else{var u,Y;t.current.calendar=(u=n.find(function(Z){return Z.id==g}))===null||u===void 0||(Y=u.defaultCalendar)===null||Y===void 0?void 0:Y.id}N.setFieldsValue(t.current)},[g,n,N]);var f=(0,a.useCallback)(function(){var u=(0,W.Z)(p().mark(function Y(Z){var J,O,E,M,_,R,h;return p().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return O=Z.calendar,E=Z.alert,M=(0,Fe.Z)(Z,["calendar","alert"]),_=(J=he.find(function(B){return B.value==E}))===null||J===void 0?void 0:J.remind,D.next=4,o({variables:{calendar:O,input:(0,z.Z)((0,z.Z)({},M),{},{remind:_||{alert:"NONE"}})}});case 4:R=D.sent,h=R.data,i(h==null?void 0:h.event);case 7:case"end":return D.stop()}},Y)}));return function(Y){return u.apply(this,arguments)}}(),[o,i]);return(0,a.useEffect)(function(){!x||N.setFieldsValue(t.current)},[x,N]),(0,e.jsx)("div",{className:Q()("calendar-new-event-container",{invisible:!s}),children:(0,e.jsx)("div",{className:"calendar-new-event",children:(0,e.jsx)(d.l0,{onFinish:f,form:N,onKeyUp:k,size:"sm",layout:"horizontal",initialValues:t.current,children:(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsx)(d.l0.Item,{name:"title",noStyle:!0,children:(0,e.jsx)(d.II,{size:"sm",solid:!0,placeholder:"\u65B0\u5EFA\u65E5\u7A0B"})})}),(0,e.jsx)("li",{children:(0,e.jsx)(d.l0.Item,{name:"allDay",valuePropName:"checked",label:"\u5168\u5929",children:(0,e.jsx)(d.XZ,{size:"sm"})})}),(0,e.jsx)("li",{children:(0,e.jsx)(d.l0.Item,{noStyle:!0,dependencies:["allDay"],children:function(){return(0,e.jsx)(d.l0.Item,{name:"starts",label:"\u5F00\u59CB\u65F6\u95F4",children:(0,e.jsx)(d.Mt,{solid:!0,size:"sm",timePicker:!N.getFieldValue("allDay"),format:N.getFieldValue("allDay")?"YYYY-MM-DD":"YYYY-MM-DD A HH:mm"})})}})}),(0,e.jsx)("li",{children:(0,e.jsx)(d.l0.Item,{noStyle:!0,dependencies:["allDay","starts"],children:function(){return(0,e.jsx)(d.l0.Item,{name:"ends",label:"\u7ED3\u675F\u65F6\u95F4",children:(0,e.jsx)(d.Mt,{solid:!0,size:"sm",minDate:N.getFieldValue("starts"),timePicker:!N.getFieldValue("allDay"),format:N.getFieldValue("allDay")?"YYYY-MM-DD":"YYYY-MM-DD A HH:mm"})})}})}),(0,e.jsx)("li",{children:(0,e.jsx)(d.l0.Item,{name:"calendar",label:"\u65E5\u5386",children:(0,e.jsx)(oe,{solid:!0})})}),(0,e.jsx)("li",{children:(0,e.jsx)(d.l0.Item,{noStyle:!0,dependencies:["allDay"],children:function(){return(0,e.jsx)(d.l0.Item,{name:"alert",label:"\u63D0\u9192",children:(0,e.jsx)(d.Ph,{size:"sm",solid:!0,options:he.filter(function(Y){return Y.scope.includes(N.getFieldValue("allDay")?"all-day":"general")})})})}})}),(0,e.jsx)("li",{className:Q()({invisible:!v}),children:(0,e.jsx)(d.l0.Item,{noStyle:!0,children:(0,e.jsx)(d.II,{solid:!0,placeholder:"\u8BBE\u7F6E\u94FE\u63A5"})})}),(0,e.jsx)("li",{className:Q()({invisible:!v}),children:(0,e.jsx)(d.l0.Item,{noStyle:!0,children:(0,e.jsx)(ve,{autoSize:!0,solid:!0,placeholder:"\u5907\u6CE8"})})}),(0,e.jsxs)("li",{className:"event-actions",children:[(0,e.jsx)(ce.ZP,{onClick:L,className:"toggle-more svg-icon-1",name:v?"Bootstrap/chevron-compact-up":"Bootstrap/chevron-compact-down"}),(0,e.jsx)(d.l0.Item,{noStyle:!0,dependencies:["title"],children:function(){return(0,e.jsx)(d.zx,{htmlType:"submit",disabled:!N.getFieldValue("title"),className:"event-btn-add rounded-2",children:"\u6DFB\u52A0\u65E5\u7A0B"})}})]})]})})})})}var Oe=ye,Ee=C(22028),Re=C(22527),Ie=C(96486),Ve=C(80256),We=C(69293),Le=a.forwardRef(function(l,s){var n=l.closeDropdown,i=l.onAction,t=l.accounts,b=(0,a.useCallback)(function(m){n(),m.keyPath.startsWith("new-calendar")?i("new",m.key):m.keyPath.startsWith("new-calendar-subscription")&&i("subscribe")},[n,i]);return(0,e.jsxs)(d.v2,{className:"menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-150px py-2",ref:s,dropdown:!0,onSelect:b,selectedKeys:[],children:[(0,e.jsx)(d.v2.SubMenu,{title:"\u65B0\u589E\u65E5\u5386",className:"px-2",bodyClassName:"py-2 w-150px",offset:[-6.5,0],children:t.map(function(m){return(0,e.jsx)(d.v2.Item,{title:m.name,className:"px-2"},m.id)})},"new-calendar"),(0,e.jsx)(d.v2.Separator,{className:"mx-1"}),(0,e.jsx)(d.v2.Item,{className:"px-2",children:"\u65B0\u589E\u65E5\u5386\u8BA2\u9605"},"new-calendar-subscription")]})});function Ue(l){var s=l.onSuccess,n=l.selectedItem,i=l.onEdit,t=(0,X.Bo)(),b=(0,A.Z)(t,1),m=b[0],v=(0,X.Cn)(),j=(0,A.Z)(v,1),F=j[0],x=(0,X.e)({fetchPolicy:"cache-and-network"}),g=x.data,T=(0,a.useMemo)(function(){return g!=null&&g.calendarAccounts?g.calendarAccounts||[]:[]},[g==null?void 0:g.calendarAccounts]),r=(0,a.useCallback)(function(){var k=(0,W.Z)(p().mark(function N(f,u){var Y,Z;return p().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(console.log(f,u),f!="new"){O.next=7;break}return O.next=4,m({variables:{input:{account:u}}});case 4:Y=O.sent,Z=Y.data,s(Z==null?void 0:Z.createCalendar);case 7:case"end":return O.stop()}},N)}));return function(N,f){return k.apply(this,arguments)}}(),[m,s]),o=(0,a.useCallback)(function(){!n||i(n.id,"modal")},[i,n]),L=(0,a.useCallback)((0,W.Z)(p().mark(function k(){var N;return p().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(n){u.next=2;break}return u.abrupt("return");case 2:return u.next=4,d.u_.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u65E5\u5386\u5417\uFF1F",content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u65E5\u5386\u201C<strong>".concat(n.name,"</strong>\u201D\u5417\uFF1F\u8FD9\u4E5F\u5C06\u5220\u9664\u6B64\u65E5\u5386\u4E0A\u7684\u6240\u6709\u4E8B\u4EF6\u3002"),okText:"\u5220 \u9664",cancelClassName:"btn btn-secondary btn-sm",okClassName:"btn btn-danger btn-sm"});case 4:if(N=u.sent,N.isConfirmed){u.next=7;break}return u.abrupt("return");case 7:return u.next=9,F({variables:{id:n.id}});case 9:s();case 10:case"end":return u.stop()}},k)})),[F,n,s]);return(0,e.jsxs)("div",{className:"calendars-footer",children:[(0,e.jsx)(d.Lt,{overlay:(0,e.jsx)(Le,{onAction:r,accounts:T}),placement:"bottomLeft",children:(0,e.jsx)("a",{children:(0,e.jsx)(ce.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})})}),(0,e.jsx)("a",{onClick:L,className:Q()({disabled:!n}),children:(0,e.jsx)(ce.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:o,className:Q()({disabled:!n}),children:(0,e.jsx)(ce.ZP,{name:"Bootstrap/gear-fill",className:"svg-icon-7"})}),(0,e.jsx)(Ke,{})]})}function Ke(){return(0,e.jsx)("div",{})}var ze=Ue,Pe=C(78929),we=C(34155),$e=a.forwardRef(function(l,s){var n=l.data,i=l.onSelect,t=l.onEdit,b=l.onCheck,m=l.editing,v=l.actived,j=l.checked,F=l.drag,x=l.indicator,g=l.onShortcut,T=(0,a.useState)(n.name),r=(0,A.Z)(T,2),o=r[0],L=r[1],k=(0,a.useRef)(null),N=(0,X.wg)(),f=(0,A.Z)(N,1),u=f[0],Y=(0,a.useCallback)(function(){i(n.id)},[n.id,i]),Z=(0,a.useCallback)(function(y){L(y.target.value)},[]),J=(0,a.useMemo)(function(){return(0,Ie.debounce)(function(){var y=(0,W.Z)(p().mark(function D(B){return p().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,u({variables:{id:n.id,input:{name:B}}});case 2:case"end":return c.stop()}},D)}));return function(D){return y.apply(this,arguments)}}(),250)},[u,n.id]),O=(0,a.useCallback)((0,W.Z)(p().mark(function y(){return p().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:t(),n.name!=o&&J(o);case 2:case"end":return B.stop()}},y)})),[n.name,t,J,o]),E=(0,a.useCallback)(function(y,D){if(D){var B;(B=k.current)===null||B===void 0||B.focus(),we.nextTick(function(){var $;($=k.current)===null||$===void 0||$.select()})}else if(y){var w,c,I,K;(w=k.current)===null||w===void 0||(c=w.offsetParent)===null||c===void 0||(I=c.parentElement)===null||I===void 0||(K=I.parentElement)===null||K===void 0||K.focus()}},[]);(0,a.useEffect)(function(){!m||E(v,m)},[v,m,E]);var M=(0,a.useCallback)(function(y){y.stopPropagation(),E(!0)},[E]),_=(0,a.useCallback)(function(y){b(n.id,y.target.checked)},[n,b]),R=(0,a.useCallback)(function(){t(n.id,"modal")},[n.id,t]),h=(0,a.useCallback)(function(){var y=(0,W.Z)(p().mark(function D(B){return p().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:B=="EXIT"?(t(),L(n.name)):B=="ENTER"?(t(),n.name!=o&&J(o)):g(B);case 1:case"end":return c.stop()}},D)}));return function(D){return y.apply(this,arguments)}}(),[n.name,t,g,J,o]);return(0,e.jsxs)(Ee.fQ,{tag:(0,e.jsx)("li",{ref:F(s),onClick:Y,onDoubleClick:R,className:Q()("calendar-list-item",{active:v,editing:m,"indicator-drag-over-bottom":x>0,"indicator-drag-over-top":x<0})}),name:"CALENDAR_PREFERENCES",handler:h,children:[(0,e.jsx)(d.XZ,{style:{backgroundColor:n.color,borderColor:v?(0,G.tG)(n.color,80):(0,G.r5)(n.color)},checked:j,onClick:M,onChange:_,className:"calendar-check",size:"sm"}),(0,e.jsxs)("div",{className:"calendar-list-item-btn",children:[(0,e.jsx)("span",{className:"input-state-view",children:o}),(0,e.jsx)("input",{className:"input-state-edit calendar-name",ref:k,onChange:Z,onBlur:O,value:o}),n._type=="SUBSCRIPTION"&&(0,e.jsx)("span",{className:"calendar-type",children:"\u8BA2\u9605"})]})]})});function He(l){var s=l.refresh,n=l.calendarSet,i=(0,X.wg)(),t=(0,A.Z)(i,1),b=t[0],m=(0,X.wN)(),v=(0,A.Z)(m,1),j=v[0],F=(0,X.DM)(),x=(0,A.Z)(F,1),g=x[0],T=(0,X.V7)({fetchPolicy:"cache-and-network"}),r=T.data,o=T.refetch,L=(0,a.useState)(),k=(0,A.Z)(L,2),N=k[0],f=k[1],u=(0,a.useState)(),Y=(0,A.Z)(u,2),Z=Y[0],J=Y[1],O=(0,a.useState)((n==null?void 0:n.calendars.map(function(S){return S.id}))||[]),E=(0,A.Z)(O,2),M=E[0],_=E[1],R=(0,a.useRef)(null),h=(0,a.useRef)({checkedKeys:[],calendars:[]});h.current.checkedKeys=M,h.current.activeKey=N,h.current.editing=Z,h.current.calendarSet=n,h.current.calendars=(r==null?void 0:r.calendars)||[];var y=(0,a.useCallback)(function(S){S&&f(S),J(void 0),we.nextTick(function(){var U;(U=R.current)===null||U===void 0||U.focus()})},[]),D=(0,a.useCallback)(function(S){S!=h.current.activeKey&&y(S)},[y]),B=(0,a.useCallback)(function(){var S=(0,W.Z)(p().mark(function U(P){var re,V=arguments;return p().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:re=V.length>1&&V[1]!==void 0?V[1]:"modal",P?J({key:P,type:re}):y();case 2:case"end":return te.stop()}},U)}));return function(U){return S.apply(this,arguments)}}(),[y]),w=(0,a.useMemo)(function(){if(!(r!=null&&r.calendars))return[];var S=[],U=(0,pe.Z)(r.calendars),P;try{var re=function(){var H=P.value,te=(0,z.Z)((0,z.Z)({},H),{},{key:H.id,actived:N==H.id,editing:(Z==null?void 0:Z.key)==H.id&&(Z==null?void 0:Z.type)=="inline",checked:M.some(function(le){return le==H.id}),_type:H.type});delete te.type;var Ne=S.find(function(le){return le.id==H.account.id});Ne==null?S.push((0,z.Z)((0,z.Z)({},H.account),{},{calendars:[te]})):Ne.calendars.push(te)};for(U.s();!(P=U.n()).done;)re()}catch(V){U.e(V)}finally{U.f()}return S.sort(function(V,H){return V.index-H.index})},[N,M,r==null?void 0:r.calendars,Z==null?void 0:Z.key,Z==null?void 0:Z.type]),c=(0,a.useCallback)(function(){var S=(0,W.Z)(p().mark(function U(P){return p().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,o();case 2:P&&(f(P.id),J({type:"inline",key:P.id}));case 3:case"end":return V.stop()}},U)}));return function(U){return S.apply(this,arguments)}}(),[o]),I=(0,a.useCallback)(function(){},[]),K=(0,a.useCallback)(function(){var S=(0,W.Z)(p().mark(function U(P){var re,V,H,te;return p().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return re=(0,Pe.y)(P.node._rect,P.node,P.dragNode,P.dropPosition,P.node.index),V=P.node.pos,H=re-Number(V[V.length-1]),te=P.node.index,H==-1?te--:H==1&&te++,le.next=7,b({variables:{id:P.dragNode.key,input:{index:Math.max(te,0)+1}}});case 7:o();case 8:case"end":return le.stop()}},U)}));return function(U){return S.apply(this,arguments)}}(),[o,b]),$=(0,a.useCallback)(function(S){var U;return((U=h.current.editing)===null||U===void 0?void 0:U.key)!=S.id},[]),q=(0,a.useCallback)(function(S){return!isNaN(S.dropPosition)},[]),se=(0,a.useCallback)(function(S){var U=h.current,P=U.calendars,re=U.activeKey,V=P.findIndex(function(H){return H.id==re});S=="PREVIOUS"?y(P[Math.max(V-1,0)].id):S=="NEXT"?f(P[Math.min(V+1,P.length-1)].id):S=="ENTER"?J({key:re,type:"inline"}):S=="EXIT"&&y()},[y]),ee=(0,a.useCallback)(function(){y()},[y]),fe=(0,a.useCallback)(function(){var S=(0,W.Z)(p().mark(function U(P,re){var V,H,te;return p().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(H=(V=h.current.calendarSet)===null||V===void 0?void 0:V.id,te=h.current.checkedKeys,console.log("handleChange",P,re,H),!re){le.next=9;break}return _([].concat((0,Se.Z)(te),[P])),le.next=7,j({variables:{id:P,set:H}});case 7:le.next=12;break;case 9:return _(te.filter(function(oa){return oa!=P})),le.next=12,g({variables:{id:P,set:H}});case 12:s();case 13:case"end":return le.stop()}},U)}));return function(U,P){return S.apply(this,arguments)}}(),[s,j,g]);return(0,a.useEffect)(function(){_((n==null?void 0:n.calendars.map(function(S){return S.id}))||[])},[n==null?void 0:n.calendars]),(0,e.jsxs)(Ee.fQ,{tag:(0,e.jsx)("div",{ref:R,className:Q()("calendar-list",{editing:!!Z})}),handler:se,name:"CALENDAR_PREFERENCES",children:[(0,e.jsxs)("div",{className:"calendar-list-notes",children:["\u201C",n==null?void 0:n.name,"\u201D\u65E5\u5386\u96C6\u7684\u65E5\u5386\u548C\u4EFB\u52A1\u5217\u8868\u3002"]}),(0,e.jsxs)("div",{className:"calendar-list-content",children:[(0,e.jsx)("div",{className:"calendars-header",children:"\u6211\u7684\u65E5\u5386"}),(0,e.jsx)("div",{className:"calendars-body scroll-y",children:w.map(function(S){return(0,e.jsxs)("div",{className:"calendars-group",children:[(0,e.jsx)("div",{className:"calendars-group-header",children:"\u6211\u7684\u65E5\u5386"}),(0,e.jsx)("div",{className:"calendars-group-body",children:(0,e.jsx)(Re.ZP,{onChange:I,tag:"ul",mode:"indicator",onDrop:K,draggable:$,allowDrop:q,className:"calendar-sets-list",items:S.calendars,rerender:!1,itemRender:function(P,re){var V=P.data,H=P.index;return(0,a.createElement)($e,(0,z.Z)((0,z.Z)({},P),{},{ref:re,actived:V.actived,editing:V.editing,checked:V.checked,onCheck:fe,key:V.id,data:V,index:H,onSelect:D,onEdit:B,onShortcut:se}))}})})]},S.id)})}),(0,e.jsx)(ze,{onSuccess:c,selectedItem:h.current.calendars.find(function(S){return S.id==N}),onEdit:B})]}),(0,e.jsx)(Xe,{data:h.current.calendars.find(function(S){return S.id==N}),visible:(Z==null?void 0:Z.type)=="modal",onClose:ee})]})}function Xe(l){var s=l.onClose,n=l.visible,i=l.data,t=(0,X.wg)(),b=(0,A.Z)(t,1),m=b[0],v=d.l0.useForm(),j=(0,a.useState)(i==null?void 0:i.color),F=(0,A.Z)(j,2),x=F[0],g=F[1],T=(0,a.useState)(!1),r=(0,A.Z)(T,2),o=r[0],L=r[1],k=(0,a.useRef)(null),N=(0,a.useRef)(null),f=(0,a.useMemo)(function(){return[{value:"#ff3d33",label:"\u7EA2\u8272"},{value:"#fc8328",label:"\u6A59\u8272"},{value:"#ffcc00",label:"\u9EC4\u8272"},{value:"#63da38",label:"\u7EFF\u8272"},{value:"#1badf8",label:"\u84DD\u8272"},{value:"#cc73e1",label:"\u7D2B\u8272"},{value:"#a67a63",label:"\u68D5\u8272"},{type:"separator"},{value:"other",label:"\u5176\u4ED6"}]},[]),u=(0,a.useMemo)(function(){return x&&f.some(function(E){return E.value==x})?x:"other"},[f,x]);(0,a.useEffect)(function(){var E;!n||(g(i==null?void 0:i.color),v.setFieldsValue(i),(E=k.current)===null||E===void 0||E.focus(),we.nextTick(function(){var M;(M=k.current)===null||M===void 0||M.select()}))},[n]),(0,We.Z)(N,function(){L(!1)});var Y=(0,a.useCallback)(function(E){E=="other"?L(!0):g(E)},[g]),Z=(0,a.useCallback)((0,W.Z)(p().mark(function E(){var M;return p().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return M=v.getFieldsValue(),R.next=3,m({variables:{id:i.id,input:(0,z.Z)({color:x},M)}});case 3:s();case 4:case"end":return R.stop()}},E)})),[x,i,v,s,m]),J=(0,a.useCallback)(function(){s(),L(!1)},[s]),O=(0,a.useCallback)(function(E){var M=E.hex;g(M)},[]);return(0,e.jsx)(d.u_,{centered:!0,visible:n,dialogClassName:"modal-dialog-concise-style w-400px",onCancel:J,onOk:Z,header:!1,closable:!1,okButtonProps:{className:"btn-xs"},cancelButtonProps:{className:"btn-xs"},children:(0,e.jsxs)(d.l0,{form:v,layout:"horizontal",initialValues:(0,z.Z)({},i),size:"xs",children:[(0,e.jsxs)("div",{className:"d-flex flex-row flex-center",children:[(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(d.l0.Item,{name:"name",label:"\u540D\u79F0",children:(0,e.jsx)(d.II,{ref:k,className:"calendar-name"})})}),(0,e.jsx)("div",{className:"d-flex flex-column-auto flex-center",children:(0,e.jsxs)("div",{className:"asany-form-item",children:[(0,e.jsx)(d.Ph,{value:u,size:"xs",onChange:Y,placement:"bottomCenter",itemRender:function(M,_){var R=M.value=="other"?x||(i==null?void 0:i.color):M.value;if(!R)return(0,e.jsx)(e.Fragment,{});var h=(0,e.jsx)("div",{style:{backgroundColor:R,width:20,height:14,marginRight:8,border:"1px solid ".concat((0,G.r5)(R)),display:"inline-block"}});return _?a.cloneElement(h,{style:(0,z.Z)((0,z.Z)({},h.props.style),{},{marginRight:5})}):(0,e.jsxs)(e.Fragment,{children:[h,M.label]})},options:f}),(0,e.jsx)(d.J2,{visible:o,overlayClassName:"popover-content-body",content:(0,e.jsx)("div",{ref:N,children:(0,e.jsx)(Ve.xS,{presetColors:f.filter(function(E){return E.value!="other"&&E.type!="separator"}).map(function(E){return{color:E.value,title:E.label}}),color:x,onChangeComplete:O,onChange:O,width:"220px"})}),children:(0,e.jsx)("div",{})})]})})]}),(i==null?void 0:i.type)=="SUBSCRIPTION"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(d.l0.Item,{name:"url",label:"\u5730\u5740",children:(0,e.jsx)(d.II,{})})}),(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(d.l0.Item,{name:"refresh",label:"\u5237\u65B0",children:(0,e.jsx)(d.Ph,{className:"w-100px",placement:"bottomCenter",options:[{value:"NEVER",label:"\u4ECE\u4E0D"},{value:"EVERY_5_MINUTES",label:"\u6BCF5\u5206\u949F"},{value:"EVERY_15_MINUTES",label:"\u6BCF15\u5206\u949F"},{value:"EVERY_HOVER",label:"\u6BCF\u5C0F\u65F6"},{value:"EVERY_DAY",label:"\u6BCF\u5929"},{value:"EVERY_WEEK",label:"\u6BCF\u5468"}]})})})]}),(0,e.jsxs)("div",{className:"d-flex flex-row flex-center",children:[(0,e.jsx)("div",{className:"d-flex flex-column-auto flex-center",style:{width:56}}),(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(d.l0.Item,{name:"ignoreAlerts",valuePropName:"checked",children:(0,e.jsx)(d.XZ,{label:"\u5FFD\u7565\u63D0\u9192"})})})]})]})})}var Je=He;function Qe(l){var s=l.onSuccess,n=l.selectedKey,i=(0,X.Xy)(),t=(0,A.Z)(i,1),b=t[0],m=(0,X.yM)(),v=(0,A.Z)(m,1),j=v[0],F=(0,a.useCallback)((0,W.Z)(p().mark(function g(){var T,r;return p().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,b();case 2:T=L.sent,r=T.data,s(r==null?void 0:r.createCalendarSet);case 5:case"end":return L.stop()}},g)})),[b,s]),x=(0,a.useCallback)((0,W.Z)(p().mark(function g(){return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,j({variables:{id:n}});case 2:s();case 3:case"end":return r.stop()}},g)})),[j,n,s]);return(0,e.jsxs)("div",{className:"calendar-sets-footer",children:[(0,e.jsx)("a",{onClick:F,children:(0,e.jsx)(ce.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:x,children:(0,e.jsx)(ce.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})})]})}var Ge=Qe,Ae=C(34155),qe=a.forwardRef(function(l,s){var n=l.data,i=l.editing,t=l.actived,b=l.onSelect,m=l.onEdit,v=l.drag,j=l.indicator,F=(0,X.f4)(),x=(0,A.Z)(F,1),g=x[0],T=(0,a.useState)(n.name),r=(0,A.Z)(T,2),o=r[0],L=r[1],k=(0,a.useRef)(null),N=(0,a.useCallback)(function(){b(n.id)},[n.id,b]),f=(0,a.useCallback)(function(){m(n.id)},[n.id,m]),u=(0,a.useMemo)(function(){return(0,Ie.debounce)(function(){var O=(0,W.Z)(p().mark(function E(M){return p().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,g({variables:{id:n.id,input:{name:M}}});case 2:case"end":return R.stop()}},E)}));return function(E){return O.apply(this,arguments)}}(),250)},[g,n.id]),Y=(0,a.useCallback)((0,W.Z)(p().mark(function O(){return p().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(m(),n.name==o){M.next=4;break}return M.next=4,u(o);case 4:case"end":return M.stop()}},O)})),[n.name,m,u,o]),Z=(0,a.useCallback)(function(O){L(O.target.value)},[]);(0,a.useEffect)(function(){var O;!i||((O=k.current)===null||O===void 0||O.focus(),Ae.nextTick(function(){var E;(E=k.current)===null||E===void 0||E.select()}))},[i]);var J=(0,a.useCallback)(function(){var O=(0,W.Z)(p().mark(function E(M){return p().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(M!="EXIT"){R.next=5;break}m(),L(n.name),R.next=10;break;case 5:if(M!="ENTER"){R.next=10;break}if(m(),n.name==o){R.next=10;break}return R.next=10,u(o);case 10:case"end":return R.stop()}},E)}));return function(E){return O.apply(this,arguments)}}(),[n.name,m,u,o]);return(0,e.jsx)(Ee.fQ,{tag:(0,e.jsx)("li",{ref:v(s),onClick:N,onDoubleClick:f,className:Q()("calendarset-item",{active:t,"indicator-drag-over-bottom":j>0,"indicator-drag-over-top":j<0})}),name:"CALENDAR_PREFERENCES",handler:J,children:(0,e.jsxs)("div",{className:"calendarset-item-btn",children:[(0,e.jsx)("span",{className:"input-state-view",children:o}),(0,e.jsx)("input",{className:"input-state-edit",ref:k,onChange:Z,onBlur:Y,value:o})]})})});function _e(l){var s=l.data,n=s===void 0?[]:s,i=l.refresh,t=l.onSelect,b=(0,X.f4)(),m=(0,A.Z)(b,1),v=m[0],j=(0,ae.tT)("calendar",function(h){return h.state.calendarSet}),F=(0,a.useRef)(null),x=(0,a.useRef)({calendarSets:[]}),g=(0,a.useState)(),T=(0,A.Z)(g,2),r=T[0],o=T[1],L=(0,a.useState)(),k=(0,A.Z)(L,2),N=k[0],f=k[1];x.current.activeKey=r,x.current.editing=N,x.current.calendarSets=n;var u=(0,a.useCallback)(function(h){h!=x.current.activeKey&&(o(h),Ae.nextTick(function(){var y;(y=F.current)===null||y===void 0||y.focus()}))},[]),Y=(0,a.useCallback)(function(){var h=(0,W.Z)(p().mark(function y(D){return p().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,i();case 2:D?(o(D.id),f(D.id)):n.length&&o(n[0].id);case 3:case"end":return w.stop()}},y)}));return function(y){return h.apply(this,arguments)}}(),[n,i]),Z=(0,a.useCallback)(function(){var h=(0,W.Z)(p().mark(function y(D){return p().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:f(D),D||Ae.nextTick(function(){var c;(c=F.current)===null||c===void 0||c.focus()});case 2:case"end":return w.stop()}},y)}));return function(y){return h.apply(this,arguments)}}(),[]);(0,a.useEffect)(function(){if(!!n.length&&!n.some(function(y){return y.id==r})){var h=j=="all"?n[0].id:String(j);o(h)}},[r,n,j]),(0,a.useEffect)(function(){!r||t(r)},[r,t]);var J=(0,a.useCallback)(function(h){var y=x.current,D=y.calendarSets,B=y.activeKey,w=D.findIndex(function(c){return c.id==B});h=="PREVIOUS"?o(D[Math.max(w-1,0)].id):h=="NEXT"?o(D[Math.min(w+1,D.length-1)].id):h=="ENTER"?f(r):h=="EXIT"&&f(void 0)},[r]),O=(0,a.useCallback)(function(){},[]),E=(0,a.useMemo)(function(){return n.map(function(h){return(0,z.Z)((0,z.Z)({},h),{},{key:h.id,actived:r==h.id,editing:N==h.id})})},[r,n,N]),M=(0,a.useCallback)(function(){var h=(0,W.Z)(p().mark(function y(D){var B,w,c,I;return p().wrap(function($){for(;;)switch($.prev=$.next){case 0:return B=(0,Pe.y)(D.node._rect,D.node,D.dragNode,D.dropPosition,D.node.index),w=D.node.pos,c=B-Number(w[w.length-1]),I=D.node.index,c==-1?I--:c==1&&I++,$.next=7,v({variables:{id:D.dragNode.key,input:{index:Math.max(I,0)+1}}});case 7:i();case 8:case"end":return $.stop()}},y)}));return function(y){return h.apply(this,arguments)}}(),[i,v]),_=(0,a.useCallback)(function(h){return x.current.editing!=h.id},[]),R=(0,a.useCallback)(function(h){return!isNaN(h.dropPosition)},[]);return(0,e.jsxs)(Ee.fQ,{tag:(0,e.jsx)("div",{ref:F,className:Q()("flex-left calendar-sets",{editing:!!N})}),name:"CALENDAR_PREFERENCES",handler:J,children:[(0,e.jsx)("div",{className:"calendar-sets-header",children:"\u65E5\u5386\u96C6"}),(0,e.jsx)("div",{className:"calendar-sets-body scroll-y",children:(0,e.jsx)(Re.ZP,{onChange:O,tag:"ul",mode:"indicator",draggable:_,onDrop:M,allowDrop:R,className:"calendar-sets-list",items:E,rerender:!1,itemRender:function(y,D){var B=y.data,w=y.index;return(0,a.createElement)(qe,(0,z.Z)((0,z.Z)({},y),{},{ref:D,actived:B.actived,editing:B.editing,key:B.id,data:B,index:w,onSelect:u,onEdit:Z}))}})}),(0,e.jsx)(Ge,{onSuccess:Y,selectedKey:r})]})}var ea=_e;function aa(){var l,s=(0,X.f4)(),n=(0,A.Z)(s,1),i=n[0],t=(0,X.Dn)({fetchPolicy:"cache-and-network"}),b=t.data,m=t.refetch,v=b==null?void 0:b.calendarSets,j=d.l0.useForm(),F=(0,a.useState)(),x=(0,A.Z)(F,2),g=x[0],T=x[1],r=(0,a.useCallback)(function(k){T(k)},[]),o=(v||[]).find(function(k){return k.id==g});(0,a.useEffect)(function(){var k;j.setFieldsValue({defaultCalendar:o==null||(k=o.defaultCalendar)===null||k===void 0?void 0:k.id})},[o,j]);var L=(0,a.useCallback)((0,W.Z)(p().mark(function k(){var N;return p().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(N=j.getFieldsValue(),o){u.next=3;break}return u.abrupt("return");case 3:return console.log("handleChange calendarSet",N),u.next=6,i({variables:{id:o.id,input:N}});case 6:case"end":return u.stop()}},k)})),[o,j,i]);return(0,e.jsxs)("div",{className:"settings-calendars",children:[(0,e.jsx)("div",{className:"settings-calendars-notes",children:"\u901A\u8FC7\u521B\u5EFA\u591A\u4E2A\u65E5\u5386\u96C6\u5FEB\u901F\u66F4\u6539\u663E\u793A\u7684\u65E5\u5386\u548C\u4EFB\u52A1\u5217\u8868\u3002\u4F8B\u5982\uFF0C\u60A8\u53EF\u80FD\u6709\u5355\u72EC\u7684\u5BB6\u5EAD\u548C\u5DE5\u4F5C\u65E5\u5386\u96C6\u3002"}),(0,e.jsxs)("div",{className:"d-flex",children:[(0,e.jsx)(ea,{onSelect:r,data:v,refresh:m}),(0,e.jsxs)("div",{className:"settings-calendars-right flex-root",children:[(0,e.jsx)(Je,{refresh:m,calendarSet:o}),(0,e.jsx)("div",{className:"calendar-sets-settings",children:(0,e.jsx)(d.l0,{form:j,layout:"horizontal",size:"xs",initialValues:{defaultCalendar:o==null||(l=o.defaultCalendar)===null||l===void 0?void 0:l.id},onFieldsChange:L,children:(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(d.l0.Item,{name:"defaultCalendar",label:"\u9ED8\u8BA4\u65E5\u5386",children:(0,e.jsx)(oe,{solid:!0})})})})})]})]})]})}var na=aa;function ra(l){var s=l.visible,n=l.onCancel,i=(0,a.useState)(!1),t=(0,A.Z)(i,2),b=t[0],m=t[1],v=(0,a.useState)("calendars"),j=(0,A.Z)(v,2),F=j[0],x=j[1],g=(0,a.useCallback)(function(){m(!0)},[]),T=(0,a.useCallback)(function(r){x(r)},[]);return(0,e.jsx)(d.u_,{centered:!0,maskClosable:!1,visible:s,onCancel:n,onOk:g,scroll:!1,confirmLoading:b,dialogClassName:"mw-750px calendar-preferences",header:(0,e.jsx)(d.u_.Header,{children:(0,e.jsxs)(d.JL,{onSelect:T,selectedKey:F,children:[(0,e.jsx)(d.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(d.JL.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(ce.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u5E38\u89C4"})})]})},"general"),(0,e.jsx)(d.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(d.JL.Link,{className:"btn d-flex flex-column btn-active-light-success",children:[(0,e.jsx)(ce.ZP,{name:"Duotune/gen014",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u65E5\u5386"})})]})},"calendars"),(0,e.jsx)(d.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(d.JL.Link,{className:"btn d-flex flex-column btn-active-light-info",children:[(0,e.jsx)(ce.ZP,{name:"Duotune/fil020",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u5929\u6C14"})})]})},"weather")]})}),footer:!1,children:(0,e.jsx)(na,{})})}var ta=ra,la=C(48775),Ze=C(25496),sa={months:["1 \u6708","2 \u6708","3 \u6708","4 \u6708","5 \u6708","6 \u6708","7 \u6708","8 \u6708","9 \u6708","10 \u6708","11 \u6708","12 \u6708"],weekDays:[{name:"\u661F\u671F\u5929",short:"\u5468\u65E5",isWeekend:!0},{name:"\u661F\u671F\u4E00",short:"\u5468\u4E00"},{name:"\u661F\u671F\u4E8C",short:"\u5468\u4E8C"},{name:"\u661F\u671F\u4E09",short:"\u5468\u4E09"},{name:"\u661F\u671F\u56DB",short:"\u5468\u56DB"},{name:"\u661F\u671F\u4E94",short:"\u5468\u4E94"},{name:"\u661F\u671F\u516D",short:"\u5468\u516D",isWeekend:!0}],weekStartingIndex:0,getToday:function(s){return s},toNativeDate:function(s){return new Date(s.year,s.month-1,s.day)},getMonthLength:function(s){return new Date(s.year,s.month,0).getDate()},transformDigit:function(s){return s},nextMonth:"Next Month",previousMonth:"Previous Month",openMonthSelector:"Open Month Selector",openYearSelector:"Open Year Selector",closeMonthSelector:"Close Month Selector",closeYearSelector:"Close Year Selector",defaultPlaceholder:"Select...",from:"from",to:"to",digitSeparator:",",yearLetterSkip:0,isRtl:!1};function ia(l,s){for(var n=0;n<7;n++){var i=l.clone().add(n,"days"),t=i.format("YYYY-MM-DD");s.has(t)?s.get(t).isWeather=!0:s.set(t,{key:t,date:i,events:[],isToDay:i.isSame(l,"date"),isWeather:!1})}}function Ye(l,s){var n=l.format("YYYY-MM-DD"),i=s.find(function(t){return t.isSelected});if(i){if(i.key==n)return s;i.isTemporary?s.splice(s.findIndex(function(t){return t.isTemporary}),1):s.find(function(t){return t.isSelected}).isSelected=!1}if(s.some(function(t){return t.key==n}))s.find(function(t){return t.key==n}).isSelected=!0;else return s.push({key:n,date:l,events:[],isToDay:l.isSame(ne()(),"date"),isWeather:!1,isSelected:!0,isTemporary:!0}),s.sort(function(t,b){return t.date.toDate().getTime()-b.date.toDate().getTime()});return s}function Me(l,s){var n=ne()(),i=new Map,t=(0,pe.Z)(l),b;try{for(t.s();!(b=t.n()).done;){var m=b.value,v=(0,pe.Z)(m.dates),j;try{for(v.s();!(j=v.n()).done;){var F=j.value,x=ne()(F),g=x.format("YYYY-MM-DD");if(i.has(g)){var T;(T=i.get(g))===null||T===void 0||T.events.push(m)}else i.set(g,{key:g,date:x,isToDay:x.isSame(n,"date"),events:[m],isWeather:!1})}}catch(r){v.e(r)}finally{v.f()}}}catch(r){t.e(r)}finally{t.f()}return ia(n,i),Ye(ne()(s),Array.from(i.values()).sort(function(r,o){return r.date.toDate().getTime()-o.date.toDate().getTime()}))}var Be=[];function ua(){var l=(0,X.Dn)(),s=l.data,n=(0,ae.tT)("calendar",function(c){var I=c.state;return I.calendarSet}),i=(0,ae.tT)("calendar",function(c){return c.state.state=="new"}),t=(0,ae.tT)("calendar",function(c){var I=c.state;return I.selectedDay||new Date}),b=(0,ae.tT)("calendar",function(c){return c.setSelectedDay}),m=(0,ae.tT)("calendar",function(c){return c.changeState}),v=(0,ae.tT)("calendar",function(c){return c.state.fullCalendar}),j=(0,a.useState)(!1),F=(0,A.Z)(j,2),x=F[0],g=F[1],T=(0,a.useRef)(null),r=(0,a.useRef)({selectedDay:t,eventsWithDays:[]}),o=(0,a.useReducer)(function(c){return c+1},0),L=(0,A.Z)(o,2),k=L[1];r.current.calendarSet=n;var N=(0,X.Vk)({fetchPolicy:"cache-and-network"}),f=(0,A.Z)(N,2),u=f[0],Y=f[1].refetch,Z=(0,a.useCallback)(function(){g(!1)},[]),J=(0,a.useCallback)(function(c){c==="manage-calendars"&&g(!0)},[]),O=(0,a.useCallback)(function(c){c&&b(new Date(c.year,c.month-1,c.day))},[b]),E=(0,a.useCallback)(function(c){return function(){b(r.current.selectedDay=c)}},[b]),M=(0,a.useCallback)(function(c){if(!!T.current){var I=Array.from(document.getElementsByClassName("event-list-item")),K=I.find(function(se){return ne()(se.dataset.date).isSame(ne()(c),"date")});if(!!K){var $=K.getBoundingClientRect().top+T.current.scrollTop,q=T.current.getBoundingClientRect();T.current.scrollTo({top:$-q.top-6.5}),r.current.skipNextScroll=!0,setTimeout(function(){clearTimeout(r.current.timer)},120),k()}}},[]);(0,a.useEffect)(function(){u({variables:{date:t,days:60,calendarSet:n=="all"?void 0:n}}).then(function(c){var I=c.data;r.current.eventsWithDays=Me((I==null?void 0:I.events)||[],r.current.selectedDay),r.current.toDayOrNextEvent=r.current.eventsWithDays.find(function(K){return K.key==ne()(r.current.selectedDay).format("YYYY-MM-DD")}),r.current.skipNextScroll=!0,k(),M(t)})},[n,u]);var _=(0,a.useCallback)(function(){var c=(0,W.Z)(p().mark(function I(K){var $,q;return p().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return r.current.selectedDay=K,r.current.eventsWithDays=Ye(ne()(K),r.current.eventsWithDays),r.current.toDayOrNextEvent=r.current.eventsWithDays.find(function(fe){return fe.key==ne()(K).format("YYYY-MM-DD")}),r.current.skipNextScroll=!0,k(),ee.next=7,(0,Ze._v)(60);case 7:return M(K),ee.next=10,(0,Ze._v)(60);case 10:if(r.current.selectedDay==K){ee.next=12;break}return ee.abrupt("return");case 12:return ee.next=14,Y({date:K,days:60,calendarSet:r.current.calendarSet=="all"?void 0:r.current.calendarSet});case 14:return $=ee.sent,q=$.data,r.current.eventsWithDays=Me(q.events,r.current.selectedDay),r.current.skipNextScroll=!0,k(),ee.next=21,(0,Ze._v)(60);case 21:r.current.selectedDay==K&&M(K);case 22:case"end":return ee.stop()}},I)}));return function(I){return c.apply(this,arguments)}}(),[]);(0,a.useEffect)(function(){r.current.selectedDay&&ne()(r.current.selectedDay).isSame(t,"date")||!r.current.eventsWithDays.length||_(t)},[t]);var R=(0,a.useCallback)(function(){if(!!T.current){if(r.current.skipNextScroll){r.current.skipNextScroll=!1;return}var c=Array.from(document.getElementsByClassName("event-list-item")),I=T.current.getBoundingClientRect(),K=c.find(function(q){if(q.dataset.temp=="true")return!1;var se=q.getBoundingClientRect(),ee=q.getElementsByClassName("event-list")[0].getBoundingClientRect().height,fe=se.top-I.top+ee+16;return fe>0&&fe<se.height});if(!!K){var $=r.current.eventsWithDays.find(function(q){return q.key==K.dataset.date});!$||(r.current.eventsWithDays=r.current.eventsWithDays.filter(function(q){return!q.isTemporary}),r.current.eventsWithDays.forEach(function(q){q.isSelected=!1}),$.isSelected=!0,r.current.skipNextScroll=!0,r.current.toDayOrNextEvent=$,k(),clearTimeout(r.current.timer),r.current.timer=setTimeout((0,W.Z)(p().mark(function q(){var se,ee;return p().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,Y({date:$.date.toDate(),days:60,calendarSet:r.current.calendarSet=="all"?void 0:r.current.calendarSet});case 2:se=S.sent,ee=se.data,r.current.eventsWithDays=Me(ee.events,r.current.selectedDay),r.current.skipNextScroll=!0,k();case 7:case"end":return S.stop()}},q)})),1e3),b(r.current.selectedDay=ne()(K.dataset.date).toDate()))}}},[b]),h=(0,a.useCallback)(function(c){var I=document.getElementsByClassName("main-calendar")[0];I==null||I.focus(),m("none"),console.log("fullCalendar",v==null?void 0:v.getApi()),v==null||v.getApi().refetchEvents(),_(new Date(c.datetime.starts))},[v,m,_]),y=r.current,D=y.toDayOrNextEvent,B=y.eventsWithDays,w=B.find(function(c){return c.key==(D==null?void 0:D.key)});return(0,e.jsxs)(la.GP,{width:325,collapsible:!1,resizeable:!0,className:Q()("calendar-sidebar-bg",{"state-new-event":i}),children:[(0,e.jsxs)("div",{className:"calendar-sidebar",children:[(0,e.jsx)(be,{}),(0,e.jsx)(Oe,{visible:i,onSuccess:h,calendarSets:(s==null?void 0:s.calendarSets)||Be}),(0,e.jsx)(me.f,{locale:sa,value:{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()},onChange:O,shouldHighlightWeekends:!0,colorPrimary:"#04c8c8"}),(0,e.jsxs)("div",{className:"calendar-day-list",children:[(0,e.jsxs)("div",{className:"event-list-header",children:[(0,e.jsxs)("h6",{children:[w!=null&&w.isToDay?"\u4ECA\u5929":(w==null?void 0:w.date.format("dddd"))||"\u4ECA\u5929",(0,e.jsx)("span",{className:"day-subtitle text-muted",children:(w==null?void 0:w.date.format("YYYY-MM-DD"))||ne()().format("YYYY-MM-DD")})]}),!(w!=null&&w.events.length)&&(w==null?void 0:w.isSelected)&&(0,e.jsx)("div",{className:"onday-no-events text-muted",children:"\u6CA1\u6709\u4E8B\u4EF6"})]}),(0,e.jsx)("div",{ref:T,onScrollCapture:R,className:"event-list-body hover-scroll-y",children:B.map(function(c){var I,K=c.key,$=c.date,q=c.isToDay,se=c.events,ee=c.isSelected,fe=c.isTemporary;return(0,e.jsxs)("div",{className:"event-list-item","data-temp":fe,"data-date":K,children:[(0,e.jsxs)("h6",{onClick:E($.toDate()),children:[q?"\u4ECA\u5929":$.format("dddd"),(0,e.jsx)("span",{className:"day-subtitle text-muted",children:$.format("YYYY-MM-DD")})]}),(0,e.jsx)("div",{className:Q()("event-list",(I={},(0,Ce.Z)(I,"is-empty",!se.length),(0,Ce.Z)(I,"onday-no-events",!se.length&&ee),I)),children:se.map(function(S){return(0,e.jsx)(d.J2,{content:(0,e.jsx)("div",{children:"12312313"}),children:(0,e.jsx)("span",{style:{backgroundColor:S.color},className:"event-day",children:S.title},S.id)},S.id)})})]},K)})})]}),(0,e.jsx)(ke,{calendarSets:(s==null?void 0:s.calendarSets)||Be,onAction:J})]}),(0,e.jsx)(ta,{visible:x,onCancel:Z})]})}var ca=a.memo(ua),da=ca},78929:function(Te,ge,C){"use strict";C.d(ge,{f:function(){return A},y:function(){return pe}});var Ce=C(19755),W=C.n(Ce);function A(ie){var p=parseInt(W()(ie).data("click-number")||0)+1;if(p==2)return clearTimeout(W()(ie).data("timer-reset")),W()(ie).data("click-number",0),!0;var a=setTimeout(function(){W()(ie).data("click-number",0),clearTimeout(a)},500);return W()(ie).data("click-number",p).data("timer-reset",a),!1}function pe(ie,p,a,me,xe){var Q=ie.height/3/2,ue=me<Q&&me>-Q&&(a==null?void 0:a.parentKey)!==p.id;return ue?xe:me>0?xe+1:me<0?xe-1:NaN}}}]);
