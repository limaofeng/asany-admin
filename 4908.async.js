"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4908],{97294:function(S,p,e){var B=e(97857),f=e.n(B),A=e(5574),R=e.n(A),x=e(52677),I=e.n(x),t=e(62435),C=e(59197),T=e(93967),g=e.n(T),o=e(10811),P=e(8606),L=e(12708),a=e(86074),j=function(s){return s!=null&&s.url?s.url:I()(s==null?void 0:s.image)==="object"?"https://api.asany.cn"+"/preview/".concat(s.image.id):typeof(s==null?void 0:s.image)=="string"?"https://api.asany.cn"+"/preview/".concat(s.image):""};function y(n){var s=n.value,D=n.onChange,r=(0,t.useRef)({value:[],visible:!1}),U=(0,t.useReducer)(function(_){return _+1},0),E=R()(U,2),h=E[1];(0,L.KW)(function(){console.log("value",s),r.current.value=(s||[]).map(function(_){return{id:_.id,title:_.title,description:_.description,image:_.image,url:_.url,data_state:"edit"}}),h()},[s]);var m=(0,t.useCallback)(function(_){console.log("handleChange",_),D&&D(_)},[]),F=(0,t.useCallback)(function(_){r.current.value=_.map(function(u){return{id:u.id,title:u.title,description:u.description,image:u.image,url:u.url,data_state:u.data_state}}),m(r.current.value)},[]),v=(0,t.useCallback)(function(_){r.current.visible=_,h()},[]),b=(0,t.useCallback)(function(_){_.preventDefault(),_.stopPropagation(),v(!0)},[]),i=(0,t.useCallback)(function(_){r.current.value.push({id:(0,P.uuid)(),title:"",description:"",data_state:"new",image:_}),m(r.current.value)},[s]),c=(0,t.useCallback)(function(_){r.current.externalLink=_.target.value,h()},[]),O=(0,t.useCallback)(function(){r.current.value.push({id:(0,P.uuid)(),title:"",description:"",data_state:"new",image:void 0,url:r.current.externalLink}),m(r.current.value),v(!1)},[s]),M=(0,t.useCallback)(function(){v(!1)},[]),k=(0,t.useCallback)(function(_){return function(){r.current.value=r.current.value.filter(function(u){return u.id!==_}),m(r.current.value)}},[]),d=r.current.visible,K=r.current.value,l=r.current.externalLink;return(0,a.jsxs)("div",{className:"article-content-image",children:[(0,a.jsx)(o.Modal,{centered:!0,visible:d,dialogClassName:"modal-dialog-small w-500px",onCancel:M,onOk:O,title:"\u8BBE\u7F6E\u94FE\u63A5\u5F15\u7528",closable:!1,headerClassName:"border-bottom-0",bodyClassName:"py-2",footerClassName:"border-top-0",children:(0,a.jsx)(o.Input.TextArea,{value:l,autoSize:{minRows:3,maxRows:5},onChange:c})}),(0,a.jsx)("div",{className:"fv-row mb-6",children:(0,a.jsx)(o.SignleUpload,{accept:{"image/*":[".png",".jpg",".jpeg",".gif",".svg"]},title:(0,a.jsxs)(a.Fragment,{children:["\u5C06\u6587\u4EF6\u62D6\u62FD\u81F3\u6B64\u5904\u3001\u70B9\u51FB\u4E0A\u4F20\uFF0C\u6216",(0,a.jsx)("a",{onClick:b,className:"",children:"\u8BBE\u7F6E"}),"\u94FE\u63A5\u5F15\u7528\u3002"]}),description:"\u652F\u6301\u7684\u683C\u5F0F\uFF1Apng, jpg, jpeg, gif, svg",onChange:i})}),(0,a.jsx)(C.ZP,{direction:"horizontal",layout:"grid",onChange:F,tag:"div",className:"ps-0",draggable:!0,items:K,rerender:!1,itemRender:function(u,W){var N=u,w=N.data,z=N.drag,G=N.style;return(0,a.jsx)(o.Symbol.Image,{ref:z(W),labelClassName:"fs-2",size:150,style:f()({width:150,height:150},G),src:j(w),className:g()("shadow shadow-sm p-2 mb-6 me-6",{}),badge:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(o.Button,{as:"label",type:"circle",variant:!1,onClick:k(w.id),"data-kt-image-input-action":"change",className:"symbol-badge start-100 btn-icon btn-active-color-primary w-25px h-25px bg-body shadow",children:(0,a.jsx)("i",{className:"bi bi-x fs-2"})})})},w.id)},preview:{render:(0,C.HG)(function(_){var u=_,W=u.data;return(0,a.jsx)(o.Symbol.Image,{style:{width:150,height:150},labelClassName:"fs-2",size:150,src:j(W),className:g()("shadow shadow-sm p-2",{})})},{})}})]})}p.Z=y},24908:function(S,p,e){e.r(p);var B=e(15009),f=e.n(B),A=e(52677),R=e.n(A),x=e(97857),I=e.n(x),t=e(99289),C=e.n(t),T=e(5574),g=e.n(T),o=e(62435),P=e(96974),L=e(73588),a=e(10811),j=e(97294),y=e(91726),n=e(86074);function s(){var D=(0,P.s0)(),r=a.Form.useForm(),U=(0,y.ac)({variables:{pageSize:1e3},fetchPolicy:"network-only"}),E=U.data,h=(0,y.qX)(),m=g()(h,1),F=m[0],v=(0,o.useCallback)(C()(f()().mark(function i(){var c,O,M;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.validateFields();case 2:return c=d.sent,c.images=(c.images||[]).map(function(K){var l=I()({},K);return l.hasOwnProperty("__typename")&&delete l.__typename,l.data_state==="new"&&delete l.id,delete l.data_state,l.hasOwnProperty("image")&&l.image&&(R()(l.image)==="object"&&(l.image=l.image.id),delete l.url),l}),d.next=6,F({variables:{input:c}});case 6:O=d.sent,M=O.data,a.Toast.success("\u4FDD\u5B58\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),D("/pim/products/"+M.result.id,{replace:!0});case 10:case"end":return d.stop()}},i)})),[]),b=(E==null?void 0:E.result.edges.map(function(i){return i.node}))||[];return(0,n.jsx)(L.vs,{header:{title:"\u65B0\u5EFA\u4EA7\u54C1"},children:(0,n.jsxs)(a.Card,{children:[(0,n.jsx)(a.Card.Header,{children:(0,n.jsx)(a.Card.Title,{children:"\u65B0\u5EFA\u4EA7\u54C1"})}),(0,n.jsx)(a.Card.Body,{children:(0,n.jsxs)(a.Form,{form:r,className:"form d-flex flex-column",children:[(0,n.jsxs)(a.Row,{className:"mt-5",children:[(0,n.jsxs)(a.Col,{span:6,children:[(0,n.jsx)(a.Form.Item,{className:"mb-5",name:"brandId",label:"\u54C1\u724C",rules:[{required:!0,message:"\u54C1\u724C\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,n.jsx)(a.Select,{className:"w-400px",options:(b==null?void 0:b.map(function(i){return{label:i.name,value:i.id}}))||[]})}),(0,n.jsx)(a.Form.Item,{className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,n.jsx)(a.Input,{solid:!0,className:"w-400px"})})]}),(0,n.jsx)(a.Col,{span:6,children:(0,n.jsx)(a.Form.Item,{className:"mb-5",name:"images",label:"\u4EA7\u54C1\u56FE\u7247",noStyle:!0,children:(0,n.jsx)(j.Z,{})})})]}),(0,n.jsx)(a.Button,{className:"w-100px",onClick:v,children:"\u4FDD\u5B58"})]})})]})})}p.default=s}}]);
