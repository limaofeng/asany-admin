(self.webpackChunk=self.webpackChunk||[]).push([[9330],{58301:function(Se,te,u){"use strict";u.d(te,{Oh:function(){return me},bp:function(){return G}});var ie=u(97857),b=u.n(ie),oe=u(62435);function de(z,h){var l,g,S=z(b()({fetchPolicy:"network-only"},h)),j=S.data,Q=S.loading,w=S.previousData,L=S.refetch,Z=S.error,ee=(0,oe.useMemo)(function(){return Q?w==null?void 0:w.result.pageInfo:j==null?void 0:j.result.pageInfo},[j==null||(l=j.result)===null||l===void 0?void 0:l.pageInfo.total,Q,w==null||(g=w.result)===null||g===void 0?void 0:g.pageInfo.total]),fe=(j==null?void 0:j.result.edges.map(function(ve){return ve.node}))||[];return[fe,{loading:Q,pageInfo:ee,error:Z,variables:{},refetch:L}]}function ce(z,h){return h.split(".").reduce(function(l,g){return l&&l[g]!==void 0?l[g]:void 0},z)}function Y(z,h,l){for(var g=h.split("."),S=z;g.length>1;){var j=g.shift();S[j]||(S[j]={}),S=S[j]}S[g[0]]=l}function me(z,h){var l=h.map(function(g){var S=g.source,j=g.target,Q=g.transform,w=g.skip,L=ce(z,S);if(L==null||w&&w(L))return"";var Z=Q?Q(L):String(L);return"".concat(encodeURIComponent(j||S),"=").concat(encodeURIComponent(Z))});return l.filter(function(g){return g}).join("&")}function G(z,h){var l={};return h.forEach(function(g){var S=g.source,j=g.target,Q=g.transform,w=g.skip,L=z.get(S);if(!(!L||L.trim()==="")){var Z=Q?Q(L):L;w&&w(Z)||(j?Y(l,j,Z):l[S]=Z)}}),l}te.ZP=de},77080:function(Se,te,u){"use strict";u.r(te),u.d(te,{default:function(){return Qe}});var ie=u(97857),b=u.n(ie),oe=u(64599),de=u.n(oe),ce=u(15009),Y=u.n(ce),me=u(99289),G=u.n(me),z=u(5574),h=u.n(z),l=u(62435),g=u(96974),S=u(39711),j=u(46027),Q=u(30381),w=u.n(Q),L=u(14336),Z=u(52677),ee=u.n(Z),fe=u(61227),ve=u.n(fe),we=u(32512),Me=u(93162),ke=u.n(Me),X=u(84105),Be=function(t){var C=t.split(`
`);return C.map(function(v){return v.split(",")})},Ie=function(t,C){var v=ve()(t),y=v[0],B=v.slice(1);return B.map(function(D){for(var x={},n=0,I=Object.keys(C.fields);n<I.length;n++){var p=I[n],c=C.fields[p];typeof c=="number"?x[p]=D[c]:typeof c=="string"?x[p]=D[y.indexOf(c)]:ee()(c)==="object"&&(x[p]=typeof c.index=="string"?D[y.indexOf(c.index)]:D[c.index],c.formatter&&(x[p]=c.formatter(x[p])))}return x})};function Pe(i,t){var C=(0,l.useCallback)(function(p){var c=p[0];if(c){var M=new FileReader;M.onload=function(E){var k=c.name.split(".").pop().toLowerCase();if(k==="csv"){var A=E.target.result,P=Be(A);console.log("Parsed CSV Data:",P)}else if(k==="xls"||k==="xlsx"){var T=E.target.result,H=X.ij(T,{type:"binary"}),N=H.SheetNames[0],U=H.Sheets[N],$=X.P6.sheet_to_json(U,{header:t.header||1,raw:!1,dateNF:"yyyy-mm-dd hh:mm:ss"}),W=Ie($,t);console.log("Formatted JSON Data:",W),i(W)}else console.error("Unsupported file type")},c.type==="text/csv"||c.name.endsWith(".csv")?M.readAsText(c):M.readAsBinaryString(c)}},[i]),v=(0,we.uI)({onDrop:C,accept:{"text/csv":[".csv"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},maxFiles:1}),y=v.getRootProps,B=v.getInputProps,D=y(),x=D.onClick,n=(0,l.useCallback)(function(p){console.log("handleImportExcel"),x&&x(p)},[x]),I=(0,l.useCallback)(function(){var p,c,M=Object.keys(t.fields).map(function(O){var s=t.fields[O];return ee()(s)==="object"&&s.name||O}),E=Object.keys(t.fields).map(function(O){var s=t.fields[O];return ee()(s)==="object"&&s.example||""}),k=[M,E],A=X.P6.aoa_to_sheet(k);(p=t.template)!==null&&p!==void 0&&p.cols&&(A["!cols"]=t.template.cols);for(var P=0,T=1;T<P;T++)for(var H=0;H<M.length;H++){var N=X.P6.encode_cell({r:T,c:H});A[N]||(A[N]={v:null});var U=t.fields[M[H]];if(ee()(U)==="object"){switch(U.type){case"date":A[N].t="d";break}U.format&&(A[N].z=U.format)}}var $=X.P6.book_new();X.P6.book_append_sheet($,A,"Sheet1");var W=X.cW($,{bookType:"xlsx",type:"array"}),K=new Blob([W],{type:"application/octet-stream"});ke()(K,((c=t.template)===null||c===void 0?void 0:c.filename)||"template.xlsx")},[t]);return[(0,l.createElement)("input",b()(b()({},B()),{},{key:"file-input",value:""})),n,I,{data:{},error:"",handleImportExcel:n}]}var Te=Pe,se=u(58301),Ne=u(73588),r=u(79817),re=u(42646),le=u(75981),ae=u(12708),Re=u(5618),he=u(96944),e=u(86074);function $e(i,t){var C=(0,he.eU)({variables:{id:i==null?void 0:i.id},refetchQueries:t==null?void 0:t.refetchQueries}),v=h()(C,1),y=v[0],B=t||{},D=B.onDeleted,x=D===void 0?function(){}:D,n=B.messages,I=(0,l.useCallback)(G()(Y()().mark(function p(){var c;return Y()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,r.Modal.confirm({title:(n==null?void 0:n.title)||"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u5417\uFF1F",content:((n==null?void 0:n.content)||function(k){return(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:k==null?void 0:k.title}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})})(i),okText:(n==null?void 0:n.okText)||"\u5220 \u9664",okClassName:"btn-danger"});case 2:if(c=E.sent,!c.isConfirmed){E.next=8;break}return E.next=6,y();case 6:r.Toast.success((n==null?void 0:n.successText)||"\u5220\u9664\u6210\u529F"),x(i);case 8:case"end":return E.stop()}},p)})),[y,i,x]);return[I]}var Oe=$e;function Ye(i,t){var C=r.Form.useForm(),v=(0,l.useState)(!1),y=h()(v,2),B=y[0],D=y[1],x=t||{},n=x.messages,I=x.onSubmitted,p=I===void 0?function(){}:I,c=x.transform,M=c===void 0?function(U){return U}:c,E=(0,he.uw)({fetchPolicy:"no-cache",refetchQueries:t==null?void 0:t.refetchQueries}),k=h()(E,1),A=k[0],P=(0,he.Mq)({fetchPolicy:"no-cache",refetchQueries:t==null?void 0:t.refetchQueries}),T=h()(P,1),H=T[0],N=(0,l.useMemo)(function(){return i!=null&&i.id?G()(Y()().mark(function U(){var $,W,K;return Y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return D(!0),s.prev=1,s.t0=M,s.next=5,C.validateFields();case 5:return s.t1=s.sent,$=(0,s.t0)(s.t1),s.next=9,r.Toast.promise((0,ae.gw)(H({variables:{id:i.id,input:b()({},$)}}),350),{pending:(n==null?void 0:n.pending)||"\u4FDD\u5B58\u4E2D...",success:{render:function(){return(0,e.jsxs)(e.Fragment,{children:["\u8DEF\u7531 ",(0,e.jsx)("strong",{children:$.name})," \u4FDD\u5B58\u6210\u529F"]})}},error:(n==null?void 0:n.error)||"\u4FDD\u5B58\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 9:W=s.sent,K=W.data,p(K.updateArticle),D(!1),s.next=18;break;case 15:s.prev=15,s.t2=s.catch(1),D(!1);case 18:case"end":return s.stop()}},U,null,[[1,15]])})):G()(Y()().mark(function U(){var $,W,K;return Y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return D(!0),s.prev=1,s.t0=M,s.next=5,C.validateFields();case 5:return s.t1=s.sent,$=(0,s.t0)(s.t1),s.next=9,r.Toast.promise((0,ae.gw)(A({variables:{input:b()({},$)}}),350),{pending:(n==null?void 0:n.pending)||"\u63D0\u4EA4\u4E2D...",success:{render:(n==null?void 0:n.pending)||"\u63D0\u4EA4\u6210\u529F"},error:(n==null?void 0:n.error)||"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 9:W=s.sent,K=W.data,p(K.createArticle),D(!1),s.next=18;break;case 15:s.prev=15,s.t2=s.catch(1),D(!1);case 18:case"end":return s.stop()}},U,null,[[1,15]])}))},[A,i==null?void 0:i.id,C,p,H]);return[N,{form:C,submitting:B}]}var Le=Ye;function Ue(i){var t=i.form;return(0,l.useEffect)(function(){var C,v=i.data;v.id||t.resetFields(),t.setFieldsValue(b()(b()({},v),{},{tags:(v.tags||[]).map(function(y){return y.name}),content:(C=v.content)===null||C===void 0?void 0:C.rawUrl.replace("storage://","").split("/").pop()}))},[t,i.data]),(0,e.jsxs)(r.Form,{form:t,children:[(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"title",className:"d-flex flex-column mb-7",required:!0,label:"CMMF CODE",rules:[{required:!0,message:"CMMF CODE\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.Input,{solid:!0})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"tags",className:"d-flex flex-column mb-7",required:!0,label:"WMF CODE",children:(0,e.jsx)(Re.ZP,{className:"form-control form-control-solid"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"content",className:"d-flex flex-column mb-7",required:!0,label:"\u6587\u4EF6\u8DEF\u5F84",rules:[{required:!0,message:"\u6587\u4EF6\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.Input.TextArea,{solid:!0,autoSize:{minRows:2,maxRows:2}})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"scheduledAt",className:"d-flex flex-column mb-7",label:"\u53D1\u5E03\u65F6\u95F4",rules:[{required:!0,message:"\u53D1\u5E03\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.DatePicker,{solid:!0,className:"w-100"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"expirationAt",className:"d-flex flex-column mb-7",label:"\u8FC7\u671F\u65F6\u95F4",rules:[{required:!0,message:"\u8FC7\u671F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.DatePicker,{solid:!0,className:"w-100"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{className:"d-flex flex-column mb-7",name:"summary",label:"\u5907\u6CE8",children:(0,e.jsx)(r.Input.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:6}})})})})]})}function He(i){var t=i.data,C=i.visible,v=i.onClose,y=i.onSuccess,B=i.onDeleteSuccess,D=Le(t,{transform:function(T){return b()(b()({},T),{},{content:{type:"PDF",url:"storage://ZovzE2fU/".concat(T.content)},category:"1386"})},onSubmitted:y}),x=h()(D,2),n=x[0],I=x[1],p=I.form,c=I.submitting,M=(0,l.useMemo)(function(){return t?b()({},t):{}},[t]),E=Oe(t,{onDeleted:B}),k=h()(E,1),A=k[0];return(0,e.jsx)(r.Drawer,{title:t!=null&&t.id?"\u7F16\u8F91":"\u65B0\u589E",placement:"right",width:640,mask:!0,closable:!0,onClose:v,visible:C,footer:(0,e.jsxs)(r.Row,{children:[(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Button,{style:{letterSpacing:"1rem"},className:"w-100",loading:c,onClick:n,children:"\u4FDD\u5B58"})}),(0,e.jsx)(r.Col,{span:6,children:(t==null?void 0:t.id)&&(0,e.jsx)(r.Button,{style:{letterSpacing:"1rem"},className:"w-100",variant:"light-danger",onClick:A,children:"\u5220\u9664"})})]}),children:t&&(0,e.jsx)(Ue,{submitting:c,data:M,form:p,submit:n,onDeleteSuccess:B})})}var Ve=He;function We(i){var t=i.data,C=i.onEdit,v=i.refetch,y=(0,l.useState)(!1),B=h()(y,2),D=B[0],x=B[1],n=(0,re.nT)(),I=h()(n,1),p=I[0],c=(0,L.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(P){return(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:P.name}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})}},function(){var A=G()(Y()().mark(function P(T){return Y()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,p({variables:{where:{id_in:[T==null?void 0:T.id]}}});case 2:v();case 3:case"end":return N.stop()}},P)}));return function(P){return A.apply(this,arguments)}}()),M=h()(c,1),E=M[0],k=(0,l.useCallback)(function(A){var P=A.key;P==="edit"?C(t):P==="delete"&&E({name:t.title,id:t.id})},[]);return(0,e.jsx)(r.Dropdown,{overlay:(0,e.jsxs)(r.Menu,{onClick:k,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-2",children:[(0,e.jsx)(r.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(r.Menu.Item,{className:"actions-delete px-3",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:x,visible:D,children:(0,e.jsxs)(r.Button,{variant:"clean",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(j.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function ze(){var i=(0,g.s0)(),t=(0,S.lr)(),C=h()(t,1),v=C[0],y=(0,l.useMemo)(function(){return(0,se.bp)(v,[{source:"q",target:"keywords"}])},[v.get("q")]);(0,l.useState)({keywords:v.get("q")||""});var B=(0,l.useMemo)(function(){return(0,se.bp)(v,[{source:"q",target:"where.name_contains"},{source:"sex",target:"where.sex"},{source:"page",transform:function(a){return parseInt(a)}},{source:"per_page",transform:function(a){return parseInt(a)}},{source:"sort",target:"orderBy",transform:function(a){var F=a.split(":"),d=h()(F,2),R=d[0],m=d[1];return"".concat(R,"_").concat(m)}}])},[v.toString()]),D=(0,re.Y9)({fetchPolicy:"network-only"}),x=h()(D,1),n=x[0],I=(0,re.uw)(),p=h()(I,1),c=p[0],M=(0,re.Mq)(),E=h()(M,1),k=E[0],A=(0,re.nT)(),P=h()(A,1),T=P[0],H=(0,se.ZP)(re.gk,{variables:B}),N=h()(H,2),U=N[0],$=N[1],W=$.loading,K=$.pageInfo,O=$.refetch,s=(0,l.useCallback)(function(o,a,F){var d=(0,se.Oh)({searchForm:y,pagination:o,filters:a,sorter:F},[{source:"searchForm.keywords",target:"q",skip:function(m){return!m}},{source:"pagination.current",target:"page",skip:function(m){return m===1}},{source:"pagination.pageSize",target:"per_page",skip:function(m){return m===15}},{source:"sorter.field",target:"sort",transform:function(m){return"".concat(m,":").concat(F.order==="ascend"?"asc":"desc")}}]);i(location.pathname+"?"+d,{replace:!0})},[y]),Fe=(0,l.useCallback)(function(o){i(location.pathname+(o?"?q="+o:""),{replace:!0})},[]),Ze=(0,l.useCallback)(function(){var o=G()(Y()().mark(function a(F){var d,R,m,_,je,V,ge,xe,ye,J,Ce,Ee,ne,Ae,ue;return Y()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:d={totalRecords:0,insertCount:0,updateCount:0,failureCount:0,failedRecords:[],startTime:null,endTime:null},d.totalRecords=F.length,R=r.Toast.loading("\u5F00\u59CB\u5BFC\u5165\u6587\u4EF6",{placement:"top-center"}),d.startTime=new Date,m=0,_=de()(F),f.prev=6,_.s();case 8:if((je=_.n()).done){f.next=49;break}return V=je.value,m++,f.prev=11,f.next=14,n({variables:{where:{title:V.title}}});case 14:if(ye=f.sent,J=ye.data,Ce={title:V.title,summary:V.summary,tags:V.tag?[V.tag]:[],scheduledAt:V.scheduledAt,expirationAt:V.expirationAt,category:"1386",content:{type:"PDF",url:"storage://ZovzE2fU/"+V.file}},(J==null||(ge=J.result)===null||ge===void 0?void 0:ge.pageInfo.total)!==1){f.next=28;break}return R.update("\u66F4\u65B0 ".concat(V.title," - ").concat(m,"/").concat(d.totalRecords),{icon:"loading"}),f.next=21,k({variables:{id:J.result.edges[0].node.id,input:Ce}});case 21:if(Ee=f.sent,ne=Ee.errors,!(ne!=null&&ne.length)){f.next=25;break}throw new Error(ne[0].message);case 25:d.updateCount++,f.next=40;break;case 28:if((J==null||(xe=J.result)===null||xe===void 0?void 0:xe.pageInfo.total)!==0){f.next=39;break}return R.update("\u65B0\u589E ".concat(V.title," - ").concat(m,"/").concat(d.totalRecords),{icon:"loading"}),f.next=32,c({variables:{input:Ce}});case 32:if(Ae=f.sent,ue=Ae.errors,!(ue!=null&&ue.length)){f.next=36;break}throw new Error(ue[0].message);case 36:d.insertCount++,f.next=40;break;case 39:d.failureCount++;case 40:f.next=47;break;case 42:f.prev=42,f.t0=f.catch(11),R.update("\u5931\u8D25 ".concat(V.title," - ").concat(m,"/").concat(d.totalRecords),{icon:"error"}),d.failureCount++,d.failedRecords.push({record:V,error:f.t0});case 47:f.next=8;break;case 49:f.next=54;break;case 51:f.prev=51,f.t1=f.catch(6),_.e(f.t1);case 54:return f.prev=54,_.f(),f.finish(54);case 57:d.endTime=new Date,console.log("Import Summary:",d),R.close(),O(),r.Modal.success({title:"\u64CD\u4F5C\u6210\u529F",width:600,content:(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:["\u5BFC\u5165\u5B8C\u6210, \u5171 ",d.totalRecords," \u6761\u8BB0\u5F55, \u6210\u529F"," ",d.insertCount," \u6761, \u66F4\u65B0 ",d.updateCount," \u6761, \u5931\u8D25 ",d.failureCount," \u6761"]}),(0,e.jsxs)("p",{children:["\u8017\u65F6:"," ",w()(d.endTime).diff(d.startTime,"seconds")," ","\u79D2"]}),(0,e.jsxs)("p",{children:["\u603B\u8BB0\u5F55\u6570: ",d.totalRecords]}),(0,e.jsxs)("p",{children:["\u63D2\u5165\u6570\u91CF: ",d.insertCount]}),(0,e.jsxs)("p",{children:["\u66F4\u65B0\u6570\u91CF: ",d.updateCount]}),(0,e.jsxs)("p",{children:["\u5931\u8D25\u6570\u91CF: ",d.failureCount]})]}),allowOutsideClick:!1});case 62:case"end":return f.stop()}},a,null,[[6,51,54,57],[11,42]])}));return function(a){return o.apply(this,arguments)}}(),[O]),Ke=Te(Ze,{header:1,fields:{title:{index:0,name:"CMMF CODE",example:"W22L1",formatter:function(a){return String(a).trim()}},tag:{index:1,name:"WMF CODE",example:"YS22ED",formatter:function(a){return String(a).trim()}},scheduledAt:{index:2,name:"\u53D1\u5E03\u65F6\u95F4",example:"2024/8/22 0:00",formatter:function(a){return String(a).trim()&&w()(a).format("YYYY-MM-DD HH:mm")}},expirationAt:{index:3,name:"\u7ED3\u675F\u65F6\u95F4",example:"2024/8/31 0:00",formatter:function(a){return String(a).trim()&&w()(a).format("YYYY-MM-DD HH:mm")}},file:{index:4,name:"\u6587\u4EF6\u4F4D\u7F6E",example:"3201000159 1873596030 \u7092\u9505\u94F2.pdf.pdf",formatter:function(a){return String(a).trim()}},summary:{index:5,name:"\u5907\u6CE8",example:"",formatter:function(a){return String(a).trim()}}},template:{filename:"\u7B26\u5408\u6027\u89C4\u8303\u6279\u91CF\u4E0A\u4F20.xlsx",cols:[{wch:20},{wch:20},{wch:20},{wch:20},{wch:50},{wch:30}]}}),pe=h()(Ke,3),Ge=pe[0],Je=pe[1],Xe=pe[2],qe=(0,l.useCallback)(function(o){return G()(Y()().mark(function a(){var F,d;return Y()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return F="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(o.length," \u4E2A\u6587\u4EF6\u5417\uFF1F"),m.next=3,r.Modal.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:F}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(d=m.sent,d.isConfirmed){m.next=6;break}return m.abrupt("return");case 6:return m.next=8,T({variables:{where:{id_in:o}}});case 8:O(),r.Toast.success("\u6587\u4EF6\u6279\u91CF\u5220\u9664\u6210\u529F",2e3,{placement:"bottom-left",progressBar:!0});case 10:case"end":return m.stop()}},a)}))},[O]),_e=(0,l.useState)({visible:!1}),De=h()(_e,2),be=De[0],q=De[1],er=(0,l.useCallback)(function(){q(function(o){return b()(b()({},o),{},{visible:!1})})},[]),rr=(0,l.useCallback)(function(o){q(function(a){return b()(b()({},a),{},{route:o})}),O()},[q]),tr=(0,l.useCallback)(function(o){q(function(a){var F;return((F=a.data)===null||F===void 0?void 0:F.id)!==o.id?a:b()(b()({},a),{},{visible:!1,menu:void 0})}),O()},[q]),ar=(0,l.useCallback)(function(){q(function(o){return b()(b()({},o),{},{visible:!0,data:{}})})},[]),nr=(0,l.useCallback)(function(o){q(function(a){return b()(b()({},a),{},{visible:!0,data:o})})},[]);return(0,e.jsxs)(Ne.vs,{header:{title:"\u7B26\u5408\u6027\u7533\u660E\u7BA1\u7406"},children:[(0,e.jsx)(Ve,{data:be.data,onClose:er,onSuccess:rr,onDeleteSuccess:tr,visible:be.visible}),(0,e.jsxs)(r.Card,{className:"mb-5 mb-xl-10",children:[(0,e.jsxs)(r.Card.Header,{className:"pt-8",children:[(0,e.jsx)(r.Card.Title,{className:"flex-column",children:(0,e.jsx)(r.Input.Search,{solid:!0,defaultValue:y.keywords,className:"w-250px",placeholder:"\u5173\u952E\u8BCD\u641C\u7D22",onSearch:Fe})}),(0,e.jsx)(r.Card.Toolbar,{children:(0,e.jsxs)("div",{children:[(0,e.jsx)(r.Button,{onClick:ar,className:"me-4 my-1",children:"\u65B0\u5EFA"}),Ge,(0,e.jsx)(r.Button,{className:"me-4 my-1",onClick:Je,children:"\u6A21\u677F\u6570\u636E\u5BFC\u5165"}),(0,e.jsx)(r.Button,{variant:"light",className:"me-4 my-1",onClick:Xe,children:"\u7B26\u5408\u6027\u58F0\u660E\u6A21\u677F\u4E0B\u8F7D"})]})})]}),(0,e.jsx)(r.Card.Body,{children:(0,e.jsx)(r.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:W,children:(0,e.jsx)(r.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(a){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:a}),"\u4E2A"]})},toolbar:function(a){return(0,e.jsx)("div",{children:(0,e.jsx)(r.Button,{color:"danger",onClick:qe(a),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},noRowsRenderer:function(){return(0,e.jsx)(r.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"title",title:"CMMF CODE",width:130,sorter:!0,sortOrder:(0,ae.PE)(v,"title")},{key:"tags",title:"WMF CODE",width:130,render:function(a,F){return!!F.tags.length&&F.tags[0].name}},{key:"content",title:"\u89C4\u8303\u6587\u4EF6",render:function(a,F){var d,R,m=F.content,_=new RegExp("^storage://[^/]+/");return(0,e.jsxs)("div",{children:[m==null||(d=m.rawUrl)===null||d===void 0?void 0:d.replace(_,""),(m==null||(R=m.url)===null||R===void 0?void 0:R.startsWith("storage://"))&&(0,e.jsx)(r.Badge,{className:"ms-2",color:"dark",children:"\u672A\u4E0A\u4F20"})]})}},{key:"status",title:"\u72B6\u6001",width:200,sorter:!0,sortOrder:(0,ae.PE)(v,"status"),render:function(a,F){switch(a){case le.af.Draft:return(0,e.jsx)(r.Badge,{light:!0,color:"secondary",children:"\u8349\u7A3F"});case le.af.Published:return(0,e.jsx)(r.Badge,{light:!0,color:"primary",children:"\u5DF2\u53D1\u5E03"});case le.af.Scheduled:return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(r.Badge,{light:!0,color:"info",children:["\u5C06\u4E8E"," ",w()(F.scheduledAt).format("YYYY-MM-DD HH:mm")," ","\u53D1\u5E03"]})});case le.af.Expired:return(0,e.jsx)(r.Badge,{color:"dark",children:"\u5DF2\u8FC7\u671F"});default:return(0,e.jsx)("span",{className:"badge badge-light-dark",children:"\u672A\u77E5"})}}},{key:"expirationAt",title:"\u7ED3\u675F\u65F6\u95F4",sorter:!0,sortOrder:(0,ae.PE)(v,"expirationAt"),width:160,render:function(a){return(0,e.jsx)("div",{className:"text-gray-700",children:a&&w()(a).format("YYYY-MM-DD HH:mm")})}},{title:"\u64CD\u4F5C",key:"action",width:120,render:function(a,F){return(0,e.jsx)(We,{data:F,refetch:O,onEdit:nr})}}],pagination:K,onChange:s,dataSource:U})})})]})]})}var Qe=ze},20067:function(){}}]);
