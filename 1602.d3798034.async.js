(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[1602],{64043:function(k,j,l){"use strict";l.d(j,{ZO:function(){return s.ZO},Yw:function(){return s.Yw},KX:function(){return s.KX},Pw:function(){return s.Pw},aA:function(){return s.aA},G$:function(){return s.G$},_c:function(){return s._c},c9:function(){return s.c9},oM:function(){return s.oM},WF:function(){return s.WF},ot:function(){return s.ot},au:function(){return s.au},Nq:function(){return s.Nq},wp:function(){return s.wp},w4:function(){return s.w4},AQ:function(){return s.AQ}});var s=l(23798)},51602:function(k,j,l){"use strict";l.r(j),l.d(j,{default:function(){return Q}});var s=l(2824),d=l(67294),I=l(7020),S=l(73727),O=l(28865),b=l(39428),B=l(11849),E=l(3182),g=l(64043),a=l(17818),e=l(85893);function L(f){var N=f.visible,y=f.onClose,h=f.onSuccess,r=a.l0.useForm(),o=(0,g.ot)(),F=(0,s.Z)(o,1),m=F[0],p=(0,g.aA)(),A=(0,s.Z)(p,2),C=A[0],w=A[1].loading,c=(0,d.useRef)(new AbortController),n="cn.asany",x=(0,d.useCallback)((0,E.Z)((0,b.Z)().mark(function D(){var i,v,M;return(0,b.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.validateFields();case 2:return i=u.sent,u.next=5,C({variables:{input:(0,B.Z)((0,B.Z)({},i),{},{code:n+"."+i.code})}});case 5:v=u.sent,M=v.data,a.FN.success("\u6A21\u5757 \u201C".concat(i.name,"\u201D \u65B0\u589E\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0}),h(M.createModule);case 9:case"end":return u.stop()}},D)})),[C,r,h]);return(0,e.jsxs)(a.u_,{confirmLoading:w,maskClosable:!w,width:592,centered:!0,visible:N,closable:!1,onCancel:y,onOk:x,children:[(0,e.jsx)(a.u_.Header,{children:(0,e.jsx)("h4",{children:"\u65B0\u6A21\u5757"})}),(0,e.jsx)(a.u_.Body,{children:(0,e.jsxs)(a.l0,{form:r,children:[(0,e.jsx)(a.l0.Item,{required:!1,className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(a.II,{solid:!0})}),(0,e.jsx)(a.l0.Item,{required:!1,className:"mb-5",name:"code",label:"\u7F16\u7801",hasFeedback:!0,help:"\u8BF7\u53C2\u8003\u7F16\u7A0B\u4E2D\u547D\u540D\u7A7A\u95F4\u7684\u5199\u6CD5",rules:[{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{validator:function(i,v){return(0,E.Z)((0,b.Z)().mark(function M(){var Z,u;return(0,b.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(v){t.next=2;break}return t.abrupt("return");case 2:return c.current&&c.current.abort(),c.current=new AbortController,t.next=6,m({variables:{filter:{code:n+"."+v},limit:1},fetchPolicy:"network-only",context:{fetchOptions:{signal:c.current.signal}}});case 6:if(Z=t.sent,u=Z.data,console.log("validator",i,v,u==null?void 0:u.modules),!(u!=null&&u.modules.length)){t.next=11;break}throw new Error(i.message);case 11:case"end":return t.stop()}},M)}))()},message:"\u7F16\u7801\u4E0D\u80FD\u91CD\u590D"}],children:(0,e.jsx)(a.II,{solid:!0,addonBefore:n+".",placeholder:"\u4F8B\u5982: module.text"})}),(0,e.jsx)(a.l0.Item,{className:"mt-5",name:"description",label:"\u63CF\u8FF0",requiredMark:"optional",children:(0,e.jsx)(a.II.TextArea,{solid:!0,autoSize:{maxRows:4,minRows:2}})})]})})]})}var $=L,P=l(18071);function X(){var f=(0,d.useState)(!1),N=(0,s.Z)(f,2),y=N[0],h=N[1],r=(0,g.au)({fetchPolicy:"cache-and-network"}),o=r.data,F=r.loading,m=r.previousData,p=r.refetch,A=(0,d.useCallback)(function(){h(!1)},[]),C=(0,d.useCallback)(function(){h(!0)},[]),w=(0,d.useCallback)(function(n){p(),I.m8.push("/modules/".concat(n.id))},[p]),c=(0,d.useMemo)(function(){return(o==null?void 0:o.modules)||(m==null?void 0:m.modules)||[]},[o==null?void 0:o.modules,m]);return(0,e.jsxs)(P.JH,{loading:F,className:"module-list",children:[(0,e.jsxs)("div",{className:"my-modules",children:[(0,e.jsxs)("h1",{className:"anchor fw-bold mb-5",children:["\u6211\u7684\u6A21\u5757(",c.length,")"]}),(0,e.jsx)(a.X2,{className:"py-2",cols:{md:2,xl:5},gutter:{default:5,xl:9},children:c.map(function(n){var x;return(0,e.jsx)(a.JX,{md:4,children:(0,e.jsxs)(a.Zb,{as:S.Link,to:"/modules/".concat(n.id),className:"module-card card-p-0",children:[(0,e.jsx)(a.Zb.Body,{children:(0,e.jsx)(a.mN,{autoColor:!1,labelClassName:"bg-dark text-inverse-info fs-5tx",src:(x=n.picture)===null||x===void 0?void 0:x.url,alt:n.name})}),(0,e.jsx)(a.Zb.Footer,{className:"p-4",children:(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("h3",{children:n.name}),(0,e.jsx)("span",{className:"tw-text-ellipsis overflow-hidden",children:n.description})]})})]})},n.id)})})]}),(0,e.jsxs)("div",{className:"create-new-module",children:[(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("h1",{className:"anchor fw-bold mb-5",children:"\u521B\u5EFA\u4E00\u4E2A\u65B0\u6A21\u5757"}),(0,e.jsx)("span",{className:"tw-text-ellipsis overflow-hidden",children:"\u521B\u5EFA\u4E00\u4E2A\u7A7A\u767D\u6A21\u5757\u6216\u4ECE\u6A21\u677F\u5F00\u59CB\u3002"})]}),(0,e.jsx)(a.X2,{className:"module-templates",cols:{md:2,xl:4},gutter:{default:5,xl:9},children:(0,e.jsx)(a.JX,{md:4,children:(0,e.jsx)(a.Zb,{as:"a",onClick:C,className:"module-card create-module-card card-p-0",children:(0,e.jsx)(a.Zb.Body,{children:(0,e.jsxs)("div",{className:"create-module-card-inner",children:[(0,e.jsx)("div",{className:"create-module-card__blank_icon",children:(0,e.jsx)(O.JO,{name:"Bootstrap/plus"})}),(0,e.jsx)("span",{className:"create-module-card__blank_name text-gray-700",children:"\u7A7A\u767D"})]})})})})}),(0,e.jsx)($,{visible:y,onSuccess:w,onClose:A})]})]})}var Q=X}}]);
