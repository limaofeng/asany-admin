"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6255],{79514:function(I,A,r){r.d(A,{AQ:function(){return a.AQ},Af:function(){return a.Af},G$:function(){return a.G$},I1:function(){return a.I1},KX:function(){return a.KX},Nq:function(){return a.Nq},P6:function(){return a.P6},Pw:function(){return a.Pw},WF:function(){return a.WF},Yw:function(){return a.Yw},ZO:function(){return a.ZO},_c:function(){return a._c},aA:function(){return a.aA},au:function(){return a.au},c9:function(){return a.c9},jS:function(){return a.jS},ko:function(){return a.ko},oM:function(){return a.oM},ot:function(){return a.ot},w4:function(){return a.w4},wp:function(){return a.wp}});var a=r(70694)},86255:function(I,A,r){r.r(A),r.d(A,{default:function(){return W}});var a=r(5574),g=r.n(a),t=r(67294),O=r(96974),P=r(46027),R=r(12845),L=r(73588),n=r(2721),T=r(15009),M=r.n(T),$=r(97857),D=r.n($),Q=r(99289),k=r.n(Q),y=r(79514),e=r(85893);function G(j){var B=j.visible,N=j.onClose,p=j.onSuccess,c=n.Form.useForm(),i=(0,y.ot)(),s=g()(i,1),E=s[0],m=(0,y.aA)(),C=g()(m,2),F=C[0],b=C[1].loading,f=(0,t.useRef)(new AbortController),v="cn.asany",l=(0,t.useCallback)(k()(M()().mark(function h(){var d,x,w;return M()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,c.validateFields();case 2:return d=u.sent,u.next=5,F({variables:{input:D()(D()({},d),{},{code:v+"."+d.code})}});case 5:x=u.sent,w=x.data,n.Toast.success("\u6A21\u5757 \u201C".concat(d.name,"\u201D \u65B0\u589E\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0}),p(w.createModule);case 9:case"end":return u.stop()}},h)})),[F,c,p]);return(0,e.jsxs)(n.Modal,{confirmLoading:b,maskClosable:!b,width:592,centered:!0,visible:B,closable:!1,onCancel:N,onOk:l,children:[(0,e.jsx)(n.Modal.Header,{children:(0,e.jsx)("h4",{children:"\u65B0\u6A21\u5757"})}),(0,e.jsx)(n.Modal.Body,{children:(0,e.jsxs)(n.Form,{form:c,children:[(0,e.jsx)(n.Form.Item,{required:!1,className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(n.Input,{solid:!0})}),(0,e.jsx)(n.Form.Item,{required:!1,className:"mb-5",name:"code",label:"\u7F16\u7801",hasFeedback:!0,help:"\u8BF7\u53C2\u8003\u7F16\u7A0B\u4E2D\u547D\u540D\u7A7A\u95F4\u7684\u5199\u6CD5",rules:[{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{validator:function(d,x){return k()(M()().mark(function w(){var S,u;return M()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(x){o.next=2;break}return o.abrupt("return");case 2:return f.current&&f.current.abort(),f.current=new AbortController,o.next=6,E({variables:{filter:{code:v+"."+x},limit:1},fetchPolicy:"network-only",context:{fetchOptions:{signal:f.current.signal}}});case 6:if(S=o.sent,u=S.data,console.log("validator",d,x,u==null?void 0:u.modules),!(u!=null&&u.modules.length)){o.next=11;break}throw new Error(d.message);case 11:case"end":return o.stop()}},w)}))()},message:"\u7F16\u7801\u4E0D\u80FD\u91CD\u590D"}],children:(0,e.jsx)(n.Input,{solid:!0,addonBefore:v+".",placeholder:"\u4F8B\u5982: module.text"})}),(0,e.jsx)(n.Form.Item,{className:"mt-5",name:"description",label:"\u63CF\u8FF0",requiredMark:"optional",children:(0,e.jsx)(n.Input.TextArea,{solid:!0,autoSize:{maxRows:4,minRows:2}})})]})})]})}var z=G;function K(){var j=(0,O.s0)(),B=(0,t.useState)(!1),N=g()(B,2),p=N[0],c=N[1],i=(0,y.au)({fetchPolicy:"cache-and-network"}),s=i.data,E=i.loading,m=i.previousData,C=i.refetch,F=(0,t.useCallback)(function(){c(!1)},[]),b=(0,t.useCallback)(function(){c(!0)},[]),f=(0,t.useCallback)(function(l){C(),j("/modules/".concat(l.id))},[C]),v=(0,t.useMemo)(function(){return(s==null?void 0:s.modules)||(m==null?void 0:m.modules)||[]},[s==null?void 0:s.modules,m]);return(0,e.jsxs)(L.JH,{loading:E,className:"module-list",children:[(0,e.jsxs)("div",{className:"my-modules",children:[(0,e.jsxs)("h1",{className:"anchor fw-bold mb-5",children:["\u6211\u7684\u6A21\u5757(",v.length,")"]}),(0,e.jsx)(n.Row,{className:"py-2",cols:{md:2,xl:5},gutter:{default:5,xl:9},children:v.map(function(l){var h;return(0,e.jsx)(n.Col,{md:4,children:(0,e.jsxs)(n.Card,{as:R.Link,to:"/modules/".concat(l.id),className:"module-card card-p-0",children:[(0,e.jsx)(n.Card.Body,{children:(0,e.jsx)(n.Symbol,{autoColor:!1,labelClassName:"bg-dark text-inverse-info fs-5tx",src:(h=l.picture)===null||h===void 0?void 0:h.url,alt:l.name})}),(0,e.jsx)(n.Card.Footer,{className:"p-4",children:(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("h3",{children:l.name}),(0,e.jsx)("span",{className:"tw-text-ellipsis overflow-hidden",children:l.description})]})})]})},l.id)})})]}),(0,e.jsxs)("div",{className:"create-new-module",children:[(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("h1",{className:"anchor fw-bold mb-5",children:"\u521B\u5EFA\u4E00\u4E2A\u65B0\u6A21\u5757"}),(0,e.jsx)("span",{className:"tw-text-ellipsis overflow-hidden",children:"\u521B\u5EFA\u4E00\u4E2A\u7A7A\u767D\u6A21\u5757\u6216\u4ECE\u6A21\u677F\u5F00\u59CB\u3002"})]}),(0,e.jsx)(n.Row,{className:"module-templates",cols:{md:2,xl:4},gutter:{default:5,xl:9},children:(0,e.jsx)(n.Col,{md:4,children:(0,e.jsx)(n.Card,{as:"a",onClick:b,className:"module-card create-module-card card-p-0",children:(0,e.jsx)(n.Card.Body,{children:(0,e.jsxs)("div",{className:"create-module-card-inner",children:[(0,e.jsx)("div",{className:"create-module-card__blank_icon",children:(0,e.jsx)(P.JO,{name:"Bootstrap/plus"})}),(0,e.jsx)("span",{className:"create-module-card__blank_name text-gray-700",children:"\u7A7A\u767D"})]})})})})}),(0,e.jsx)(z,{visible:p,onSuccess:f,onClose:F})]})]})}var W=K}}]);
