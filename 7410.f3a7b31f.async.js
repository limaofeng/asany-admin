"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7410],{65224:function(ee,w,e){e.d(w,{Z:function(){return G}});var r=e(5574),N=e.n(r),m=e(62435),E=e(35090),Z=e(93967),B=e.n(Z),V=e(96486),o=e(86074),M=260,X=768;function P(n){var u=n.minWidth,c=u===void 0?M:u,l=n.maxWidth,A=l===void 0?X:l,g=n.collapsible,h=g===void 0?!0:g,H=n.children,z=n.className,s=n.onWidthChange,i=(0,m.useRef)({minimized:!1,width:n.width}),j=(0,m.useReducer)(function(T){return T+1},0),L=N()(j,2),C=L[1],R=(0,m.useMemo)(function(){return(0,V.debounce)(function(){C()},10)},[]),f=(0,m.useCallback)(function(T){return h&&c-T>c/2||T<=30},[h,c]),W=(0,m.useCallback)(function(){i.current.minimized&&i.current.width>0&&(i.current.width=0)},[]),Y=(0,m.useCallback)(function(T){i.current.width+=T,f(i.current.width)?i.current.minimized=!0:i.current.minimized=!1,R()},[R,f]),J=(0,m.useCallback)(function(){i.current.width=f(i.current.width)?0:Math.min(A,Math.max(c,i.current.width))},[f,A,c]),q=(0,m.useCallback)(function(){i.current.minimized=!i.current.minimized,i.current.width||(i.current.width=c),R()},[R,c]),U=i.current,D=U.minimized,k=U.width,O=(0,m.useMemo)(function(){return Math.min(A,Math.max(c,k))},[A,c,k]);return(0,m.useEffect)(function(){s&&s(D?0:O)},[s,D,O]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"secondary_sidebar-resizer__mirror",style:{width:D?void 0:O}}),(0,o.jsxs)(E.w_,{className:B()("secondary_sidebar-resizer d-flex flex-column flex-lg-row",z,{"secondary_sidebar-resizer-minimized":D}),style:{width:D?void 0:O},onResizeStart:W,onResize:Y,onResizeEnd:J,children:[h&&(0,o.jsxs)("button",{onClick:q,className:B()("secondary_sidebar-resize-button",{collapsed:D,expanded:!D}),type:"button",children:[(0,o.jsx)("div",{className:"invisible-area"}),(0,o.jsx)("span",{className:"homemade-button",role:"presentation",children:(0,o.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",focusable:"false",role:"presentation",children:(0,o.jsx)("path",{d:"M10.294 9.698a.988.988 0 0 1 0-1.407 1.01 1.01 0 0 1 1.419 0l2.965 2.94a1.09 1.09 0 0 1 0 1.548l-2.955 2.93a1.01 1.01 0 0 1-1.42 0 .988.988 0 0 1 0-1.407l2.318-2.297-2.327-2.307z",fill:"currentColor",fillRule:"evenodd"})})})]}),(0,o.jsx)("div",{className:"secondary_sidebar-inner flex-column flex-lg-row-auto w-100 mb-10 mb-lg-0",children:H})]})]})}var G=P},79514:function(ee,w,e){e.d(w,{AQ:function(){return r.AQ},Af:function(){return r.Af},G$:function(){return r.G$},I1:function(){return r.I1},KX:function(){return r.KX},Nq:function(){return r.Nq},P6:function(){return r.P6},Pw:function(){return r.Pw},WF:function(){return r.WF},Yw:function(){return r.Yw},ZO:function(){return r.ZO},_c:function(){return r._c},aA:function(){return r.aA},au:function(){return r.au},c9:function(){return r.c9},jS:function(){return r.jS},ko:function(){return r.ko},oM:function(){return r.oM},ot:function(){return r.ot},w4:function(){return r.w4},wp:function(){return r.wp}});var r=e(70694)},77410:function(ee,w,e){e.r(w),e.d(w,{default:function(){return l}});var r=e(5574),N=e.n(r),m=e(62435),E=e(96974),Z=e(46027),B=e(12845),V=e(93967),o=e.n(V),M=e(1861),X=e(65224),P=e(2721),G=e(79514),n=e(66894),u=e(86074);function c(A){var g=A.location,h=A.history,H=A.children,z=g.state,s=z.module,i=z.baseUrl,j=i===void 0?"":i,L=(0,m.useState)(!1),C=N()(L,2),R=C[0],f=C[1],W=(0,G.wp)({variables:{module:s.id},fetchPolicy:"cache-and-network"}),Y=W.data,J=W.loading,q=Y||{},U=q.models,D=U===void 0?[]:U,k=(0,m.useCallback)(function(){f(!0)},[]),O=(0,m.useCallback)(function(){f(!1)},[]),T=(0,m.useCallback)(function(v){O(),navigate("".concat(j,"/schema/models/").concat(v.id))},[j,O,h]),ae=(0,m.useCallback)(function(v){return function(){navigate("".concat(j,"/schema/models/").concat(v.id))}},[j,h]),K=(0,m.useMemo)(function(){var v=(0,E.LX)(g.pathname,{path:"".concat(j,"/schema/models/:mid"),exact:!0,strict:!0});return v?"model_"+v.params.mid:(v=(0,E.LX)(g.pathname,{path:"".concat(j,"/schema/models"),exact:!0,strict:!0}),v?"model_overview":"")},[j,g.pathname]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(X.Z,{className:"module_secondary_sidebar",width:260,children:(0,u.jsxs)("div",{className:"h-100",children:[(0,u.jsx)("div",{className:"mx-2 p-5 mt-5",children:(0,u.jsx)("h3",{className:"fw-bold text-dark mx-0 mb-0",children:"\u7ED3\u6784\u5B9A\u4E49"})}),(0,u.jsx)(M.E,{className:"d-flex h-100 flex-column custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,u.jsxs)(P.Menu,{className:"px-7 menu-state-bg menu-title-gray-600 menu-icon-gray-400 menu-state-primary menu-state-icon-primary menu-state-bullet-primary menu-arrow-gray-500 fw-bold fs-6 my-5 my-lg-0",selectedKeys:K?[K]:[],accordion:!1,selectable:"AllMenu",fit:!0,children:[(0,u.jsxs)(P.Menu.Section,{className:"menu-section-container",sectionClassName:"d-flex align-items-center",children:[(0,u.jsxs)("span",{className:"menu-section text-muted text-uppercase fs-8 ls-1 flex-row-fluid",children:[(0,u.jsx)(B.Link,{to:"".concat(j,"/schema/models"),className:o()("menu-section__link cursor-pointer text-muted",{checked:K==="model_overview"}),children:"\u5B9E\u4F53"}),J&&" - \u52A0\u8F7D\u4E2D..."]}),(0,u.jsx)(P.Button,{icon:(0,u.jsx)(Z.JO,{style:{marginRight:".2rem"},name:"Duotune/arr087",className:""}),size:"sm",variant:"white",activeColor:"light",className:"px-3 me-n4",onClick:k,children:"\u65B0\u589E"})]}),D.map(function(v){return(0,u.jsx)(P.Menu.Item,{onClick:ae(v),children:v.name},"model_".concat(v.id))})]})})]})}),(0,u.jsx)(n.Z,{module:s,onSuccess:T,visible:R,onClose:O}),H]})}var l=c},66894:function(ee,w,e){var r=e(97857),N=e.n(r),m=e(15009),E=e.n(m),Z=e(99289),B=e.n(Z),V=e(5574),o=e.n(V),M=e(62435),X=e(93967),P=e.n(X),G=e(91845),n=e(2721),u=e(30773),c=e(79514),l=e(86074);function A(g){var h=g.module,H=g.visible,z=g.onClose,s=g.data,i=g.onSuccess,j=(0,M.useState)("settings"),L=o()(j,2),C=L[0],R=L[1],f=n.Form.useForm(),W=(0,c.oM)(),Y=o()(W,1),J=Y[0],q=(0,c.oM)(),U=o()(q,1),D=U[0],k=(0,c.oM)(),O=o()(k,1),T=O[0],ae=(0,c.Pw)({refetchQueries:[{query:c.Yw,variables:{module:h.id}}]}),K=o()(ae,2),v=K[0],re=K[1].loading,me=(0,c.ko)({refetchQueries:[{query:c.Yw,variables:{module:h.id}},{query:c.ZO,variables:{id:s==null?void 0:s.id}}]}),se=o()(me,2),te=se[0],le=se[1].loading,ue=(0,M.useMemo)(function(){return re||le},[re,le]),$=(0,M.useMemo)(function(){return(h.code||"").split(".").map(function(t){return t.charAt(0).toUpperCase()+t.substring(1)}).join("")},[h]),Q=(0,M.useMemo)(function(){return(h.code||"").replaceAll(".","_").toUpperCase()+"_"},[h]),he=(0,u.RO)(function(){var t=B()(E()().mark(function d(F,_,I){var b,p;return E()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(s&&_===s.name)){y.next=2;break}return y.abrupt("return",!0);case 2:return y.next=4,J({variables:{moduleId:h.id,filter:{name:_}},fetchPolicy:"network-only",context:{fetchOptions:{signal:I}}});case 4:return b=y.sent,p=b.data,y.abrupt("return",!(p!=null&&p.models.length));case 7:case"end":return y.stop()}},d)}));return function(d,F,_){return t.apply(this,arguments)}}()),fe=(0,u.RO)(function(){var t=B()(E()().mark(function d(F,_,I){var b,p,x;return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(_){a.next=2;break}return a.abrupt("return",!0);case 2:if(b=$+_.charAt(0).toUpperCase()+_.substring(1),!(s&&b===s.code)){a.next=5;break}return a.abrupt("return",!0);case 5:return a.next=7,D({variables:{moduleId:h.id,filter:{code:b}},fetchPolicy:"network-only",context:{fetchOptions:{signal:I}}});case 7:return p=a.sent,x=p.data,a.abrupt("return",!(x!=null&&x.models.length));case 10:case"end":return a.stop()}},d)}));return function(d,F,_){return t.apply(this,arguments)}}()),ve=(0,u.RO)(function(){var t=B()(E()().mark(function d(F,_,I){var b,p,x,y;return E()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(p=Q+(_||"").toUpperCase(),!(s&&p===((b=s.metadata)===null||b===void 0?void 0:b.databaseTableName))){S.next=3;break}return S.abrupt("return",!0);case 3:return S.next=5,T({variables:{moduleId:h.id,filter:{databaseTableName:p}},fetchPolicy:"network-only",context:{fetchOptions:{signal:I}}});case 5:return x=S.sent,y=x.data,S.abrupt("return",!(y!=null&&y.models.length));case 8:case"end":return S.stop()}},d)}));return function(d,F,_){return t.apply(this,arguments)}}()),ie=(0,M.useCallback)(function(t){return function(){R(t)}},[]),_e=(0,M.useCallback)(B()(E()().mark(function t(){var d,F,_,I,b,p,x;return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.validateFields();case 2:if(d=a.sent,F=Q+(d.databaseTableName||d.code).toUpperCase(),_=$+d.code.charAt(0).toUpperCase()+d.code.substring(1),a.prev=5,s){a.next=15;break}return a.next=9,v({variables:{input:N()(N()({},d),{},{databaseTableName:F,code:_,features:["master","system-fields"],module:h.id})}});case 9:I=a.sent,b=I.data,n.Toast.success("\u5B9E\u4F53 \u201C".concat(d.name,"\u201D \u65B0\u589E\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0}),i(b==null?void 0:b.createModel),a.next=21;break;case 15:return a.next=17,te({variables:{id:s.id,input:N()(N()({},d),{},{databaseTableName:F,code:_,features:["master","system-fields"]})}});case 17:p=a.sent,x=p.data,n.Toast.success("\u5B9E\u4F53 \u201C".concat(d.name,"\u201D \u66F4\u65B0\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0}),i(x==null?void 0:x.updateModel);case 21:a.next=26;break;case 23:a.prev=23,a.t0=a.catch(5),n.Toast.error(a.t0.message,2e3,{placement:"bottom-end",progressBar:!0});case 26:case"end":return a.stop()}},t,null,[[5,23]])})),[$,v,s,f,h.id,i,Q,te]),be=(0,M.useState)(!0),oe=o()(be,2),de=oe[0],ye=oe[1],Me=(0,M.useState)(!0),ce=o()(Me,2),ne=ce[0],pe=ce[1],Ee=(0,M.useCallback)(function(t){if(Object.hasOwn(t,"code")&&ye(!1),Object.hasOwn(t,"databaseTableName")&&pe(!1),Object.hasOwn(t,"name")&&de){var d=(0,G.N9)(t.name,{toneType:"none",type:"array"}).join("");f.setFieldValue("code",d),ne&&f.setFieldValue("databaseTableName",d.toUpperCase())}Object.hasOwn(t,"code")&&ne&&f.setFieldValue("databaseTableName",t.code.toUpperCase())},[de,ne,f]);return(0,M.useEffect)(function(){if(s){var t;f.setFieldsValue(N()(N()({},s),{},{code:s.code.substring($.length),databaseTableName:(t=s.metadata)===null||t===void 0||(t=t.databaseTableName)===null||t===void 0?void 0:t.substring(Q.length)}))}},[$,s,f,Q.length]),(0,l.jsxs)(n.Modal,{confirmLoading:ue,maskClosable:!ue,width:592,centered:!0,visible:H,closable:!1,onCancel:z,onOk:_e,children:[(0,l.jsx)(n.Modal.Header,{children:(0,l.jsx)("h4",{children:s?"\u7F16\u8F91\u5B9E\u4F53":"\u65B0\u589E\u5B9E\u4F53"})}),(0,l.jsx)(n.Modal.Body,{children:(0,l.jsxs)(n.Form,{form:f,onValuesChange:s?void 0:Ee,children:[(0,l.jsxs)("div",{className:"mb-5",children:[(0,l.jsx)(n.Button,{color:C!=="settings"&&"gray-700",variant:C==="settings"?"light-primary":!1,activeColor:C==="settings"?"light-primary":"secondary",className:"me-4 px-5",onClick:ie("settings"),children:"\u8BBE\u7F6E"}),(0,l.jsx)(n.Button,{color:C!=="advanced"&&"gray-700",variant:C==="advanced"?"light-primary":!1,activeColor:C==="advanced"?"light-primary":"secondary",className:"me-4 px-5",onClick:ie("advanced"),children:"\u9AD8\u7EA7"})]}),(0,l.jsxs)("div",{className:P()("modal-tabpane",{"d-none":C!=="settings"}),children:[(0,l.jsx)(n.Form.Item,{required:!1,className:"mb-5",name:"name",hasFeedback:!0,label:"\u663E\u793A\u540D\u79F0",help:"\u914D\u7F6E\u5B9E\u4F53\u65F6\u663E\u793A\u7684\u540D\u79F0, \u901A\u5E38\u4E3A\u4E2D\u6587",rules:[{required:!0,message:"\u663E\u793A\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"},{validator:he,message:"\u540D\u79F0\u91CD\u590D"}],children:(0,l.jsx)(n.Input,{solid:!0,boxClassName:"w-75"})}),(0,l.jsx)(n.Form.Item,{required:!1,className:"my-5",name:"code",label:"\u7F16\u7801",hasFeedback:!0,help:"\u7528\u4E8E\u901A\u8FC7 API \u8BBF\u95EE\u6B64\u5B9E\u4F53\u7684 ID, \u4E0D\u80FD\u4E3A\u4E2D\u6587",rules:[{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{pattern:/^([a-z])([a-z1-9])*(_([a-z1-9]+))*/i,message:"\u8BF7\u9075\u5FAA Java \u547D\u540D\u89C4\u8303"},{validator:fe,message:"\u7F16\u7801\u91CD\u590D"}],children:(0,l.jsx)(n.Input,{addonBefore:$,style:{textTransform:"capitalize"},solid:!0,boxClassName:"w-75"})}),(0,l.jsx)(n.Form.Item,{className:"mt-5",name:"description",label:"\u63CF\u8FF0",help:"\u4E3A\u5185\u5BB9\u7F16\u8F91\u8005\u548C API \u7528\u6237\u663E\u793A\u63D0\u793A",requiredMark:"optional",children:(0,l.jsx)(n.Input.TextArea,{className:"w-75",solid:!0,autoSize:{maxRows:4,minRows:2}})})]}),(0,l.jsx)("div",{className:P()("modal-tabpane",{"d-none":C!=="advanced"}),children:(0,l.jsx)(n.Form.Item,{className:"mb-5",name:"databaseTableName",label:"\u8868\u540D",hasFeedback:!0,help:"\u6620\u5C04\u5230\u6570\u636E\u5E93\u4E2D\u7684\u8868\u540D",rules:[{pattern:/(^_([A-Z0-9]_?)*$)|(^[A-Z](_?[A-Z0-9])*_?$)/i,message:"\u8BF7\u9075\u5FAA\u6570\u636E\u5E93\u547D\u540D\u89C4\u8303"},{validator:ve,message:"\u6570\u636E\u5E93\u8868\u540D\u91CD\u590D"}],children:(0,l.jsx)(n.Input,{solid:!0,addonBefore:Q,boxClassName:"w-75",className:"text-uppercase"})})})]})})]})}w.Z=A}}]);
