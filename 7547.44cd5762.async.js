(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[7547,3190],{48775:function(Re,Ze,o){"use strict";o.d(Ze,{GP:function(){return be.Z},Hk:function(){return te}});var be=o(48655),c=o(39981),k=o(67294),R=o(94184),ce=o.n(R),a=o(12788),Se=o(11849),Ne=o(28865),ae=o(37334),Me=o(2824),ie=o(96486),$=o(85893),ne={aside:{minimize:!1,width:280}},Ae=k.createContext({state:ne,dispatch:function(){}}),r;(function(D){D.AsideToggle="ASIDE_TOGGLE",D.AsideWidth="ASIDE_WIDTH"})(r||(r={}));function e(D,q){switch(q.type){case"ASIDE_TOGGLE":return D.aside.minimize=!D.aside.minimize,(0,Se.Z)({},D);case"ASIDE_WIDTH":return D.aside.width=q.payload,(0,Se.Z)({},D);default:throw new Error}}var z=function(q){var ge=(0,k.useReducer)(e,(0,ie.cloneDeep)(ne)),ue=(0,Me.Z)(ge,2),pe=ue[0],Ee=ue[1];return(0,$.jsx)(Ae.Provider,{value:{state:pe,dispatch:Ee},children:q.children})},se=function(){return(0,k.useContext)(Ae)},he=o(74200),Ie=o(8265);function G(D){var q=D.className,ge=D.header,ue=D.children,pe=D.collapsible,Ee=pe===void 0?!0:pe,De=D.width,je=De===void 0?280:De,we=(0,Ie.$Y)(),Be=se(),Fe=Be.dispatch;return(0,k.useEffect)(function(){we.aside.width(je+100),Fe({type:r.AsideWidth,payload:je})},[we.aside,Fe,je]),(0,$.jsxs)("div",{className:ce()("app-aside aside",q),children:[(0,$.jsx)(ae.Z,{children:(0,$.jsx)(be.Z,{header:ge,resizeable:!0,className:"app-sidebar",children:ue})}),Ee&&(0,$.jsx)(l,{className:"start-100 end-0"})]})}function l(D){var q=se(),ge=q.dispatch,ue=q.state.aside.minimize,pe=(0,k.useCallback)(function(){ge({type:r.AsideToggle})},[ge]);return(0,$.jsx)(he.zx,{style:(0,Se.Z)({marginBottom:"1.35rem",zIndex:105},D.style),onClick:pe,activeColor:"primary",className:ce()("micro-app-aside-toggle","btn-icon bg-body btn-color-gray-700 rounded-2 position-absolute translate-middle bottom-0 shadow-sm d-none d-lg-flex",D.className,{active:ue}),children:(0,$.jsx)(Ne.JO,{name:"Duotune/arr063",className:"svg-icon-2 rotate-180"})})}G.Toggle=l;var j=G,m=a.ZP.div.withConfig({displayName:"MicroApp__MicroAppContainer",componentId:"sc-1dngjf6-0"})(["--root-aside-width:",";--met-aside-width:",";"],function(D){return D.minimize?"100px":"".concat(D.width,"px")},function(D){return D.minimize?"100px":"".concat(D.width,"px")});function H(D){var q=D.children,ge=D.className,ue=se(),pe=ue.state.aside,Ee=pe.minimize,De=pe.width,je=(0,k.useCallback)(function(we){we.preventDefault()},[]);return(0,$.jsx)(m,{minimize:Ee,width:De,className:ce()("micro-app-container page-full-content",ge,{"aside-minimize":Ee}),onContextMenu:je,children:q})}function _(D){var q=D.children,ge=D.className;return(0,$.jsx)(z,{children:(0,$.jsx)(H,{className:ge,children:q})})}_.Sidebar=j;var te=_,oe=o(53851)},8265:function(Re,Ze,o){"use strict";o.d(Ze,{$Y:function(){return Me},BK:function(){return ie},aM:function(){return Ae}});var be=o(2824),c=o(11849),k=o(67294),R=o(85893),ce=k.createContext({getState:function(){return{routes:[]}},subscribe:function(){},dispatch:function(){}}),a=function(e,z){return z?z.type==="ASIDE_MINIMIZE"?(0,c.Z)((0,c.Z)({},e),{},{aside:(0,c.Z)((0,c.Z)({},e.aside),{},{minimize:!!z.payload})}):z.type==="ASIDE_WIDTH"?(0,c.Z)((0,c.Z)({},e),{},{aside:(0,c.Z)((0,c.Z)({},e.aside),{},{width:z.payload})}):z.type==="ASIDE_COLLAPSIBLE"?(0,c.Z)((0,c.Z)({},e),{},{aside:(0,c.Z)((0,c.Z)({},e.aside),{},{collapsible:z.payload})}):e:e},Se=function(e){return(0,c.Z)({},e)};function Ne(r){var e=(0,k.useReducer)(a,r,Se),z=(0,be.Z)(e,2),se=z[0],he=z[1],Ie=(0,k.useState)([]),G=(0,be.Z)(Ie,1),l=G[0],j=function(ge){return function(){var ue=l.indexOf(ge);ue>-1&&l.splice(ue,1)}},m=(0,k.useCallback)(function(q){return l.unshift(q),j(q)},[l]),H=(0,k.useCallback)(function(){l.forEach(function(q){return q()})},[l]),_={getState:function(){return se},dispatch:he,subscribe:m},te=(0,k.useState)(_),oe=(0,be.Z)(te,1),D=oe[0];return(0,k.useEffect)(function(){D.getState=function(){return se},H()},[se]),D}var ae=function(e,z){return e===z};function Me(){var r=(0,k.useContext)(ce),e=(0,k.useRef)({aside:{get state(){return r.getState().aside},width:function(se){r.dispatch({type:"ASIDE_WIDTH",payload:se})},minimize:function(se){r.dispatch({type:"ASIDE_MINIMIZE",payload:se})},collapsible:function(se){r.dispatch({type:"ASIDE_COLLAPSIBLE",payload:se})}}});return e.current}function ie(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ae;return $(r,e)}function $(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ae,z=(0,k.useContext)(ce),se=(0,k.useReducer)(function(m){return m+1},0),he=(0,be.Z)(se,2),Ie=he[1],G=(0,k.useRef)(),l=r(z.getState());function j(){var m=r(z.getState());e(m,G.current)||(G.current=m,Ie())}return(0,k.useEffect)(function(){return z.subscribe(j)},[]),l}function ne(){var r=useContext(ce);return r.dispatch}function Ae(r){var e=r.children,z=r.state,se=Ne(z);return(0,k.useMemo)(function(){return(0,R.jsx)(ce.Provider,{value:se,children:e})},[e,se])}},95901:function(Re,Ze,o){"use strict";o.d(Ze,{dI:function(){return Ie},rB:function(){return he}});var be=o(2824),c=o(67294);function k(G){return G!=null&&G!==""}function R(G,l){var j=useState(G),m=_slicedToArray(j,2),H=m[0],_=m[1];return useEffect(function(){var te=setTimeout(function(){_(G)},l);return function(){clearTimeout(te)}},[G,l]),H}var ce={USERS_LIST:"users-list"},a=o(54941),Se=o(69610),Ne=o(36321),ae=(0,a.Z)(function G(){var l=this;(0,Se.Z)(this,G),this.menu=null,this.element=null,this.getParamName=function(j){var m=document.body.hasAttribute("data-kt-name"),H=m?m+"_":"";return"kt_"+H+"theme_mode_"+j},this.getMode=function(){var j,m=l.getParamName("value"),H=l.getMenuMode(),_="light";if(!localStorage)return _;var te=localStorage.getItem(m);if(te)return te;var oe=(j=l.element)===null||j===void 0?void 0:j.getAttribute("data-theme");return oe||(H?H==="system"?l.getSystemMode():H:_)},this.setMode=function(j,m){var H,_,te,oe=j,D=m;if(!(oe!=="light"&&oe!=="dark")){var q=l.getParamName("value"),ge=l.getParamName("menu");D==="system"&&l.getSystemMode()!==oe&&(oe=l.getSystemMode()),D||(D=oe);var ue=((H=l.menu)===null||H===void 0?void 0:H.querySelector('[data-kt-element="mode"][data-kt-value="'+D+'"]'))||null;(_=l.element)===null||_===void 0||_.setAttribute("data-kt-theme-mode-switching","true"),(te=l.element)===null||te===void 0||te.setAttribute("data-theme",oe);var pe=l;setTimeout(function(){var Ee;(Ee=pe.element)===null||Ee===void 0||Ee.removeAttribute("data-kt-theme-mode-switching")},300),localStorage&&localStorage.setItem(q,oe),ue&&localStorage&&(localStorage.setItem(ge,D),l.setActiveMenuItem(ue)),l.flipImages()}},this.getMenuMode=function(){var j,m=l.getParamName("menu"),H=(j=l.menu)===null||j===void 0?void 0:j.querySelector('.active[data-kt-element="mode"]'),_=H==null?void 0:H.getAttribute("data-kt-value");if(_)return _;if(!m)return"";var te=localStorage?localStorage.getItem(m):null;return te||""},this.getSystemMode=function(){return window.matchMedia("(prefers-color-scheme: dark)")?"dark":"light"},this.initMode=function(){l.setMode(l.getMode(),l.getMenuMode()),l.element&&Ne.EventHandlerUtil.trigger(l.element,"kt.thememode.init")},this.setActiveMenuItem=function(j){var m,H=l.getParamName("menu"),_=j.getAttribute("data-kt-value"),te=(m=l.menu)===null||m===void 0?void 0:m.querySelector('.active[data-kt-element="mode"]');te&&te.classList.remove("active"),j.classList.add("active"),localStorage&&_&&H&&localStorage.setItem(H,_)},this.handleMenu=function(){var j,m;(j=l.menu)===null||j===void 0||(m=j.querySelectorAll('[data-kt-element="mode"]'))===null||m===void 0||m.forEach(function(H){H.addEventListener("click",function(_){_.preventDefault();var te=H.getAttribute("data-kt-value"),oe=te==="system"?l.getSystemMode():te;oe&&l.setMode(oe,te)})})},this.flipImages=function(){var j;(j=document.querySelectorAll("[data-kt-img-dark]"))===null||j===void 0||j.forEach(function(m){m.tagName==="IMG"?l.getMode()==="dark"&&m.hasAttribute("data-kt-img-dark")?(m.setAttribute("data-kt-img-light",m.getAttribute("src")||""),m.setAttribute("src",m.getAttribute("data-kt-img-dark")||"")):l.getMode()==="light"&&m.hasAttribute("data-kt-img-light")&&(m.setAttribute("data-kt-img-dark",m.getAttribute("src")||""),m.setAttribute("src",m.getAttribute("data-kt-img-light")||"")):l.getMode()==="dark"&&m.hasAttribute("data-kt-img-dark")?(m.setAttribute("data-kt-img-light",m.getAttribute("src")||""),m.style.backgroundImage="url('"+m.getAttribute("data-kt-img-dark")+"')"):l.getMode()==="light"&&m.hasAttribute("data-kt-img-light")&&(m.setAttribute("data-kt-img-dark",m.getAttribute("src")||""),m.style.backgroundImage="url('"+m.getAttribute("data-kt-img-light")+"')")})},this.on=function(j,m){if(l.element)return Ne.EventHandlerUtil.on(l.element,j,m)},this.off=function(j,m){if(l.element)return Ne.EventHandlerUtil.off(l.element,j,m)},this.init=function(){l.menu=document.querySelector('[data-kt-element="theme-mode-menu"]'),l.element=document.documentElement,l.initMode(),l.menu&&l.handleMenu()}}),Me=new ae,ie=o(85893),$=Me.getSystemMode(),ne=function(l){var j=l!=="system"?l:$,m="/media/patterns/header-bg"+(j==="light"?".jpg":"-dark.png");document.body.style.backgroundImage='url("'.concat(toAbsoluteUrl(m),'")')},Ae="kt_theme_mode_value",r="kt_theme_mode_menu",e=function(l){if(!localStorage)return"light";var j=localStorage.getItem(l);return!j||j==="light"?"light":j==="dark"?"dark":"system"},z={mode:e(Ae),menuMode:e(r),updateMode:function(l){},updateMenuMode:function(l){}},se=(0,c.createContext)({mode:z.mode,menuMode:z.menuMode,updateMode:function(l){},updateMenuMode:function(l){}}),he=function(){return(0,c.useContext)(se)},Ie=function(l){var j=l.children,m=(0,c.useState)(z.mode),H=(0,be.Z)(m,2),_=H[0],te=H[1],oe=(0,c.useState)(z.menuMode),D=(0,be.Z)(oe,2),q=D[0],ge=D[1],ue=function(De){var je=De==="system"?$:De;te(je),localStorage&&localStorage.setItem(Ae,je),document.documentElement.setAttribute("data-theme",je),Me.init()},pe=function(De){ge(De),localStorage&&localStorage.setItem(r,De)};return(0,c.useEffect)(function(){ue(_),pe(q)},[]),(0,ie.jsx)(se.Provider,{value:{mode:_,menuMode:q,updateMode:ue,updateMenuMode:pe},children:j})}},84036:function(Re,Ze,o){"use strict";o.r(Ze),o.d(Ze,{default:function(){return ca}});var be=o(32059),c=o(39428),k=o(3182),R=o(2824),ce=o(91220),a=o(67294),Se=o(49972),Ne=o(94184),ae=o.n(Ne),Me=o(30381),ie=o.n(Me),$=o(7020),ne=o(31318),Ae=o(86582),r=o(74200),e=o(85893);function z(i){var u=i.calendarSets,t=i.onAction,d=(0,$.tT)("calendar",function(g){return g.state.calendarSet}),s=(0,$.tT)("calendar",function(g){return g.setCalendarSet}),N=(0,a.useCallback)(function(g){if(g.startsWith("calendar-set-"))s(g.substring("calendar-set-".length));else return t(g),!1;return!0},[t,s]),S=(0,a.useMemo)(function(){return[{value:"calendar-set-all",label:"\u5168\u90E8\u65E5\u5386"}].concat((0,Ae.Z)(u.map(function(g){return{value:"calendar-set-".concat(g.id),label:g.name}})),[{type:"separator"},{value:"manage-calendars",label:"\u7BA1\u7406\u65E5\u5386"}])},[u]);return(0,e.jsx)("div",{className:"calendar-sidebar-footer",children:(0,e.jsx)(r.Ph,{onChange:N,placement:"topCenter",value:"calendar-set-".concat(d),options:S})})}var se=z,he=o(28865);function Ie(){var i=(0,a.useRef)(null),u=(0,a.useState)(!1),t=(0,R.Z)(u,2),d=t[0],s=t[1],N=(0,a.useState)(""),S=(0,R.Z)(N,2),g=S[0],A=S[1],Y=(0,$.tT)("calendar",function(p){var v=p.state;return v.selectedDay||new Date}),C=(0,$.tT)("calendar",function(p){return p.state.state=="new"}),x=(0,$.tT)("calendar",function(p){return p.changeState}),B=(0,a.useCallback)(function(){var p;(p=i.current)===null||p===void 0||p.focus()},[]),n=(0,a.useCallback)(function(){s(!0)},[]),h=(0,a.useCallback)(function(){var p=document.getElementsByClassName("main-calendar")[0];p==null||p.focus(),x("none"),A(""),s(!1)},[x]),J=(0,a.useCallback)(function(p){p.key=="Escape"&&h()},[h]),I=(0,a.useCallback)(function(p){if(A(p.target.value),!p.target.value){x("none");return}!C&&x("new",Y)},[x,C,Y]),Z=(0,a.useCallback)(function(){var p;(p=i.current)!==null&&p!==void 0&&p.value||h()},[h]);return(0,a.useEffect)(function(){var p;if(!C){A(""),s(!1);return}var v=document.activeElement,U=!!v&&(v.tagName==="INPUT"||v.tagName==="SELECT"||v.tagName==="TEXTAREA"||v.contentEditable&&v.contentEditable==="true");U||((p=i.current)===null||p===void 0||p.focus(),A(ie()(Y).format("YYYY-MM-DD")))},[C,Y]),(0,e.jsxs)("div",{className:ae()("calendar-event-header",{"event-header-state-new":C}),children:[(0,e.jsx)("div",{className:ae()("calendar-event-header-left"),children:(0,e.jsx)(r.II,{onFocus:n,onBlur:Z,ref:i,value:g,onChange:I,solid:!0,placeholder:"\u65B0\u5EFA\u65E5\u7A0B",onKeyUp:J})}),(0,e.jsx)("a",{className:ae()("calendar-event-header-right",{"calendar-event-new-icon":!(d||C)}),onClick:d||C?h:B,children:(0,e.jsx)(he.ZP,{className:ae()({"svg-icon-1":d||C,"svg-icon-2x svg-icon-dark":!(d||C)}),name:d||C?"Duotune/arr088":"Duotune/arr087"})})]})}var G=Ie,l=o(11849),j=o(93224),m=o(94199);function H(i){var u=(0,ne.V7)({fetchPolicy:"cache-and-network"}),t=u.data,d=(0,a.useMemo)(function(){return t!=null&&t.calendars?t.calendars.filter(function(s){return s.type==="SUNRISE"}).map(function(s){return(0,l.Z)((0,l.Z)({},s),{},{label:s.name,value:s.id})}):[]},[t==null?void 0:t.calendars]);return(0,e.jsx)(r.Ph,(0,l.Z)((0,l.Z)({},i),{},{options:d,itemRender:function(N,S){var g=N.color,A=(0,e.jsx)("div",{style:{backgroundColor:g,width:12,height:12,marginRight:8,border:"1px solid ".concat((0,m.r5)(g)),borderRadius:6,display:"inline-block"}});return S?(0,e.jsxs)(e.Fragment,{children:[a.cloneElement(A,{style:(0,l.Z)((0,l.Z)({},A.props.style),{},{marginRight:5})}),N.label]}):(0,e.jsxs)(e.Fragment,{children:[A,N.label]})}}))}var _=H,te=["calendar","alert"],oe=r.II.TextArea,D=[{label:"\u65E0",value:"none",scope:["all-day","general"],remind:{alert:"NONE"}},{type:"separator",scope:["all-day","general"]},{label:"\u65E5\u7A0B\u5F53\u5929 (\u4E0A\u5348 8:00)",value:"on time of event",scope:["all-day"],remind:{alert:"ON_TIME_OF_EVENT"}},{label:"1 \u5929\u524D (\u4E0A\u5348 8:00)",value:"1 day before 8:00",scope:["all-day"],remind:{alert:"DAYS_BEFORE",times:1}},{label:"2 \u5929\u524D (\u4E0A\u5348 8:00)",value:"2 day before 8:00",scope:["all-day"],remind:{alert:"DAYS_BEFORE",times:2}},{label:"\u65E5\u7A0B\u53D1\u751F\u65F6",value:"at time of event",scope:["general"],remind:{alert:"AT_TIME_OF_EVENT"}},{label:"1 \u5206\u949F\u524D",value:"1 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:1}},{label:"5 \u5206\u949F\u524D",value:"5 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:5}},{label:"10 \u5206\u949F\u524D",value:"10 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:10}},{label:"15 \u5206\u949F\u524D",value:"15 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:15}},{label:"30 \u5206\u949F\u524D",value:"30 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:30}},{label:"45 \u5206\u949F\u524D",value:"45 minute before",scope:["general"],remind:{alert:"MINUTES_BEFORE",times:45}},{label:"1 \u5C0F\u65F6\u524D",value:"1 hour before",scope:["general"],remind:{alert:"HOURS_BEFORE",times:1}},{label:"2 \u5C0F\u65F6\u524D",value:"2 hour before",scope:["general"],remind:{alert:"HOURS_BEFORE",times:2}},{label:"1 \u5929\u524D",value:"1 day before",scope:["general"],remind:{alert:"DAYS_BEFORE",times:1}},{label:"2 \u5929\u524D",value:"2 day before",scope:["general"],remind:{alert:"DAYS_BEFORE",times:2}},{type:"separator",scope:["all-day","general"]},{label:"\u81EA\u5B9A\u4E49",value:"custom",scope:[]}];function q(i){var u=i.visible,t=i.calendarSets,d=i.onSuccess,s=(0,a.useRef)({title:"\u6D4B\u8BD5",allDay:!0,color:"none",alert:"none",starts:"2022-01-19",ends:"2022-01-19"}),N=(0,a.useState)(!1),S=(0,R.Z)(N,2),g=S[0],A=S[1],Y=(0,$.tT)("calendar",function(v){var U=v.state;return ie()(U.selectedDay||new Date).format("YYYY-MM-DD")}),C=(0,$.tT)("calendar",function(v){return v.state.state=="new"}),x=(0,$.tT)("calendar",function(v){return v.state.calendarSet}),B=(0,ne.wO)(),n=(0,R.Z)(B,1),h=n[0];s.current.starts=Y,s.current.ends=Y;var J=(0,a.useCallback)(function(){A(function(v){return!v})},[]),I=(0,a.useCallback)(function(v){if(v.key=="Escape"){var U;(U=document.querySelector(".calendar-event-header input"))===null||U===void 0||U.focus()}},[]),Z=r.l0.useForm();(0,a.useEffect)(function(){if(!s.current.calendar)if(x=="all")s.current.calendar=null;else{var v,U;s.current.calendar=(v=t.find(function(F){return F.id==x}))===null||v===void 0||(U=v.defaultCalendar)===null||U===void 0?void 0:U.id}Z.setFieldsValue(s.current)},[x,t,Z]);var p=(0,a.useCallback)(function(){var v=(0,k.Z)((0,c.Z)().mark(function U(F){var de,K,M,P,fe,L,y;return(0,c.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return K=F.calendar,M=F.alert,P=(0,j.Z)(F,te),fe=(de=D.find(function(V){return V.value==M}))===null||de===void 0?void 0:de.remind,T.next=4,h({variables:{calendar:K,input:(0,l.Z)((0,l.Z)({},P),{},{remind:fe||{alert:"NONE"}})}});case 4:L=T.sent,y=L.data,d(y==null?void 0:y.event);case 7:case"end":return T.stop()}},U)}));return function(U){return v.apply(this,arguments)}}(),[h,d]);return(0,a.useEffect)(function(){!C||Z.setFieldsValue(s.current)},[C,Z]),(0,e.jsx)("div",{className:ae()("calendar-new-event-container",{invisible:!u}),children:(0,e.jsx)("div",{className:"calendar-new-event",children:(0,e.jsx)(r.l0,{onFinish:p,form:Z,onKeyUp:I,layout:"horizontal",initialValues:s.current,children:(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsx)(r.l0.Item,{name:"title",noStyle:!0,children:(0,e.jsx)(r.II,{solid:!0,placeholder:"\u65B0\u5EFA\u65E5\u7A0B"})})}),(0,e.jsx)("li",{children:(0,e.jsx)(r.l0.Item,{name:"allDay",valuePropName:"checked",label:"\u5168\u5929",children:(0,e.jsx)(r.XZ,{})})}),(0,e.jsx)("li",{children:(0,e.jsx)(r.l0.Item,{noStyle:!0,dependencies:["allDay"],children:function(){return(0,e.jsx)(r.l0.Item,{name:"starts",label:"\u5F00\u59CB\u65F6\u95F4",children:(0,e.jsx)(r.Mt,{solid:!0,timePicker:!Z.getFieldValue("allDay"),format:Z.getFieldValue("allDay")?"YYYY-MM-DD":"YYYY-MM-DD A HH:mm"})})}})}),(0,e.jsx)("li",{children:(0,e.jsx)(r.l0.Item,{noStyle:!0,dependencies:["allDay","starts"],children:function(){return(0,e.jsx)(r.l0.Item,{name:"ends",label:"\u7ED3\u675F\u65F6\u95F4",children:(0,e.jsx)(r.Mt,{solid:!0,minDate:Z.getFieldValue("starts"),timePicker:!Z.getFieldValue("allDay"),format:Z.getFieldValue("allDay")?"YYYY-MM-DD":"YYYY-MM-DD A HH:mm"})})}})}),(0,e.jsx)("li",{children:(0,e.jsx)(r.l0.Item,{name:"calendar",label:"\u65E5\u5386",children:(0,e.jsx)(_,{solid:!0})})}),(0,e.jsx)("li",{children:(0,e.jsx)(r.l0.Item,{noStyle:!0,dependencies:["allDay"],children:function(){return(0,e.jsx)(r.l0.Item,{name:"alert",label:"\u63D0\u9192",children:(0,e.jsx)(r.Ph,{solid:!0,options:D.filter(function(U){return U.scope.includes(Z.getFieldValue("allDay")?"all-day":"general")})})})}})}),(0,e.jsx)("li",{className:ae()({invisible:!g}),children:(0,e.jsx)(r.l0.Item,{noStyle:!0,children:(0,e.jsx)(r.II,{solid:!0,placeholder:"\u8BBE\u7F6E\u94FE\u63A5"})})}),(0,e.jsx)("li",{className:ae()({invisible:!g}),children:(0,e.jsx)(r.l0.Item,{noStyle:!0,children:(0,e.jsx)(oe,{autoSize:!0,solid:!0,placeholder:"\u5907\u6CE8"})})}),(0,e.jsxs)("li",{className:"event-actions",children:[(0,e.jsx)(he.ZP,{onClick:J,className:"toggle-more svg-icon-1",name:g?"Bootstrap/chevron-compact-up":"Bootstrap/chevron-compact-down"}),(0,e.jsx)(r.l0.Item,{noStyle:!0,dependencies:["title"],children:function(){return(0,e.jsx)(r.zx,{htmlType:"submit",disabled:!Z.getFieldValue("title"),className:"event-btn-add rounded-2",children:"\u6DFB\u52A0\u65E5\u7A0B"})}})]})]})})})})}var ge=q,ue=o(22028),pe=o(33389),Ee=o(96486),De=o(61051),je=o(69293),we=a.forwardRef(function(i,u){var t=i.closeDropdown,d=i.onAction,s=i.accounts,N=(0,a.useCallback)(function(S){t(),S.keyPath.startsWith("new-calendar")?d("new",S.key):S.keyPath.startsWith("new-calendar-subscription")&&d("subscribe")},[t,d]);return(0,e.jsxs)(r.v2,{className:"menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-150px py-2",ref:u,dropdown:!0,onSelect:N,selectedKeys:[],children:[(0,e.jsx)(r.v2.SubMenu,{title:"\u65B0\u589E\u65E5\u5386",className:"px-2",bodyClassName:"py-2 w-150px",offset:[-6.5,0],children:s.map(function(S){return(0,e.jsx)(r.v2.Item,{title:S.name,className:"px-2"},S.id)})},"new-calendar"),(0,e.jsx)(r.v2.Separator,{className:"mx-1"}),(0,e.jsx)(r.v2.Item,{className:"px-2",children:"\u65B0\u589E\u65E5\u5386\u8BA2\u9605"},"new-calendar-subscription")]})});function Be(i){var u=i.onSuccess,t=i.selectedItem,d=i.onEdit,s=(0,ne.Bo)(),N=(0,R.Z)(s,1),S=N[0],g=(0,ne.Cn)(),A=(0,R.Z)(g,1),Y=A[0],C=(0,ne.e)({fetchPolicy:"cache-and-network"}),x=C.data,B=(0,a.useMemo)(function(){return x!=null&&x.calendarAccounts?x.calendarAccounts||[]:[]},[x==null?void 0:x.calendarAccounts]),n=(0,a.useCallback)(function(){var I=(0,k.Z)((0,c.Z)().mark(function Z(p,v){var U,F;return(0,c.Z)().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(console.log(p,v),p!="new"){K.next=7;break}return K.next=4,S({variables:{input:{account:v}}});case 4:U=K.sent,F=U.data,u(F==null?void 0:F.createCalendar);case 7:case"end":return K.stop()}},Z)}));return function(Z,p){return I.apply(this,arguments)}}(),[S,u]),h=(0,a.useCallback)(function(){!t||d(t.id,"modal")},[d,t]),J=(0,a.useCallback)((0,k.Z)((0,c.Z)().mark(function I(){var Z;return(0,c.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(t){v.next=2;break}return v.abrupt("return");case 2:return v.next=4,r.u_.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u65E5\u5386\u5417\uFF1F",content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u65E5\u5386\u201C<strong>".concat(t.name,"</strong>\u201D\u5417\uFF1F\u8FD9\u4E5F\u5C06\u5220\u9664\u6B64\u65E5\u5386\u4E0A\u7684\u6240\u6709\u4E8B\u4EF6\u3002"),okText:"\u5220 \u9664",cancelClassName:"btn btn-secondary btn-sm",okClassName:"btn btn-danger btn-sm"});case 4:if(Z=v.sent,Z.isConfirmed){v.next=7;break}return v.abrupt("return");case 7:return v.next=9,Y({variables:{id:t.id}});case 9:u();case 10:case"end":return v.stop()}},I)})),[Y,t,u]);return(0,e.jsxs)("div",{className:"calendars-footer",children:[(0,e.jsx)(r.Lt,{overlay:(0,e.jsx)(we,{onAction:n,accounts:B}),placement:"bottomLeft",children:(0,e.jsx)("a",{children:(0,e.jsx)(he.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})})}),(0,e.jsx)("a",{onClick:J,className:ae()({disabled:!t}),children:(0,e.jsx)(he.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:h,className:ae()({disabled:!t}),children:(0,e.jsx)(he.ZP,{name:"Bootstrap/gear-fill",className:"svg-icon-7"})}),(0,e.jsx)(Fe,{})]})}function Fe(){return(0,e.jsx)("div",{})}var $e=Be,Ue=o(78929),Ye=o(34155),ze=a.forwardRef(function(i,u){var t=i.data,d=i.onSelect,s=i.onEdit,N=i.onCheck,S=i.editing,g=i.actived,A=i.checked,Y=i.drag,C=i.indicator,x=i.onShortcut,B=(0,a.useState)(t.name),n=(0,R.Z)(B,2),h=n[0],J=n[1],I=(0,a.useRef)(null),Z=(0,ne.wg)(),p=(0,R.Z)(Z,1),v=p[0],U=(0,a.useCallback)(function(){d(t.id)},[t.id,d]),F=(0,a.useCallback)(function(b){J(b.target.value)},[]),de=(0,a.useMemo)(function(){return(0,Ee.debounce)(function(){var b=(0,k.Z)((0,c.Z)().mark(function T(V){return(0,c.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,v({variables:{id:t.id,input:{name:V}}});case 2:case"end":return f.stop()}},T)}));return function(T){return b.apply(this,arguments)}}(),250)},[v,t.id]),K=(0,a.useCallback)((0,k.Z)((0,c.Z)().mark(function b(){return(0,c.Z)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:s(),t.name!=h&&de(h);case 2:case"end":return V.stop()}},b)})),[t.name,s,de,h]),M=(0,a.useCallback)(function(b,T){if(T){var V;(V=I.current)===null||V===void 0||V.focus(),Ye.nextTick(function(){var re;(re=I.current)===null||re===void 0||re.select()})}else if(b){var w,f,O,ee;(w=I.current)===null||w===void 0||(f=w.offsetParent)===null||f===void 0||(O=f.parentElement)===null||O===void 0||(ee=O.parentElement)===null||ee===void 0||ee.focus()}},[]);(0,a.useEffect)(function(){!S||M(g,S)},[g,S,M]);var P=(0,a.useCallback)(function(b){b.stopPropagation(),M(!0)},[M]),fe=(0,a.useCallback)(function(b){N(t.id,b.target.checked)},[t,N]),L=(0,a.useCallback)(function(){s(t.id,"modal")},[t.id,s]),y=(0,a.useCallback)(function(){var b=(0,k.Z)((0,c.Z)().mark(function T(V){return(0,c.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:V=="EXIT"?(s(),J(t.name)):V=="ENTER"?(s(),t.name!=h&&de(h)):x(V);case 1:case"end":return f.stop()}},T)}));return function(T){return b.apply(this,arguments)}}(),[t.name,s,x,de,h]);return(0,e.jsxs)(ue.fQ,{tag:(0,e.jsx)("li",{ref:Y(u),onClick:U,onDoubleClick:L,className:ae()("calendar-list-item",{active:g,editing:S,"indicator-drag-over-bottom":C>0,"indicator-drag-over-top":C<0})}),name:"CALENDAR_PREFERENCES",handler:y,children:[(0,e.jsx)(r.XZ,{style:{backgroundColor:t.color,borderColor:g?(0,m.tG)(t.color,80):(0,m.r5)(t.color)},checked:A,onClick:P,onChange:fe,className:"calendar-check",size:"sm"}),(0,e.jsxs)("div",{className:"calendar-list-item-btn",children:[(0,e.jsx)("span",{className:"input-state-view",children:h}),(0,e.jsx)("input",{className:"input-state-edit calendar-name",ref:I,onChange:F,onBlur:K,value:h}),t._type=="SUBSCRIPTION"&&(0,e.jsx)("span",{className:"calendar-type",children:"\u8BA2\u9605"})]})]})});function He(i){var u=i.refresh,t=i.calendarSet,d=(0,ne.wg)(),s=(0,R.Z)(d,1),N=s[0],S=(0,ne.wN)(),g=(0,R.Z)(S,1),A=g[0],Y=(0,ne.DM)(),C=(0,R.Z)(Y,1),x=C[0],B=(0,ne.V7)({fetchPolicy:"cache-and-network"}),n=B.data,h=B.refetch,J=(0,a.useState)(),I=(0,R.Z)(J,2),Z=I[0],p=I[1],v=(0,a.useState)(),U=(0,R.Z)(v,2),F=U[0],de=U[1],K=(0,a.useState)((t==null?void 0:t.calendars.map(function(E){return E.id}))||[]),M=(0,R.Z)(K,2),P=M[0],fe=M[1],L=(0,a.useRef)(null),y=(0,a.useRef)({checkedKeys:[],calendars:[]});y.current.checkedKeys=P,y.current.activeKey=Z,y.current.editing=F,y.current.calendarSet=t,y.current.calendars=(n==null?void 0:n.calendars)||[];var b=(0,a.useCallback)(function(E){E&&p(E),de(void 0),Ye.nextTick(function(){var Q;(Q=L.current)===null||Q===void 0||Q.focus()})},[]),T=(0,a.useCallback)(function(E){E!=y.current.activeKey&&b(E)},[b]),V=(0,a.useCallback)(function(){var E=(0,k.Z)((0,c.Z)().mark(function Q(W){var ye,X=arguments;return(0,c.Z)().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:ye=X.length>1&&X[1]!==void 0?X[1]:"modal",W?de({key:W,type:ye}):b();case 2:case"end":return Ce.stop()}},Q)}));return function(Q){return E.apply(this,arguments)}}(),[b]),w=(0,a.useMemo)(function(){if(!(n!=null&&n.calendars))return[];var E=[],Q=(0,ce.Z)(n.calendars),W;try{var ye=function(){var le=W.value,Ce=(0,l.Z)((0,l.Z)({},le),{},{key:le.id,actived:Z==le.id,editing:(F==null?void 0:F.key)==le.id&&(F==null?void 0:F.type)=="inline",checked:P.some(function(xe){return xe==le.id}),_type:le.type});delete Ce.type;var Pe=E.find(function(xe){return xe.id==le.account.id});Pe==null?E.push((0,l.Z)((0,l.Z)({},le.account),{},{calendars:[Ce]})):Pe.calendars.push(Ce)};for(Q.s();!(W=Q.n()).done;)ye()}catch(X){Q.e(X)}finally{Q.f()}return E.sort(function(X,le){return X.index-le.index})},[Z,P,n==null?void 0:n.calendars,F==null?void 0:F.key,F==null?void 0:F.type]),f=(0,a.useCallback)(function(){var E=(0,k.Z)((0,c.Z)().mark(function Q(W){return(0,c.Z)().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,h();case 2:W&&(p(W.id),de({type:"inline",key:W.id}));case 3:case"end":return X.stop()}},Q)}));return function(Q){return E.apply(this,arguments)}}(),[h]),O=(0,a.useCallback)(function(){},[]),ee=(0,a.useCallback)(function(){var E=(0,k.Z)((0,c.Z)().mark(function Q(W){var ye,X,le,Ce;return(0,c.Z)().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return ye=(0,Ue.y)(W.node._rect,W.node,W.dragNode,W.dropPosition,W.node.index),X=W.node.pos,le=ye-Number(X[X.length-1]),Ce=W.node.index,le==-1?Ce--:le==1&&Ce++,xe.next=7,N({variables:{id:W.dragNode.key,input:{index:Math.max(Ce,0)+1}}});case 7:h();case 8:case"end":return xe.stop()}},Q)}));return function(Q){return E.apply(this,arguments)}}(),[h,N]),re=(0,a.useCallback)(function(E){var Q;return((Q=y.current.editing)===null||Q===void 0?void 0:Q.key)!=E.id},[]),ve=(0,a.useCallback)(function(E){return!isNaN(E.dropPosition)},[]),ke=(0,a.useCallback)(function(E){var Q=y.current,W=Q.calendars,ye=Q.activeKey,X=W.findIndex(function(le){return le.id==ye});E=="PREVIOUS"?b(W[Math.max(X-1,0)].id):E=="NEXT"?p(W[Math.min(X+1,W.length-1)].id):E=="ENTER"?de({key:ye,type:"inline"}):E=="EXIT"&&b()},[b]),me=(0,a.useCallback)(function(){b()},[b]),Te=(0,a.useCallback)(function(){var E=(0,k.Z)((0,c.Z)().mark(function Q(W,ye){var X,le,Ce;return(0,c.Z)().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(le=(X=y.current.calendarSet)===null||X===void 0?void 0:X.id,Ce=y.current.checkedKeys,console.log("handleChange",W,ye,le),!ye){xe.next=9;break}return fe([].concat((0,Ae.Z)(Ce),[W])),xe.next=7,A({variables:{id:W,set:le}});case 7:xe.next=12;break;case 9:return fe(Ce.filter(function(oa){return oa!=W})),xe.next=12,x({variables:{id:W,set:le}});case 12:u();case 13:case"end":return xe.stop()}},Q)}));return function(Q,W){return E.apply(this,arguments)}}(),[u,A,x]);return(0,a.useEffect)(function(){fe((t==null?void 0:t.calendars.map(function(E){return E.id}))||[])},[t==null?void 0:t.calendars]),(0,e.jsxs)(ue.fQ,{tag:(0,e.jsx)("div",{ref:L,className:ae()("calendar-list",{editing:!!F})}),handler:ke,name:"CALENDAR_PREFERENCES",children:[(0,e.jsxs)("div",{className:"calendar-list-notes",children:["\u201C",t==null?void 0:t.name,"\u201D\u65E5\u5386\u96C6\u7684\u65E5\u5386\u548C\u4EFB\u52A1\u5217\u8868\u3002"]}),(0,e.jsxs)("div",{className:"calendar-list-content",children:[(0,e.jsx)("div",{className:"calendars-header",children:"\u6211\u7684\u65E5\u5386"}),(0,e.jsx)("div",{className:"calendars-body scroll-y",children:w.map(function(E){return(0,e.jsxs)("div",{className:"calendars-group",children:[(0,e.jsx)("div",{className:"calendars-group-header",children:"\u6211\u7684\u65E5\u5386"}),(0,e.jsx)("div",{className:"calendars-group-body",children:(0,e.jsx)(pe.ZP,{onChange:O,tag:"ul",mode:"indicator",onDrop:ee,draggable:re,allowDrop:ve,className:"calendar-sets-list",items:E.calendars,rerender:!1,itemRender:function(W,ye){var X=W.data,le=W.index;return(0,a.createElement)(ze,(0,l.Z)((0,l.Z)({},W),{},{ref:ye,actived:X.actived,editing:X.editing,checked:X.checked,onCheck:Te,key:X.id,data:X,index:le,onSelect:T,onEdit:V,onShortcut:ke}))}})})]},E.id)})}),(0,e.jsx)($e,{onSuccess:f,selectedItem:y.current.calendars.find(function(E){return E.id==Z}),onEdit:V})]}),(0,e.jsx)(Xe,{data:y.current.calendars.find(function(E){return E.id==Z}),visible:(F==null?void 0:F.type)=="modal",onClose:me})]})}function Xe(i){var u=i.onClose,t=i.visible,d=i.data,s=(0,ne.wg)(),N=(0,R.Z)(s,1),S=N[0],g=r.l0.useForm(),A=(0,a.useState)(d==null?void 0:d.color),Y=(0,R.Z)(A,2),C=Y[0],x=Y[1],B=(0,a.useState)(!1),n=(0,R.Z)(B,2),h=n[0],J=n[1],I=(0,a.useRef)(null),Z=(0,a.useRef)(null),p=(0,a.useMemo)(function(){return[{value:"#ff3d33",label:"\u7EA2\u8272"},{value:"#fc8328",label:"\u6A59\u8272"},{value:"#ffcc00",label:"\u9EC4\u8272"},{value:"#63da38",label:"\u7EFF\u8272"},{value:"#1badf8",label:"\u84DD\u8272"},{value:"#cc73e1",label:"\u7D2B\u8272"},{value:"#a67a63",label:"\u68D5\u8272"},{type:"separator"},{value:"other",label:"\u5176\u4ED6"}]},[]),v=(0,a.useMemo)(function(){return C&&p.some(function(M){return M.value==C})?C:"other"},[p,C]);(0,a.useEffect)(function(){var M;!t||(x(d==null?void 0:d.color),g.setFieldsValue(d),(M=I.current)===null||M===void 0||M.focus(),Ye.nextTick(function(){var P;(P=I.current)===null||P===void 0||P.select()}))},[t]),(0,je.Z)(Z,function(){J(!1)});var U=(0,a.useCallback)(function(M){M=="other"?J(!0):x(M)},[x]),F=(0,a.useCallback)((0,k.Z)((0,c.Z)().mark(function M(){var P;return(0,c.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return P=g.getFieldsValue(),L.next=3,S({variables:{id:d.id,input:(0,l.Z)({color:C},P)}});case 3:u();case 4:case"end":return L.stop()}},M)})),[C,d,g,u,S]),de=(0,a.useCallback)(function(){u(),J(!1)},[u]),K=(0,a.useCallback)(function(M){var P=M.hex;x(P)},[]);return(0,e.jsx)(r.u_,{centered:!0,visible:t,dialogClassName:"modal-dialog-concise-style modal-dialog-small w-400px",onCancel:de,onOk:F,header:!1,closable:!1,okButtonProps:{className:"btn-xs"},cancelButtonProps:{className:"btn-xs"},children:(0,e.jsxs)(r.l0,{form:g,layout:"horizontal",initialValues:(0,l.Z)({},d),size:"xs",children:[(0,e.jsxs)("div",{className:"d-flex flex-row flex-center",children:[(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(r.l0.Item,{name:"name",label:"\u540D\u79F0",children:(0,e.jsx)(r.II,{ref:I,className:"calendar-name"})})}),(0,e.jsx)("div",{className:"d-flex flex-column-auto flex-center",children:(0,e.jsxs)("div",{className:"asany-form-item",children:[(0,e.jsx)(r.Ph,{value:v,size:"xs",onChange:U,placement:"bottomCenter",itemRender:function(P,fe){var L=P.value=="other"?C||(d==null?void 0:d.color):P.value;if(!L)return(0,e.jsx)(e.Fragment,{});var y=(0,e.jsx)("div",{style:{backgroundColor:L,width:20,height:14,marginRight:8,border:"1px solid ".concat((0,m.r5)(L)),display:"inline-block"}});return fe?a.cloneElement(y,{style:(0,l.Z)((0,l.Z)({},y.props.style),{},{marginRight:5})}):(0,e.jsxs)(e.Fragment,{children:[y,P.label]})},options:p}),(0,e.jsx)(r.J2,{visible:h,overlayClassName:"popover-content-body",content:(0,e.jsx)("div",{ref:Z,children:(0,e.jsx)(De.xS,{presetColors:p.filter(function(M){return M.value!="other"&&M.type!="separator"}).map(function(M){return{color:M.value,title:M.label}}),color:C,onChangeComplete:K,onChange:K,width:"220px"})}),children:(0,e.jsx)("div",{})})]})})]}),(d==null?void 0:d.type)=="SUBSCRIPTION"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(r.l0.Item,{name:"url",label:"\u5730\u5740",children:(0,e.jsx)(r.II,{})})}),(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(r.l0.Item,{name:"refresh",label:"\u5237\u65B0",children:(0,e.jsx)(r.Ph,{className:"w-100px",placement:"bottomCenter",options:[{value:"NEVER",label:"\u4ECE\u4E0D"},{value:"EVERY_5_MINUTES",label:"\u6BCF5\u5206\u949F"},{value:"EVERY_15_MINUTES",label:"\u6BCF15\u5206\u949F"},{value:"EVERY_HOVER",label:"\u6BCF\u5C0F\u65F6"},{value:"EVERY_DAY",label:"\u6BCF\u5929"},{value:"EVERY_WEEK",label:"\u6BCF\u5468"}]})})})]}),(0,e.jsxs)("div",{className:"d-flex flex-row flex-center",children:[(0,e.jsx)("div",{className:"d-flex flex-column-auto flex-center",style:{width:56}}),(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(r.l0.Item,{name:"ignoreAlerts",valuePropName:"checked",children:(0,e.jsx)(r.XZ,{label:"\u5FFD\u7565\u63D0\u9192"})})})]})]})})}var Je=He;function Qe(i){var u=i.onSuccess,t=i.selectedKey,d=(0,ne.Xy)(),s=(0,R.Z)(d,1),N=s[0],S=(0,ne.yM)(),g=(0,R.Z)(S,1),A=g[0],Y=(0,a.useCallback)((0,k.Z)((0,c.Z)().mark(function x(){var B,n;return(0,c.Z)().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,N();case 2:B=J.sent,n=B.data,u(n==null?void 0:n.createCalendarSet);case 5:case"end":return J.stop()}},x)})),[N,u]),C=(0,a.useCallback)((0,k.Z)((0,c.Z)().mark(function x(){return(0,c.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,A({variables:{id:t}});case 2:u();case 3:case"end":return n.stop()}},x)})),[A,t,u]);return(0,e.jsxs)("div",{className:"calendar-sets-footer",children:[(0,e.jsx)("a",{onClick:Y,children:(0,e.jsx)(he.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:C,children:(0,e.jsx)(he.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})})]})}var Ge=Qe,Le=o(34155),_e=a.forwardRef(function(i,u){var t=i.data,d=i.editing,s=i.actived,N=i.onSelect,S=i.onEdit,g=i.drag,A=i.indicator,Y=(0,ne.f4)(),C=(0,R.Z)(Y,1),x=C[0],B=(0,a.useState)(t.name),n=(0,R.Z)(B,2),h=n[0],J=n[1],I=(0,a.useRef)(null),Z=(0,a.useCallback)(function(){N(t.id)},[t.id,N]),p=(0,a.useCallback)(function(){S(t.id)},[t.id,S]),v=(0,a.useMemo)(function(){return(0,Ee.debounce)(function(){var K=(0,k.Z)((0,c.Z)().mark(function M(P){return(0,c.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,x({variables:{id:t.id,input:{name:P}}});case 2:case"end":return L.stop()}},M)}));return function(M){return K.apply(this,arguments)}}(),250)},[x,t.id]),U=(0,a.useCallback)((0,k.Z)((0,c.Z)().mark(function K(){return(0,c.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(S(),t.name==h){P.next=4;break}return P.next=4,v(h);case 4:case"end":return P.stop()}},K)})),[t.name,S,v,h]),F=(0,a.useCallback)(function(K){J(K.target.value)},[]);(0,a.useEffect)(function(){var K;!d||((K=I.current)===null||K===void 0||K.focus(),Le.nextTick(function(){var M;(M=I.current)===null||M===void 0||M.select()}))},[d]);var de=(0,a.useCallback)(function(){var K=(0,k.Z)((0,c.Z)().mark(function M(P){return(0,c.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(P!="EXIT"){L.next=5;break}S(),J(t.name),L.next=10;break;case 5:if(P!="ENTER"){L.next=10;break}if(S(),t.name==h){L.next=10;break}return L.next=10,v(h);case 10:case"end":return L.stop()}},M)}));return function(M){return K.apply(this,arguments)}}(),[t.name,S,v,h]);return(0,e.jsx)(ue.fQ,{tag:(0,e.jsx)("li",{ref:g(u),onClick:Z,onDoubleClick:p,className:ae()("calendarset-item",{active:s,"indicator-drag-over-bottom":A>0,"indicator-drag-over-top":A<0})}),name:"CALENDAR_PREFERENCES",handler:de,children:(0,e.jsxs)("div",{className:"calendarset-item-btn",children:[(0,e.jsx)("span",{className:"input-state-view",children:h}),(0,e.jsx)("input",{className:"input-state-edit",ref:I,onChange:F,onBlur:U,value:h})]})})});function qe(i){var u=i.data,t=u===void 0?[]:u,d=i.refresh,s=i.onSelect,N=(0,ne.f4)(),S=(0,R.Z)(N,1),g=S[0],A=(0,$.tT)("calendar",function(y){return y.state.calendarSet}),Y=(0,a.useRef)(null),C=(0,a.useRef)({calendarSets:[]}),x=(0,a.useState)(),B=(0,R.Z)(x,2),n=B[0],h=B[1],J=(0,a.useState)(),I=(0,R.Z)(J,2),Z=I[0],p=I[1];C.current.activeKey=n,C.current.editing=Z,C.current.calendarSets=t;var v=(0,a.useCallback)(function(y){y!=C.current.activeKey&&(h(y),Le.nextTick(function(){var b;(b=Y.current)===null||b===void 0||b.focus()}))},[]),U=(0,a.useCallback)(function(){var y=(0,k.Z)((0,c.Z)().mark(function b(T){return(0,c.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,d();case 2:T?(h(T.id),p(T.id)):t.length&&h(t[0].id);case 3:case"end":return w.stop()}},b)}));return function(b){return y.apply(this,arguments)}}(),[t,d]),F=(0,a.useCallback)(function(){var y=(0,k.Z)((0,c.Z)().mark(function b(T){return(0,c.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:p(T),T||Le.nextTick(function(){var f;(f=Y.current)===null||f===void 0||f.focus()});case 2:case"end":return w.stop()}},b)}));return function(b){return y.apply(this,arguments)}}(),[]);(0,a.useEffect)(function(){if(!!t.length&&!t.some(function(b){return b.id==n})){var y=A=="all"?t[0].id:String(A);h(y)}},[n,t,A]),(0,a.useEffect)(function(){!n||s(n)},[n,s]);var de=(0,a.useCallback)(function(y){var b=C.current,T=b.calendarSets,V=b.activeKey,w=T.findIndex(function(f){return f.id==V});y=="PREVIOUS"?h(T[Math.max(w-1,0)].id):y=="NEXT"?h(T[Math.min(w+1,T.length-1)].id):y=="ENTER"?p(n):y=="EXIT"&&p(void 0)},[n]),K=(0,a.useCallback)(function(){},[]),M=(0,a.useMemo)(function(){return t.map(function(y){return(0,l.Z)((0,l.Z)({},y),{},{key:y.id,actived:n==y.id,editing:Z==y.id})})},[n,t,Z]),P=(0,a.useCallback)(function(){var y=(0,k.Z)((0,c.Z)().mark(function b(T){var V,w,f,O;return(0,c.Z)().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return V=(0,Ue.y)(T.node._rect,T.node,T.dragNode,T.dropPosition,T.node.index),w=T.node.pos,f=V-Number(w[w.length-1]),O=T.node.index,f==-1?O--:f==1&&O++,re.next=7,g({variables:{id:T.dragNode.key,input:{index:Math.max(O,0)+1}}});case 7:d();case 8:case"end":return re.stop()}},b)}));return function(b){return y.apply(this,arguments)}}(),[d,g]),fe=(0,a.useCallback)(function(y){return C.current.editing!=y.id},[]),L=(0,a.useCallback)(function(y){return!isNaN(y.dropPosition)},[]);return(0,e.jsxs)(ue.fQ,{tag:(0,e.jsx)("div",{ref:Y,className:ae()("flex-left calendar-sets",{editing:!!Z})}),name:"CALENDAR_PREFERENCES",handler:de,children:[(0,e.jsx)("div",{className:"calendar-sets-header",children:"\u65E5\u5386\u96C6"}),(0,e.jsx)("div",{className:"calendar-sets-body scroll-y",children:(0,e.jsx)(pe.ZP,{onChange:K,tag:"ul",mode:"indicator",draggable:fe,onDrop:P,allowDrop:L,className:"calendar-sets-list",items:M,rerender:!1,itemRender:function(b,T){var V=b.data,w=b.index;return(0,a.createElement)(_e,(0,l.Z)((0,l.Z)({},b),{},{ref:T,actived:V.actived,editing:V.editing,key:V.id,data:V,index:w,onSelect:v,onEdit:F}))}})}),(0,e.jsx)(Ge,{onSuccess:U,selectedKey:n})]})}var ea=qe;function aa(){var i,u=(0,ne.f4)(),t=(0,R.Z)(u,1),d=t[0],s=(0,ne.Dn)({fetchPolicy:"cache-and-network"}),N=s.data,S=s.refetch,g=N==null?void 0:N.calendarSets,A=r.l0.useForm(),Y=(0,a.useState)(),C=(0,R.Z)(Y,2),x=C[0],B=C[1],n=(0,a.useCallback)(function(I){B(I)},[]),h=(g||[]).find(function(I){return I.id==x});(0,a.useEffect)(function(){var I;A.setFieldsValue({defaultCalendar:h==null||(I=h.defaultCalendar)===null||I===void 0?void 0:I.id})},[h,A]);var J=(0,a.useCallback)((0,k.Z)((0,c.Z)().mark(function I(){var Z;return(0,c.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(Z=A.getFieldsValue(),h){v.next=3;break}return v.abrupt("return");case 3:return console.log("handleChange calendarSet",Z),v.next=6,d({variables:{id:h.id,input:Z}});case 6:case"end":return v.stop()}},I)})),[h,A,d]);return(0,e.jsxs)("div",{className:"settings-calendars",children:[(0,e.jsx)("div",{className:"settings-calendars-notes",children:"\u901A\u8FC7\u521B\u5EFA\u591A\u4E2A\u65E5\u5386\u96C6\u5FEB\u901F\u66F4\u6539\u663E\u793A\u7684\u65E5\u5386\u548C\u4EFB\u52A1\u5217\u8868\u3002\u4F8B\u5982\uFF0C\u60A8\u53EF\u80FD\u6709\u5355\u72EC\u7684\u5BB6\u5EAD\u548C\u5DE5\u4F5C\u65E5\u5386\u96C6\u3002"}),(0,e.jsxs)("div",{className:"d-flex",children:[(0,e.jsx)(ea,{onSelect:n,data:g,refresh:S}),(0,e.jsxs)("div",{className:"settings-calendars-right flex-root",children:[(0,e.jsx)(Je,{refresh:S,calendarSet:h}),(0,e.jsx)("div",{className:"calendar-sets-settings",children:(0,e.jsx)(r.l0,{form:A,layout:"horizontal",size:"xs",initialValues:{defaultCalendar:h==null||(i=h.defaultCalendar)===null||i===void 0?void 0:i.id},onFieldsChange:J,children:(0,e.jsx)("div",{className:"d-flex flex-row flex-center",children:(0,e.jsx)(r.l0.Item,{name:"defaultCalendar",label:"\u9ED8\u8BA4\u65E5\u5386",children:(0,e.jsx)(_,{solid:!0})})})})})]})]})]})}var ta=aa;function na(i){var u=i.visible,t=i.onCancel,d=(0,a.useState)(!1),s=(0,R.Z)(d,2),N=s[0],S=s[1],g=(0,a.useState)("calendars"),A=(0,R.Z)(g,2),Y=A[0],C=A[1],x=(0,a.useCallback)(function(){S(!0)},[]),B=(0,a.useCallback)(function(n){C(n)},[]);return(0,e.jsx)(r.u_,{centered:!0,maskClosable:!1,visible:u,onCancel:t,onOk:x,scroll:!1,confirmLoading:N,dialogClassName:"mw-750px calendar-preferences",header:(0,e.jsx)(r.u_.Header,{children:(0,e.jsxs)(r.JL,{onSelect:B,selectedKey:Y,children:[(0,e.jsx)(r.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(r.JL.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(he.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u5E38\u89C4"})})]})},"general"),(0,e.jsx)(r.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(r.JL.Link,{className:"btn d-flex flex-column btn-active-light-success",children:[(0,e.jsx)(he.ZP,{name:"Duotune/gen014",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u65E5\u5386"})})]})},"calendars"),(0,e.jsx)(r.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(r.JL.Link,{className:"btn d-flex flex-column btn-active-light-info",children:[(0,e.jsx)(he.ZP,{name:"Duotune/fil020",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u5929\u6C14"})})]})},"weather")]})}),footer:!1,children:(0,e.jsx)(ta,{})})}var ra=na,la=o(48775),Oe=o(25496),sa={months:["1 \u6708","2 \u6708","3 \u6708","4 \u6708","5 \u6708","6 \u6708","7 \u6708","8 \u6708","9 \u6708","10 \u6708","11 \u6708","12 \u6708"],weekDays:[{name:"\u661F\u671F\u5929",short:"\u5468\u65E5",isWeekend:!0},{name:"\u661F\u671F\u4E00",short:"\u5468\u4E00"},{name:"\u661F\u671F\u4E8C",short:"\u5468\u4E8C"},{name:"\u661F\u671F\u4E09",short:"\u5468\u4E09"},{name:"\u661F\u671F\u56DB",short:"\u5468\u56DB"},{name:"\u661F\u671F\u4E94",short:"\u5468\u4E94"},{name:"\u661F\u671F\u516D",short:"\u5468\u516D",isWeekend:!0}],weekStartingIndex:0,getToday:function(u){return u},toNativeDate:function(u){return new Date(u.year,u.month-1,u.day)},getMonthLength:function(u){return new Date(u.year,u.month,0).getDate()},transformDigit:function(u){return u},nextMonth:"Next Month",previousMonth:"Previous Month",openMonthSelector:"Open Month Selector",openYearSelector:"Open Year Selector",closeMonthSelector:"Close Month Selector",closeYearSelector:"Close Year Selector",defaultPlaceholder:"Select...",from:"from",to:"to",digitSeparator:",",yearLetterSkip:0,isRtl:!1};function ia(i,u){for(var t=0;t<7;t++){var d=i.clone().add(t,"days"),s=d.format("YYYY-MM-DD");u.has(s)?u.get(s).isWeather=!0:u.set(s,{key:s,date:d,events:[],isToDay:d.isSame(i,"date"),isWeather:!1})}}function Ve(i,u){var t=i.format("YYYY-MM-DD"),d=u.find(function(s){return s.isSelected});if(d){if(d.key==t)return u;d.isTemporary?u.splice(u.findIndex(function(s){return s.isTemporary}),1):u.find(function(s){return s.isSelected}).isSelected=!1}if(u.some(function(s){return s.key==t}))u.find(function(s){return s.key==t}).isSelected=!0;else return u.push({key:t,date:i,events:[],isToDay:i.isSame(ie()(),"date"),isWeather:!1,isSelected:!0,isTemporary:!0}),u.sort(function(s,N){return s.date.toDate().getTime()-N.date.toDate().getTime()});return u}function We(i,u){var t=ie()(),d=new Map,s=(0,ce.Z)(i),N;try{for(s.s();!(N=s.n()).done;){var S=N.value,g=(0,ce.Z)(S.dates),A;try{for(g.s();!(A=g.n()).done;){var Y=A.value,C=ie()(Y),x=C.format("YYYY-MM-DD");if(d.has(x)){var B;(B=d.get(x))===null||B===void 0||B.events.push(S)}else d.set(x,{key:x,date:C,isToDay:C.isSame(t,"date"),events:[S],isWeather:!1})}}catch(n){g.e(n)}finally{g.f()}}}catch(n){s.e(n)}finally{s.f()}return ia(t,d),Ve(ie()(u),Array.from(d.values()).sort(function(n,h){return n.date.toDate().getTime()-h.date.toDate().getTime()}))}var Ke=[];function ua(){var i=(0,ne.Dn)(),u=i.data,t=(0,$.tT)("calendar",function(f){var O=f.state;return O.calendarSet}),d=(0,$.tT)("calendar",function(f){return f.state.state=="new"}),s=(0,$.tT)("calendar",function(f){var O=f.state;return O.selectedDay||new Date}),N=(0,$.tT)("calendar",function(f){return f.setSelectedDay}),S=(0,$.tT)("calendar",function(f){return f.changeState}),g=(0,$.tT)("calendar",function(f){return f.state.fullCalendar}),A=(0,a.useState)(!1),Y=(0,R.Z)(A,2),C=Y[0],x=Y[1],B=(0,a.useRef)(null),n=(0,a.useRef)({selectedDay:s,eventsWithDays:[]}),h=(0,a.useReducer)(function(f){return f+1},0),J=(0,R.Z)(h,2),I=J[1];n.current.calendarSet=t;var Z=(0,ne.Vk)({fetchPolicy:"cache-and-network"}),p=(0,R.Z)(Z,2),v=p[0],U=p[1].refetch,F=(0,a.useCallback)(function(){x(!1)},[]),de=(0,a.useCallback)(function(f){f==="manage-calendars"&&x(!0)},[]),K=(0,a.useCallback)(function(f){f&&N(new Date(f.year,f.month-1,f.day))},[N]),M=(0,a.useCallback)(function(f){return function(){N(n.current.selectedDay=f)}},[N]),P=(0,a.useCallback)(function(f){if(!!B.current){var O=Array.from(document.getElementsByClassName("event-list-item")),ee=O.find(function(ke){return ie()(ke.dataset.date).isSame(ie()(f),"date")});if(!!ee){var re=ee.getBoundingClientRect().top+B.current.scrollTop,ve=B.current.getBoundingClientRect();B.current.scrollTo({top:re-ve.top-6.5}),n.current.skipNextScroll=!0,setTimeout(function(){clearTimeout(n.current.timer)},120),I()}}},[]);(0,a.useEffect)(function(){v({variables:{date:s,days:60,calendarSet:t=="all"?void 0:t}}).then(function(f){var O=f.data;n.current.eventsWithDays=We((O==null?void 0:O.events)||[],n.current.selectedDay),n.current.toDayOrNextEvent=n.current.eventsWithDays.find(function(ee){return ee.key==ie()(n.current.selectedDay).format("YYYY-MM-DD")}),n.current.skipNextScroll=!0,I(),P(s)})},[t,v]);var fe=(0,a.useCallback)(function(){var f=(0,k.Z)((0,c.Z)().mark(function O(ee){var re,ve;return(0,c.Z)().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return n.current.selectedDay=ee,n.current.eventsWithDays=Ve(ie()(ee),n.current.eventsWithDays),n.current.toDayOrNextEvent=n.current.eventsWithDays.find(function(Te){return Te.key==ie()(ee).format("YYYY-MM-DD")}),n.current.skipNextScroll=!0,I(),me.next=7,(0,Oe._v)(60);case 7:return P(ee),me.next=10,(0,Oe._v)(60);case 10:if(n.current.selectedDay==ee){me.next=12;break}return me.abrupt("return");case 12:return me.next=14,U({date:ee,days:60,calendarSet:n.current.calendarSet=="all"?void 0:n.current.calendarSet});case 14:return re=me.sent,ve=re.data,n.current.eventsWithDays=We(ve.events,n.current.selectedDay),n.current.skipNextScroll=!0,I(),me.next=21,(0,Oe._v)(60);case 21:n.current.selectedDay==ee&&P(ee);case 22:case"end":return me.stop()}},O)}));return function(O){return f.apply(this,arguments)}}(),[]);(0,a.useEffect)(function(){n.current.selectedDay&&ie()(n.current.selectedDay).isSame(s,"date")||!n.current.eventsWithDays.length||fe(s)},[s]);var L=(0,a.useCallback)(function(){if(!!B.current){if(n.current.skipNextScroll){n.current.skipNextScroll=!1;return}var f=Array.from(document.getElementsByClassName("event-list-item")),O=B.current.getBoundingClientRect(),ee=f.find(function(ve){if(ve.dataset.temp=="true")return!1;var ke=ve.getBoundingClientRect(),me=ve.getElementsByClassName("event-list")[0].getBoundingClientRect().height,Te=ke.top-O.top+me+16;return Te>0&&Te<ke.height});if(!!ee){var re=n.current.eventsWithDays.find(function(ve){return ve.key==ee.dataset.date});!re||(n.current.eventsWithDays=n.current.eventsWithDays.filter(function(ve){return!ve.isTemporary}),n.current.eventsWithDays.forEach(function(ve){ve.isSelected=!1}),re.isSelected=!0,n.current.skipNextScroll=!0,n.current.toDayOrNextEvent=re,I(),clearTimeout(n.current.timer),n.current.timer=setTimeout((0,k.Z)((0,c.Z)().mark(function ve(){var ke,me;return(0,c.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,U({date:re.date.toDate(),days:60,calendarSet:n.current.calendarSet=="all"?void 0:n.current.calendarSet});case 2:ke=E.sent,me=ke.data,n.current.eventsWithDays=We(me.events,n.current.selectedDay),n.current.skipNextScroll=!0,I();case 7:case"end":return E.stop()}},ve)})),1e3),N(n.current.selectedDay=ie()(ee.dataset.date).toDate()))}}},[N]),y=(0,a.useCallback)(function(f){var O=document.getElementsByClassName("main-calendar")[0];O==null||O.focus(),S("none"),console.log("fullCalendar",g==null?void 0:g.getApi()),g==null||g.getApi().refetchEvents(),fe(new Date(f.datetime.starts))},[g,S,fe]),b=n.current,T=b.toDayOrNextEvent,V=b.eventsWithDays,w=V.find(function(f){return f.key==(T==null?void 0:T.key)});return(0,e.jsxs)(la.GP,{width:325,collapsible:!1,resizeable:!0,className:ae()("calendar-sidebar-bg",{"state-new-event":d}),children:[(0,e.jsxs)("div",{className:"calendar-sidebar",children:[(0,e.jsx)(G,{}),(0,e.jsx)(ge,{visible:d,onSuccess:y,calendarSets:(u==null?void 0:u.calendarSets)||Ke}),(0,e.jsx)(Se.f,{locale:sa,value:{year:s.getFullYear(),month:s.getMonth()+1,day:s.getDate()},onChange:K,shouldHighlightWeekends:!0,colorPrimary:"#04c8c8"}),(0,e.jsxs)("div",{className:"calendar-day-list",children:[(0,e.jsxs)("div",{className:"event-list-header",children:[(0,e.jsxs)("h6",{children:[w!=null&&w.isToDay?"\u4ECA\u5929":(w==null?void 0:w.date.format("dddd"))||"\u4ECA\u5929",(0,e.jsx)("span",{className:"day-subtitle text-muted",children:(w==null?void 0:w.date.format("YYYY-MM-DD"))||ie()().format("YYYY-MM-DD")})]}),!(w!=null&&w.events.length)&&(w==null?void 0:w.isSelected)&&(0,e.jsx)("div",{className:"onday-no-events text-muted",children:"\u6CA1\u6709\u4E8B\u4EF6"})]}),(0,e.jsx)("div",{ref:B,onScrollCapture:L,className:"event-list-body hover-scroll-y",children:V.map(function(f){var O,ee=f.key,re=f.date,ve=f.isToDay,ke=f.events,me=f.isSelected,Te=f.isTemporary;return(0,e.jsxs)("div",{className:"event-list-item","data-temp":Te,"data-date":ee,children:[(0,e.jsxs)("h6",{onClick:M(re.toDate()),children:[ve?"\u4ECA\u5929":re.format("dddd"),(0,e.jsx)("span",{className:"day-subtitle text-muted",children:re.format("YYYY-MM-DD")})]}),(0,e.jsx)("div",{className:ae()("event-list",(O={},(0,be.Z)(O,"is-empty",!ke.length),(0,be.Z)(O,"onday-no-events",!ke.length&&me),O)),children:ke.map(function(E){return(0,e.jsx)(r.J2,{content:(0,e.jsx)("div",{children:"12312313"}),children:(0,e.jsx)("span",{style:{backgroundColor:E.color},className:"event-day",children:E.title},E.id)},E.id)})})]},ee)})})]}),(0,e.jsx)(se,{calendarSets:(u==null?void 0:u.calendarSets)||Ke,onAction:de})]}),(0,e.jsx)(ra,{visible:C,onCancel:F})]})}var da=a.memo(ua),ca=da},78929:function(Re,Ze,o){"use strict";o.d(Ze,{f:function(){return k},y:function(){return R}});var be=o(19755),c=o.n(be);function k(ce){var a=parseInt(c()(ce).data("click-number")||0)+1;if(a==2)return clearTimeout(c()(ce).data("timer-reset")),c()(ce).data("click-number",0),!0;var Se=setTimeout(function(){c()(ce).data("click-number",0),clearTimeout(Se)},500);return c()(ce).data("click-number",a).data("timer-reset",Se),!1}function R(ce,a,Se,Ne,ae){var Me=ce.height/3/2,ie=Ne<Me&&Ne>-Me&&(Se==null?void 0:Se.parentKey)!==a.id;return ie?ae:Ne>0?ae+1:Ne<0?ae-1:NaN}}}]);
