(self.webpackChunk=self.webpackChunk||[]).push([[2581],{96708:function(U,k,a){"use strict";var l=a(46027),d=a(84048),v=a(86074);function g(c){var w=c.layout,L=c.children,j=c.onLayout;return(0,v.jsxs)("div",{className:"d-flex flex-wrap my-1",children:[w&&(0,v.jsxs)("ul",{className:"nav nav-pills me-6 mb-2 mb-sm-0",children:[(0,v.jsx)("li",{className:"nav-item m-0 me-3",children:(0,v.jsx)(d.Z,{variant:"light",color:"muted",active:w==="card",activeColor:"primary",onClick:j==null?void 0:j.bind(null,"card"),icon:(0,v.jsx)(l.ZP,{name:"Duotune/gen024",className:"svg-icon-1"})})}),(0,v.jsx)("li",{className:"nav-item m-0",children:(0,v.jsx)(d.Z,{variant:"light",color:"muted",active:w==="table",onClick:j==null?void 0:j.bind(null,"table"),activeColor:"primary",className:"me-3",icon:(0,v.jsx)(l.ZP,{name:"Duotune/abs015",className:"svg-icon-1"})})})]}),L]})}k.Z=g},85947:function(U,k,a){"use strict";a.d(k,{u7:function(){return l.u7},pM:function(){return l.pM},dP:function(){return l.dP},zR:function(){return l.zR},bo:function(){return l.bo},CF:function(){return l.CF},hT:function(){return l.hT},X4:function(){return l.X4},rq:function(){return l.rq},qb:function(){return l.qb},a$:function(){return l.a$},mp:function(){return l.mp},WE:function(){return l.WE},HC:function(){return l.HC},cT:function(){return t},Hr:function(){return ae},r3:function(){return l.r3},bI:function(){return l.bI},A6:function(){return l.A6},LV:function(){return l.LV}});var l=a(10557),d=a(15009),v=a.n(d),g=a(99289),c=a.n(g),w=a(5574),L=a.n(w),j=a(62435),Z=a(13757),D=a(86074);function ee(s,P){var x,T=(0,l.rz)({variables:{id:s==null?void 0:s.id},refetchQueries:[{query:l.dP,variables:{id:s==null||(x=s.application)===null||x===void 0?void 0:x.id}}]}),M=L()(T,1),e=M[0],Y=(0,j.useCallback)(c()(v()().mark(function H(){var W;return v()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,Z.Modal.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u8DEF\u7531\u5417\uFF1F",content:(0,D.jsxs)(D.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,D.jsx)("strong",{children:s.name}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]}),okText:"\u5220 \u9664",okClassName:"btn-danger"});case 2:if(W=N.sent,!W.isConfirmed){N.next=8;break}return N.next=6,e();case 6:Z.Toast.success("\u5220\u9664\u6210\u529F"),P(s);case 8:case"end":return N.stop()}},H)})),[e,s,P]);return[Y]}var t=ee,ne=a(97857),V=a.n(ne),X=a(12708);function re(s,P){var x,T,M,e=Z.Form.useForm(),Y=(0,j.useState)(!1),H=L()(Y,2),W=H[0],R=H[1],N=(0,l.X4)({fetchPolicy:"no-cache",refetchQueries:[{query:l.dP,variables:{id:s==null||(x=s.application)===null||x===void 0?void 0:x.id}}]}),J=L()(N,1),q=J[0],te=(0,l.LV)({fetchPolicy:"no-cache",refetchQueries:[{query:l.dP,variables:{id:s==null||(T=s.application)===null||T===void 0?void 0:T.id}}]}),ue=L()(te,1),_=ue[0],se=(0,j.useMemo)(function(){return s!=null&&s.id?c()(v()().mark(function K(){var n,r,o;return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return R(!0),u.prev=1,u.next=4,e.validateFields();case 4:return n=u.sent,u.next=7,Z.Toast.promise((0,X.gw)(_({variables:{id:s.id,input:V()({},n)}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,D.jsxs)(D.Fragment,{children:["\u8DEF\u7531 ",(0,D.jsx)("strong",{children:n.name})," \u4FDD\u5B58\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:r=u.sent,o=r.data,P(o.updateRoute),R(!1),u.next=16;break;case 13:u.prev=13,u.t0=u.catch(1),R(!1);case 16:case"end":return u.stop()}},K,null,[[1,13]])})):c()(v()().mark(function K(){var n,r,o;return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return R(!0),u.prev=1,u.next=4,e.validateFields();case 4:return n=u.sent,u.next=7,Z.Toast.promise((0,X.gw)(q({variables:{input:V()(V()({},n),{},{application:s.application.id})}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,D.jsxs)(D.Fragment,{children:["\u8DEF\u7531 ",(0,D.jsx)("strong",{children:n.name})," \u65B0\u589E\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:r=u.sent,o=r.data,P(o.createRoute),R(!1),u.next=16;break;case 13:u.prev=13,u.t0=u.catch(1),R(!1);case 16:case"end":return u.stop()}},K,null,[[1,13]])}))},[q,s==null||(M=s.application)===null||M===void 0?void 0:M.id,s==null?void 0:s.id,e,P,_]);return[se,{form:e,submitting:W}]}var ae=re},22581:function(U,k,a){"use strict";a.r(k),a.d(k,{default:function(){return K}});var l=a(97857),d=a.n(l),v=a(5574),g=a.n(v),c=a(62435),w=a(96974),L=a(46027),j=a(30381),Z=a.n(j),D=a(96708),ee=a(73588),t=a(13757),ne=a(49677),V=a.n(ne),X=a(50603),re=a(5618),ae=a(15009),s=a.n(ae),P=a(99289),x=a.n(P),T=a(12708),M=a(85947),e=a(86074);function Y(n,r){var o=t.Form.useForm(),m=(0,c.useState)(!1),u=g()(m,2),f=u[0],p=u[1],I=(0,M.CF)({fetchPolicy:"no-cache",refetchQueries:[{query:M.u7,variables:{id:n==null?void 0:n.libraryId}}]}),A=g()(I,1),F=A[0],$=(0,M.bI)({fetchPolicy:"no-cache",refetchQueries:[{query:M.u7,variables:{id:n==null?void 0:n.libraryId}}]}),C=g()($,1),b=C[0],O=(0,c.useMemo)(function(){return n!=null&&n.id?x()(s()().mark(function z(){var y,S,E;return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return p(!0),i.prev=1,i.next=4,o.validateFields();case 4:return y=i.sent,i.next=7,t.Toast.promise((0,T.gw)(b({variables:{id:n.id,input:d()(d()({},y),{},{libraryId:n.libraryId})}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,e.jsxs)(e.Fragment,{children:["\u7EC4\u4EF6 ",(0,e.jsx)("strong",{children:y.title})," \u4FDD\u5B58\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:S=i.sent,E=S.data,r(E.updateComponent),p(!1),i.next=16;break;case 13:i.prev=13,i.t0=i.catch(1),p(!1);case 16:case"end":return i.stop()}},z,null,[[1,13]])})):x()(s()().mark(function z(){var y,S,E;return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return p(!0),i.prev=1,i.next=4,o.validateFields();case 4:return y=i.sent,i.next=7,t.Toast.promise((0,T.gw)(F({variables:{input:d()(d()({},y),{},{libraryId:n.libraryId})}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,e.jsxs)(e.Fragment,{children:["\u7EC4\u4EF6 ",(0,e.jsx)("strong",{children:y.name})," \u65B0\u589E\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:S=i.sent,E=S.data,r(E.createComponent),p(!1),i.next=16;break;case 13:i.prev=13,i.t0=i.catch(1),p(!1);case 16:case"end":return i.stop()}},z,null,[[1,13]])}))},[F,n==null?void 0:n.libraryId,n==null?void 0:n.id,o,r,b]);return console.log("data",n),[O,{form:o,submitting:f}]}var H=Y;function W(n){var r=n.form;return(0,c.useEffect)(function(){var o=Object.assign({},(V()(n.data),n.data));n.data.id||r.resetFields(),r.setFieldsValue(d()({},o))},[r,n.data]),(0,e.jsx)(t.Form,{form:r,children:(0,e.jsxs)(t.Row,{children:[(0,e.jsxs)(t.Col,{span:8,children:[(0,e.jsx)(t.Form.Item,{rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],className:"d-flex flex-column mb-7",name:"title",label:"\u540D\u79F0",children:(0,e.jsx)(t.Input,{solid:!0})}),(0,e.jsx)(t.Form.Item,{className:"d-flex flex-column mb-7",name:"description",label:"\u63CF\u8FF0",children:(0,e.jsx)(t.Input.TextArea,{solid:!0})}),(0,e.jsx)(t.Form.Item,{className:"d-flex flex-column mb-7",name:"tags",label:"\u6807\u7B7E",children:(0,e.jsx)(re.ZP,{})}),(0,e.jsx)(t.Form.Item,{rules:[{required:!0,message:"\u7EC4\u4EF6\u6A21\u7248"}],className:"d-flex flex-column mb-7",name:"template",label:"\u6A21\u7248",children:(0,e.jsx)(X.zm,{placeholder:"\u9009\u62E9\u7EC4\u4EF6\u6A21\u7248"})})]}),(0,e.jsx)(t.Col,{span:4,children:(0,e.jsx)(t.Form.Item,{className:"mb-5",name:"image",label:"\u5C01\u9762\u56FE",help:"\u5141\u8BB8\u7684\u6587\u4EF6\u7C7B\u578B:png, jpg, jpeg\u3002",children:(0,e.jsx)(t.Upload.Image,{width:125,height:125,space:"Ohc2OaZ4",crop:{height:300,zoomable:!1,aspectRatio:1},background:"/assets/media/svg/avatars/blank.svg"})})})]})})}function R(n){var r=n.component,o=n.visible,m=n.onClose,u=n.onSuccess,f=n.onDeleteSuccess,p=H(r,u),I=g()(p,2),A=I[0],F=I[1],$=F.form,C=F.submitting,b=(0,c.useMemo)(function(){return r?d()(d()({},r),{},{template:r==null?void 0:r.template}):{type:"URL",index:0}},[r]);return(0,e.jsxs)(t.Modal,{width:640,centered:!0,onOk:A,confirmLoading:C,okText:"\u4FDD\u5B58",visible:o,onCancel:m,children:[(0,e.jsx)(t.Modal.Header,{closable:!0,children:r!=null&&r.id?(0,e.jsx)(e.Fragment,{children:"\u7F16\u8F91\u7EC4\u4EF6"}):(0,e.jsx)(e.Fragment,{children:"\u65B0\u589E\u7EC4\u4EF6"})}),(0,e.jsx)(t.Modal.Body,{children:r&&(0,e.jsx)(W,{submitting:C,data:b,libraryId:r==null?void 0:r.libraryId,form:$,submit:A,onDeleteSuccess:f})})]})}var N=R,J=a(10557);function q(n,r){var o=(0,c.useRef)(!1),m=(0,J._5)({refetchQueries:[{query:J.u7,variables:{id:n}}]}),u=g()(m,1),f=u[0],p=(0,c.useCallback)(function(){var I=x()(s()().mark(function A(F){var $;return s()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,t.Modal.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8BE5 \u7EC4\u4EF6\u5417\uFF1F",content:(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:F.title}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]}),okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!o.current},preConfirm:function(){var O=x()(s()().mark(function y(){var S,E,G;return s()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o.current=!0,h.prev=1,S=document.querySelector(".swal2-confirm"),S.textContent="\u5220\u9664\u4E2D...",E=document.createElement("span"),E.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),S.appendChild(E),h.next=9,(0,T.gw)(f({variables:{id:F.id,libraryId:n}}),350);case 9:G=h.sent,t.Toast.success("\u5220\u9664\u6210\u529F"),console.log(G),h.next=17;break;case 14:h.prev=14,h.t0=h.catch(1),t.Toast.error("\u4FDD\u5B58\u5931\u8D25");case 17:return h.prev=17,o.current=!1,h.finish(17);case 20:case"end":return h.stop()}},y,null,[[1,14,17,20]])}));function z(){return O.apply(this,arguments)}return z}()});case 2:$=b.sent,$.isConfirmed&&r(F);case 4:case"end":return b.stop()}},A)}));return function(A){return I.apply(this,arguments)}}(),[f,n,r]);return[p]}var te=q;function ue(n){var r=n.data,o=n.onEdit,m=n.onDelete,u=(0,w.s0)(),f=(0,c.useCallback)(function(){o(r)},[r,o]),p=(0,c.useCallback)(function(){m(r)},[r,m]),I=(0,c.useCallback)(function(){u("/designs/".concat(r.id))},[r]);return(0,e.jsx)(t.Col,{md:3,children:(0,e.jsx)(t.Card,{flush:!0,className:"h-md-100",children:(0,e.jsxs)(t.Card.Body,{children:[(0,e.jsxs)("div",{className:"d-flex flex-stack mb-3",children:[(0,e.jsxs)(t.Badge,{color:"light",children:[(0,e.jsx)(e.Fragment,{children:r.tags&&r.tags.length?r.tags[0]+"/":null}),(0,e.jsx)(e.Fragment,{children:r.title+"("+r.id+")"})]}),(0,e.jsx)("div",{children:(0,e.jsx)(t.Dropdown,{overlay:(0,e.jsxs)(t.Menu,{className:"menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fs-7 fw-bold w-200px py-3",children:[(0,e.jsx)(t.Menu.Item,{onClick:f,className:"px-3",children:"\u7F16\u8F91"}),(0,e.jsx)(t.Menu.Item,{onClick:I,className:"px-3",children:"\u8BBE\u8BA1"}),(0,e.jsx)(t.Menu.Item,{onClick:p,className:"px-3",children:"\u5220\u9664"})]}),placement:"bottomRight",children:(0,e.jsx)(t.Button,{variant:!1,color:"light-dark",activeColor:"light-primary",icon:(0,e.jsx)(L.JO,{className:"svg-icon-2",name:"Duotune/gen024"})})})})]}),(0,e.jsx)("div",{className:"mb-3",children:(0,e.jsx)("a",{onClick:f,children:(0,e.jsxs)("div",{className:"position-relative",children:[(0,e.jsxs)("div",{className:"overlay overlay-show",children:[(0,e.jsx)("div",{className:"bgi-no-repeat bgi-position-center bgi-size-cover card-rounded h-200px",style:{backgroundImage:"url('/assets/media/background/mage_icon.png')"}}),(0,e.jsx)("div",{className:"overlay-layer rounded",style:{opacity:.4}})]}),(0,e.jsxs)("div",{className:"position-absolute text-white mb-4 ms-4 bottom-0",children:[(0,e.jsx)("span",{className:"text-white fs-4 fw-bolder mb-1",children:r.title}),(0,e.jsx)("div",{className:"fs-6 fw-bold mb-5",children:r.description})]})]})})}),(0,e.jsxs)("div",{className:"d-flex flex-stack flex-wrapr",children:[(0,e.jsx)(t.Symbol.Avatar,{shape:"circle",size:35,alt:"\u6D4B"}),(0,e.jsx)("div",{className:"d-flex my-1",children:(0,e.jsx)("div",{className:"py-2 px-3 ms-3",children:(0,e.jsx)("span",{className:"ms-1 fs-7 fw-bolder text-gray-600",children:r.createdAt&&Z()(r.createdAt).format("YYYY-MM-DD HH:mm")})})})]})]})})})}function _(n){var r=n.layout,o=n.components,m=n.onEdit,u=n.onDelete;return r==="table"?(0,e.jsx)(t.Card,{children:(0,e.jsx)(t.Card.Body,{children:(0,e.jsx)(t.Table,{columns:[{key:"name",title:"\u540D\u79F0",width:"auto"},{key:"createAt",title:"\u521B\u5EFA\u4EBA",width:200},{key:"actions",title:"\u64CD\u4F5C",width:200}],dataSource:o})})}):(0,e.jsx)(t.Row,{gutter:{default:5,xl:9},cols:{default:1,md:3,xl:4},children:o.map(function(f){return(0,e.jsx)(ue,{data:f,onDelete:u,onEdit:m},f.id)})})}function se(){var n,r=(0,w.bx)(),o=r.app,m=o.dependencies.find(function(B){return B.name==="component.library"}).value,u=(0,c.useState)("card"),f=g()(u,2),p=f[0],I=f[1],A=(0,c.useState)({visible:!1}),F=g()(A,2),$=F[0],C=F[1],b=(0,M.qb)({variables:{id:m},fetchPolicy:"cache-and-network"}),O=b.data,z=b.loading,y=(O==null||(n=O.library)===null||n===void 0?void 0:n.components)||[],S=(0,c.useCallback)(function(B){C(function(Q){return d()(d()({},Q),{},{visible:!1,component:B})})},[C]),E=(0,c.useCallback)(function(B){C(function(Q){var le;return((le=Q.component)===null||le===void 0?void 0:le.id)!==B.id?Q:d()(d()({},Q),{},{visible:!1,component:void 0})})},[C]),G=te(m,E),i=g()(G,1),h=i[0],ie=(0,c.useCallback)(function(){C(function(B){return d()(d()({},B),{},{visible:!1})})},[]),oe=(0,c.useCallback)(function(){C(function(B){return d()(d()({},B),{},{visible:!0,component:{libraryId:m}})})},[m]),de=(0,c.useCallback)(function(B){C(function(Q){return d()(d()({},Q),{},{visible:!0,component:d()(d()({},B),{},{libraryId:m})})})},[m]);return(0,e.jsxs)(ee.vs,{header:{title:"\u7EC4\u4EF6\u8BBE\u7F6E"},loading:z,children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap flex-stack pb-7",children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,e.jsxs)("h3",{className:"fw-bolder me-5",children:["\u7EC4\u4EF6 (",y.length,")"]}),(0,e.jsx)(t.Input.Search,{placeholder:"\u641C\u7D22",className:"border-body bg-body w-250px"})]}),(0,e.jsx)(D.Z,{layout:p,onLayout:I,children:(0,e.jsx)("div",{className:"d-flex my-0",children:(0,e.jsx)(t.Button,{onClick:oe,children:"\u65B0\u589E\u7EC4\u4EF6"})})})]}),(0,e.jsx)(_,{layout:p,onEdit:de,onDelete:h,components:y}),(0,e.jsx)(N,{component:$.component,onClose:ie,onSuccess:S,onDeleteSuccess:E,visible:$.visible})]})}var K=se},49677:function(U){function k(a){if(a==null)throw new TypeError("Cannot destructure "+a)}U.exports=k,U.exports.__esModule=!0,U.exports.default=U.exports}}]);
