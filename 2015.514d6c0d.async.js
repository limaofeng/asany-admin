(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[2015],{2015:function(gr,Se,C){"use strict";C.d(Se,{Z:function(){return Je}});var Ae=C(93224),g=C(39428),R=C(3182),P=C(2824),re=C(11849),Ce=C(86582),r=C(67294),D=C(28865),Re=C(94184),J=C.n(Re),Me=C(13356),Te=C(51615),xe=C(7020),e=C(85893);function ze(i){var a=i.paths,s=i.onClick;console.log("FolderPath",a);var h=(0,r.useCallback)(function(f){return function(d){d.preventDefault(),d.stopPropagation(),s(f)}},[s]);return(0,e.jsx)("div",{className:"folder-path badge badge-lg badge-white",children:(0,e.jsx)("div",{className:"d-flex align-items-center flex-wrap",children:a.map(function(f,d){var m=d==0,E=d==a.length-1;return(0,e.jsxs)(r.Fragment,{children:[!m&&(0,e.jsx)(D.ZP,{name:m?"Duotune/abs039":"Duotune/arr071",className:J()("svg-icon-2 svg-icon-primary",{"mx-1":!m,"me-3":m})}),E?f.name:(0,e.jsx)("a",{href:d==0?"/drive/my-drive":"/drive/folders/".concat(f.id),onClick:h(f),children:f.name})]},f.id)})})})}var $e=ze,$=C(14928),Ne=C(1861),we=C(73727),n=C(51186),ye=C(54108);function Ie(){return(0,e.jsx)(e.Fragment,{children:"\u65E5\u5FD7"})}function Oe(i){var a=(0,r.useState)(i.file),s=(0,P.Z)(a,2),h=s[0],f=s[1],d=(0,$.lK)({fetchPolicy:"cache-and-network",variables:{id:i.file.id}}),m=d.data,E=d.loading;return(0,r.useEffect)(function(){(m==null?void 0:m.file)&&f(m==null?void 0:m.file)},[m==null?void 0:m.file]),(0,e.jsxs)(n.bH,{overlayClassName:"bg-white bg-opacity-25",className:"pt-5",loading:E,children:[!h.isDirectory&&(0,e.jsx)("div",{className:"file-preview mb-6",children:(0,e.jsx)(n.mN,{src:"//api.asany.cn/graphql"+"/thumbnail/".concat(h.id,"?size=120x120")})}),!1,(0,e.jsx)("div",{className:"fs-6 text-gray-800 mb-4",children:"\u7CFB\u7EDF\u5C5E\u6027"}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u7C7B\u578B"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:h.isDirectory?"\u6587\u4EF6\u5939":h.mimeType})})]}),!h.isDirectory&&(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u5927\u5C0F"}),(0,e.jsx)("div",{className:"col-lg-9 fv-row",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:(0,ye.jb)(h.size)})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u4F4D\u7F6E"}),(0,e.jsxs)("div",{className:"col-lg-9 d-flex align-items-center flex-wrap",children:[(0,e.jsx)(we.Link,{className:"tw-truncate mw-90px",to:"/drive/my-drive",children:"\u5168\u90E8\u6587\u4EF6"}),(h.parents||[]).map(function(k){return(0,e.jsxs)(r.Fragment,{children:[(0,e.jsx)(D.ZP,{name:"Duotune/arr071",className:J()("svg-icon-5 svg-icon-primary")}),(0,e.jsx)(we.Link,{className:"tw-truncate mw-90px",to:"/drive/folders/".concat(k.id),children:k.name})]},k.id)})]})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u4FEE\u6539\u65F6\u95F4"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:h.lastModified})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u521B\u5EFA\u65F6\u95F4"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:h.createdAt})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u8BF4\u660E"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:h.description})})]})]})}function Le(i){var a=i.file;return(0,e.jsxs)(n.mQ,{className:"nav-line-tabs-2x",children:[(0,e.jsx)(n.mQ.TabPane,{tab:"\u6587\u4EF6\u8BE6\u60C5",children:(0,e.jsx)(Ne.E,{className:"flex-column-fluid custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(Oe,{file:a})})},"file-details"),(0,e.jsx)(n.mQ.TabPane,{tab:"\u64CD\u4F5C\u8BB0\u5F55",children:(0,e.jsx)(Ne.E,{className:"flex-column-fluid custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(Ie,{})})},"action-records")]})}function Ve(i){var a=i.files,s=i.currentFolder,h=(0,r.useMemo)(function(){return a.length==1?"file_details":a.length>1?"many_file_details":"current_folder"},[a]),f=(0,r.useMemo)(function(){return h==="file_details"?a[0].name:h==="many_file_details"?"\u591A\u4E2A\u6587\u4EF6":(s==null?void 0:s.name)||""},[s==null?void 0:s.name,a,h]),d=(0,r.useMemo)(function(){var T=f.lastIndexOf(".");return T==-1?[f,void 0]:[f.substring(0,T),f.substring(T+1)]},[f]),m=(0,P.Z)(d,2),E=m[0],k=m[1];return(0,e.jsxs)("div",{className:"preview-container",children:[(0,e.jsx)("div",{className:"preview-header",children:(0,e.jsx)("h4",{className:J()({"tw-truncate":!k,"d-flex":k}),children:k?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"file-title shrink tw-truncate",children:E}),(0,e.jsxs)("span",{className:"file-suffix",children:[".",k]})]}):E})}),(0,e.jsx)("div",{className:"preview-body",children:h=="file_details"&&(0,e.jsx)(Le,{file:a[0]})})]})}var He=Ve,ce=C(25496);function We(i){var a=i.data,s=i.editable,h=i.onClick,f=i.onCancelRename,d=i.onSuccess,m=(0,r.useRef)(null),E=(0,r.useState)(!1),k=(0,P.Z)(E,2),T=k[0],p=k[1],ae=(0,r.useState)(a.name),V=(0,P.Z)(ae,2),S=V[0],H=V[1],Y=(0,$.Ep)(),se=(0,P.Z)(Y,1),N=se[0],ne=(0,r.useCallback)(function(c){H(c.target.value)},[]),W=(0,r.useCallback)(function(){var c=(0,R.Z)((0,g.Z)().mark(function z(y){var de,te,w;return(0,g.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return y.stopPropagation(),B.prev=1,p(!0),B.next=5,(0,ce.gw)(N({variables:{id:a.id,name:S}}),350);case 5:return de=B.sent,te=de.data,d(te.file),B.next=10,(0,ce._v)(350);case 10:p(!1),f(),B.next=22;break;case 14:return B.prev=14,B.t0=B.catch(1),p(!1),B.next=19,n.FN.error(B.t0.message,2e5,{progressBar:!0,placement:"middle-center"});case 19:return B.next=21,(0,ce._v)(300);case 21:(w=m.current)===null||w===void 0||w.select();case 22:case"end":return B.stop()}},z,null,[[1,14]])}));return function(z){return c.apply(this,arguments)}}(),[a.id,S,f,d,N]),I=(0,r.useCallback)(function(c){c.preventDefault(),W(c)},[W]),le=(0,r.useCallback)(function(c){c.stopPropagation(),c.preventDefault(),f()},[f]),A=(0,r.useCallback)(function(c){h(a),c.preventDefault(),c.stopPropagation()},[a,h]);(0,r.useEffect)(function(){var c;H(function(){return a.name}),!!s&&((c=m.current)===null||c===void 0||c.select(0,a.name.length-(a.extension?a.extension.length+1:0)))},[a.extension,a.name,s]);var K=(0,r.useCallback)(function(c){s&&(c.stopPropagation(),c.preventDefault())},[s]),O=(0,r.useMemo)(function(){var c,z;return((c=a.mimeType)===null||c===void 0?void 0:c.startsWith("image/"))||((z=a.mimeType)===null||z===void 0?void 0:z.startsWith("video/"))},[a.mimeType]);return(0,e.jsxs)("div",{onClick:K,className:J()("d-flex align-items-center",{"no-selecto-drag":s}),children:[(0,e.jsxs)("div",{className:"title-icon-container position-relative me-1 d-flex align-items-center justify-content-center",children:[O?(0,e.jsx)(n.mN,{alt:(0,e.jsx)(D.ZP,{name:"Duotune/".concat(a.isDirectory?"fil012":"fil003"),className:"svg-icon-2x svg-icon-primary"}),src:"//api.asany.cn/graphql"+"/thumbnail/".concat(a.id,"?size=120x120")}):(0,e.jsx)(D.ZP,{name:"Duotune/".concat(a.isDirectory?"fil012":"fil003"),className:"svg-icon-2x svg-icon-primary"}),a.starred&&(0,e.jsx)(D.ZP,{name:"Bootstrap/star-fill",className:"position-absolute starred-flag"})]}),s?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.II,{ref:m,value:S,onChange:ne,onPressEnter:I,placeholder:"\u8F93\u5165\u65B0\u6587\u4EF6\u5939\u540D\u79F0",size:"sm",className:"mw-250px me-3"}),(0,e.jsx)(n.zx,{as:"button",loading:T,variant:"light-primary",size:"sm",icon:(0,e.jsx)(D.ZP,{name:"Duotune/arr085",className:"svg-icon-1"}),className:"me-3",onClick:W}),(0,e.jsx)(n.zx,{as:"button",size:"sm",variant:"light-danger",icon:(0,e.jsx)(D.ZP,{name:"Duotune/arr088",className:"svg-icon-1"}),className:"svg-icon-1",onClick:le})]}):(0,e.jsx)("a",{className:"text-gray-800 text-hover-primary no-selecto-drag",onClick:A,href:a.isDirectory?"/drive/folders/".concat(a.id):"/preview/".concat(a.id),children:a.name})]})}var Ke=We;function Qe(i){var a=i.visible,s=i.onCancel,h=i.onSuccess,f=i.parentFolder,d=(0,r.useState)("\u672A\u547D\u540D\u6587\u4EF6\u5939"),m=(0,P.Z)(d,2),E=m[0],k=m[1],T=(0,r.useState)(!1),p=(0,P.Z)(T,2),ae=p[0],V=p[1],S=(0,$.we)(),H=(0,P.Z)(S,2),Y=H[0],se=H[1].loading,N=(0,r.useRef)(null),ne=(0,r.useCallback)(function(){s()},[s]),W=(0,r.useCallback)(function(A){k(A.target.value),V(!A.target.value)},[]),I=(0,r.useCallback)((0,R.Z)((0,g.Z)().mark(function A(){var K,O,c;return(0,g.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(E){y.next=2;break}return y.abrupt("return");case 2:return y.prev=2,y.next=5,Y({variables:{name:E,parentFolder:f}});case 5:K=y.sent,O=K.data,s&&s(),(O==null?void 0:O.folder)&&h(O.folder),n.FN.success("\u6587\u4EF6\u5939\u65B0\u589E\u6210\u529F",2e3,{progressBar:!0,placement:"bottom-start"}),y.next=19;break;case 12:return y.prev=12,y.t0=y.catch(2),y.next=16,n.FN.error(y.t0.message,2e3,{progressBar:!0});case 16:return y.next=18,(0,ce._v)(300);case 18:(c=N.current)===null||c===void 0||c.select();case 19:case"end":return y.stop()}},A,null,[[2,12]])})),[Y,s,h,f,E]),le=(0,r.useCallback)(function(){I()},[I]);return(0,r.useEffect)(function(){if(a){var A;(A=N.current)===null||A===void 0||A.select()}else k("\u672A\u547D\u540D\u6587\u4EF6\u5939"),V(!1)},[a]),(0,e.jsx)(n.u_,{centered:!0,visible:a,dialogClassName:"modal-dialog-small w-400px",onCancel:ne,onOk:I,title:"\u65B0\u5EFA\u6587\u4EF6\u5939",closable:!1,okButtonProps:{loading:se,className:J()({disabled:ae})},headerClassName:"border-bottom-0",bodyClassName:"py-2",footerClassName:"border-top-0",children:(0,e.jsx)(n.II,{ref:N,onPressEnter:le,onChange:W,value:E})})}var Ge=Qe,Ue=["role","tabIndex","onClick"];function De(i,a){var s=i?[{id:i.id,name:i.name,isDirectory:!0,isRootFolder:!0,path:"/"}]:[];return!!a&&a.id!==(i==null?void 0:i.id)&&(a.parents&&s.push.apply(s,(0,Ce.Z)(a.parents)),a.isRootFolder||s.push((0,re.Z)({},a))),s}function Xe(i){var a=i.folder,s=i.rootFolder,h=i.filter,f=i.toolbar,d=f===void 0?"default":f,m=(0,Te.k6)(),E=(0,xe.tT)("cloud-drive.index",function(l){var o=l.state;return o.cloudDrive}),k=(0,xe.tT)("cloud-drive.index",function(l){return l.upload}),T=(0,xe.tT)("cloud-drive.index",function(l){return l.download}),p=(0,r.useRef)({sorter:i.orderBy||{field:"name",order:"ascend"},rootFolder:s,newFolderVisible:!1,currentFolder:i.currentFolder}),ae=(0,r.useReducer)(function(l){return l+1},0),V=(0,P.Z)(ae,2),S=V[1],H=(0,r.useCallback)(function(){p.current.newFolderVisible=!0,S()},[]),Y=(0,r.useCallback)(function(){p.current.newFolderVisible=!1,S()},[]),se=(0,$.rn)({fetchPolicy:"cache-and-network",variables:{folder:a}}),N=se.data,ne=(0,$.tz)(),W=(0,P.Z)(ne,1),I=W[0],le=(0,$._D)(),A=(0,P.Z)(le,1),K=A[0],O=(0,$.HD)(),c=(0,P.Z)(O,1),z=c[0],y=(0,$.fX)(),de=(0,P.Z)(y,1),te=de[0],w=p.current.sorter,ke=(0,r.useMemo)(function(){return w?"isDirectory_desc,"+w.field+"_"+(w.order=="ascend"?"asc":"desc"):"isDirectory_desc,name_asc"},[w]),B=(0,$.Eo)(s==null?void 0:s.id,h,ke),me=(0,P.Z)(B,4),Q=me[0],ve=me[1],Ze=me[2],ie=me[3],G=ie.loadedCount,U=ie.allItems,fe=ie.refetch,ue=ie.refetchForObjects,q=ie.refetchWithRemoveForObjects,_=(0,r.useMemo)(function(){return{loadedCount:G,rowCount:Q.totalCount,get items(){return U()},useItem:Ze}},[U,G,Q.totalCount,Ze]),Ye=(0,r.useState)([]),Ee=(0,P.Z)(Ye,2),b=Ee[0],X=Ee[1],ee=(0,r.useMemo)(function(){return i.currentFolder&&N!==null&&N!==void 0&&N.currentFolder&&i.currentFolder.id!=N.currentFolder.id&&i.currentFolder.path.startsWith(N.currentFolder.path)?p.current.currentFolder=i.currentFolder:N!=null&&N.currentFolder?p.current.currentFolder=N==null?void 0:N.currentFolder:p.current.currentFolder},[N==null?void 0:N.currentFolder,i.currentFolder]),qe=(0,r.useCallback)(function(l){X(l)},[X]),_e=(0,r.useCallback)(function(){var l=(0,R.Z)((0,g.Z)().mark(function o(t){return(0,g.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,ue([t],function(F,v){return F.id==v.id});case 2:case"end":return x.stop()}},o)}));return function(o){return l.apply(this,arguments)}}(),[ue]),Z=(0,r.useMemo)(function(){if(b.length==1)return U().find(function(l){return l&&l.id==b[0]})},[U,b]),er=(0,r.useCallback)(function(){p.current.renameFile=void 0,S()},[]),rr=(0,r.useMemo)(function(){return De(s,ee)},[s,ee]),Be=(0,r.useCallback)(function(){var l=(0,R.Z)((0,g.Z)().mark(function o(t){var u,x,F;return(0,g.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(d!="trash"){j.next=4;break}return j.next=3,n.u_.confirm({title:(0,e.jsxs)(e.Fragment,{children:["\u6B64\u6587\u4EF6",t.isDirectory&&"\u5939","\u4F4D\u4E8E\u60A8\u7684\u56DE\u6536\u7AD9\u4E2D"]}),content:(0,e.jsxs)(e.Fragment,{children:["\u8981\u67E5\u770B\u8BE5\u6587\u4EF6",t.isDirectory&&"\u5939","\uFF0C\u60A8\u9700\u8981\u5C06\u5176\u4ECE\u56DE\u6536\u7AD9\u8FD8\u539F\u3002"]}),okText:"\u8FD8\u539F"});case 3:return j.abrupt("return");case 4:if(!t.isDirectory){j.next=9;break}return u=(0,re.Z)({},t),t.isRootFolder||(x=[].concat((0,Ce.Z)(De(p.current.rootFolder,p.current.currentFolder)),[u]),u.parents=x.slice(1,x.length-1),F=u.parents.findIndex(function(M){return M.path==t.path}),F!=-1&&(u.parents=u.parents.slice(0,F))),t.isRootFolder?m.push("/drive/my-drive",{rootFolder:s,currentFolder:u,orderBy:p.current.sorter}):m.push("/drive/folders/".concat(t.id),{rootFolder:s,currentFolder:u,orderBy:p.current.sorter}),j.abrupt("return");case 9:case"end":return j.stop()}},o)}));return function(o){return l.apply(this,arguments)}}(),[d,m,s]),ar=(0,r.useCallback)(function(){return(0,e.jsxs)("div",{className:"clouddrive-listfiles-no-rows d-flex flex-column flex-center",children:[(0,e.jsx)("img",{src:"/assets/media/illustrations/sketchy-1/5.png",className:"mw-200px"}),(0,e.jsx)("div",{className:"fs-1 fw-bolder text-dark mb-4",children:"\u5C06\u6587\u4EF6\u62D6\u62FD\u5230\u6B64\u5904"}),(0,e.jsxs)("div",{className:"fs-6",children:["\u6216\u70B9\u51FB \u201C",(0,e.jsx)("span",{className:"text-success",children:"\u4E0A\u4F20"}),"\u201D \u6309\u94AE"]})]})},[]),sr=(0,r.useCallback)(function(){return Q.totalCount==G&&G==0?ve?(0,e.jsx)(e.Fragment,{children:"\u52A0\u8F7D\u4E2D...."}):(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(e.Fragment,{children:[Q.totalCount==G?(0,e.jsx)(e.Fragment,{children:"\u5DF2\u5168\u90E8\u52A0\u8F7D"}):(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u52A0\u8F7D ",G," \u4E2A"]}),"\uFF0C\u5171 ",Q.totalCount," \u4E2A"]})},[G,ve,Q.totalCount]),ge=U().filter(function(l){return b.includes(l.id)}).every(function(l){return l.starred}),nr=(0,r.useCallback)(function(l,o,t){p.current.sorter=t,S()},[]),lr=(0,r.useMemo)(function(){return _.items.filter(function(l){return b.some(function(o){return o==l.id})})},[_,b]),tr=(0,r.useCallback)(function(){var l=(0,R.Z)((0,g.Z)().mark(function o(t){var u;return(0,g.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,fe(1);case 2:u=U(),u.some(function(v){return v&&v.id==t.id})&&X([t.id]);case 4:case"end":return F.stop()}},o)}));return function(o){return l.apply(this,arguments)}}(),[fe,U]),he=(ee==null?void 0:ee.id)||(s==null?void 0:s.id);(0,r.useEffect)(function(){X([])},[he,s==null?void 0:s.name]);var ir=(0,r.useCallback)(function(l){k(l,{space:E.space,folder:he})},[E,he,k]),pe=(0,Me.uI)({onDrop:ir}),ur=pe.getRootProps,or=pe.getInputProps,cr=pe.isDragActive;console.log("isDragActive",cr);var Fe=ur(),pr=Fe.role,br=Fe.tabIndex,be=Fe.onClick,dr=(0,Ae.Z)(Fe,Ue),mr=(0,r.useCallback)(function(l){be&&be(l)},[be]),vr=(0,r.useCallback)((0,R.Z)((0,g.Z)().mark(function l(){var o,t,u;return(0,g.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:o=_.items,t=o.filter(function(v){return b.includes(v.id)}),u=t.length==1?t[0].name:"\u3010\u6279\u91CF\u4E0B\u8F7D\u3011".concat(t[0].name," \u7B49 (").concat(t.length,").zip"),T(t,u);case 4:case"end":return F.stop()}},l)})),[_,T,b]),fr=(0,r.useCallback)((0,R.Z)((0,g.Z)().mark(function l(){var o,t,u,x;return(0,g.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=Z?Z!=null&&Z.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":b.length+" \u9879\u5185\u5BB9",v.next=3,n.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:"\u786E\u5B9A\u5220\u9664\u6240\u9009\u7684\u6587\u4EF6\u5417\uFF1F"}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u6587\u4EF6\u53EF\u5728 10\u5929 \u5185\u901A\u8FC7\u56DE\u6536\u7AD9\u8FD8\u539F"})]}),icon:"info",okText:"\u5220\u9664"});case 3:if(t=v.sent,t.isConfirmed){v.next=6;break}return v.abrupt("return");case 6:return v.next=8,K({variables:{ids:b}});case 8:u=v.sent,x=u.data,X([]),q(x==null?void 0:x.files,function(j,M){return j.id==M.id}),n.FN.success(o+" \u5DF2\u79FB\u81F3\u56DE\u6536\u7AD9",2e3,{placement:"bottom-start",progressBar:!0});case 13:case"end":return v.stop()}},l)})),[K,q,Z,b]),hr=(0,r.useCallback)((0,R.Z)((0,g.Z)().mark(function l(){var o;return(0,g.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,n.u_.confirm({title:"\u6E05\u7A7A\u56DE\u6536\u7AD9",content:"\u7CFB\u7EDF\u5C06\u6C38\u4E45\u5220\u9664\u56DE\u6536\u7AD9\u4E2D\u7684\u5185\u5BB9\uFF0C\u6B64\u64CD\u4F5C\u65E0\u6CD5\u6062\u590D \uFF1F"});case 2:if(o=u.sent,o.isConfirmed){u.next=5;break}return u.abrupt("return");case 5:return u.next=7,z({variables:{folder:a}});case 7:fe(1),n.FN.success("\u56DE\u6536\u7AD9\u5DF2\u88AB\u6E05\u7A7A",2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return u.stop()}},l)})),[z,a,fe]),Pe=(0,r.useCallback)((0,R.Z)((0,g.Z)().mark(function l(){var o,t,u,x;return(0,g.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o=Z?Z!=null&&Z.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":b.length+" \u9879\u5185\u5BB9",v.next=3,n.u_.confirm({title:"\u786E\u5B9A\u8FD8\u539F",content:"\u786E\u8BA4\u8FD8\u539F\u9009\u4E2D\u7684 "+o+" \uFF1F"});case 3:if(t=v.sent,t.isConfirmed){v.next=6;break}return v.abrupt("return");case 6:return v.next=8,te({variables:{ids:b}});case 8:u=v.sent,x=u.data,X([]),q(x==null?void 0:x.files,function(j,M){return j.id==M.id}),n.FN.success(o+" \u8FD8\u539F\u6210\u529F",2e3,{placement:"bottom-start",progressBar:!0});case 13:case"end":return v.stop()}},l)})),[q,te,Z,b]),je=(0,r.useCallback)((0,R.Z)((0,g.Z)().mark(function l(){var o,t,u,x,F;return(0,g.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(o=Z?Z!=null&&Z.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":b.length+" \u9879\u5185\u5BB9",!ge){j.next=10;break}return j.next=4,I({variables:{ids:b,mode:"REMOVE"}});case 4:t=j.sent,u=t.data,ue(u==null?void 0:u.files,function(M,oe){return M.id==oe.id}),n.FN.success(o+"\u5DF2\u4ECE\u6536\u85CF\u4E2D\u79FB\u9664",2e3,{placement:"bottom-start",progressBar:!0}),j.next=16;break;case 10:return j.next=12,I({variables:{ids:b,mode:"ADD"}});case 12:x=j.sent,F=x.data,d=="starred"?(X([]),q(F==null?void 0:F.files,function(M,oe){return M.id==oe.id})):ue(F==null?void 0:F.files,function(M,oe){return M.id==oe.id}),n.FN.success(o+" \u5DF2\u6DFB\u52A0\u5230\u6536\u85CF",2e3,{placement:"bottom-start",progressBar:!0});case 16:S();case 17:case"end":return j.stop()}},l)})),[ue,q,Z,b,I,ge,d]),Fr=(0,r.useCallback)((0,R.Z)((0,g.Z)().mark(function l(){return(0,g.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:p.current.renameFile=Z,S();case 2:case"end":return t.stop()}},l)})),[Z]),L=(0,r.useMemo)(function(){return b.length?b.length==1?"row":"multi-row":"no_rows"},[b.length]),xr=(0,r.useMemo)(function(){if(d=="starred")return function(){return(0,e.jsx)("div",{children:(0,e.jsx)(n.zx,{color:"success",variant:!1,className:"trash-restore",onClick:je,icon:(0,e.jsx)(D.ZP,{name:"Duotune/arr029",className:"svg-icon-4 svg-icon-success"}),children:"\u53D6\u6D88\u6536\u85CF"})})};if(d=="trash")return function(){return(0,e.jsx)("div",{children:(0,e.jsx)(n.zx,{color:"success",variant:!1,className:"trash-restore",onClick:Pe,icon:(0,e.jsx)(D.ZP,{name:"Duotune/arr029",className:"svg-icon-4 svg-icon-success"}),children:"\u8FD8\u539F"})})}},[Pe,je,d]);return(0,e.jsxs)(n.Zb,{flush:!0,children:[d=="default"&&(0,e.jsxs)(n.Zb.Header,{className:"pt-8 flex-row-reverse",children:[(0,e.jsx)(n.Zb.Title,{children:(0,e.jsx)(n.II.Search,{size:"lg",solid:!0,className:"rounded-2 w-300px",placeholder:"\u641C\u7D22 \u6587\u4EF6 & \u6587\u4EF6\u5939"})}),(0,e.jsx)(n.Zb.Toolbar,{children:(0,e.jsxs)("div",{className:J()("d-flex justify-content-end",{"file-action-group px-3 gap-2":["row","multi-row"].includes(L)}),children:[L=="no_rows"&&(0,e.jsxs)(e.Fragment,{children:[d=="default"&&(0,e.jsx)(n.zx,{variant:"primary",className:"rounded-2 me-3",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/fil018"}),onClick:mr,children:"\u4E0A\u4F20\u6587\u4EF6"}),d=="default"&&(s==null?void 0:s.isRootFolder)&&(0,e.jsx)(n.zx,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/fil013"}),onClick:H,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"})]}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.zx,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/arr095"}),children:"\u5206\u4EAB"}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.zx,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",style:{transform:"rotateZ(90deg)"},name:"Duotune/arr076"}),onClick:vr,children:"\u4E0B\u8F7D"}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.zx,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/gen027"}),onClick:fr,children:"\u5220\u9664"}),L=="row"&&(0,e.jsx)(n.zx,{as:"button",variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/gen055"}),onClick:Fr,children:"\u91CD\u547D\u540D"}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.zx,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/arr033"}),children:"\u79FB\u52A8"}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.zx,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/abs024"}),onClick:je,children:ge?"\u53D6\u6D88\u6536\u85CF":"\u6536\u85CF"})]})})]}),(0,e.jsxs)(n.Zb.Body,{className:"d-flex flex-row",children:[(0,e.jsxs)("div",(0,re.Z)((0,re.Z)({className:"flex-row-fluid"},dr),{},{children:[(0,e.jsxs)("div",{className:"d-flex flex-stack",children:[(0,e.jsx)($e,{onClick:Be,paths:rr}),(0,e.jsx)(n.Ct,{size:"lg",color:"white",children:sr()})]}),d=="trash"&&!!_.rowCount&&(0,e.jsx)(n.bZ,{theme:"Light",type:"primary",action:(0,e.jsx)(n.zx,{onClick:hr,variant:"light-primary",className:"me-3 ls-1",children:"\u6E05\u7A7A\u56DE\u6536\u7AD9"}),message:"\u5185\u5BB9\u79FB\u81F3\u56DE\u6536\u7AD9\u540E\u4F1A\u5728 10 \u5929\u540E\u88AB\u6C38\u4E45\u5220\u9664"}),(0,e.jsx)("input",(0,re.Z)({},or())),(0,e.jsx)(n.bH,{overlayClassName:"bg-white bg-opacity-25",loading:ve,children:!Q.totalCount&&!ve?ar():(0,e.jsx)(n.iA,{rowKey:"id",hover:!0,rowSelection:{type:"checkbox",selectedRowKeys:b,renderTitle:function(o){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:o}),"\u4E2A\u6587\u4EF6/\u6587\u4EF6\u5939"]})},toolbar:xr,onChange:qe},rowHeight:50,columns:[{key:"name",title:(0,e.jsx)("span",{className:"ps-2",children:"\u6587\u4EF6\u540D"}),className:"min-w-250px",sorter:!0,sortOrder:(w==null?void 0:w.field)=="name"?w.order:void 0,render:function(o,t){var u;return(0,e.jsx)(Ke,{onClick:Be,onSuccess:_e,onCancelRename:er,data:t,editable:t.id==((u=p.current.renameFile)===null||u===void 0?void 0:u.id)})}},{key:"lastModified",title:"\u66F4\u65B0\u65F6\u95F4",sorter:!0,className:"min-w-125px",sortOrder:(w==null?void 0:w.field)=="lastModified"?w.order:void 0},{key:"size",title:"\u6587\u4EF6\u5927\u5C0F",sorter:!0,className:"min-w-100px",sortOrder:(w==null?void 0:w.field)=="size"?w.order:void 0,render:function(o,t){return t.isDirectory?"-":(0,ye.jb)(o)}}],dataSource:_,onChange:nr})})]})),(0,e.jsx)("div",{className:"file-details-quick-preview pb-7",children:(0,e.jsx)(He,{files:lr,currentFolder:ee})}),(0,e.jsx)(Ge,{onCancel:Y,visible:p.current.newFolderVisible,parentFolder:he,onSuccess:tr})]})]})}var Je=Xe}}]);
