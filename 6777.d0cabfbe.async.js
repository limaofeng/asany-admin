"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6777],{66777:function(z,I,t){t.r(I),t.d(I,{default:function(){return X}});var k=t(97857),N=t.n(k),P=t(15009),E=t.n(P),L=t(99289),T=t.n(L),R=t(5574),h=t.n(R),j=t(62435),V=t(46027),w=t(14336),O=t(58301),Z=t(73588),a=t(79817),$=t(13769),U=t.n($),M=t(91726),e=t(86074),G=["id"];function H(c){var i=c.form,m=c.mode;return(0,e.jsxs)(a.Form,{form:i,children:[(0,e.jsx)(a.Form.Item,{className:"d-flex flex-column mb-7",name:"id",label:"\u7F16\u7801",rules:[{required:!0}],children:(0,e.jsx)(a.Input,{solid:!0,readOnly:m==="edit"})}),(0,e.jsx)(a.Form.Item,{className:"d-flex flex-column mb-7",name:"name",label:"\u540D\u79F0",rules:[{required:!0}],children:(0,e.jsx)(a.Input,{solid:!0})}),(0,e.jsx)(a.Form.Item,{className:"d-flex flex-column mb-7",name:"description",label:"\u63CF\u8FF0",children:(0,e.jsx)(a.Input.TextArea,{solid:!0})})]})}var Q=function(i){var m=(0,j.useState)(!1),f=h()(m,2),D=f[0],x=f[1],F=i.visible,n=i.data,g=i.refetch,y=(0,M.X9)(),C=h()(y,1),A=C[0],p=(0,M.f0)(),o=h()(p,1),r=o[0],s=a.Form.useForm(),d=(0,j.useCallback)(function(){i.setVisible(!1)},[]),v=(0,j.useCallback)(T()(E()().mark(function B(){var u,b,S;return E()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,s.validateFields();case 2:if(u=l.sent,b=u.id,S=U()(u,G),x(!0),l.prev=6,!(n!=null&&n.id)){l.next=12;break}return l.next=10,r({variables:{id:b,input:S}});case 10:l.next=14;break;case 12:return l.next=14,A({variables:{input:N()({id:b},S)}});case 14:i.setVisible(!1);case 15:return l.prev=15,x(!1),g(),l.finish(15);case 19:case"end":return l.stop()}},B,null,[[6,,15,19]])})),[g,n]);return(0,j.useEffect)(function(){F?n&&s.setFieldsValue({id:n.id,name:n.name,description:n.description}):s.resetFields()},[F,n]),(0,e.jsxs)(a.Modal,{width:640,centered:!0,onOk:v,confirmLoading:D,okText:"\u4FDD\u5B58",visible:F,onCancel:d,children:[(0,e.jsx)(a.Modal.Header,{closable:!0,className:"ms-5 border-0",children:(0,e.jsx)("h1",{className:"modal-title pt-6 pb-4",children:"\u6DFB\u52A0\u54C1\u724C"})}),(0,e.jsx)(a.Modal.Body,{children:(0,e.jsx)(H,{form:s,mode:n!=null&&n.id?"edit":"create"})})]})};function W(c){var i=c.data,m=c.refetch,f=c.onEdit,D=(0,j.useState)(!1),x=h()(D,2),F=x[0],n=x[1],g=(0,M.rD)(),y=h()(g,1),C=y[0],A=(0,w.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(d){return(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:d.name}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})}},function(){var s=T()(E()().mark(function d(v){return E()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,C({variables:{where:{id_in:[v==null?void 0:v.id]}}});case 2:m();case 3:case"end":return u.stop()}},d)}));return function(d){return s.apply(this,arguments)}}()),p=h()(A,1),o=p[0],r=(0,j.useCallback)(function(s){var d=s.key;d==="edit"?f():d==="delete"&&o({name:i.name,id:i.id})},[f]);return(0,e.jsx)(a.Dropdown,{overlay:(0,e.jsxs)(a.Menu,{onClick:r,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(a.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(a.Menu.Item,{className:"px-3",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:n,visible:F,children:(0,e.jsxs)(a.Button,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(V.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function K(){var c=(0,j.useState)({visible:!1}),i=h()(c,2),m=i[0],f=i[1],D=(0,O.Z)(M.ac,{toQuery:function(r,s,d,v){var B,u={};if((B=r.filter)!==null&&B!==void 0&&B.name_contains){var b;u.q=(b=r.filter)===null||b===void 0?void 0:b.name_contains}return v&&(u.orderBy=v.field+"_"+(v.order==="ascend"?"asc":"desc")),u.page=s.current,u},toVariables:function(r){return r.q&&(r.filter={name_contains:r.q},delete r.q),r}}),x=h()(D,2),F=x[0],n=x[1],g=n.loading,y=n.pageInfo,C=n.sorter,A=n.onChange,p=n.refetch;return(0,e.jsxs)(Z.vs,{header:{title:"\u54C1\u724C\u5217\u8868"},children:[(0,e.jsx)(Q,{visible:m.visible,setVisible:function(r){return f(N()(N()({},m),{},{visible:r}))},refetch:p,data:m.data}),!y.total&&!g?(0,e.jsx)(a.Card,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(a.Empty,{title:"\u8FD8\u6CA1\u6709\u54C1\u724C",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u54C1\u724C\u5427\uFF01",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(a.Button,{variant:"primary",children:"\u6DFB\u52A0\u54C1\u724C"})})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(a.Card,{className:"mb-5 mb-xl-10",children:[(0,e.jsxs)(a.Card.Header,{className:"pt-8",children:[(0,e.jsx)(a.Card.Title,{className:"flex-column"}),(0,e.jsx)(a.Card.Toolbar,{children:(0,e.jsx)("div",{className:"d-flex justify-content-end",children:(0,e.jsx)(a.Button,{variant:"primary",className:"me-3",icon:(0,e.jsx)(V.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),onClick:function(){return f({visible:!0})},children:"\u6DFB\u52A0\u54C1\u724C"})})})]}),(0,e.jsx)(a.Card.Body,{children:(0,e.jsx)(a.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:g,children:(0,e.jsx)(a.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(r){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:r}),"\u4E2A\u54C1\u724C"]})}},noRowsRenderer:function(){return(0,e.jsx)(a.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"id",title:"\u7F16\u7801",sorter:!0,sortOrder:C.field==="id"?C.order:void 0,width:120},{key:"name",title:"\u54C1\u724C\u540D\u79F0",sorter:!0,width:180,sortOrder:C.field==="name"?C.order:void 0},{key:"description",title:"\u63CF\u8FF0"},{key:"createdAt",title:"\u521B\u5EFA\u65F6\u95F4",width:120},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(r,s){return(0,e.jsx)(W,{data:s,onEdit:function(){f({visible:!0,data:s})},refetch:p})}}],pagination:y,onChange:A,dataSource:F})})})]})})]})}var X=K}}]);
