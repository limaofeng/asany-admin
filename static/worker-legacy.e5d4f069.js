!(function(){var S=(qt,jt,ot)=>new Promise((Ot,St)=>{var Jt=Te=>{try{Qe(ot.next(Te))}catch(be){St(be)}},_t=Te=>{try{Qe(ot.throw(Te))}catch(be){St(be)}},Qe=Te=>Te.done?Ot(Te.value):Promise.resolve(Te.value).then(Jt,_t);Qe((ot=ot.apply(qt,jt)).next())});(function(){"use strict";var qt=Object.defineProperty,jt=Object.defineProperties,ot=Object.getOwnPropertyDescriptors,Ot=Object.getOwnPropertySymbols,St=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable,_t=(t,e,r)=>e in t?qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qe=(t,e)=>{for(var r in e||(e={}))St.call(e,r)&&_t(t,r,e[r]);if(Ot)for(var r of Ot(e))Jt.call(e,r)&&_t(t,r,e[r]);return t},Te=(t,e)=>jt(t,ot(e)),be=(t,e,r)=>(_t(t,typeof e!="symbol"?e+"":e,r),r);const st={CONNECT_TIMEOUT:{code:-32300,message:"Connect timeout"},APPLICATION_ERROR:{code:-32500,message:"Application error"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"}},Ke=class{constructor(t){be(this,"_event"),be(this,"_methods",{}),be(this,"_timeout",0),be(this,"_$connect",null),this._event=t.event,this._timeout=t.timeout||0,t.methods&&Object.entries(t.methods).forEach(([e,r])=>{this.registerMethod(e,r)}),this._event.onerror=e=>{const{code:r,message:i,data:o}=e;if(o.event&&Array.isArray(o.args)&&o.args.length){const a=o.args[0],p=this._getAckEventName(a.method),c={jsonrpc:"2.0",id:a==null?void 0:a.id,error:{code:r,message:i,data:a}};this._event.emit(p,c)}else console.error(e)},this.connect()}static uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=16*Math.random()|0;return(t=="x"?e:3&e|8).toString(16)})}_getSynEventName(t){return`${Ke.EVENT.SYN_SIGN}${t}`}_getAckEventName(t){return`${Ke.EVENT.ACK_SIGN}${t}`}connect(t){return this._$connect||(this._$connect=new Promise((e,r)=>{const i=t||this._timeout;let o;i&&(o=setTimeout(()=>{const x=Te(Qe({},st.TIMEOUT),{data:{timeout:i}});r(x)},i));const a=Ke.EVENT.CONNECT,p=this._getAckEventName(a),c=this._getSynEventName(a),M=()=>{clearTimeout(o),e()};this._event.on(p,M),this._event.on(c,()=>{this._event.emit(p),M()}),this._event.emit(c)})),this._$connect}registerMethod(t,e){if(this._methods[t])throw new Error(`${t} already registered`);this._methods[t]=e;const r=this._getSynEventName(t);this._event.on(r,i=>{const o=this._getAckEventName(t);i.id?Promise.resolve(e(...i.params)).then(a=>{const p={jsonrpc:"2.0",result:a,id:i.id};this._event.emit(o,p)}).catch(a=>{const p={jsonrpc:"2.0",id:i.id,error:{code:(a==null?void 0:a.code)||st.APPLICATION_ERROR.code,message:(a==null?void 0:a.message)||st.APPLICATION_ERROR.message,data:null}};this._event.emit(o,p)}):e(...i.params)})}removeMethod(t){this._methods[t]||delete this._methods[t];const e=this._getSynEventName(t);this._event.off(e)}invoke(t,...e){return new Promise((r,i)=>{const o=e[e.length-1],a=o&&typeof o=="object"&&(Reflect.has(o,"isNotify")||Reflect.has(o,"timeout")),p=a?o:{isNotify:!1,timeout:0},c=a?e.slice(0,-1):e,M=this._getSynEventName(t),x=Ke.uuid(),A={jsonrpc:"2.0",method:t,params:c,id:x};if(this._event.emit(M,A),p.isNotify)r(void 0);else{const D=this._getAckEventName(t),L=p.timeout||this._timeout;let G;L&&(G=setTimeout(()=>{const te=Te(Qe({},st.CONNECT_TIMEOUT),{data:{timeout:L}});i(te)},L));const X=te=>{te.id===x&&(clearTimeout(G),this._event.off(D,X),te.error?i(te.error):r(te.result))};this._event.on(D,X)}})}destroy(){Object.entries(this._methods).forEach(([r])=>{const i=this._getSynEventName(r);this._event.off(i)});const t=this._getAckEventName(Ke.EVENT.CONNECT),e=this._getSynEventName(Ke.EVENT.CONNECT);this._event.off(e),this._event.off(t),this._event.destroy&&this._event.destroy()}};let zt=Ke;be(zt,"CODES",st),be(zt,"EVENT",{SYN_SIGN:"syn:",ACK_SIGN:"ack:",CONNECT:"__rpc_connect_event",SYNC_METHODS:"__rpc_sync_methods_event"});const k={ErrorInit:10001,ErrorNoRecord:10002,ErrorDBTimeout:10003};var pr;(function(t){t.Login="Login",t.OnConnectFailed="OnConnectFailed",t.OnConnectSuccess="OnConnectSuccess",t.OnConnecting="OnConnecting",t.OnKickedOffline="OnKickedOffline",t.OnSelfInfoUpdated="OnSelfInfoUpdated",t.OnUserTokenExpired="OnUserTokenExpired",t.OnUserTokenInvalid="OnUserTokenInvalid",t.OnProgress="OnProgress",t.OnRecvNewMessage="OnRecvNewMessage",t.OnRecvNewMessages="OnRecvNewMessages",t.OnRecvOnlineOnlyMessage="OnRecvOnlineOnlyMessage",t.OnRecvOfflineNewMessage="onRecvOfflineNewMessage",t.OnRecvOnlineOnlyMessages="OnRecvOnlineOnlyMessages",t.OnRecvOfflineNewMessages="onRecvOfflineNewMessages",t.OnRecvMessageRevoked="OnRecvMessageRevoked",t.OnNewRecvMessageRevoked="OnNewRecvMessageRevoked",t.OnRecvC2CReadReceipt="OnRecvC2CReadReceipt",t.OnRecvGroupReadReceipt="OnRecvGroupReadReceipt",t.OnConversationChanged="OnConversationChanged",t.OnNewConversation="OnNewConversation",t.OnConversationUserInputStatusChanged="OnConversationUserInputStatusChanged",t.OnSyncServerFailed="OnSyncServerFailed",t.OnSyncServerFinish="OnSyncServerFinish",t.OnSyncServerProgress="OnSyncServerProgress",t.OnSyncServerStart="OnSyncServerStart",t.OnTotalUnreadMessageCountChanged="OnTotalUnreadMessageCountChanged",t.OnBlackAdded="OnBlackAdded",t.OnBlackDeleted="OnBlackDeleted",t.OnFriendApplicationAccepted="OnFriendApplicationAccepted",t.OnFriendApplicationAdded="OnFriendApplicationAdded",t.OnFriendApplicationDeleted="OnFriendApplicationDeleted",t.OnFriendApplicationRejected="OnFriendApplicationRejected",t.OnFriendInfoChanged="OnFriendInfoChanged",t.OnFriendAdded="OnFriendAdded",t.OnFriendDeleted="OnFriendDeleted",t.OnJoinedGroupAdded="OnJoinedGroupAdded",t.OnJoinedGroupDeleted="OnJoinedGroupDeleted",t.OnGroupDismissed="OnGroupDismissed",t.OnGroupMemberAdded="OnGroupMemberAdded",t.OnGroupMemberDeleted="OnGroupMemberDeleted",t.OnGroupApplicationAdded="OnGroupApplicationAdded",t.OnGroupApplicationDeleted="OnGroupApplicationDeleted",t.OnGroupInfoChanged="OnGroupInfoChanged",t.OnGroupMemberInfoChanged="OnGroupMemberInfoChanged",t.OnGroupApplicationAccepted="OnGroupApplicationAccepted",t.OnGroupApplicationRejected="OnGroupApplicationRejected",t.UploadComplete="UploadComplete",t.OnRecvCustomBusinessMessage="OnRecvCustomBusinessMessage",t.OnUserStatusChanged="OnUserStatusChanged",t.OnUploadLogsProgress="OnUploadLogsProgress",t.OnReceiveNewInvitation="OnReceiveNewInvitation",t.OnInviteeAccepted="OnInviteeAccepted",t.OnInviteeRejected="OnInviteeRejected",t.OnInvitationCancelled="OnInvitationCancelled",t.OnHangUp="OnHangUp",t.OnInvitationTimeout="OnInvitationTimeout",t.OnInviteeAcceptedByOtherDevice="OnInviteeAcceptedByOtherDevice",t.OnInviteeRejectedByOtherDevice="OnInviteeRejectedByOtherDevice",t.OnStreamChange="OnStreamChange",t.OnRoomParticipantConnected="OnRoomParticipantConnected",t.OnRoomParticipantDisconnected="OnRoomParticipantDisconnected",t.OnReceiveCustomSignal="OnReceiveCustomSignal",t.UnUsedEvent="UnUsedEvent"})(pr||(pr={})),typeof globalThis!="undefined"||typeof window!="undefined"||typeof global!="undefined"&&global;function vr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Wt(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var o=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,o.get?o:{enumerable:!0,get:function(){return t[i]}})}),r}var yr={exports:{}};yr.exports=function(){var t=function U(m,P,O){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,P);if(v===void 0){var d=Object.getPrototypeOf(m);return d===null?void 0:U(d,P,O)}if("value"in v)return v.value;var f=v.get;return f!==void 0?f.call(O):void 0},e=function(){function U(m,P){for(var O=0;O<P.length;O++){var v=P[O];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,P,O){return P&&U(m.prototype,P),O&&U(m,O),m}}(),r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(U){return typeof U}:function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U};function i(U,m){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!m||typeof m!="object"&&typeof m!="function"?U:m}function o(U,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);U.prototype=Object.create(m&&m.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(U,m):U.__proto__=m)}function a(U,m){if(!(U instanceof m))throw new TypeError("Cannot call a class as a function")}function p(U,m){return U.length?U+m:U}function c(U){for(var m=arguments.length,P=Array(m>1?m-1:0),O=1;O<m;O++)P[O-1]=arguments[O];if(U&&P){var v=function(F){(F===void 0?"undefined":r(F))==="object"&&Object.getOwnPropertyNames(F).forEach(function($){U[$]=F[$]})},d=!0,f=!1,g=void 0;try{for(var b,E=P[Symbol.iterator]();!(d=(b=E.next()).done);d=!0)v(b.value)}catch(F){f=!0,g=F}finally{try{!d&&E.return&&E.return()}finally{if(f)throw g}}}return U}function M(U){return U&&U.constructor.prototype===Object.prototype}function x(U){return U&&U.constructor.prototype===Array.prototype}function A(U){if(!U)return U;if(typeof U.clone=="function")return U.clone();if(M(U)||x(U)){var m=new U.constructor;return Object.getOwnPropertyNames(U).forEach(function(P){typeof U[P]!="function"&&(m[P]=A(U[P]))}),m}return JSON.parse(JSON.stringify(U))}function D(U,m,P){var O=m===void 0?"undefined":r(m);if(O!=="function"&&O!=="string")throw new Error("type must be a class constructor or string");if(typeof P!="function")throw new Error("handler must be a function");var v=!0,d=!1,f=void 0;try{for(var g,b=U[Symbol.iterator]();!(v=(g=b.next()).done);v=!0){var E=g.value;if(E.type===m)return void(E.handler=P)}}catch(F){d=!0,f=F}finally{try{!v&&b.return&&b.return()}finally{if(d)throw f}}U.push({type:m,handler:P})}function L(U,m,P){return G(U,m)||G(U,P)}function G(U,m){for(var P=0;P<m.length;P++){var O=m[P];if((U===void 0?"undefined":r(U))===O.type||typeof O.type!="string"&&U instanceof O.type)return O.handler}}function X(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,m={isSquelBuilder:function(v){return v&&!!v._toParamString}},P=function(v){return!m.isSquelBuilder(v)||!v.options.rawNesting};m.DefaultQueryBuilderOptions={autoQuoteTableNames:!1,autoQuoteFieldNames:!1,autoQuoteAliasNames:!0,useAsForTableAliasNames:!1,nameQuoteCharacter:"`",tableAliasQuoteCharacter:"`",fieldAliasQuoteCharacter:'"',valueHandlers:[],parameterCharacter:"?",numberedParameters:!1,numberedParametersPrefix:"$",numberedParametersStartAt:1,replaceSingleQuotes:!1,singleQuoteReplacement:"''",separator:" ",stringFormatter:null,rawNesting:!1},m.globalValueHandlers=[],m.registerValueHandler=function(v,d){D(m.globalValueHandlers,v,d)},m.Cloneable=function(){function v(){a(this,v)}return e(v,[{key:"clone",value:function(){return c(new this.constructor,A(c({},this)))}}]),v}(),m.BaseBuilder=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this)),b=JSON.parse(JSON.stringify(m.DefaultQueryBuilderOptions));return["stringFormatter"].forEach(function(E){b[E]=m.DefaultQueryBuilderOptions[E]}),g.options=c({},b,f),g}return o(d,v),e(d,[{key:"registerValueHandler",value:function(f,g){return D(this.options.valueHandlers,f,g),this}},{key:"_sanitizeExpression",value:function(f){if(!m.isSquelBuilder(f)&&typeof f!="string")throw new Error("expression must be a string\xA0or builder instance");return f}},{key:"_sanitizeName",value:function(f,g){if(typeof f!="string")throw new Error(g+" must be a string");return f}},{key:"_sanitizeField",value:function(f){return m.isSquelBuilder(f)||(f=this._sanitizeName(f,"field name")),f}},{key:"_sanitizeBaseBuilder",value:function(f){if(m.isSquelBuilder(f))return f;throw new Error("must be a builder instance")}},{key:"_sanitizeTable",value:function(f){if(typeof f!="string")try{f=this._sanitizeBaseBuilder(f)}catch(g){throw new Error("table name must be a string or a builder")}else f=this._sanitizeName(f,"table");return f}},{key:"_sanitizeTableAlias",value:function(f){return this._sanitizeName(f,"table alias")}},{key:"_sanitizeFieldAlias",value:function(f){return this._sanitizeName(f,"field alias")}},{key:"_sanitizeLimitOffset",value:function(f){if(0>(f=parseInt(f))||isNaN(f))throw new Error("limit/offset must be >= 0");return f}},{key:"_sanitizeValue",value:function(f){var g=f===void 0?"undefined":r(f);if(f!==null){if(!(g==="string"||g==="number"||g==="boolean")){if(!m.isSquelBuilder(f)){if(!L(f,this.options.valueHandlers,m.globalValueHandlers))throw new Error("field value must be a string, number, boolean, null or one of the registered custom value types")}}}return f}},{key:"_escapeValue",value:function(f){return this.options.replaceSingleQuotes&&f?f.replace(/\'/g,this.options.singleQuoteReplacement):f}},{key:"_formatTableName",value:function(f){if(this.options.autoQuoteTableNames){var g=this.options.nameQuoteCharacter;f=""+g+f+g}return f}},{key:"_formatFieldAlias",value:function(f){if(this.options.autoQuoteAliasNames){var g=this.options.fieldAliasQuoteCharacter;f=""+g+f+g}return f}},{key:"_formatTableAlias",value:function(f){if(this.options.autoQuoteAliasNames){var g=this.options.tableAliasQuoteCharacter;f=""+g+f+g}return this.options.useAsForTableAliasNames?"AS "+f:f}},{key:"_formatFieldName",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options.autoQuoteFieldNames){var b=this.options.nameQuoteCharacter;f=g.ignorePeriodsForFieldNameQuotes?""+b+f+b:f.split(".").map(function(E){return E==="*"?E:""+b+E+b}).join(".")}return f}},{key:"_formatCustomValue",value:function(f,g,b){var E=L(f,this.options.valueHandlers,m.globalValueHandlers);return E&&(f=E(f,g,b))&&f.rawNesting?{formatted:!0,rawNesting:!0,value:f.value}:{formatted:!!E,value:f}}},{key:"_formatValueForParamArray",value:function(f){var g=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return x(f)?f.map(function(E){return g._formatValueForParamArray(E,b)}):this._formatCustomValue(f,!0,b).value}},{key:"_formatValueForQueryString",value:function(f){var g=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E=this._formatCustomValue(f,!1,b),F=E.rawNesting,$=E.formatted,C=E.value;if($)return F?C:this._applyNestingFormatting(C,P(f));if(x(C))C=C.map(function(Y){return g._formatValueForQueryString(Y)}),C=this._applyNestingFormatting(C.join(", "),P(C));else{var J=C===void 0?"undefined":r(C);if(C===null)C="NULL";else if(J==="boolean")C=C?"TRUE":"FALSE";else if(m.isSquelBuilder(C))C=this._applyNestingFormatting(C.toString(),P(C));else if(J!=="number"){if(J==="string"&&this.options.stringFormatter)return this.options.stringFormatter(C);C=b.dontQuote?""+C:"'"+this._escapeValue(C)+"'"}}return C}},{key:"_applyNestingFormatting",value:function(f){if(f&&typeof f=="string"&&(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&!this.options.rawNesting){var g=f.charAt(0)==="("&&f.charAt(f.length-1)===")";if(g)for(var b=0,E=1;f.length-1>++b;){var F=f.charAt(b);if(F==="(")E++;else if(F===")"&&1>--E){g=!1;break}}g||(f="("+f+")")}return f}},{key:"_buildString",value:function(f,g){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=b.nested,F=b.buildParameterized,$=b.formattingOptions;g=g||[],f=f||"";for(var C="",J=-1,Y=[],Q=this.options.parameterCharacter,K=0;f.length>K;)if(f.substr(K,Q.length)===Q){var ne=g[++J];if(F)if(m.isSquelBuilder(ne)){var ie=ne._toParamString({buildParameterized:F,nested:!0});C+=ie.text,ie.values.forEach(function(fe){return Y.push(fe)})}else x(ne=this._formatValueForParamArray(ne,$))?(C+="("+ne.map(function(){return Q}).join(", ")+")",ne.forEach(function(fe){return Y.push(fe)})):(C+=Q,Y.push(ne));else C+=this._formatValueForQueryString(ne,$);K+=Q.length}else C+=f.charAt(K),K++;return{text:this._applyNestingFormatting(C,!!E),values:Y}}},{key:"_buildManyStrings",value:function(f,g){for(var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=[],F=[],$=0;f.length>$;++$){var C=f[$],J=g[$],Y=this._buildString(C,J,{buildParameterized:b.buildParameterized,nested:!1}),Q=Y.text,K=Y.values;E.push(Q),K.forEach(function(ne){return F.push(ne)})}return{text:(E=E.join(this.options.separator)).length?this._applyNestingFormatting(E,!!b.nested):"",values:F}}},{key:"_toParamString",value:function(f){throw new Error("Not yet implemented")}},{key:"toString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._toParamString(f).text}},{key:"toParam",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._toParamString(c({},f,{buildParameterized:!0}))}}]),d}(m.Cloneable),m.Expression=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._nodes=[],g}return o(d,v),e(d,[{key:"and",value:function(f){for(var g=arguments.length,b=Array(g>1?g-1:0),E=1;E<g;E++)b[E-1]=arguments[E];return f=this._sanitizeExpression(f),this._nodes.push({type:"AND",expr:f,para:b}),this}},{key:"or",value:function(f){for(var g=arguments.length,b=Array(g>1?g-1:0),E=1;E<g;E++)b[E-1]=arguments[E];return f=this._sanitizeExpression(f),this._nodes.push({type:"OR",expr:f,para:b}),this}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=[],b=[],E=!0,F=!1,$=void 0;try{for(var C,J=this._nodes[Symbol.iterator]();!(E=(C=J.next()).done);E=!0){var Y=C.value,Q=Y.type,K=Y.expr,ne=Y.para,ie=m.isSquelBuilder(K)?K._toParamString({buildParameterized:f.buildParameterized,nested:!0}):this._buildString(K,ne,{buildParameterized:f.buildParameterized}),fe=ie.text,de=ie.values;g.length&&g.push(Q),g.push(fe),de.forEach(function(he){return b.push(he)})}}catch(he){F=!0,$=he}finally{try{!E&&J.return&&J.return()}finally{if(F)throw $}}return g=g.join(" "),{text:this._applyNestingFormatting(g,!!f.nested),values:b}}}]),d}(m.BaseBuilder),m.Case=function(v){function d(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};a(this,d);var b=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,g));return M(f)&&(g=f,f=null),f&&(b._fieldName=b._sanitizeField(f)),b.options=c({},m.DefaultQueryBuilderOptions,g),b._cases=[],b._elseValue=null,b}return o(d,v),e(d,[{key:"when",value:function(f){for(var g=arguments.length,b=Array(g>1?g-1:0),E=1;E<g;E++)b[E-1]=arguments[E];return this._cases.unshift({expression:f,values:b||[]}),this}},{key:"then",value:function(f){if(this._cases.length==0)throw new Error("when() needs to be called first");return this._cases[0].result=f,this}},{key:"else",value:function(f){return this._elseValue=f,this}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g="",b=[],E=!0,F=!1,$=void 0;try{for(var C,J=this._cases[Symbol.iterator]();!(E=(C=J.next()).done);E=!0){var Y=C.value,Q=Y.expression,K=Y.values,ne=Y.result;g=p(g," ");var ie=this._buildString(Q,K,{buildParameterized:f.buildParameterized,nested:!0});g+="WHEN "+ie.text+" THEN "+this._formatValueForQueryString(ne),ie.values.forEach(function(fe){return b.push(fe)})}}catch(fe){F=!0,$=fe}finally{try{!E&&J.return&&J.return()}finally{if(F)throw $}}return g.length?(g+=" ELSE "+this._formatValueForQueryString(this._elseValue)+" END",this._fieldName&&(g=this._fieldName+" "+g),g="CASE "+g):g=this._formatValueForQueryString(this._elseValue),{text:g,values:b}}}]),d}(m.BaseBuilder),m.Block=function(v){function d(f){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f))}return o(d,v),e(d,[{key:"exposedMethods",value:function(){for(var f={},g=this;g;)Object.getOwnPropertyNames(g).forEach(function(b){b==="constructor"||typeof g[b]!="function"||b.charAt(0)==="_"||m.Block.prototype[b]||(f[b]=g[b])}),g=Object.getPrototypeOf(g);return f}}]),d}(m.BaseBuilder),m.StringBlock=function(v){function d(f,g){a(this,d);var b=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return b._str=g,b}return o(d,v),e(d,[{key:"_toParamString",value:function(){return{text:this._str,values:[]}}}]),d}(m.Block),m.FunctionBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._strings=[],g._values=[],g}return o(d,v),e(d,[{key:"function",value:function(f){this._strings.push(f);for(var g=arguments.length,b=Array(g>1?g-1:0),E=1;E<g;E++)b[E-1]=arguments[E];this._values.push(b)}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._buildManyStrings(this._strings,this._values,f)}}]),d}(m.Block),m.registerValueHandler(m.FunctionBlock,function(v){return arguments.length>1&&arguments[1]!==void 0&&arguments[1]?v.toParam():v.toString()}),m.AbstractTableBlock=function(v){function d(f,g){a(this,d);var b=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return b._tables=[],b}return o(d,v),e(d,[{key:"_table",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;g=g&&this._sanitizeTableAlias(g),f=this._sanitizeTable(f),this.options.singleTable&&(this._tables=[]),this._tables.push({table:f,alias:g})}},{key:"_hasTable",value:function(){return 0<this._tables.length}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g="",b=[];if(this._hasTable()){var E=!0,F=!1,$=void 0;try{for(var C,J=this._tables[Symbol.iterator]();!(E=(C=J.next()).done);E=!0){var Y=C.value,Q=Y.table,K=Y.alias;g=p(g,", ");var ne=void 0;if(m.isSquelBuilder(Q)){var ie=Q._toParamString({buildParameterized:f.buildParameterized,nested:!0}),fe=ie.text,de=ie.values;ne=fe,de.forEach(function(he){return b.push(he)})}else ne=this._formatTableName(Q);K&&(ne+=" "+this._formatTableAlias(K)),g+=ne}}catch(he){F=!0,$=he}finally{try{!E&&J.return&&J.return()}finally{if(F)throw $}}this.options.prefix&&(g=this.options.prefix+" "+g)}return{text:g,values:b}}}]),d}(m.Block),m.TargetTableBlock=function(v){function d(){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return o(d,v),e(d,[{key:"target",value:function(f){this._table(f)}}]),d}(m.AbstractTableBlock),m.UpdateTableBlock=function(v){function d(){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return o(d,v),e(d,[{key:"table",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this._table(f,g)}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._hasTable())throw new Error("table() needs to be called");return t(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"_toParamString",this).call(this,f)}}]),d}(m.AbstractTableBlock),m.FromTableBlock=function(v){function d(f){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,c({},f,{prefix:"FROM"})))}return o(d,v),e(d,[{key:"from",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this._table(f,g)}}]),d}(m.AbstractTableBlock),m.IntoTableBlock=function(v){function d(f){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,c({},f,{prefix:"INTO",singleTable:!0})))}return o(d,v),e(d,[{key:"into",value:function(f){this._table(f)}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._hasTable())throw new Error("into() needs to be called");return t(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"_toParamString",this).call(this,f)}}]),d}(m.AbstractTableBlock),m.GetFieldBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._fields=[],g}return o(d,v),e(d,[{key:"fields",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(x(f)){var b=!0,E=!1,F=void 0;try{for(var $,C=f[Symbol.iterator]();!(b=($=C.next()).done);b=!0){var J=$.value;this.field(J,null,g)}}catch(K){E=!0,F=K}finally{try{!b&&C.return&&C.return()}finally{if(E)throw F}}}else for(var Y in f){var Q=f[Y];this.field(Y,Q,g)}}},{key:"field",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(g=g&&this._sanitizeFieldAlias(g),f=this._sanitizeField(f),this._fields.filter(function(E){return E.name===f&&E.alias===g}).length)return this;this._fields.push({name:f,alias:g,options:b})}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=f.queryBuilder,b=f.buildParameterized,E="",F=[],$=!0,C=!1,J=void 0;try{for(var Y,Q=this._fields[Symbol.iterator]();!($=(Y=Q.next()).done);$=!0){var K=Y.value;E=p(E,", ");var ne=K.name,ie=K.alias,fe=K.options;if(typeof ne=="string")E+=this._formatFieldName(ne,fe);else{var de=ne._toParamString({nested:!0,buildParameterized:b});E+=de.text,de.values.forEach(function(Oe){return F.push(Oe)})}ie&&(E+=" AS "+this._formatFieldAlias(ie))}}catch(Oe){C=!0,J=Oe}finally{try{!$&&Q.return&&Q.return()}finally{if(C)throw J}}if(!E.length){var he=g&&g.getBlock(m.FromTableBlock);he&&he._hasTable()&&(E="*")}return{text:E,values:F}}}]),d}(m.Block),m.AbstractSetFieldBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._reset(),g}return o(d,v),e(d,[{key:"_reset",value:function(){this._fields=[],this._values=[[]],this._valueOptions=[[]]}},{key:"_set",value:function(f,g){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._values.length>1)throw new Error("Cannot set multiple rows of fields this way.");g!==void 0&&(g=this._sanitizeValue(g)),f=this._sanitizeField(f);var E=this._fields.indexOf(f);E===-1&&(this._fields.push(f),E=this._fields.length-1),this._values[0][E]=g,this._valueOptions[0][E]=b}},{key:"_setFields",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((f===void 0?"undefined":r(f))!=="object")throw new Error("Expected an object but got "+(f===void 0?"undefined":r(f)));for(var b in f)this._set(b,f[b],g)}},{key:"_setFieldsRows",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!x(f))throw new Error("Expected an array of objects but got "+(f===void 0?"undefined":r(f)));this._reset();for(var b=0;f.length>b;++b){var E=f[b];for(var F in E){var $=E[F];F=this._sanitizeField(F),$=this._sanitizeValue($);var C=this._fields.indexOf(F);if(0<b&&C===-1)throw new Error("All fields in subsequent rows must match the fields in the first row");C===-1&&(this._fields.push(F),C=this._fields.length-1),x(this._values[b])||(this._values[b]=[],this._valueOptions[b]=[]),this._values[b][C]=$,this._valueOptions[b][C]=g}}}}]),d}(m.Block),m.SetFieldBlock=function(v){function d(){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return o(d,v),e(d,[{key:"set",value:function(f,g,b){this._set(f,g,b)}},{key:"setFields",value:function(f,g){this._setFields(f,g)}},{key:"_toParamString",value:function(){var f=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).buildParameterized;if(0>=this._fields.length)throw new Error("set() needs to be called");for(var g="",b=[],E=0;E<this._fields.length;++E){g=p(g,", ");var F=this._formatFieldName(this._fields[E]),$=this._values[0][E];0>F.indexOf("=")&&(F=F+" = "+this.options.parameterCharacter);var C=this._buildString(F,[$],{buildParameterized:f,formattingOptions:this._valueOptions[0][E]});g+=C.text,C.values.forEach(function(J){return b.push(J)})}return{text:"SET "+g,values:b}}}]),d}(m.AbstractSetFieldBlock),m.InsertFieldValueBlock=function(v){function d(){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return o(d,v),e(d,[{key:"set",value:function(f,g){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._set(f,g,b)}},{key:"setFields",value:function(f,g){this._setFields(f,g)}},{key:"setFieldsRows",value:function(f,g){this._setFieldsRows(f,g)}},{key:"_toParamString",value:function(){for(var f=this,g=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).buildParameterized,b=this._fields.map(function(Y){return f._formatFieldName(Y)}).join(", "),E=[],F=[],$=0;$<this._values.length;++$){E[$]="";for(var C=0;C<this._values[$].length;++C){var J=this._buildString(this.options.parameterCharacter,[this._values[$][C]],{buildParameterized:g,formattingOptions:this._valueOptions[$][C]});J.values.forEach(function(Y){return F.push(Y)}),E[$]=p(E[$],", "),E[$]+=J.text}}return{text:b.length?"("+b+") VALUES ("+E.join("), (")+")":"",values:F}}}]),d}(m.AbstractSetFieldBlock),m.InsertFieldsFromQueryBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._fields=[],g._query=null,g}return o(d,v),e(d,[{key:"fromQuery",value:function(f,g){var b=this;this._fields=f.map(function(E){return b._sanitizeField(E)}),this._query=this._sanitizeBaseBuilder(g)}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g="",b=[];if(this._fields.length&&this._query){var E=this._query._toParamString({buildParameterized:f.buildParameterized,nested:!0}),F=E.text,$=E.values;g="("+this._fields.join(", ")+") "+this._applyNestingFormatting(F),b=$}return{text:g,values:b}}}]),d}(m.Block),m.DistinctBlock=function(v){function d(){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return o(d,v),e(d,[{key:"distinct",value:function(){this._useDistinct=!0}},{key:"_toParamString",value:function(){return{text:this._useDistinct?"DISTINCT":"",values:[]}}}]),d}(m.Block),m.GroupByBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._groups=[],g}return o(d,v),e(d,[{key:"group",value:function(f){this._groups.push(this._sanitizeField(f))}},{key:"_toParamString",value:function(){return{text:this._groups.length?"GROUP BY "+this._groups.join(", "):"",values:[]}}}]),d}(m.Block),m.AbstractVerbSingleValueBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._value=null,g}return o(d,v),e(d,[{key:"_setValue",value:function(f){this._value=f!==null?this._sanitizeLimitOffset(f):f}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=this._value!==null?this.options.verb+" "+this.options.parameterCharacter:"",b=this._value!==null?[this._value]:[];return this._buildString(g,b,f)}}]),d}(m.Block),m.OffsetBlock=function(v){function d(f){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,c({},f,{verb:"OFFSET"})))}return o(d,v),e(d,[{key:"offset",value:function(f){this._setValue(f)}}]),d}(m.AbstractVerbSingleValueBlock),m.LimitBlock=function(v){function d(f){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,c({},f,{verb:"LIMIT"})))}return o(d,v),e(d,[{key:"limit",value:function(f){this._setValue(f)}}]),d}(m.AbstractVerbSingleValueBlock),m.AbstractConditionBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._conditions=[],g}return o(d,v),e(d,[{key:"_condition",value:function(f){f=this._sanitizeExpression(f);for(var g=arguments.length,b=Array(g>1?g-1:0),E=1;E<g;E++)b[E-1]=arguments[E];this._conditions.push({expr:f,values:b||[]})}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=[],b=[],E=!0,F=!1,$=void 0;try{for(var C,J=this._conditions[Symbol.iterator]();!(E=(C=J.next()).done);E=!0){var Y=C.value,Q=Y.expr,K=Y.values,ne=m.isSquelBuilder(Q)?Q._toParamString({buildParameterized:f.buildParameterized}):this._buildString(Q,K,{buildParameterized:f.buildParameterized});ne.text.length&&g.push(ne.text),ne.values.forEach(function(ie){return b.push(ie)})}}catch(ie){F=!0,$=ie}finally{try{!E&&J.return&&J.return()}finally{if(F)throw $}}return g.length&&(g=g.join(") AND (")),{text:g.length?this.options.verb+" ("+g+")":"",values:b}}}]),d}(m.Block),m.WhereBlock=function(v){function d(f){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,c({},f,{verb:"WHERE"})))}return o(d,v),e(d,[{key:"where",value:function(f){for(var g=arguments.length,b=Array(g>1?g-1:0),E=1;E<g;E++)b[E-1]=arguments[E];this._condition.apply(this,[f].concat(b))}}]),d}(m.AbstractConditionBlock),m.HavingBlock=function(v){function d(f){return a(this,d),i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,c({},f,{verb:"HAVING"})))}return o(d,v),e(d,[{key:"having",value:function(f){for(var g=arguments.length,b=Array(g>1?g-1:0),E=1;E<g;E++)b[E-1]=arguments[E];this._condition.apply(this,[f].concat(b))}}]),d}(m.AbstractConditionBlock),m.OrderByBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._orders=[],g}return o(d,v),e(d,[{key:"order",value:function(f,g){f=this._sanitizeField(f),typeof g!="string"&&(g===void 0?g="ASC":g!==null&&(g=g?"ASC":"DESC"));for(var b=arguments.length,E=Array(b>2?b-2:0),F=2;F<b;F++)E[F-2]=arguments[F];this._orders.push({field:f,dir:g,values:E||[]})}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g="",b=[],E=!0,F=!1,$=void 0;try{for(var C,J=this._orders[Symbol.iterator]();!(E=(C=J.next()).done);E=!0){var Y=C.value,Q=Y.field,K=Y.dir,ne=Y.values;g=p(g,", ");var ie=this._buildString(Q,ne,{buildParameterized:f.buildParameterized});g+=ie.text,x(ie.values)&&ie.values.forEach(function(fe){return b.push(fe)}),K!==null&&(g+=" "+K)}}catch(fe){F=!0,$=fe}finally{try{!E&&J.return&&J.return()}finally{if(F)throw $}}return{text:g.length?"ORDER BY "+g:"",values:b}}}]),d}(m.Block),m.JoinBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._joins=[],g}return o(d,v),e(d,[{key:"join",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"INNER";f=this._sanitizeTable(f,!0),g=g&&this._sanitizeTableAlias(g),b=b&&this._sanitizeExpression(b),this._joins.push({type:E,table:f,alias:g,condition:b})}},{key:"left_join",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(f,g,b,"LEFT")}},{key:"right_join",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(f,g,b,"RIGHT")}},{key:"outer_join",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(f,g,b,"OUTER")}},{key:"left_outer_join",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(f,g,b,"LEFT OUTER")}},{key:"full_join",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(f,g,b,"FULL")}},{key:"cross_join",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(f,g,b,"CROSS")}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g="",b=[],E=!0,F=!1,$=void 0;try{for(var C,J=this._joins[Symbol.iterator]();!(E=(C=J.next()).done);E=!0){var Y=C.value,Q=Y.type,K=Y.table,ne=Y.alias,ie=Y.condition;g=p(g,this.options.separator);var fe=void 0;if(m.isSquelBuilder(K)){var de=K._toParamString({buildParameterized:f.buildParameterized,nested:!0});de.values.forEach(function(Oe){return b.push(Oe)}),fe=de.text}else fe=this._formatTableName(K);if(g+=Q+" JOIN "+fe,ne&&(g+=" "+this._formatTableAlias(ne)),ie){g+=" ON ";var he=void 0;he=m.isSquelBuilder(ie)?ie._toParamString({buildParameterized:f.buildParameterized}):this._buildString(ie,[],{buildParameterized:f.buildParameterized}),g+=this._applyNestingFormatting(he.text),he.values.forEach(function(Oe){return b.push(Oe)})}}}catch(Oe){F=!0,$=Oe}finally{try{!E&&J.return&&J.return()}finally{if(F)throw $}}return{text:g,values:b}}}]),d}(m.Block),m.UnionBlock=function(v){function d(f){a(this,d);var g=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));return g._unions=[],g}return o(d,v),e(d,[{key:"union",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"UNION";f=this._sanitizeTable(f),this._unions.push({type:g,table:f})}},{key:"union_all",value:function(f){this.union(f,"UNION ALL")}},{key:"_toParamString",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g="",b=[],E=!0,F=!1,$=void 0;try{for(var C,J=this._unions[Symbol.iterator]();!(E=(C=J.next()).done);E=!0){var Y=C.value,Q=Y.type,K=Y.table;g=p(g,this.options.separator);var ne=void 0;if(K instanceof m.BaseBuilder){var ie=K._toParamString({buildParameterized:f.buildParameterized,nested:!0});ne=ie.text,ie.values.forEach(function(fe){return b.push(fe)})}else g=this._formatTableName(K);g+=Q+" "+ne}}catch(fe){F=!0,$=fe}finally{try{!E&&J.return&&J.return()}finally{if(F)throw $}}return{text:g,values:b}}}]),d}(m.Block),m.QueryBuilder=function(v){function d(f,g){a(this,d);var b=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f));b.blocks=g||[];var E=!0,F=!1,$=void 0;try{for(var C,J=b.blocks[Symbol.iterator]();!(E=(C=J.next()).done);E=!0){var Y=C.value,Q=Y.exposedMethods();for(var K in Q){var ne=Q[K];if(b[K]!==void 0)throw new Error("Builder already has a builder method called: "+K);(function(ie,fe,de){b[fe]=function(){for(var he=arguments.length,Oe=Array(he),H=0;H<he;H++)Oe[H]=arguments[H];return de.call.apply(de,[ie].concat(Oe)),b}})(Y,K,ne)}}}catch(ie){F=!0,$=ie}finally{try{!E&&J.return&&J.return()}finally{if(F)throw $}}return b}return o(d,v),e(d,[{key:"registerValueHandler",value:function(f,g){var b=!0,E=!1,F=void 0;try{for(var $,C=this.blocks[Symbol.iterator]();!(b=($=C.next()).done);b=!0)$.value.registerValueHandler(f,g)}catch(J){E=!0,F=J}finally{try{!b&&C.return&&C.return()}finally{if(E)throw F}}return t(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"registerValueHandler",this).call(this,f,g),this}},{key:"updateOptions",value:function(f){this.options=c({},this.options,f);var g=!0,b=!1,E=void 0;try{for(var F,$=this.blocks[Symbol.iterator]();!(g=(F=$.next()).done);g=!0){var C=F.value;C.options=c({},C.options,f)}}catch(J){b=!0,E=J}finally{try{!g&&$.return&&$.return()}finally{if(b)throw E}}}},{key:"_toParamString",value:function(){var f=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g=c({},this.options,g);var b=this.blocks.map(function(Q){return Q._toParamString({buildParameterized:g.buildParameterized,queryBuilder:f})}),E=b.map(function(Q){return Q.text}),F=b.map(function(Q){return Q.values}),$=E.filter(function(Q){return 0<Q.length}).join(g.separator),C=[];if(F.forEach(function(Q){return Q.forEach(function(K){return C.push(K)})}),!g.nested&&g.numberedParameters){var J=g.numberedParametersStartAt!==void 0?g.numberedParametersStartAt:1,Y=g.parameterCharacter.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");$=$.replace(new RegExp(Y,"g"),function(){return""+g.numberedParametersPrefix+J++})}return{text:this._applyNestingFormatting($,!!g.nested),values:C}}},{key:"clone",value:function(){var f=this.blocks.map(function(g){return g.clone()});return new this.constructor(this.options,f)}},{key:"getBlock",value:function(f){return this.blocks.filter(function(g){return g instanceof f})[0]}}]),d}(m.BaseBuilder),m.Select=function(v){function d(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,d),g=g||[new m.StringBlock(f,"SELECT"),new m.FunctionBlock(f),new m.DistinctBlock(f),new m.GetFieldBlock(f),new m.FromTableBlock(f),new m.JoinBlock(f),new m.WhereBlock(f),new m.GroupByBlock(f),new m.HavingBlock(f),new m.OrderByBlock(f),new m.LimitBlock(f),new m.OffsetBlock(f),new m.UnionBlock(f)],i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,g))}return o(d,v),d}(m.QueryBuilder),m.Update=function(v){function d(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,d),g=g||[new m.StringBlock(f,"UPDATE"),new m.UpdateTableBlock(f),new m.SetFieldBlock(f),new m.WhereBlock(f),new m.OrderByBlock(f),new m.LimitBlock(f)],i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,g))}return o(d,v),d}(m.QueryBuilder),m.Delete=function(v){function d(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,d),g=g||[new m.StringBlock(f,"DELETE"),new m.TargetTableBlock(f),new m.FromTableBlock(c({},f,{singleTable:!0})),new m.JoinBlock(f),new m.WhereBlock(f),new m.OrderByBlock(f),new m.LimitBlock(f)],i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,g))}return o(d,v),d}(m.QueryBuilder),m.Insert=function(v){function d(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,d),g=g||[new m.StringBlock(f,"INSERT"),new m.IntoTableBlock(f),new m.InsertFieldValueBlock(f),new m.InsertFieldsFromQueryBlock(f)],i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,g))}return o(d,v),d}(m.QueryBuilder);var O={VERSION:"5.13.0",flavour:U,expr:function(v){return new m.Expression(v)},case:function(v,d){return new m.Case(v,d)},select:function(v,d){return new m.Select(v,d)},update:function(v,d){return new m.Update(v,d)},insert:function(v,d){return new m.Insert(v,d)},delete:function(v,d){return new m.Delete(v,d)},str:function(){var v=new m.FunctionBlock;return v.function.apply(v,arguments),v},rstr:function(){var v=new m.FunctionBlock({rawNesting:!0});return v.function.apply(v,arguments),v},registerValueHandler:m.registerValueHandler};return O.remove=O.delete,O.cls=m,O}var te=X();return te.flavours={},te.useFlavour=function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!U)return te;if(te.flavours[U]instanceof Function){var m=X(U);return te.flavours[U].call(null,m),m.flavours=te.flavours,m.useFlavour=te.useFlavour,m}throw new Error("Flavour not available: "+U)},te.flavours.mssql=function(U){var m=U.cls;m.DefaultQueryBuilderOptions.replaceSingleQuotes=!0,m.DefaultQueryBuilderOptions.autoQuoteAliasNames=!1,m.DefaultQueryBuilderOptions.numberedParametersPrefix="@",U.registerValueHandler(Date,function(P){return"'"+P.getUTCFullYear()+"-"+(P.getUTCMonth()+1)+"-"+P.getUTCDate()+" "+P.getUTCHours()+":"+P.getUTCMinutes()+":"+P.getUTCSeconds()+"'"}),m.MssqlLimitOffsetTopBlock=function(P){function O(v){a(this,O);var d=i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v));d._limits=null,d._offsets=null;var f=function(g){g=this._sanitizeLimitOffset(g),this._parent._limits=g};return d.ParentBlock=function(g){function b(E){a(this,b);var F=i(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,E.options));return F._parent=E,F}return o(b,g),b}(m.Block),d.LimitBlock=function(g){function b(E){a(this,b);var F=i(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,E));return F.limit=f,F}return o(b,g),e(b,[{key:"_toParamString",value:function(){var E="";return this._parent._limits&&this._parent._offsets&&(E="FETCH NEXT "+this._parent._limits+" ROWS ONLY"),{text:E,values:[]}}}]),b}(d.ParentBlock),d.TopBlock=function(g){function b(E){a(this,b);var F=i(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,E));return F.top=f,F}return o(b,g),e(b,[{key:"_toParamString",value:function(){var E="";return this._parent._limits&&!this._parent._offsets&&(E="TOP ("+this._parent._limits+")"),{text:E,values:[]}}}]),b}(d.ParentBlock),d.OffsetBlock=function(g){function b(){return a(this,b),i(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return o(b,g),e(b,[{key:"offset",value:function(E){this._parent._offsets=this._sanitizeLimitOffset(E)}},{key:"_toParamString",value:function(){var E="";return this._parent._offsets&&(E="OFFSET "+this._parent._offsets+" ROWS"),{text:E,values:[]}}}]),b}(d.ParentBlock),d}return o(O,P),e(O,[{key:"LIMIT",value:function(){return new this.LimitBlock(this)}},{key:"TOP",value:function(){return new this.TopBlock(this)}},{key:"OFFSET",value:function(){return new this.OffsetBlock(this)}}]),O}(m.Block),m.MssqlUpdateTopBlock=function(P){function O(v){a(this,O);var d=i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v));return d._limits=null,d.limit=d.top=function(f){d._limits=d._sanitizeLimitOffset(f)},d}return o(O,P),e(O,[{key:"_toParamString",value:function(){return{text:this._limits?"TOP ("+this._limits+")":"",values:[]}}}]),O}(m.Block),m.MssqlInsertFieldValueBlock=function(P){function O(v){a(this,O);var d=i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v));return d._outputs=[],d}return o(O,P),e(O,[{key:"output",value:function(v){var d=this;typeof v=="string"?this._outputs.push("INSERTED."+this._sanitizeField(v)):v.forEach(function(f){d._outputs.push("INSERTED."+d._sanitizeField(f))})}},{key:"_toParamString",value:function(v){var d=t(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"_toParamString",this).call(this,v);if(d.text.length&&0<this._outputs.length){var f="OUTPUT "+this._outputs.join(", ")+" ",g=d.text.indexOf("VALUES");d.text=d.text.substr(0,g)+f+d.text.substr(g)}return d}}]),O}(m.InsertFieldValueBlock),m.MssqlUpdateDeleteOutputBlock=function(P){function O(v){a(this,O);var d=i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v));return d._outputs=[],d}return o(O,P),e(O,[{key:"outputs",value:function(v){for(var d in v)this.output(d,v[d])}},{key:"output",value:function(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;v=this._sanitizeField(v),d=d&&this._sanitizeFieldAlias(d),this._outputs.push({name:this.options.forDelete?"DELETED."+v:"INSERTED."+v,alias:d})}},{key:"_toParamString",value:function(v){var d="";if(this._outputs.length){var f=!0,g=!1,b=void 0;try{for(var E,F=this._outputs[Symbol.iterator]();!(f=(E=F.next()).done);f=!0){var $=E.value;d=p(d,", "),d+=$.name,$.alias&&(d+=" AS "+this._formatFieldAlias($.alias))}}catch(C){g=!0,b=C}finally{try{!f&&F.return&&F.return()}finally{if(g)throw b}}d="OUTPUT "+d}return{text:d,values:[]}}}]),O}(m.Block),m.Select=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;a(this,O);var f=new m.MssqlLimitOffsetTopBlock(v);return d=d||[new m.StringBlock(v,"SELECT"),new m.DistinctBlock(v),f.TOP(),new m.GetFieldBlock(v),new m.FromTableBlock(v),new m.JoinBlock(v),new m.WhereBlock(v),new m.GroupByBlock(v),new m.OrderByBlock(v),f.OFFSET(),f.LIMIT(),new m.UnionBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder),m.Update=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.StringBlock(v,"UPDATE"),new m.MssqlUpdateTopBlock(v),new m.UpdateTableBlock(v),new m.SetFieldBlock(v),new m.MssqlUpdateDeleteOutputBlock(v),new m.WhereBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder),m.Delete=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.StringBlock(v,"DELETE"),new m.TargetTableBlock(v),new m.FromTableBlock(c({},v,{singleTable:!0})),new m.JoinBlock(v),new m.MssqlUpdateDeleteOutputBlock(c({},v,{forDelete:!0})),new m.WhereBlock(v),new m.OrderByBlock(v),new m.LimitBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder),m.Insert=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.StringBlock(v,"INSERT"),new m.IntoTableBlock(v),new m.MssqlInsertFieldValueBlock(v),new m.InsertFieldsFromQueryBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder)},te.flavours.mysql=function(U){var m=U.cls;m.MysqlOnDuplicateKeyUpdateBlock=function(P){function O(){return a(this,O),i(this,(O.__proto__||Object.getPrototypeOf(O)).apply(this,arguments))}return o(O,P),e(O,[{key:"onDupUpdate",value:function(v,d,f){this._set(v,d,f)}},{key:"_toParamString",value:function(){for(var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d="",f=[],g=0;g<this._fields.length;++g){d=p(d,", ");var b=this._fields[g],E=this._values[0][g],F=this._valueOptions[0][g];if(E===void 0)d+=b;else{var $=this._buildString(b+" = "+this.options.parameterCharacter,[E],{buildParameterized:v.buildParameterized,formattingOptions:F});d+=$.text,$.values.forEach(function(C){return f.push(C)})}}return{text:d.length?"ON DUPLICATE KEY UPDATE "+d:"",values:f}}}]),O}(m.AbstractSetFieldBlock),m.Insert=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.StringBlock(v,"INSERT"),new m.IntoTableBlock(v),new m.InsertFieldValueBlock(v),new m.InsertFieldsFromQueryBlock(v),new m.MysqlOnDuplicateKeyUpdateBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder),m.Replace=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.StringBlock(v,"REPLACE"),new m.IntoTableBlock(v),new m.InsertFieldValueBlock(v),new m.InsertFieldsFromQueryBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder),U.replace=function(P,O){return new m.Replace(P,O)}},te.flavours.postgres=function(U){var m=U.cls;m.DefaultQueryBuilderOptions.numberedParameters=!0,m.DefaultQueryBuilderOptions.numberedParametersStartAt=1,m.DefaultQueryBuilderOptions.autoQuoteAliasNames=!1,m.DefaultQueryBuilderOptions.useAsForTableAliasNames=!0,m.PostgresOnConflictKeyUpdateBlock=function(P){function O(){return a(this,O),i(this,(O.__proto__||Object.getPrototypeOf(O)).apply(this,arguments))}return o(O,P),e(O,[{key:"onConflict",value:function(v,d){var f=this;this._onConflict=!0,v&&(x(v)||(v=[v]),this._dupFields=v.map(this._sanitizeField.bind(this)),d&&Object.keys(d).forEach(function(g){f._set(g,d[g])}))}},{key:"_toParamString",value:function(){for(var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d="",f=[],g=0;g<this._fields.length;++g){d=p(d,", ");var b=this._fields[g],E=this._values[0][g],F=this._valueOptions[0][g];if(E===void 0)d+=b;else{var $=this._buildString(b+" = "+this.options.parameterCharacter,[E],{buildParameterized:v.buildParameterized,formattingOptions:F});d+=$.text,$.values.forEach(function(Q){return f.push(Q)})}}var C={text:"",values:f};if(this._onConflict){var J=this._dupFields?"("+this._dupFields.join(", ")+") ":"",Y=d.length?"UPDATE SET "+d:"NOTHING";C.text="ON CONFLICT "+J+"DO "+Y}return C}}]),O}(m.AbstractSetFieldBlock),m.ReturningBlock=function(P){function O(v){a(this,O);var d=i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v));return d._fields=[],d}return o(O,P),e(O,[{key:"returning",value:function(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(d=d&&this._sanitizeFieldAlias(d),v=this._sanitizeField(v),this._fields.filter(function(g){return g.name===v&&g.alias===d}).length)return this;this._fields.push({name:v,alias:d,options:f})}},{key:"_toParamString",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};v.queryBuilder;var d=v.buildParameterized,f="",g=[],b=!0,E=!1,F=void 0;try{for(var $,C=this._fields[Symbol.iterator]();!(b=($=C.next()).done);b=!0){var J=$.value;f=p(f,", ");var Y=J.name,Q=J.alias,K=J.options;if(typeof Y=="string")f+=this._formatFieldName(Y,K);else{var ne=Y._toParamString({nested:!0,buildParameterized:d});f+=ne.text,ne.values.forEach(function(ie){return g.push(ie)})}Q&&(f+=" AS "+this._formatFieldAlias(Q))}}catch(ie){E=!0,F=ie}finally{try{!b&&C.return&&C.return()}finally{if(E)throw F}}return{text:f.length>0?"RETURNING "+f:"",values:g}}}]),O}(m.Block),m.WithBlock=function(P){function O(v){a(this,O);var d=i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v));return d._tables=[],d}return o(O,P),e(O,[{key:"with",value:function(v,d){this._tables.push({alias:v,table:d})}},{key:"_toParamString",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=[],f=[],g=!0,b=!1,E=void 0;try{for(var F,$=this._tables[Symbol.iterator]();!(g=(F=$.next()).done);g=!0){var C=F.value,J=C.alias,Y=C.table._toParamString({buildParameterized:v.buildParameterized,nested:!0});d.push(J+" AS "+Y.text),Y.values.forEach(function(Q){return f.push(Q)})}}catch(Q){b=!0,E=Q}finally{try{!g&&$.return&&$.return()}finally{if(b)throw E}}return{text:d.length?"WITH "+d.join(", "):"",values:f}}}]),O}(m.Block),m.DistinctOnBlock=function(P){function O(v){a(this,O);var d=i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v));return d._distinctFields=[],d}return o(O,P),e(O,[{key:"distinct",value:function(){var v=this;this._useDistinct=!0;for(var d=arguments.length,f=Array(d),g=0;g<d;g++)f[g]=arguments[g];f.forEach(function(b){v._distinctFields.push(v._sanitizeField(b))})}},{key:"_toParamString",value:function(){var v="";return this._useDistinct&&(v="DISTINCT",this._distinctFields.length&&(v+=" ON ("+this._distinctFields.join(", ")+")")),{text:v,values:[]}}}]),O}(m.Block),m.Select=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.WithBlock(v),new m.StringBlock(v,"SELECT"),new m.FunctionBlock(v),new m.DistinctOnBlock(v),new m.GetFieldBlock(v),new m.FromTableBlock(v),new m.JoinBlock(v),new m.WhereBlock(v),new m.GroupByBlock(v),new m.HavingBlock(v),new m.OrderByBlock(v),new m.LimitBlock(v),new m.OffsetBlock(v),new m.UnionBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder),m.Insert=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.WithBlock(v),new m.StringBlock(v,"INSERT"),new m.IntoTableBlock(v),new m.InsertFieldValueBlock(v),new m.InsertFieldsFromQueryBlock(v),new m.PostgresOnConflictKeyUpdateBlock(v),new m.ReturningBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder),m.Update=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.WithBlock(v),new m.StringBlock(v,"UPDATE"),new m.UpdateTableBlock(v),new m.SetFieldBlock(v),new m.FromTableBlock(v),new m.WhereBlock(v),new m.OrderByBlock(v),new m.LimitBlock(v),new m.ReturningBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder),m.Delete=function(P){function O(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return a(this,O),d=d||[new m.WithBlock(v),new m.StringBlock(v,"DELETE"),new m.TargetTableBlock(v),new m.FromTableBlock(c({},v,{singleTable:!0})),new m.JoinBlock(v),new m.WhereBlock(v),new m.OrderByBlock(v),new m.LimitBlock(v),new m.ReturningBlock(v)],i(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,v,d))}return o(O,P),O}(m.QueryBuilder)},te}();var re=vr(yr.exports);function Le(t,e){(function(r,i){r.exec(`
    create table if not exists 'chat_logs_${i}' (
        'client_msg_id' char(32),
        'server_msg_id' char(32),
        'send_id' char(32),
        'recv_id' char(32),
        'sender_platform_id' smallint,
        'sender_nick_name' varchar(255),
        'sender_face_url' varchar(255),
        'session_type' smallint,
        'msg_from' smallint,
        'content_type' smallint,
        'content' varchar(1000),
        'is_read' tinyint(1),
        'status' smallint,
        'seq' int DEFAULT 0,
        'send_time' int,
        'create_time' int,
        'attached_info' varchar(1024),
        'ex' varchar(1024),
        'local_ex' varchar(1024),
        'is_react' tinyint(1),
        'is_external_extensions' tinyint(1),
        'msg_first_modify_time' int,
        PRIMARY KEY ('client_msg_id')
      );
      `)})(t,e)}function br(t){return t.exec(`
        select * from local_super_groups;
    `)}function wr(t,e){const r=re.insert().into("local_friends").setFields(e).toString();return t.exec(r)}function Er(t,e){const r=re.insert().into("local_groups").setFields(e).toString();return t.exec(r)}function Ht(t){return t.exec(`
    SELECT * FROM local_groups
    `)}function Or(t,e,r){return t.exec(`INSERT INTO local_notification_seqs (conversation_id, seq) VALUES ("${e}", ${r});`)}function Sr(t,e){const r=e.map(i=>`'${i}'`);return t.exec(`
        select *
        from local_stranger
        WHERE user_id = (${r.join(",")})
        `)}function kr(t){return t.exec(`
      SELECT * FROM local_app_sdk_version LIMIT 1
        `)}function Rr(t,e,r){return t.exec(`
      SELECT * FROM local_sync_version WHERE table_name = "${e}" AND entity_id = "${r}"
    `)}function _(t,e,r){let i=t;return typeof t=="object"&&(i=JSON.stringify(t)),{data:t!==void 0?i:"{}",errCode:e||0,errMsg:r||""}}const Nr=[["user_id","userID"],["group_id","groupID"],["client_msg_id","clientMsgID"],["server_msg_id","serverMsgID"],["send_id","sendID"],["recv_id","recvID"],["sender_platform_id","senderPlatformID"],["sender_nick_name","senderNickname"],["sender_face_url","senderFaceURL"],["session_type","sessionType"],["msg_from","msgFrom"],["content_type","contentType"],["content","content"],["is_read","isRead"],["is_react","isReact"],["is_external_extensions","isExternalExtensions"],["msg_first_modify_time","msgFirstModifyTime"],["status","status"],["seq","seq"],["send_time","sendTime"],["create_time","createTime"],["attached_info","attachedInfo"],["ex","ex"],["face_url","faceURL"],["creator_user_id","creatorUserID"],["conversation_id","conversationID"],["owner_user_id","ownerUserID"],["notification_user_id","notificationUserID"],["operator_user_id","operatorUserID"],["from_face_url","fromFaceURL"],["from_user_id","fromUserID"],["from_gender","fromGender"],["from_nickname","fromNickname"],["to_user_id","toUserID"],["to_nickname","toNickname"],["to_face_url","toFaceURL"],["to_gender","toGender"],["req_msg","reqMsg"],["handle_msg","handleMsg"],["handle_time","handleTime"],["handle_result","handleResult"],["handler_user_id","handlerUserID"],["handle_user_id","handleUserID"],["inviter_user_id","inviterUserID"],["mute_end_time","muteEndTime"],["role_level","roleLevel"],["join_time","joinTime"],["join_source","joinSource"],["friend_user_id","friendUserID"],["recv_msg_opt","recvMsgOpt"],["group_at_type","groupAtType"],["latest_msg_send_time","latestMsgSendTime"],["draft_text_time","draftTextTime"],["is_private_chat","isPrivateChat"],["is_not_in_group","isNotInGroup"],["update_unread_count_time","updateUnreadCountTime"],["is_msg_destruct","isMsgDestruct"],["msg_destruct_time","msgDestructTime"],["part_hash","partHash"],["upload_id","uploadID"],["upload_info","uploadInfo"],["expire_time","expireTime"],["entity_id","entityID"],["version_id","versionID"],["display_is_read","displayIsRead"]];function $n(t){const e=function(o){const a=Nr.find(p=>p[0]===o);if(a)return a[1]}(t);if(e)return e;const r=[];let i=-2;for(let o=0;o<t.length;o++){const a=t[o];a==="_"&&o<t.length-1?i=o:o-1===i?r.push(a.toUpperCase()):r.push(a)}return r.join("")}function Mr(t){const e=function(i){const o=Nr.find(a=>a[1]===i);if(o)return o[0]}(t);if(e)return e;const r=[];for(let i=0;i<t.length;i++){const o=t[i];o.toLowerCase()!==o&&r.push("_"),r.push(o.toLowerCase())}return r.join("")}const Ln=/[\0\b\t\n\r\x1a"'\\]/g,Un={"\0":"\\0","\b":"\\b","	":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};function j(t,e="CamelCase",r=[],i={}){const{columns:o=[],values:a=[]}=t||{},p=[];return a.forEach(c=>{const M={};o.forEach((x,A)=>{let D=x,L=c[A];e==="CamelCase"&&(D=$n(x)),e==="SnakeCase"&&(D=Mr(x)),r.find(G=>G===D)&&(L=!!L),D=i[x]||D,M[D]=L}),p.push(M)}),p}function se(t,e=!0){const r={};return Object.keys(t).forEach(i=>{let o=t[i];e&&function(a){return typeof a=="string"}(o)&&(o=function(a,p={backslashSupported:!1}){if(a==null)throw new Error("Need to pass a valid string");if(!(p=p||{}).backslashSupported)return"'"+a.replace(/'/g,"''")+"'";const c=Ln,M=Un;let x,A=c.lastIndex=0,D="";for(;x=c.exec(a);)D+=a.slice(A,x.index)+M[x[0]],A=c.lastIndex;return A===0?"'"+a+"'":A<a.length?"'"+D+a.slice(A)+"'":"'"+D+"'"}(o).slice(1,-1)),r[Mr(i)]=o}),r}function le(t,e={}){const r={};return Object.keys(t).forEach(i=>{const o=e[i]||i;r[o]=t[i]}),r}var mt=typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{};function xr(){throw new Error("setTimeout has not been defined")}function Ar(){throw new Error("clearTimeout has not been defined")}var Je=xr,ze=Ar;function Ir(t){if(Je===setTimeout)return setTimeout(t,0);if((Je===xr||!Je)&&setTimeout)return Je=setTimeout,setTimeout(t,0);try{return Je(t,0)}catch(e){try{return Je.call(null,t,0)}catch(r){return Je.call(this,t,0)}}}typeof mt.setTimeout=="function"&&(Je=setTimeout),typeof mt.clearTimeout=="function"&&(ze=clearTimeout);var Xe,Ue=[],at=!1,kt=-1;function qn(){at&&Xe&&(at=!1,Xe.length?Ue=Xe.concat(Ue):kt=-1,Ue.length&&Tr())}function Tr(){if(!at){var t=Ir(qn);at=!0;for(var e=Ue.length;e;){for(Xe=Ue,Ue=[];++kt<e;)Xe&&Xe[kt].run();kt=-1,e=Ue.length}Xe=null,at=!1,function(r){if(ze===clearTimeout)return clearTimeout(r);if((ze===Ar||!ze)&&clearTimeout)return ze=clearTimeout,clearTimeout(r);try{return ze(r)}catch(i){try{return ze.call(null,r)}catch(o){return ze.call(this,r)}}}(t)}}function Cr(t,e){this.fun=t,this.array=e}Cr.prototype.run=function(){this.fun.apply(null,this.array)};function Ze(){}var jn=Ze,Jn=Ze,zn=Ze,Wn=Ze,Hn=Ze,Gn=Ze,Yn=Ze,ut=mt.performance||{},Vn=ut.now||ut.mozNow||ut.msNow||ut.oNow||ut.webkitNow||function(){return new Date().getTime()},Qn=new Date,Fe={nextTick:function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Ue.push(new Cr(t,e)),Ue.length!==1||at||Ir(Tr)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:jn,addListener:Jn,once:zn,off:Wn,removeListener:Hn,removeAllListeners:Gn,emit:Yn,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*Vn.call(ut),r=Math.floor(e),i=Math.floor(e%1*1e9);return t&&(r-=t[0],(i-=t[1])<0&&(r--,i+=1e9)),[r,i]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Qn)/1e3}},Be=[],xe=[],Kn=typeof Uint8Array!="undefined"?Uint8Array:Array,Gt=!1;function Fr(){Gt=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0;e<64;++e)Be[e]=t[e],xe[t.charCodeAt(e)]=e;xe["-".charCodeAt(0)]=62,xe["_".charCodeAt(0)]=63}function Xn(t,e,r){for(var i,o,a=[],p=e;p<r;p+=3)i=(t[p]<<16)+(t[p+1]<<8)+t[p+2],a.push(Be[(o=i)>>18&63]+Be[o>>12&63]+Be[o>>6&63]+Be[63&o]);return a.join("")}function Br(t){var e;Gt||Fr();for(var r=t.length,i=r%3,o="",a=[],p=16383,c=0,M=r-i;c<M;c+=p)a.push(Xn(t,c,c+p>M?M:c+p));return i===1?(e=t[r-1],o+=Be[e>>2],o+=Be[e<<4&63],o+="=="):i===2&&(e=(t[r-2]<<8)+t[r-1],o+=Be[e>>10],o+=Be[e>>4&63],o+=Be[e<<2&63],o+="="),a.push(o),a.join("")}function Rt(t,e,r,i,o){var a,p,c=8*o-i-1,M=(1<<c)-1,x=M>>1,A=-7,D=r?o-1:0,L=r?-1:1,G=t[e+D];for(D+=L,a=G&(1<<-A)-1,G>>=-A,A+=c;A>0;a=256*a+t[e+D],D+=L,A-=8);for(p=a&(1<<-A)-1,a>>=-A,A+=i;A>0;p=256*p+t[e+D],D+=L,A-=8);if(a===0)a=1-x;else{if(a===M)return p?NaN:1/0*(G?-1:1);p+=Math.pow(2,i),a-=x}return(G?-1:1)*p*Math.pow(2,a-i)}function Pr(t,e,r,i,o,a){var p,c,M,x=8*a-o-1,A=(1<<x)-1,D=A>>1,L=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,G=i?0:a-1,X=i?1:-1,te=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,p=A):(p=Math.floor(Math.log(e)/Math.LN2),e*(M=Math.pow(2,-p))<1&&(p--,M*=2),(e+=p+D>=1?L/M:L*Math.pow(2,1-D))*M>=2&&(p++,M/=2),p+D>=A?(c=0,p=A):p+D>=1?(c=(e*M-1)*Math.pow(2,o),p+=D):(c=e*Math.pow(2,D-1)*Math.pow(2,o),p=0));o>=8;t[r+G]=255&c,G+=X,c/=256,o-=8);for(p=p<<o|c,x+=o;x>0;t[r+G]=255&p,G+=X,p/=256,x-=8);t[r+G-X]|=128*te}var Zn={}.toString,Dr=Array.isArray||function(t){return Zn.call(t)=="[object Array]"};function Nt(){return B.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function qe(t,e){if(Nt()<e)throw new RangeError("Invalid typed array length");return B.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=B.prototype:(t===null&&(t=new B(e)),t.length=e),t}function B(t,e,r){if(!(B.TYPED_ARRAY_SUPPORT||this instanceof B))return new B(t,e,r);if(typeof t=="number"){if(typeof e=="string")throw new Error("If encoding is specified then the first argument must be a string");return Yt(this,t)}return $r(this,t,e,r)}function $r(t,e,r,i){if(typeof e=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer?function(o,a,p,c){if(a.byteLength,p<0||a.byteLength<p)throw new RangeError("'offset' is out of bounds");if(a.byteLength<p+(c||0))throw new RangeError("'length' is out of bounds");return a=p===void 0&&c===void 0?new Uint8Array(a):c===void 0?new Uint8Array(a,p):new Uint8Array(a,p,c),B.TYPED_ARRAY_SUPPORT?(o=a).__proto__=B.prototype:o=Vt(o,a),o}(t,e,r,i):typeof e=="string"?function(o,a,p){if(typeof p=="string"&&p!==""||(p="utf8"),!B.isEncoding(p))throw new TypeError('"encoding" must be a valid string encoding');var c=0|Ur(a,p);o=qe(o,c);var M=o.write(a,p);return M!==c&&(o=o.slice(0,M)),o}(t,e,r):function(o,a){if(Pe(a)){var p=0|Qt(a.length);return(o=qe(o,p)).length===0||a.copy(o,0,0,p),o}if(a){if(typeof ArrayBuffer!="undefined"&&a.buffer instanceof ArrayBuffer||"length"in a)return typeof a.length!="number"||(c=a.length)!=c?qe(o,0):Vt(o,a);if(a.type==="Buffer"&&Dr(a.data))return Vt(o,a.data)}var c;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function Lr(t){if(typeof t!="number")throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Yt(t,e){if(Lr(e),t=qe(t,e<0?0:0|Qt(e)),!B.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function Vt(t,e){var r=e.length<0?0:0|Qt(e.length);t=qe(t,r);for(var i=0;i<r;i+=1)t[i]=255&e[i];return t}function Qt(t){if(t>=Nt())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Nt().toString(16)+" bytes");return 0|t}function Pe(t){return!(t==null||!t._isBuffer)}function Ur(t,e){if(Pe(t))return t.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;typeof t!="string"&&(t=""+t);var r=t.length;if(r===0)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return At(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Vr(t).length;default:if(i)return At(t).length;e=(""+e).toLowerCase(),i=!0}}function ei(t,e,r){var i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return ci(this,e,r);case"utf8":case"utf-8":return zr(this,e,r);case"ascii":return ai(this,e,r);case"latin1":case"binary":return ui(this,e,r);case"base64":return si(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return li(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function et(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function qr(t,e,r,i,o){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if(typeof e=="string"&&(e=B.from(e,i)),Pe(e))return e.length===0?-1:jr(t,e,r,i,o);if(typeof e=="number")return e&=255,B.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):jr(t,[e],r,i,o);throw new TypeError("val must be string, number or Buffer")}function jr(t,e,r,i,o){var a,p=1,c=t.length,M=e.length;if(i!==void 0&&((i=String(i).toLowerCase())==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;p=2,c/=2,M/=2,r/=2}function x(G,X){return p===1?G[X]:G.readUInt16BE(X*p)}if(o){var A=-1;for(a=r;a<c;a++)if(x(t,a)===x(e,A===-1?0:a-A)){if(A===-1&&(A=a),a-A+1===M)return A*p}else A!==-1&&(a-=a-A),A=-1}else for(r+M>c&&(r=c-M),a=r;a>=0;a--){for(var D=!0,L=0;L<M;L++)if(x(t,a+L)!==x(e,L)){D=!1;break}if(D)return a}return-1}function ti(t,e,r,i){r=Number(r)||0;var o=t.length-r;i?(i=Number(i))>o&&(i=o):i=o;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var p=0;p<i;++p){var c=parseInt(e.substr(2*p,2),16);if(isNaN(c))return p;t[r+p]=c}return p}function ri(t,e,r,i){return It(At(e,t.length-r),t,r,i)}function Jr(t,e,r,i){return It(function(o){for(var a=[],p=0;p<o.length;++p)a.push(255&o.charCodeAt(p));return a}(e),t,r,i)}function ni(t,e,r,i){return Jr(t,e,r,i)}function ii(t,e,r,i){return It(Vr(e),t,r,i)}function oi(t,e,r,i){return It(function(o,a){for(var p,c,M,x=[],A=0;A<o.length&&!((a-=2)<0);++A)c=(p=o.charCodeAt(A))>>8,M=p%256,x.push(M),x.push(c);return x}(e,t.length-r),t,r,i)}function si(t,e,r){return e===0&&r===t.length?Br(t):Br(t.slice(e,r))}function zr(t,e,r){r=Math.min(t.length,r);for(var i=[],o=e;o<r;){var a,p,c,M,x=t[o],A=null,D=x>239?4:x>223?3:x>191?2:1;if(o+D<=r)switch(D){case 1:x<128&&(A=x);break;case 2:(192&(a=t[o+1]))==128&&(M=(31&x)<<6|63&a)>127&&(A=M);break;case 3:a=t[o+1],p=t[o+2],(192&a)==128&&(192&p)==128&&(M=(15&x)<<12|(63&a)<<6|63&p)>2047&&(M<55296||M>57343)&&(A=M);break;case 4:a=t[o+1],p=t[o+2],c=t[o+3],(192&a)==128&&(192&p)==128&&(192&c)==128&&(M=(15&x)<<18|(63&a)<<12|(63&p)<<6|63&c)>65535&&M<1114112&&(A=M)}A===null?(A=65533,D=1):A>65535&&(A-=65536,i.push(A>>>10&1023|55296),A=56320|1023&A),i.push(A),o+=D}return function(L){var G=L.length;if(G<=Wr)return String.fromCharCode.apply(String,L);for(var X="",te=0;te<G;)X+=String.fromCharCode.apply(String,L.slice(te,te+=Wr));return X}(i)}B.TYPED_ARRAY_SUPPORT=mt.TYPED_ARRAY_SUPPORT===void 0||mt.TYPED_ARRAY_SUPPORT,Nt(),B.poolSize=8192,B._augment=function(t){return t.__proto__=B.prototype,t},B.from=function(t,e,r){return $r(null,t,e,r)},B.TYPED_ARRAY_SUPPORT&&(B.prototype.__proto__=Uint8Array.prototype,B.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&B[Symbol.species]),B.alloc=function(t,e,r){return function(i,o,a,p){return Lr(o),o<=0?qe(i,o):a!==void 0?typeof p=="string"?qe(i,o).fill(a,p):qe(i,o).fill(a):qe(i,o)}(null,t,e,r)},B.allocUnsafe=function(t){return Yt(null,t)},B.allocUnsafeSlow=function(t){return Yt(null,t)},B.isBuffer=function(t){return t!=null&&(!!t._isBuffer||Qr(t)||function(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&Qr(e.slice(0,0))}(t))},B.compare=function(t,e){if(!Pe(t)||!Pe(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,i=e.length,o=0,a=Math.min(r,i);o<a;++o)if(t[o]!==e[o]){r=t[o],i=e[o];break}return r<i?-1:i<r?1:0},B.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},B.concat=function(t,e){if(!Dr(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return B.alloc(0);var r;if(e===void 0)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=B.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var a=t[r];if(!Pe(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},B.byteLength=Ur,B.prototype._isBuffer=!0,B.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)et(this,e,e+1);return this},B.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)et(this,e,e+3),et(this,e+1,e+2);return this},B.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)et(this,e,e+7),et(this,e+1,e+6),et(this,e+2,e+5),et(this,e+3,e+4);return this},B.prototype.toString=function(){var t=0|this.length;return t===0?"":arguments.length===0?zr(this,0,t):ei.apply(this,arguments)},B.prototype.equals=function(t){if(!Pe(t))throw new TypeError("Argument must be a Buffer");return this===t||B.compare(this,t)===0},B.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},B.prototype.compare=function(t,e,r,i,o){if(!Pe(t))throw new TypeError("Argument must be a Buffer");if(e===void 0&&(e=0),r===void 0&&(r=t?t.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),e<0||r>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=r)return 0;if(i>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var a=(o>>>=0)-(i>>>=0),p=(r>>>=0)-(e>>>=0),c=Math.min(a,p),M=this.slice(i,o),x=t.slice(e,r),A=0;A<c;++A)if(M[A]!==x[A]){a=M[A],p=x[A];break}return a<p?-1:p<a?1:0},B.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1},B.prototype.indexOf=function(t,e,r){return qr(this,t,e,r,!0)},B.prototype.lastIndexOf=function(t,e,r){return qr(this,t,e,r,!1)},B.prototype.write=function(t,e,r,i){if(e===void 0)i="utf8",r=this.length,e=0;else if(r===void 0&&typeof e=="string")i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,i===void 0&&(i="utf8")):(i=r,r=void 0)}var o=this.length-e;if((r===void 0||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return ti(this,t,e,r);case"utf8":case"utf-8":return ri(this,t,e,r);case"ascii":return Jr(this,t,e,r);case"latin1":case"binary":return ni(this,t,e,r);case"base64":return ii(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oi(this,t,e,r);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},B.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Wr=4096;function ai(t,e,r){var i="";r=Math.min(t.length,r);for(var o=e;o<r;++o)i+=String.fromCharCode(127&t[o]);return i}function ui(t,e,r){var i="";r=Math.min(t.length,r);for(var o=e;o<r;++o)i+=String.fromCharCode(t[o]);return i}function ci(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var o="",a=e;a<r;++a)o+=di(t[a]);return o}function li(t,e,r){for(var i=t.slice(e,r),o="",a=0;a<i.length;a+=2)o+=String.fromCharCode(i[a]+256*i[a+1]);return o}function Ee(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function Re(t,e,r,i,o,a){if(!Pe(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<a)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function Mt(t,e,r,i){e<0&&(e=65535+e+1);for(var o=0,a=Math.min(t.length-r,2);o<a;++o)t[r+o]=(e&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function xt(t,e,r,i){e<0&&(e=4294967295+e+1);for(var o=0,a=Math.min(t.length-r,4);o<a;++o)t[r+o]=e>>>8*(i?o:3-o)&255}function Hr(t,e,r,i,o,a){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Gr(t,e,r,i,o){return o||Hr(t,0,r,4),Pr(t,e,r,i,23,4),r+4}function Yr(t,e,r,i,o){return o||Hr(t,0,r,8),Pr(t,e,r,i,52,8),r+8}B.prototype.slice=function(t,e){var r,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=e===void 0?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),B.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=B.prototype;else{var o=e-t;r=new B(o,void 0);for(var a=0;a<o;++a)r[a]=this[a+t]}return r},B.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||Ee(t,e,this.length);for(var i=this[t],o=1,a=0;++a<e&&(o*=256);)i+=this[t+a]*o;return i},B.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||Ee(t,e,this.length);for(var i=this[t+--e],o=1;e>0&&(o*=256);)i+=this[t+--e]*o;return i},B.prototype.readUInt8=function(t,e){return e||Ee(t,1,this.length),this[t]},B.prototype.readUInt16LE=function(t,e){return e||Ee(t,2,this.length),this[t]|this[t+1]<<8},B.prototype.readUInt16BE=function(t,e){return e||Ee(t,2,this.length),this[t]<<8|this[t+1]},B.prototype.readUInt32LE=function(t,e){return e||Ee(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},B.prototype.readUInt32BE=function(t,e){return e||Ee(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},B.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||Ee(t,e,this.length);for(var i=this[t],o=1,a=0;++a<e&&(o*=256);)i+=this[t+a]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},B.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||Ee(t,e,this.length);for(var i=e,o=1,a=this[t+--i];i>0&&(o*=256);)a+=this[t+--i]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*e)),a},B.prototype.readInt8=function(t,e){return e||Ee(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},B.prototype.readInt16LE=function(t,e){e||Ee(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},B.prototype.readInt16BE=function(t,e){e||Ee(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},B.prototype.readInt32LE=function(t,e){return e||Ee(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},B.prototype.readInt32BE=function(t,e){return e||Ee(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},B.prototype.readFloatLE=function(t,e){return e||Ee(t,4,this.length),Rt(this,t,!0,23,4)},B.prototype.readFloatBE=function(t,e){return e||Ee(t,4,this.length),Rt(this,t,!1,23,4)},B.prototype.readDoubleLE=function(t,e){return e||Ee(t,8,this.length),Rt(this,t,!0,52,8)},B.prototype.readDoubleBE=function(t,e){return e||Ee(t,8,this.length),Rt(this,t,!1,52,8)},B.prototype.writeUIntLE=function(t,e,r,i){t=+t,e|=0,r|=0,i||Re(this,t,e,r,Math.pow(2,8*r)-1,0);var o=1,a=0;for(this[e]=255&t;++a<r&&(o*=256);)this[e+a]=t/o&255;return e+r},B.prototype.writeUIntBE=function(t,e,r,i){t=+t,e|=0,r|=0,i||Re(this,t,e,r,Math.pow(2,8*r)-1,0);var o=r-1,a=1;for(this[e+o]=255&t;--o>=0&&(a*=256);)this[e+o]=t/a&255;return e+r},B.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,1,255,0),B.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},B.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,2,65535,0),B.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Mt(this,t,e,!0),e+2},B.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,2,65535,0),B.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Mt(this,t,e,!1),e+2},B.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,4,4294967295,0),B.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):xt(this,t,e,!0),e+4},B.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,4,4294967295,0),B.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):xt(this,t,e,!1),e+4},B.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e|=0,!i){var o=Math.pow(2,8*r-1);Re(this,t,e,r,o-1,-o)}var a=0,p=1,c=0;for(this[e]=255&t;++a<r&&(p*=256);)t<0&&c===0&&this[e+a-1]!==0&&(c=1),this[e+a]=(t/p>>0)-c&255;return e+r},B.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e|=0,!i){var o=Math.pow(2,8*r-1);Re(this,t,e,r,o-1,-o)}var a=r-1,p=1,c=0;for(this[e+a]=255&t;--a>=0&&(p*=256);)t<0&&c===0&&this[e+a+1]!==0&&(c=1),this[e+a]=(t/p>>0)-c&255;return e+r},B.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,1,127,-128),B.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},B.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,2,32767,-32768),B.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Mt(this,t,e,!0),e+2},B.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,2,32767,-32768),B.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Mt(this,t,e,!1),e+2},B.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,4,2147483647,-2147483648),B.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):xt(this,t,e,!0),e+4},B.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||Re(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),B.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):xt(this,t,e,!1),e+4},B.prototype.writeFloatLE=function(t,e,r){return Gr(this,t,e,!0,r)},B.prototype.writeFloatBE=function(t,e,r){return Gr(this,t,e,!1,r)},B.prototype.writeDoubleLE=function(t,e,r){return Yr(this,t,e,!0,r)},B.prototype.writeDoubleBE=function(t,e,r){return Yr(this,t,e,!1,r)},B.prototype.copy=function(t,e,r,i){if(r||(r=0),i||i===0||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var o,a=i-r;if(this===t&&r<e&&e<i)for(o=a-1;o>=0;--o)t[o+e]=this[o+r];else if(a<1e3||!B.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+e]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+a),e);return a},B.prototype.fill=function(t,e,r,i){if(typeof t=="string"){if(typeof e=="string"?(i=e,e=0,r=this.length):typeof r=="string"&&(i=r,r=this.length),t.length===1){var o=t.charCodeAt(0);o<256&&(t=o)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!B.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof t=="number"&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var a;if(e>>>=0,r=r===void 0?this.length:r>>>0,t||(t=0),typeof t=="number")for(a=e;a<r;++a)this[a]=t;else{var p=Pe(t)?t:At(new B(t,i).toString()),c=p.length;for(a=0;a<r-e;++a)this[a+e]=p[a%c]}return this};var fi=/[^+\/0-9A-Za-z-_]/g;function di(t){return t<16?"0"+t.toString(16):t.toString(16)}function At(t,e){var r;e=e||1/0;for(var i=t.length,o=null,a=[],p=0;p<i;++p){if((r=t.charCodeAt(p))>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(p+1===i){(e-=3)>-1&&a.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&a.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&a.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;a.push(r)}else if(r<2048){if((e-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function Vr(t){return function(e){var r,i,o,a,p,c;Gt||Fr();var M=e.length;if(M%4>0)throw new Error("Invalid string. Length must be a multiple of 4");p=e[M-2]==="="?2:e[M-1]==="="?1:0,c=new Kn(3*M/4-p),o=p>0?M-4:M;var x=0;for(r=0,i=0;r<o;r+=4,i+=3)a=xe[e.charCodeAt(r)]<<18|xe[e.charCodeAt(r+1)]<<12|xe[e.charCodeAt(r+2)]<<6|xe[e.charCodeAt(r+3)],c[x++]=a>>16&255,c[x++]=a>>8&255,c[x++]=255&a;return p===2?(a=xe[e.charCodeAt(r)]<<2|xe[e.charCodeAt(r+1)]>>4,c[x++]=255&a):p===1&&(a=xe[e.charCodeAt(r)]<<10|xe[e.charCodeAt(r+1)]<<4|xe[e.charCodeAt(r+2)]>>2,c[x++]=a>>8&255,c[x++]=255&a),c}(function(e){if((e=function(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}(e).replace(fi,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(t))}function It(t,e,r,i){for(var o=0;o<i&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function Qr(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}var Kr={exports:{}};function Xr(t,e){for(var r=0,i=t.length-1;i>=0;i--){var o=t[i];o==="."?t.splice(i,1):o===".."?(t.splice(i,1),r++):r&&(t.splice(i,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}var hi=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Kt=function(t){return hi.exec(t).slice(1)};function Tt(){for(var t="",e=!1,r=arguments.length-1;r>=-1&&!e;r--){var i=r>=0?arguments[r]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");i&&(t=i+"/"+t,e=i.charAt(0)==="/")}return(e?"/":"")+(t=Xr(er(t.split("/"),function(o){return!!o}),!e).join("/"))||"."}function Xt(t){var e=Zt(t),r=_i(t,-1)==="/";return(t=Xr(er(t.split("/"),function(i){return!!i}),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t}function Zt(t){return t.charAt(0)==="/"}function Zr(){return Xt(er(Array.prototype.slice.call(arguments,0),function(t,e){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function en(t,e){function r(x){for(var A=0;A<x.length&&x[A]==="";A++);for(var D=x.length-1;D>=0&&x[D]==="";D--);return A>D?[]:x.slice(A,D-A+1)}t=Tt(t).substr(1),e=Tt(e).substr(1);for(var i=r(t.split("/")),o=r(e.split("/")),a=Math.min(i.length,o.length),p=a,c=0;c<a;c++)if(i[c]!==o[c]){p=c;break}var M=[];for(c=p;c<i.length;c++)M.push("..");return(M=M.concat(o.slice(p))).join("/")}function tn(t){var e=Kt(t),r=e[0],i=e[1];return r||i?(i&&(i=i.substr(0,i.length-1)),r+i):"."}function rn(t,e){var r=Kt(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r}function nn(t){return Kt(t)[3]}var gi={extname:nn,basename:rn,dirname:tn,sep:"/",delimiter:":",relative:en,join:Zr,isAbsolute:Zt,normalize:Xt,resolve:Tt};function er(t,e){if(t.filter)return t.filter(e);for(var r=[],i=0;i<t.length;i++)e(t[i],i,t)&&r.push(t[i]);return r}var _i="ab".substr(-1)==="b"?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)},tr=Wt(Object.freeze({__proto__:null,resolve:Tt,normalize:Xt,isAbsolute:Zt,join:Zr,relative:en,sep:"/",delimiter:":",dirname:tn,basename:rn,extname:nn,default:gi})),on=Wt(Object.freeze({__proto__:null,default:{}})),mi=Wt(Object.freeze({__proto__:null,default:{}}));(function(t,e){var r=void 0,i=function(o){return r||(r=new Promise(function(a,p){var c,M=(c=o!==void 0?o:{}).onAbort;c.onAbort=function(n){p(new Error(n)),M&&M(n)},c.postRun=c.postRun||[],c.postRun.push(function(){a(c)}),t=void 0,c||(c=c!==void 0?c:{}),c.onRuntimeInitialized=function(){function n(I,z){this.Qa=I,this.db=z,this.Pa=1,this.wb=[]}function s(I,z){if(this.db=z,z=rt(I)+1,this.hb=$t(z),this.hb===null)throw Error("Unable to allocate memory for the SQL string");We(I,he,this.hb,z),this.sb=this.hb,this.eb=this.Mb=null}function l(I,{filename:z=!1}={}){z===!1?(this.filename="dbfile_"+(4294967295*Math.random()>>>0),this.Xc=!0,I!=null&&u.zb("/",this.filename,I,!0,!0)):this.filename=I,this.handleError(w(this.filename,h)),this.db=J(h,"i32"),ro(this.db),this.nb={},this.Xa={}}var h=Ye(4),y=c.cwrap,w=y("sqlite3_open","number",["string","number"]),T=y("sqlite3_close_v2","number",["number"]),q=y("sqlite3_exec","number",["number","string","number","number","number"]),V=y("sqlite3_changes","number",["number"]),W=y("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Z=y("sqlite3_sql","string",["number"]),ue=y("sqlite3_normalized_sql","string",["number"]),ge=y("sqlite3_prepare_v2","number",["number","number","number","number","number"]),me=y("sqlite3_bind_text","number",["number","number","number","number","number"]),_e=y("sqlite3_bind_blob","number",["number","number","number","number","number"]),ve=y("sqlite3_bind_double","number",["number","number","number"]),Se=y("sqlite3_bind_int","number",["number","number","number"]),Ce=y("sqlite3_bind_parameter_index","number",["number","string"]),mr=y("sqlite3_step","number",["number"]),ke=y("sqlite3_errmsg","string",["number"]),Bi=y("sqlite3_column_count","number",["number"]),Pi=y("sqlite3_data_count","number",["number"]),Di=y("sqlite3_column_double","number",["number","number"]),$i=y("sqlite3_column_text","string",["number","number"]),Li=y("sqlite3_column_blob","number",["number","number"]),Ui=y("sqlite3_column_bytes","number",["number","number"]),qi=y("sqlite3_column_type","number",["number","number"]),ji=y("sqlite3_column_name","string",["number","number"]),Ji=y("sqlite3_reset","number",["number"]),zi=y("sqlite3_clear_bindings","number",["number"]),Wi=y("sqlite3_finalize","number",["number"]),Hi=y("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),Gi=y("sqlite3_value_type","number",["number"]),Yi=y("sqlite3_value_bytes","number",["number"]),Vi=y("sqlite3_value_text","string",["number"]),Qi=y("sqlite3_value_blob","number",["number"]),Ki=y("sqlite3_value_double","number",["number"]),Xi=y("sqlite3_result_double","",["number","number"]),Bn=y("sqlite3_result_null","",["number"]),Zi=y("sqlite3_result_text","",["number","string","number","number"]),eo=y("sqlite3_result_blob","",["number","number","number","number"]),to=y("sqlite3_result_int","",["number","number"]),Pn=y("sqlite3_result_error","",["number","string","number"]),ro=y("RegisterExtensionFunctions","number",["number"]);n.prototype.bind=function(I){if(!this.Qa)throw"Statement closed";return this.reset(),Array.isArray(I)?this.vc(I):I==null||typeof I!="object"||this.wc(I)},n.prototype.step=function(){if(!this.Qa)throw"Statement closed";this.Pa=1;var I=mr(this.Qa);switch(I){case 100:return!0;case 101:return!1;default:throw this.db.handleError(I)}},n.prototype.Pc=function(I){return I==null&&(I=this.Pa,this.Pa+=1),Di(this.Qa,I)},n.prototype.Qc=function(I){return I==null&&(I=this.Pa,this.Pa+=1),$i(this.Qa,I)},n.prototype.getBlob=function(I){I==null&&(I=this.Pa,this.Pa+=1);var z=Ui(this.Qa,I);I=Li(this.Qa,I);for(var ee=new Uint8Array(z),ae=0;ae<z;ae+=1)ee[ae]=de[I+ae];return ee},n.prototype.get=function(I){I!=null&&this.bind(I)&&this.step(),I=[];for(var z=Pi(this.Qa),ee=0;ee<z;ee+=1)switch(qi(this.Qa,ee)){case 1:case 2:I.push(this.Pc(ee));break;case 3:I.push(this.Qc(ee));break;case 4:I.push(this.getBlob(ee));break;default:I.push(null)}return I},n.prototype.getColumnNames=function(){for(var I=[],z=Bi(this.Qa),ee=0;ee<z;ee+=1)I.push(ji(this.Qa,ee));return I},n.prototype.getAsObject=function(I){I=this.get(I);for(var z=this.getColumnNames(),ee={},ae=0;ae<z.length;ae+=1)ee[z[ae]]=I[ae];return ee},n.prototype.getSQL=function(){return Z(this.Qa)},n.prototype.getNormalizedSQL=function(){return ue(this.Qa)},n.prototype.run=function(I){return I!=null&&this.bind(I),this.step(),this.reset()},n.prototype.zc=function(I,z){z==null&&(z=this.Pa,this.Pa+=1);var ee=ie(I=Dt(I));this.wb.push(ee),this.db.handleError(me(this.Qa,z,ee,I.length-1,0))},n.prototype.uc=function(I,z){z==null&&(z=this.Pa,this.Pa+=1);var ee=ie(I);this.wb.push(ee),this.db.handleError(_e(this.Qa,z,ee,I.length,0))},n.prototype.yc=function(I,z){z==null&&(z=this.Pa,this.Pa+=1),this.db.handleError((I===(0|I)?Se:ve)(this.Qa,z,I))},n.prototype.xc=function(I){I==null&&(I=this.Pa,this.Pa+=1),_e(this.Qa,I,0,0,0)},n.prototype.Tb=function(I,z){switch(z==null&&(z=this.Pa,this.Pa+=1),typeof I){case"string":return void this.zc(I,z);case"number":case"boolean":return void this.yc(I+0,z);case"object":if(I===null)return void this.xc(z);if(I.length!=null)return void this.uc(I,z)}throw"Wrong API use : tried to bind a value of an unknown type ("+I+")."},n.prototype.wc=function(I){var z=this;return Object.keys(I).forEach(function(ee){var ae=Ce(z.Qa,ee);ae!==0&&z.Tb(I[ee],ae)}),!0},n.prototype.vc=function(I){for(var z=0;z<I.length;z+=1)this.Tb(I[z],z+1);return!0},n.prototype.reset=function(){return zi(this.Qa)===0&&Ji(this.Qa)===0},n.prototype.freemem=function(){for(var I;(I=this.wb.pop())!==void 0;)yt(I)},n.prototype.free=function(){var I=Wi(this.Qa)===0;return delete this.db.nb[this.Qa],this.Qa=0,I},s.prototype.next=function(){if(this.hb===null)return{done:!0};if(this.eb!==null&&(this.eb.free(),this.eb=null),!this.db.db)throw this.Bb(),Error("Database closed");var I=bt(),z=Ye(4);C(h),C(z);try{this.db.handleError(ge(this.db.db,this.sb,-1,h,z)),this.sb=J(z,"i32");var ee=J(h,"i32");return ee===0?(this.Bb(),{done:!0}):(this.eb=new n(ee,this.db),this.db.nb[ee]=this.eb,{value:this.eb,done:!1})}catch(ae){throw this.Mb=we(this.sb),this.Bb(),ae}finally{wt(I)}},s.prototype.Bb=function(){yt(this.hb),this.hb=null},s.prototype.getRemainingSQL=function(){return this.Mb!==null?this.Mb:we(this.sb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(s.prototype[Symbol.iterator]=function(){return this}),l.prototype.run=function(I,z){if(!this.db)throw"Database closed";if(z){I=this.prepare(I,z);try{I.step()}finally{I.free()}}else this.handleError(q(this.db,I,0,0,h));return this},l.prototype.exec=function(I,z){if(!this.db)throw"Database closed";var ee=bt(),ae=null;try{var ye=rt(I)+1,$e=Ye(ye);We(I,de,$e,ye);var Ne=$e,ht=Ye(4);for(I=[];J(Ne,"i8")!==0;){C(h),C(ht),this.handleError(ge(this.db,Ne,-1,h,ht));var gt=J(h,"i32");if(Ne=J(ht,"i32"),gt!==0){for(ye=null,ae=new n(gt,this),z!=null&&ae.bind(z);ae.step();)ye===null&&(ye={columns:ae.getColumnNames(),values:[]},I.push(ye)),ye.values.push(ae.get());ae.free()}}return I}catch(Me){throw ae&&ae.free(),Me}finally{wt(ee)}},l.prototype.each=function(I,z,ee,ae){typeof z=="function"&&(ae=ee,ee=z,z=void 0),I=this.prepare(I,z);try{for(;I.step();)ee(I.getAsObject())}finally{I.free()}if(typeof ae=="function")return ae()},l.prototype.prepare=function(I,z){if(C(h),this.handleError(W(this.db,I,-1,h,0)),(I=J(h,"i32"))===0)throw"Nothing to prepare";var ee=new n(I,this);return z!=null&&ee.bind(z),this.nb[I]=ee},l.prototype.iterateStatements=function(I){return new s(I,this)},l.prototype.export=function(){Object.values(this.nb).forEach(function(z){z.free()}),Object.values(this.Xa).forEach(F),this.Xa={},this.handleError(T(this.db));var I=u.readFile(this.filename,{encoding:"binary"});return this.handleError(w(this.filename,h)),this.db=J(h,"i32"),I},l.prototype.close=function(){this.db!==null&&(Object.values(this.nb).forEach(function(I){I.free()}),Object.values(this.Xa).forEach(F),this.Xa={},this.handleError(T(this.db)),this.Xc&&u.unlink("/"+this.filename),this.db=null)},l.prototype.handleError=function(I){if(I===0)return null;throw I=ke(this.db),Error(I)},l.prototype.getRowsModified=function(){return V(this.db)},l.prototype.create_function=function(I,z){Object.prototype.hasOwnProperty.call(this.Xa,I)&&(F(this.Xa[I]),delete this.Xa[I]);var ee=$(function(ae,ye,$e){for(var Ne,ht=[],gt=0;gt<ye;gt+=1){var Me=J($e+4*gt,"i32"),Ve=Gi(Me);if(Ve===1||Ve===2)Me=Ki(Me);else if(Ve===3)Me=Vi(Me);else if(Ve===4){Me=Yi(Ve=Me),Ve=Qi(Ve);for(var Dn=new Uint8Array(Me),Ut=0;Ut<Me;Ut+=1)Dn[Ut]=de[Ve+Ut];Me=Dn}else Me=null;ht.push(Me)}try{Ne=z.apply(null,ht)}catch(no){return void Pn(ae,no,-1)}switch(typeof Ne){case"boolean":to(ae,Ne?1:0);break;case"number":Xi(ae,Ne);break;case"string":Zi(ae,Ne,-1,-1);break;case"object":Ne===null?Bn(ae):Ne.length!=null?(ye=ie(Ne),eo(ae,ye,Ne.length,-1),yt(ye)):Pn(ae,"Wrong API use : tried to return a value of an unknown type ("+Ne+").",-1);break;default:Bn(ae)}},"viii");return this.Xa[I]=ee,this.handleError(Hi(this.db,I,z.length,1,0,ee,0,0,0)),this},c.Database=l;var Et=new Map;c.register_for_idb=I=>{let z=$(function(ye,$e){return ye=Et.get(ye),I.lock(ye,$e)?0:5},"iii"),ee=$(function(ye,$e){return ye=Et.get(ye),I.unlock(ye,$e),0},"iii"),ae=$(function(ye,$e){ye=we(ye),Et.set($e,ye)},"vii");c._register_for_idb(z,ee,ae)},c.cleanup_file=I=>{let z=[...Et.entries()].find(ee=>ee[1]===I);Et.delete(z[0])},c.reset_filesystem=()=>{u.root=null,u.lc()}};var x,A={};for(x in c)c.hasOwnProperty(x)&&(A[x]=c[x]);var D,L,G,X,te,U="./this.program",m=typeof window=="object",P=typeof importScripts=="function",O=typeof Fe=="object"&&typeof Fe.versions=="object"&&typeof Fe.versions.node=="string",v="";O?(v=P?tr.dirname(v)+"/":"/home/runner/work/open-im-sdk-web-wasm/open-im-sdk-web-wasm/node_modules/@jlongster/sql.js/dist/",D=function(n,s){return X||(X=on),te||(te=tr),n=te.normalize(n),X.readFileSync(n,s?null:"utf8")},G=function(n){return(n=D(n,!0)).buffer||(n=new Uint8Array(n)),K(n.buffer),n},L=function(n,s,l){X||(X=on),te||(te=tr),n=te.normalize(n),X.readFile(n,function(h,y){h?l(h):s(y.buffer)})},1<Fe.argv.length&&(U=Fe.argv[1].replace(/\\/g,"/")),Fe.argv.slice(2),t.exports=c,c.inspect=function(){return"[Emscripten Module object]"}):(m||P)&&(P?v=self.location.href:typeof document!="undefined"&&document.currentScript&&(v=document.currentScript.src),v=v.indexOf("blob:")!==0?v.substr(0,v.lastIndexOf("/")+1):"",D=function(n){var s=new XMLHttpRequest;return s.open("GET",n,!1),s.send(null),s.responseText},P&&(G=function(n){var s=new XMLHttpRequest;return s.open("GET",n,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),L=function(n,s,l){var h=new XMLHttpRequest;h.open("GET",n,!0),h.responseType="arraybuffer",h.onload=function(){h.status==200||h.status==0&&h.response?s(h.response):l()},h.onerror=l,h.send(null)});var d=c.print||console.log.bind(console),f=c.printErr||console.warn.bind(console);for(x in A)A.hasOwnProperty(x)&&(c[x]=A[x]);A=null,c.thisProgram&&(U=c.thisProgram);var g,b,E=[];function F(n){g.delete(De.get(n)),E.push(n)}function $(n,s){if(!g){g=new WeakMap;for(var l=0;l<De.length;l++){var h=De.get(l);h&&g.set(h,l)}}if(g.has(n))n=g.get(n);else{if(E.length)l=E.pop();else{try{De.grow(1)}catch(q){throw q instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":q}l=De.length-1}try{De.set(l,n)}catch(q){if(!(q instanceof TypeError))throw q;if(typeof WebAssembly.Function=="function"){var y={i:"i32",j:"i64",f:"f32",d:"f64"},w={parameters:[],results:s[0]=="v"?[]:[y[s[0]]]};for(h=1;h<s.length;++h)w.parameters.push(y[s[h]]);s=new WebAssembly.Function(w,n)}else{y=[1,0,1,96],w=s.slice(0,1),s=s.slice(1);var T={i:127,j:126,f:125,d:124};for(y.push(s.length),h=0;h<s.length;++h)y.push(T[s[h]]);w=="v"?y.push(0):y=y.concat([1,T[w]]),y[1]=y.length-2,s=new Uint8Array([0,97,115,109,1,0,0,0].concat(y,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),s=new WebAssembly.Module(s),s=new WebAssembly.Instance(s,{e:{f:n}}).exports.f}De.set(l,s)}g.set(n,l),n=l}return n}function C(n){var s="i32";switch(s.charAt(s.length-1)==="*"&&(s="i32"),s){case"i1":case"i8":de[n>>0]=0;break;case"i16":Oe[n>>1]=0;break;case"i32":H[n>>2]=0;break;case"i64":Ie=[0,(pe=0,1<=+Math.abs(pe)?0<pe?(0|Math.min(+Math.floor(pe/4294967296),4294967295))>>>0:~~+Math.ceil((pe-+(~~pe>>>0))/4294967296)>>>0:0)],H[n>>2]=Ie[0],H[n+4>>2]=Ie[1];break;case"float":nr[n>>2]=0;break;case"double":ir[n>>3]=0;break;default:ce("invalid type for setValue: "+s)}}function J(n,s){switch((s=s||"i8").charAt(s.length-1)==="*"&&(s="i32"),s){case"i1":case"i8":return de[n>>0];case"i16":return Oe[n>>1];case"i32":case"i64":return H[n>>2];case"float":return nr[n>>2];case"double":return ir[n>>3];default:ce("invalid type for getValue: "+s)}return null}c.wasmBinary&&(b=c.wasmBinary),c.noExitRuntime,typeof WebAssembly!="object"&&ce("no native wasm support detected");var Y,Q=!1;function K(n,s){n||ce("Assertion failed: "+s)}function ne(n){var s=c["_"+n];return K(s,"Cannot call unknown function "+n+", make sure it is exported"),s}function ie(n){var s=$t(n.length);return n.subarray||n.slice?he.set(n,s):he.set(new Uint8Array(n),s),s}var fe,de,he,Oe,H,nr,ir,mn=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function ct(n,s,l){var h=s+l;for(l=s;n[l]&&!(l>=h);)++l;if(16<l-s&&n.subarray&&mn)return mn.decode(n.subarray(s,l));for(h="";s<l;){var y=n[s++];if(128&y){var w=63&n[s++];if((224&y)==192)h+=String.fromCharCode((31&y)<<6|w);else{var T=63&n[s++];65536>(y=(240&y)==224?(15&y)<<12|w<<6|T:(7&y)<<18|w<<12|T<<6|63&n[s++])?h+=String.fromCharCode(y):(y-=65536,h+=String.fromCharCode(55296|y>>10,56320|1023&y))}}else h+=String.fromCharCode(y)}return h}function we(n,s){return n?ct(he,n,s):""}function We(n,s,l,h){if(!(0<h))return 0;var y=l;h=l+h-1;for(var w=0;w<n.length;++w){var T=n.charCodeAt(w);if(55296<=T&&57343>=T&&(T=65536+((1023&T)<<10)|1023&n.charCodeAt(++w)),127>=T){if(l>=h)break;s[l++]=T}else{if(2047>=T){if(l+1>=h)break;s[l++]=192|T>>6}else{if(65535>=T){if(l+2>=h)break;s[l++]=224|T>>12}else{if(l+3>=h)break;s[l++]=240|T>>18,s[l++]=128|T>>12&63}s[l++]=128|T>>6&63}s[l++]=128|63&T}}return s[l]=0,l-y}function rt(n){for(var s=0,l=0;l<n.length;++l){var h=n.charCodeAt(l);55296<=h&&57343>=h&&(h=65536+((1023&h)<<10)|1023&n.charCodeAt(++l)),127>=h?++s:s=2047>=h?s+2:65535>=h?s+3:s+4}return s}function pn(n){var s=rt(n)+1,l=$t(s);return l&&We(n,de,l,s),l}function vn(){var n=Y.buffer;fe=n,c.HEAP8=de=new Int8Array(n),c.HEAP16=Oe=new Int16Array(n),c.HEAP32=H=new Int32Array(n),c.HEAPU8=he=new Uint8Array(n),c.HEAPU16=new Uint16Array(n),c.HEAPU32=new Uint32Array(n),c.HEAPF32=nr=new Float32Array(n),c.HEAPF64=ir=new Float64Array(n)}var De,yn=[],bn=[],wn=[];function Ai(){var n=c.preRun.shift();yn.unshift(n)}var Ae,pe,Ie,En,nt=0,vt=null;function or(){nt++,c.monitorRunDependencies&&c.monitorRunDependencies(nt)}function Ft(){if(nt--,c.monitorRunDependencies&&c.monitorRunDependencies(nt),nt==0&&vt){var n=vt;vt=null,n()}}function ce(n){throw c.onAbort&&c.onAbort(n),f(n),Q=!0,new WebAssembly.RuntimeError("abort("+n+"). Build with -s ASSERTIONS=1 for more info.")}function On(){return Ae.startsWith("data:application/octet-stream;base64,")}if(c.preloadedImages={},c.preloadedAudios={},Ae="sql-wasm.wasm",!On()){var Sn=Ae;Ae=c.locateFile?c.locateFile(Sn,v):v+Sn}function kn(){var n=Ae;try{if(n==Ae&&b)return new Uint8Array(b);if(G)return G(n);throw"both async and sync fetching of the wasm failed"}catch(s){ce(s)}}function sr(n){for(;0<n.length;){var s=n.shift();if(typeof s=="function")s(c);else{var l=s.pd;typeof l=="number"?s.yb===void 0?De.get(l)():De.get(l)(s.yb):l(s.yb===void 0?null:s.yb)}}}function ar(n,s){for(var l=0,h=n.length-1;0<=h;h--){var y=n[h];y==="."?n.splice(h,1):y===".."?(n.splice(h,1),l++):l&&(n.splice(h,1),l--)}if(s)for(;l;l--)n.unshift("..");return n}function lt(n){var s=n.charAt(0)==="/",l=n.substr(-1)==="/";return(n=ar(n.split("/").filter(function(h){return!!h}),!s).join("/"))||s||(n="."),n&&l&&(n+="/"),(s?"/":"")+n}function Bt(n){var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(n).slice(1);return n=s[0],s=s[1],n||s?(s&&(s=s.substr(0,s.length-1)),n+s):"."}function He(n){if(n==="/")return"/";var s=(n=(n=lt(n)).replace(/\/$/,"")).lastIndexOf("/");return s===-1?n:n.substr(s+1)}function ft(n,s){return lt(n+"/"+s)}function it(){for(var n="",s=!1,l=arguments.length-1;-1<=l&&!s;l--){if(typeof(s=0<=l?arguments[l]:u.cwd())!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!s)return"";n=s+"/"+n,s=s.charAt(0)==="/"}return(s?"/":"")+(n=ar(n.split("/").filter(function(h){return!!h}),!s).join("/"))||"."}function Rn(n,s){function l(T){for(var q=0;q<T.length&&T[q]==="";q++);for(var V=T.length-1;0<=V&&T[V]==="";V--);return q>V?[]:T.slice(q,V-q+1)}n=it(n).substr(1),s=it(s).substr(1),n=l(n.split("/")),s=l(s.split("/"));for(var h=Math.min(n.length,s.length),y=h,w=0;w<h;w++)if(n[w]!==s[w]){y=w;break}for(h=[],w=y;w<n.length;w++)h.push("..");return(h=h.concat(s.slice(y))).join("/")}var Nn=[];function Mn(n,s){Nn[n]={input:[],output:[],gb:s},u.Qb(n,Ii)}var Ii={open:function(n){var s=Nn[n.node.rdev];if(!s)throw new u.ErrnoError(43);n.tty=s,n.seekable=!1},close:function(n){n.tty.gb.flush(n.tty)},flush:function(n){n.tty.gb.flush(n.tty)},read:function(n,s,l,h){if(!n.tty||!n.tty.gb.cc)throw new u.ErrnoError(60);for(var y=0,w=0;w<h;w++){try{var T=n.tty.gb.cc(n.tty)}catch(q){throw new u.ErrnoError(29)}if(T===void 0&&y===0)throw new u.ErrnoError(6);if(T==null)break;y++,s[l+w]=T}return y&&(n.node.timestamp=Date.now()),y},write:function(n,s,l,h){if(!n.tty||!n.tty.gb.Nb)throw new u.ErrnoError(60);try{for(var y=0;y<h;y++)n.tty.gb.Nb(n.tty,s[l+y])}catch(w){throw new u.ErrnoError(29)}return h&&(n.node.timestamp=Date.now()),y}},Ti={cc:function(n){if(!n.input.length){var s=null;if(O){var l=B.alloc(256),h=0;try{h=X.readSync(Fe.stdin.fd,l,0,256,null)}catch(y){if(!y.toString().includes("EOF"))throw y;h=0}s=0<h?l.slice(0,h).toString("utf-8"):null}else typeof window!="undefined"&&typeof window.prompt=="function"?(s=window.prompt("Input: "))!==null&&(s+=`
`):typeof readline=="function"&&(s=readline())!==null&&(s+=`
`);if(!s)return null;n.input=Dt(s,!0)}return n.input.shift()},Nb:function(n,s){s===null||s===10?(d(ct(n.output,0)),n.output=[]):s!=0&&n.output.push(s)},flush:function(n){n.output&&0<n.output.length&&(d(ct(n.output,0)),n.output=[])}},Ci={Nb:function(n,s){s===null||s===10?(f(ct(n.output,0)),n.output=[]):s!=0&&n.output.push(s)},flush:function(n){n.output&&0<n.output.length&&(f(ct(n.output,0)),n.output=[])}};function xn(n){n=65536*Math.ceil(n/65536);var s=Fn(65536,n);return s?(he.fill(0,s,s+n),s):0}var oe={Va:null,mount:function(){return oe.createNode(null,"/",16895,0)},createNode:function(n,s,l,h){if(u.Rc(l)||u.isFIFO(l))throw new u.ErrnoError(63);return oe.Va||(oe.Va={dir:{node:{getattr:oe.node_ops.getattr,setattr:oe.node_ops.setattr,lookup:oe.node_ops.lookup,mknod:oe.node_ops.mknod,rename:oe.node_ops.rename,unlink:oe.node_ops.unlink,rmdir:oe.node_ops.rmdir,readdir:oe.node_ops.readdir,symlink:oe.node_ops.symlink},stream:{llseek:oe.stream_ops.llseek}},file:{node:{getattr:oe.node_ops.getattr,setattr:oe.node_ops.setattr},stream:{llseek:oe.stream_ops.llseek,read:oe.stream_ops.read,write:oe.stream_ops.write,allocate:oe.stream_ops.allocate,mmap:oe.stream_ops.mmap,msync:oe.stream_ops.msync}},link:{node:{getattr:oe.node_ops.getattr,setattr:oe.node_ops.setattr,readlink:oe.node_ops.readlink},stream:{}},Vb:{node:{getattr:oe.node_ops.getattr,setattr:oe.node_ops.setattr},stream:u.Cc}}),l=u.createNode(n,s,l,h),u.isDir(l.mode)?(l.node_ops=oe.Va.dir.node,l.stream_ops=oe.Va.dir.stream,l.Na={}):u.isFile(l.mode)?(l.node_ops=oe.Va.file.node,l.stream_ops=oe.Va.file.stream,l.Ra=0,l.Na=null):u.fb(l.mode)?(l.node_ops=oe.Va.link.node,l.stream_ops=oe.Va.link.stream):u.pb(l.mode)&&(l.node_ops=oe.Va.Vb.node,l.stream_ops=oe.Va.Vb.stream),l.timestamp=Date.now(),n&&(n.Na[s]=l,n.timestamp=l.timestamp),l},qd:function(n){return n.Na?n.Na.subarray?n.Na.subarray(0,n.Ra):new Uint8Array(n.Na):new Uint8Array(0)},Zb:function(n,s){var l=n.Na?n.Na.length:0;l>=s||(s=Math.max(s,l*(1048576>l?2:1.125)>>>0),l!=0&&(s=Math.max(s,256)),l=n.Na,n.Na=new Uint8Array(s),0<n.Ra&&n.Na.set(l.subarray(0,n.Ra),0))},gd:function(n,s){if(n.Ra!=s)if(s==0)n.Na=null,n.Ra=0;else{var l=n.Na;n.Na=new Uint8Array(s),l&&n.Na.set(l.subarray(0,Math.min(s,n.Ra))),n.Ra=s}},node_ops:{getattr:function(n){var s={};return s.dev=u.pb(n.mode)?n.id:1,s.ino=n.id,s.mode=n.mode,s.nlink=1,s.uid=0,s.gid=0,s.rdev=n.rdev,u.isDir(n.mode)?s.size=4096:u.isFile(n.mode)?s.size=n.Ra:u.fb(n.mode)?s.size=n.link.length:s.size=0,s.atime=new Date(n.timestamp),s.mtime=new Date(n.timestamp),s.ctime=new Date(n.timestamp),s.Ac=4096,s.blocks=Math.ceil(s.size/s.Ac),s},setattr:function(n,s){s.mode!==void 0&&(n.mode=s.mode),s.timestamp!==void 0&&(n.timestamp=s.timestamp),s.size!==void 0&&oe.gd(n,s.size)},lookup:function(){throw u.Db[44]},mknod:function(n,s,l,h){return oe.createNode(n,s,l,h)},rename:function(n,s,l){if(u.isDir(n.mode)){try{var h=u.lookupNode(s,l)}catch(w){}if(h)for(var y in h.Na)throw new u.ErrnoError(55)}delete n.parent.Na[n.name],n.parent.timestamp=Date.now(),n.name=l,s.Na[l]=n,s.timestamp=n.parent.timestamp,n.parent=s},unlink:function(n,s){delete n.Na[s],n.timestamp=Date.now()},rmdir:function(n,s){var l,h=u.lookupNode(n,s);for(l in h.Na)throw new u.ErrnoError(55);delete n.Na[s],n.timestamp=Date.now()},readdir:function(n){var s,l=[".",".."];for(s in n.Na)n.Na.hasOwnProperty(s)&&l.push(s);return l},symlink:function(n,s,l){return(n=oe.createNode(n,s,41471,0)).link=l,n},readlink:function(n){if(!u.fb(n.mode))throw new u.ErrnoError(28);return n.link}},stream_ops:{read:function(n,s,l,h,y){var w=n.node.Na;if(y>=n.node.Ra)return 0;if(8<(n=Math.min(n.node.Ra-y,h))&&w.subarray)s.set(w.subarray(y,y+n),l);else for(h=0;h<n;h++)s[l+h]=w[y+h];return n},write:function(n,s,l,h,y,w){if(s.buffer===de.buffer&&(w=!1),!h)return 0;if((n=n.node).timestamp=Date.now(),s.subarray&&(!n.Na||n.Na.subarray)){if(w)return n.Na=s.subarray(l,l+h),n.Ra=h;if(n.Ra===0&&y===0)return n.Na=s.slice(l,l+h),n.Ra=h;if(y+h<=n.Ra)return n.Na.set(s.subarray(l,l+h),y),h}if(oe.Zb(n,y+h),n.Na.subarray&&s.subarray)n.Na.set(s.subarray(l,l+h),y);else for(w=0;w<h;w++)n.Na[y+w]=s[l+w];return n.Ra=Math.max(n.Ra,y+h),h},llseek:function(n,s,l){if(l===1?s+=n.position:l===2&&u.isFile(n.node.mode)&&(s+=n.node.Ra),0>s)throw new u.ErrnoError(28);return s},allocate:function(n,s,l){oe.Zb(n.node,s+l),n.node.Ra=Math.max(n.node.Ra,s+l)},mmap:function(n,s,l,h,y,w){if(s!==0)throw new u.ErrnoError(28);if(!u.isFile(n.node.mode))throw new u.ErrnoError(43);if(n=n.node.Na,2&w||n.buffer!==fe){if((0<h||h+l<n.length)&&(n=n.subarray?n.subarray(h,h+l):Array.prototype.slice.call(n,h,h+l)),h=!0,!(l=xn(l)))throw new u.ErrnoError(48);de.set(n,l)}else h=!1,l=n.byteOffset;return{ed:l,vb:h}},msync:function(n,s,l,h,y){if(!u.isFile(n.node.mode))throw new u.ErrnoError(43);return 2&y||oe.stream_ops.write(n,s,0,h,l,!1),0}}},u={root:null,mb:[],Xb:{},streams:[],Zc:1,Ua:null,Wb:"/",Hb:!1,hc:!0,Sa:{},nc:{kc:{qc:1,rc:2}},ErrnoError:null,Db:{},Lc:null,tb:0,lookupPath:function(n,s){if(s=s||{},!(n=it(u.cwd(),n)))return{path:"",node:null};var l,h={Cb:!0,Pb:0};for(l in h)s[l]===void 0&&(s[l]=h[l]);if(8<s.Pb)throw new u.ErrnoError(32);n=ar(n.split("/").filter(function(T){return!!T}),!1);var y=u.root;for(h="/",l=0;l<n.length;l++){var w=l===n.length-1;if(w&&s.parent)break;if(y=u.lookupNode(y,n[l]),h=ft(h,n[l]),u.ab(y)&&(!w||w&&s.Cb)&&(y=y.lb.root),!w||s.Ta){for(w=0;u.fb(y.mode);)if(y=u.readlink(h),h=it(Bt(h),y),y=u.lookupPath(h,{Pb:s.Pb}).node,40<w++)throw new u.ErrnoError(32)}}return{path:h,node:y}},Ya:function(n){for(var s;;){if(u.isRoot(n))return n=n.mount.jc,s?n[n.length-1]!=="/"?n+"/"+s:n+s:n;s=s?n.name+"/"+s:n.name,n=n.parent}},Gb:function(n,s){for(var l=0,h=0;h<s.length;h++)l=(l<<5)-l+s.charCodeAt(h)|0;return(n+l>>>0)%u.Ua.length},ec:function(n){var s=u.Gb(n.parent.id,n.name);n.cb=u.Ua[s],u.Ua[s]=n},fc:function(n){var s=u.Gb(n.parent.id,n.name);if(u.Ua[s]===n)u.Ua[s]=n.cb;else for(s=u.Ua[s];s;){if(s.cb===n){s.cb=n.cb;break}s=s.cb}},lookupNode:function(n,s){var l=u.Vc(n);if(l)throw new u.ErrnoError(l,n);for(l=u.Ua[u.Gb(n.id,s)];l;l=l.cb){var h=l.name;if(l.parent.id===n.id&&h===s)return l}return u.lookup(n,s)},createNode:function(n,s,l,h){return n=new u.FSNode(n,s,l,h),u.ec(n),n},Ab:function(n){u.fc(n)},isRoot:function(n){return n===n.parent},ab:function(n){return!!n.lb},isFile:function(n){return(61440&n)==32768},isDir:function(n){return(61440&n)==16384},fb:function(n){return(61440&n)==40960},pb:function(n){return(61440&n)==8192},Rc:function(n){return(61440&n)==24576},isFIFO:function(n){return(61440&n)==4096},isSocket:function(n){return(49152&n)==49152},Mc:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},Yc:function(n){var s=u.Mc[n];if(s===void 0)throw Error("Unknown file open mode: "+n);return s},$b:function(n){var s=["r","w","rw"][3&n];return 512&n&&(s+="w"),s},Za:function(n,s){return u.hc?0:!s.includes("r")||292&n.mode?s.includes("w")&&!(146&n.mode)||s.includes("x")&&!(73&n.mode)?2:0:2},Vc:function(n){var s=u.Za(n,"x");return s||(n.node_ops.lookup?0:2)},Lb:function(n,s){try{return u.lookupNode(n,s),20}catch(l){}return u.Za(n,"wx")},qb:function(n,s,l){try{var h=u.lookupNode(n,s)}catch(y){return y.Oa}if(n=u.Za(n,"wx"))return n;if(l){if(!u.isDir(h.mode))return 54;if(u.isRoot(h)||u.Ya(h)===u.cwd())return 10}else if(u.isDir(h.mode))return 31;return 0},Wc:function(n,s){return n?u.fb(n.mode)?32:u.isDir(n.mode)&&(u.$b(s)!=="r"||512&s)?31:u.Za(n,u.$b(s)):44},oc:4096,$c:function(n,s){for(s=s||u.oc,n=n||0;n<=s;n++)if(!u.streams[n])return n;throw new u.ErrnoError(33)},$a:function(n){return u.streams[n]},Jc:function(n,s,l){u.ub||(u.ub=function(){},u.ub.prototype={object:{get:function(){return this.node},set:function(w){this.node=w}}});var h,y=new u.ub;for(h in n)y[h]=n[h];return n=y,s=u.$c(s,l),n.fd=s,u.streams[s]=n},Dc:function(n){u.streams[n]=null},Cc:{open:function(n){n.stream_ops=u.Oc(n.node.rdev).stream_ops,n.stream_ops.open&&n.stream_ops.open(n)},llseek:function(){throw new u.ErrnoError(70)}},Kb:function(n){return n>>8},sd:function(n){return 255&n},bb:function(n,s){return n<<8|s},Qb:function(n,s){u.Xb[n]={stream_ops:s}},Oc:function(n){return u.Xb[n]},bc:function(n){var s=[];for(n=[n];n.length;){var l=n.pop();s.push(l),n.push.apply(n,l.mb)}return s},mc:function(n,s){function l(T){return u.tb--,s(T)}function h(T){if(T){if(!h.Kc)return h.Kc=!0,l(T)}else++w>=y.length&&l(null)}typeof n=="function"&&(s=n,n=!1),u.tb++,1<u.tb&&f("warning: "+u.tb+" FS.syncfs operations in flight at once, probably just doing extra work");var y=u.bc(u.root.mount),w=0;y.forEach(function(T){if(!T.type.mc)return h(null);T.type.mc(T,n,h)})},mount:function(n,s,l){var h=l==="/",y=!l;if(h&&u.root)throw new u.ErrnoError(10);if(!h&&!y){var w=u.lookupPath(l,{Cb:!1});if(l=w.path,w=w.node,u.ab(w))throw new u.ErrnoError(10);if(!u.isDir(w.mode))throw new u.ErrnoError(54)}return s={type:n,vd:s,jc:l,mb:[]},(n=n.mount(s)).mount=s,s.root=n,h?u.root=n:w&&(w.lb=s,w.mount&&w.mount.mb.push(s)),n},yd:function(n){if(n=u.lookupPath(n,{Cb:!1}),!u.ab(n.node))throw new u.ErrnoError(28);var s=(n=n.node).lb,l=u.bc(s);Object.keys(u.Ua).forEach(function(h){for(h=u.Ua[h];h;){var y=h.cb;l.includes(h.mount)&&u.Ab(h),h=y}}),n.lb=null,n.mount.mb.splice(n.mount.mb.indexOf(s),1)},lookup:function(n,s){return n.node_ops.lookup(n,s)},mknod:function(n,s,l){var h=u.lookupPath(n,{parent:!0}).node;if(!(n=He(n))||n==="."||n==="..")throw new u.ErrnoError(28);var y=u.Lb(h,n);if(y)throw new u.ErrnoError(y);if(!h.node_ops.mknod)throw new u.ErrnoError(63);return h.node_ops.mknod(h,n,s,l)},create:function(n,s){return u.mknod(n,4095&(s!==void 0?s:438)|32768,0)},mkdir:function(n,s){return u.mknod(n,1023&(s!==void 0?s:511)|16384,0)},td:function(n,s){n=n.split("/");for(var l="",h=0;h<n.length;++h)if(n[h]){l+="/"+n[h];try{u.mkdir(l,s)}catch(y){if(y.Oa!=20)throw y}}},rb:function(n,s,l){return l===void 0&&(l=s,s=438),u.mknod(n,8192|s,l)},symlink:function(n,s){if(!it(n))throw new u.ErrnoError(44);var l=u.lookupPath(s,{parent:!0}).node;if(!l)throw new u.ErrnoError(44);s=He(s);var h=u.Lb(l,s);if(h)throw new u.ErrnoError(h);if(!l.node_ops.symlink)throw new u.ErrnoError(63);return l.node_ops.symlink(l,s,n)},rename:function(n,s){var l=Bt(n),h=Bt(s),y=He(n),w=He(s),T=u.lookupPath(n,{parent:!0}),q=T.node;if(T=(T=u.lookupPath(s,{parent:!0})).node,!q||!T)throw new u.ErrnoError(44);if(q.mount!==T.mount)throw new u.ErrnoError(75);var V=u.lookupNode(q,y);if((h=Rn(n,h)).charAt(0)!==".")throw new u.ErrnoError(28);if((h=Rn(s,l)).charAt(0)!==".")throw new u.ErrnoError(55);try{var W=u.lookupNode(T,w)}catch(Z){}if(V!==W){if(l=u.isDir(V.mode),y=u.qb(q,y,l))throw new u.ErrnoError(y);if(y=W?u.qb(T,w,l):u.Lb(T,w))throw new u.ErrnoError(y);if(!q.node_ops.rename)throw new u.ErrnoError(63);if(u.ab(V)||W&&u.ab(W))throw new u.ErrnoError(10);if(T!==q&&(y=u.Za(q,"w")))throw new u.ErrnoError(y);try{u.Sa.willMovePath&&u.Sa.willMovePath(n,s)}catch(Z){f("FS.trackingDelegate['willMovePath']('"+n+"', '"+s+"') threw an exception: "+Z.message)}u.fc(V);try{q.node_ops.rename(V,T,w)}catch(Z){throw Z}finally{u.ec(V)}try{u.Sa.onMovePath&&u.Sa.onMovePath(n,s)}catch(Z){f("FS.trackingDelegate['onMovePath']('"+n+"', '"+s+"') threw an exception: "+Z.message)}}},rmdir:function(n){var s=u.lookupPath(n,{parent:!0}).node,l=He(n),h=u.lookupNode(s,l),y=u.qb(s,l,!0);if(y)throw new u.ErrnoError(y);if(!s.node_ops.rmdir)throw new u.ErrnoError(63);if(u.ab(h))throw new u.ErrnoError(10);try{u.Sa.willDeletePath&&u.Sa.willDeletePath(n)}catch(w){f("FS.trackingDelegate['willDeletePath']('"+n+"') threw an exception: "+w.message)}s.node_ops.rmdir(s,l),u.Ab(h);try{u.Sa.onDeletePath&&u.Sa.onDeletePath(n)}catch(w){f("FS.trackingDelegate['onDeletePath']('"+n+"') threw an exception: "+w.message)}},readdir:function(n){if(!(n=u.lookupPath(n,{Ta:!0}).node).node_ops.readdir)throw new u.ErrnoError(54);return n.node_ops.readdir(n)},unlink:function(n){var s=u.lookupPath(n,{parent:!0}).node,l=He(n),h=u.lookupNode(s,l),y=u.qb(s,l,!1);if(y)throw new u.ErrnoError(y);if(!s.node_ops.unlink)throw new u.ErrnoError(63);if(u.ab(h))throw new u.ErrnoError(10);try{u.Sa.willDeletePath&&u.Sa.willDeletePath(n)}catch(w){f("FS.trackingDelegate['willDeletePath']('"+n+"') threw an exception: "+w.message)}s.node_ops.unlink(s,l),u.Ab(h);try{u.Sa.onDeletePath&&u.Sa.onDeletePath(n)}catch(w){f("FS.trackingDelegate['onDeletePath']('"+n+"') threw an exception: "+w.message)}},readlink:function(n){if(!(n=u.lookupPath(n).node))throw new u.ErrnoError(44);if(!n.node_ops.readlink)throw new u.ErrnoError(28);return it(u.Ya(n.parent),n.node_ops.readlink(n))},stat:function(n,s){if(!(n=u.lookupPath(n,{Ta:!s}).node))throw new u.ErrnoError(44);if(!n.node_ops.getattr)throw new u.ErrnoError(63);return n.node_ops.getattr(n)},lstat:function(n){return u.stat(n,!0)},chmod:function(n,s,l){if(!(n=typeof n=="string"?u.lookupPath(n,{Ta:!l}).node:n).node_ops.setattr)throw new u.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&s|-4096&n.mode,timestamp:Date.now()})},lchmod:function(n,s){u.chmod(n,s,!0)},fchmod:function(n,s){if(!(n=u.$a(n)))throw new u.ErrnoError(8);u.chmod(n.node,s)},chown:function(n,s,l,h){if(!(n=typeof n=="string"?u.lookupPath(n,{Ta:!h}).node:n).node_ops.setattr)throw new u.ErrnoError(63);n.node_ops.setattr(n,{timestamp:Date.now()})},lchown:function(n,s,l){u.chown(n,s,l,!0)},fchown:function(n,s,l){if(!(n=u.$a(n)))throw new u.ErrnoError(8);u.chown(n.node,s,l)},truncate:function(n,s){if(0>s)throw new u.ErrnoError(28);if(!(n=typeof n=="string"?u.lookupPath(n,{Ta:!0}).node:n).node_ops.setattr)throw new u.ErrnoError(63);if(u.isDir(n.mode))throw new u.ErrnoError(31);if(!u.isFile(n.mode))throw new u.ErrnoError(28);var l=u.Za(n,"w");if(l)throw new u.ErrnoError(l);n.node_ops.setattr(n,{size:s,timestamp:Date.now()})},Nc:function(n,s){if(!(n=u.$a(n)))throw new u.ErrnoError(8);if(!(2097155&n.flags))throw new u.ErrnoError(28);u.truncate(n.node,s)},kd:function(n,s,l){(n=u.lookupPath(n,{Ta:!0}).node).node_ops.setattr(n,{timestamp:Math.max(s,l)})},open:function(n,s,l,h,y){if(n==="")throw new u.ErrnoError(44);if(l=64&(s=typeof s=="string"?u.Yc(s):s)?4095&(l===void 0?438:l)|32768:0,typeof n=="object")var w=n;else{n=lt(n);try{w=u.lookupPath(n,{Ta:!(131072&s)}).node}catch(q){}}var T=!1;if(64&s)if(w){if(128&s)throw new u.ErrnoError(20)}else w=u.mknod(n,l,0),T=!0;if(!w)throw new u.ErrnoError(44);if(u.pb(w.mode)&&(s&=-513),65536&s&&!u.isDir(w.mode))throw new u.ErrnoError(54);if(!T&&(l=u.Wc(w,s)))throw new u.ErrnoError(l);512&s&&u.truncate(w,0),s&=-131713,(h=u.Jc({node:w,path:u.Ya(w),flags:s,seekable:!0,position:0,stream_ops:w.stream_ops,jd:[],error:!1},h,y)).stream_ops.open&&h.stream_ops.open(h),!c.logReadFiles||1&s||(u.Ob||(u.Ob={}),n in u.Ob||(u.Ob[n]=1,f("FS.trackingDelegate error on read file: "+n)));try{u.Sa.onOpenFile&&(y=0,(2097155&s)!=1&&(y|=u.nc.kc.qc),2097155&s&&(y|=u.nc.kc.rc),u.Sa.onOpenFile(n,y))}catch(q){f("FS.trackingDelegate['onOpenFile']('"+n+"', flags) threw an exception: "+q.message)}return h},close:function(n){if(u.kb(n))throw new u.ErrnoError(8);n.Fb&&(n.Fb=null);try{n.stream_ops.close&&n.stream_ops.close(n)}catch(s){throw s}finally{u.Dc(n.fd)}n.fd=null},kb:function(n){return n.fd===null},llseek:function(n,s,l){if(u.kb(n))throw new u.ErrnoError(8);if(!n.seekable||!n.stream_ops.llseek)throw new u.ErrnoError(70);if(l!=0&&l!=1&&l!=2)throw new u.ErrnoError(28);return n.position=n.stream_ops.llseek(n,s,l),n.jd=[],n.position},read:function(n,s,l,h,y){if(0>h||0>y)throw new u.ErrnoError(28);if(u.kb(n))throw new u.ErrnoError(8);if((2097155&n.flags)==1)throw new u.ErrnoError(8);if(u.isDir(n.node.mode))throw new u.ErrnoError(31);if(!n.stream_ops.read)throw new u.ErrnoError(28);var w=y!==void 0;if(w){if(!n.seekable)throw new u.ErrnoError(70)}else y=n.position;return s=n.stream_ops.read(n,s,l,h,y),w||(n.position+=s),s},write:function(n,s,l,h,y,w){if(0>h||0>y)throw new u.ErrnoError(28);if(u.kb(n))throw new u.ErrnoError(8);if(!(2097155&n.flags))throw new u.ErrnoError(8);if(u.isDir(n.node.mode))throw new u.ErrnoError(31);if(!n.stream_ops.write)throw new u.ErrnoError(28);n.seekable&&1024&n.flags&&u.llseek(n,0,2);var T=y!==void 0;if(T){if(!n.seekable)throw new u.ErrnoError(70)}else y=n.position;s=n.stream_ops.write(n,s,l,h,y,w),T||(n.position+=s);try{n.path&&u.Sa.onWriteToFile&&u.Sa.onWriteToFile(n.path)}catch(q){f("FS.trackingDelegate['onWriteToFile']('"+n.path+"') threw an exception: "+q.message)}return s},allocate:function(n,s,l){if(u.kb(n))throw new u.ErrnoError(8);if(0>s||0>=l)throw new u.ErrnoError(28);if(!(2097155&n.flags))throw new u.ErrnoError(8);if(!u.isFile(n.node.mode)&&!u.isDir(n.node.mode))throw new u.ErrnoError(43);if(!n.stream_ops.allocate)throw new u.ErrnoError(138);n.stream_ops.allocate(n,s,l)},mmap:function(n,s,l,h,y,w){if(2&y&&!(2&w)&&(2097155&n.flags)!=2)throw new u.ErrnoError(2);if((2097155&n.flags)==1)throw new u.ErrnoError(2);if(!n.stream_ops.mmap)throw new u.ErrnoError(43);return n.stream_ops.mmap(n,s,l,h,y,w)},msync:function(n,s,l,h,y){return n&&n.stream_ops.msync?n.stream_ops.msync(n,s,l,h,y):0},ud:function(){return 0},ic:function(n,s,l){if(!n.stream_ops.ic)throw new u.ErrnoError(59);return n.stream_ops.ic(n,s,l)},readFile:function(n,s){if((s=s||{}).flags=s.flags||0,s.encoding=s.encoding||"binary",s.encoding!=="utf8"&&s.encoding!=="binary")throw Error('Invalid encoding type "'+s.encoding+'"');var l,h=u.open(n,s.flags);n=u.stat(n).size;var y=new Uint8Array(n);return u.read(h,y,0,n,0),s.encoding==="utf8"?l=ct(y,0):s.encoding==="binary"&&(l=y),u.close(h),l},writeFile:function(n,s,l){if((l=l||{}).flags=l.flags||577,n=u.open(n,l.flags,l.mode),typeof s=="string"){var h=new Uint8Array(rt(s)+1);s=We(s,h,0,h.length),u.write(n,h,0,s,void 0,l.Bc)}else{if(!ArrayBuffer.isView(s))throw Error("Unsupported data type");u.write(n,s,0,s.byteLength,void 0,l.Bc)}u.close(n)},cwd:function(){return u.Wb},chdir:function(n){if((n=u.lookupPath(n,{Ta:!0})).node===null)throw new u.ErrnoError(44);if(!u.isDir(n.node.mode))throw new u.ErrnoError(54);var s=u.Za(n.node,"x");if(s)throw new u.ErrnoError(s);u.Wb=n.path},Fc:function(){u.mkdir("/tmp"),u.mkdir("/home"),u.mkdir("/home/web_user")},Ec:function(){u.mkdir("/dev"),u.Qb(u.bb(1,3),{read:function(){return 0},write:function(s,l,h,y){return y}}),u.rb("/dev/null",u.bb(1,3)),Mn(u.bb(5,0),Ti),Mn(u.bb(6,0),Ci),u.rb("/dev/tty",u.bb(5,0)),u.rb("/dev/tty1",u.bb(6,0));var n=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var s=new Uint8Array(1);return function(){return crypto.getRandomValues(s),s[0]}}if(O)try{var l=mi;return function(){return l.randomBytes(1)[0]}}catch(h){}return function(){ce("randomDevice")}}();u.Wa("/dev","random",n),u.Wa("/dev","urandom",n),u.mkdir("/dev/shm"),u.mkdir("/dev/shm/tmp")},Hc:function(){u.mkdir("/proc");var n=u.mkdir("/proc/self");u.mkdir("/proc/self/fd"),u.mount({mount:function(){var s=u.createNode(n,"fd",16895,73);return s.node_ops={lookup:function(l,h){var y=u.$a(+h);if(!y)throw new u.ErrnoError(8);return(l={parent:null,mount:{jc:"fake"},node_ops:{readlink:function(){return y.path}}}).parent=l}},s}},{},"/proc/self/fd")},Ic:function(){c.stdin?u.Wa("/dev","stdin",c.stdin):u.symlink("/dev/tty","/dev/stdin"),c.stdout?u.Wa("/dev","stdout",null,c.stdout):u.symlink("/dev/tty","/dev/stdout"),c.stderr?u.Wa("/dev","stderr",null,c.stderr):u.symlink("/dev/tty1","/dev/stderr"),u.open("/dev/stdin",0),u.open("/dev/stdout",1),u.open("/dev/stderr",1)},Yb:function(){u.ErrnoError||(u.ErrnoError=function(n,s){this.node=s,this.hd=function(l){this.Oa=l},this.hd(n),this.message="FS error"},u.ErrnoError.prototype=Error(),u.ErrnoError.prototype.constructor=u.ErrnoError,[44].forEach(function(n){u.Db[n]=new u.ErrnoError(n),u.Db[n].stack="<generic error, no stack>"}))},lc:function(){u.Yb(),u.Ua=Array(4096),u.mount(oe,{},"/"),u.Fc(),u.Ec(),u.Hc(),u.Lc={MEMFS:oe}},jb:function(n,s,l){u.jb.Hb=!0,u.Yb(),c.stdin=n||c.stdin,c.stdout=s||c.stdout,c.stderr=l||c.stderr,u.Ic()},wd:function(){u.jb.Hb=!1;var n=c._fflush;for(n&&n(0),n=0;n<u.streams.length;n++){var s=u.streams[n];s&&u.close(s)}},Eb:function(n,s){var l=0;return n&&(l|=365),s&&(l|=146),l},od:function(n,s){return(n=u.xb(n,s)).exists?n.object:null},xb:function(n,s){try{var l=u.lookupPath(n,{Ta:!s});n=l.path}catch(y){}var h={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,ad:!1,cd:null,bd:null};try{l=u.lookupPath(n,{parent:!0}),h.ad=!0,h.cd=l.path,h.bd=l.node,h.name=He(n),l=u.lookupPath(n,{Ta:!s}),h.exists=!0,h.path=l.path,h.object=l.node,h.name=l.node.name,h.isRoot=l.path==="/"}catch(y){h.error=y.Oa}return h},md:function(n,s){for(n=typeof n=="string"?n:u.Ya(n),s=s.split("/").reverse();s.length;){var l=s.pop();if(l){var h=ft(n,l);try{u.mkdir(h)}catch(y){}n=h}}return h},Gc:function(n,s,l,h,y){return n=ft(typeof n=="string"?n:u.Ya(n),s),u.create(n,u.Eb(h,y))},zb:function(n,s,l,h,y,w){if(n=s?ft(typeof n=="string"?n:u.Ya(n),s):n,h=u.Eb(h,y),y=u.create(n,h),l){if(typeof l=="string"){n=Array(l.length),s=0;for(var T=l.length;s<T;++s)n[s]=l.charCodeAt(s);l=n}u.chmod(y,146|h),n=u.open(y,577),u.write(n,l,0,l.length,0,w),u.close(n),u.chmod(y,h)}return y},Wa:function(n,s,l,h){n=ft(typeof n=="string"?n:u.Ya(n),s),s=u.Eb(!!l,!!h),u.Wa.Kb||(u.Wa.Kb=64);var y=u.bb(u.Wa.Kb++,0);return u.Qb(y,{open:function(w){w.seekable=!1},close:function(){h&&h.buffer&&h.buffer.length&&h(10)},read:function(w,T,q,V){for(var W=0,Z=0;Z<V;Z++){try{var ue=l()}catch(ge){throw new u.ErrnoError(29)}if(ue===void 0&&W===0)throw new u.ErrnoError(6);if(ue==null)break;W++,T[q+Z]=ue}return W&&(w.node.timestamp=Date.now()),W},write:function(w,T,q,V){for(var W=0;W<V;W++)try{h(T[q+W])}catch(Z){throw new u.ErrnoError(29)}return V&&(w.node.timestamp=Date.now()),W}}),u.rb(n,s,y)},ac:function(n){if(n.Ib||n.Sc||n.link||n.Na)return!0;if(typeof XMLHttpRequest!="undefined")throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!D)throw Error("Cannot load without read() or XMLHttpRequest.");try{n.Na=Dt(D(n.url),!0),n.Ra=n.Na.length}catch(s){throw new u.ErrnoError(29)}},ld:function(n,s,l,h,y){function w(){this.Jb=!1,this.ob=[]}if(w.prototype.get=function(W){if(!(W>this.length-1||0>W)){var Z=W%this.chunkSize;return this.dc(W/this.chunkSize|0)[Z]}},w.prototype.pc=function(W){this.dc=W},w.prototype.Ub=function(){var W=new XMLHttpRequest;if(W.open("HEAD",l,!1),W.send(null),!(200<=W.status&&300>W.status||W.status===304))throw Error("Couldn't load "+l+". Status: "+W.status);var Z,ue=Number(W.getResponseHeader("Content-length")),ge=(Z=W.getResponseHeader("Accept-Ranges"))&&Z==="bytes";W=(Z=W.getResponseHeader("Content-Encoding"))&&Z==="gzip";var me=1048576;ge||(me=ue);var _e=this;_e.pc(function(ve){var Se=ve*me,Ce=(ve+1)*me-1;if(Ce=Math.min(Ce,ue-1),_e.ob[ve]===void 0){var mr=_e.ob;if(Se>Ce)throw Error("invalid range ("+Se+", "+Ce+") or no bytes requested!");if(Ce>ue-1)throw Error("only "+ue+" bytes available! programmer error!");var ke=new XMLHttpRequest;if(ke.open("GET",l,!1),ue!==me&&ke.setRequestHeader("Range","bytes="+Se+"-"+Ce),typeof Uint8Array!="undefined"&&(ke.responseType="arraybuffer"),ke.overrideMimeType&&ke.overrideMimeType("text/plain; charset=x-user-defined"),ke.send(null),!(200<=ke.status&&300>ke.status||ke.status===304))throw Error("Couldn't load "+l+". Status: "+ke.status);Se=ke.response!==void 0?new Uint8Array(ke.response||[]):Dt(ke.responseText||"",!0),mr[ve]=Se}if(_e.ob[ve]===void 0)throw Error("doXHR failed!");return _e.ob[ve]}),!W&&ue||(me=ue=1,me=ue=this.dc(0).length,d("LazyFiles on gzip forces download of the whole file when length is accessed")),this.tc=ue,this.sc=me,this.Jb=!0},typeof XMLHttpRequest!="undefined"){if(!P)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var T=new w;Object.defineProperties(T,{length:{get:function(){return this.Jb||this.Ub(),this.tc}},chunkSize:{get:function(){return this.Jb||this.Ub(),this.sc}}}),T={Ib:!1,Na:T}}else T={Ib:!1,url:l};var q=u.Gc(n,s,T,h,y);T.Na?q.Na=T.Na:T.url&&(q.Na=null,q.url=T.url),Object.defineProperties(q,{Ra:{get:function(){return this.Na.length}}});var V={};return Object.keys(q.stream_ops).forEach(function(W){var Z=q.stream_ops[W];V[W]=function(){return u.ac(q),Z.apply(null,arguments)}}),V.read=function(W,Z,ue,ge,me){if(u.ac(q),me>=(W=W.node.Na).length)return 0;if(ge=Math.min(W.length-me,ge),W.slice)for(var _e=0;_e<ge;_e++)Z[ue+_e]=W[me+_e];else for(_e=0;_e<ge;_e++)Z[ue+_e]=W.get(me+_e);return ge},q.stream_ops=V,q},nd:function(n,s,l,h,y,w,T,q,V,W){function Z(ge){function me(ve){W&&W(),q||u.zb(n,s,ve,h,y,V),w&&w(),Ft()}var _e=!1;c.preloadPlugins.forEach(function(ve){!_e&&ve.canHandle(ue)&&(ve.handle(ge,ue,me,function(){T&&T(),Ft()}),_e=!0)}),_e||me(ge)}(void 0).jb();var ue=s?it(ft(n,s)):n;or(),typeof l=="string"?function(ge,me,_e){var ve="al "+ge;L(ge,function(Se){K(Se,'Loading data file "'+ge+'" failed (no arrayBuffer).'),me(new Uint8Array(Se)),ve&&Ft()},function(){if(!_e)throw'Loading data file "'+ge+'" failed.';_e()}),ve&&or()}(l,function(ge){Z(ge)},T):Z(l)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},Rb:function(){return"EM_FS_"+window.location.pathname},Sb:20,ib:"FILE_DATA",xd:function(n,s,l){s=s||function(){},l=l||function(){};var h=u.indexedDB();try{var y=h.open(u.Rb(),u.Sb)}catch(w){return l(w)}y.onupgradeneeded=function(){d("creating db"),y.result.createObjectStore(u.ib)},y.onsuccess=function(){var w=y.result.transaction([u.ib],"readwrite"),T=w.objectStore(u.ib),q=0,V=0,W=n.length;n.forEach(function(Z){(Z=T.put(u.xb(Z).object.Na,Z)).onsuccess=function(){++q+V==W&&(V==0?s():l())},Z.onerror=function(){V++,q+V==W&&(V==0?s():l())}}),w.onerror=l},y.onerror=l},rd:function(n,s,l){s=s||function(){},l=l||function(){};var h=u.indexedDB();try{var y=h.open(u.Rb(),u.Sb)}catch(w){return l(w)}y.onupgradeneeded=l,y.onsuccess=function(){var w=y.result;try{var T=w.transaction([u.ib],"readonly")}catch(ue){return void l(ue)}var q=T.objectStore(u.ib),V=0,W=0,Z=n.length;n.forEach(function(ue){var ge=q.get(ue);ge.onsuccess=function(){u.xb(ue).exists&&u.unlink(ue),u.zb(Bt(ue),He(ue),ge.result,!0,!0,!0),++V+W==Z&&(W==0?s():l())},ge.onerror=function(){W++,V+W==Z&&(W==0?s():l())}}),T.onerror=l},y.onerror=l}},ur={};function cr(n,s,l){try{var h=n(s)}catch(y){if(y&&y.node&&lt(s)!==lt(u.Ya(y.node)))return-54;throw y}return H[l>>2]=h.dev,H[l+4>>2]=0,H[l+8>>2]=h.ino,H[l+12>>2]=h.mode,H[l+16>>2]=h.nlink,H[l+20>>2]=h.uid,H[l+24>>2]=h.gid,H[l+28>>2]=h.rdev,H[l+32>>2]=0,Ie=[h.size>>>0,(pe=h.size,1<=+Math.abs(pe)?0<pe?(0|Math.min(+Math.floor(pe/4294967296),4294967295))>>>0:~~+Math.ceil((pe-+(~~pe>>>0))/4294967296)>>>0:0)],H[l+40>>2]=Ie[0],H[l+44>>2]=Ie[1],H[l+48>>2]=4096,H[l+52>>2]=h.blocks,H[l+56>>2]=h.atime.getTime()/1e3|0,H[l+60>>2]=0,H[l+64>>2]=h.mtime.getTime()/1e3|0,H[l+68>>2]=0,H[l+72>>2]=h.ctime.getTime()/1e3|0,H[l+76>>2]=0,Ie=[h.ino>>>0,(pe=h.ino,1<=+Math.abs(pe)?0<pe?(0|Math.min(+Math.floor(pe/4294967296),4294967295))>>>0:~~+Math.ceil((pe-+(~~pe>>>0))/4294967296)>>>0:0)],H[l+80>>2]=Ie[0],H[l+84>>2]=Ie[1],0}var lr,fr=void 0;function Pt(){return H[(fr+=4)-4>>2]}function Ge(n){if(!(n=u.$a(n)))throw new u.ErrnoError(8);return n}lr=O?function(){var n=Fe.hrtime();return 1e3*n[0]+n[1]/1e6}:function(){return performance.now()};var dr,hr={};function An(){if(!dr){var n,s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:U||"./this.program"};for(n in hr)hr[n]===void 0?delete s[n]:s[n]=hr[n];var l=[];for(n in s)l.push(n+"="+s[n]);dr=l}return dr}function In(n,s,l,h){n||(n=this),this.parent=n,this.mount=n.mount,this.lb=null,this.id=u.Zc++,this.name=s,this.mode=l,this.node_ops={},this.stream_ops={},this.rdev=h}function Dt(n,s){var l=Array(rt(n)+1);return n=We(n,l,0,l.length),s&&(l.length=n),l}Object.defineProperties(In.prototype,{read:{get:function(){return(365&this.mode)==365},set:function(n){n?this.mode|=365:this.mode&=-366}},write:{get:function(){return(146&this.mode)==146},set:function(n){n?this.mode|=146:this.mode&=-147}},Sc:{get:function(){return u.isDir(this.mode)}},Ib:{get:function(){return u.pb(this.mode)}}}),u.FSNode=In,u.lc();var Fi={a:function(n,s,l,h){ce("Assertion failed: "+we(n)+", at: "+[s?we(s):"unknown filename",l,h?we(h):"unknown function"])},u:function(n,s){(function(){function y(Z){return(Z=Z.toTimeString().match(/\(([A-Za-z ]+)\)$/))?Z[1]:"GMT"}if(!En){En=!0;var w=new Date().getFullYear(),T=new Date(w,0,1),q=new Date(w,6,1);w=T.getTimezoneOffset();var V=q.getTimezoneOffset(),W=Math.max(w,V);H[Cn()>>2]=60*W,H[Tn()>>2]=+(w!=V),T=y(T),q=y(q),T=pn(T),q=pn(q),V<w?(H[dt()>>2]=T,H[dt()+4>>2]=q):(H[dt()>>2]=q,H[dt()+4>>2]=T)}})(),n=new Date(1e3*H[n>>2]),H[s>>2]=n.getSeconds(),H[s+4>>2]=n.getMinutes(),H[s+8>>2]=n.getHours(),H[s+12>>2]=n.getDate(),H[s+16>>2]=n.getMonth(),H[s+20>>2]=n.getFullYear()-1900,H[s+24>>2]=n.getDay();var l=new Date(n.getFullYear(),0,1);H[s+28>>2]=(n.getTime()-l.getTime())/864e5|0,H[s+36>>2]=-60*n.getTimezoneOffset();var h=new Date(n.getFullYear(),6,1).getTimezoneOffset();return n=0|(h!=(l=l.getTimezoneOffset())&&n.getTimezoneOffset()==Math.min(l,h)),H[s+32>>2]=n,n=H[dt()+(n?4:0)>>2],H[s+40>>2]=n,s},m:function(n,s){try{var l;if(n=we(n),-8&s)var h=-28;else(l=u.lookupPath(n,{Ta:!0}).node)?(n="",4&s&&(n+="r"),2&s&&(n+="w"),1&s&&(n+="x"),h=n&&u.Za(l,n)?-2:0):h=-44;return h}catch(y){return u!==void 0&&y instanceof u.ErrnoError||ce(y),-y.Oa}},A:function(n,s){try{return n=we(n),u.chmod(n,s),0}catch(l){return u!==void 0&&l instanceof u.ErrnoError||ce(l),-l.Oa}},H:function(n,s,l){try{return n=we(n),u.chown(n,s,l),0}catch(h){return u!==void 0&&h instanceof u.ErrnoError||ce(h),-h.Oa}},B:function(n,s){try{return u.fchmod(n,s),0}catch(l){return u!==void 0&&l instanceof u.ErrnoError||ce(l),-l.Oa}},I:function(n,s,l){try{return u.fchown(n,s,l),0}catch(h){return u!==void 0&&h instanceof u.ErrnoError||ce(h),-h.Oa}},b:function(n,s,l){fr=l;try{var h=Ge(n);switch(s){case 0:var y=Pt();return 0>y?-28:u.open(h.path,h.flags,0,y).fd;case 1:case 2:case 13:case 14:return 0;case 3:return h.flags;case 4:return y=Pt(),h.flags|=y,0;case 12:return y=Pt(),Oe[y+0>>1]=2,0;case 16:case 8:default:return-28;case 9:return H[gr()>>2]=28,-1}}catch(w){return u!==void 0&&w instanceof u.ErrnoError||ce(w),-w.Oa}},E:function(n,s){try{var l=Ge(n);return cr(u.stat,l.path,s)}catch(h){return u!==void 0&&h instanceof u.ErrnoError||ce(h),-h.Oa}},n:function(n,s,l){try{return u.Nc(n,l),0}catch(h){return u!==void 0&&h instanceof u.ErrnoError||ce(h),-h.Oa}},l:function(n,s){try{if(s===0)return-28;var l=u.cwd();return s<rt(l)+1?-68:(We(l,he,n,s),n)}catch(h){return u!==void 0&&h instanceof u.ErrnoError||ce(h),-h.Oa}},G:function(){return 0},d:function(){return 42},z:function(n,s){try{return n=we(n),cr(u.lstat,n,s)}catch(l){return u!==void 0&&l instanceof u.ErrnoError||ce(l),-l.Oa}},C:function(n,s){try{return(n=lt(n=we(n)))[n.length-1]==="/"&&(n=n.substr(0,n.length-1)),u.mkdir(n,s,0),0}catch(l){return u!==void 0&&l instanceof u.ErrnoError||ce(l),-l.Oa}},y:function(n,s,l,h,y,w){try{e:{w<<=12;var T=!1;if(16&h&&n%65536!=0)var q=-28;else{if(32&h){var V=xn(s);if(!V){q=-48;break e}T=!0}else{var W=u.$a(y);if(!W){q=-8;break e}var Z=u.mmap(W,n,s,w,l,h);V=Z.ed,T=Z.vb}ur[V]={Uc:V,Tc:s,vb:T,fd:y,dd:l,flags:h,offset:w},q=V}}return q}catch(ue){return u!==void 0&&ue instanceof u.ErrnoError||ce(ue),-ue.Oa}},x:function(n,s){try{var l=ur[n];if(s!==0&&l){if(s===l.Tc){var h=u.$a(l.fd);if(h&&2&l.dd){var y=l.flags,w=l.offset,T=he.slice(n,n+s);u.msync(h,T,w,s,y)}ur[n]=null,l.vb&&yt(l.Uc)}var q=0}else q=-28;return q}catch(V){return u!==void 0&&V instanceof u.ErrnoError||ce(V),-V.Oa}},w:function(n,s,l){fr=l;try{var h=we(n),y=l?Pt():0;return u.open(h,s,y).fd}catch(w){return u!==void 0&&w instanceof u.ErrnoError||ce(w),-w.Oa}},J:function(n,s,l){try{if(n=we(n),0>=l)var h=-28;else{var y=u.readlink(n),w=Math.min(l,rt(y)),T=de[s+w];We(y,he,s,l+1),de[s+w]=T,h=w}return h}catch(q){return u!==void 0&&q instanceof u.ErrnoError||ce(q),-q.Oa}},F:function(n){try{return n=we(n),u.rmdir(n),0}catch(s){return u!==void 0&&s instanceof u.ErrnoError||ce(s),-s.Oa}},e:function(n,s){try{return n=we(n),cr(u.stat,n,s)}catch(l){return u!==void 0&&l instanceof u.ErrnoError||ce(l),-l.Oa}},i:function(n){try{return n=we(n),u.unlink(n),0}catch(s){return u!==void 0&&s instanceof u.ErrnoError||ce(s),-s.Oa}},v:function(){return 2147483648},p:function(n,s,l){he.copyWithin(n,s,s+l)},c:function(n){var s=he.length;if(2147483648<(n>>>=0))return!1;for(var l=1;4>=l;l*=2){var h=s*(1+.2/l);h=Math.min(h,n+100663296),0<(h=Math.max(n,h))%65536&&(h+=65536-h%65536);e:{try{Y.grow(Math.min(2147483648,h)-fe.byteLength+65535>>>16),vn();var y=1;break e}catch(w){}y=void 0}if(y)return!0}return!1},t:function(n){for(var s=lr();lr()-s<n;);},r:function(n,s){try{var l=0;return An().forEach(function(h,y){var w=s+l;for(y=H[n+4*y>>2]=w,w=0;w<h.length;++w)de[y++>>0]=h.charCodeAt(w);de[y>>0]=0,l+=h.length+1}),0}catch(h){return u!==void 0&&h instanceof u.ErrnoError||ce(h),h.Oa}},s:function(n,s){try{var l=An();H[n>>2]=l.length;var h=0;return l.forEach(function(y){h+=y.length+1}),H[s>>2]=h,0}catch(y){return u!==void 0&&y instanceof u.ErrnoError||ce(y),y.Oa}},f:function(n){try{var s=Ge(n);return u.close(s),0}catch(l){return u!==void 0&&l instanceof u.ErrnoError||ce(l),l.Oa}},q:function(n,s){try{var l=Ge(n),h=l.tty?2:u.isDir(l.mode)?3:u.fb(l.mode)?7:4;return de[s>>0]=h,0}catch(y){return u!==void 0&&y instanceof u.ErrnoError||ce(y),y.Oa}},j:function(n,s,l,h){try{e:{for(var y=Ge(n),w=n=0;w<l;w++){var T=H[s+(8*w+4)>>2],q=u.read(y,de,H[s+8*w>>2],T,void 0);if(0>q){var V=-1;break e}if(n+=q,q<T)break}V=n}return H[h>>2]=V,0}catch(W){return u!==void 0&&W instanceof u.ErrnoError||ce(W),W.Oa}},o:function(n,s,l,h,y){try{var w=Ge(n);return-9007199254740992>=(n=4294967296*l+(s>>>0))||9007199254740992<=n?-61:(u.llseek(w,n,h),Ie=[w.position>>>0,(pe=w.position,1<=+Math.abs(pe)?0<pe?(0|Math.min(+Math.floor(pe/4294967296),4294967295))>>>0:~~+Math.ceil((pe-+(~~pe>>>0))/4294967296)>>>0:0)],H[y>>2]=Ie[0],H[y+4>>2]=Ie[1],w.Fb&&n===0&&h===0&&(w.Fb=null),0)}catch(T){return u!==void 0&&T instanceof u.ErrnoError||ce(T),T.Oa}},k:function(n){try{var s=Ge(n);return s.stream_ops&&s.stream_ops.fsync?-s.stream_ops.fsync(s):0}catch(l){return u!==void 0&&l instanceof u.ErrnoError||ce(l),l.Oa}},g:function(n,s,l,h){try{e:{for(var y=Ge(n),w=n=0;w<l;w++){var T=u.write(y,de,H[s+8*w>>2],H[s+(8*w+4)>>2],void 0);if(0>T){var q=-1;break e}n+=T}q=n}return H[h>>2]=q,0}catch(V){return u!==void 0&&V instanceof u.ErrnoError||ce(V),V.Oa}},h:function(n){var s=Date.now();return H[n>>2]=s/1e3|0,H[n+4>>2]=s%1e3*1e3|0,0},K:function(n){var s=Date.now()/1e3|0;return n&&(H[n>>2]=s),s},D:function(n,s){if(s){var l=s+8;s=1e3*H[l>>2],s+=H[l+4>>2]/1e3}else s=Date.now();n=we(n);try{u.kd(n,s,s);var h=0}catch(y){if(!(y instanceof u.ErrnoError)){e:{if(!(h=Error()).stack){try{throw Error()}catch(w){h=w}if(!h.stack){h="(no stack trace available)";break e}}h=h.stack.toString()}throw c.extraStackTrace&&(h+=`
`+c.extraStackTrace()),h=function(w){return w.replace(/\b_Z[\w\d_]+/g,function(T){return T==T?T:T+" ["+T+"]"})}(h),y+" : "+h}h=y.Oa,H[gr()>>2]=h,h=-1}return h}};(function(){function n(y){c.asm=y.exports,Y=c.asm.L,vn(),De=c.asm.Da,bn.unshift(c.asm.M),Ft()}function s(y){n(y.instance)}function l(y){return function(){if(!b&&(m||P)){if(typeof fetch=="function"&&!Ae.startsWith("file://"))return fetch(Ae,{credentials:"same-origin"}).then(function(w){if(!w.ok)throw"failed to load wasm binary file at '"+Ae+"'";return w.arrayBuffer()}).catch(function(){return kn()});if(L)return new Promise(function(w,T){L(Ae,function(q){w(new Uint8Array(q))},T)})}return Promise.resolve().then(function(){return kn()})}().then(function(w){return WebAssembly.instantiate(w,h)}).then(y,function(w){f("failed to asynchronously prepare wasm: "+w),ce(w)})}var h={a:Fi};if(or(),c.instantiateWasm)try{return c.instantiateWasm(h,n)}catch(y){return f("Module.instantiateWasm callback failed with error: "+y),!1}b||typeof WebAssembly.instantiateStreaming!="function"||On()||Ae.startsWith("file://")||typeof fetch!="function"?l(s):fetch(Ae,{credentials:"same-origin"}).then(function(y){return WebAssembly.instantiateStreaming(y,h).then(s,function(w){return f("wasm streaming compile failed: "+w),f("falling back to ArrayBuffer instantiation"),l(s)})})})(),c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm.M).apply(null,arguments)},c._sqlite3_vfs_find=function(){return(c._sqlite3_vfs_find=c.asm.N).apply(null,arguments)},c._sqlite3_free=function(){return(c._sqlite3_free=c.asm.O).apply(null,arguments)};var gr=c.___errno_location=function(){return(gr=c.___errno_location=c.asm.P).apply(null,arguments)};c._sqlite3_finalize=function(){return(c._sqlite3_finalize=c.asm.Q).apply(null,arguments)},c._sqlite3_reset=function(){return(c._sqlite3_reset=c.asm.R).apply(null,arguments)},c._sqlite3_clear_bindings=function(){return(c._sqlite3_clear_bindings=c.asm.S).apply(null,arguments)},c._sqlite3_value_blob=function(){return(c._sqlite3_value_blob=c.asm.T).apply(null,arguments)},c._sqlite3_value_text=function(){return(c._sqlite3_value_text=c.asm.U).apply(null,arguments)},c._sqlite3_value_bytes=function(){return(c._sqlite3_value_bytes=c.asm.V).apply(null,arguments)},c._sqlite3_value_double=function(){return(c._sqlite3_value_double=c.asm.W).apply(null,arguments)},c._sqlite3_value_int=function(){return(c._sqlite3_value_int=c.asm.X).apply(null,arguments)},c._sqlite3_value_type=function(){return(c._sqlite3_value_type=c.asm.Y).apply(null,arguments)},c._sqlite3_result_blob=function(){return(c._sqlite3_result_blob=c.asm.Z).apply(null,arguments)},c._sqlite3_result_double=function(){return(c._sqlite3_result_double=c.asm._).apply(null,arguments)},c._sqlite3_result_error=function(){return(c._sqlite3_result_error=c.asm.$).apply(null,arguments)},c._sqlite3_result_int=function(){return(c._sqlite3_result_int=c.asm.aa).apply(null,arguments)},c._sqlite3_result_int64=function(){return(c._sqlite3_result_int64=c.asm.ba).apply(null,arguments)},c._sqlite3_result_null=function(){return(c._sqlite3_result_null=c.asm.ca).apply(null,arguments)},c._sqlite3_result_text=function(){return(c._sqlite3_result_text=c.asm.da).apply(null,arguments)},c._sqlite3_step=function(){return(c._sqlite3_step=c.asm.ea).apply(null,arguments)},c._sqlite3_column_count=function(){return(c._sqlite3_column_count=c.asm.fa).apply(null,arguments)},c._sqlite3_data_count=function(){return(c._sqlite3_data_count=c.asm.ga).apply(null,arguments)},c._sqlite3_column_blob=function(){return(c._sqlite3_column_blob=c.asm.ha).apply(null,arguments)},c._sqlite3_column_bytes=function(){return(c._sqlite3_column_bytes=c.asm.ia).apply(null,arguments)},c._sqlite3_column_double=function(){return(c._sqlite3_column_double=c.asm.ja).apply(null,arguments)},c._sqlite3_column_text=function(){return(c._sqlite3_column_text=c.asm.ka).apply(null,arguments)},c._sqlite3_column_type=function(){return(c._sqlite3_column_type=c.asm.la).apply(null,arguments)},c._sqlite3_column_name=function(){return(c._sqlite3_column_name=c.asm.ma).apply(null,arguments)},c._sqlite3_bind_blob=function(){return(c._sqlite3_bind_blob=c.asm.na).apply(null,arguments)},c._sqlite3_bind_double=function(){return(c._sqlite3_bind_double=c.asm.oa).apply(null,arguments)},c._sqlite3_bind_int=function(){return(c._sqlite3_bind_int=c.asm.pa).apply(null,arguments)},c._sqlite3_bind_text=function(){return(c._sqlite3_bind_text=c.asm.qa).apply(null,arguments)},c._sqlite3_bind_parameter_index=function(){return(c._sqlite3_bind_parameter_index=c.asm.ra).apply(null,arguments)},c._sqlite3_sql=function(){return(c._sqlite3_sql=c.asm.sa).apply(null,arguments)},c._sqlite3_normalized_sql=function(){return(c._sqlite3_normalized_sql=c.asm.ta).apply(null,arguments)},c._sqlite3_errmsg=function(){return(c._sqlite3_errmsg=c.asm.ua).apply(null,arguments)},c._sqlite3_exec=function(){return(c._sqlite3_exec=c.asm.va).apply(null,arguments)},c._sqlite3_prepare_v2=function(){return(c._sqlite3_prepare_v2=c.asm.wa).apply(null,arguments)},c._sqlite3_changes=function(){return(c._sqlite3_changes=c.asm.xa).apply(null,arguments)},c._sqlite3_close_v2=function(){return(c._sqlite3_close_v2=c.asm.ya).apply(null,arguments)},c._sqlite3_create_function_v2=function(){return(c._sqlite3_create_function_v2=c.asm.za).apply(null,arguments)},c._sqlite3_open=function(){return(c._sqlite3_open=c.asm.Aa).apply(null,arguments)};var $t=c._malloc=function(){return($t=c._malloc=c.asm.Ba).apply(null,arguments)},yt=c._free=function(){return(yt=c._free=c.asm.Ca).apply(null,arguments)};c._RegisterExtensionFunctions=function(){return(c._RegisterExtensionFunctions=c.asm.Ea).apply(null,arguments)},c._register_for_idb=function(){return(c._register_for_idb=c.asm.Fa).apply(null,arguments)};var Lt,dt=c.__get_tzname=function(){return(dt=c.__get_tzname=c.asm.Ga).apply(null,arguments)},Tn=c.__get_daylight=function(){return(Tn=c.__get_daylight=c.asm.Ha).apply(null,arguments)},Cn=c.__get_timezone=function(){return(Cn=c.__get_timezone=c.asm.Ia).apply(null,arguments)},bt=c.stackSave=function(){return(bt=c.stackSave=c.asm.Ja).apply(null,arguments)},wt=c.stackRestore=function(){return(wt=c.stackRestore=c.asm.Ka).apply(null,arguments)},Ye=c.stackAlloc=function(){return(Ye=c.stackAlloc=c.asm.La).apply(null,arguments)},Fn=c._memalign=function(){return(Fn=c._memalign=c.asm.Ma).apply(null,arguments)};function _r(){function n(){if(!Lt&&(Lt=!0,c.calledRun=!0,!Q)){if(c.noFSInit||u.jb.Hb||u.jb(),u.hc=!1,sr(bn),c.onRuntimeInitialized&&c.onRuntimeInitialized(),c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;){var s=c.postRun.shift();wn.unshift(s)}sr(wn)}}if(!(0<nt)){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)Ai();sr(yn),0<nt||(c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),n()},1)):n())}}if(c.cwrap=function(n,s,l,h){var y=(l=l||[]).every(function(w){return w==="number"});return s!=="string"&&y&&!h?ne(n):function(){return function(w,T,q,V){var W,Z={string:function(ve){var Se=0;if(ve!=null&&ve!==0){var Ce=1+(ve.length<<2);Se=Ye(Ce),We(ve,he,Se,Ce)}return Se},array:function(ve){var Se=Ye(ve.length);return de.set(ve,Se),Se}},ue=ne(w),ge=[];if(w=0,V)for(var me=0;me<V.length;me++){var _e=Z[q[me]];_e?(w===0&&(w=bt()),ge[me]=_e(V[me])):ge[me]=V[me]}return q=ue.apply(null,ge),W=q,q=T==="string"?we(W):T==="boolean"?!!W:W,w!==0&&wt(w),q}(n,s,l,arguments)}},c.UTF8ToString=we,c.FS=u,c.stackSave=bt,c.stackRestore=wt,c.stackAlloc=Ye,vt=function n(){Lt||_r(),Lt||(vt=n)},c.run=_r,c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);0<c.preInit.length;)c.preInit.pop()();return _r(),c}),r)};t.exports=i,t.exports.default=i})(Kr);var pi=vr(Kr.exports);const vi=63,yi=44,bi=class{constructor(t,e){this.FS=t,this.backend=e,this.node_ops={getattr:r=>{let i=t.isFile(r.mode)?r.contents.getattr():null,o={dev:1};return o.ino=r.id,o.mode=i?i.mode:r.mode,o.nlink=1,o.uid=0,o.gid=0,o.rdev=r.rdev,o.size=i?i.size:t.isDir(r.mode)?4096:0,o.atime=new Date(0),o.mtime=new Date(0),o.ctime=new Date(0),o.blksize=i?i.blockSize:4096,o.blocks=Math.ceil(o.size/o.blksize),o},setattr:(r,i)=>{this.FS.isFile(r.mode)?r.contents.setattr(i):(i.mode!=null&&(r.mode=i.mode),i.size!=null&&(r.size=i.size))},lookup:(r,i)=>{throw new this.FS.ErrnoError(yi)},mknod:(r,i,o,a)=>{if(i.endsWith(".lock"))throw new Error("Locking via lockfiles is not supported");return this.createNode(r,i,o,a)},rename:(r,i,o)=>{throw new Error("rename not implemented")},unlink:(r,i)=>{this.FS.lookupNode(r,i).contents.delete(i)},readdir:r=>{throw new Error("readdir not implemented")},symlink:(r,i,o)=>{throw new Error("symlink not implemented")},readlink:r=>{throw new Error("symlink not implemented")}},this.stream_ops={open:r=>{this.FS.isFile(r.node.mode)&&r.node.contents.open()},close:r=>{this.FS.isFile(r.node.mode)&&r.node.contents.close()},read:(r,i,o,a,p)=>r.node.contents.read(i,o,a,p),write:(r,i,o,a,p)=>r.node.contents.write(i,o,a,p),llseek:(r,i,o)=>{var a=i;if(o===1?a+=r.position:o===2&&t.isFile(r.node.mode)&&(a+=r.node.contents.getattr().size),a<0)throw new this.FS.ErrnoError(28);return a},allocate:(r,i,o)=>{r.node.contents.setattr({size:i+o})},mmap:(r,i,o,a,p,c)=>{throw new Error("mmap not implemented")},msync:(r,i,o,a,p)=>{throw new Error("msync not implemented")},fsync:(r,i,o,a,p)=>{r.node.contents.fsync()}}}mount(){return this.createNode(null,"/",16895,0)}lock(t,e){let{node:r}=this.FS.lookupPath(t);return r.contents.lock(e)}unlock(t,e){let{node:r}=this.FS.lookupPath(t);return r.contents.unlock(e)}createNode(t,e,r,i){if(!this.FS.isDir(r)&&!this.FS.isFile(r))throw new this.FS.ErrnoError(vi);var o=this.FS.createNode(t,e,r,i);return this.FS.isDir(o.mode)?(o.node_ops={mknod:this.node_ops.mknod,lookup:this.node_ops.lookup,unlink:this.node_ops.unlink,setattr:this.node_ops.setattr},o.stream_ops={},o.contents={}):this.FS.isFile(o.mode)&&(o.node_ops=this.node_ops,o.stream_ops=this.stream_ops,o.contents=this.backend.createFile(e)),t&&(t.contents[e]=o,t.timestamp=o.timestamp),o}};let Ct=1,wi=2;function rr(t){return(t[16]<<8)+t[17]}function sn(t,e,r){return function(i,o,a){let p=[];for(let c=i;c<=o;c+=a)p.push(c);return p}(e-e%t,r-1-(r-1)%t,t)}function an(t,e,r,i){let o=sn(e,r,i),a=0;return o.map(p=>{let c=0,M=e;r>p&&r<p+e&&(c=r-p),i>p&&i<p+e&&(M=i-p);let x=M-c,A=new ArrayBuffer(e);if(r>p+e||i<=p)return null;let D=t.byteOffset+a,L=t.buffer.byteLength-D;if(L<=0)return null;let G=Math.min(x,L);return new Uint8Array(A).set(new Uint8Array(t.buffer,D,G),c),a+=G,{pos:p,data:A,offset:c,length:G}}).filter(Boolean)}class Ei{constructor(e,r,i=null){this.filename=e,this.buffer=new Map,this.ops=r,this.meta=i,this._metaDirty=!1,this.writeLock=!1,this.openHandles=0}bufferChunks(e){for(let r=0;r<e.length;r++){let i=e[r];this.buffer.set(i.pos,i)}}open(){if(this.openHandles++,this.openHandles===1){this.ops.open();let e=this.ops.readMeta();this.meta==null&&(e==null&&(e={size:0}),this.meta=e)}return this.meta}close(){this.fsync(),this.openHandles=Math.max(this.openHandles-1,0),this.openHandles===0&&this.ops.close()}delete(){this.ops.delete()}load(e){let r=e.reduce((o,a)=>{let p=this.buffer.get(a);return p?o.chunks.push(p):o.missing.push(a),o},{chunks:[],missing:[]}),i=[];return r.missing.length>0&&(i=this.ops.readBlocks(r.missing,this.meta.blockSize)),r.chunks.concat(i)}read(e,r,i,o){let a=e.buffer;if(i<=0||o<0)return 0;if(o>=this.meta.size){let L=new Uint8Array(a,r);for(let G=0;G<i;G++)L[G]=0;return i}o=Math.max(o,0);let p=Math.min(i,this.meta.size-o),c=o,M=o+p,x=sn(this.meta.blockSize,c,M),A=function(L,G,X){let te=new ArrayBuffer(X-G),U=new Uint8Array(te);for(let m=0;m<L.length;m++){let P=L[m];if(P.data.constructor.name!=="ArrayBuffer")throw new Error("Chunk data is not an ArrayBuffer");let O=0,v=P.data.byteLength;if(G>P.pos&&(O=G-P.pos),X<P.pos+P.data.byteLength&&(v=X-P.pos),O>P.data.byteLength||v<0)continue;let d=v-O;U.set(new Uint8Array(P.data,O,d),P.pos-G+O)}return te}(this.load(x),c,M);if(a.byteLength-r<A.byteLength)throw new Error("Buffer given to `read` is too small");let D=new Uint8Array(a);D.set(new Uint8Array(A),r);for(let L=p;L<i;L++)D[r+L]=0;return i}write(e,r,i,o){if(this.meta.blockSize==null){let D=rr(new Uint8Array(e.buffer,e.byteOffset+r));if(![512,1024,2048,4096,8192,16384,32768,65536].includes(D))throw new Error("File has invalid page size. (the first block of a new file must be written first)");this.setattr({blockSize:D})}let a=e.buffer;if(i<=0||o<0||a.byteLength===0)return 0;i=Math.min(i,a.byteLength-r);let p=an(new Uint8Array(a,r,i),this.meta.blockSize,o,o+i),{partialWrites:c,fullWrites:M}=p.reduce((D,L)=>(L.length!==this.meta.blockSize?D.partialWrites.push(L):D.fullWrites.push({pos:L.pos,data:L.data}),D),{fullWrites:[],partialWrites:[]}),x=[];c.length>0&&(x=this.load(c.map(D=>D.pos)));let A=M.concat(x.map(D=>{let L=c.find(G=>G.pos===D.pos);return new Uint8Array(D.data).set(new Uint8Array(L.data,L.offset,L.length),L.offset,L.length),D}));return this.bufferChunks(A),o+i>this.meta.size&&this.setattr({size:o+i}),i}readIfFallback(){return S(this,null,function*(){if(this.ops.readIfFallback){let e=yield this.ops.readIfFallback();this.meta=e||{size:0}}})}lock(e){return this._recordingLock||(this._recordingLock=!0),!!this.ops.lock(e)&&(e>=wi&&(this.writeLock=!0),!0)}unlock(e){return e===0&&(this._recordingLock=!1),this.writeLock&&(this.fsync(),this.writeLock=!1),this.ops.unlock(e)}fsync(){if(this.buffer.size>0){let e=this.buffer.get(0);if(e){let r=rr(new Uint8Array(e.data));if(r!==this.meta.blockSize){let i=this.buffer;this.buffer=new Map;let o=[...i.values()],a=o.length*this.meta.blockSize,p=new ArrayBuffer(a),c=new Uint8Array(p);for(let M of o)c.set(new Uint8Array(M.data),M.pos);this.bufferChunks(an(c,r,0,a)),this.setattr({blockSize:r})}}this.ops.writeBlocks([...this.buffer.values()],this.meta.blockSize)}this._metaDirty&&(this.ops.writeMeta({size:this.meta.size}),this._metaDirty=!1),this.buffer=new Map}setattr(e){this.meta==null&&(this.meta={}),e.mode!==void 0&&(this.meta.mode=e.mode),e.blockSize!==void 0&&(this.meta.blockSize=e.blockSize),e.size!==void 0&&(this.meta.size=e.size,this._metaDirty=!0)}getattr(){return this.meta}}let tt,je,un,cn=3735928559;class Oi{constructor(e,{initialOffset:r=4,useAtomics:i=!0,stream:o=!0,debug:a,name:p}={}){this.buffer=e,this.atomicView=new Int32Array(e),this.offset=r,this.useAtomics=i,this.stream=o,this.debug=a,this.name=p}log(...e){this.debug&&console.log(`[reader: ${this.name}]`,...e)}waitWrite(e,r=null){if(this.useAtomics){for(this.log(`waiting for ${e}`);Atomics.load(this.atomicView,0)===0;){if(r!=null&&Atomics.wait(this.atomicView,0,0,r)==="timed-out")throw new Error("timeout");Atomics.wait(this.atomicView,0,0,500)}this.log(`resumed for ${e}`)}else if(this.atomicView[0]!==1)throw new Error("`waitWrite` expected array to be readable")}flip(){if(this.log("flip"),this.useAtomics){if(Atomics.compareExchange(this.atomicView,0,1,0)!==1)throw new Error("Read data out of sync! This is disastrous");Atomics.notify(this.atomicView,0)}else this.atomicView[0]=0;this.offset=4}done(){this.waitWrite("done");let e=new DataView(this.buffer,this.offset).getUint32(0)===cn;return e&&(this.log("done"),this.flip()),e}peek(e){this.peekOffset=this.offset;let r=e();return this.offset=this.peekOffset,this.peekOffset=null,r}string(e){this.waitWrite("string",e);let r=this._int32(),i=r/2,o=new DataView(this.buffer,this.offset,r),a=[];for(let c=0;c<i;c++)a.push(o.getUint16(2*c));let p=String.fromCharCode.apply(null,a);return this.log("string",p),this.offset+=r,this.peekOffset==null&&this.flip(),p}_int32(){let e=new DataView(this.buffer,this.offset).getInt32();return this.log("_int32",e),this.offset+=4,e}int32(){this.waitWrite("int32");let e=this._int32();return this.log("int32",e),this.peekOffset==null&&this.flip(),e}bytes(){this.waitWrite("bytes");let e=this._int32(),r=new ArrayBuffer(e);return new Uint8Array(r).set(new Uint8Array(this.buffer,this.offset,e)),this.log("bytes",r),this.offset+=e,this.peekOffset==null&&this.flip(),r}}class Si{constructor(e,{initialOffset:r=4,useAtomics:i=!0,stream:o=!0,debug:a,name:p}={}){this.buffer=e,this.atomicView=new Int32Array(e),this.offset=r,this.useAtomics=i,this.stream=o,this.debug=a,this.name=p,this.useAtomics?Atomics.store(this.atomicView,0,0):this.atomicView[0]=0}log(...e){this.debug&&console.log(`[writer: ${this.name}]`,...e)}waitRead(e){if(this.useAtomics){if(this.log(`waiting for ${e}`),Atomics.compareExchange(this.atomicView,0,0,1)!==0)throw new Error("Wrote something into unwritable buffer! This is disastrous");for(Atomics.notify(this.atomicView,0);Atomics.load(this.atomicView,0)===1;)Atomics.wait(this.atomicView,0,1,500);this.log(`resumed for ${e}`)}else this.atomicView[0]=1;this.offset=4}finalize(){this.log("finalizing"),new DataView(this.buffer,this.offset).setUint32(0,cn),this.waitRead("finalize")}string(e){this.log("string",e);let r=2*e.length;this._int32(r);let i=new DataView(this.buffer,this.offset,r);for(let o=0;o<e.length;o++)i.setUint16(2*o,e.charCodeAt(o));this.offset+=r,this.waitRead("string")}_int32(e){new DataView(this.buffer,this.offset).setInt32(0,e),this.offset+=4}int32(e){this.log("int32",e),this._int32(e),this.waitRead("int32")}bytes(e){this.log("bytes",e);let r=e.byteLength;this._int32(r),new Uint8Array(this.buffer,this.offset).set(new Uint8Array(e)),this.offset+=r,this.waitRead("bytes")}}function ln(t,e){return Math.round(t/e)}class ki{constructor(e){this.filename=e}getStoreName(){return this.filename.replace(/\//g,"-")}invokeWorker(e,r){if(this.reader==null||this.writer==null)throw new Error(`Attempted ${e} on ${this.filename} but file not open`);let i=this.reader,o=this.writer;switch(e){case"readBlocks":{let{name:a,positions:p,blockSize:c}=r,M=[];for(let x of p){o.string("readBlock"),o.string(a),o.int32(ln(x,c)),o.finalize();let A=i.bytes();i.done(),M.push({pos:x,data:A.byteLength===0?new ArrayBuffer(c):A})}return M}case"writeBlocks":{let{name:a,writes:p,blockSize:c}=r;o.string("writeBlocks"),o.string(a);for(let x of p)o.int32(ln(x.pos,c)),o.bytes(x.data);o.finalize();let M=i.int32();return i.done(),M}case"readMeta":{o.string("readMeta"),o.string(r.name),o.finalize();let a=i.int32(),p=i.int32();return i.done(),a===-1?null:{size:a,blockSize:p}}case"writeMeta":{let{name:a,meta:p}=r;o.string("writeMeta"),o.string(a),o.int32(p.size),o.finalize();let c=i.int32();return i.done(),c}case"closeFile":{o.string("closeFile"),o.string(r.name),o.finalize();let a=i.int32();return i.done(),a}case"lockFile":{o.string("lockFile"),o.string(r.name),o.int32(r.lockType),o.finalize();let a=i.int32();return i.done(),a===0}case"unlockFile":{o.string("unlockFile"),o.string(r.name),o.int32(r.lockType),o.finalize();let a=i.int32();return i.done(),a===0}}}lock(e){return this.invokeWorker("lockFile",{name:this.getStoreName(),lockType:e})}unlock(e){return this.invokeWorker("unlockFile",{name:this.getStoreName(),lockType:e})}delete(){(this.reader||this.writer)&&this.close();let e=globalThis.indexedDB.deleteDatabase(this.getStoreName());e.onerror=()=>{console.warn(`Deleting ${this.filename} database failed`)},e.onsuccess=()=>{}}open(){let e=new SharedArrayBuffer(36864);this.writer=new Si(e,{name:"args (backend)",debug:!1});let r=new SharedArrayBuffer(36864);var i,o;this.reader=new Oi(r,{name:"results",debug:!1}),i=this.reader,o=this.writer,self.postMessage({type:"__absurd:spawn-idb-worker",argBuffer:o.buffer,resultBuffer:i.buffer}),self.addEventListener("message",a=>{switch(a.data.type){case"__perf-deets:start-profile":o.string("profile-start"),o.finalize(),i.int32(),i.done();break;case"__perf-deets:stop-profile":o.string("profile-stop"),o.finalize(),i.int32(),i.done()}})}close(){this.invokeWorker("closeFile",{name:this.getStoreName()}),this.reader=null,this.writer=null,this.worker=null}readMeta(){return this.invokeWorker("readMeta",{name:this.getStoreName()})}writeMeta(e){return this.invokeWorker("writeMeta",{name:this.getStoreName(),meta:e})}readBlocks(e,r){return this.stats&&(this.stats.read+=e.length),this.invokeWorker("readBlocks",{name:this.getStoreName(),positions:e,blockSize:r})}writeBlocks(e,r){return this.stats&&(this.stats.writes+=e.length),this.invokeWorker("writeBlocks",{name:this.getStoreName(),writes:e,blockSize:r})}}function fn(t,e){return Math.round(t/e)}function Ri(t){return S(this,null,function*(){return yield function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(r=>{const i=()=>indexedDB.databases().finally(r);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}(),new Promise((e,r)=>{let i=globalThis.indexedDB.open(t,2);i.onsuccess=o=>{let a=o.target.result;a.onversionchange=()=>{console.log("closing because version changed"),a.close()},a.onclose=()=>{},e(a)},i.onupgradeneeded=o=>{let a=o.target.result;a.objectStoreNames.contains("data")||a.createObjectStore("data")},i.onblocked=o=>console.log("blocked",o),i.onerror=i.onabort=o=>r(o.target.error)})})}class Ni{constructor(e,r){this.dbName=e,this._openDb=null,this.hasAlertedFailure=!1,this.onFallbackFailure=r}getDb(){return S(this,null,function*(){return this._openDb||(this._openDb=yield Ri(this.dbName)),this._openDb})}closeDb(){this._openDb&&(this._openDb.close(),this._openDb=null)}readAll(){return S(this,null,function*(){let e=yield this.getDb(this.dbName),r=new Map,i=e.transaction(["data"],"readonly").objectStore("data");return new Promise((o,a)=>{let p=i.openCursor(IDBKeyRange.lowerBound(-1));p.onerror=a,p.onsuccess=c=>{let M=c.target.result;M?(r.set(M.key,M.value),M.continue()):o(r)}})})}write(e,r,i){return S(this,null,function*(){let o=(yield this.getDb(this.dbName)).transaction(["data"],"readwrite"),a=o.objectStore("data");yield new Promise((p,c)=>{let M=a.get(0);M.onsuccess=x=>{if(i&&!function(A,D){if(A!=null&&D!=null){let L=new Uint8Array(A),G=new Uint8Array(D);for(let X=24;X<40;X++)if(L[X]!==G[X])return!1;return!0}return A==null&&D==null}(M.result,r))return this.onFallbackFailure&&!this.hasAlertedFailure&&(this.hasAlertedFailure=!0,this.onFallbackFailure()),void c(new Error("Fallback mode unable to write file changes"));for(let A of e)a.put(A.value,A.key);o.onsuccess=()=>p(),o.onerror=()=>c()},M.onerror=c})})}}class Mi{constructor(e,r){this.filename=e,this.dbName=this.filename.replace(/\//g,"-"),this.cachedFirstBlock=null,this.writeQueue=null,this.blocks=new Map,this.lockType=0,this.transferBlockOwnership=!1,this.persistance=new Ni(this.dbName,r)}readIfFallback(){return S(this,null,function*(){return this.transferBlockOwnership=!0,this.blocks=yield this.persistance.readAll(),this.readMeta()})}lock(e){return this.cachedFirstBlock=this.blocks.get(0),this.lockType=e,!0}unlock(e){return this.lockType>Ct&&e===Ct&&this.flush(),this.lockType=e,!0}delete(){let e=globalThis.indexedDB.deleteDatabase(this.dbName);e.onerror=()=>{console.warn(`Deleting ${this.filename} database failed`)},e.onsuccess=()=>{}}open(){this.writeQueue=[],this.lockType=0}close(){this.flush(),this.transferBlockOwnership?this.transferBlockOwnership=!1:this.blocks=new Map,this.persistance.closeDb()}readMeta(){let e=this.blocks.get(-1);if(e){let r=this.blocks.get(0);return{size:e.size,blockSize:rr(new Uint8Array(r))}}return null}writeMeta(e){this.blocks.set(-1,e),this.queueWrite(-1,e)}readBlocks(e,r){let i=[];for(let o of e)i.push({pos:o,data:this.blocks.get(fn(o,r))});return i}writeBlocks(e,r){for(let i of e){let o=fn(i.pos,r);this.blocks.set(o,i.data),this.queueWrite(o,i.data)}this.lockType<=Ct&&this.flush()}queueWrite(e,r){this.writeQueue.push({key:e,value:r})}flush(){this.writeQueue.length>0&&(this.persistance.write(this.writeQueue,this.cachedFirstBlock,this.lockType>Ct),this.writeQueue=[]),this.cachedFirstBlock=null}}class xi{constructor(e){this.onFallbackFailure=e}createFile(e){let r;r=typeof SharedArrayBuffer!="undefined"?new ki(e):new Mi(e,this.onFallbackFailure);let i=new Ei(e,r);return(Fe.env.NODE_ENV!=="production"||Fe.env.PERF_BUILD)&&(this._files==null&&(this._files=new Set),this._files.add(i)),i}startProfile(){for(let e of this._files)if(e.ops.writer){let r=e.ops.writer,i=e.ops.reader;r.string("profile-start"),r.finalize(),i.int32(),i.done()}}stopProfile(){for(let e of this._files)if(e.ops.writer){let r=e.ops.writer,i=e.ops.reader;r.string("profile-stop"),r.finalize(),i.int32(),i.done()}}}function N(t,e){if(tt)return tt;if(!t)throw new Error("must speciefic database file");return tt=new Promise((r,i)=>{(function(a,p="/sql-wasm.wasm"){return S(this,null,function*(){if(!je){je=yield pi({locateFile:()=>p});const x=new bi(je.FS,new xi);je.register_for_idb(x),je.FS.mkdir("/sql"),je.FS.mount(x,{},"/sql")}const c=`/sql/${a}`,M=new je.Database(c,{filename:!0});if(typeof SharedArrayBuffer=="undefined"){const x=je.FS.open(c,"a+");yield x.node.contents.readIfFallback(),je.FS.close(x)}return M.exec(`
    PRAGMA page_size=8192;
    PRAGMA journal_mode=MEMORY;
  `),M})})(t,e).then(a=>r(a)).catch(a=>i(a))}),tt}function dn(t,e,r=!1){return S(this,null,function*(){try{const i=function(o,a,p,c){return Le(o,a),o.exec(`
    SELECT * FROM 'chat_logs_${a}' ORDER BY send_time ${c?"ASC":"DESC"} LIMIT ${p}
    `)}(yield N(),t,e,r);return _(j(i[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}function hn(t){return S(this,null,function*(){try{const e=yield N(),r=(JSON.parse(t)||[]).map(o=>se(o));if(r.length===0)return _("");const i=function(o,a){const p=re.insert().into("local_conversations").setFieldsRows(a).toString();return o.exec(p)}(e,r);return _(i)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}function gn(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=re.insert().into("temp_cache_local_chat_logs").setFieldsRows(o).toString();return i.exec(a)}(e,JSON.parse(t).map(i=>se(i)));return _(r[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}self.$RefreshReg$=()=>{},self.$RefreshSig$=()=>()=>{};const pt=new Map,_n=self,R=new zt({event:new class{constructor(t){be(this,"_currentEndpoint"),be(this,"_targetEndpoint"),be(this,"_events"),be(this,"_originOnmessage"),be(this,"_receiveMessage"),be(this,"onerror",null),be(this,"config"),be(this,"sendAdapter"),be(this,"receiveAdapter"),this._events={},this._currentEndpoint=t.currentEndpoint,this._targetEndpoint=t.targetEndpoint,this._originOnmessage=null,this.config=t.config,this.receiveAdapter=t.receiveAdapter,this.sendAdapter=t.sendAdapter;const e=r=>{const i=this.receiveAdapter?this.receiveAdapter(r):r.data;if(i&&typeof i.event=="string"){const o=this._events[i.event]||[];if(o.length)return void o.forEach(a=>{a(...i.args||[])});this.onerror&&this.onerror(Te(Qe({},st.METHOD_NOT_FOUND),{data:i}))}};if(this._currentEndpoint.addEventListener)return"start"in this._currentEndpoint&&this._currentEndpoint.start&&this._currentEndpoint.start(),this._currentEndpoint.addEventListener("message",e,!1),void(this._receiveMessage=e);this._originOnmessage=this._currentEndpoint.onmessage,this._currentEndpoint.onmessage=r=>{this._originOnmessage&&this._originOnmessage(r),e(r)},this._receiveMessage=this._currentEndpoint.onmessage}emit(t,...e){const r={event:t,args:e},i=this.sendAdapter?this.sendAdapter(r,this._targetEndpoint):{data:r},o=i.data||r,a=this.config?typeof this.config=="function"?this.config(o,this._targetEndpoint)||{}:this.config||{}:{};Array.isArray(i.transfer)&&i.transfer.length&&(a.transfer=i.transfer),this._targetEndpoint.postMessage(o,a)}on(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)}off(t,e){if(!this._events[t])return;if(!e)return void(this._events[t]=[]);const r=this._events[t]||[];this._events[t]=r.filter(i=>i!==e)}destroy(){if(this._currentEndpoint.removeEventListener)this._currentEndpoint.removeEventListener("message",this._receiveMessage,!1);else try{this._currentEndpoint.onmessage=this._originOnmessage}catch(t){console.warn(t)}}}({currentEndpoint:_n,targetEndpoint:_n})});R.registerMethod("fileMapSet",(t,e)=>(pt.set(t,e),_(t))),R.registerMethod("fileMapClear",()=>(pt.clear(),_(""))),R.registerMethod("wasmOpen",t=>new Promise((e,r)=>{const i=pt.get(t);i?e(_(i.size)):r("file not found")})),R.registerMethod("wasmClose",t=>S(this,null,function*(){return new Promise(e=>{pt.delete(t),e(_(t))})})),R.registerMethod("wasmRead",(t,e,r)=>{const i=pt.get(t);if(!i)throw"file not found";const o=i.slice(e,e+r);return new Promise((a,p)=>{const c=new FileReader;c.onload=()=>{a(c.result)},c.onerror=()=>{p(c.error)},c.readAsArrayBuffer(o)})}),R.registerMethod("getUpload",function(t){return S(this,null,function*(){try{const e=function(i,o){return i.exec(`
        select * from local_uploads where part_hash = '${o}'  limit 1;
    `)}(yield N(),t),r=j(e[0],"CamelCase");if(r.length===0)throw`no upload with partHash = ${t}`;return _(r[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("insertUpload",function(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=re.insert().into("local_uploads").setFields(o).toString();return i.exec(a)}(e,se(le(JSON.parse(t))));return _(r)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("updateUpload",function(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=re.update().table("local_uploads").setFields(o).where(`part_hash = '${o.part_hash}'`).toString();return i.exec(a)}(e,se(le(JSON.parse(t))));return _(r)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteUpload",function(t){return S(this,null,function*(){try{const e=function(r,i){const o=re.delete().from("local_uploads").where(`part_hash = '${i}'`).toString();return r.exec(o)}(yield N(),t);return _(e)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("setSqlWasmPath",function(t){un=t}),R.registerMethod("initDB",function(t,e){return S(this,null,function*(){try{const r=yield N(`${e}${t}.sqlite`,un),i=[],o=function(f){return f.exec(`
        create table if not exists 'local_uploads' (
            'part_hash'   text,
            'upload_id'   varchar(1000),
            'upload_info'        varchar(2000),
            'expire_time' integer,
            'create_time' integer,
            PRIMARY KEY ('part_hash')
          )
      `)}(r),a=function(f){return f.exec(`
    create table if not exists 'local_stranger'
        (
            'user_id'             varchar(64),
            'name'                varchar(255),
            'face_url'            varchar(255),
            'create_time'         integer,
            'app_manger_level'    integer,
            'ex'                  varchar(1024),
            'attached_info'       varchar(1024),
            'global_recv_msg_opt' integer,
            PRIMARY KEY ('user_id')
        )
      `)}(r),p=function(f){return f.exec(`
      create table if not exists 'local_conversations' (
            'conversation_id' char(128),
            'conversation_type' integer,
            'user_id' char(64),
            'group_id' char(128),
            'show_name' varchar(255),
            'face_url' varchar(255),
            'recv_msg_opt' integer,
            'unread_count' integer,
            'group_at_type' integer,
            'latest_msg' varchar(1000),
            'latest_msg_send_time' integer,
            'draft_text' text,
            'draft_text_time' integer,
            'is_pinned' numeric,
            'burn_duration' integer,
            'is_private_chat' numeric,
            'is_not_in_group' numeric,
            'update_unread_count_time' integer,
            'attached_info' varchar(1024),
            'ex' varchar(1024),
            'max_seq' integer,
            'min_seq' integer,
            'has_read_seq' integer,
            'msg_destruct_time' integer default 604800,
            'is_msg_destruct' numeric default false,
            primary key ('conversation_id')
        )
    `)}(r),c=function(f){return f.exec(`
      create table if not exists 'local_users' (
            'user_id' varchar(64),
            'name' varchar(255),
            'face_url' varchar(255),
            'create_time' integer,
            'app_manger_level' integer,
            'ex' varchar(1024),
            'attached_info' varchar(1024),
            'global_recv_msg_opt' integer,
             primary key ('user_id')
        )
    `)}(r),M=function(f){return f.exec(`
      create table if not exists 'local_blacks' (
        'owner_user_id'     varchar(64),
        'block_user_id'     varchar(64),
        'nickname'         varchar(255),
        'face_url'         varchar(255),
        'gender'           INTEGER,
        'create_time'      INTEGER,
        'add_source'      INTEGER,
        'operator_user_id'   varchar(64),
        'ex'              varchar(1024),
        'attached_info'     varchar(1024),
        primary key  ('owner_user_id', 'block_user_id')
    ) 
      `)}(r),x=function(f){return f.exec(`
      create table if not exists 'local_friends'
      (
          'owner_user_id'    varchar(64),
          'friend_user_id'   varchar(64),
          'remark'           varchar(255),
          'create_time'      INTEGER,
          'add_source'       INTEGER,
          'operator_user_id' varchar(64),
          'name'             varchar(255),
          'face_url'         varchar(255),
          'ex'               varchar(1024),
          'attached_info'    varchar(1024),
          'is_pinned'        numeric,
          primary key ('owner_user_id', 'friend_user_id')
      )       
      `)}(r),A=function(f){return f.exec(`
      create table if not exists 'local_groups'
      (
          'group_id'                 varchar(64) PRIMARY KEY,
          'name'                  TEXT,
          'notification'            varchar(255),
          'introduction'            varchar(255),
          'face_url'           varchar(255),
          'create_time'             INTEGER,
          'status'              INTEGER,
          'creator_user_id'      varchar(64),
          'group_type'              INTEGER,
          'owner_user_id'          varchar(64),
          'member_count'            INTEGER,
          'ex'                   varchar(1024),
          'attached_info'           varchar(1024),
          'need_verification'     INTEGER,
          'look_member_info'     INTEGER,
          'apply_member_friend'      INTEGER,
          'notification_update_time' INTEGER,
          'notification_user_id'   TEXT,
          'display_is_read'        numeric
      )  
      `)}(r),D=function(f){return f.exec(`
    create table if not exists "local_group_requests" (
        "group_id" varchar(64),
        "group_name" text,
        "notification" varchar(255),
        "introduction" varchar(255),
        "face_url" varchar(255),
        "create_time" integer,
        "status" integer,
        "creator_user_id" varchar(64),
        "group_type" integer,
        "owner_user_id" varchar(64),
        "member_count" integer,
        "user_id" varchar(64),
        "nickname" varchar(255),
        "user_face_url" varchar(255),
        "gender" integer,
        "handle_result" integer,
        "req_msg" varchar(255),
        "handle_msg" varchar(255),
        "req_time" integer,
        "handle_user_id" varchar(64),
        "handle_time" integer,
        "ex" varchar(1024),
        "attached_info" varchar(1024),
        "join_source" integer,
        "inviter_user_id" text,
        PRIMARY KEY ("group_id", "user_id")
      );
      `)}(r),L=function(f){return f.exec(`
      create table if not exists 'local_group_members' (
        'group_id' varchar(64),
        'user_id' varchar(64),
        'nickname' varchar(255),
        'user_group_face_url' varchar(255),
        'role_level' integer,
        'join_time' integer,
        'join_source' integer,
        'inviter_user_id' text,
        'mute_end_time' integer DEFAULT 0,
        'operator_user_id' varchar(64),
        'ex' varchar(1024),
        'attached_info' varchar(1024),
        PRIMARY KEY ('group_id', 'user_id')
    ) 
      `)}(r),G=function(f){return f.exec(`
    create table if not exists "local_admin_group_requests" (
        "group_id" varchar(64),
        "group_name" text,
        "notification" varchar(255),
        "introduction" varchar(255),
        "face_url" varchar(255),
        "create_time" integer,
        "status" integer,
        "creator_user_id" varchar(64),
        "group_type" integer,
        "owner_user_id" varchar(64),
        "member_count" integer,
        "user_id" varchar(64),
        "nickname" varchar(255),
        "user_face_url" varchar(255),
        "gender" integer,
        "handle_result" integer,
        "req_msg" varchar(255),
        "handle_msg" varchar(255),
        "req_time" integer,
        "handle_user_id" varchar(64),
        "handle_time" integer,
        "ex" varchar(1024),
        "attached_info" varchar(1024),
        "join_source" integer,
        "inviter_user_id" text,
        PRIMARY KEY ("group_id", "user_id")
      );
      `)}(r),X=function(f){return f.exec(`
      create table if not exists 'local_friend_requests'
      (
          'from_user_id'    varchar(64),
          'from_nickname'   varchar(255),
          'from_face_url'   varchar(255),
          'to_user_id'   varchar(64),
          'to_nickname'   varchar(255),
          'to_face_url'     varchar(255),
          'handle_result'    INTEGER,
          'req_msg'        varchar(255),
          'create_time'   INTEGER,
          'handler_user_id'  varchar(64),
          'handle_msg'    varchar(255),
          'handle_time'    INTEGER,
          'ex'           varchar(1024),
          'attached_info'   varchar(1024),
          primary key ('from_user_id', 'to_user_id')
      );  
      `)}(r),te=function(f){return f.exec(`
      create table if not exists 'local_super_groups' (
            'group_id' varchar(64),
            'name' text,
            'notification' varchar(255),
            'introduction' varchar(255),
            'face_url' varchar(255),
            'create_time' integer,
            'status' integer,
            'creator_user_id' varchar(64),
            'group_type' integer,
            'owner_user_id' varchar(64),
            'member_count' integer,
            'ex' varchar(1024),
            'attached_info' varchar(1024),
            'need_verification' integer,
            'look_member_info' integer,
            'apply_member_friend' integer,
            'notification_update_time' integer,
            'notification_user_id' text,
        primary key ('group_id')
     )
    `)}(r),U=function(f){return f.exec(`
    create table if not exists 'temp_cache_local_chat_logs' (
        'client_msg_id' char(64),
        'server_msg_id' char(64),
        'send_id' char(64),
        'recv_id' char(64),
        'sender_platform_id' integer,
        'sender_nick_name' varchar(255),
        'sender_face_url' varchar(255),
        'session_type' integer,
        'msg_from' integer,
        'content_type' integer,
        'content' varchar(1000),
        'is_read' numeric,
        'status' integer,
        'seq' integer DEFAULT 0,
        'send_time' integer,
        'create_time' integer,
        'attached_info' varchar(1024),
        'ex' varchar(1024),
        PRIMARY KEY ('client_msg_id')
      );
      `)}(r),m=function(f){return f.exec(`
    create table if not exists 'local_notification_seqs'
        (
            'conversation_id' char(128),
            'seq'             integer,
            PRIMARY KEY ('conversation_id')
        )
      `)}(r),P=function(f){return f.exec(`
      create table if not exists 'local_sending_messages'
        (
            conversation_id varchar(128),
            client_msg_id   varchar(64),
            ex              varchar(1024),
            PRIMARY KEY ('conversation_id', 'client_msg_id')
        );
        `)}(r),O=function(f){return f.exec(`
      create table if not exists 'local_conversation_unread_messages' (
            'conversation_id' char(128),
            'client_msg_id' char(64),
            'send_time' integer,
            'ex' varchar(1024),
            primary key (
                'conversation_id',
                'client_msg_id'
            )
        );
    `)}(r),v=function(f){return f.exec(`
      create table if not exists 'local_app_sdk_version' (
        'version'         varchar(255),
        'installed'       numeric,
        primary key  ('version')
    ) 
      `)}(r),d=function(f){return f.exec(`
      create table if not exists 'local_sync_version' (
        'table_name'         varchar(255),
        'entity_id'         varchar(255),
        'version_id'         text,
        'version'         integer,
        'create_time'         integer,
        'id_list'         text,
        primary key  ('table_name','entity_id')
    ) 
      `)}(r);return function(f){(function(g){try{g.exec(`
        ALTER TABLE local_friends ADD COLUMN is_pinned numeric;
        `)}catch(b){}})(f),function(g){try{g.exec(`
        ALTER TABLE local_groups ADD COLUMN display_is_read numeric;
        `)}catch(b){}}(f),function(g){try{g.exec(`
        ALTER TABLE local_app_sdk_version ADD COLUMN installed numeric;
        `)}catch(b){}}(f)}(r),i.push(o,a,p,c,te,O,M,x,A,L,X,D,G,U,m,P,v,d),_(i)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("close",function(){return S(this,null,function*(){try{return yield function(){return S(this,null,function*(){tt&&((yield tt).close(),tt=void 0)})}(),_("")}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getMessage",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return Le(i,o),i.exec(`
    SELECT * FROM 'chat_logs_${o}' WHERE client_msg_id = '${a}' limit 1
    `)}(yield N(),t,e);return r.length===0?_("",k.ErrorNoRecord,`no message with id ${e}`):_(j(r[0],"CamelCase",["isRead","isReact","isExternalExtensions"])[0])}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getMultipleMessage",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
    SELECT * FROM 'chat_logs_${o}' WHERE client_msg_id in (${a.map(p=>`'${p}'`).join(",")}) order by send_time desc;
    `)}(yield N(),t,JSON.parse(e));return _(j(r[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getSendingMessageList",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
    SELECT * FROM 'chat_logs_${i}' WHERE status = 1;
    `)}(yield N(),t);return _(j(e[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("updateMessageTimeAndStatus",function(t,e,r,i,o){return S(this,null,function*(){try{const a=yield N(),p=function(c,M,x,A,D,L){return c.exec(`
    UPDATE 'chat_logs_${M}' SET server_msg_id = '${A}', send_time = ${D}, status = ${L} WHERE client_msg_id = '${x}' and seq=0;
    `)}(a,t,e,r,i,o);if(a.getRowsModified()===0)throw"updateMessageTimeAndStatus no record updated";return _(p)}catch(a){return console.error(a),_(void 0,k.ErrorInit,JSON.stringify(a))}})}),R.registerMethod("updateMessage",function(t,e,r){return S(this,null,function*(){try{const i=yield N(),o=function(a,p,c,M){const x=re.update().table(`'chat_logs_${p}'`).setFields(M).where(`client_msg_id = '${c}'`).toString();return a.exec(x)}(i,t,e,se(le(JSON.parse(r))));if(i.getRowsModified()===0)throw"updateMessage no record updated";return _(o)}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("updateMessageBySeq",function(t,e,r){return S(this,null,function*(){try{const i=yield N(),o=function(a,p,c,M){const x=re.update().table(`'chat_logs_${p}'`).setFields(M).where(`seq = '${c}'`).toString();return a.exec(x)}(i,t,e,se(le(JSON.parse(r))));if(i.getRowsModified()===0)throw"updateMessageBySeq no record updated";return _(o)}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("updateColumnsMessage",function(t,e,r){return S(this,null,function*(){try{const i=yield N(),o=function(a,p,c,M){const x=re.update().table(`'chat_logs_${p}'`).setFields(M).where(`client_msg_id = '${c}'`).toString();return a.exec(x)}(i,t,e,se(le(JSON.parse(r))));if(i.getRowsModified()===0)throw"updateMessage no record updated";return _(o)}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("insertMessage",function(t,e){return S(this,null,function*(){try{const r=yield N(),i=function(o,a,p){const c=re.insert().into(`'chat_logs_${a}'`).setFields(p).toString();return o.exec(c)}(r,t,se(JSON.parse(e)));return _(i)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("batchInsertMessageList",function(t,e){return S(this,null,function*(){try{const r=yield N(),i=function(o,a,p){Le(o,a);const c=re.insert().into(`'chat_logs_${a}'`).setFieldsRows(p).toString();return o.exec(c)}(r,t,JSON.parse(e).map(o=>se(o)));return _(i)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getMessageList",function(t,e,r,i=!1){return S(this,null,function*(){if(r<=0)return dn(t,e,i);try{const o=function(a,p,c,M,x){return a.exec(`
    SELECT * FROM 'chat_logs_${p}' WHERE send_time ${x?">":"<"} ${M} ORDER BY send_time ${x?"ASC":"DESC"} LIMIT ${c}
    `)}(yield N(),t,e,r,i);return _(j(o[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(o){return console.error(o),_(void 0,k.ErrorInit,JSON.stringify(o))}})}),R.registerMethod("getMessageListNoTime",dn),R.registerMethod("messageIfExists",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
      SELECT * FROM 'chat_logs_${o}' WHERE client_msg_id = '${a}';
      `)}(yield N(),t,e);return _(r.length!==0)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("searchMessageByKeyword",function(t,e,r,i,o,a,p,c){return S(this,null,function*(){try{const M=function(x,A,D,L,G,X,te,U,m){const P=te||new Date().getTime();let O="";const v=D.map(f=>`${f}`).join(","),d=G===0?"or ":"and ";return L.forEach((f,g)=>{g==0&&(O+="And ("),g+1>=L.length?O+="content like '%"+L[g]+"%') ":O+="content like '%"+L[g]+"%' "+d}),x.exec(`  
    SELECT * FROM 'chat_logs_${A}' 
          WHERE send_time  between ${X} and ${P} 
          AND status <=3  
          And content_type IN (${v}) 
          ${O}
    ORDER BY send_time DESC LIMIT ${m} OFFSET ${U};
    `)}(yield N(),t,JSON.parse(e),JSON.parse(r),i,o,a,p,c);return _(j(M[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(M){return console.error(M),_(void 0,k.ErrorInit,JSON.stringify(M))}})}),R.registerMethod("searchMessageByContentType",function(t,e,r,i,o,a){return S(this,null,function*(){try{const p=function(c,M,x,A,D,L,G){const X=x.map(U=>`${U}`).join(","),te=D||new Date().getTime();return c.exec(`  
    SELECT * FROM 'chat_logs_${M}' 
          WHERE send_time between ${A} and ${te} 
          AND status <=3 
          And content_type IN (${X}) 
    ORDER BY send_time DESC LIMIT ${G} OFFSET ${L};
    `)}(yield N(),t,JSON.parse(e),r,i,o,a);return _(j(p[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(p){return console.error(p),_(void 0,k.ErrorInit,JSON.stringify(p))}})}),R.registerMethod("searchMessageByContentTypeAndKeyword",function(t,e,r,i,o,a){return S(this,null,function*(){try{const p=function(c,M,x,A,D,L,G){const X=x.map(P=>`${P}`).join(","),te=G||new Date().getTime();let U="";const m=D===0?"or ":"and ";return A.forEach((P,O)=>{O==0&&(U+="And ("),O+1>=A.length?U+="content like '%"+A[O]+"%') ":U+="content like '%"+A[O]+"%' "+m}),c.exec(`  
      SELECT * FROM 'chat_logs_${M}' 
            WHERE send_time between ${L} and ${te} 
            AND status <=3 
            And content_type IN (${X}) 
            ${U}
      ORDER BY send_time DESC;
      `)}(yield N(),t,JSON.parse(e),JSON.parse(r),i,o,a);return _(j(p[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(p){return console.error(p),_(void 0,k.ErrorInit,JSON.stringify(p))}})}),R.registerMethod("updateMsgSenderFaceURLAndSenderNickname",function(t,e,r,i){return S(this,null,function*(){try{return function(o,a,p,c,M){Le(o,a),o.exec(`
      UPDATE 'chat_logs_${a}' SET sender_face_url = '${c}', sender_nick_name = '${M}' WHERE send_id = '${p}';
      `)}(yield N(),t,e,r,i),_("")}catch(o){return console.error(o),_(void 0,k.ErrorInit,JSON.stringify(o))}})}),R.registerMethod("getAlreadyExistSeqList",function(t,e){return S(this,null,function*(){var r;try{const i=function(o,a,p){return o.exec(`
    SELECT seq FROM 'chat_logs_${a}' WHERE seq in (${p.join(",")})
    `)}(yield N(),t,JSON.parse(e));return _((r=j(i[0],"CamelCase",["isRead","isReact","isExternalExtensions"]).map(o=>o.seq))!==null&&r!==void 0?r:[])}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("getMessageBySeq",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return Le(i,o),i.exec(`
    SELECT * FROM 'chat_logs_${o}' WHERE seq = ${a} limit 1;
    `)}(yield N(),t,e);return r.length===0?_("",k.ErrorNoRecord,`no message with seq ${e}`):_(j(r[0],"CamelCase",["isRead","isReact","isExternalExtensions"])[0])}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getMessagesByClientMsgIDs",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
    SELECT * FROM 'chat_logs_${o}' WHERE client_msg_id in (${a.map(p=>`'${p}'`).join(",")}) order by send_time desc;
    `)}(yield N(),t,JSON.parse(e));return r.length===0?_("",k.ErrorNoRecord,`no message with clientMsgIDListStr ${e}`):_(j(r[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getMessagesBySeqs",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return Le(i,o),i.exec(`
    SELECT * FROM 'chat_logs_${o}' WHERE seq in (${a.join(",")}) order by send_time desc;
    `)}(yield N(),t,JSON.parse(e));return _(j(r[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getConversationNormalMsgSeq",function(t){return S(this,null,function*(){var e,r;try{const i=function(o,a){return Le(o,a),o.exec(`
      SELECT seq FROM 'chat_logs_${a}' order by seq desc limit 1;
      `)}(yield N(),t);return _((r=(e=j(i[0],"CamelCase")[0])===null||e===void 0?void 0:e.seq)!==null&&r!==void 0?r:0)}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("getConversationPeerNormalMsgSeq",function(t,e){return S(this,null,function*(){var r,i;try{const o=function(a,p,c){return a.exec(`
      SELECT seq FROM 'chat_logs_${p}' where send_id != '${c}' order by seq desc limit 1;
      `)}(yield N(),t,e);return _((i=(r=j(o[0],"CamelCase")[0])===null||r===void 0?void 0:r.seq)!==null&&i!==void 0?i:0)}catch(o){return console.error(o),_(void 0,k.ErrorInit,JSON.stringify(o))}})}),R.registerMethod("deleteConversationAllMessages",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`
      DELETE FROM 'chat_logs_${r}' WHERE 1=1;
      `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("markDeleteConversationAllMessages",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`
      UPDATE 'chat_logs_${r}' SET status = 2 WHERE (1=1) and (conversation_id = '${r}')';
      `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getUnreadMessage",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
      SELECT * FROM 'chat_logs_${o}' WHERE send_id != '${a}' and is_read = 0;
      `)}(yield N(),t,e);return _(j(r[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("markConversationMessageAsReadBySeqs",function(t,e,r){return S(this,null,function*(){try{const i=yield N();return function(o,a,p,c){Le(o,a);const M=p.map(x=>`${x}`).join(",");o.exec(`
      UPDATE 'chat_logs_${a}' SET is_read = 1 WHERE seq IN (${M}) and send_id != '${c}';
      `)}(i,t,JSON.parse(e),r),_(i.getRowsModified())}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("markConversationMessageAsRead",function(t,e,r){return S(this,null,function*(){try{const i=yield N();return function(o,a,p,c){const M=p.map(x=>`'${x}'`).join(",");o.exec(`
      UPDATE 'chat_logs_${a}' SET is_read = 1 WHERE client_msg_id IN (${M}) and send_id != '${c}';
      `)}(i,t,JSON.parse(e),r),_(i.getRowsModified())}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("deleteConversationMsgs",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){const p=a.map(c=>`'${c}'`).join(",");return i.exec(`
      DELETE FROM 'chat_logs_${o}' WHERE client_msg_id IN (${p});
      `)}(yield N(),t,JSON.parse(e));return _(r)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("markConversationAllMessageAsRead",function(t,e){return S(this,null,function*(){try{const r=yield N();return function(i,o,a){i.exec(`
      UPDATE 'chat_logs_${o}' SET is_read = 1 WHERE is_read = 0 and send_id != '${a}';
      `)}(r,t,JSON.parse(e)),_(r.getRowsModified())}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("searchAllMessageByContentType",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
      SELECT * FROM 'chat_logs_${o}' WHERE content_type = ${a};
      `)}(yield N(),t,JSON.parse(e));return _(j(r[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("insertSendingMessage",function(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=re.insert().into("local_sending_messages").setFields(o).toString();return i.exec(a)}(e,se(JSON.parse(t)));return _(r)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteSendingMessage",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){const p=re.delete().from("local_sending_messages").where(`conversation_id = '${o}'`).where(`client_msg_id = '${a}'`).toString();return i.exec(p)}(yield N(),t,e);return _(r)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getAllSendingMessages",function(){return S(this,null,function*(){try{const t=function(e){const r=re.select().from("local_sending_messages").toString();return e.exec(r)}(yield N());return _(j(t[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getLatestActiveMessage",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){Le(i,o);const p=a?"ASC":"DESC";return i.exec(`
      SELECT * FROM 'chat_logs_${o}' WHERE status < 4 ORDER BY send_time ${p};
    `)}(yield N(),t,e);return _(j(r[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getAllConversationList",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
        select * from local_conversations where latest_msg_send_time > 0 order by case when is_pinned=1 then 0 else 1 end,max(latest_msg_send_time,draft_text_time) desc;
    `)}(yield N());return _(j(t[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getAllConversationListToSync",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
        select * from local_conversations;
    `)}(yield N());return _(j(t[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getHiddenConversationList",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
        select * from local_conversations where latest_msg_send_time = 0;
    `)}(yield N());return _(j(t[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getConversation",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
        select * from local_conversations where conversation_id = '${i}' limit 1;
    `)}(yield N(),t);return e.length===0?_("",k.ErrorNoRecord,`no conversation with id ${t}`):_(j(e[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"])[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getMultipleConversation",function(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=o.map(p=>`'${p}'`);return i.exec(`
        select * from local_conversations where conversation_id in (${a.join(",")});
    `)}(e,JSON.parse(t));return _(j(r[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("updateColumnsConversation",function(t,e){return S(this,null,function*(){try{const r=yield N();let i=e;typeof e=="string"&&(i=se(le(JSON.parse(e))));const o=function(a,p,c){const M=re.update().table("local_conversations").setFields(c).where(`conversation_id = '${p}'`).toString();return a.exec(M)}(r,t,i);if(r.getRowsModified()===0)throw"updateColumnsConversation no record updated";return _(o)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("decrConversationUnreadCount",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){i.exec("begin"),i.exec(`
        update local_conversations set 
            unread_count=unread_count-${a} 
        where conversation_id = '${o}';
    `);const p=i.exec(`select unread_count from local_conversations where conversation_id = '${o}'`);return Number(p[0].values[0])<0&&i.exec(`
          update local_conversations set 
              unread_count=0 
          where conversation_id = '${o}';
      `),i.exec("commit")}(yield N(),t,e);return _(r)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("batchInsertConversationList",hn),R.registerMethod("getTotalUnreadMsgCount",function(){return S(this,null,function*(){var t,e,r;try{const i=function(o){return o.exec(`
        select sum(unread_count) from local_conversations where recv_msg_opt < 2 and latest_msg_send_time > 0;
    `)}(yield N());return _((r=(e=(t=i[0])===null||t===void 0?void 0:t.values[0])===null||e===void 0?void 0:e[0])!==null&&r!==void 0?r:0)}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("insertConversation",function(t){return S(this,null,function*(){return hn(`[${t}]`)})}),R.registerMethod("getConversationByUserID",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
        select * from local_conversations where user_id = "${i}" limit 1;
    `)}(yield N(),t);return e.length===0?_("",k.ErrorNoRecord,`no conversation with userID ${t}`):_(j(e[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"])[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getConversationListSplit",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
    SELECT *
    FROM local_conversations
    WHERE latest_msg_send_time > 0
    ORDER BY case
                 when is_pinned = 1 then 0
                 else 1 end, max(latest_msg_send_time, draft_text_time) DESC
    LIMIT ${a} OFFSET ${o}
    `)}(yield N(),t,e);return _(j(r[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("deleteConversation",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`
    DELETE
      FROM local_conversations
      WHERE conversation_id = "${r}"
  `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteAllConversation",function(){return S(this,null,function*(){try{return function(t){t.exec(`
    DELETE FROM local_conversations;
  `)}(yield N()),_("")}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("batchUpdateConversationList",function(t){return S(this,null,function*(){try{const e=yield N(),r=(JSON.parse(t)||[]).map(i=>se(i));return r.length===0||r.forEach(i=>{(function(o,a){const p=re.update().table("local_conversations").setFields(a).where(`conversation_id = '${a.conversation_id}'`).toString();o.exec(p)})(e,i)}),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("conversationIfExists",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
  SELECT count(*)
  FROM local_conversations
  WHERE conversation_id = "${i}"
  `)}(yield N(),t);return _(e.length!==0)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("resetConversation",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`
  UPDATE local_conversations
    SET unread_count=0,
    latest_msg="",
    latest_msg_send_time=0,
    draft_text="",
    draft_text_time=0
WHERE conversation_id = "${r}"
  `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("resetAllConversation",function(){return S(this,null,function*(){try{return function(t){t.exec(`
  UPDATE local_conversations
    SET unread_count=0,
    latest_msg="",
    latest_msg_send_time=0,
    draft_text="",
    draft_text_time=0
  `)}(yield N()),_("")}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("clearConversation",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`
  UPDATE local_conversations
SET unread_count=0,
    latest_msg="",
    draft_text="",
    draft_text_time=0
WHERE conversation_id = "${r}"
  `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("clearAllConversation",function(){return S(this,null,function*(){try{return function(t){t.exec(`
  UPDATE local_conversations
SET unread_count=0,
    latest_msg="",
    draft_text="",
    draft_text_time=0
  `)}(yield N()),_("")}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("setConversationDraft",function(t,e){return S(this,null,function*(){try{return function(r,i,o){const a=new Date().getTime();r.exec(`
  update local_conversations
    set draft_text='${o}',
    draft_text_time=${a},
    latest_msg_send_time=case when latest_msg_send_time = 0 then ${a} else latest_msg_send_time end
    where conversation_id = "${i}"
  `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("removeConversationDraft",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
  update local_conversations
    set draft_text="${o}",
    draft_text_time=0
    where conversation_id = "${i}"
  `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("unPinConversation",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
  update local_conversations
    set is_pinned=${o},
    draft_text_time=case when draft_text = "" then 0 else draft_text_time end
    where conversation_id = "${i}"
  `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("incrConversationUnreadCount",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
        update local_conversations set 
            unread_count=unread_count+1 
        where conversation_id = '${i}';
    `)}(yield N(),t);return _(e)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("setMultipleConversationRecvMsgOpt",function(t,e){return S(this,null,function*(){try{return function(r,i,o){const a=i.map(p=>`'${p}'`).join(",");r.exec(`
    UPDATE local_conversations
    SET recv_msg_opt=${o}
    WHERE conversation_id IN (${a})
    `)}(yield N(),JSON.parse(t),e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("findAllUnreadConversationConversationID",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
        select conversation_id from local_conversations where unread_count > 0;
    `)}(yield N());return _(j(t[0],"CamelCase").map(e=>e.conversationID))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getAllSingleConversationIDList",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
        select conversation_id from local_conversations where conversation_type = 1;
    `)}(yield N());return _(j(t[0],"CamelCase").map(e=>e.conversationID))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getAllConversationIDList",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
        select conversation_id from local_conversations;
    `)}(yield N());return _(j(t[0],"CamelCase").map(e=>e.conversationID))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getAllConversations",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
    SELECT * FROM local_conversations
    `)}(yield N());return _(j(t[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("searchConversations",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
    SELECT * FROM local_conversations
    WHERE show_name LIKE '%${i}%'
    ORDER BY latest_msg_send_time DESC
    `)}(yield N(),t);return _(j(e[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getLoginUser",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
        select *, name as nickname from local_users where user_id = '${i}'  limit 1;
    `)}(yield N(),t);return e.length===0?_("",k.ErrorNoRecord,`no login user with id ${t}`):_(j(e[0],"CamelCase",[],{name:"nickname"})[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("insertLoginUser",function(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=re.insert().into("local_users").setFields(o).toString();return i.exec(a)}(e,se(le(JSON.parse(t),{nickname:"name"})));return _(r)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("updateLoginUser",function(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=re.update().table("local_users").setFields(o).where(`user_id = '${o.user_id}'`).toString();return i.exec(a)}(e,se(le(JSON.parse(t),{nickname:"name"})));if(e.getRowsModified()===0)throw"updateLoginUser no record updated";return _(r)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getStrangerInfo",function(t){return S(this,null,function*(){try{const e=yield N();return _(j(Sr(e,JSON.parse(t))[0],"CamelCase",[],{name:"nickname"}))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("setStrangerInfo",function(t){try{return JSON.parse(t).map(e=>se(le(e,{nickname:"name"}))).map(e=>function(r){return S(this,null,function*(){try{const i=yield N(),o=Sr(i,[r.user_id]);return j(o[0]).length?function(a,p){const c=re.update().table("local_stranger").setFields(p).where(`user_id = '${p.user_id}'`).toString();a.exec(c)}(i,r):function(a,p){const c=re.insert().into("local_stranger").setFields(p).toString();a.exec(c)}(i,r),_("")}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}(e)),Promise.resolve(_(""))}catch(e){return console.error(e),Promise.resolve(_(void 0,k.ErrorInit,JSON.stringify(e)))}}),R.registerMethod("getAppSDKVersion",function(){return S(this,null,function*(){try{const t=kr(yield N());return t.length===0?_("",k.ErrorNoRecord,"no app version with database"):_(j(t[0],"CamelCase",["installed"])[0])}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("setAppSDKVersion",function(t){return S(this,null,function*(){try{const e=yield N(),r=se(le(JSON.parse(t))),i=j(kr(e)[0],"CamelCase",["installed"]);return i[0]&&i[0].version?(function(o,a,p){const c=re.update().table("local_app_sdk_version").setFields(p).where(`version = '${a}'`).toString();o.exec(c)}(e,i[0].version,r),_("")):(function(o,a){const p=re.insert().into("local_app_sdk_version").setFields(a).toString();o.exec(p)}(e,r),_(""))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getVersionSync",function(t,e){return S(this,null,function*(){try{const r=Rr(yield N(),t,e);if(r.length===0)return _("",k.ErrorNoRecord,`no sync version with tableName ${t}, entityID ${e}`);const i=j(r[0],"CamelCase",[],{id_list:"uidList"})[0];return i.uidList=JSON.parse(i.uidList),_(i)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("setVersionSync",function(t){return S(this,null,function*(){try{const e=yield N(),r=se(le(JSON.parse(t)));r.id_list=JSON.stringify(r.uid_list),delete r.uid_list;const i=j(Rr(e,r.table_name,r.entity_id)[0],"CamelCase",[]);return i[0]&&i[0].tableName?(function(o,a,p,c){delete c.table;const M=re.update().table("local_sync_version").setFields(c).where(`table_name = '${a}' AND entity_id = '${p}'`).toString();o.exec(M)}(e,i[0].tableName,i[0].entityID,r),_("")):(function(o,a){delete a.table;const p=re.insert().into("local_sync_version").setFields(a).toString();o.exec(p)}(e,r),_(""))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteVersionSync",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
    DELETE FROM local_sync_version WHERE table_name = "${i}" AND entity_id = "${o}";
    `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getJoinedSuperGroupList",function(){return S(this,null,function*(){try{const t=yield N();return _(j(br(t)[0]))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getJoinedSuperGroupIDList",function(){return S(this,null,function*(){try{const t=yield N(),e=j(br(t)[0]);return _(e.map(r=>r.groupID))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getSuperGroupInfoByGroupID",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
        select * from local_super_groups where group_id = '${i}'  LIMIT 1;
    `)}(yield N(),t);return e.length===0?_("",k.ErrorNoRecord,`no super group with id ${t}`):_(j(e[0])[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteSuperGroup",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
        delete from local_super_groups where group_id = '${i}';
    `)}(yield N(),t);return _(e)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("insertSuperGroup",function(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=re.insert().into("local_super_groups").setFields(o).toString();return i.exec(a)}(e,se(le(JSON.parse(t),{groupName:"name"})));return _(r)}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("updateSuperGroup",function(t,e){return S(this,null,function*(){try{const r=yield N(),i=function(o,a,p){const c=re.update().table("local_super_groups").setFields(p).where(`group_id = '${a}'`).toString();return o.exec(c)}(r,t,se(le(JSON.parse(e),{groupName:"name"})));if(r.getRowsModified()===0)throw"updateSuperGroup no record updated";return _(i)}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("deleteConversationUnreadMessageList",function(t,e){return S(this,null,function*(){try{const r=yield N();return function(i,o,a){i.exec(`
        delete from local_conversation_unread_messages where conversation_id = '${o}' and send_time <= ${a};
    `)}(r,t,e),_(r.getRowsModified())}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("batchInsertConversationUnreadMessageList",function(t){return S(this,null,function*(){try{const e=yield N(),r=function(i,o){const a=re.insert().into("local_conversation_unread_messages").setFieldsRows(o).toString();return i.exec(a)}(e,JSON.parse(t).map(i=>se(i)));return _(r[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getBlackList",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
      select *
      from local_blacks
      `)}(yield N());return _(j(t[0],"CamelCase",[],{block_user_id:"userID"}))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getBlackListUserID",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
    SELECT block_user_id
    FROM local_blacks
      `)}(yield N());return _(j(t[0],"CamelCase"))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getBlackInfoByBlockUserID",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
      SELECT *
        FROM local_blacks
        WHERE owner_user_id = "${a}"
          AND block_user_id = "${o}"
        LIMIT 1
      `)}(yield N(),t,e);return _(j(r[0],"CamelCase"))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getBlackInfoList",function(t){return S(this,null,function*(){try{const e=function(r,i){const o=i.map(a=>`'${a}'`);return r.exec(`
    select *
    from local_blacks
    where block_user_id in (${o.join(",")})
      `)}(yield N(),JSON.parse(t));return _(j(e[0],"CamelCase"))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("insertBlack",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.insert().into("local_blacks").setFields(i).toString();r.exec(o)}(e,se(le(JSON.parse(t),{userID:"block_user_id",name:"nickname"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteBlack",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
    delete
    from local_blacks
    where owner_user_id = "${o}"
    and block_user_id = "${i}"
      `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("updateBlack",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.update().table("local_blacks").setFields(i).where(`owner_user_id = '${i.owner_user_id}' and block_user_id = '${i.block_user_id}'`).toString();r.exec(o)}(e,se(le(JSON.parse(t)))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("insertFriendRequest",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.insert().into("local_friend_requests").setFields(i).toString();r.exec(o)}(e,se(le(JSON.parse(t)))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteFriendRequestBothUserID",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
      delete
      from local_friend_requests
      where from_user_id = "${i}"
        and to_user_id = "${o}"
      `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("updateFriendRequest",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.update().table("local_friend_requests").setFields(i).where(`from_user_id = '${i.from_user_id}' and to_user_id = '${i.to_user_id}'`).toString();r.exec(o)}(e,se(le(JSON.parse(t)))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getRecvFriendApplication",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
      select *
      from local_friend_requests
      where to_user_id = "${i}"
      order by create_time desc
      `)}(yield N(),t);return _(j(e[0],"CamelCase"))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getSendFriendApplication",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
      select * from local_friend_requests
      where from_user_id = "${i}"
      order by create_time desc
      `)}(yield N(),t);return _(j(e[0],"CamelCase"))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getFriendApplicationByBothID",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
      select *
        from local_friend_requests
        where from_user_id = "${o}"
        and to_user_id = "${a}"
        limit 1
      `)}(yield N(),t,e);return _(j(r[0],"CamelCase"))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getBothFriendReq",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
      select *
        from local_friend_requests
        where (from_user_id = "${o}"
        and to_user_id = "${a}")
        or (from_user_id = "${a}"
        and to_user_id = "${o}")
      `)}(yield N(),t,e);return _(j(r[0],"CamelCase"))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("insertGroup",function(t){return S(this,null,function*(){try{const e=yield N();return Er(e,se(le(JSON.parse(t),{groupName:"name"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteGroup",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`
    DELETE FROM local_groups 
          WHERE group_id="${r}" 
        `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("updateGroup",function(t,e){return S(this,null,function*(){try{const r=yield N();return function(i,o,a){const p=re.update().table("local_groups").setFields(a).where(`group_id = '${o}'`).toString();i.exec(p)}(r,t,se(le(JSON.parse(e),{groupName:"name"}))),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getJoinedGroupList",function(){return S(this,null,function*(){try{const t=yield N();return _(j(Ht(t)[0],"CamelCase",["displayIsRead"],{name:"groupName"}))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getGroupInfoByGroupID",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
    SELECT *
      FROM local_groups
      WHERE group_id = "${i}"
    `)}(yield N(),t);return e.length===0?_("",k.ErrorNoRecord,`no group with id ${t}`):_(j(e[0],"CamelCase",["displayIsRead"],{name:"groupName"})[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getAllGroupInfoByGroupIDOrGroupName",function(t,e,r){return S(this,null,function*(){try{const i=function(o,a,p,c){let M="";const x=`group_id like "%${a}%"`,A=`name like "%${a}%"`;return p&&(M=x),c&&(M=A),c&&p&&(M=x+" or "+A),o.exec(`
    select *
    from local_groups
    where ${M}
    order by create_time desc
    `)}(yield N(),t,e,r);return _(j(i[0],"CamelCase",["displayIsRead"],{name:"groupName"}))}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("subtractMemberCount",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`  
    update local_groups set member_count = member_count-1 where group_id = '${r}'
    `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("addMemberCount",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`  
    update local_groups set member_count = member_count+1 where group_id = '${r}'   
    `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getJoinedWorkingGroupIDList",function(){return S(this,null,function*(){try{const t=yield N(),e=j(Ht(t)[0],"CamelCase",["displayIsRead"]),r=[];return e.forEach(i=>{i.groupType===2&&r.push(i.groupID)}),_(JSON.stringify(r))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getJoinedWorkingGroupList",function(){return S(this,null,function*(){try{const t=Ht(yield N()),e=j(t[0],"CamelCase",["displayIsRead"],{name:"groupName"}).filter(r=>r.groupType===2);return _(JSON.stringify(e))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getGroupMemberAllGroupIDs",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
    select distinct group_id from local_group_members
    `)}(yield N());return _(j(t[0],"CamelCase",["displayIsRead"]).map(e=>e.groupID))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getGroups",function(t){return S(this,null,function*(){try{const e=function(i,o){const a=o.map(p=>`'${p}'`).join(",");return i.exec(`
    select * from local_groups where group_id in (${a});
    `)}(yield N(),JSON.parse(t)),r=j(e[0],"CamelCase",["displayIsRead"],{name:"groupName"});return _(JSON.stringify(r))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("batchInsertGroup",function(t){return S(this,null,function*(){try{const e=yield N();return JSON.parse(t).map(r=>{const i=se(le(r,{groupName:"name"}));return Er(e,i),null}),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteAllGroup",function(){return S(this,null,function*(){try{return function(t){t.exec(`
    DELETE FROM local_groups;
    `)}(yield N()),_("")}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getGroupMemberInfoByGroupIDUserID",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
      select *
      from local_group_members
      WHERE group_id = "${o}" 
      AND user_id = "${a}" 
      LIMIT 1
      `)}(yield N(),t,e);return _(j(r[0],"CamelCase",[],{user_group_face_url:"faceURL"})[0])}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getAllGroupMemberList",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
    SELECT *
    FROM local_group_members
      `)}(yield N());return _(j(t[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getAllGroupMemberUserIDList",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
      SELECT user_id
      FROM local_group_members
        `)}(yield N());return _(j(t[0],"CamelCase"))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("getGroupMemberCount",function(t){return S(this,null,function*(){var e,r;try{const i=function(o,a){return o.exec(`
    SELECT count(*) FROM local_group_members 
    WHERE group_id = "${a}" 
      `)}(yield N(),t);return _((r=(e=i[0])===null||e===void 0?void 0:e.values[0])===null||r===void 0?void 0:r[0])}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("getGroupSomeMemberInfo",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){const p=a.map(c=>`'${c}'`);return i.exec(`
    select *
    from local_group_members
    where group_id = "${o}"
    and user_id in (${p.join(",")})
      `)}(yield N(),t,JSON.parse(e));return _(j(r[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getGroupAdminID",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
    SELECT user_id FROM local_group_members 
    WHERE group_id = "${i}" 
    And role_level = 3
      `)}(yield N(),t);return _(j(e[0],"CamelCase").map(r=>r.userID))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getGroupMemberListByGroupID",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
      SELECT * FROM local_group_members 
      WHERE group_id = "${i}" 
        `)}(yield N(),t);return _(j(e[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getGroupMemberListSplit",function(t,e,r,i,o){return S(this,null,function*(){try{const a=function(p,c,M,x,A,D){let L=`
    SELECT * FROM local_group_members 
        WHERE group_id = "${c}" 
        ORDER BY role_level DESC,join_time ASC 
    LIMIT ${A} OFFSET ${x}
    `;return M===1&&(L=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${c}" 
            And role_level = 100 
        LIMIT ${A} OFFSET ${x}
        `),M===2&&(L=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${c}" 
            And role_level = 60 
        ORDER BY join_time ASC 
        LIMIT ${A} OFFSET ${x}
        `),M===3&&(L=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${c}" 
            And role_level = 20 
        ORDER BY join_time ASC 
        LIMIT ${A} OFFSET ${x}
        `),M===4&&(L=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${c}" 
            And ( role_level = 20 OR role_level = 60 )  
        ORDER BY role_level DESC,join_time ASC 
        LIMIT ${A} OFFSET ${x}
        `),M===5&&(L=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${c}" 
            And ( role_level = 100 OR role_level = 60 )  
        ORDER BY role_level DESC,join_time ASC 
        LIMIT ${A} OFFSET ${x}
        `),M===6&&(L=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${c}" 
            And user_id != "${D}" 
        LIMIT ${A} OFFSET ${x}
        `),p.exec(L)}(yield N(),t,e,r,i,o);return _(j(a[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(a){return console.error(a),_(void 0,k.ErrorInit,JSON.stringify(a))}})}),R.registerMethod("getGroupMemberOwnerAndAdmin",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
      SELECT * FROM local_group_members 
      WHERE group_id = "${i}" 
      And role_level > 1 
      ORDER BY role_level DESC
        `)}(yield N(),t);return _(j(e[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getGroupMemberOwner",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
      SELECT * FROM local_group_members 
      WHERE group_id = "${i}" 
      And role_level = 2
        `)}(yield N(),t);return _(j(e[0],"CamelCase",[],{user_group_face_url:"faceURL"})[0])}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getGroupMemberListSplitByJoinTimeFilter",function(t,e,r,i=0,o=1e11,a){return S(this,null,function*(){try{const p=function(c,M,x,A,D=0,L=1e11,G){let X="";return X=G.length===0?`
        SELECT * FROM local_group_members 
            WHERE group_id = "${M}" 
            And join_time  between ${D} and ${L}  
            ORDER BY join_time DESC 
            LIMIT ${A} OFFSET ${x}
        `:`
        SELECT * FROM local_group_members 
        WHERE group_id = "${M}" 
        And join_time  between ${D} and ${L}  
        And user_id NOT IN (${G.map(te=>`'${te}'`).join(",")})
        ORDER BY join_time DESC 
        LIMIT ${A} OFFSET ${x}
        `,c.exec(X)}(yield N(),t,e,r,i,o,JSON.parse(a));return _(j(p[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(p){return console.error(p),_(void 0,k.ErrorInit,JSON.stringify(p))}})}),R.registerMethod("getGroupOwnerAndAdminByGroupID",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
      SELECT * FROM local_group_members 
      WHERE group_id = "${i}" 
      And role_level > 1
        `)}(yield N(),t);return _(j(e[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getGroupMemberUIDListByGroupID",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
      SELECT user_id FROM local_group_members 
      WHERE group_id = "${i}" 
        `)}(yield N(),t);return _(j(e[0],"CamelCase").map(r=>r.userID))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("insertGroupMember",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.insert().into("local_group_members").setFields(i).toString();r.exec(o)}(e,se(le(JSON.parse(t),{faceURL:"user_group_face_url"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("batchInsertGroupMember",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.insert().into("local_group_members").setFieldsRows(i).toString();r.exec(o)}(e,(JSON.parse(t)||[]).map(r=>se(le(r,{faceURL:"user_group_face_url"})))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteGroupMember",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
    DELETE FROM local_group_members 
    WHERE group_id="${i}" 
    and user_id="${o}"
      `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("deleteGroupAllMembers",function(t){return S(this,null,function*(){try{return function(e,r){e.exec(`
      DELETE FROM local_group_members 
      WHERE group_id="${r}"
        `)}(yield N(),t),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("updateGroupMember",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.update().table("local_group_members").setFields(i).where(`group_id = '${i.group_id}' and user_id = '${i.user_id}'`).toString();r.exec(o)}(e,se(le(JSON.parse(t),{faceURL:"user_group_face_url"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("updateGroupMemberField",function(t,e,r){return S(this,null,function*(){try{const i=yield N();return function(o,a,p,c){const M=re.update().table("local_group_members").setFields(c).where(`group_id = '${a}' and user_id = '${p}'`).toString();o.exec(M)}(i,t,e,se(le(JSON.parse(r),{faceURL:"user_group_face_url"}))),_("")}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("searchGroupMembers",function(t,e,r,i,o,a){return S(this,null,function*(){try{const p=function(c,M,x,A,D,L,G){let X="";return X=x?A&&D?`
            SELECT * FROM local_group_members 
            WHERE ( user_id like "%${M}%" or nickname like "%${M}%"  ) 
            and group_id IN ("${x}")  
            ORDER BY join_time DESC 
            LIMIT ${G} OFFSET ${L}
            `:A||D?`
            SELECT * FROM local_group_members 
            WHERE ${A?`nickname like "%${M}%"`:`user_id like "%${M}%"`}
            and group_id IN ("${x}")  
            ORDER BY join_time DESC 
            LIMIT ${G} OFFSET ${L}
            `:`
        SELECT * FROM local_group_members 
        WHERE group_id IN ("${x}")  
        ORDER BY join_time DESC 
        LIMIT ${G} OFFSET ${L}
        `:A&&A?`
        SELECT * FROM local_group_members 
        WHERE user_id like "%${M}%" or nickname like "%${M}%"  
        ORDER BY join_time DESC 
        LIMIT ${G} OFFSET ${L}
        `:A||A?`
        SELECT * FROM local_group_members 
        WHERE ${A?`nickname like "%${M}%"`:`user_id like "%${M}%"`}  
        ORDER BY join_time DESC 
        LIMIT ${G} OFFSET ${L}
        `:`
        SELECT * FROM local_group_members 
        ORDER BY join_time DESC 
        LIMIT ${G} OFFSET ${L}
        `,c.exec(X)}(yield N(),t,e,r,i,o,a);return _(j(p[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(p){return console.error(p),_(void 0,k.ErrorInit,JSON.stringify(p))}})}),R.registerMethod("getUserJoinedGroupIDs",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
    select group_id from local_group_members where user_id = "${i}";
    `)}(yield N(),t);return _(j(e[0],"CamelCase").map(r=>r.groupID))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getGroupMemberListByUserIDs",function(t,e,r){return S(this,null,function*(){try{const i=function(o,a,p,c){const M=c.map(A=>`'${A}'`);let x=`
    SELECT * FROM local_group_members 
        WHERE group_id = "${a}" 
        And user_id IN (${M.join(",")})
        ORDER BY role_level DESC,join_time ASC 
    `;return p===1&&(x=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${a}" 
            And role_level = 100 
            And user_id IN (${M.join(",")})
        `),p===2&&(x=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${a}" 
            And role_level = 60 
            And user_id IN (${M.join(",")})
        ORDER BY join_time ASC 
        `),p===3&&(x=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${a}" 
            And role_level = 20 
            And user_id IN (${M.join(",")})
        ORDER BY join_time ASC 
        `),p===4&&(x=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${a}" 
            And ( role_level = 20 OR role_level = 60 )  
            And user_id IN (${M.join(",")})
        ORDER BY role_level DESC,join_time ASC 
        `),p===5&&(x=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${a}" 
            And ( role_level = 100 OR role_level = 60 )  
            And user_id IN (${M.join(",")})
        ORDER BY role_level DESC,join_time ASC 
        `),o.exec(x)}(yield N(),t,e,JSON.parse(r));return _(j(i[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("insertGroupRequest",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.insert().into("local_group_requests").setFields(i).toString();r.exec(o)}(e,se(le(JSON.parse(t),{groupFaceURL:"face_url",userFaceURL:"user_face_url",handledMsg:"handle_msg",handledTime:"handle_time"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteGroupRequest",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
        delete
        from local_group_requests
        where group_id = "${i}"
          and user_id = "${o}"
        `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("updateGroupRequest",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.update().table("local_group_requests").setFields(i).where(`group_id = '${i.group_id}' and user_id = '${i.user_id}'`).toString();r.exec(o)}(e,se(le(JSON.parse(t),{groupFaceURL:"face_url",userFaceURL:"user_face_url",handledMsg:"handle_msg",handledTime:"handle_time"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getSendGroupApplication",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
        select *
        from local_group_requests
        order by create_time desc
        `)}(yield N());return _(j(t[0],"CamelCase",[],{face_url:"groupFaceURL",user_face_url:"userFaceURL",handle_msg:"handledMsg",handle_time:"handledTime"}))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("insertAdminGroupRequest",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.insert().into("local_admin_group_requests").setFields(i).toString();r.exec(o)}(e,se(le(JSON.parse(t),{groupFaceURL:"face_url",userFaceURL:"user_face_url",handledMsg:"handle_msg",handledTime:"handle_time"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteAdminGroupRequest",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
        delete
        from local_admin_group_requests
        where group_id = "${i}"
          and user_id = "${o}"
        `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("updateAdminGroupRequest",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.update().table("local_admin_group_requests").setFields(i).where(`group_id = '${i.group_id}' and user_id = '${i.user_id}'`).toString();r.exec(o)}(e,se(le(JSON.parse(t),{groupFaceURL:"face_url",userFaceURL:"user_face_url",handledMsg:"handle_msg",handledTime:"handle_time"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getAdminGroupApplication",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
        select *
        from local_admin_group_requests
        order by create_time desc
        `)}(yield N());return _(j(t[0],"CamelCase",[],{face_url:"groupFaceURL",user_face_url:"userFaceURL",handle_msg:"handledMsg",handle_time:"handledTime"}))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("insertFriend",function(t){return S(this,null,function*(){try{const e=yield N();return wr(e,se(le(JSON.parse(t),{userID:"friend_user_id",nickname:"name"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteFriend",function(t,e){return S(this,null,function*(){try{return function(r,i,o){r.exec(`
    DELETE FROM local_friends 
          WHERE owner_user_id="${o}" 
          and friend_user_id="${i}"
        `)}(yield N(),t,e),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("updateFriend",function(t){return S(this,null,function*(){try{const e=yield N();return function(r,i){const o=re.update().table("local_friends").setFields(i).where(`owner_user_id = '${i.owner_user_id}' and friend_user_id = '${i.friend_user_id}'`).toString();r.exec(o)}(e,se(le(JSON.parse(t),{userID:"friend_user_id",nickname:"name"}))),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getAllFriendList",function(t){return S(this,null,function*(){try{const e=function(r,i){return r.exec(`
      select *
        from local_friends
        where owner_user_id = "${i}"
        `)}(yield N(),t);return _(j(e[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"}))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("searchFriendList",function(t,e,r,i){return S(this,null,function*(){try{const o=function(a,p,c,M,x){let A="";const D=`name like "%${p}%"`,L=`remark like "%${p}%"`;return c&&(A=`friend_user_id like "%${p}%"`),M&&(A=A?A+" or "+D:D),x&&(A=A?A+" or "+L:L),a.exec(`
      select *
        from local_friends
        where ${A}
        order by create_time desc
        `)}(yield N(),t,e,r,i);return _(j(o[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"}))}catch(o){return console.error(o),_(void 0,k.ErrorInit,JSON.stringify(o))}})}),R.registerMethod("getFriendInfoByFriendUserID",function(t,e){return S(this,null,function*(){try{const r=function(i,o,a){return i.exec(`
      select *
        from local_friends
        where owner_user_id = "${a}"
         and friend_user_id = "${o}"
        limit 1
        `)}(yield N(),t,e);return r.length===0?_("",k.ErrorNoRecord,`no friend with id ${t}`):_(j(r[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"})[0])}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getFriendInfoList",function(t){return S(this,null,function*(){try{const e=function(r,i){const o=i.map(a=>`'${a}'`).join(",");return r.exec(`
      select *
        from local_friends
        where friend_user_id in (${o})
        `)}(yield N(),JSON.parse(t));return _(j(e[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"}))}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("getPageFriendList",function(t,e,r){return S(this,null,function*(){try{const i=function(o,a,p,c){return o.exec(`
      select *
        from local_friends
        where owner_user_id = "${c}"
        order by name
        limit ${p} offset ${a}
        `)}(yield N(),t,e,r);return _(j(i[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"}))}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("updateColumnsFriend",function(t,e){return S(this,null,function*(){try{const r=yield N(),i=se(le(JSON.parse(e),{userID:"friend_user_id",nickname:"name"}));return function(o,a,p){const c=a.map(x=>`'${x}'`).join(","),M=re.update().table("local_friends").setFields(p).where(`friend_user_id IN (${c})`).toString();o.exec(M)}(r,JSON.parse(t),i),_("")}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getFriendListCount",function(){return S(this,null,function*(){var t,e,r;try{const i=function(o){return o.exec(`
      SELECT COUNT(*) FROM local_friends;
      `)}(yield N());return _((r=(e=(t=i[0])===null||t===void 0?void 0:t.values[0])===null||e===void 0?void 0:e[0])!==null&&r!==void 0?r:0)}catch(i){return console.error(i),_(void 0,k.ErrorInit,JSON.stringify(i))}})}),R.registerMethod("batchInsertFriend",function(t){return S(this,null,function*(){try{const e=yield N();return JSON.parse(t).map(r=>{const i=se(le(r,{userID:"friend_user_id",nickname:"name"}));return wr(e,i),null}),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("deleteAllFriend",function(){return S(this,null,function*(){try{return function(t){t.exec(`
      DELETE FROM local_friends;
      `)}(yield N()),_("")}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("batchInsertTempCacheMessageList",gn),R.registerMethod("InsertTempCacheMessage",function(t){return S(this,null,function*(){return gn(`[${t}]`)})}),R.registerMethod("getNotificationAllSeqs",function(){return S(this,null,function*(){try{const t=function(e){return e.exec("SELECT * from local_notification_seqs where 1 = 1;")}(yield N());return _(j(t[0],"CamelCase"))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("batchInsertNotificationSeq",function(t){return S(this,null,function*(){try{const e=JSON.parse(t),r=yield N();return e.map(i=>{const{conversationID:o,seq:a}=i;Or(r,o,a)}),_("")}catch(e){return console.error(e),_(void 0,k.ErrorInit,JSON.stringify(e))}})}),R.registerMethod("setNotificationSeq",function(t,e){return S(this,null,function*(){try{const r=yield N();let i=function(o,a,p){return o.exec(`UPDATE local_notification_seqs set seq = ${p} where conversation_id = "${a}"`)}(r,t,e);return r.getRowsModified()===0&&(i=Or(r,t,e)),_(i[0])}catch(r){return console.error(r),_(void 0,k.ErrorInit,JSON.stringify(r))}})}),R.registerMethod("getExistedTables",function(){return S(this,null,function*(){try{const t=function(e){return e.exec(`
      SELECT name FROM sqlite_master WHERE type="table";
    `)}(yield N());return _(j(t[0],"CamelCase",[],{tbl_name:"tblName"}))}catch(t){return console.error(t),_(void 0,k.ErrorInit,JSON.stringify(t))}})}),R.registerMethod("exec",t=>S(this,null,function*(){const e=yield N();try{const r=e.exec(t);console.info(`sql debug with exec sql = ${t.trim()} , return `,r)}catch(r){console.info(`sql debug with exec sql = ${t} , return `,r)}})),R.registerMethod("getRowsModified",()=>S(this,null,function*(){const t=yield N();try{const e=t.getRowsModified();console.info("sql debug with getRowsModified return ",e)}catch(e){console.info("sql debug with getRowsModified return ",e)}})),R.registerMethod("exportDB",()=>S(this,null,function*(){const t=yield N();try{const e=t.export(),r=new Blob([e]);return URL.createObjectURL(r)}catch(e){console.info("sql export error, return ",e)}}))})();
}());