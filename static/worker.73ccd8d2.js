!(function(){var Er=(er,Zt,tr)=>new Promise((nr,ir)=>{var sr=Or=>{try{ar(tr.next(Or))}catch(Sr){ir(Sr)}},_r=Or=>{try{ar(tr.throw(Or))}catch(Sr){ir(Sr)}},ar=Or=>Or.done?nr(Or.value):Promise.resolve(Or.value).then(sr,_r);ar((tr=tr.apply(er,Zt)).next())});var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(er,Zt,tr)=>Zt in er?e(er,Zt,{enumerable:!0,configurable:!0,writable:!0,value:tr}):er[Zt]=tr,a=(er,Zt)=>{for(var tr in Zt||(Zt={}))i.call(Zt,tr)&&s(er,tr,Zt[tr]);if(n)for(var tr of n(Zt))o.call(Zt,tr)&&s(er,tr,Zt[tr]);return er},u=(er,Zt)=>t(er,r(Zt)),c=(er,Zt,tr)=>(s(er,typeof Zt!="symbol"?Zt+"":Zt,tr),tr);const l={CONNECT_TIMEOUT:{code:-32300,message:"Connect timeout"},APPLICATION_ERROR:{code:-32500,message:"Application error"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"}},f=class{constructor(er){c(this,"_event"),c(this,"_methods",{}),c(this,"_timeout",0),c(this,"_$connect",null),this._event=er.event,this._timeout=er.timeout||0,er.methods&&Object.entries(er.methods).forEach(([Zt,tr])=>{this.registerMethod(Zt,tr)}),this._event.onerror=Zt=>{const{code:tr,message:nr,data:ir}=Zt;if(ir.event&&Array.isArray(ir.args)&&ir.args.length){const sr=ir.args[0],_r=this._getAckEventName(sr.method),ar={jsonrpc:"2.0",id:sr==null?void 0:sr.id,error:{code:tr,message:nr,data:sr}};this._event.emit(_r,ar)}else console.error(Zt)},this.connect()}static uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,er=>{const Zt=16*Math.random()|0;return(er=="x"?Zt:3&Zt|8).toString(16)})}_getSynEventName(er){return`${f.EVENT.SYN_SIGN}${er}`}_getAckEventName(er){return`${f.EVENT.ACK_SIGN}${er}`}connect(er){return this._$connect||(this._$connect=new Promise((Zt,tr)=>{const nr=er||this._timeout;let ir;nr&&(ir=setTimeout(()=>{const Sr=u(a({},l.TIMEOUT),{data:{timeout:nr}});tr(Sr)},nr));const sr=f.EVENT.CONNECT,_r=this._getAckEventName(sr),ar=this._getSynEventName(sr),Or=()=>{clearTimeout(ir),Zt()};this._event.on(_r,Or),this._event.on(ar,()=>{this._event.emit(_r),Or()}),this._event.emit(ar)})),this._$connect}registerMethod(er,Zt){if(this._methods[er])throw new Error(`${er} already registered`);this._methods[er]=Zt;const tr=this._getSynEventName(er);this._event.on(tr,nr=>{const ir=this._getAckEventName(er);nr.id?Promise.resolve(Zt(...nr.params)).then(sr=>{const _r={jsonrpc:"2.0",result:sr,id:nr.id};this._event.emit(ir,_r)}).catch(sr=>{const _r={jsonrpc:"2.0",id:nr.id,error:{code:(sr==null?void 0:sr.code)||l.APPLICATION_ERROR.code,message:(sr==null?void 0:sr.message)||l.APPLICATION_ERROR.message,data:null}};this._event.emit(ir,_r)}):Zt(...nr.params)})}removeMethod(er){this._methods[er]||delete this._methods[er];const Zt=this._getSynEventName(er);this._event.off(Zt)}invoke(er,...Zt){return new Promise((tr,nr)=>{const ir=Zt[Zt.length-1],sr=ir&&typeof ir=="object"&&(Reflect.has(ir,"isNotify")||Reflect.has(ir,"timeout")),_r=sr?ir:{isNotify:!1,timeout:0},ar=sr?Zt.slice(0,-1):Zt,Or=this._getSynEventName(er),Sr=f.uuid(),kr={jsonrpc:"2.0",method:er,params:ar,id:Sr};if(this._event.emit(Or,kr),_r.isNotify)tr(void 0);else{const Ir=this._getAckEventName(er),Cr=_r.timeout||this._timeout;let Ur;Cr&&(Ur=setTimeout(()=>{const Yr=u(a({},l.CONNECT_TIMEOUT),{data:{timeout:Cr}});nr(Yr)},Cr));const Wr=Yr=>{Yr.id===Sr&&(clearTimeout(Ur),this._event.off(Ir,Wr),Yr.error?nr(Yr.error):tr(Yr.result))};this._event.on(Ir,Wr)}})}destroy(){Object.entries(this._methods).forEach(([tr])=>{const nr=this._getSynEventName(tr);this._event.off(nr)});const er=this._getAckEventName(f.EVENT.CONNECT),Zt=this._getSynEventName(f.EVENT.CONNECT);this._event.off(Zt),this._event.off(er),this._event.destroy&&this._event.destroy()}};let d=f;c(d,"CODES",l),c(d,"EVENT",{SYN_SIGN:"syn:",ACK_SIGN:"ack:",CONNECT:"__rpc_connect_event",SYNC_METHODS:"__rpc_sync_methods_event"});const h={ErrorInit:10001,ErrorNoRecord:10002,ErrorDBTimeout:10003};var _;(function(er){er.Login="Login",er.OnConnectFailed="OnConnectFailed",er.OnConnectSuccess="OnConnectSuccess",er.OnConnecting="OnConnecting",er.OnKickedOffline="OnKickedOffline",er.OnSelfInfoUpdated="OnSelfInfoUpdated",er.OnUserTokenExpired="OnUserTokenExpired",er.OnUserTokenInvalid="OnUserTokenInvalid",er.OnProgress="OnProgress",er.OnRecvNewMessage="OnRecvNewMessage",er.OnRecvNewMessages="OnRecvNewMessages",er.OnRecvOnlineOnlyMessage="OnRecvOnlineOnlyMessage",er.OnRecvOfflineNewMessage="onRecvOfflineNewMessage",er.OnRecvOnlineOnlyMessages="OnRecvOnlineOnlyMessages",er.OnRecvOfflineNewMessages="onRecvOfflineNewMessages",er.OnRecvMessageRevoked="OnRecvMessageRevoked",er.OnNewRecvMessageRevoked="OnNewRecvMessageRevoked",er.OnRecvC2CReadReceipt="OnRecvC2CReadReceipt",er.OnRecvGroupReadReceipt="OnRecvGroupReadReceipt",er.OnConversationChanged="OnConversationChanged",er.OnNewConversation="OnNewConversation",er.OnConversationUserInputStatusChanged="OnConversationUserInputStatusChanged",er.OnSyncServerFailed="OnSyncServerFailed",er.OnSyncServerFinish="OnSyncServerFinish",er.OnSyncServerProgress="OnSyncServerProgress",er.OnSyncServerStart="OnSyncServerStart",er.OnTotalUnreadMessageCountChanged="OnTotalUnreadMessageCountChanged",er.OnBlackAdded="OnBlackAdded",er.OnBlackDeleted="OnBlackDeleted",er.OnFriendApplicationAccepted="OnFriendApplicationAccepted",er.OnFriendApplicationAdded="OnFriendApplicationAdded",er.OnFriendApplicationDeleted="OnFriendApplicationDeleted",er.OnFriendApplicationRejected="OnFriendApplicationRejected",er.OnFriendInfoChanged="OnFriendInfoChanged",er.OnFriendAdded="OnFriendAdded",er.OnFriendDeleted="OnFriendDeleted",er.OnJoinedGroupAdded="OnJoinedGroupAdded",er.OnJoinedGroupDeleted="OnJoinedGroupDeleted",er.OnGroupDismissed="OnGroupDismissed",er.OnGroupMemberAdded="OnGroupMemberAdded",er.OnGroupMemberDeleted="OnGroupMemberDeleted",er.OnGroupApplicationAdded="OnGroupApplicationAdded",er.OnGroupApplicationDeleted="OnGroupApplicationDeleted",er.OnGroupInfoChanged="OnGroupInfoChanged",er.OnGroupMemberInfoChanged="OnGroupMemberInfoChanged",er.OnGroupApplicationAccepted="OnGroupApplicationAccepted",er.OnGroupApplicationRejected="OnGroupApplicationRejected",er.UploadComplete="UploadComplete",er.OnRecvCustomBusinessMessage="OnRecvCustomBusinessMessage",er.OnUserStatusChanged="OnUserStatusChanged",er.OnUploadLogsProgress="OnUploadLogsProgress",er.OnReceiveNewInvitation="OnReceiveNewInvitation",er.OnInviteeAccepted="OnInviteeAccepted",er.OnInviteeRejected="OnInviteeRejected",er.OnInvitationCancelled="OnInvitationCancelled",er.OnHangUp="OnHangUp",er.OnInvitationTimeout="OnInvitationTimeout",er.OnInviteeAcceptedByOtherDevice="OnInviteeAcceptedByOtherDevice",er.OnInviteeRejectedByOtherDevice="OnInviteeRejectedByOtherDevice",er.OnStreamChange="OnStreamChange",er.OnRoomParticipantConnected="OnRoomParticipantConnected",er.OnRoomParticipantDisconnected="OnRoomParticipantDisconnected",er.OnReceiveCustomSignal="OnReceiveCustomSignal",er.UnUsedEvent="UnUsedEvent"})(_||(_={})),typeof globalThis!="undefined"||typeof window!="undefined"||typeof global!="undefined"&&global;function p(er){return er&&er.__esModule&&Object.prototype.hasOwnProperty.call(er,"default")?er.default:er}function g(er){if(er.__esModule)return er;var Zt=er.default;if(typeof Zt=="function"){var tr=function nr(){return this instanceof nr?Reflect.construct(Zt,arguments,this.constructor):Zt.apply(this,arguments)};tr.prototype=Zt.prototype}else tr={};return Object.defineProperty(tr,"__esModule",{value:!0}),Object.keys(er).forEach(function(nr){var ir=Object.getOwnPropertyDescriptor(er,nr);Object.defineProperty(tr,nr,ir.get?ir:{enumerable:!0,get:function(){return er[nr]}})}),tr}var m={exports:{}};m.exports=function(){var er=function Fr(gr,Ar,wr){gr===null&&(gr=Function.prototype);var mr=Object.getOwnPropertyDescriptor(gr,Ar);if(mr===void 0){var fr=Object.getPrototypeOf(gr);return fr===null?void 0:Fr(fr,Ar,wr)}if("value"in mr)return mr.value;var lr=mr.get;return lr!==void 0?lr.call(wr):void 0},Zt=function(){function Fr(gr,Ar){for(var wr=0;wr<Ar.length;wr++){var mr=Ar[wr];mr.enumerable=mr.enumerable||!1,mr.configurable=!0,"value"in mr&&(mr.writable=!0),Object.defineProperty(gr,mr.key,mr)}}return function(gr,Ar,wr){return Ar&&Fr(gr.prototype,Ar),wr&&Fr(gr,wr),gr}}(),tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Fr){return typeof Fr}:function(Fr){return Fr&&typeof Symbol=="function"&&Fr.constructor===Symbol&&Fr!==Symbol.prototype?"symbol":typeof Fr};function nr(Fr,gr){if(!Fr)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!gr||typeof gr!="object"&&typeof gr!="function"?Fr:gr}function ir(Fr,gr){if(typeof gr!="function"&&gr!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof gr);Fr.prototype=Object.create(gr&&gr.prototype,{constructor:{value:Fr,enumerable:!1,writable:!0,configurable:!0}}),gr&&(Object.setPrototypeOf?Object.setPrototypeOf(Fr,gr):Fr.__proto__=gr)}function sr(Fr,gr){if(!(Fr instanceof gr))throw new TypeError("Cannot call a class as a function")}function _r(Fr,gr){return Fr.length?Fr+gr:Fr}function ar(Fr){for(var gr=arguments.length,Ar=Array(gr>1?gr-1:0),wr=1;wr<gr;wr++)Ar[wr-1]=arguments[wr];if(Fr&&Ar){var mr=function(xr){(xr===void 0?"undefined":tr(xr))==="object"&&Object.getOwnPropertyNames(xr).forEach(function(Tr){Fr[Tr]=xr[Tr]})},fr=!0,lr=!1,hr=void 0;try{for(var vr,br=Ar[Symbol.iterator]();!(fr=(vr=br.next()).done);fr=!0)mr(vr.value)}catch(xr){lr=!0,hr=xr}finally{try{!fr&&br.return&&br.return()}finally{if(lr)throw hr}}}return Fr}function Or(Fr){return Fr&&Fr.constructor.prototype===Object.prototype}function Sr(Fr){return Fr&&Fr.constructor.prototype===Array.prototype}function kr(Fr){if(!Fr)return Fr;if(typeof Fr.clone=="function")return Fr.clone();if(Or(Fr)||Sr(Fr)){var gr=new Fr.constructor;return Object.getOwnPropertyNames(Fr).forEach(function(Ar){typeof Fr[Ar]!="function"&&(gr[Ar]=kr(Fr[Ar]))}),gr}return JSON.parse(JSON.stringify(Fr))}function Ir(Fr,gr,Ar){var wr=gr===void 0?"undefined":tr(gr);if(wr!=="function"&&wr!=="string")throw new Error("type must be a class constructor or string");if(typeof Ar!="function")throw new Error("handler must be a function");var mr=!0,fr=!1,lr=void 0;try{for(var hr,vr=Fr[Symbol.iterator]();!(mr=(hr=vr.next()).done);mr=!0){var br=hr.value;if(br.type===gr)return void(br.handler=Ar)}}catch(xr){fr=!0,lr=xr}finally{try{!mr&&vr.return&&vr.return()}finally{if(fr)throw lr}}Fr.push({type:gr,handler:Ar})}function Cr(Fr,gr,Ar){return Ur(Fr,gr)||Ur(Fr,Ar)}function Ur(Fr,gr){for(var Ar=0;Ar<gr.length;Ar++){var wr=gr[Ar];if((Fr===void 0?"undefined":tr(Fr))===wr.type||typeof wr.type!="string"&&Fr instanceof wr.type)return wr.handler}}function Wr(){var Fr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,gr={isSquelBuilder:function(mr){return mr&&!!mr._toParamString}},Ar=function(mr){return!gr.isSquelBuilder(mr)||!mr.options.rawNesting};gr.DefaultQueryBuilderOptions={autoQuoteTableNames:!1,autoQuoteFieldNames:!1,autoQuoteAliasNames:!0,useAsForTableAliasNames:!1,nameQuoteCharacter:"`",tableAliasQuoteCharacter:"`",fieldAliasQuoteCharacter:'"',valueHandlers:[],parameterCharacter:"?",numberedParameters:!1,numberedParametersPrefix:"$",numberedParametersStartAt:1,replaceSingleQuotes:!1,singleQuoteReplacement:"''",separator:" ",stringFormatter:null,rawNesting:!1},gr.globalValueHandlers=[],gr.registerValueHandler=function(mr,fr){Ir(gr.globalValueHandlers,mr,fr)},gr.Cloneable=function(){function mr(){sr(this,mr)}return Zt(mr,[{key:"clone",value:function(){return ar(new this.constructor,kr(ar({},this)))}}]),mr}(),gr.BaseBuilder=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this)),vr=JSON.parse(JSON.stringify(gr.DefaultQueryBuilderOptions));return["stringFormatter"].forEach(function(br){vr[br]=gr.DefaultQueryBuilderOptions[br]}),hr.options=ar({},vr,lr),hr}return ir(fr,mr),Zt(fr,[{key:"registerValueHandler",value:function(lr,hr){return Ir(this.options.valueHandlers,lr,hr),this}},{key:"_sanitizeExpression",value:function(lr){if(!gr.isSquelBuilder(lr)&&typeof lr!="string")throw new Error("expression must be a string\xA0or builder instance");return lr}},{key:"_sanitizeName",value:function(lr,hr){if(typeof lr!="string")throw new Error(hr+" must be a string");return lr}},{key:"_sanitizeField",value:function(lr){return gr.isSquelBuilder(lr)||(lr=this._sanitizeName(lr,"field name")),lr}},{key:"_sanitizeBaseBuilder",value:function(lr){if(gr.isSquelBuilder(lr))return lr;throw new Error("must be a builder instance")}},{key:"_sanitizeTable",value:function(lr){if(typeof lr!="string")try{lr=this._sanitizeBaseBuilder(lr)}catch(hr){throw new Error("table name must be a string or a builder")}else lr=this._sanitizeName(lr,"table");return lr}},{key:"_sanitizeTableAlias",value:function(lr){return this._sanitizeName(lr,"table alias")}},{key:"_sanitizeFieldAlias",value:function(lr){return this._sanitizeName(lr,"field alias")}},{key:"_sanitizeLimitOffset",value:function(lr){if(0>(lr=parseInt(lr))||isNaN(lr))throw new Error("limit/offset must be >= 0");return lr}},{key:"_sanitizeValue",value:function(lr){var hr=lr===void 0?"undefined":tr(lr);if(lr!==null){if(!(hr==="string"||hr==="number"||hr==="boolean")){if(!gr.isSquelBuilder(lr)){if(!Cr(lr,this.options.valueHandlers,gr.globalValueHandlers))throw new Error("field value must be a string, number, boolean, null or one of the registered custom value types")}}}return lr}},{key:"_escapeValue",value:function(lr){return this.options.replaceSingleQuotes&&lr?lr.replace(/\'/g,this.options.singleQuoteReplacement):lr}},{key:"_formatTableName",value:function(lr){if(this.options.autoQuoteTableNames){var hr=this.options.nameQuoteCharacter;lr=""+hr+lr+hr}return lr}},{key:"_formatFieldAlias",value:function(lr){if(this.options.autoQuoteAliasNames){var hr=this.options.fieldAliasQuoteCharacter;lr=""+hr+lr+hr}return lr}},{key:"_formatTableAlias",value:function(lr){if(this.options.autoQuoteAliasNames){var hr=this.options.tableAliasQuoteCharacter;lr=""+hr+lr+hr}return this.options.useAsForTableAliasNames?"AS "+lr:lr}},{key:"_formatFieldName",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options.autoQuoteFieldNames){var vr=this.options.nameQuoteCharacter;lr=hr.ignorePeriodsForFieldNameQuotes?""+vr+lr+vr:lr.split(".").map(function(br){return br==="*"?br:""+vr+br+vr}).join(".")}return lr}},{key:"_formatCustomValue",value:function(lr,hr,vr){var br=Cr(lr,this.options.valueHandlers,gr.globalValueHandlers);return br&&(lr=br(lr,hr,vr))&&lr.rawNesting?{formatted:!0,rawNesting:!0,value:lr.value}:{formatted:!!br,value:lr}}},{key:"_formatValueForParamArray",value:function(lr){var hr=this,vr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Sr(lr)?lr.map(function(br){return hr._formatValueForParamArray(br,vr)}):this._formatCustomValue(lr,!0,vr).value}},{key:"_formatValueForQueryString",value:function(lr){var hr=this,vr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},br=this._formatCustomValue(lr,!1,vr),xr=br.rawNesting,Tr=br.formatted,Mr=br.value;if(Tr)return xr?Mr:this._applyNestingFormatting(Mr,Ar(lr));if(Sr(Mr))Mr=Mr.map(function(qr){return hr._formatValueForQueryString(qr)}),Mr=this._applyNestingFormatting(Mr.join(", "),Ar(Mr));else{var Pr=Mr===void 0?"undefined":tr(Mr);if(Mr===null)Mr="NULL";else if(Pr==="boolean")Mr=Mr?"TRUE":"FALSE";else if(gr.isSquelBuilder(Mr))Mr=this._applyNestingFormatting(Mr.toString(),Ar(Mr));else if(Pr!=="number"){if(Pr==="string"&&this.options.stringFormatter)return this.options.stringFormatter(Mr);Mr=vr.dontQuote?""+Mr:"'"+this._escapeValue(Mr)+"'"}}return Mr}},{key:"_applyNestingFormatting",value:function(lr){if(lr&&typeof lr=="string"&&(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&!this.options.rawNesting){var hr=lr.charAt(0)==="("&&lr.charAt(lr.length-1)===")";if(hr)for(var vr=0,br=1;lr.length-1>++vr;){var xr=lr.charAt(vr);if(xr==="(")br++;else if(xr===")"&&1>--br){hr=!1;break}}hr||(lr="("+lr+")")}return lr}},{key:"_buildString",value:function(lr,hr){var vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},br=vr.nested,xr=vr.buildParameterized,Tr=vr.formattingOptions;hr=hr||[],lr=lr||"";for(var Mr="",Pr=-1,qr=[],Jr=this.options.parameterCharacter,zr=0;lr.length>zr;)if(lr.substr(zr,Jr.length)===Jr){var Vr=hr[++Pr];if(xr)if(gr.isSquelBuilder(Vr)){var Qr=Vr._toParamString({buildParameterized:xr,nested:!0});Mr+=Qr.text,Qr.values.forEach(function(tn){return qr.push(tn)})}else Sr(Vr=this._formatValueForParamArray(Vr,Tr))?(Mr+="("+Vr.map(function(){return Jr}).join(", ")+")",Vr.forEach(function(tn){return qr.push(tn)})):(Mr+=Jr,qr.push(Vr));else Mr+=this._formatValueForQueryString(Vr,Tr);zr+=Jr.length}else Mr+=lr.charAt(zr),zr++;return{text:this._applyNestingFormatting(Mr,!!br),values:qr}}},{key:"_buildManyStrings",value:function(lr,hr){for(var vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},br=[],xr=[],Tr=0;lr.length>Tr;++Tr){var Mr=lr[Tr],Pr=hr[Tr],qr=this._buildString(Mr,Pr,{buildParameterized:vr.buildParameterized,nested:!1}),Jr=qr.text,zr=qr.values;br.push(Jr),zr.forEach(function(Vr){return xr.push(Vr)})}return{text:(br=br.join(this.options.separator)).length?this._applyNestingFormatting(br,!!vr.nested):"",values:xr}}},{key:"_toParamString",value:function(lr){throw new Error("Not yet implemented")}},{key:"toString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._toParamString(lr).text}},{key:"toParam",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._toParamString(ar({},lr,{buildParameterized:!0}))}}]),fr}(gr.Cloneable),gr.Expression=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._nodes=[],hr}return ir(fr,mr),Zt(fr,[{key:"and",value:function(lr){for(var hr=arguments.length,vr=Array(hr>1?hr-1:0),br=1;br<hr;br++)vr[br-1]=arguments[br];return lr=this._sanitizeExpression(lr),this._nodes.push({type:"AND",expr:lr,para:vr}),this}},{key:"or",value:function(lr){for(var hr=arguments.length,vr=Array(hr>1?hr-1:0),br=1;br<hr;br++)vr[br-1]=arguments[br];return lr=this._sanitizeExpression(lr),this._nodes.push({type:"OR",expr:lr,para:vr}),this}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr=[],vr=[],br=!0,xr=!1,Tr=void 0;try{for(var Mr,Pr=this._nodes[Symbol.iterator]();!(br=(Mr=Pr.next()).done);br=!0){var qr=Mr.value,Jr=qr.type,zr=qr.expr,Vr=qr.para,Qr=gr.isSquelBuilder(zr)?zr._toParamString({buildParameterized:lr.buildParameterized,nested:!0}):this._buildString(zr,Vr,{buildParameterized:lr.buildParameterized}),tn=Qr.text,rn=Qr.values;hr.length&&hr.push(Jr),hr.push(tn),rn.forEach(function(nn){return vr.push(nn)})}}catch(nn){xr=!0,Tr=nn}finally{try{!br&&Pr.return&&Pr.return()}finally{if(xr)throw Tr}}return hr=hr.join(" "),{text:this._applyNestingFormatting(hr,!!lr.nested),values:vr}}}]),fr}(gr.BaseBuilder),gr.Case=function(mr){function fr(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sr(this,fr);var vr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,hr));return Or(lr)&&(hr=lr,lr=null),lr&&(vr._fieldName=vr._sanitizeField(lr)),vr.options=ar({},gr.DefaultQueryBuilderOptions,hr),vr._cases=[],vr._elseValue=null,vr}return ir(fr,mr),Zt(fr,[{key:"when",value:function(lr){for(var hr=arguments.length,vr=Array(hr>1?hr-1:0),br=1;br<hr;br++)vr[br-1]=arguments[br];return this._cases.unshift({expression:lr,values:vr||[]}),this}},{key:"then",value:function(lr){if(this._cases.length==0)throw new Error("when() needs to be called first");return this._cases[0].result=lr,this}},{key:"else",value:function(lr){return this._elseValue=lr,this}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr="",vr=[],br=!0,xr=!1,Tr=void 0;try{for(var Mr,Pr=this._cases[Symbol.iterator]();!(br=(Mr=Pr.next()).done);br=!0){var qr=Mr.value,Jr=qr.expression,zr=qr.values,Vr=qr.result;hr=_r(hr," ");var Qr=this._buildString(Jr,zr,{buildParameterized:lr.buildParameterized,nested:!0});hr+="WHEN "+Qr.text+" THEN "+this._formatValueForQueryString(Vr),Qr.values.forEach(function(tn){return vr.push(tn)})}}catch(tn){xr=!0,Tr=tn}finally{try{!br&&Pr.return&&Pr.return()}finally{if(xr)throw Tr}}return hr.length?(hr+=" ELSE "+this._formatValueForQueryString(this._elseValue)+" END",this._fieldName&&(hr=this._fieldName+" "+hr),hr="CASE "+hr):hr=this._formatValueForQueryString(this._elseValue),{text:hr,values:vr}}}]),fr}(gr.BaseBuilder),gr.Block=function(mr){function fr(lr){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr))}return ir(fr,mr),Zt(fr,[{key:"exposedMethods",value:function(){for(var lr={},hr=this;hr;)Object.getOwnPropertyNames(hr).forEach(function(vr){vr==="constructor"||typeof hr[vr]!="function"||vr.charAt(0)==="_"||gr.Block.prototype[vr]||(lr[vr]=hr[vr])}),hr=Object.getPrototypeOf(hr);return lr}}]),fr}(gr.BaseBuilder),gr.StringBlock=function(mr){function fr(lr,hr){sr(this,fr);var vr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return vr._str=hr,vr}return ir(fr,mr),Zt(fr,[{key:"_toParamString",value:function(){return{text:this._str,values:[]}}}]),fr}(gr.Block),gr.FunctionBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._strings=[],hr._values=[],hr}return ir(fr,mr),Zt(fr,[{key:"function",value:function(lr){this._strings.push(lr);for(var hr=arguments.length,vr=Array(hr>1?hr-1:0),br=1;br<hr;br++)vr[br-1]=arguments[br];this._values.push(vr)}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._buildManyStrings(this._strings,this._values,lr)}}]),fr}(gr.Block),gr.registerValueHandler(gr.FunctionBlock,function(mr){return arguments.length>1&&arguments[1]!==void 0&&arguments[1]?mr.toParam():mr.toString()}),gr.AbstractTableBlock=function(mr){function fr(lr,hr){sr(this,fr);var vr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return vr._tables=[],vr}return ir(fr,mr),Zt(fr,[{key:"_table",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;hr=hr&&this._sanitizeTableAlias(hr),lr=this._sanitizeTable(lr),this.options.singleTable&&(this._tables=[]),this._tables.push({table:lr,alias:hr})}},{key:"_hasTable",value:function(){return 0<this._tables.length}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr="",vr=[];if(this._hasTable()){var br=!0,xr=!1,Tr=void 0;try{for(var Mr,Pr=this._tables[Symbol.iterator]();!(br=(Mr=Pr.next()).done);br=!0){var qr=Mr.value,Jr=qr.table,zr=qr.alias;hr=_r(hr,", ");var Vr=void 0;if(gr.isSquelBuilder(Jr)){var Qr=Jr._toParamString({buildParameterized:lr.buildParameterized,nested:!0}),tn=Qr.text,rn=Qr.values;Vr=tn,rn.forEach(function(nn){return vr.push(nn)})}else Vr=this._formatTableName(Jr);zr&&(Vr+=" "+this._formatTableAlias(zr)),hr+=Vr}}catch(nn){xr=!0,Tr=nn}finally{try{!br&&Pr.return&&Pr.return()}finally{if(xr)throw Tr}}this.options.prefix&&(hr=this.options.prefix+" "+hr)}return{text:hr,values:vr}}}]),fr}(gr.Block),gr.TargetTableBlock=function(mr){function fr(){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).apply(this,arguments))}return ir(fr,mr),Zt(fr,[{key:"target",value:function(lr){this._table(lr)}}]),fr}(gr.AbstractTableBlock),gr.UpdateTableBlock=function(mr){function fr(){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).apply(this,arguments))}return ir(fr,mr),Zt(fr,[{key:"table",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this._table(lr,hr)}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._hasTable())throw new Error("table() needs to be called");return er(fr.prototype.__proto__||Object.getPrototypeOf(fr.prototype),"_toParamString",this).call(this,lr)}}]),fr}(gr.AbstractTableBlock),gr.FromTableBlock=function(mr){function fr(lr){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,ar({},lr,{prefix:"FROM"})))}return ir(fr,mr),Zt(fr,[{key:"from",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this._table(lr,hr)}}]),fr}(gr.AbstractTableBlock),gr.IntoTableBlock=function(mr){function fr(lr){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,ar({},lr,{prefix:"INTO",singleTable:!0})))}return ir(fr,mr),Zt(fr,[{key:"into",value:function(lr){this._table(lr)}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._hasTable())throw new Error("into() needs to be called");return er(fr.prototype.__proto__||Object.getPrototypeOf(fr.prototype),"_toParamString",this).call(this,lr)}}]),fr}(gr.AbstractTableBlock),gr.GetFieldBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._fields=[],hr}return ir(fr,mr),Zt(fr,[{key:"fields",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Sr(lr)){var vr=!0,br=!1,xr=void 0;try{for(var Tr,Mr=lr[Symbol.iterator]();!(vr=(Tr=Mr.next()).done);vr=!0){var Pr=Tr.value;this.field(Pr,null,hr)}}catch(zr){br=!0,xr=zr}finally{try{!vr&&Mr.return&&Mr.return()}finally{if(br)throw xr}}}else for(var qr in lr){var Jr=lr[qr];this.field(qr,Jr,hr)}}},{key:"field",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(hr=hr&&this._sanitizeFieldAlias(hr),lr=this._sanitizeField(lr),this._fields.filter(function(br){return br.name===lr&&br.alias===hr}).length)return this;this._fields.push({name:lr,alias:hr,options:vr})}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr=lr.queryBuilder,vr=lr.buildParameterized,br="",xr=[],Tr=!0,Mr=!1,Pr=void 0;try{for(var qr,Jr=this._fields[Symbol.iterator]();!(Tr=(qr=Jr.next()).done);Tr=!0){var zr=qr.value;br=_r(br,", ");var Vr=zr.name,Qr=zr.alias,tn=zr.options;if(typeof Vr=="string")br+=this._formatFieldName(Vr,tn);else{var rn=Vr._toParamString({nested:!0,buildParameterized:vr});br+=rn.text,rn.values.forEach(function(dn){return xr.push(dn)})}Qr&&(br+=" AS "+this._formatFieldAlias(Qr))}}catch(dn){Mr=!0,Pr=dn}finally{try{!Tr&&Jr.return&&Jr.return()}finally{if(Mr)throw Pr}}if(!br.length){var nn=hr&&hr.getBlock(gr.FromTableBlock);nn&&nn._hasTable()&&(br="*")}return{text:br,values:xr}}}]),fr}(gr.Block),gr.AbstractSetFieldBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._reset(),hr}return ir(fr,mr),Zt(fr,[{key:"_reset",value:function(){this._fields=[],this._values=[[]],this._valueOptions=[[]]}},{key:"_set",value:function(lr,hr){var vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._values.length>1)throw new Error("Cannot set multiple rows of fields this way.");hr!==void 0&&(hr=this._sanitizeValue(hr)),lr=this._sanitizeField(lr);var br=this._fields.indexOf(lr);br===-1&&(this._fields.push(lr),br=this._fields.length-1),this._values[0][br]=hr,this._valueOptions[0][br]=vr}},{key:"_setFields",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((lr===void 0?"undefined":tr(lr))!=="object")throw new Error("Expected an object but got "+(lr===void 0?"undefined":tr(lr)));for(var vr in lr)this._set(vr,lr[vr],hr)}},{key:"_setFieldsRows",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Sr(lr))throw new Error("Expected an array of objects but got "+(lr===void 0?"undefined":tr(lr)));this._reset();for(var vr=0;lr.length>vr;++vr){var br=lr[vr];for(var xr in br){var Tr=br[xr];xr=this._sanitizeField(xr),Tr=this._sanitizeValue(Tr);var Mr=this._fields.indexOf(xr);if(0<vr&&Mr===-1)throw new Error("All fields in subsequent rows must match the fields in the first row");Mr===-1&&(this._fields.push(xr),Mr=this._fields.length-1),Sr(this._values[vr])||(this._values[vr]=[],this._valueOptions[vr]=[]),this._values[vr][Mr]=Tr,this._valueOptions[vr][Mr]=hr}}}}]),fr}(gr.Block),gr.SetFieldBlock=function(mr){function fr(){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).apply(this,arguments))}return ir(fr,mr),Zt(fr,[{key:"set",value:function(lr,hr,vr){this._set(lr,hr,vr)}},{key:"setFields",value:function(lr,hr){this._setFields(lr,hr)}},{key:"_toParamString",value:function(){var lr=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).buildParameterized;if(0>=this._fields.length)throw new Error("set() needs to be called");for(var hr="",vr=[],br=0;br<this._fields.length;++br){hr=_r(hr,", ");var xr=this._formatFieldName(this._fields[br]),Tr=this._values[0][br];0>xr.indexOf("=")&&(xr=xr+" = "+this.options.parameterCharacter);var Mr=this._buildString(xr,[Tr],{buildParameterized:lr,formattingOptions:this._valueOptions[0][br]});hr+=Mr.text,Mr.values.forEach(function(Pr){return vr.push(Pr)})}return{text:"SET "+hr,values:vr}}}]),fr}(gr.AbstractSetFieldBlock),gr.InsertFieldValueBlock=function(mr){function fr(){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).apply(this,arguments))}return ir(fr,mr),Zt(fr,[{key:"set",value:function(lr,hr){var vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._set(lr,hr,vr)}},{key:"setFields",value:function(lr,hr){this._setFields(lr,hr)}},{key:"setFieldsRows",value:function(lr,hr){this._setFieldsRows(lr,hr)}},{key:"_toParamString",value:function(){for(var lr=this,hr=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).buildParameterized,vr=this._fields.map(function(qr){return lr._formatFieldName(qr)}).join(", "),br=[],xr=[],Tr=0;Tr<this._values.length;++Tr){br[Tr]="";for(var Mr=0;Mr<this._values[Tr].length;++Mr){var Pr=this._buildString(this.options.parameterCharacter,[this._values[Tr][Mr]],{buildParameterized:hr,formattingOptions:this._valueOptions[Tr][Mr]});Pr.values.forEach(function(qr){return xr.push(qr)}),br[Tr]=_r(br[Tr],", "),br[Tr]+=Pr.text}}return{text:vr.length?"("+vr+") VALUES ("+br.join("), (")+")":"",values:xr}}}]),fr}(gr.AbstractSetFieldBlock),gr.InsertFieldsFromQueryBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._fields=[],hr._query=null,hr}return ir(fr,mr),Zt(fr,[{key:"fromQuery",value:function(lr,hr){var vr=this;this._fields=lr.map(function(br){return vr._sanitizeField(br)}),this._query=this._sanitizeBaseBuilder(hr)}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr="",vr=[];if(this._fields.length&&this._query){var br=this._query._toParamString({buildParameterized:lr.buildParameterized,nested:!0}),xr=br.text,Tr=br.values;hr="("+this._fields.join(", ")+") "+this._applyNestingFormatting(xr),vr=Tr}return{text:hr,values:vr}}}]),fr}(gr.Block),gr.DistinctBlock=function(mr){function fr(){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).apply(this,arguments))}return ir(fr,mr),Zt(fr,[{key:"distinct",value:function(){this._useDistinct=!0}},{key:"_toParamString",value:function(){return{text:this._useDistinct?"DISTINCT":"",values:[]}}}]),fr}(gr.Block),gr.GroupByBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._groups=[],hr}return ir(fr,mr),Zt(fr,[{key:"group",value:function(lr){this._groups.push(this._sanitizeField(lr))}},{key:"_toParamString",value:function(){return{text:this._groups.length?"GROUP BY "+this._groups.join(", "):"",values:[]}}}]),fr}(gr.Block),gr.AbstractVerbSingleValueBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._value=null,hr}return ir(fr,mr),Zt(fr,[{key:"_setValue",value:function(lr){this._value=lr!==null?this._sanitizeLimitOffset(lr):lr}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr=this._value!==null?this.options.verb+" "+this.options.parameterCharacter:"",vr=this._value!==null?[this._value]:[];return this._buildString(hr,vr,lr)}}]),fr}(gr.Block),gr.OffsetBlock=function(mr){function fr(lr){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,ar({},lr,{verb:"OFFSET"})))}return ir(fr,mr),Zt(fr,[{key:"offset",value:function(lr){this._setValue(lr)}}]),fr}(gr.AbstractVerbSingleValueBlock),gr.LimitBlock=function(mr){function fr(lr){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,ar({},lr,{verb:"LIMIT"})))}return ir(fr,mr),Zt(fr,[{key:"limit",value:function(lr){this._setValue(lr)}}]),fr}(gr.AbstractVerbSingleValueBlock),gr.AbstractConditionBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._conditions=[],hr}return ir(fr,mr),Zt(fr,[{key:"_condition",value:function(lr){lr=this._sanitizeExpression(lr);for(var hr=arguments.length,vr=Array(hr>1?hr-1:0),br=1;br<hr;br++)vr[br-1]=arguments[br];this._conditions.push({expr:lr,values:vr||[]})}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr=[],vr=[],br=!0,xr=!1,Tr=void 0;try{for(var Mr,Pr=this._conditions[Symbol.iterator]();!(br=(Mr=Pr.next()).done);br=!0){var qr=Mr.value,Jr=qr.expr,zr=qr.values,Vr=gr.isSquelBuilder(Jr)?Jr._toParamString({buildParameterized:lr.buildParameterized}):this._buildString(Jr,zr,{buildParameterized:lr.buildParameterized});Vr.text.length&&hr.push(Vr.text),Vr.values.forEach(function(Qr){return vr.push(Qr)})}}catch(Qr){xr=!0,Tr=Qr}finally{try{!br&&Pr.return&&Pr.return()}finally{if(xr)throw Tr}}return hr.length&&(hr=hr.join(") AND (")),{text:hr.length?this.options.verb+" ("+hr+")":"",values:vr}}}]),fr}(gr.Block),gr.WhereBlock=function(mr){function fr(lr){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,ar({},lr,{verb:"WHERE"})))}return ir(fr,mr),Zt(fr,[{key:"where",value:function(lr){for(var hr=arguments.length,vr=Array(hr>1?hr-1:0),br=1;br<hr;br++)vr[br-1]=arguments[br];this._condition.apply(this,[lr].concat(vr))}}]),fr}(gr.AbstractConditionBlock),gr.HavingBlock=function(mr){function fr(lr){return sr(this,fr),nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,ar({},lr,{verb:"HAVING"})))}return ir(fr,mr),Zt(fr,[{key:"having",value:function(lr){for(var hr=arguments.length,vr=Array(hr>1?hr-1:0),br=1;br<hr;br++)vr[br-1]=arguments[br];this._condition.apply(this,[lr].concat(vr))}}]),fr}(gr.AbstractConditionBlock),gr.OrderByBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._orders=[],hr}return ir(fr,mr),Zt(fr,[{key:"order",value:function(lr,hr){lr=this._sanitizeField(lr),typeof hr!="string"&&(hr===void 0?hr="ASC":hr!==null&&(hr=hr?"ASC":"DESC"));for(var vr=arguments.length,br=Array(vr>2?vr-2:0),xr=2;xr<vr;xr++)br[xr-2]=arguments[xr];this._orders.push({field:lr,dir:hr,values:br||[]})}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr="",vr=[],br=!0,xr=!1,Tr=void 0;try{for(var Mr,Pr=this._orders[Symbol.iterator]();!(br=(Mr=Pr.next()).done);br=!0){var qr=Mr.value,Jr=qr.field,zr=qr.dir,Vr=qr.values;hr=_r(hr,", ");var Qr=this._buildString(Jr,Vr,{buildParameterized:lr.buildParameterized});hr+=Qr.text,Sr(Qr.values)&&Qr.values.forEach(function(tn){return vr.push(tn)}),zr!==null&&(hr+=" "+zr)}}catch(tn){xr=!0,Tr=tn}finally{try{!br&&Pr.return&&Pr.return()}finally{if(xr)throw Tr}}return{text:hr.length?"ORDER BY "+hr:"",values:vr}}}]),fr}(gr.Block),gr.JoinBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._joins=[],hr}return ir(fr,mr),Zt(fr,[{key:"join",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,br=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"INNER";lr=this._sanitizeTable(lr,!0),hr=hr&&this._sanitizeTableAlias(hr),vr=vr&&this._sanitizeExpression(vr),this._joins.push({type:br,table:lr,alias:hr,condition:vr})}},{key:"left_join",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(lr,hr,vr,"LEFT")}},{key:"right_join",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(lr,hr,vr,"RIGHT")}},{key:"outer_join",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(lr,hr,vr,"OUTER")}},{key:"left_outer_join",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(lr,hr,vr,"LEFT OUTER")}},{key:"full_join",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(lr,hr,vr,"FULL")}},{key:"cross_join",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,vr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.join(lr,hr,vr,"CROSS")}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr="",vr=[],br=!0,xr=!1,Tr=void 0;try{for(var Mr,Pr=this._joins[Symbol.iterator]();!(br=(Mr=Pr.next()).done);br=!0){var qr=Mr.value,Jr=qr.type,zr=qr.table,Vr=qr.alias,Qr=qr.condition;hr=_r(hr,this.options.separator);var tn=void 0;if(gr.isSquelBuilder(zr)){var rn=zr._toParamString({buildParameterized:lr.buildParameterized,nested:!0});rn.values.forEach(function(dn){return vr.push(dn)}),tn=rn.text}else tn=this._formatTableName(zr);if(hr+=Jr+" JOIN "+tn,Vr&&(hr+=" "+this._formatTableAlias(Vr)),Qr){hr+=" ON ";var nn=void 0;nn=gr.isSquelBuilder(Qr)?Qr._toParamString({buildParameterized:lr.buildParameterized}):this._buildString(Qr,[],{buildParameterized:lr.buildParameterized}),hr+=this._applyNestingFormatting(nn.text),nn.values.forEach(function(dn){return vr.push(dn)})}}}catch(dn){xr=!0,Tr=dn}finally{try{!br&&Pr.return&&Pr.return()}finally{if(xr)throw Tr}}return{text:hr,values:vr}}}]),fr}(gr.Block),gr.UnionBlock=function(mr){function fr(lr){sr(this,fr);var hr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));return hr._unions=[],hr}return ir(fr,mr),Zt(fr,[{key:"union",value:function(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"UNION";lr=this._sanitizeTable(lr),this._unions.push({type:hr,table:lr})}},{key:"union_all",value:function(lr){this.union(lr,"UNION ALL")}},{key:"_toParamString",value:function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr="",vr=[],br=!0,xr=!1,Tr=void 0;try{for(var Mr,Pr=this._unions[Symbol.iterator]();!(br=(Mr=Pr.next()).done);br=!0){var qr=Mr.value,Jr=qr.type,zr=qr.table;hr=_r(hr,this.options.separator);var Vr=void 0;if(zr instanceof gr.BaseBuilder){var Qr=zr._toParamString({buildParameterized:lr.buildParameterized,nested:!0});Vr=Qr.text,Qr.values.forEach(function(tn){return vr.push(tn)})}else hr=this._formatTableName(zr);hr+=Jr+" "+Vr}}catch(tn){xr=!0,Tr=tn}finally{try{!br&&Pr.return&&Pr.return()}finally{if(xr)throw Tr}}return{text:hr,values:vr}}}]),fr}(gr.Block),gr.QueryBuilder=function(mr){function fr(lr,hr){sr(this,fr);var vr=nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr));vr.blocks=hr||[];var br=!0,xr=!1,Tr=void 0;try{for(var Mr,Pr=vr.blocks[Symbol.iterator]();!(br=(Mr=Pr.next()).done);br=!0){var qr=Mr.value,Jr=qr.exposedMethods();for(var zr in Jr){var Vr=Jr[zr];if(vr[zr]!==void 0)throw new Error("Builder already has a builder method called: "+zr);(function(Qr,tn,rn){vr[tn]=function(){for(var nn=arguments.length,dn=Array(nn),Lr=0;Lr<nn;Lr++)dn[Lr]=arguments[Lr];return rn.call.apply(rn,[Qr].concat(dn)),vr}})(qr,zr,Vr)}}}catch(Qr){xr=!0,Tr=Qr}finally{try{!br&&Pr.return&&Pr.return()}finally{if(xr)throw Tr}}return vr}return ir(fr,mr),Zt(fr,[{key:"registerValueHandler",value:function(lr,hr){var vr=!0,br=!1,xr=void 0;try{for(var Tr,Mr=this.blocks[Symbol.iterator]();!(vr=(Tr=Mr.next()).done);vr=!0)Tr.value.registerValueHandler(lr,hr)}catch(Pr){br=!0,xr=Pr}finally{try{!vr&&Mr.return&&Mr.return()}finally{if(br)throw xr}}return er(fr.prototype.__proto__||Object.getPrototypeOf(fr.prototype),"registerValueHandler",this).call(this,lr,hr),this}},{key:"updateOptions",value:function(lr){this.options=ar({},this.options,lr);var hr=!0,vr=!1,br=void 0;try{for(var xr,Tr=this.blocks[Symbol.iterator]();!(hr=(xr=Tr.next()).done);hr=!0){var Mr=xr.value;Mr.options=ar({},Mr.options,lr)}}catch(Pr){vr=!0,br=Pr}finally{try{!hr&&Tr.return&&Tr.return()}finally{if(vr)throw br}}}},{key:"_toParamString",value:function(){var lr=this,hr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hr=ar({},this.options,hr);var vr=this.blocks.map(function(Jr){return Jr._toParamString({buildParameterized:hr.buildParameterized,queryBuilder:lr})}),br=vr.map(function(Jr){return Jr.text}),xr=vr.map(function(Jr){return Jr.values}),Tr=br.filter(function(Jr){return 0<Jr.length}).join(hr.separator),Mr=[];if(xr.forEach(function(Jr){return Jr.forEach(function(zr){return Mr.push(zr)})}),!hr.nested&&hr.numberedParameters){var Pr=hr.numberedParametersStartAt!==void 0?hr.numberedParametersStartAt:1,qr=hr.parameterCharacter.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");Tr=Tr.replace(new RegExp(qr,"g"),function(){return""+hr.numberedParametersPrefix+Pr++})}return{text:this._applyNestingFormatting(Tr,!!hr.nested),values:Mr}}},{key:"clone",value:function(){var lr=this.blocks.map(function(hr){return hr.clone()});return new this.constructor(this.options,lr)}},{key:"getBlock",value:function(lr){return this.blocks.filter(function(hr){return hr instanceof lr})[0]}}]),fr}(gr.BaseBuilder),gr.Select=function(mr){function fr(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,fr),hr=hr||[new gr.StringBlock(lr,"SELECT"),new gr.FunctionBlock(lr),new gr.DistinctBlock(lr),new gr.GetFieldBlock(lr),new gr.FromTableBlock(lr),new gr.JoinBlock(lr),new gr.WhereBlock(lr),new gr.GroupByBlock(lr),new gr.HavingBlock(lr),new gr.OrderByBlock(lr),new gr.LimitBlock(lr),new gr.OffsetBlock(lr),new gr.UnionBlock(lr)],nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr,hr))}return ir(fr,mr),fr}(gr.QueryBuilder),gr.Update=function(mr){function fr(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,fr),hr=hr||[new gr.StringBlock(lr,"UPDATE"),new gr.UpdateTableBlock(lr),new gr.SetFieldBlock(lr),new gr.WhereBlock(lr),new gr.OrderByBlock(lr),new gr.LimitBlock(lr)],nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr,hr))}return ir(fr,mr),fr}(gr.QueryBuilder),gr.Delete=function(mr){function fr(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,fr),hr=hr||[new gr.StringBlock(lr,"DELETE"),new gr.TargetTableBlock(lr),new gr.FromTableBlock(ar({},lr,{singleTable:!0})),new gr.JoinBlock(lr),new gr.WhereBlock(lr),new gr.OrderByBlock(lr),new gr.LimitBlock(lr)],nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr,hr))}return ir(fr,mr),fr}(gr.QueryBuilder),gr.Insert=function(mr){function fr(lr){var hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,fr),hr=hr||[new gr.StringBlock(lr,"INSERT"),new gr.IntoTableBlock(lr),new gr.InsertFieldValueBlock(lr),new gr.InsertFieldsFromQueryBlock(lr)],nr(this,(fr.__proto__||Object.getPrototypeOf(fr)).call(this,lr,hr))}return ir(fr,mr),fr}(gr.QueryBuilder);var wr={VERSION:"5.13.0",flavour:Fr,expr:function(mr){return new gr.Expression(mr)},case:function(mr,fr){return new gr.Case(mr,fr)},select:function(mr,fr){return new gr.Select(mr,fr)},update:function(mr,fr){return new gr.Update(mr,fr)},insert:function(mr,fr){return new gr.Insert(mr,fr)},delete:function(mr,fr){return new gr.Delete(mr,fr)},str:function(){var mr=new gr.FunctionBlock;return mr.function.apply(mr,arguments),mr},rstr:function(){var mr=new gr.FunctionBlock({rawNesting:!0});return mr.function.apply(mr,arguments),mr},registerValueHandler:gr.registerValueHandler};return wr.remove=wr.delete,wr.cls=gr,wr}var Yr=Wr();return Yr.flavours={},Yr.useFlavour=function(){var Fr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!Fr)return Yr;if(Yr.flavours[Fr]instanceof Function){var gr=Wr(Fr);return Yr.flavours[Fr].call(null,gr),gr.flavours=Yr.flavours,gr.useFlavour=Yr.useFlavour,gr}throw new Error("Flavour not available: "+Fr)},Yr.flavours.mssql=function(Fr){var gr=Fr.cls;gr.DefaultQueryBuilderOptions.replaceSingleQuotes=!0,gr.DefaultQueryBuilderOptions.autoQuoteAliasNames=!1,gr.DefaultQueryBuilderOptions.numberedParametersPrefix="@",Fr.registerValueHandler(Date,function(Ar){return"'"+Ar.getUTCFullYear()+"-"+(Ar.getUTCMonth()+1)+"-"+Ar.getUTCDate()+" "+Ar.getUTCHours()+":"+Ar.getUTCMinutes()+":"+Ar.getUTCSeconds()+"'"}),gr.MssqlLimitOffsetTopBlock=function(Ar){function wr(mr){sr(this,wr);var fr=nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr));fr._limits=null,fr._offsets=null;var lr=function(hr){hr=this._sanitizeLimitOffset(hr),this._parent._limits=hr};return fr.ParentBlock=function(hr){function vr(br){sr(this,vr);var xr=nr(this,(vr.__proto__||Object.getPrototypeOf(vr)).call(this,br.options));return xr._parent=br,xr}return ir(vr,hr),vr}(gr.Block),fr.LimitBlock=function(hr){function vr(br){sr(this,vr);var xr=nr(this,(vr.__proto__||Object.getPrototypeOf(vr)).call(this,br));return xr.limit=lr,xr}return ir(vr,hr),Zt(vr,[{key:"_toParamString",value:function(){var br="";return this._parent._limits&&this._parent._offsets&&(br="FETCH NEXT "+this._parent._limits+" ROWS ONLY"),{text:br,values:[]}}}]),vr}(fr.ParentBlock),fr.TopBlock=function(hr){function vr(br){sr(this,vr);var xr=nr(this,(vr.__proto__||Object.getPrototypeOf(vr)).call(this,br));return xr.top=lr,xr}return ir(vr,hr),Zt(vr,[{key:"_toParamString",value:function(){var br="";return this._parent._limits&&!this._parent._offsets&&(br="TOP ("+this._parent._limits+")"),{text:br,values:[]}}}]),vr}(fr.ParentBlock),fr.OffsetBlock=function(hr){function vr(){return sr(this,vr),nr(this,(vr.__proto__||Object.getPrototypeOf(vr)).apply(this,arguments))}return ir(vr,hr),Zt(vr,[{key:"offset",value:function(br){this._parent._offsets=this._sanitizeLimitOffset(br)}},{key:"_toParamString",value:function(){var br="";return this._parent._offsets&&(br="OFFSET "+this._parent._offsets+" ROWS"),{text:br,values:[]}}}]),vr}(fr.ParentBlock),fr}return ir(wr,Ar),Zt(wr,[{key:"LIMIT",value:function(){return new this.LimitBlock(this)}},{key:"TOP",value:function(){return new this.TopBlock(this)}},{key:"OFFSET",value:function(){return new this.OffsetBlock(this)}}]),wr}(gr.Block),gr.MssqlUpdateTopBlock=function(Ar){function wr(mr){sr(this,wr);var fr=nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr));return fr._limits=null,fr.limit=fr.top=function(lr){fr._limits=fr._sanitizeLimitOffset(lr)},fr}return ir(wr,Ar),Zt(wr,[{key:"_toParamString",value:function(){return{text:this._limits?"TOP ("+this._limits+")":"",values:[]}}}]),wr}(gr.Block),gr.MssqlInsertFieldValueBlock=function(Ar){function wr(mr){sr(this,wr);var fr=nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr));return fr._outputs=[],fr}return ir(wr,Ar),Zt(wr,[{key:"output",value:function(mr){var fr=this;typeof mr=="string"?this._outputs.push("INSERTED."+this._sanitizeField(mr)):mr.forEach(function(lr){fr._outputs.push("INSERTED."+fr._sanitizeField(lr))})}},{key:"_toParamString",value:function(mr){var fr=er(wr.prototype.__proto__||Object.getPrototypeOf(wr.prototype),"_toParamString",this).call(this,mr);if(fr.text.length&&0<this._outputs.length){var lr="OUTPUT "+this._outputs.join(", ")+" ",hr=fr.text.indexOf("VALUES");fr.text=fr.text.substr(0,hr)+lr+fr.text.substr(hr)}return fr}}]),wr}(gr.InsertFieldValueBlock),gr.MssqlUpdateDeleteOutputBlock=function(Ar){function wr(mr){sr(this,wr);var fr=nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr));return fr._outputs=[],fr}return ir(wr,Ar),Zt(wr,[{key:"outputs",value:function(mr){for(var fr in mr)this.output(fr,mr[fr])}},{key:"output",value:function(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;mr=this._sanitizeField(mr),fr=fr&&this._sanitizeFieldAlias(fr),this._outputs.push({name:this.options.forDelete?"DELETED."+mr:"INSERTED."+mr,alias:fr})}},{key:"_toParamString",value:function(mr){var fr="";if(this._outputs.length){var lr=!0,hr=!1,vr=void 0;try{for(var br,xr=this._outputs[Symbol.iterator]();!(lr=(br=xr.next()).done);lr=!0){var Tr=br.value;fr=_r(fr,", "),fr+=Tr.name,Tr.alias&&(fr+=" AS "+this._formatFieldAlias(Tr.alias))}}catch(Mr){hr=!0,vr=Mr}finally{try{!lr&&xr.return&&xr.return()}finally{if(hr)throw vr}}fr="OUTPUT "+fr}return{text:fr,values:[]}}}]),wr}(gr.Block),gr.Select=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;sr(this,wr);var lr=new gr.MssqlLimitOffsetTopBlock(mr);return fr=fr||[new gr.StringBlock(mr,"SELECT"),new gr.DistinctBlock(mr),lr.TOP(),new gr.GetFieldBlock(mr),new gr.FromTableBlock(mr),new gr.JoinBlock(mr),new gr.WhereBlock(mr),new gr.GroupByBlock(mr),new gr.OrderByBlock(mr),lr.OFFSET(),lr.LIMIT(),new gr.UnionBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder),gr.Update=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.StringBlock(mr,"UPDATE"),new gr.MssqlUpdateTopBlock(mr),new gr.UpdateTableBlock(mr),new gr.SetFieldBlock(mr),new gr.MssqlUpdateDeleteOutputBlock(mr),new gr.WhereBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder),gr.Delete=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.StringBlock(mr,"DELETE"),new gr.TargetTableBlock(mr),new gr.FromTableBlock(ar({},mr,{singleTable:!0})),new gr.JoinBlock(mr),new gr.MssqlUpdateDeleteOutputBlock(ar({},mr,{forDelete:!0})),new gr.WhereBlock(mr),new gr.OrderByBlock(mr),new gr.LimitBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder),gr.Insert=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.StringBlock(mr,"INSERT"),new gr.IntoTableBlock(mr),new gr.MssqlInsertFieldValueBlock(mr),new gr.InsertFieldsFromQueryBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder)},Yr.flavours.mysql=function(Fr){var gr=Fr.cls;gr.MysqlOnDuplicateKeyUpdateBlock=function(Ar){function wr(){return sr(this,wr),nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).apply(this,arguments))}return ir(wr,Ar),Zt(wr,[{key:"onDupUpdate",value:function(mr,fr,lr){this._set(mr,fr,lr)}},{key:"_toParamString",value:function(){for(var mr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},fr="",lr=[],hr=0;hr<this._fields.length;++hr){fr=_r(fr,", ");var vr=this._fields[hr],br=this._values[0][hr],xr=this._valueOptions[0][hr];if(br===void 0)fr+=vr;else{var Tr=this._buildString(vr+" = "+this.options.parameterCharacter,[br],{buildParameterized:mr.buildParameterized,formattingOptions:xr});fr+=Tr.text,Tr.values.forEach(function(Mr){return lr.push(Mr)})}}return{text:fr.length?"ON DUPLICATE KEY UPDATE "+fr:"",values:lr}}}]),wr}(gr.AbstractSetFieldBlock),gr.Insert=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.StringBlock(mr,"INSERT"),new gr.IntoTableBlock(mr),new gr.InsertFieldValueBlock(mr),new gr.InsertFieldsFromQueryBlock(mr),new gr.MysqlOnDuplicateKeyUpdateBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder),gr.Replace=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.StringBlock(mr,"REPLACE"),new gr.IntoTableBlock(mr),new gr.InsertFieldValueBlock(mr),new gr.InsertFieldsFromQueryBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder),Fr.replace=function(Ar,wr){return new gr.Replace(Ar,wr)}},Yr.flavours.postgres=function(Fr){var gr=Fr.cls;gr.DefaultQueryBuilderOptions.numberedParameters=!0,gr.DefaultQueryBuilderOptions.numberedParametersStartAt=1,gr.DefaultQueryBuilderOptions.autoQuoteAliasNames=!1,gr.DefaultQueryBuilderOptions.useAsForTableAliasNames=!0,gr.PostgresOnConflictKeyUpdateBlock=function(Ar){function wr(){return sr(this,wr),nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).apply(this,arguments))}return ir(wr,Ar),Zt(wr,[{key:"onConflict",value:function(mr,fr){var lr=this;this._onConflict=!0,mr&&(Sr(mr)||(mr=[mr]),this._dupFields=mr.map(this._sanitizeField.bind(this)),fr&&Object.keys(fr).forEach(function(hr){lr._set(hr,fr[hr])}))}},{key:"_toParamString",value:function(){for(var mr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},fr="",lr=[],hr=0;hr<this._fields.length;++hr){fr=_r(fr,", ");var vr=this._fields[hr],br=this._values[0][hr],xr=this._valueOptions[0][hr];if(br===void 0)fr+=vr;else{var Tr=this._buildString(vr+" = "+this.options.parameterCharacter,[br],{buildParameterized:mr.buildParameterized,formattingOptions:xr});fr+=Tr.text,Tr.values.forEach(function(Jr){return lr.push(Jr)})}}var Mr={text:"",values:lr};if(this._onConflict){var Pr=this._dupFields?"("+this._dupFields.join(", ")+") ":"",qr=fr.length?"UPDATE SET "+fr:"NOTHING";Mr.text="ON CONFLICT "+Pr+"DO "+qr}return Mr}}]),wr}(gr.AbstractSetFieldBlock),gr.ReturningBlock=function(Ar){function wr(mr){sr(this,wr);var fr=nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr));return fr._fields=[],fr}return ir(wr,Ar),Zt(wr,[{key:"returning",value:function(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,lr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(fr=fr&&this._sanitizeFieldAlias(fr),mr=this._sanitizeField(mr),this._fields.filter(function(hr){return hr.name===mr&&hr.alias===fr}).length)return this;this._fields.push({name:mr,alias:fr,options:lr})}},{key:"_toParamString",value:function(){var mr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};mr.queryBuilder;var fr=mr.buildParameterized,lr="",hr=[],vr=!0,br=!1,xr=void 0;try{for(var Tr,Mr=this._fields[Symbol.iterator]();!(vr=(Tr=Mr.next()).done);vr=!0){var Pr=Tr.value;lr=_r(lr,", ");var qr=Pr.name,Jr=Pr.alias,zr=Pr.options;if(typeof qr=="string")lr+=this._formatFieldName(qr,zr);else{var Vr=qr._toParamString({nested:!0,buildParameterized:fr});lr+=Vr.text,Vr.values.forEach(function(Qr){return hr.push(Qr)})}Jr&&(lr+=" AS "+this._formatFieldAlias(Jr))}}catch(Qr){br=!0,xr=Qr}finally{try{!vr&&Mr.return&&Mr.return()}finally{if(br)throw xr}}return{text:lr.length>0?"RETURNING "+lr:"",values:hr}}}]),wr}(gr.Block),gr.WithBlock=function(Ar){function wr(mr){sr(this,wr);var fr=nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr));return fr._tables=[],fr}return ir(wr,Ar),Zt(wr,[{key:"with",value:function(mr,fr){this._tables.push({alias:mr,table:fr})}},{key:"_toParamString",value:function(){var mr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},fr=[],lr=[],hr=!0,vr=!1,br=void 0;try{for(var xr,Tr=this._tables[Symbol.iterator]();!(hr=(xr=Tr.next()).done);hr=!0){var Mr=xr.value,Pr=Mr.alias,qr=Mr.table._toParamString({buildParameterized:mr.buildParameterized,nested:!0});fr.push(Pr+" AS "+qr.text),qr.values.forEach(function(Jr){return lr.push(Jr)})}}catch(Jr){vr=!0,br=Jr}finally{try{!hr&&Tr.return&&Tr.return()}finally{if(vr)throw br}}return{text:fr.length?"WITH "+fr.join(", "):"",values:lr}}}]),wr}(gr.Block),gr.DistinctOnBlock=function(Ar){function wr(mr){sr(this,wr);var fr=nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr));return fr._distinctFields=[],fr}return ir(wr,Ar),Zt(wr,[{key:"distinct",value:function(){var mr=this;this._useDistinct=!0;for(var fr=arguments.length,lr=Array(fr),hr=0;hr<fr;hr++)lr[hr]=arguments[hr];lr.forEach(function(vr){mr._distinctFields.push(mr._sanitizeField(vr))})}},{key:"_toParamString",value:function(){var mr="";return this._useDistinct&&(mr="DISTINCT",this._distinctFields.length&&(mr+=" ON ("+this._distinctFields.join(", ")+")")),{text:mr,values:[]}}}]),wr}(gr.Block),gr.Select=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.WithBlock(mr),new gr.StringBlock(mr,"SELECT"),new gr.FunctionBlock(mr),new gr.DistinctOnBlock(mr),new gr.GetFieldBlock(mr),new gr.FromTableBlock(mr),new gr.JoinBlock(mr),new gr.WhereBlock(mr),new gr.GroupByBlock(mr),new gr.HavingBlock(mr),new gr.OrderByBlock(mr),new gr.LimitBlock(mr),new gr.OffsetBlock(mr),new gr.UnionBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder),gr.Insert=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.WithBlock(mr),new gr.StringBlock(mr,"INSERT"),new gr.IntoTableBlock(mr),new gr.InsertFieldValueBlock(mr),new gr.InsertFieldsFromQueryBlock(mr),new gr.PostgresOnConflictKeyUpdateBlock(mr),new gr.ReturningBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder),gr.Update=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.WithBlock(mr),new gr.StringBlock(mr,"UPDATE"),new gr.UpdateTableBlock(mr),new gr.SetFieldBlock(mr),new gr.FromTableBlock(mr),new gr.WhereBlock(mr),new gr.OrderByBlock(mr),new gr.LimitBlock(mr),new gr.ReturningBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder),gr.Delete=function(Ar){function wr(mr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return sr(this,wr),fr=fr||[new gr.WithBlock(mr),new gr.StringBlock(mr,"DELETE"),new gr.TargetTableBlock(mr),new gr.FromTableBlock(ar({},mr,{singleTable:!0})),new gr.JoinBlock(mr),new gr.WhereBlock(mr),new gr.OrderByBlock(mr),new gr.LimitBlock(mr),new gr.ReturningBlock(mr)],nr(this,(wr.__proto__||Object.getPrototypeOf(wr)).call(this,mr,fr))}return ir(wr,Ar),wr}(gr.QueryBuilder)},Yr}();var v=p(m.exports);function y(er,Zt){(function(tr,nr){tr.exec(`
    create table if not exists 'chat_logs_${nr}' (
        'client_msg_id' char(32),
        'server_msg_id' char(32),
        'send_id' char(32),
        'recv_id' char(32),
        'sender_platform_id' smallint,
        'sender_nick_name' varchar(255),
        'sender_face_url' varchar(255),
        'session_type' smallint,
        'msg_from' smallint,
        'content_type' smallint,
        'content' varchar(1000),
        'is_read' tinyint(1),
        'status' smallint,
        'seq' int DEFAULT 0,
        'send_time' int,
        'create_time' int,
        'attached_info' varchar(1024),
        'ex' varchar(1024),
        'local_ex' varchar(1024),
        'is_react' tinyint(1),
        'is_external_extensions' tinyint(1),
        'msg_first_modify_time' int,
        PRIMARY KEY ('client_msg_id')
      );
      `)})(er,Zt)}function b(er){return er.exec(`
        select * from local_super_groups;
    `)}function w(er,Zt){const tr=v.insert().into("local_friends").setFields(Zt).toString();return er.exec(tr)}function E(er,Zt){const tr=v.insert().into("local_groups").setFields(Zt).toString();return er.exec(tr)}function O(er){return er.exec(`
    SELECT * FROM local_groups
    `)}function S(er,Zt,tr){return er.exec(`INSERT INTO local_notification_seqs (conversation_id, seq) VALUES ("${Zt}", ${tr});`)}function k(er,Zt){const tr=Zt.map(nr=>`'${nr}'`);return er.exec(`
        select *
        from local_stranger
        WHERE user_id = (${tr.join(",")})
        `)}function R(er){return er.exec(`
      SELECT * FROM local_app_sdk_version LIMIT 1
        `)}function N(er,Zt,tr){return er.exec(`
      SELECT * FROM local_sync_version WHERE table_name = "${Zt}" AND entity_id = "${tr}"
    `)}function M(er,Zt,tr){let nr=er;return typeof er=="object"&&(nr=JSON.stringify(er)),{data:er!==void 0?nr:"{}",errCode:Zt||0,errMsg:tr||""}}const x=[["user_id","userID"],["group_id","groupID"],["client_msg_id","clientMsgID"],["server_msg_id","serverMsgID"],["send_id","sendID"],["recv_id","recvID"],["sender_platform_id","senderPlatformID"],["sender_nick_name","senderNickname"],["sender_face_url","senderFaceURL"],["session_type","sessionType"],["msg_from","msgFrom"],["content_type","contentType"],["content","content"],["is_read","isRead"],["is_react","isReact"],["is_external_extensions","isExternalExtensions"],["msg_first_modify_time","msgFirstModifyTime"],["status","status"],["seq","seq"],["send_time","sendTime"],["create_time","createTime"],["attached_info","attachedInfo"],["ex","ex"],["face_url","faceURL"],["creator_user_id","creatorUserID"],["conversation_id","conversationID"],["owner_user_id","ownerUserID"],["notification_user_id","notificationUserID"],["operator_user_id","operatorUserID"],["from_face_url","fromFaceURL"],["from_user_id","fromUserID"],["from_gender","fromGender"],["from_nickname","fromNickname"],["to_user_id","toUserID"],["to_nickname","toNickname"],["to_face_url","toFaceURL"],["to_gender","toGender"],["req_msg","reqMsg"],["handle_msg","handleMsg"],["handle_time","handleTime"],["handle_result","handleResult"],["handler_user_id","handlerUserID"],["handle_user_id","handleUserID"],["inviter_user_id","inviterUserID"],["mute_end_time","muteEndTime"],["role_level","roleLevel"],["join_time","joinTime"],["join_source","joinSource"],["friend_user_id","friendUserID"],["recv_msg_opt","recvMsgOpt"],["group_at_type","groupAtType"],["latest_msg_send_time","latestMsgSendTime"],["draft_text_time","draftTextTime"],["is_private_chat","isPrivateChat"],["is_not_in_group","isNotInGroup"],["update_unread_count_time","updateUnreadCountTime"],["is_msg_destruct","isMsgDestruct"],["msg_destruct_time","msgDestructTime"],["part_hash","partHash"],["upload_id","uploadID"],["upload_info","uploadInfo"],["expire_time","expireTime"],["entity_id","entityID"],["version_id","versionID"],["display_is_read","displayIsRead"]];function A(er){const Zt=function(ir){const sr=x.find(_r=>_r[0]===ir);if(sr)return sr[1]}(er);if(Zt)return Zt;const tr=[];let nr=-2;for(let ir=0;ir<er.length;ir++){const sr=er[ir];sr==="_"&&ir<er.length-1?nr=ir:ir-1===nr?tr.push(sr.toUpperCase()):tr.push(sr)}return tr.join("")}function I(er){const Zt=function(nr){const ir=x.find(sr=>sr[1]===nr);if(ir)return ir[0]}(er);if(Zt)return Zt;const tr=[];for(let nr=0;nr<er.length;nr++){const ir=er[nr];ir.toLowerCase()!==ir&&tr.push("_"),tr.push(ir.toLowerCase())}return tr.join("")}const T=/[\0\b\t\n\r\x1a"'\\]/g,C={"\0":"\\0","\b":"\\b","	":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};function F(er,Zt="CamelCase",tr=[],nr={}){const{columns:ir=[],values:sr=[]}=er||{},_r=[];return sr.forEach(ar=>{const Or={};ir.forEach((Sr,kr)=>{let Ir=Sr,Cr=ar[kr];Zt==="CamelCase"&&(Ir=A(Sr)),Zt==="SnakeCase"&&(Ir=I(Sr)),tr.find(Ur=>Ur===Ir)&&(Cr=!!Cr),Ir=nr[Sr]||Ir,Or[Ir]=Cr}),_r.push(Or)}),_r}function B(er,Zt=!0){const tr={};return Object.keys(er).forEach(nr=>{let ir=er[nr];Zt&&function(sr){return typeof sr=="string"}(ir)&&(ir=function(sr,_r={backslashSupported:!1}){if(sr==null)throw new Error("Need to pass a valid string");if(!(_r=_r||{}).backslashSupported)return"'"+sr.replace(/'/g,"''")+"'";const ar=T,Or=C;let Sr,kr=ar.lastIndex=0,Ir="";for(;Sr=ar.exec(sr);)Ir+=sr.slice(kr,Sr.index)+Or[Sr[0]],kr=ar.lastIndex;return kr===0?"'"+sr+"'":kr<sr.length?"'"+Ir+sr.slice(kr)+"'":"'"+Ir+"'"}(ir).slice(1,-1)),tr[I(nr)]=ir}),tr}function P(er,Zt={}){const tr={};return Object.keys(er).forEach(nr=>{const ir=Zt[nr]||nr;tr[ir]=er[nr]}),tr}var D=typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{};function $(){throw new Error("setTimeout has not been defined")}function L(){throw new Error("clearTimeout has not been defined")}var U=$,q=L;function j(er){if(U===setTimeout)return setTimeout(er,0);if((U===$||!U)&&setTimeout)return U=setTimeout,setTimeout(er,0);try{return U(er,0)}catch(Zt){try{return U.call(null,er,0)}catch(tr){return U.call(this,er,0)}}}typeof D.setTimeout=="function"&&(U=setTimeout),typeof D.clearTimeout=="function"&&(q=clearTimeout);var J,z=[],W=!1,H=-1;function G(){W&&J&&(W=!1,J.length?z=J.concat(z):H=-1,z.length&&Y())}function Y(){if(!W){var er=j(G);W=!0;for(var Zt=z.length;Zt;){for(J=z,z=[];++H<Zt;)J&&J[H].run();H=-1,Zt=z.length}J=null,W=!1,function(tr){if(q===clearTimeout)return clearTimeout(tr);if((q===L||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(tr);try{return q(tr)}catch(nr){try{return q.call(null,tr)}catch(ir){return q.call(this,tr)}}}(er)}}function V(er,Zt){this.fun=er,this.array=Zt}V.prototype.run=function(){this.fun.apply(null,this.array)};function Q(){}var K=Q,X=Q,Z=Q,ee=Q,te=Q,re=Q,ne=Q,ie=D.performance||{},oe=ie.now||ie.mozNow||ie.msNow||ie.oNow||ie.webkitNow||function(){return new Date().getTime()},se=new Date,ae={nextTick:function(er){var Zt=new Array(arguments.length-1);if(arguments.length>1)for(var tr=1;tr<arguments.length;tr++)Zt[tr-1]=arguments[tr];z.push(new V(er,Zt)),z.length!==1||W||j(Y)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:K,addListener:X,once:Z,off:ee,removeListener:te,removeAllListeners:re,emit:ne,binding:function(er){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(er){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(er){var Zt=.001*oe.call(ie),tr=Math.floor(Zt),nr=Math.floor(Zt%1*1e9);return er&&(tr-=er[0],(nr-=er[1])<0&&(tr--,nr+=1e9)),[tr,nr]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-se)/1e3}},ue=[],ce=[],le=typeof Uint8Array!="undefined"?Uint8Array:Array,fe=!1;function de(){fe=!0;for(var er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zt=0;Zt<64;++Zt)ue[Zt]=er[Zt],ce[er.charCodeAt(Zt)]=Zt;ce["-".charCodeAt(0)]=62,ce["_".charCodeAt(0)]=63}function he(er,Zt,tr){for(var nr,ir,sr=[],_r=Zt;_r<tr;_r+=3)nr=(er[_r]<<16)+(er[_r+1]<<8)+er[_r+2],sr.push(ue[(ir=nr)>>18&63]+ue[ir>>12&63]+ue[ir>>6&63]+ue[63&ir]);return sr.join("")}function _e(er){var Zt;fe||de();for(var tr=er.length,nr=tr%3,ir="",sr=[],_r=16383,ar=0,Or=tr-nr;ar<Or;ar+=_r)sr.push(he(er,ar,ar+_r>Or?Or:ar+_r));return nr===1?(Zt=er[tr-1],ir+=ue[Zt>>2],ir+=ue[Zt<<4&63],ir+="=="):nr===2&&(Zt=(er[tr-2]<<8)+er[tr-1],ir+=ue[Zt>>10],ir+=ue[Zt>>4&63],ir+=ue[Zt<<2&63],ir+="="),sr.push(ir),sr.join("")}function pe(er,Zt,tr,nr,ir){var sr,_r,ar=8*ir-nr-1,Or=(1<<ar)-1,Sr=Or>>1,kr=-7,Ir=tr?ir-1:0,Cr=tr?-1:1,Ur=er[Zt+Ir];for(Ir+=Cr,sr=Ur&(1<<-kr)-1,Ur>>=-kr,kr+=ar;kr>0;sr=256*sr+er[Zt+Ir],Ir+=Cr,kr-=8);for(_r=sr&(1<<-kr)-1,sr>>=-kr,kr+=nr;kr>0;_r=256*_r+er[Zt+Ir],Ir+=Cr,kr-=8);if(sr===0)sr=1-Sr;else{if(sr===Or)return _r?NaN:1/0*(Ur?-1:1);_r+=Math.pow(2,nr),sr-=Sr}return(Ur?-1:1)*_r*Math.pow(2,sr-nr)}function ge(er,Zt,tr,nr,ir,sr){var _r,ar,Or,Sr=8*sr-ir-1,kr=(1<<Sr)-1,Ir=kr>>1,Cr=ir===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ur=nr?0:sr-1,Wr=nr?1:-1,Yr=Zt<0||Zt===0&&1/Zt<0?1:0;for(Zt=Math.abs(Zt),isNaN(Zt)||Zt===1/0?(ar=isNaN(Zt)?1:0,_r=kr):(_r=Math.floor(Math.log(Zt)/Math.LN2),Zt*(Or=Math.pow(2,-_r))<1&&(_r--,Or*=2),(Zt+=_r+Ir>=1?Cr/Or:Cr*Math.pow(2,1-Ir))*Or>=2&&(_r++,Or/=2),_r+Ir>=kr?(ar=0,_r=kr):_r+Ir>=1?(ar=(Zt*Or-1)*Math.pow(2,ir),_r+=Ir):(ar=Zt*Math.pow(2,Ir-1)*Math.pow(2,ir),_r=0));ir>=8;er[tr+Ur]=255&ar,Ur+=Wr,ar/=256,ir-=8);for(_r=_r<<ir|ar,Sr+=ir;Sr>0;er[tr+Ur]=255&_r,Ur+=Wr,_r/=256,Sr-=8);er[tr+Ur-Wr]|=128*Yr}var me={}.toString,ve=Array.isArray||function(er){return me.call(er)=="[object Array]"};function ye(){return we.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function be(er,Zt){if(ye()<Zt)throw new RangeError("Invalid typed array length");return we.TYPED_ARRAY_SUPPORT?(er=new Uint8Array(Zt)).__proto__=we.prototype:(er===null&&(er=new we(Zt)),er.length=Zt),er}function we(er,Zt,tr){if(!(we.TYPED_ARRAY_SUPPORT||this instanceof we))return new we(er,Zt,tr);if(typeof er=="number"){if(typeof Zt=="string")throw new Error("If encoding is specified then the first argument must be a string");return Se(this,er)}return Ee(this,er,Zt,tr)}function Ee(er,Zt,tr,nr){if(typeof Zt=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&Zt instanceof ArrayBuffer?function(ir,sr,_r,ar){if(sr.byteLength,_r<0||sr.byteLength<_r)throw new RangeError("'offset' is out of bounds");if(sr.byteLength<_r+(ar||0))throw new RangeError("'length' is out of bounds");return sr=_r===void 0&&ar===void 0?new Uint8Array(sr):ar===void 0?new Uint8Array(sr,_r):new Uint8Array(sr,_r,ar),we.TYPED_ARRAY_SUPPORT?(ir=sr).__proto__=we.prototype:ir=ke(ir,sr),ir}(er,Zt,tr,nr):typeof Zt=="string"?function(ir,sr,_r){if(typeof _r=="string"&&_r!==""||(_r="utf8"),!we.isEncoding(_r))throw new TypeError('"encoding" must be a valid string encoding');var ar=0|Me(sr,_r);ir=be(ir,ar);var Or=ir.write(sr,_r);return Or!==ar&&(ir=ir.slice(0,Or)),ir}(er,Zt,tr):function(ir,sr){if(Ne(sr)){var _r=0|Re(sr.length);return(ir=be(ir,_r)).length===0||sr.copy(ir,0,0,_r),ir}if(sr){if(typeof ArrayBuffer!="undefined"&&sr.buffer instanceof ArrayBuffer||"length"in sr)return typeof sr.length!="number"||(ar=sr.length)!=ar?be(ir,0):ke(ir,sr);if(sr.type==="Buffer"&&ve(sr.data))return ke(ir,sr.data)}var ar;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(er,Zt)}function Oe(er){if(typeof er!="number")throw new TypeError('"size" argument must be a number');if(er<0)throw new RangeError('"size" argument must not be negative')}function Se(er,Zt){if(Oe(Zt),er=be(er,Zt<0?0:0|Re(Zt)),!we.TYPED_ARRAY_SUPPORT)for(var tr=0;tr<Zt;++tr)er[tr]=0;return er}function ke(er,Zt){var tr=Zt.length<0?0:0|Re(Zt.length);er=be(er,tr);for(var nr=0;nr<tr;nr+=1)er[nr]=255&Zt[nr];return er}function Re(er){if(er>=ye())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ye().toString(16)+" bytes");return 0|er}function Ne(er){return!(er==null||!er._isBuffer)}function Me(er,Zt){if(Ne(er))return er.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(er)||er instanceof ArrayBuffer))return er.byteLength;typeof er!="string"&&(er=""+er);var tr=er.length;if(tr===0)return 0;for(var nr=!1;;)switch(Zt){case"ascii":case"latin1":case"binary":return tr;case"utf8":case"utf-8":case void 0:return tt(er).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*tr;case"hex":return tr>>>1;case"base64":return rt(er).length;default:if(nr)return tt(er).length;Zt=(""+Zt).toLowerCase(),nr=!0}}function xe(er,Zt,tr){var nr=!1;if((Zt===void 0||Zt<0)&&(Zt=0),Zt>this.length||((tr===void 0||tr>this.length)&&(tr=this.length),tr<=0)||(tr>>>=0)<=(Zt>>>=0))return"";for(er||(er="utf8");;)switch(er){case"hex":return ze(this,Zt,tr);case"utf8":case"utf-8":return Ue(this,Zt,tr);case"ascii":return je(this,Zt,tr);case"latin1":case"binary":return Je(this,Zt,tr);case"base64":return Le(this,Zt,tr);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return We(this,Zt,tr);default:if(nr)throw new TypeError("Unknown encoding: "+er);er=(er+"").toLowerCase(),nr=!0}}function Ae(er,Zt,tr){var nr=er[Zt];er[Zt]=er[tr],er[tr]=nr}function Ie(er,Zt,tr,nr,ir){if(er.length===0)return-1;if(typeof tr=="string"?(nr=tr,tr=0):tr>2147483647?tr=2147483647:tr<-2147483648&&(tr=-2147483648),tr=+tr,isNaN(tr)&&(tr=ir?0:er.length-1),tr<0&&(tr=er.length+tr),tr>=er.length){if(ir)return-1;tr=er.length-1}else if(tr<0){if(!ir)return-1;tr=0}if(typeof Zt=="string"&&(Zt=we.from(Zt,nr)),Ne(Zt))return Zt.length===0?-1:Te(er,Zt,tr,nr,ir);if(typeof Zt=="number")return Zt&=255,we.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?ir?Uint8Array.prototype.indexOf.call(er,Zt,tr):Uint8Array.prototype.lastIndexOf.call(er,Zt,tr):Te(er,[Zt],tr,nr,ir);throw new TypeError("val must be string, number or Buffer")}function Te(er,Zt,tr,nr,ir){var sr,_r=1,ar=er.length,Or=Zt.length;if(nr!==void 0&&((nr=String(nr).toLowerCase())==="ucs2"||nr==="ucs-2"||nr==="utf16le"||nr==="utf-16le")){if(er.length<2||Zt.length<2)return-1;_r=2,ar/=2,Or/=2,tr/=2}function Sr(Ur,Wr){return _r===1?Ur[Wr]:Ur.readUInt16BE(Wr*_r)}if(ir){var kr=-1;for(sr=tr;sr<ar;sr++)if(Sr(er,sr)===Sr(Zt,kr===-1?0:sr-kr)){if(kr===-1&&(kr=sr),sr-kr+1===Or)return kr*_r}else kr!==-1&&(sr-=sr-kr),kr=-1}else for(tr+Or>ar&&(tr=ar-Or),sr=tr;sr>=0;sr--){for(var Ir=!0,Cr=0;Cr<Or;Cr++)if(Sr(er,sr+Cr)!==Sr(Zt,Cr)){Ir=!1;break}if(Ir)return sr}return-1}function Ce(er,Zt,tr,nr){tr=Number(tr)||0;var ir=er.length-tr;nr?(nr=Number(nr))>ir&&(nr=ir):nr=ir;var sr=Zt.length;if(sr%2!=0)throw new TypeError("Invalid hex string");nr>sr/2&&(nr=sr/2);for(var _r=0;_r<nr;++_r){var ar=parseInt(Zt.substr(2*_r,2),16);if(isNaN(ar))return _r;er[tr+_r]=ar}return _r}function Fe(er,Zt,tr,nr){return nt(tt(Zt,er.length-tr),er,tr,nr)}function Be(er,Zt,tr,nr){return nt(function(ir){for(var sr=[],_r=0;_r<ir.length;++_r)sr.push(255&ir.charCodeAt(_r));return sr}(Zt),er,tr,nr)}function Pe(er,Zt,tr,nr){return Be(er,Zt,tr,nr)}function De(er,Zt,tr,nr){return nt(rt(Zt),er,tr,nr)}function $e(er,Zt,tr,nr){return nt(function(ir,sr){for(var _r,ar,Or,Sr=[],kr=0;kr<ir.length&&!((sr-=2)<0);++kr)ar=(_r=ir.charCodeAt(kr))>>8,Or=_r%256,Sr.push(Or),Sr.push(ar);return Sr}(Zt,er.length-tr),er,tr,nr)}function Le(er,Zt,tr){return Zt===0&&tr===er.length?_e(er):_e(er.slice(Zt,tr))}function Ue(er,Zt,tr){tr=Math.min(er.length,tr);for(var nr=[],ir=Zt;ir<tr;){var sr,_r,ar,Or,Sr=er[ir],kr=null,Ir=Sr>239?4:Sr>223?3:Sr>191?2:1;if(ir+Ir<=tr)switch(Ir){case 1:Sr<128&&(kr=Sr);break;case 2:(192&(sr=er[ir+1]))==128&&(Or=(31&Sr)<<6|63&sr)>127&&(kr=Or);break;case 3:sr=er[ir+1],_r=er[ir+2],(192&sr)==128&&(192&_r)==128&&(Or=(15&Sr)<<12|(63&sr)<<6|63&_r)>2047&&(Or<55296||Or>57343)&&(kr=Or);break;case 4:sr=er[ir+1],_r=er[ir+2],ar=er[ir+3],(192&sr)==128&&(192&_r)==128&&(192&ar)==128&&(Or=(15&Sr)<<18|(63&sr)<<12|(63&_r)<<6|63&ar)>65535&&Or<1114112&&(kr=Or)}kr===null?(kr=65533,Ir=1):kr>65535&&(kr-=65536,nr.push(kr>>>10&1023|55296),kr=56320|1023&kr),nr.push(kr),ir+=Ir}return function(Cr){var Ur=Cr.length;if(Ur<=qe)return String.fromCharCode.apply(String,Cr);for(var Wr="",Yr=0;Yr<Ur;)Wr+=String.fromCharCode.apply(String,Cr.slice(Yr,Yr+=qe));return Wr}(nr)}we.TYPED_ARRAY_SUPPORT=D.TYPED_ARRAY_SUPPORT===void 0||D.TYPED_ARRAY_SUPPORT,ye(),we.poolSize=8192,we._augment=function(er){return er.__proto__=we.prototype,er},we.from=function(er,Zt,tr){return Ee(null,er,Zt,tr)},we.TYPED_ARRAY_SUPPORT&&(we.prototype.__proto__=Uint8Array.prototype,we.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&we[Symbol.species]),we.alloc=function(er,Zt,tr){return function(nr,ir,sr,_r){return Oe(ir),ir<=0?be(nr,ir):sr!==void 0?typeof _r=="string"?be(nr,ir).fill(sr,_r):be(nr,ir).fill(sr):be(nr,ir)}(null,er,Zt,tr)},we.allocUnsafe=function(er){return Se(null,er)},we.allocUnsafeSlow=function(er){return Se(null,er)},we.isBuffer=function(er){return er!=null&&(!!er._isBuffer||it(er)||function(Zt){return typeof Zt.readFloatLE=="function"&&typeof Zt.slice=="function"&&it(Zt.slice(0,0))}(er))},we.compare=function(er,Zt){if(!Ne(er)||!Ne(Zt))throw new TypeError("Arguments must be Buffers");if(er===Zt)return 0;for(var tr=er.length,nr=Zt.length,ir=0,sr=Math.min(tr,nr);ir<sr;++ir)if(er[ir]!==Zt[ir]){tr=er[ir],nr=Zt[ir];break}return tr<nr?-1:nr<tr?1:0},we.isEncoding=function(er){switch(String(er).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},we.concat=function(er,Zt){if(!ve(er))throw new TypeError('"list" argument must be an Array of Buffers');if(er.length===0)return we.alloc(0);var tr;if(Zt===void 0)for(Zt=0,tr=0;tr<er.length;++tr)Zt+=er[tr].length;var nr=we.allocUnsafe(Zt),ir=0;for(tr=0;tr<er.length;++tr){var sr=er[tr];if(!Ne(sr))throw new TypeError('"list" argument must be an Array of Buffers');sr.copy(nr,ir),ir+=sr.length}return nr},we.byteLength=Me,we.prototype._isBuffer=!0,we.prototype.swap16=function(){var er=this.length;if(er%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Zt=0;Zt<er;Zt+=2)Ae(this,Zt,Zt+1);return this},we.prototype.swap32=function(){var er=this.length;if(er%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Zt=0;Zt<er;Zt+=4)Ae(this,Zt,Zt+3),Ae(this,Zt+1,Zt+2);return this},we.prototype.swap64=function(){var er=this.length;if(er%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Zt=0;Zt<er;Zt+=8)Ae(this,Zt,Zt+7),Ae(this,Zt+1,Zt+6),Ae(this,Zt+2,Zt+5),Ae(this,Zt+3,Zt+4);return this},we.prototype.toString=function(){var er=0|this.length;return er===0?"":arguments.length===0?Ue(this,0,er):xe.apply(this,arguments)},we.prototype.equals=function(er){if(!Ne(er))throw new TypeError("Argument must be a Buffer");return this===er||we.compare(this,er)===0},we.prototype.inspect=function(){var er="";return this.length>0&&(er=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(er+=" ... ")),"<Buffer "+er+">"},we.prototype.compare=function(er,Zt,tr,nr,ir){if(!Ne(er))throw new TypeError("Argument must be a Buffer");if(Zt===void 0&&(Zt=0),tr===void 0&&(tr=er?er.length:0),nr===void 0&&(nr=0),ir===void 0&&(ir=this.length),Zt<0||tr>er.length||nr<0||ir>this.length)throw new RangeError("out of range index");if(nr>=ir&&Zt>=tr)return 0;if(nr>=ir)return-1;if(Zt>=tr)return 1;if(this===er)return 0;for(var sr=(ir>>>=0)-(nr>>>=0),_r=(tr>>>=0)-(Zt>>>=0),ar=Math.min(sr,_r),Or=this.slice(nr,ir),Sr=er.slice(Zt,tr),kr=0;kr<ar;++kr)if(Or[kr]!==Sr[kr]){sr=Or[kr],_r=Sr[kr];break}return sr<_r?-1:_r<sr?1:0},we.prototype.includes=function(er,Zt,tr){return this.indexOf(er,Zt,tr)!==-1},we.prototype.indexOf=function(er,Zt,tr){return Ie(this,er,Zt,tr,!0)},we.prototype.lastIndexOf=function(er,Zt,tr){return Ie(this,er,Zt,tr,!1)},we.prototype.write=function(er,Zt,tr,nr){if(Zt===void 0)nr="utf8",tr=this.length,Zt=0;else if(tr===void 0&&typeof Zt=="string")nr=Zt,tr=this.length,Zt=0;else{if(!isFinite(Zt))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");Zt|=0,isFinite(tr)?(tr|=0,nr===void 0&&(nr="utf8")):(nr=tr,tr=void 0)}var ir=this.length-Zt;if((tr===void 0||tr>ir)&&(tr=ir),er.length>0&&(tr<0||Zt<0)||Zt>this.length)throw new RangeError("Attempt to write outside buffer bounds");nr||(nr="utf8");for(var sr=!1;;)switch(nr){case"hex":return Ce(this,er,Zt,tr);case"utf8":case"utf-8":return Fe(this,er,Zt,tr);case"ascii":return Be(this,er,Zt,tr);case"latin1":case"binary":return Pe(this,er,Zt,tr);case"base64":return De(this,er,Zt,tr);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $e(this,er,Zt,tr);default:if(sr)throw new TypeError("Unknown encoding: "+nr);nr=(""+nr).toLowerCase(),sr=!0}},we.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var qe=4096;function je(er,Zt,tr){var nr="";tr=Math.min(er.length,tr);for(var ir=Zt;ir<tr;++ir)nr+=String.fromCharCode(127&er[ir]);return nr}function Je(er,Zt,tr){var nr="";tr=Math.min(er.length,tr);for(var ir=Zt;ir<tr;++ir)nr+=String.fromCharCode(er[ir]);return nr}function ze(er,Zt,tr){var nr=er.length;(!Zt||Zt<0)&&(Zt=0),(!tr||tr<0||tr>nr)&&(tr=nr);for(var ir="",sr=Zt;sr<tr;++sr)ir+=et(er[sr]);return ir}function We(er,Zt,tr){for(var nr=er.slice(Zt,tr),ir="",sr=0;sr<nr.length;sr+=2)ir+=String.fromCharCode(nr[sr]+256*nr[sr+1]);return ir}function He(er,Zt,tr){if(er%1!=0||er<0)throw new RangeError("offset is not uint");if(er+Zt>tr)throw new RangeError("Trying to access beyond buffer length")}function Ge(er,Zt,tr,nr,ir,sr){if(!Ne(er))throw new TypeError('"buffer" argument must be a Buffer instance');if(Zt>ir||Zt<sr)throw new RangeError('"value" argument is out of bounds');if(tr+nr>er.length)throw new RangeError("Index out of range")}function Ye(er,Zt,tr,nr){Zt<0&&(Zt=65535+Zt+1);for(var ir=0,sr=Math.min(er.length-tr,2);ir<sr;++ir)er[tr+ir]=(Zt&255<<8*(nr?ir:1-ir))>>>8*(nr?ir:1-ir)}function Ve(er,Zt,tr,nr){Zt<0&&(Zt=4294967295+Zt+1);for(var ir=0,sr=Math.min(er.length-tr,4);ir<sr;++ir)er[tr+ir]=Zt>>>8*(nr?ir:3-ir)&255}function Qe(er,Zt,tr,nr,ir,sr){if(tr+nr>er.length)throw new RangeError("Index out of range");if(tr<0)throw new RangeError("Index out of range")}function Ke(er,Zt,tr,nr,ir){return ir||Qe(er,0,tr,4),ge(er,Zt,tr,nr,23,4),tr+4}function Xe(er,Zt,tr,nr,ir){return ir||Qe(er,0,tr,8),ge(er,Zt,tr,nr,52,8),tr+8}we.prototype.slice=function(er,Zt){var tr,nr=this.length;if((er=~~er)<0?(er+=nr)<0&&(er=0):er>nr&&(er=nr),(Zt=Zt===void 0?nr:~~Zt)<0?(Zt+=nr)<0&&(Zt=0):Zt>nr&&(Zt=nr),Zt<er&&(Zt=er),we.TYPED_ARRAY_SUPPORT)(tr=this.subarray(er,Zt)).__proto__=we.prototype;else{var ir=Zt-er;tr=new we(ir,void 0);for(var sr=0;sr<ir;++sr)tr[sr]=this[sr+er]}return tr},we.prototype.readUIntLE=function(er,Zt,tr){er|=0,Zt|=0,tr||He(er,Zt,this.length);for(var nr=this[er],ir=1,sr=0;++sr<Zt&&(ir*=256);)nr+=this[er+sr]*ir;return nr},we.prototype.readUIntBE=function(er,Zt,tr){er|=0,Zt|=0,tr||He(er,Zt,this.length);for(var nr=this[er+--Zt],ir=1;Zt>0&&(ir*=256);)nr+=this[er+--Zt]*ir;return nr},we.prototype.readUInt8=function(er,Zt){return Zt||He(er,1,this.length),this[er]},we.prototype.readUInt16LE=function(er,Zt){return Zt||He(er,2,this.length),this[er]|this[er+1]<<8},we.prototype.readUInt16BE=function(er,Zt){return Zt||He(er,2,this.length),this[er]<<8|this[er+1]},we.prototype.readUInt32LE=function(er,Zt){return Zt||He(er,4,this.length),(this[er]|this[er+1]<<8|this[er+2]<<16)+16777216*this[er+3]},we.prototype.readUInt32BE=function(er,Zt){return Zt||He(er,4,this.length),16777216*this[er]+(this[er+1]<<16|this[er+2]<<8|this[er+3])},we.prototype.readIntLE=function(er,Zt,tr){er|=0,Zt|=0,tr||He(er,Zt,this.length);for(var nr=this[er],ir=1,sr=0;++sr<Zt&&(ir*=256);)nr+=this[er+sr]*ir;return nr>=(ir*=128)&&(nr-=Math.pow(2,8*Zt)),nr},we.prototype.readIntBE=function(er,Zt,tr){er|=0,Zt|=0,tr||He(er,Zt,this.length);for(var nr=Zt,ir=1,sr=this[er+--nr];nr>0&&(ir*=256);)sr+=this[er+--nr]*ir;return sr>=(ir*=128)&&(sr-=Math.pow(2,8*Zt)),sr},we.prototype.readInt8=function(er,Zt){return Zt||He(er,1,this.length),128&this[er]?-1*(255-this[er]+1):this[er]},we.prototype.readInt16LE=function(er,Zt){Zt||He(er,2,this.length);var tr=this[er]|this[er+1]<<8;return 32768&tr?4294901760|tr:tr},we.prototype.readInt16BE=function(er,Zt){Zt||He(er,2,this.length);var tr=this[er+1]|this[er]<<8;return 32768&tr?4294901760|tr:tr},we.prototype.readInt32LE=function(er,Zt){return Zt||He(er,4,this.length),this[er]|this[er+1]<<8|this[er+2]<<16|this[er+3]<<24},we.prototype.readInt32BE=function(er,Zt){return Zt||He(er,4,this.length),this[er]<<24|this[er+1]<<16|this[er+2]<<8|this[er+3]},we.prototype.readFloatLE=function(er,Zt){return Zt||He(er,4,this.length),pe(this,er,!0,23,4)},we.prototype.readFloatBE=function(er,Zt){return Zt||He(er,4,this.length),pe(this,er,!1,23,4)},we.prototype.readDoubleLE=function(er,Zt){return Zt||He(er,8,this.length),pe(this,er,!0,52,8)},we.prototype.readDoubleBE=function(er,Zt){return Zt||He(er,8,this.length),pe(this,er,!1,52,8)},we.prototype.writeUIntLE=function(er,Zt,tr,nr){er=+er,Zt|=0,tr|=0,nr||Ge(this,er,Zt,tr,Math.pow(2,8*tr)-1,0);var ir=1,sr=0;for(this[Zt]=255&er;++sr<tr&&(ir*=256);)this[Zt+sr]=er/ir&255;return Zt+tr},we.prototype.writeUIntBE=function(er,Zt,tr,nr){er=+er,Zt|=0,tr|=0,nr||Ge(this,er,Zt,tr,Math.pow(2,8*tr)-1,0);var ir=tr-1,sr=1;for(this[Zt+ir]=255&er;--ir>=0&&(sr*=256);)this[Zt+ir]=er/sr&255;return Zt+tr},we.prototype.writeUInt8=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,1,255,0),we.TYPED_ARRAY_SUPPORT||(er=Math.floor(er)),this[Zt]=255&er,Zt+1},we.prototype.writeUInt16LE=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,2,65535,0),we.TYPED_ARRAY_SUPPORT?(this[Zt]=255&er,this[Zt+1]=er>>>8):Ye(this,er,Zt,!0),Zt+2},we.prototype.writeUInt16BE=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,2,65535,0),we.TYPED_ARRAY_SUPPORT?(this[Zt]=er>>>8,this[Zt+1]=255&er):Ye(this,er,Zt,!1),Zt+2},we.prototype.writeUInt32LE=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,4,4294967295,0),we.TYPED_ARRAY_SUPPORT?(this[Zt+3]=er>>>24,this[Zt+2]=er>>>16,this[Zt+1]=er>>>8,this[Zt]=255&er):Ve(this,er,Zt,!0),Zt+4},we.prototype.writeUInt32BE=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,4,4294967295,0),we.TYPED_ARRAY_SUPPORT?(this[Zt]=er>>>24,this[Zt+1]=er>>>16,this[Zt+2]=er>>>8,this[Zt+3]=255&er):Ve(this,er,Zt,!1),Zt+4},we.prototype.writeIntLE=function(er,Zt,tr,nr){if(er=+er,Zt|=0,!nr){var ir=Math.pow(2,8*tr-1);Ge(this,er,Zt,tr,ir-1,-ir)}var sr=0,_r=1,ar=0;for(this[Zt]=255&er;++sr<tr&&(_r*=256);)er<0&&ar===0&&this[Zt+sr-1]!==0&&(ar=1),this[Zt+sr]=(er/_r>>0)-ar&255;return Zt+tr},we.prototype.writeIntBE=function(er,Zt,tr,nr){if(er=+er,Zt|=0,!nr){var ir=Math.pow(2,8*tr-1);Ge(this,er,Zt,tr,ir-1,-ir)}var sr=tr-1,_r=1,ar=0;for(this[Zt+sr]=255&er;--sr>=0&&(_r*=256);)er<0&&ar===0&&this[Zt+sr+1]!==0&&(ar=1),this[Zt+sr]=(er/_r>>0)-ar&255;return Zt+tr},we.prototype.writeInt8=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,1,127,-128),we.TYPED_ARRAY_SUPPORT||(er=Math.floor(er)),er<0&&(er=255+er+1),this[Zt]=255&er,Zt+1},we.prototype.writeInt16LE=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,2,32767,-32768),we.TYPED_ARRAY_SUPPORT?(this[Zt]=255&er,this[Zt+1]=er>>>8):Ye(this,er,Zt,!0),Zt+2},we.prototype.writeInt16BE=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,2,32767,-32768),we.TYPED_ARRAY_SUPPORT?(this[Zt]=er>>>8,this[Zt+1]=255&er):Ye(this,er,Zt,!1),Zt+2},we.prototype.writeInt32LE=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,4,2147483647,-2147483648),we.TYPED_ARRAY_SUPPORT?(this[Zt]=255&er,this[Zt+1]=er>>>8,this[Zt+2]=er>>>16,this[Zt+3]=er>>>24):Ve(this,er,Zt,!0),Zt+4},we.prototype.writeInt32BE=function(er,Zt,tr){return er=+er,Zt|=0,tr||Ge(this,er,Zt,4,2147483647,-2147483648),er<0&&(er=4294967295+er+1),we.TYPED_ARRAY_SUPPORT?(this[Zt]=er>>>24,this[Zt+1]=er>>>16,this[Zt+2]=er>>>8,this[Zt+3]=255&er):Ve(this,er,Zt,!1),Zt+4},we.prototype.writeFloatLE=function(er,Zt,tr){return Ke(this,er,Zt,!0,tr)},we.prototype.writeFloatBE=function(er,Zt,tr){return Ke(this,er,Zt,!1,tr)},we.prototype.writeDoubleLE=function(er,Zt,tr){return Xe(this,er,Zt,!0,tr)},we.prototype.writeDoubleBE=function(er,Zt,tr){return Xe(this,er,Zt,!1,tr)},we.prototype.copy=function(er,Zt,tr,nr){if(tr||(tr=0),nr||nr===0||(nr=this.length),Zt>=er.length&&(Zt=er.length),Zt||(Zt=0),nr>0&&nr<tr&&(nr=tr),nr===tr||er.length===0||this.length===0)return 0;if(Zt<0)throw new RangeError("targetStart out of bounds");if(tr<0||tr>=this.length)throw new RangeError("sourceStart out of bounds");if(nr<0)throw new RangeError("sourceEnd out of bounds");nr>this.length&&(nr=this.length),er.length-Zt<nr-tr&&(nr=er.length-Zt+tr);var ir,sr=nr-tr;if(this===er&&tr<Zt&&Zt<nr)for(ir=sr-1;ir>=0;--ir)er[ir+Zt]=this[ir+tr];else if(sr<1e3||!we.TYPED_ARRAY_SUPPORT)for(ir=0;ir<sr;++ir)er[ir+Zt]=this[ir+tr];else Uint8Array.prototype.set.call(er,this.subarray(tr,tr+sr),Zt);return sr},we.prototype.fill=function(er,Zt,tr,nr){if(typeof er=="string"){if(typeof Zt=="string"?(nr=Zt,Zt=0,tr=this.length):typeof tr=="string"&&(nr=tr,tr=this.length),er.length===1){var ir=er.charCodeAt(0);ir<256&&(er=ir)}if(nr!==void 0&&typeof nr!="string")throw new TypeError("encoding must be a string");if(typeof nr=="string"&&!we.isEncoding(nr))throw new TypeError("Unknown encoding: "+nr)}else typeof er=="number"&&(er&=255);if(Zt<0||this.length<Zt||this.length<tr)throw new RangeError("Out of range index");if(tr<=Zt)return this;var sr;if(Zt>>>=0,tr=tr===void 0?this.length:tr>>>0,er||(er=0),typeof er=="number")for(sr=Zt;sr<tr;++sr)this[sr]=er;else{var _r=Ne(er)?er:tt(new we(er,nr).toString()),ar=_r.length;for(sr=0;sr<tr-Zt;++sr)this[sr+Zt]=_r[sr%ar]}return this};var Ze=/[^+\/0-9A-Za-z-_]/g;function et(er){return er<16?"0"+er.toString(16):er.toString(16)}function tt(er,Zt){var tr;Zt=Zt||1/0;for(var nr=er.length,ir=null,sr=[],_r=0;_r<nr;++_r){if((tr=er.charCodeAt(_r))>55295&&tr<57344){if(!ir){if(tr>56319){(Zt-=3)>-1&&sr.push(239,191,189);continue}if(_r+1===nr){(Zt-=3)>-1&&sr.push(239,191,189);continue}ir=tr;continue}if(tr<56320){(Zt-=3)>-1&&sr.push(239,191,189),ir=tr;continue}tr=65536+(ir-55296<<10|tr-56320)}else ir&&(Zt-=3)>-1&&sr.push(239,191,189);if(ir=null,tr<128){if((Zt-=1)<0)break;sr.push(tr)}else if(tr<2048){if((Zt-=2)<0)break;sr.push(tr>>6|192,63&tr|128)}else if(tr<65536){if((Zt-=3)<0)break;sr.push(tr>>12|224,tr>>6&63|128,63&tr|128)}else{if(!(tr<1114112))throw new Error("Invalid code point");if((Zt-=4)<0)break;sr.push(tr>>18|240,tr>>12&63|128,tr>>6&63|128,63&tr|128)}}return sr}function rt(er){return function(Zt){var tr,nr,ir,sr,_r,ar;fe||de();var Or=Zt.length;if(Or%4>0)throw new Error("Invalid string. Length must be a multiple of 4");_r=Zt[Or-2]==="="?2:Zt[Or-1]==="="?1:0,ar=new le(3*Or/4-_r),ir=_r>0?Or-4:Or;var Sr=0;for(tr=0,nr=0;tr<ir;tr+=4,nr+=3)sr=ce[Zt.charCodeAt(tr)]<<18|ce[Zt.charCodeAt(tr+1)]<<12|ce[Zt.charCodeAt(tr+2)]<<6|ce[Zt.charCodeAt(tr+3)],ar[Sr++]=sr>>16&255,ar[Sr++]=sr>>8&255,ar[Sr++]=255&sr;return _r===2?(sr=ce[Zt.charCodeAt(tr)]<<2|ce[Zt.charCodeAt(tr+1)]>>4,ar[Sr++]=255&sr):_r===1&&(sr=ce[Zt.charCodeAt(tr)]<<10|ce[Zt.charCodeAt(tr+1)]<<4|ce[Zt.charCodeAt(tr+2)]>>2,ar[Sr++]=sr>>8&255,ar[Sr++]=255&sr),ar}(function(Zt){if((Zt=function(tr){return tr.trim?tr.trim():tr.replace(/^\s+|\s+$/g,"")}(Zt).replace(Ze,"")).length<2)return"";for(;Zt.length%4!=0;)Zt+="=";return Zt}(er))}function nt(er,Zt,tr,nr){for(var ir=0;ir<nr&&!(ir+tr>=Zt.length||ir>=er.length);++ir)Zt[ir+tr]=er[ir];return ir}function it(er){return!!er.constructor&&typeof er.constructor.isBuffer=="function"&&er.constructor.isBuffer(er)}var ot={exports:{}};function st(er,Zt){for(var tr=0,nr=er.length-1;nr>=0;nr--){var ir=er[nr];ir==="."?er.splice(nr,1):ir===".."?(er.splice(nr,1),tr++):tr&&(er.splice(nr,1),tr--)}if(Zt)for(;tr--;tr)er.unshift("..");return er}var at=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,ut=function(er){return at.exec(er).slice(1)};function ct(){for(var er="",Zt=!1,tr=arguments.length-1;tr>=-1&&!Zt;tr--){var nr=tr>=0?arguments[tr]:"/";if(typeof nr!="string")throw new TypeError("Arguments to path.resolve must be strings");nr&&(er=nr+"/"+er,Zt=nr.charAt(0)==="/")}return(Zt?"/":"")+(er=st(vt(er.split("/"),function(ir){return!!ir}),!Zt).join("/"))||"."}function lt(er){var Zt=ft(er),tr=yt(er,-1)==="/";return(er=st(vt(er.split("/"),function(nr){return!!nr}),!Zt).join("/"))||Zt||(er="."),er&&tr&&(er+="/"),(Zt?"/":"")+er}function ft(er){return er.charAt(0)==="/"}function dt(){return lt(vt(Array.prototype.slice.call(arguments,0),function(er,Zt){if(typeof er!="string")throw new TypeError("Arguments to path.join must be strings");return er}).join("/"))}function ht(er,Zt){function tr(Sr){for(var kr=0;kr<Sr.length&&Sr[kr]==="";kr++);for(var Ir=Sr.length-1;Ir>=0&&Sr[Ir]==="";Ir--);return kr>Ir?[]:Sr.slice(kr,Ir-kr+1)}er=ct(er).substr(1),Zt=ct(Zt).substr(1);for(var nr=tr(er.split("/")),ir=tr(Zt.split("/")),sr=Math.min(nr.length,ir.length),_r=sr,ar=0;ar<sr;ar++)if(nr[ar]!==ir[ar]){_r=ar;break}var Or=[];for(ar=_r;ar<nr.length;ar++)Or.push("..");return(Or=Or.concat(ir.slice(_r))).join("/")}function _t(er){var Zt=ut(er),tr=Zt[0],nr=Zt[1];return tr||nr?(nr&&(nr=nr.substr(0,nr.length-1)),tr+nr):"."}function pt(er,Zt){var tr=ut(er)[2];return Zt&&tr.substr(-1*Zt.length)===Zt&&(tr=tr.substr(0,tr.length-Zt.length)),tr}function gt(er){return ut(er)[3]}var mt={extname:gt,basename:pt,dirname:_t,sep:"/",delimiter:":",relative:ht,join:dt,isAbsolute:ft,normalize:lt,resolve:ct};function vt(er,Zt){if(er.filter)return er.filter(Zt);for(var tr=[],nr=0;nr<er.length;nr++)Zt(er[nr],nr,er)&&tr.push(er[nr]);return tr}var yt="ab".substr(-1)==="b"?function(er,Zt,tr){return er.substr(Zt,tr)}:function(er,Zt,tr){return Zt<0&&(Zt=er.length+Zt),er.substr(Zt,tr)},bt=g(Object.freeze({__proto__:null,resolve:ct,normalize:lt,isAbsolute:ft,join:dt,relative:ht,sep:"/",delimiter:":",dirname:_t,basename:pt,extname:gt,default:mt})),wt=g(Object.freeze({__proto__:null,default:{}})),Et=g(Object.freeze({__proto__:null,default:{}}));(function(er,Zt){var tr=void 0,nr=function(ir){return tr||(tr=new Promise(function(sr,_r){var ar,Or=(ar=ir!==void 0?ir:{}).onAbort;ar.onAbort=function(rr){_r(new Error(rr)),Or&&Or(rr)},ar.postRun=ar.postRun||[],ar.postRun.push(function(){sr(ar)}),er=void 0,ar||(ar=ar!==void 0?ar:{}),ar.onRuntimeInitialized=function(){function rr(Rr,Dr){this.Qa=Rr,this.db=Dr,this.Pa=1,this.wb=[]}function or(Rr,Dr){if(this.db=Dr,Dr=Nn(Rr)+1,this.hb=Wn(Dr),this.hb===null)throw Error("Unable to allocate memory for the SQL string");En(Rr,nn,this.hb,Dr),this.sb=this.hb,this.eb=this.Mb=null}function cr(Rr,{filename:Dr=!1}={}){Dr===!1?(this.filename="dbfile_"+(4294967295*Math.random()>>>0),this.Xc=!0,Rr!=null&&ur.zb("/",this.filename,Rr,!0,!0)):this.filename=Rr,this.handleError(yr(this.filename,dr)),this.db=Pr(dr,"i32"),ro(this.db),this.nb={},this.Xa={}}var dr=kn(4),pr=ar.cwrap,yr=pr("sqlite3_open","number",["string","number"]),Nr=pr("sqlite3_close_v2","number",["number"]),Br=pr("sqlite3_exec","number",["number","string","number","number","number"]),jr=pr("sqlite3_changes","number",["number"]),$r=pr("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Hr=pr("sqlite3_sql","string",["number"]),Zr=pr("sqlite3_normalized_sql","string",["number"]),on=pr("sqlite3_prepare_v2","number",["number","number","number","number","number"]),an=pr("sqlite3_bind_text","number",["number","number","number","number","number"]),sn=pr("sqlite3_bind_blob","number",["number","number","number","number","number"]),cn=pr("sqlite3_bind_double","number",["number","number","number"]),hn=pr("sqlite3_bind_int","number",["number","number","number"]),yn=pr("sqlite3_bind_parameter_index","number",["number","string"]),ai=pr("sqlite3_step","number",["number"]),gn=pr("sqlite3_errmsg","string",["number"]),Bi=pr("sqlite3_column_count","number",["number"]),Pi=pr("sqlite3_data_count","number",["number"]),Di=pr("sqlite3_column_double","number",["number","number"]),$i=pr("sqlite3_column_text","string",["number","number"]),Li=pr("sqlite3_column_blob","number",["number","number"]),Ui=pr("sqlite3_column_bytes","number",["number","number"]),qi=pr("sqlite3_column_type","number",["number","number"]),ji=pr("sqlite3_column_name","string",["number","number"]),Ji=pr("sqlite3_reset","number",["number"]),zi=pr("sqlite3_clear_bindings","number",["number"]),Wi=pr("sqlite3_finalize","number",["number"]),Hi=pr("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),Gi=pr("sqlite3_value_type","number",["number"]),Yi=pr("sqlite3_value_bytes","number",["number"]),Vi=pr("sqlite3_value_text","string",["number"]),Qi=pr("sqlite3_value_blob","number",["number"]),Ki=pr("sqlite3_value_double","number",["number"]),Xi=pr("sqlite3_result_double","",["number","number"]),Ni=pr("sqlite3_result_null","",["number"]),Zi=pr("sqlite3_result_text","",["number","string","number","number"]),eo=pr("sqlite3_result_blob","",["number","number","number","number"]),to=pr("sqlite3_result_int","",["number","number"]),Mi=pr("sqlite3_result_error","",["number","string","number"]),ro=pr("RegisterExtensionFunctions","number",["number"]);rr.prototype.bind=function(Rr){if(!this.Qa)throw"Statement closed";return this.reset(),Array.isArray(Rr)?this.vc(Rr):Rr==null||typeof Rr!="object"||this.wc(Rr)},rr.prototype.step=function(){if(!this.Qa)throw"Statement closed";this.Pa=1;var Rr=ai(this.Qa);switch(Rr){case 100:return!0;case 101:return!1;default:throw this.db.handleError(Rr)}},rr.prototype.Pc=function(Rr){return Rr==null&&(Rr=this.Pa,this.Pa+=1),Di(this.Qa,Rr)},rr.prototype.Qc=function(Rr){return Rr==null&&(Rr=this.Pa,this.Pa+=1),$i(this.Qa,Rr)},rr.prototype.getBlob=function(Rr){Rr==null&&(Rr=this.Pa,this.Pa+=1);var Dr=Ui(this.Qa,Rr);Rr=Li(this.Qa,Rr);for(var Gr=new Uint8Array(Dr),Xr=0;Xr<Dr;Xr+=1)Gr[Xr]=rn[Rr+Xr];return Gr},rr.prototype.get=function(Rr){Rr!=null&&this.bind(Rr)&&this.step(),Rr=[];for(var Dr=Pi(this.Qa),Gr=0;Gr<Dr;Gr+=1)switch(qi(this.Qa,Gr)){case 1:case 2:Rr.push(this.Pc(Gr));break;case 3:Rr.push(this.Qc(Gr));break;case 4:Rr.push(this.getBlob(Gr));break;default:Rr.push(null)}return Rr},rr.prototype.getColumnNames=function(){for(var Rr=[],Dr=Bi(this.Qa),Gr=0;Gr<Dr;Gr+=1)Rr.push(ji(this.Qa,Gr));return Rr},rr.prototype.getAsObject=function(Rr){Rr=this.get(Rr);for(var Dr=this.getColumnNames(),Gr={},Xr=0;Xr<Dr.length;Xr+=1)Gr[Dr[Xr]]=Rr[Xr];return Gr},rr.prototype.getSQL=function(){return Hr(this.Qa)},rr.prototype.getNormalizedSQL=function(){return Zr(this.Qa)},rr.prototype.run=function(Rr){return Rr!=null&&this.bind(Rr),this.step(),this.reset()},rr.prototype.zc=function(Rr,Dr){Dr==null&&(Dr=this.Pa,this.Pa+=1);var Gr=Qr(Rr=zn(Rr));this.wb.push(Gr),this.db.handleError(an(this.Qa,Dr,Gr,Rr.length-1,0))},rr.prototype.uc=function(Rr,Dr){Dr==null&&(Dr=this.Pa,this.Pa+=1);var Gr=Qr(Rr);this.wb.push(Gr),this.db.handleError(sn(this.Qa,Dr,Gr,Rr.length,0))},rr.prototype.yc=function(Rr,Dr){Dr==null&&(Dr=this.Pa,this.Pa+=1),this.db.handleError((Rr===(0|Rr)?hn:cn)(this.Qa,Dr,Rr))},rr.prototype.xc=function(Rr){Rr==null&&(Rr=this.Pa,this.Pa+=1),sn(this.Qa,Rr,0,0,0)},rr.prototype.Tb=function(Rr,Dr){switch(Dr==null&&(Dr=this.Pa,this.Pa+=1),typeof Rr){case"string":return void this.zc(Rr,Dr);case"number":case"boolean":return void this.yc(Rr+0,Dr);case"object":if(Rr===null)return void this.xc(Dr);if(Rr.length!=null)return void this.uc(Rr,Dr)}throw"Wrong API use : tried to bind a value of an unknown type ("+Rr+")."},rr.prototype.wc=function(Rr){var Dr=this;return Object.keys(Rr).forEach(function(Gr){var Xr=yn(Dr.Qa,Gr);Xr!==0&&Dr.Tb(Rr[Gr],Xr)}),!0},rr.prototype.vc=function(Rr){for(var Dr=0;Dr<Rr.length;Dr+=1)this.Tb(Rr[Dr],Dr+1);return!0},rr.prototype.reset=function(){return zi(this.Qa)===0&&Ji(this.Qa)===0},rr.prototype.freemem=function(){for(var Rr;(Rr=this.wb.pop())!==void 0;)Dn(Rr)},rr.prototype.free=function(){var Rr=Wi(this.Qa)===0;return delete this.db.nb[this.Qa],this.Qa=0,Rr},or.prototype.next=function(){if(this.hb===null)return{done:!0};if(this.eb!==null&&(this.eb.free(),this.eb=null),!this.db.db)throw this.Bb(),Error("Database closed");var Rr=$n(),Dr=kn(4);Mr(dr),Mr(Dr);try{this.db.handleError(on(this.db.db,this.sb,-1,dr,Dr)),this.sb=Pr(Dr,"i32");var Gr=Pr(dr,"i32");return Gr===0?(this.Bb(),{done:!0}):(this.eb=new rr(Gr,this.db),this.db.nb[Gr]=this.eb,{value:this.eb,done:!1})}catch(Xr){throw this.Mb=fn(this.sb),this.Bb(),Xr}finally{Ln(Rr)}},or.prototype.Bb=function(){Dn(this.hb),this.hb=null},or.prototype.getRemainingSQL=function(){return this.Mb!==null?this.Mb:fn(this.sb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(or.prototype[Symbol.iterator]=function(){return this}),cr.prototype.run=function(Rr,Dr){if(!this.db)throw"Database closed";if(Dr){Rr=this.prepare(Rr,Dr);try{Rr.step()}finally{Rr.free()}}else this.handleError(Br(this.db,Rr,0,0,dr));return this},cr.prototype.exec=function(Rr,Dr){if(!this.db)throw"Database closed";var Gr=$n(),Xr=null;try{var ln=Nn(Rr)+1,wn=kn(ln);En(Rr,rn,wn,ln);var _n=wn,Fn=kn(4);for(Rr=[];Pr(_n,"i8")!==0;){Mr(dr),Mr(Fn),this.handleError(on(this.db,_n,-1,dr,Fn));var Bn=Pr(dr,"i32");if(_n=Pr(Fn,"i32"),Bn!==0){for(ln=null,Xr=new rr(Bn,this),Dr!=null&&Xr.bind(Dr);Xr.step();)ln===null&&(ln={columns:Xr.getColumnNames(),values:[]},Rr.push(ln)),ln.values.push(Xr.get());Xr.free()}}return Rr}catch(mn){throw Xr&&Xr.free(),mn}finally{Ln(Gr)}},cr.prototype.each=function(Rr,Dr,Gr,Xr){typeof Dr=="function"&&(Xr=Gr,Gr=Dr,Dr=void 0),Rr=this.prepare(Rr,Dr);try{for(;Rr.step();)Gr(Rr.getAsObject())}finally{Rr.free()}if(typeof Xr=="function")return Xr()},cr.prototype.prepare=function(Rr,Dr){if(Mr(dr),this.handleError($r(this.db,Rr,-1,dr,0)),(Rr=Pr(dr,"i32"))===0)throw"Nothing to prepare";var Gr=new rr(Rr,this);return Dr!=null&&Gr.bind(Dr),this.nb[Rr]=Gr},cr.prototype.iterateStatements=function(Rr){return new or(Rr,this)},cr.prototype.export=function(){Object.values(this.nb).forEach(function(Dr){Dr.free()}),Object.values(this.Xa).forEach(xr),this.Xa={},this.handleError(Nr(this.db));var Rr=ur.readFile(this.filename,{encoding:"binary"});return this.handleError(yr(this.filename,dr)),this.db=Pr(dr,"i32"),Rr},cr.prototype.close=function(){this.db!==null&&(Object.values(this.nb).forEach(function(Rr){Rr.free()}),Object.values(this.Xa).forEach(xr),this.Xa={},this.handleError(Nr(this.db)),this.Xc&&ur.unlink("/"+this.filename),this.db=null)},cr.prototype.handleError=function(Rr){if(Rr===0)return null;throw Rr=gn(this.db),Error(Rr)},cr.prototype.getRowsModified=function(){return jr(this.db)},cr.prototype.create_function=function(Rr,Dr){Object.prototype.hasOwnProperty.call(this.Xa,Rr)&&(xr(this.Xa[Rr]),delete this.Xa[Rr]);var Gr=Tr(function(Xr,ln,wn){for(var _n,Fn=[],Bn=0;Bn<ln;Bn+=1){var mn=Pr(wn+4*Bn,"i32"),Rn=Gi(mn);if(Rn===1||Rn===2)mn=Ki(mn);else if(Rn===3)mn=Vi(mn);else if(Rn===4){mn=Yi(Rn=mn),Rn=Qi(Rn);for(var xi=new Uint8Array(mn),Gn=0;Gn<mn;Gn+=1)xi[Gn]=rn[Rn+Gn];mn=xi}else mn=null;Fn.push(mn)}try{_n=Dr.apply(null,Fn)}catch(no){return void Mi(Xr,no,-1)}switch(typeof _n){case"boolean":to(Xr,_n?1:0);break;case"number":Xi(Xr,_n);break;case"string":Zi(Xr,_n,-1,-1);break;case"object":_n===null?Ni(Xr):_n.length!=null?(ln=Qr(_n),eo(Xr,ln,_n.length,-1),Dn(ln)):Mi(Xr,"Wrong API use : tried to return a value of an unknown type ("+_n+").",-1);break;default:Ni(Xr)}},"viii");return this.Xa[Rr]=Gr,this.handleError(Hi(this.db,Rr,Dr.length,1,0,Gr,0,0,0)),this},ar.Database=cr;var Un=new Map;ar.register_for_idb=Rr=>{let Dr=Tr(function(ln,wn){return ln=Un.get(ln),Rr.lock(ln,wn)?0:5},"iii"),Gr=Tr(function(ln,wn){return ln=Un.get(ln),Rr.unlock(ln,wn),0},"iii"),Xr=Tr(function(ln,wn){ln=fn(ln),Un.set(wn,ln)},"vii");ar._register_for_idb(Dr,Gr,Xr)},ar.cleanup_file=Rr=>{let Dr=[...Un.entries()].find(Gr=>Gr[1]===Rr);Un.delete(Dr[0])},ar.reset_filesystem=()=>{ur.root=null,ur.lc()}};var Sr,kr={};for(Sr in ar)ar.hasOwnProperty(Sr)&&(kr[Sr]=ar[Sr]);var Ir,Cr,Ur,Wr,Yr,Fr="./this.program",gr=typeof window=="object",Ar=typeof importScripts=="function",wr=typeof ae=="object"&&typeof ae.versions=="object"&&typeof ae.versions.node=="string",mr="";wr?(mr=Ar?bt.dirname(mr)+"/":"/home/runner/work/open-im-sdk-web-wasm/open-im-sdk-web-wasm/node_modules/@jlongster/sql.js/dist/",Ir=function(rr,or){return Wr||(Wr=wt),Yr||(Yr=bt),rr=Yr.normalize(rr),Wr.readFileSync(rr,or?null:"utf8")},Ur=function(rr){return(rr=Ir(rr,!0)).buffer||(rr=new Uint8Array(rr)),zr(rr.buffer),rr},Cr=function(rr,or,cr){Wr||(Wr=wt),Yr||(Yr=bt),rr=Yr.normalize(rr),Wr.readFile(rr,function(dr,pr){dr?cr(dr):or(pr.buffer)})},1<ae.argv.length&&(Fr=ae.argv[1].replace(/\\/g,"/")),ae.argv.slice(2),er.exports=ar,ar.inspect=function(){return"[Emscripten Module object]"}):(gr||Ar)&&(Ar?mr=self.location.href:typeof document!="undefined"&&document.currentScript&&(mr=document.currentScript.src),mr=mr.indexOf("blob:")!==0?mr.substr(0,mr.lastIndexOf("/")+1):"",Ir=function(rr){var or=new XMLHttpRequest;return or.open("GET",rr,!1),or.send(null),or.responseText},Ar&&(Ur=function(rr){var or=new XMLHttpRequest;return or.open("GET",rr,!1),or.responseType="arraybuffer",or.send(null),new Uint8Array(or.response)}),Cr=function(rr,or,cr){var dr=new XMLHttpRequest;dr.open("GET",rr,!0),dr.responseType="arraybuffer",dr.onload=function(){dr.status==200||dr.status==0&&dr.response?or(dr.response):cr()},dr.onerror=cr,dr.send(null)});var fr=ar.print||console.log.bind(console),lr=ar.printErr||console.warn.bind(console);for(Sr in kr)kr.hasOwnProperty(Sr)&&(ar[Sr]=kr[Sr]);kr=null,ar.thisProgram&&(Fr=ar.thisProgram);var hr,vr,br=[];function xr(rr){hr.delete(bn.get(rr)),br.push(rr)}function Tr(rr,or){if(!hr){hr=new WeakMap;for(var cr=0;cr<bn.length;cr++){var dr=bn.get(cr);dr&&hr.set(dr,cr)}}if(hr.has(rr))rr=hr.get(rr);else{if(br.length)cr=br.pop();else{try{bn.grow(1)}catch(Br){throw Br instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":Br}cr=bn.length-1}try{bn.set(cr,rr)}catch(Br){if(!(Br instanceof TypeError))throw Br;if(typeof WebAssembly.Function=="function"){var pr={i:"i32",j:"i64",f:"f32",d:"f64"},yr={parameters:[],results:or[0]=="v"?[]:[pr[or[0]]]};for(dr=1;dr<or.length;++dr)yr.parameters.push(pr[or[dr]]);or=new WebAssembly.Function(yr,rr)}else{pr=[1,0,1,96],yr=or.slice(0,1),or=or.slice(1);var Nr={i:127,j:126,f:125,d:124};for(pr.push(or.length),dr=0;dr<or.length;++dr)pr.push(Nr[or[dr]]);yr=="v"?pr.push(0):pr=pr.concat([1,Nr[yr]]),pr[1]=pr.length-2,or=new Uint8Array([0,97,115,109,1,0,0,0].concat(pr,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),or=new WebAssembly.Module(or),or=new WebAssembly.Instance(or,{e:{f:rr}}).exports.f}bn.set(cr,or)}hr.set(rr,cr),rr=cr}return rr}function Mr(rr){var or="i32";switch(or.charAt(or.length-1)==="*"&&(or="i32"),or){case"i1":case"i8":rn[rr>>0]=0;break;case"i16":dn[rr>>1]=0;break;case"i32":Lr[rr>>2]=0;break;case"i64":vn=[0,(un=0,1<=+Math.abs(un)?0<un?(0|Math.min(+Math.floor(un/4294967296),4294967295))>>>0:~~+Math.ceil((un-+(~~un>>>0))/4294967296)>>>0:0)],Lr[rr>>2]=vn[0],Lr[rr+4>>2]=vn[1];break;case"float":Yn[rr>>2]=0;break;case"double":Vn[rr>>3]=0;break;default:en("invalid type for setValue: "+or)}}function Pr(rr,or){switch((or=or||"i8").charAt(or.length-1)==="*"&&(or="i32"),or){case"i1":case"i8":return rn[rr>>0];case"i16":return dn[rr>>1];case"i32":case"i64":return Lr[rr>>2];case"float":return Yn[rr>>2];case"double":return Vn[rr>>3];default:en("invalid type for getValue: "+or)}return null}ar.wasmBinary&&(vr=ar.wasmBinary),ar.noExitRuntime,typeof WebAssembly!="object"&&en("no native wasm support detected");var qr,Jr=!1;function zr(rr,or){rr||en("Assertion failed: "+or)}function Vr(rr){var or=ar["_"+rr];return zr(or,"Cannot call unknown function "+rr+", make sure it is exported"),or}function Qr(rr){var or=Wn(rr.length);return rr.subarray||rr.slice?nn.set(rr,or):nn.set(new Uint8Array(rr),or),or}var tn,rn,nn,dn,Lr,Yn,Vn,ui=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function An(rr,or,cr){var dr=or+cr;for(cr=or;rr[cr]&&!(cr>=dr);)++cr;if(16<cr-or&&rr.subarray&&ui)return ui.decode(rr.subarray(or,cr));for(dr="";or<cr;){var pr=rr[or++];if(128&pr){var yr=63&rr[or++];if((224&pr)==192)dr+=String.fromCharCode((31&pr)<<6|yr);else{var Nr=63&rr[or++];65536>(pr=(240&pr)==224?(15&pr)<<12|yr<<6|Nr:(7&pr)<<18|yr<<12|Nr<<6|63&rr[or++])?dr+=String.fromCharCode(pr):(pr-=65536,dr+=String.fromCharCode(55296|pr>>10,56320|1023&pr))}}else dr+=String.fromCharCode(pr)}return dr}function fn(rr,or){return rr?An(nn,rr,or):""}function En(rr,or,cr,dr){if(!(0<dr))return 0;var pr=cr;dr=cr+dr-1;for(var yr=0;yr<rr.length;++yr){var Nr=rr.charCodeAt(yr);if(55296<=Nr&&57343>=Nr&&(Nr=65536+((1023&Nr)<<10)|1023&rr.charCodeAt(++yr)),127>=Nr){if(cr>=dr)break;or[cr++]=Nr}else{if(2047>=Nr){if(cr+1>=dr)break;or[cr++]=192|Nr>>6}else{if(65535>=Nr){if(cr+2>=dr)break;or[cr++]=224|Nr>>12}else{if(cr+3>=dr)break;or[cr++]=240|Nr>>18,or[cr++]=128|Nr>>12&63}or[cr++]=128|Nr>>6&63}or[cr++]=128|63&Nr}}return or[cr]=0,cr-pr}function Nn(rr){for(var or=0,cr=0;cr<rr.length;++cr){var dr=rr.charCodeAt(cr);55296<=dr&&57343>=dr&&(dr=65536+((1023&dr)<<10)|1023&rr.charCodeAt(++cr)),127>=dr?++or:or=2047>=dr?or+2:65535>=dr?or+3:or+4}return or}function ci(rr){var or=Nn(rr)+1,cr=Wn(or);return cr&&En(rr,rn,cr,or),cr}function li(){var rr=qr.buffer;tn=rr,ar.HEAP8=rn=new Int8Array(rr),ar.HEAP16=dn=new Int16Array(rr),ar.HEAP32=Lr=new Int32Array(rr),ar.HEAPU8=nn=new Uint8Array(rr),ar.HEAPU16=new Uint16Array(rr),ar.HEAPU32=new Uint32Array(rr),ar.HEAPF32=Yn=new Float32Array(rr),ar.HEAPF64=Vn=new Float64Array(rr)}var bn,fi=[],di=[],hi=[];function Ai(){var rr=ar.preRun.shift();fi.unshift(rr)}var pn,un,vn,gi,Mn=0,Pn=null;function Qn(){Mn++,ar.monitorRunDependencies&&ar.monitorRunDependencies(Mn)}function qn(){if(Mn--,ar.monitorRunDependencies&&ar.monitorRunDependencies(Mn),Mn==0&&Pn){var rr=Pn;Pn=null,rr()}}function en(rr){throw ar.onAbort&&ar.onAbort(rr),lr(rr),Jr=!0,new WebAssembly.RuntimeError("abort("+rr+"). Build with -s ASSERTIONS=1 for more info.")}function _i(){return pn.startsWith("data:application/octet-stream;base64,")}if(ar.preloadedImages={},ar.preloadedAudios={},pn="sql-wasm.wasm",!_i()){var mi=pn;pn=ar.locateFile?ar.locateFile(mi,mr):mr+mi}function pi(){var rr=pn;try{if(rr==pn&&vr)return new Uint8Array(vr);if(Ur)return Ur(rr);throw"both async and sync fetching of the wasm failed"}catch(or){en(or)}}function Kn(rr){for(;0<rr.length;){var or=rr.shift();if(typeof or=="function")or(ar);else{var cr=or.pd;typeof cr=="number"?or.yb===void 0?bn.get(cr)():bn.get(cr)(or.yb):cr(or.yb===void 0?null:or.yb)}}}function Xn(rr,or){for(var cr=0,dr=rr.length-1;0<=dr;dr--){var pr=rr[dr];pr==="."?rr.splice(dr,1):pr===".."?(rr.splice(dr,1),cr++):cr&&(rr.splice(dr,1),cr--)}if(or)for(;cr;cr--)rr.unshift("..");return rr}function In(rr){var or=rr.charAt(0)==="/",cr=rr.substr(-1)==="/";return(rr=Xn(rr.split("/").filter(function(dr){return!!dr}),!or).join("/"))||or||(rr="."),rr&&cr&&(rr+="/"),(or?"/":"")+rr}function jn(rr){var or=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(rr).slice(1);return rr=or[0],or=or[1],rr||or?(or&&(or=or.substr(0,or.length-1)),rr+or):"."}function On(rr){if(rr==="/")return"/";var or=(rr=(rr=In(rr)).replace(/\/$/,"")).lastIndexOf("/");return or===-1?rr:rr.substr(or+1)}function Tn(rr,or){return In(rr+"/"+or)}function xn(){for(var rr="",or=!1,cr=arguments.length-1;-1<=cr&&!or;cr--){if(typeof(or=0<=cr?arguments[cr]:ur.cwd())!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!or)return"";rr=or+"/"+rr,or=or.charAt(0)==="/"}return(or?"/":"")+(rr=Xn(rr.split("/").filter(function(dr){return!!dr}),!or).join("/"))||"."}function vi(rr,or){function cr(Nr){for(var Br=0;Br<Nr.length&&Nr[Br]==="";Br++);for(var jr=Nr.length-1;0<=jr&&Nr[jr]==="";jr--);return Br>jr?[]:Nr.slice(Br,jr-Br+1)}rr=xn(rr).substr(1),or=xn(or).substr(1),rr=cr(rr.split("/")),or=cr(or.split("/"));for(var dr=Math.min(rr.length,or.length),pr=dr,yr=0;yr<dr;yr++)if(rr[yr]!==or[yr]){pr=yr;break}for(dr=[],yr=pr;yr<rr.length;yr++)dr.push("..");return(dr=dr.concat(or.slice(pr))).join("/")}var yi=[];function bi(rr,or){yi[rr]={input:[],output:[],gb:or},ur.Qb(rr,Ii)}var Ii={open:function(rr){var or=yi[rr.node.rdev];if(!or)throw new ur.ErrnoError(43);rr.tty=or,rr.seekable=!1},close:function(rr){rr.tty.gb.flush(rr.tty)},flush:function(rr){rr.tty.gb.flush(rr.tty)},read:function(rr,or,cr,dr){if(!rr.tty||!rr.tty.gb.cc)throw new ur.ErrnoError(60);for(var pr=0,yr=0;yr<dr;yr++){try{var Nr=rr.tty.gb.cc(rr.tty)}catch(Br){throw new ur.ErrnoError(29)}if(Nr===void 0&&pr===0)throw new ur.ErrnoError(6);if(Nr==null)break;pr++,or[cr+yr]=Nr}return pr&&(rr.node.timestamp=Date.now()),pr},write:function(rr,or,cr,dr){if(!rr.tty||!rr.tty.gb.Nb)throw new ur.ErrnoError(60);try{for(var pr=0;pr<dr;pr++)rr.tty.gb.Nb(rr.tty,or[cr+pr])}catch(yr){throw new ur.ErrnoError(29)}return dr&&(rr.node.timestamp=Date.now()),pr}},Ti={cc:function(rr){if(!rr.input.length){var or=null;if(wr){var cr=we.alloc(256),dr=0;try{dr=Wr.readSync(ae.stdin.fd,cr,0,256,null)}catch(pr){if(!pr.toString().includes("EOF"))throw pr;dr=0}or=0<dr?cr.slice(0,dr).toString("utf-8"):null}else typeof window!="undefined"&&typeof window.prompt=="function"?(or=window.prompt("Input: "))!==null&&(or+=`
`):typeof readline=="function"&&(or=readline())!==null&&(or+=`
`);if(!or)return null;rr.input=zn(or,!0)}return rr.input.shift()},Nb:function(rr,or){or===null||or===10?(fr(An(rr.output,0)),rr.output=[]):or!=0&&rr.output.push(or)},flush:function(rr){rr.output&&0<rr.output.length&&(fr(An(rr.output,0)),rr.output=[])}},Ci={Nb:function(rr,or){or===null||or===10?(lr(An(rr.output,0)),rr.output=[]):or!=0&&rr.output.push(or)},flush:function(rr){rr.output&&0<rr.output.length&&(lr(An(rr.output,0)),rr.output=[])}};function wi(rr){rr=65536*Math.ceil(rr/65536);var or=Ri(65536,rr);return or?(nn.fill(0,or,or+rr),or):0}var Kr={Va:null,mount:function(){return Kr.createNode(null,"/",16895,0)},createNode:function(rr,or,cr,dr){if(ur.Rc(cr)||ur.isFIFO(cr))throw new ur.ErrnoError(63);return Kr.Va||(Kr.Va={dir:{node:{getattr:Kr.node_ops.getattr,setattr:Kr.node_ops.setattr,lookup:Kr.node_ops.lookup,mknod:Kr.node_ops.mknod,rename:Kr.node_ops.rename,unlink:Kr.node_ops.unlink,rmdir:Kr.node_ops.rmdir,readdir:Kr.node_ops.readdir,symlink:Kr.node_ops.symlink},stream:{llseek:Kr.stream_ops.llseek}},file:{node:{getattr:Kr.node_ops.getattr,setattr:Kr.node_ops.setattr},stream:{llseek:Kr.stream_ops.llseek,read:Kr.stream_ops.read,write:Kr.stream_ops.write,allocate:Kr.stream_ops.allocate,mmap:Kr.stream_ops.mmap,msync:Kr.stream_ops.msync}},link:{node:{getattr:Kr.node_ops.getattr,setattr:Kr.node_ops.setattr,readlink:Kr.node_ops.readlink},stream:{}},Vb:{node:{getattr:Kr.node_ops.getattr,setattr:Kr.node_ops.setattr},stream:ur.Cc}}),cr=ur.createNode(rr,or,cr,dr),ur.isDir(cr.mode)?(cr.node_ops=Kr.Va.dir.node,cr.stream_ops=Kr.Va.dir.stream,cr.Na={}):ur.isFile(cr.mode)?(cr.node_ops=Kr.Va.file.node,cr.stream_ops=Kr.Va.file.stream,cr.Ra=0,cr.Na=null):ur.fb(cr.mode)?(cr.node_ops=Kr.Va.link.node,cr.stream_ops=Kr.Va.link.stream):ur.pb(cr.mode)&&(cr.node_ops=Kr.Va.Vb.node,cr.stream_ops=Kr.Va.Vb.stream),cr.timestamp=Date.now(),rr&&(rr.Na[or]=cr,rr.timestamp=cr.timestamp),cr},qd:function(rr){return rr.Na?rr.Na.subarray?rr.Na.subarray(0,rr.Ra):new Uint8Array(rr.Na):new Uint8Array(0)},Zb:function(rr,or){var cr=rr.Na?rr.Na.length:0;cr>=or||(or=Math.max(or,cr*(1048576>cr?2:1.125)>>>0),cr!=0&&(or=Math.max(or,256)),cr=rr.Na,rr.Na=new Uint8Array(or),0<rr.Ra&&rr.Na.set(cr.subarray(0,rr.Ra),0))},gd:function(rr,or){if(rr.Ra!=or)if(or==0)rr.Na=null,rr.Ra=0;else{var cr=rr.Na;rr.Na=new Uint8Array(or),cr&&rr.Na.set(cr.subarray(0,Math.min(or,rr.Ra))),rr.Ra=or}},node_ops:{getattr:function(rr){var or={};return or.dev=ur.pb(rr.mode)?rr.id:1,or.ino=rr.id,or.mode=rr.mode,or.nlink=1,or.uid=0,or.gid=0,or.rdev=rr.rdev,ur.isDir(rr.mode)?or.size=4096:ur.isFile(rr.mode)?or.size=rr.Ra:ur.fb(rr.mode)?or.size=rr.link.length:or.size=0,or.atime=new Date(rr.timestamp),or.mtime=new Date(rr.timestamp),or.ctime=new Date(rr.timestamp),or.Ac=4096,or.blocks=Math.ceil(or.size/or.Ac),or},setattr:function(rr,or){or.mode!==void 0&&(rr.mode=or.mode),or.timestamp!==void 0&&(rr.timestamp=or.timestamp),or.size!==void 0&&Kr.gd(rr,or.size)},lookup:function(){throw ur.Db[44]},mknod:function(rr,or,cr,dr){return Kr.createNode(rr,or,cr,dr)},rename:function(rr,or,cr){if(ur.isDir(rr.mode)){try{var dr=ur.lookupNode(or,cr)}catch(yr){}if(dr)for(var pr in dr.Na)throw new ur.ErrnoError(55)}delete rr.parent.Na[rr.name],rr.parent.timestamp=Date.now(),rr.name=cr,or.Na[cr]=rr,or.timestamp=rr.parent.timestamp,rr.parent=or},unlink:function(rr,or){delete rr.Na[or],rr.timestamp=Date.now()},rmdir:function(rr,or){var cr,dr=ur.lookupNode(rr,or);for(cr in dr.Na)throw new ur.ErrnoError(55);delete rr.Na[or],rr.timestamp=Date.now()},readdir:function(rr){var or,cr=[".",".."];for(or in rr.Na)rr.Na.hasOwnProperty(or)&&cr.push(or);return cr},symlink:function(rr,or,cr){return(rr=Kr.createNode(rr,or,41471,0)).link=cr,rr},readlink:function(rr){if(!ur.fb(rr.mode))throw new ur.ErrnoError(28);return rr.link}},stream_ops:{read:function(rr,or,cr,dr,pr){var yr=rr.node.Na;if(pr>=rr.node.Ra)return 0;if(8<(rr=Math.min(rr.node.Ra-pr,dr))&&yr.subarray)or.set(yr.subarray(pr,pr+rr),cr);else for(dr=0;dr<rr;dr++)or[cr+dr]=yr[pr+dr];return rr},write:function(rr,or,cr,dr,pr,yr){if(or.buffer===rn.buffer&&(yr=!1),!dr)return 0;if((rr=rr.node).timestamp=Date.now(),or.subarray&&(!rr.Na||rr.Na.subarray)){if(yr)return rr.Na=or.subarray(cr,cr+dr),rr.Ra=dr;if(rr.Ra===0&&pr===0)return rr.Na=or.slice(cr,cr+dr),rr.Ra=dr;if(pr+dr<=rr.Ra)return rr.Na.set(or.subarray(cr,cr+dr),pr),dr}if(Kr.Zb(rr,pr+dr),rr.Na.subarray&&or.subarray)rr.Na.set(or.subarray(cr,cr+dr),pr);else for(yr=0;yr<dr;yr++)rr.Na[pr+yr]=or[cr+yr];return rr.Ra=Math.max(rr.Ra,pr+dr),dr},llseek:function(rr,or,cr){if(cr===1?or+=rr.position:cr===2&&ur.isFile(rr.node.mode)&&(or+=rr.node.Ra),0>or)throw new ur.ErrnoError(28);return or},allocate:function(rr,or,cr){Kr.Zb(rr.node,or+cr),rr.node.Ra=Math.max(rr.node.Ra,or+cr)},mmap:function(rr,or,cr,dr,pr,yr){if(or!==0)throw new ur.ErrnoError(28);if(!ur.isFile(rr.node.mode))throw new ur.ErrnoError(43);if(rr=rr.node.Na,2&yr||rr.buffer!==tn){if((0<dr||dr+cr<rr.length)&&(rr=rr.subarray?rr.subarray(dr,dr+cr):Array.prototype.slice.call(rr,dr,dr+cr)),dr=!0,!(cr=wi(cr)))throw new ur.ErrnoError(48);rn.set(rr,cr)}else dr=!1,cr=rr.byteOffset;return{ed:cr,vb:dr}},msync:function(rr,or,cr,dr,pr){if(!ur.isFile(rr.node.mode))throw new ur.ErrnoError(43);return 2&pr||Kr.stream_ops.write(rr,or,0,dr,cr,!1),0}}},ur={root:null,mb:[],Xb:{},streams:[],Zc:1,Ua:null,Wb:"/",Hb:!1,hc:!0,Sa:{},nc:{kc:{qc:1,rc:2}},ErrnoError:null,Db:{},Lc:null,tb:0,lookupPath:function(rr,or){if(or=or||{},!(rr=xn(ur.cwd(),rr)))return{path:"",node:null};var cr,dr={Cb:!0,Pb:0};for(cr in dr)or[cr]===void 0&&(or[cr]=dr[cr]);if(8<or.Pb)throw new ur.ErrnoError(32);rr=Xn(rr.split("/").filter(function(Nr){return!!Nr}),!1);var pr=ur.root;for(dr="/",cr=0;cr<rr.length;cr++){var yr=cr===rr.length-1;if(yr&&or.parent)break;if(pr=ur.lookupNode(pr,rr[cr]),dr=Tn(dr,rr[cr]),ur.ab(pr)&&(!yr||yr&&or.Cb)&&(pr=pr.lb.root),!yr||or.Ta){for(yr=0;ur.fb(pr.mode);)if(pr=ur.readlink(dr),dr=xn(jn(dr),pr),pr=ur.lookupPath(dr,{Pb:or.Pb}).node,40<yr++)throw new ur.ErrnoError(32)}}return{path:dr,node:pr}},Ya:function(rr){for(var or;;){if(ur.isRoot(rr))return rr=rr.mount.jc,or?rr[rr.length-1]!=="/"?rr+"/"+or:rr+or:rr;or=or?rr.name+"/"+or:rr.name,rr=rr.parent}},Gb:function(rr,or){for(var cr=0,dr=0;dr<or.length;dr++)cr=(cr<<5)-cr+or.charCodeAt(dr)|0;return(rr+cr>>>0)%ur.Ua.length},ec:function(rr){var or=ur.Gb(rr.parent.id,rr.name);rr.cb=ur.Ua[or],ur.Ua[or]=rr},fc:function(rr){var or=ur.Gb(rr.parent.id,rr.name);if(ur.Ua[or]===rr)ur.Ua[or]=rr.cb;else for(or=ur.Ua[or];or;){if(or.cb===rr){or.cb=rr.cb;break}or=or.cb}},lookupNode:function(rr,or){var cr=ur.Vc(rr);if(cr)throw new ur.ErrnoError(cr,rr);for(cr=ur.Ua[ur.Gb(rr.id,or)];cr;cr=cr.cb){var dr=cr.name;if(cr.parent.id===rr.id&&dr===or)return cr}return ur.lookup(rr,or)},createNode:function(rr,or,cr,dr){return rr=new ur.FSNode(rr,or,cr,dr),ur.ec(rr),rr},Ab:function(rr){ur.fc(rr)},isRoot:function(rr){return rr===rr.parent},ab:function(rr){return!!rr.lb},isFile:function(rr){return(61440&rr)==32768},isDir:function(rr){return(61440&rr)==16384},fb:function(rr){return(61440&rr)==40960},pb:function(rr){return(61440&rr)==8192},Rc:function(rr){return(61440&rr)==24576},isFIFO:function(rr){return(61440&rr)==4096},isSocket:function(rr){return(49152&rr)==49152},Mc:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},Yc:function(rr){var or=ur.Mc[rr];if(or===void 0)throw Error("Unknown file open mode: "+rr);return or},$b:function(rr){var or=["r","w","rw"][3&rr];return 512&rr&&(or+="w"),or},Za:function(rr,or){return ur.hc?0:!or.includes("r")||292&rr.mode?or.includes("w")&&!(146&rr.mode)||or.includes("x")&&!(73&rr.mode)?2:0:2},Vc:function(rr){var or=ur.Za(rr,"x");return or||(rr.node_ops.lookup?0:2)},Lb:function(rr,or){try{return ur.lookupNode(rr,or),20}catch(cr){}return ur.Za(rr,"wx")},qb:function(rr,or,cr){try{var dr=ur.lookupNode(rr,or)}catch(pr){return pr.Oa}if(rr=ur.Za(rr,"wx"))return rr;if(cr){if(!ur.isDir(dr.mode))return 54;if(ur.isRoot(dr)||ur.Ya(dr)===ur.cwd())return 10}else if(ur.isDir(dr.mode))return 31;return 0},Wc:function(rr,or){return rr?ur.fb(rr.mode)?32:ur.isDir(rr.mode)&&(ur.$b(or)!=="r"||512&or)?31:ur.Za(rr,ur.$b(or)):44},oc:4096,$c:function(rr,or){for(or=or||ur.oc,rr=rr||0;rr<=or;rr++)if(!ur.streams[rr])return rr;throw new ur.ErrnoError(33)},$a:function(rr){return ur.streams[rr]},Jc:function(rr,or,cr){ur.ub||(ur.ub=function(){},ur.ub.prototype={object:{get:function(){return this.node},set:function(yr){this.node=yr}}});var dr,pr=new ur.ub;for(dr in rr)pr[dr]=rr[dr];return rr=pr,or=ur.$c(or,cr),rr.fd=or,ur.streams[or]=rr},Dc:function(rr){ur.streams[rr]=null},Cc:{open:function(rr){rr.stream_ops=ur.Oc(rr.node.rdev).stream_ops,rr.stream_ops.open&&rr.stream_ops.open(rr)},llseek:function(){throw new ur.ErrnoError(70)}},Kb:function(rr){return rr>>8},sd:function(rr){return 255&rr},bb:function(rr,or){return rr<<8|or},Qb:function(rr,or){ur.Xb[rr]={stream_ops:or}},Oc:function(rr){return ur.Xb[rr]},bc:function(rr){var or=[];for(rr=[rr];rr.length;){var cr=rr.pop();or.push(cr),rr.push.apply(rr,cr.mb)}return or},mc:function(rr,or){function cr(Nr){return ur.tb--,or(Nr)}function dr(Nr){if(Nr){if(!dr.Kc)return dr.Kc=!0,cr(Nr)}else++yr>=pr.length&&cr(null)}typeof rr=="function"&&(or=rr,rr=!1),ur.tb++,1<ur.tb&&lr("warning: "+ur.tb+" FS.syncfs operations in flight at once, probably just doing extra work");var pr=ur.bc(ur.root.mount),yr=0;pr.forEach(function(Nr){if(!Nr.type.mc)return dr(null);Nr.type.mc(Nr,rr,dr)})},mount:function(rr,or,cr){var dr=cr==="/",pr=!cr;if(dr&&ur.root)throw new ur.ErrnoError(10);if(!dr&&!pr){var yr=ur.lookupPath(cr,{Cb:!1});if(cr=yr.path,yr=yr.node,ur.ab(yr))throw new ur.ErrnoError(10);if(!ur.isDir(yr.mode))throw new ur.ErrnoError(54)}return or={type:rr,vd:or,jc:cr,mb:[]},(rr=rr.mount(or)).mount=or,or.root=rr,dr?ur.root=rr:yr&&(yr.lb=or,yr.mount&&yr.mount.mb.push(or)),rr},yd:function(rr){if(rr=ur.lookupPath(rr,{Cb:!1}),!ur.ab(rr.node))throw new ur.ErrnoError(28);var or=(rr=rr.node).lb,cr=ur.bc(or);Object.keys(ur.Ua).forEach(function(dr){for(dr=ur.Ua[dr];dr;){var pr=dr.cb;cr.includes(dr.mount)&&ur.Ab(dr),dr=pr}}),rr.lb=null,rr.mount.mb.splice(rr.mount.mb.indexOf(or),1)},lookup:function(rr,or){return rr.node_ops.lookup(rr,or)},mknod:function(rr,or,cr){var dr=ur.lookupPath(rr,{parent:!0}).node;if(!(rr=On(rr))||rr==="."||rr==="..")throw new ur.ErrnoError(28);var pr=ur.Lb(dr,rr);if(pr)throw new ur.ErrnoError(pr);if(!dr.node_ops.mknod)throw new ur.ErrnoError(63);return dr.node_ops.mknod(dr,rr,or,cr)},create:function(rr,or){return ur.mknod(rr,4095&(or!==void 0?or:438)|32768,0)},mkdir:function(rr,or){return ur.mknod(rr,1023&(or!==void 0?or:511)|16384,0)},td:function(rr,or){rr=rr.split("/");for(var cr="",dr=0;dr<rr.length;++dr)if(rr[dr]){cr+="/"+rr[dr];try{ur.mkdir(cr,or)}catch(pr){if(pr.Oa!=20)throw pr}}},rb:function(rr,or,cr){return cr===void 0&&(cr=or,or=438),ur.mknod(rr,8192|or,cr)},symlink:function(rr,or){if(!xn(rr))throw new ur.ErrnoError(44);var cr=ur.lookupPath(or,{parent:!0}).node;if(!cr)throw new ur.ErrnoError(44);or=On(or);var dr=ur.Lb(cr,or);if(dr)throw new ur.ErrnoError(dr);if(!cr.node_ops.symlink)throw new ur.ErrnoError(63);return cr.node_ops.symlink(cr,or,rr)},rename:function(rr,or){var cr=jn(rr),dr=jn(or),pr=On(rr),yr=On(or),Nr=ur.lookupPath(rr,{parent:!0}),Br=Nr.node;if(Nr=(Nr=ur.lookupPath(or,{parent:!0})).node,!Br||!Nr)throw new ur.ErrnoError(44);if(Br.mount!==Nr.mount)throw new ur.ErrnoError(75);var jr=ur.lookupNode(Br,pr);if((dr=vi(rr,dr)).charAt(0)!==".")throw new ur.ErrnoError(28);if((dr=vi(or,cr)).charAt(0)!==".")throw new ur.ErrnoError(55);try{var $r=ur.lookupNode(Nr,yr)}catch(Hr){}if(jr!==$r){if(cr=ur.isDir(jr.mode),pr=ur.qb(Br,pr,cr))throw new ur.ErrnoError(pr);if(pr=$r?ur.qb(Nr,yr,cr):ur.Lb(Nr,yr))throw new ur.ErrnoError(pr);if(!Br.node_ops.rename)throw new ur.ErrnoError(63);if(ur.ab(jr)||$r&&ur.ab($r))throw new ur.ErrnoError(10);if(Nr!==Br&&(pr=ur.Za(Br,"w")))throw new ur.ErrnoError(pr);try{ur.Sa.willMovePath&&ur.Sa.willMovePath(rr,or)}catch(Hr){lr("FS.trackingDelegate['willMovePath']('"+rr+"', '"+or+"') threw an exception: "+Hr.message)}ur.fc(jr);try{Br.node_ops.rename(jr,Nr,yr)}catch(Hr){throw Hr}finally{ur.ec(jr)}try{ur.Sa.onMovePath&&ur.Sa.onMovePath(rr,or)}catch(Hr){lr("FS.trackingDelegate['onMovePath']('"+rr+"', '"+or+"') threw an exception: "+Hr.message)}}},rmdir:function(rr){var or=ur.lookupPath(rr,{parent:!0}).node,cr=On(rr),dr=ur.lookupNode(or,cr),pr=ur.qb(or,cr,!0);if(pr)throw new ur.ErrnoError(pr);if(!or.node_ops.rmdir)throw new ur.ErrnoError(63);if(ur.ab(dr))throw new ur.ErrnoError(10);try{ur.Sa.willDeletePath&&ur.Sa.willDeletePath(rr)}catch(yr){lr("FS.trackingDelegate['willDeletePath']('"+rr+"') threw an exception: "+yr.message)}or.node_ops.rmdir(or,cr),ur.Ab(dr);try{ur.Sa.onDeletePath&&ur.Sa.onDeletePath(rr)}catch(yr){lr("FS.trackingDelegate['onDeletePath']('"+rr+"') threw an exception: "+yr.message)}},readdir:function(rr){if(!(rr=ur.lookupPath(rr,{Ta:!0}).node).node_ops.readdir)throw new ur.ErrnoError(54);return rr.node_ops.readdir(rr)},unlink:function(rr){var or=ur.lookupPath(rr,{parent:!0}).node,cr=On(rr),dr=ur.lookupNode(or,cr),pr=ur.qb(or,cr,!1);if(pr)throw new ur.ErrnoError(pr);if(!or.node_ops.unlink)throw new ur.ErrnoError(63);if(ur.ab(dr))throw new ur.ErrnoError(10);try{ur.Sa.willDeletePath&&ur.Sa.willDeletePath(rr)}catch(yr){lr("FS.trackingDelegate['willDeletePath']('"+rr+"') threw an exception: "+yr.message)}or.node_ops.unlink(or,cr),ur.Ab(dr);try{ur.Sa.onDeletePath&&ur.Sa.onDeletePath(rr)}catch(yr){lr("FS.trackingDelegate['onDeletePath']('"+rr+"') threw an exception: "+yr.message)}},readlink:function(rr){if(!(rr=ur.lookupPath(rr).node))throw new ur.ErrnoError(44);if(!rr.node_ops.readlink)throw new ur.ErrnoError(28);return xn(ur.Ya(rr.parent),rr.node_ops.readlink(rr))},stat:function(rr,or){if(!(rr=ur.lookupPath(rr,{Ta:!or}).node))throw new ur.ErrnoError(44);if(!rr.node_ops.getattr)throw new ur.ErrnoError(63);return rr.node_ops.getattr(rr)},lstat:function(rr){return ur.stat(rr,!0)},chmod:function(rr,or,cr){if(!(rr=typeof rr=="string"?ur.lookupPath(rr,{Ta:!cr}).node:rr).node_ops.setattr)throw new ur.ErrnoError(63);rr.node_ops.setattr(rr,{mode:4095&or|-4096&rr.mode,timestamp:Date.now()})},lchmod:function(rr,or){ur.chmod(rr,or,!0)},fchmod:function(rr,or){if(!(rr=ur.$a(rr)))throw new ur.ErrnoError(8);ur.chmod(rr.node,or)},chown:function(rr,or,cr,dr){if(!(rr=typeof rr=="string"?ur.lookupPath(rr,{Ta:!dr}).node:rr).node_ops.setattr)throw new ur.ErrnoError(63);rr.node_ops.setattr(rr,{timestamp:Date.now()})},lchown:function(rr,or,cr){ur.chown(rr,or,cr,!0)},fchown:function(rr,or,cr){if(!(rr=ur.$a(rr)))throw new ur.ErrnoError(8);ur.chown(rr.node,or,cr)},truncate:function(rr,or){if(0>or)throw new ur.ErrnoError(28);if(!(rr=typeof rr=="string"?ur.lookupPath(rr,{Ta:!0}).node:rr).node_ops.setattr)throw new ur.ErrnoError(63);if(ur.isDir(rr.mode))throw new ur.ErrnoError(31);if(!ur.isFile(rr.mode))throw new ur.ErrnoError(28);var cr=ur.Za(rr,"w");if(cr)throw new ur.ErrnoError(cr);rr.node_ops.setattr(rr,{size:or,timestamp:Date.now()})},Nc:function(rr,or){if(!(rr=ur.$a(rr)))throw new ur.ErrnoError(8);if(!(2097155&rr.flags))throw new ur.ErrnoError(28);ur.truncate(rr.node,or)},kd:function(rr,or,cr){(rr=ur.lookupPath(rr,{Ta:!0}).node).node_ops.setattr(rr,{timestamp:Math.max(or,cr)})},open:function(rr,or,cr,dr,pr){if(rr==="")throw new ur.ErrnoError(44);if(cr=64&(or=typeof or=="string"?ur.Yc(or):or)?4095&(cr===void 0?438:cr)|32768:0,typeof rr=="object")var yr=rr;else{rr=In(rr);try{yr=ur.lookupPath(rr,{Ta:!(131072&or)}).node}catch(Br){}}var Nr=!1;if(64&or)if(yr){if(128&or)throw new ur.ErrnoError(20)}else yr=ur.mknod(rr,cr,0),Nr=!0;if(!yr)throw new ur.ErrnoError(44);if(ur.pb(yr.mode)&&(or&=-513),65536&or&&!ur.isDir(yr.mode))throw new ur.ErrnoError(54);if(!Nr&&(cr=ur.Wc(yr,or)))throw new ur.ErrnoError(cr);512&or&&ur.truncate(yr,0),or&=-131713,(dr=ur.Jc({node:yr,path:ur.Ya(yr),flags:or,seekable:!0,position:0,stream_ops:yr.stream_ops,jd:[],error:!1},dr,pr)).stream_ops.open&&dr.stream_ops.open(dr),!ar.logReadFiles||1&or||(ur.Ob||(ur.Ob={}),rr in ur.Ob||(ur.Ob[rr]=1,lr("FS.trackingDelegate error on read file: "+rr)));try{ur.Sa.onOpenFile&&(pr=0,(2097155&or)!=1&&(pr|=ur.nc.kc.qc),2097155&or&&(pr|=ur.nc.kc.rc),ur.Sa.onOpenFile(rr,pr))}catch(Br){lr("FS.trackingDelegate['onOpenFile']('"+rr+"', flags) threw an exception: "+Br.message)}return dr},close:function(rr){if(ur.kb(rr))throw new ur.ErrnoError(8);rr.Fb&&(rr.Fb=null);try{rr.stream_ops.close&&rr.stream_ops.close(rr)}catch(or){throw or}finally{ur.Dc(rr.fd)}rr.fd=null},kb:function(rr){return rr.fd===null},llseek:function(rr,or,cr){if(ur.kb(rr))throw new ur.ErrnoError(8);if(!rr.seekable||!rr.stream_ops.llseek)throw new ur.ErrnoError(70);if(cr!=0&&cr!=1&&cr!=2)throw new ur.ErrnoError(28);return rr.position=rr.stream_ops.llseek(rr,or,cr),rr.jd=[],rr.position},read:function(rr,or,cr,dr,pr){if(0>dr||0>pr)throw new ur.ErrnoError(28);if(ur.kb(rr))throw new ur.ErrnoError(8);if((2097155&rr.flags)==1)throw new ur.ErrnoError(8);if(ur.isDir(rr.node.mode))throw new ur.ErrnoError(31);if(!rr.stream_ops.read)throw new ur.ErrnoError(28);var yr=pr!==void 0;if(yr){if(!rr.seekable)throw new ur.ErrnoError(70)}else pr=rr.position;return or=rr.stream_ops.read(rr,or,cr,dr,pr),yr||(rr.position+=or),or},write:function(rr,or,cr,dr,pr,yr){if(0>dr||0>pr)throw new ur.ErrnoError(28);if(ur.kb(rr))throw new ur.ErrnoError(8);if(!(2097155&rr.flags))throw new ur.ErrnoError(8);if(ur.isDir(rr.node.mode))throw new ur.ErrnoError(31);if(!rr.stream_ops.write)throw new ur.ErrnoError(28);rr.seekable&&1024&rr.flags&&ur.llseek(rr,0,2);var Nr=pr!==void 0;if(Nr){if(!rr.seekable)throw new ur.ErrnoError(70)}else pr=rr.position;or=rr.stream_ops.write(rr,or,cr,dr,pr,yr),Nr||(rr.position+=or);try{rr.path&&ur.Sa.onWriteToFile&&ur.Sa.onWriteToFile(rr.path)}catch(Br){lr("FS.trackingDelegate['onWriteToFile']('"+rr.path+"') threw an exception: "+Br.message)}return or},allocate:function(rr,or,cr){if(ur.kb(rr))throw new ur.ErrnoError(8);if(0>or||0>=cr)throw new ur.ErrnoError(28);if(!(2097155&rr.flags))throw new ur.ErrnoError(8);if(!ur.isFile(rr.node.mode)&&!ur.isDir(rr.node.mode))throw new ur.ErrnoError(43);if(!rr.stream_ops.allocate)throw new ur.ErrnoError(138);rr.stream_ops.allocate(rr,or,cr)},mmap:function(rr,or,cr,dr,pr,yr){if(2&pr&&!(2&yr)&&(2097155&rr.flags)!=2)throw new ur.ErrnoError(2);if((2097155&rr.flags)==1)throw new ur.ErrnoError(2);if(!rr.stream_ops.mmap)throw new ur.ErrnoError(43);return rr.stream_ops.mmap(rr,or,cr,dr,pr,yr)},msync:function(rr,or,cr,dr,pr){return rr&&rr.stream_ops.msync?rr.stream_ops.msync(rr,or,cr,dr,pr):0},ud:function(){return 0},ic:function(rr,or,cr){if(!rr.stream_ops.ic)throw new ur.ErrnoError(59);return rr.stream_ops.ic(rr,or,cr)},readFile:function(rr,or){if((or=or||{}).flags=or.flags||0,or.encoding=or.encoding||"binary",or.encoding!=="utf8"&&or.encoding!=="binary")throw Error('Invalid encoding type "'+or.encoding+'"');var cr,dr=ur.open(rr,or.flags);rr=ur.stat(rr).size;var pr=new Uint8Array(rr);return ur.read(dr,pr,0,rr,0),or.encoding==="utf8"?cr=An(pr,0):or.encoding==="binary"&&(cr=pr),ur.close(dr),cr},writeFile:function(rr,or,cr){if((cr=cr||{}).flags=cr.flags||577,rr=ur.open(rr,cr.flags,cr.mode),typeof or=="string"){var dr=new Uint8Array(Nn(or)+1);or=En(or,dr,0,dr.length),ur.write(rr,dr,0,or,void 0,cr.Bc)}else{if(!ArrayBuffer.isView(or))throw Error("Unsupported data type");ur.write(rr,or,0,or.byteLength,void 0,cr.Bc)}ur.close(rr)},cwd:function(){return ur.Wb},chdir:function(rr){if((rr=ur.lookupPath(rr,{Ta:!0})).node===null)throw new ur.ErrnoError(44);if(!ur.isDir(rr.node.mode))throw new ur.ErrnoError(54);var or=ur.Za(rr.node,"x");if(or)throw new ur.ErrnoError(or);ur.Wb=rr.path},Fc:function(){ur.mkdir("/tmp"),ur.mkdir("/home"),ur.mkdir("/home/web_user")},Ec:function(){ur.mkdir("/dev"),ur.Qb(ur.bb(1,3),{read:function(){return 0},write:function(or,cr,dr,pr){return pr}}),ur.rb("/dev/null",ur.bb(1,3)),bi(ur.bb(5,0),Ti),bi(ur.bb(6,0),Ci),ur.rb("/dev/tty",ur.bb(5,0)),ur.rb("/dev/tty1",ur.bb(6,0));var rr=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var or=new Uint8Array(1);return function(){return crypto.getRandomValues(or),or[0]}}if(wr)try{var cr=Et;return function(){return cr.randomBytes(1)[0]}}catch(dr){}return function(){en("randomDevice")}}();ur.Wa("/dev","random",rr),ur.Wa("/dev","urandom",rr),ur.mkdir("/dev/shm"),ur.mkdir("/dev/shm/tmp")},Hc:function(){ur.mkdir("/proc");var rr=ur.mkdir("/proc/self");ur.mkdir("/proc/self/fd"),ur.mount({mount:function(){var or=ur.createNode(rr,"fd",16895,73);return or.node_ops={lookup:function(cr,dr){var pr=ur.$a(+dr);if(!pr)throw new ur.ErrnoError(8);return(cr={parent:null,mount:{jc:"fake"},node_ops:{readlink:function(){return pr.path}}}).parent=cr}},or}},{},"/proc/self/fd")},Ic:function(){ar.stdin?ur.Wa("/dev","stdin",ar.stdin):ur.symlink("/dev/tty","/dev/stdin"),ar.stdout?ur.Wa("/dev","stdout",null,ar.stdout):ur.symlink("/dev/tty","/dev/stdout"),ar.stderr?ur.Wa("/dev","stderr",null,ar.stderr):ur.symlink("/dev/tty1","/dev/stderr"),ur.open("/dev/stdin",0),ur.open("/dev/stdout",1),ur.open("/dev/stderr",1)},Yb:function(){ur.ErrnoError||(ur.ErrnoError=function(rr,or){this.node=or,this.hd=function(cr){this.Oa=cr},this.hd(rr),this.message="FS error"},ur.ErrnoError.prototype=Error(),ur.ErrnoError.prototype.constructor=ur.ErrnoError,[44].forEach(function(rr){ur.Db[rr]=new ur.ErrnoError(rr),ur.Db[rr].stack="<generic error, no stack>"}))},lc:function(){ur.Yb(),ur.Ua=Array(4096),ur.mount(Kr,{},"/"),ur.Fc(),ur.Ec(),ur.Hc(),ur.Lc={MEMFS:Kr}},jb:function(rr,or,cr){ur.jb.Hb=!0,ur.Yb(),ar.stdin=rr||ar.stdin,ar.stdout=or||ar.stdout,ar.stderr=cr||ar.stderr,ur.Ic()},wd:function(){ur.jb.Hb=!1;var rr=ar._fflush;for(rr&&rr(0),rr=0;rr<ur.streams.length;rr++){var or=ur.streams[rr];or&&ur.close(or)}},Eb:function(rr,or){var cr=0;return rr&&(cr|=365),or&&(cr|=146),cr},od:function(rr,or){return(rr=ur.xb(rr,or)).exists?rr.object:null},xb:function(rr,or){try{var cr=ur.lookupPath(rr,{Ta:!or});rr=cr.path}catch(pr){}var dr={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,ad:!1,cd:null,bd:null};try{cr=ur.lookupPath(rr,{parent:!0}),dr.ad=!0,dr.cd=cr.path,dr.bd=cr.node,dr.name=On(rr),cr=ur.lookupPath(rr,{Ta:!or}),dr.exists=!0,dr.path=cr.path,dr.object=cr.node,dr.name=cr.node.name,dr.isRoot=cr.path==="/"}catch(pr){dr.error=pr.Oa}return dr},md:function(rr,or){for(rr=typeof rr=="string"?rr:ur.Ya(rr),or=or.split("/").reverse();or.length;){var cr=or.pop();if(cr){var dr=Tn(rr,cr);try{ur.mkdir(dr)}catch(pr){}rr=dr}}return dr},Gc:function(rr,or,cr,dr,pr){return rr=Tn(typeof rr=="string"?rr:ur.Ya(rr),or),ur.create(rr,ur.Eb(dr,pr))},zb:function(rr,or,cr,dr,pr,yr){if(rr=or?Tn(typeof rr=="string"?rr:ur.Ya(rr),or):rr,dr=ur.Eb(dr,pr),pr=ur.create(rr,dr),cr){if(typeof cr=="string"){rr=Array(cr.length),or=0;for(var Nr=cr.length;or<Nr;++or)rr[or]=cr.charCodeAt(or);cr=rr}ur.chmod(pr,146|dr),rr=ur.open(pr,577),ur.write(rr,cr,0,cr.length,0,yr),ur.close(rr),ur.chmod(pr,dr)}return pr},Wa:function(rr,or,cr,dr){rr=Tn(typeof rr=="string"?rr:ur.Ya(rr),or),or=ur.Eb(!!cr,!!dr),ur.Wa.Kb||(ur.Wa.Kb=64);var pr=ur.bb(ur.Wa.Kb++,0);return ur.Qb(pr,{open:function(yr){yr.seekable=!1},close:function(){dr&&dr.buffer&&dr.buffer.length&&dr(10)},read:function(yr,Nr,Br,jr){for(var $r=0,Hr=0;Hr<jr;Hr++){try{var Zr=cr()}catch(on){throw new ur.ErrnoError(29)}if(Zr===void 0&&$r===0)throw new ur.ErrnoError(6);if(Zr==null)break;$r++,Nr[Br+Hr]=Zr}return $r&&(yr.node.timestamp=Date.now()),$r},write:function(yr,Nr,Br,jr){for(var $r=0;$r<jr;$r++)try{dr(Nr[Br+$r])}catch(Hr){throw new ur.ErrnoError(29)}return jr&&(yr.node.timestamp=Date.now()),$r}}),ur.rb(rr,or,pr)},ac:function(rr){if(rr.Ib||rr.Sc||rr.link||rr.Na)return!0;if(typeof XMLHttpRequest!="undefined")throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!Ir)throw Error("Cannot load without read() or XMLHttpRequest.");try{rr.Na=zn(Ir(rr.url),!0),rr.Ra=rr.Na.length}catch(or){throw new ur.ErrnoError(29)}},ld:function(rr,or,cr,dr,pr){function yr(){this.Jb=!1,this.ob=[]}if(yr.prototype.get=function($r){if(!($r>this.length-1||0>$r)){var Hr=$r%this.chunkSize;return this.dc($r/this.chunkSize|0)[Hr]}},yr.prototype.pc=function($r){this.dc=$r},yr.prototype.Ub=function(){var $r=new XMLHttpRequest;if($r.open("HEAD",cr,!1),$r.send(null),!(200<=$r.status&&300>$r.status||$r.status===304))throw Error("Couldn't load "+cr+". Status: "+$r.status);var Hr,Zr=Number($r.getResponseHeader("Content-length")),on=(Hr=$r.getResponseHeader("Accept-Ranges"))&&Hr==="bytes";$r=(Hr=$r.getResponseHeader("Content-Encoding"))&&Hr==="gzip";var an=1048576;on||(an=Zr);var sn=this;sn.pc(function(cn){var hn=cn*an,yn=(cn+1)*an-1;if(yn=Math.min(yn,Zr-1),sn.ob[cn]===void 0){var ai=sn.ob;if(hn>yn)throw Error("invalid range ("+hn+", "+yn+") or no bytes requested!");if(yn>Zr-1)throw Error("only "+Zr+" bytes available! programmer error!");var gn=new XMLHttpRequest;if(gn.open("GET",cr,!1),Zr!==an&&gn.setRequestHeader("Range","bytes="+hn+"-"+yn),typeof Uint8Array!="undefined"&&(gn.responseType="arraybuffer"),gn.overrideMimeType&&gn.overrideMimeType("text/plain; charset=x-user-defined"),gn.send(null),!(200<=gn.status&&300>gn.status||gn.status===304))throw Error("Couldn't load "+cr+". Status: "+gn.status);hn=gn.response!==void 0?new Uint8Array(gn.response||[]):zn(gn.responseText||"",!0),ai[cn]=hn}if(sn.ob[cn]===void 0)throw Error("doXHR failed!");return sn.ob[cn]}),!$r&&Zr||(an=Zr=1,an=Zr=this.dc(0).length,fr("LazyFiles on gzip forces download of the whole file when length is accessed")),this.tc=Zr,this.sc=an,this.Jb=!0},typeof XMLHttpRequest!="undefined"){if(!Ar)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var Nr=new yr;Object.defineProperties(Nr,{length:{get:function(){return this.Jb||this.Ub(),this.tc}},chunkSize:{get:function(){return this.Jb||this.Ub(),this.sc}}}),Nr={Ib:!1,Na:Nr}}else Nr={Ib:!1,url:cr};var Br=ur.Gc(rr,or,Nr,dr,pr);Nr.Na?Br.Na=Nr.Na:Nr.url&&(Br.Na=null,Br.url=Nr.url),Object.defineProperties(Br,{Ra:{get:function(){return this.Na.length}}});var jr={};return Object.keys(Br.stream_ops).forEach(function($r){var Hr=Br.stream_ops[$r];jr[$r]=function(){return ur.ac(Br),Hr.apply(null,arguments)}}),jr.read=function($r,Hr,Zr,on,an){if(ur.ac(Br),an>=($r=$r.node.Na).length)return 0;if(on=Math.min($r.length-an,on),$r.slice)for(var sn=0;sn<on;sn++)Hr[Zr+sn]=$r[an+sn];else for(sn=0;sn<on;sn++)Hr[Zr+sn]=$r.get(an+sn);return on},Br.stream_ops=jr,Br},nd:function(rr,or,cr,dr,pr,yr,Nr,Br,jr,$r){function Hr(on){function an(cn){$r&&$r(),Br||ur.zb(rr,or,cn,dr,pr,jr),yr&&yr(),qn()}var sn=!1;ar.preloadPlugins.forEach(function(cn){!sn&&cn.canHandle(Zr)&&(cn.handle(on,Zr,an,function(){Nr&&Nr(),qn()}),sn=!0)}),sn||an(on)}(void 0).jb();var Zr=or?xn(Tn(rr,or)):rr;Qn(),typeof cr=="string"?function(on,an,sn){var cn="al "+on;Cr(on,function(hn){zr(hn,'Loading data file "'+on+'" failed (no arrayBuffer).'),an(new Uint8Array(hn)),cn&&qn()},function(){if(!sn)throw'Loading data file "'+on+'" failed.';sn()}),cn&&Qn()}(cr,function(on){Hr(on)},Nr):Hr(cr)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},Rb:function(){return"EM_FS_"+window.location.pathname},Sb:20,ib:"FILE_DATA",xd:function(rr,or,cr){or=or||function(){},cr=cr||function(){};var dr=ur.indexedDB();try{var pr=dr.open(ur.Rb(),ur.Sb)}catch(yr){return cr(yr)}pr.onupgradeneeded=function(){fr("creating db"),pr.result.createObjectStore(ur.ib)},pr.onsuccess=function(){var yr=pr.result.transaction([ur.ib],"readwrite"),Nr=yr.objectStore(ur.ib),Br=0,jr=0,$r=rr.length;rr.forEach(function(Hr){(Hr=Nr.put(ur.xb(Hr).object.Na,Hr)).onsuccess=function(){++Br+jr==$r&&(jr==0?or():cr())},Hr.onerror=function(){jr++,Br+jr==$r&&(jr==0?or():cr())}}),yr.onerror=cr},pr.onerror=cr},rd:function(rr,or,cr){or=or||function(){},cr=cr||function(){};var dr=ur.indexedDB();try{var pr=dr.open(ur.Rb(),ur.Sb)}catch(yr){return cr(yr)}pr.onupgradeneeded=cr,pr.onsuccess=function(){var yr=pr.result;try{var Nr=yr.transaction([ur.ib],"readonly")}catch(Zr){return void cr(Zr)}var Br=Nr.objectStore(ur.ib),jr=0,$r=0,Hr=rr.length;rr.forEach(function(Zr){var on=Br.get(Zr);on.onsuccess=function(){ur.xb(Zr).exists&&ur.unlink(Zr),ur.zb(jn(Zr),On(Zr),on.result,!0,!0,!0),++jr+$r==Hr&&($r==0?or():cr())},on.onerror=function(){$r++,jr+$r==Hr&&($r==0?or():cr())}}),Nr.onerror=cr},pr.onerror=cr}},Zn={};function ei(rr,or,cr){try{var dr=rr(or)}catch(pr){if(pr&&pr.node&&In(or)!==In(ur.Ya(pr.node)))return-54;throw pr}return Lr[cr>>2]=dr.dev,Lr[cr+4>>2]=0,Lr[cr+8>>2]=dr.ino,Lr[cr+12>>2]=dr.mode,Lr[cr+16>>2]=dr.nlink,Lr[cr+20>>2]=dr.uid,Lr[cr+24>>2]=dr.gid,Lr[cr+28>>2]=dr.rdev,Lr[cr+32>>2]=0,vn=[dr.size>>>0,(un=dr.size,1<=+Math.abs(un)?0<un?(0|Math.min(+Math.floor(un/4294967296),4294967295))>>>0:~~+Math.ceil((un-+(~~un>>>0))/4294967296)>>>0:0)],Lr[cr+40>>2]=vn[0],Lr[cr+44>>2]=vn[1],Lr[cr+48>>2]=4096,Lr[cr+52>>2]=dr.blocks,Lr[cr+56>>2]=dr.atime.getTime()/1e3|0,Lr[cr+60>>2]=0,Lr[cr+64>>2]=dr.mtime.getTime()/1e3|0,Lr[cr+68>>2]=0,Lr[cr+72>>2]=dr.ctime.getTime()/1e3|0,Lr[cr+76>>2]=0,vn=[dr.ino>>>0,(un=dr.ino,1<=+Math.abs(un)?0<un?(0|Math.min(+Math.floor(un/4294967296),4294967295))>>>0:~~+Math.ceil((un-+(~~un>>>0))/4294967296)>>>0:0)],Lr[cr+80>>2]=vn[0],Lr[cr+84>>2]=vn[1],0}var ti,ri=void 0;function Jn(){return Lr[(ri+=4)-4>>2]}function Sn(rr){if(!(rr=ur.$a(rr)))throw new ur.ErrnoError(8);return rr}ti=wr?function(){var rr=ae.hrtime();return 1e3*rr[0]+rr[1]/1e6}:function(){return performance.now()};var ni,ii={};function Ei(){if(!ni){var rr,or={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Fr||"./this.program"};for(rr in ii)ii[rr]===void 0?delete or[rr]:or[rr]=ii[rr];var cr=[];for(rr in or)cr.push(rr+"="+or[rr]);ni=cr}return ni}function Oi(rr,or,cr,dr){rr||(rr=this),this.parent=rr,this.mount=rr.mount,this.lb=null,this.id=ur.Zc++,this.name=or,this.mode=cr,this.node_ops={},this.stream_ops={},this.rdev=dr}function zn(rr,or){var cr=Array(Nn(rr)+1);return rr=En(rr,cr,0,cr.length),or&&(cr.length=rr),cr}Object.defineProperties(Oi.prototype,{read:{get:function(){return(365&this.mode)==365},set:function(rr){rr?this.mode|=365:this.mode&=-366}},write:{get:function(){return(146&this.mode)==146},set:function(rr){rr?this.mode|=146:this.mode&=-147}},Sc:{get:function(){return ur.isDir(this.mode)}},Ib:{get:function(){return ur.pb(this.mode)}}}),ur.FSNode=Oi,ur.lc();var Fi={a:function(rr,or,cr,dr){en("Assertion failed: "+fn(rr)+", at: "+[or?fn(or):"unknown filename",cr,dr?fn(dr):"unknown function"])},u:function(rr,or){(function(){function pr(Hr){return(Hr=Hr.toTimeString().match(/\(([A-Za-z ]+)\)$/))?Hr[1]:"GMT"}if(!gi){gi=!0;var yr=new Date().getFullYear(),Nr=new Date(yr,0,1),Br=new Date(yr,6,1);yr=Nr.getTimezoneOffset();var jr=Br.getTimezoneOffset(),$r=Math.max(yr,jr);Lr[ki()>>2]=60*$r,Lr[Si()>>2]=+(yr!=jr),Nr=pr(Nr),Br=pr(Br),Nr=ci(Nr),Br=ci(Br),jr<yr?(Lr[Cn()>>2]=Nr,Lr[Cn()+4>>2]=Br):(Lr[Cn()>>2]=Br,Lr[Cn()+4>>2]=Nr)}})(),rr=new Date(1e3*Lr[rr>>2]),Lr[or>>2]=rr.getSeconds(),Lr[or+4>>2]=rr.getMinutes(),Lr[or+8>>2]=rr.getHours(),Lr[or+12>>2]=rr.getDate(),Lr[or+16>>2]=rr.getMonth(),Lr[or+20>>2]=rr.getFullYear()-1900,Lr[or+24>>2]=rr.getDay();var cr=new Date(rr.getFullYear(),0,1);Lr[or+28>>2]=(rr.getTime()-cr.getTime())/864e5|0,Lr[or+36>>2]=-60*rr.getTimezoneOffset();var dr=new Date(rr.getFullYear(),6,1).getTimezoneOffset();return rr=0|(dr!=(cr=cr.getTimezoneOffset())&&rr.getTimezoneOffset()==Math.min(cr,dr)),Lr[or+32>>2]=rr,rr=Lr[Cn()+(rr?4:0)>>2],Lr[or+40>>2]=rr,or},m:function(rr,or){try{var cr;if(rr=fn(rr),-8&or)var dr=-28;else(cr=ur.lookupPath(rr,{Ta:!0}).node)?(rr="",4&or&&(rr+="r"),2&or&&(rr+="w"),1&or&&(rr+="x"),dr=rr&&ur.Za(cr,rr)?-2:0):dr=-44;return dr}catch(pr){return ur!==void 0&&pr instanceof ur.ErrnoError||en(pr),-pr.Oa}},A:function(rr,or){try{return rr=fn(rr),ur.chmod(rr,or),0}catch(cr){return ur!==void 0&&cr instanceof ur.ErrnoError||en(cr),-cr.Oa}},H:function(rr,or,cr){try{return rr=fn(rr),ur.chown(rr,or,cr),0}catch(dr){return ur!==void 0&&dr instanceof ur.ErrnoError||en(dr),-dr.Oa}},B:function(rr,or){try{return ur.fchmod(rr,or),0}catch(cr){return ur!==void 0&&cr instanceof ur.ErrnoError||en(cr),-cr.Oa}},I:function(rr,or,cr){try{return ur.fchown(rr,or,cr),0}catch(dr){return ur!==void 0&&dr instanceof ur.ErrnoError||en(dr),-dr.Oa}},b:function(rr,or,cr){ri=cr;try{var dr=Sn(rr);switch(or){case 0:var pr=Jn();return 0>pr?-28:ur.open(dr.path,dr.flags,0,pr).fd;case 1:case 2:case 13:case 14:return 0;case 3:return dr.flags;case 4:return pr=Jn(),dr.flags|=pr,0;case 12:return pr=Jn(),dn[pr+0>>1]=2,0;case 16:case 8:default:return-28;case 9:return Lr[oi()>>2]=28,-1}}catch(yr){return ur!==void 0&&yr instanceof ur.ErrnoError||en(yr),-yr.Oa}},E:function(rr,or){try{var cr=Sn(rr);return ei(ur.stat,cr.path,or)}catch(dr){return ur!==void 0&&dr instanceof ur.ErrnoError||en(dr),-dr.Oa}},n:function(rr,or,cr){try{return ur.Nc(rr,cr),0}catch(dr){return ur!==void 0&&dr instanceof ur.ErrnoError||en(dr),-dr.Oa}},l:function(rr,or){try{if(or===0)return-28;var cr=ur.cwd();return or<Nn(cr)+1?-68:(En(cr,nn,rr,or),rr)}catch(dr){return ur!==void 0&&dr instanceof ur.ErrnoError||en(dr),-dr.Oa}},G:function(){return 0},d:function(){return 42},z:function(rr,or){try{return rr=fn(rr),ei(ur.lstat,rr,or)}catch(cr){return ur!==void 0&&cr instanceof ur.ErrnoError||en(cr),-cr.Oa}},C:function(rr,or){try{return(rr=In(rr=fn(rr)))[rr.length-1]==="/"&&(rr=rr.substr(0,rr.length-1)),ur.mkdir(rr,or,0),0}catch(cr){return ur!==void 0&&cr instanceof ur.ErrnoError||en(cr),-cr.Oa}},y:function(rr,or,cr,dr,pr,yr){try{e:{yr<<=12;var Nr=!1;if(16&dr&&rr%65536!=0)var Br=-28;else{if(32&dr){var jr=wi(or);if(!jr){Br=-48;break e}Nr=!0}else{var $r=ur.$a(pr);if(!$r){Br=-8;break e}var Hr=ur.mmap($r,rr,or,yr,cr,dr);jr=Hr.ed,Nr=Hr.vb}Zn[jr]={Uc:jr,Tc:or,vb:Nr,fd:pr,dd:cr,flags:dr,offset:yr},Br=jr}}return Br}catch(Zr){return ur!==void 0&&Zr instanceof ur.ErrnoError||en(Zr),-Zr.Oa}},x:function(rr,or){try{var cr=Zn[rr];if(or!==0&&cr){if(or===cr.Tc){var dr=ur.$a(cr.fd);if(dr&&2&cr.dd){var pr=cr.flags,yr=cr.offset,Nr=nn.slice(rr,rr+or);ur.msync(dr,Nr,yr,or,pr)}Zn[rr]=null,cr.vb&&Dn(cr.Uc)}var Br=0}else Br=-28;return Br}catch(jr){return ur!==void 0&&jr instanceof ur.ErrnoError||en(jr),-jr.Oa}},w:function(rr,or,cr){ri=cr;try{var dr=fn(rr),pr=cr?Jn():0;return ur.open(dr,or,pr).fd}catch(yr){return ur!==void 0&&yr instanceof ur.ErrnoError||en(yr),-yr.Oa}},J:function(rr,or,cr){try{if(rr=fn(rr),0>=cr)var dr=-28;else{var pr=ur.readlink(rr),yr=Math.min(cr,Nn(pr)),Nr=rn[or+yr];En(pr,nn,or,cr+1),rn[or+yr]=Nr,dr=yr}return dr}catch(Br){return ur!==void 0&&Br instanceof ur.ErrnoError||en(Br),-Br.Oa}},F:function(rr){try{return rr=fn(rr),ur.rmdir(rr),0}catch(or){return ur!==void 0&&or instanceof ur.ErrnoError||en(or),-or.Oa}},e:function(rr,or){try{return rr=fn(rr),ei(ur.stat,rr,or)}catch(cr){return ur!==void 0&&cr instanceof ur.ErrnoError||en(cr),-cr.Oa}},i:function(rr){try{return rr=fn(rr),ur.unlink(rr),0}catch(or){return ur!==void 0&&or instanceof ur.ErrnoError||en(or),-or.Oa}},v:function(){return 2147483648},p:function(rr,or,cr){nn.copyWithin(rr,or,or+cr)},c:function(rr){var or=nn.length;if(2147483648<(rr>>>=0))return!1;for(var cr=1;4>=cr;cr*=2){var dr=or*(1+.2/cr);dr=Math.min(dr,rr+100663296),0<(dr=Math.max(rr,dr))%65536&&(dr+=65536-dr%65536);e:{try{qr.grow(Math.min(2147483648,dr)-tn.byteLength+65535>>>16),li();var pr=1;break e}catch(yr){}pr=void 0}if(pr)return!0}return!1},t:function(rr){for(var or=ti();ti()-or<rr;);},r:function(rr,or){try{var cr=0;return Ei().forEach(function(dr,pr){var yr=or+cr;for(pr=Lr[rr+4*pr>>2]=yr,yr=0;yr<dr.length;++yr)rn[pr++>>0]=dr.charCodeAt(yr);rn[pr>>0]=0,cr+=dr.length+1}),0}catch(dr){return ur!==void 0&&dr instanceof ur.ErrnoError||en(dr),dr.Oa}},s:function(rr,or){try{var cr=Ei();Lr[rr>>2]=cr.length;var dr=0;return cr.forEach(function(pr){dr+=pr.length+1}),Lr[or>>2]=dr,0}catch(pr){return ur!==void 0&&pr instanceof ur.ErrnoError||en(pr),pr.Oa}},f:function(rr){try{var or=Sn(rr);return ur.close(or),0}catch(cr){return ur!==void 0&&cr instanceof ur.ErrnoError||en(cr),cr.Oa}},q:function(rr,or){try{var cr=Sn(rr),dr=cr.tty?2:ur.isDir(cr.mode)?3:ur.fb(cr.mode)?7:4;return rn[or>>0]=dr,0}catch(pr){return ur!==void 0&&pr instanceof ur.ErrnoError||en(pr),pr.Oa}},j:function(rr,or,cr,dr){try{e:{for(var pr=Sn(rr),yr=rr=0;yr<cr;yr++){var Nr=Lr[or+(8*yr+4)>>2],Br=ur.read(pr,rn,Lr[or+8*yr>>2],Nr,void 0);if(0>Br){var jr=-1;break e}if(rr+=Br,Br<Nr)break}jr=rr}return Lr[dr>>2]=jr,0}catch($r){return ur!==void 0&&$r instanceof ur.ErrnoError||en($r),$r.Oa}},o:function(rr,or,cr,dr,pr){try{var yr=Sn(rr);return-9007199254740992>=(rr=4294967296*cr+(or>>>0))||9007199254740992<=rr?-61:(ur.llseek(yr,rr,dr),vn=[yr.position>>>0,(un=yr.position,1<=+Math.abs(un)?0<un?(0|Math.min(+Math.floor(un/4294967296),4294967295))>>>0:~~+Math.ceil((un-+(~~un>>>0))/4294967296)>>>0:0)],Lr[pr>>2]=vn[0],Lr[pr+4>>2]=vn[1],yr.Fb&&rr===0&&dr===0&&(yr.Fb=null),0)}catch(Nr){return ur!==void 0&&Nr instanceof ur.ErrnoError||en(Nr),Nr.Oa}},k:function(rr){try{var or=Sn(rr);return or.stream_ops&&or.stream_ops.fsync?-or.stream_ops.fsync(or):0}catch(cr){return ur!==void 0&&cr instanceof ur.ErrnoError||en(cr),cr.Oa}},g:function(rr,or,cr,dr){try{e:{for(var pr=Sn(rr),yr=rr=0;yr<cr;yr++){var Nr=ur.write(pr,rn,Lr[or+8*yr>>2],Lr[or+(8*yr+4)>>2],void 0);if(0>Nr){var Br=-1;break e}rr+=Nr}Br=rr}return Lr[dr>>2]=Br,0}catch(jr){return ur!==void 0&&jr instanceof ur.ErrnoError||en(jr),jr.Oa}},h:function(rr){var or=Date.now();return Lr[rr>>2]=or/1e3|0,Lr[rr+4>>2]=or%1e3*1e3|0,0},K:function(rr){var or=Date.now()/1e3|0;return rr&&(Lr[rr>>2]=or),or},D:function(rr,or){if(or){var cr=or+8;or=1e3*Lr[cr>>2],or+=Lr[cr+4>>2]/1e3}else or=Date.now();rr=fn(rr);try{ur.kd(rr,or,or);var dr=0}catch(pr){if(!(pr instanceof ur.ErrnoError)){e:{if(!(dr=Error()).stack){try{throw Error()}catch(yr){dr=yr}if(!dr.stack){dr="(no stack trace available)";break e}}dr=dr.stack.toString()}throw ar.extraStackTrace&&(dr+=`
`+ar.extraStackTrace()),dr=function(yr){return yr.replace(/\b_Z[\w\d_]+/g,function(Nr){return Nr==Nr?Nr:Nr+" ["+Nr+"]"})}(dr),pr+" : "+dr}dr=pr.Oa,Lr[oi()>>2]=dr,dr=-1}return dr}};(function(){function rr(pr){ar.asm=pr.exports,qr=ar.asm.L,li(),bn=ar.asm.Da,di.unshift(ar.asm.M),qn()}function or(pr){rr(pr.instance)}function cr(pr){return function(){if(!vr&&(gr||Ar)){if(typeof fetch=="function"&&!pn.startsWith("file://"))return fetch(pn,{credentials:"same-origin"}).then(function(yr){if(!yr.ok)throw"failed to load wasm binary file at '"+pn+"'";return yr.arrayBuffer()}).catch(function(){return pi()});if(Cr)return new Promise(function(yr,Nr){Cr(pn,function(Br){yr(new Uint8Array(Br))},Nr)})}return Promise.resolve().then(function(){return pi()})}().then(function(yr){return WebAssembly.instantiate(yr,dr)}).then(pr,function(yr){lr("failed to asynchronously prepare wasm: "+yr),en(yr)})}var dr={a:Fi};if(Qn(),ar.instantiateWasm)try{return ar.instantiateWasm(dr,rr)}catch(pr){return lr("Module.instantiateWasm callback failed with error: "+pr),!1}vr||typeof WebAssembly.instantiateStreaming!="function"||_i()||pn.startsWith("file://")||typeof fetch!="function"?cr(or):fetch(pn,{credentials:"same-origin"}).then(function(pr){return WebAssembly.instantiateStreaming(pr,dr).then(or,function(yr){return lr("wasm streaming compile failed: "+yr),lr("falling back to ArrayBuffer instantiation"),cr(or)})})})(),ar.___wasm_call_ctors=function(){return(ar.___wasm_call_ctors=ar.asm.M).apply(null,arguments)},ar._sqlite3_vfs_find=function(){return(ar._sqlite3_vfs_find=ar.asm.N).apply(null,arguments)},ar._sqlite3_free=function(){return(ar._sqlite3_free=ar.asm.O).apply(null,arguments)};var oi=ar.___errno_location=function(){return(oi=ar.___errno_location=ar.asm.P).apply(null,arguments)};ar._sqlite3_finalize=function(){return(ar._sqlite3_finalize=ar.asm.Q).apply(null,arguments)},ar._sqlite3_reset=function(){return(ar._sqlite3_reset=ar.asm.R).apply(null,arguments)},ar._sqlite3_clear_bindings=function(){return(ar._sqlite3_clear_bindings=ar.asm.S).apply(null,arguments)},ar._sqlite3_value_blob=function(){return(ar._sqlite3_value_blob=ar.asm.T).apply(null,arguments)},ar._sqlite3_value_text=function(){return(ar._sqlite3_value_text=ar.asm.U).apply(null,arguments)},ar._sqlite3_value_bytes=function(){return(ar._sqlite3_value_bytes=ar.asm.V).apply(null,arguments)},ar._sqlite3_value_double=function(){return(ar._sqlite3_value_double=ar.asm.W).apply(null,arguments)},ar._sqlite3_value_int=function(){return(ar._sqlite3_value_int=ar.asm.X).apply(null,arguments)},ar._sqlite3_value_type=function(){return(ar._sqlite3_value_type=ar.asm.Y).apply(null,arguments)},ar._sqlite3_result_blob=function(){return(ar._sqlite3_result_blob=ar.asm.Z).apply(null,arguments)},ar._sqlite3_result_double=function(){return(ar._sqlite3_result_double=ar.asm._).apply(null,arguments)},ar._sqlite3_result_error=function(){return(ar._sqlite3_result_error=ar.asm.$).apply(null,arguments)},ar._sqlite3_result_int=function(){return(ar._sqlite3_result_int=ar.asm.aa).apply(null,arguments)},ar._sqlite3_result_int64=function(){return(ar._sqlite3_result_int64=ar.asm.ba).apply(null,arguments)},ar._sqlite3_result_null=function(){return(ar._sqlite3_result_null=ar.asm.ca).apply(null,arguments)},ar._sqlite3_result_text=function(){return(ar._sqlite3_result_text=ar.asm.da).apply(null,arguments)},ar._sqlite3_step=function(){return(ar._sqlite3_step=ar.asm.ea).apply(null,arguments)},ar._sqlite3_column_count=function(){return(ar._sqlite3_column_count=ar.asm.fa).apply(null,arguments)},ar._sqlite3_data_count=function(){return(ar._sqlite3_data_count=ar.asm.ga).apply(null,arguments)},ar._sqlite3_column_blob=function(){return(ar._sqlite3_column_blob=ar.asm.ha).apply(null,arguments)},ar._sqlite3_column_bytes=function(){return(ar._sqlite3_column_bytes=ar.asm.ia).apply(null,arguments)},ar._sqlite3_column_double=function(){return(ar._sqlite3_column_double=ar.asm.ja).apply(null,arguments)},ar._sqlite3_column_text=function(){return(ar._sqlite3_column_text=ar.asm.ka).apply(null,arguments)},ar._sqlite3_column_type=function(){return(ar._sqlite3_column_type=ar.asm.la).apply(null,arguments)},ar._sqlite3_column_name=function(){return(ar._sqlite3_column_name=ar.asm.ma).apply(null,arguments)},ar._sqlite3_bind_blob=function(){return(ar._sqlite3_bind_blob=ar.asm.na).apply(null,arguments)},ar._sqlite3_bind_double=function(){return(ar._sqlite3_bind_double=ar.asm.oa).apply(null,arguments)},ar._sqlite3_bind_int=function(){return(ar._sqlite3_bind_int=ar.asm.pa).apply(null,arguments)},ar._sqlite3_bind_text=function(){return(ar._sqlite3_bind_text=ar.asm.qa).apply(null,arguments)},ar._sqlite3_bind_parameter_index=function(){return(ar._sqlite3_bind_parameter_index=ar.asm.ra).apply(null,arguments)},ar._sqlite3_sql=function(){return(ar._sqlite3_sql=ar.asm.sa).apply(null,arguments)},ar._sqlite3_normalized_sql=function(){return(ar._sqlite3_normalized_sql=ar.asm.ta).apply(null,arguments)},ar._sqlite3_errmsg=function(){return(ar._sqlite3_errmsg=ar.asm.ua).apply(null,arguments)},ar._sqlite3_exec=function(){return(ar._sqlite3_exec=ar.asm.va).apply(null,arguments)},ar._sqlite3_prepare_v2=function(){return(ar._sqlite3_prepare_v2=ar.asm.wa).apply(null,arguments)},ar._sqlite3_changes=function(){return(ar._sqlite3_changes=ar.asm.xa).apply(null,arguments)},ar._sqlite3_close_v2=function(){return(ar._sqlite3_close_v2=ar.asm.ya).apply(null,arguments)},ar._sqlite3_create_function_v2=function(){return(ar._sqlite3_create_function_v2=ar.asm.za).apply(null,arguments)},ar._sqlite3_open=function(){return(ar._sqlite3_open=ar.asm.Aa).apply(null,arguments)};var Wn=ar._malloc=function(){return(Wn=ar._malloc=ar.asm.Ba).apply(null,arguments)},Dn=ar._free=function(){return(Dn=ar._free=ar.asm.Ca).apply(null,arguments)};ar._RegisterExtensionFunctions=function(){return(ar._RegisterExtensionFunctions=ar.asm.Ea).apply(null,arguments)},ar._register_for_idb=function(){return(ar._register_for_idb=ar.asm.Fa).apply(null,arguments)};var Hn,Cn=ar.__get_tzname=function(){return(Cn=ar.__get_tzname=ar.asm.Ga).apply(null,arguments)},Si=ar.__get_daylight=function(){return(Si=ar.__get_daylight=ar.asm.Ha).apply(null,arguments)},ki=ar.__get_timezone=function(){return(ki=ar.__get_timezone=ar.asm.Ia).apply(null,arguments)},$n=ar.stackSave=function(){return($n=ar.stackSave=ar.asm.Ja).apply(null,arguments)},Ln=ar.stackRestore=function(){return(Ln=ar.stackRestore=ar.asm.Ka).apply(null,arguments)},kn=ar.stackAlloc=function(){return(kn=ar.stackAlloc=ar.asm.La).apply(null,arguments)},Ri=ar._memalign=function(){return(Ri=ar._memalign=ar.asm.Ma).apply(null,arguments)};function si(){function rr(){if(!Hn&&(Hn=!0,ar.calledRun=!0,!Jr)){if(ar.noFSInit||ur.jb.Hb||ur.jb(),ur.hc=!1,Kn(di),ar.onRuntimeInitialized&&ar.onRuntimeInitialized(),ar.postRun)for(typeof ar.postRun=="function"&&(ar.postRun=[ar.postRun]);ar.postRun.length;){var or=ar.postRun.shift();hi.unshift(or)}Kn(hi)}}if(!(0<Mn)){if(ar.preRun)for(typeof ar.preRun=="function"&&(ar.preRun=[ar.preRun]);ar.preRun.length;)Ai();Kn(fi),0<Mn||(ar.setStatus?(ar.setStatus("Running..."),setTimeout(function(){setTimeout(function(){ar.setStatus("")},1),rr()},1)):rr())}}if(ar.cwrap=function(rr,or,cr,dr){var pr=(cr=cr||[]).every(function(yr){return yr==="number"});return or!=="string"&&pr&&!dr?Vr(rr):function(){return function(yr,Nr,Br,jr){var $r,Hr={string:function(cn){var hn=0;if(cn!=null&&cn!==0){var yn=1+(cn.length<<2);hn=kn(yn),En(cn,nn,hn,yn)}return hn},array:function(cn){var hn=kn(cn.length);return rn.set(cn,hn),hn}},Zr=Vr(yr),on=[];if(yr=0,jr)for(var an=0;an<jr.length;an++){var sn=Hr[Br[an]];sn?(yr===0&&(yr=$n()),on[an]=sn(jr[an])):on[an]=jr[an]}return Br=Zr.apply(null,on),$r=Br,Br=Nr==="string"?fn($r):Nr==="boolean"?!!$r:$r,yr!==0&&Ln(yr),Br}(rr,or,cr,arguments)}},ar.UTF8ToString=fn,ar.FS=ur,ar.stackSave=$n,ar.stackRestore=Ln,ar.stackAlloc=kn,Pn=function rr(){Hn||si(),Hn||(Pn=rr)},ar.run=si,ar.preInit)for(typeof ar.preInit=="function"&&(ar.preInit=[ar.preInit]);0<ar.preInit.length;)ar.preInit.pop()();return si(),ar}),tr)};er.exports=nr,er.exports.default=nr})(ot);var Ot=p(ot.exports);const St=63,kt=44,Rt=class{constructor(er,Zt){this.FS=er,this.backend=Zt,this.node_ops={getattr:tr=>{let nr=er.isFile(tr.mode)?tr.contents.getattr():null,ir={dev:1};return ir.ino=tr.id,ir.mode=nr?nr.mode:tr.mode,ir.nlink=1,ir.uid=0,ir.gid=0,ir.rdev=tr.rdev,ir.size=nr?nr.size:er.isDir(tr.mode)?4096:0,ir.atime=new Date(0),ir.mtime=new Date(0),ir.ctime=new Date(0),ir.blksize=nr?nr.blockSize:4096,ir.blocks=Math.ceil(ir.size/ir.blksize),ir},setattr:(tr,nr)=>{this.FS.isFile(tr.mode)?tr.contents.setattr(nr):(nr.mode!=null&&(tr.mode=nr.mode),nr.size!=null&&(tr.size=nr.size))},lookup:(tr,nr)=>{throw new this.FS.ErrnoError(kt)},mknod:(tr,nr,ir,sr)=>{if(nr.endsWith(".lock"))throw new Error("Locking via lockfiles is not supported");return this.createNode(tr,nr,ir,sr)},rename:(tr,nr,ir)=>{throw new Error("rename not implemented")},unlink:(tr,nr)=>{this.FS.lookupNode(tr,nr).contents.delete(nr)},readdir:tr=>{throw new Error("readdir not implemented")},symlink:(tr,nr,ir)=>{throw new Error("symlink not implemented")},readlink:tr=>{throw new Error("symlink not implemented")}},this.stream_ops={open:tr=>{this.FS.isFile(tr.node.mode)&&tr.node.contents.open()},close:tr=>{this.FS.isFile(tr.node.mode)&&tr.node.contents.close()},read:(tr,nr,ir,sr,_r)=>tr.node.contents.read(nr,ir,sr,_r),write:(tr,nr,ir,sr,_r)=>tr.node.contents.write(nr,ir,sr,_r),llseek:(tr,nr,ir)=>{var sr=nr;if(ir===1?sr+=tr.position:ir===2&&er.isFile(tr.node.mode)&&(sr+=tr.node.contents.getattr().size),sr<0)throw new this.FS.ErrnoError(28);return sr},allocate:(tr,nr,ir)=>{tr.node.contents.setattr({size:nr+ir})},mmap:(tr,nr,ir,sr,_r,ar)=>{throw new Error("mmap not implemented")},msync:(tr,nr,ir,sr,_r)=>{throw new Error("msync not implemented")},fsync:(tr,nr,ir,sr,_r)=>{tr.node.contents.fsync()}}}mount(){return this.createNode(null,"/",16895,0)}lock(er,Zt){let{node:tr}=this.FS.lookupPath(er);return tr.contents.lock(Zt)}unlock(er,Zt){let{node:tr}=this.FS.lookupPath(er);return tr.contents.unlock(Zt)}createNode(er,Zt,tr,nr){if(!this.FS.isDir(tr)&&!this.FS.isFile(tr))throw new this.FS.ErrnoError(St);var ir=this.FS.createNode(er,Zt,tr,nr);return this.FS.isDir(ir.mode)?(ir.node_ops={mknod:this.node_ops.mknod,lookup:this.node_ops.lookup,unlink:this.node_ops.unlink,setattr:this.node_ops.setattr},ir.stream_ops={},ir.contents={}):this.FS.isFile(ir.mode)&&(ir.node_ops=this.node_ops,ir.stream_ops=this.stream_ops,ir.contents=this.backend.createFile(Zt)),er&&(er.contents[Zt]=ir,er.timestamp=ir.timestamp),ir}};let Nt=1,Mt=2;function xt(er){return(er[16]<<8)+er[17]}function At(er,Zt,tr){return function(nr,ir,sr){let _r=[];for(let ar=nr;ar<=ir;ar+=sr)_r.push(ar);return _r}(Zt-Zt%er,tr-1-(tr-1)%er,er)}function It(er,Zt,tr,nr){let ir=At(Zt,tr,nr),sr=0;return ir.map(_r=>{let ar=0,Or=Zt;tr>_r&&tr<_r+Zt&&(ar=tr-_r),nr>_r&&nr<_r+Zt&&(Or=nr-_r);let Sr=Or-ar,kr=new ArrayBuffer(Zt);if(tr>_r+Zt||nr<=_r)return null;let Ir=er.byteOffset+sr,Cr=er.buffer.byteLength-Ir;if(Cr<=0)return null;let Ur=Math.min(Sr,Cr);return new Uint8Array(kr).set(new Uint8Array(er.buffer,Ir,Ur),ar),sr+=Ur,{pos:_r,data:kr,offset:ar,length:Ur}}).filter(Boolean)}class Tt{constructor(Zt,tr,nr=null){this.filename=Zt,this.buffer=new Map,this.ops=tr,this.meta=nr,this._metaDirty=!1,this.writeLock=!1,this.openHandles=0}bufferChunks(Zt){for(let tr=0;tr<Zt.length;tr++){let nr=Zt[tr];this.buffer.set(nr.pos,nr)}}open(){if(this.openHandles++,this.openHandles===1){this.ops.open();let Zt=this.ops.readMeta();this.meta==null&&(Zt==null&&(Zt={size:0}),this.meta=Zt)}return this.meta}close(){this.fsync(),this.openHandles=Math.max(this.openHandles-1,0),this.openHandles===0&&this.ops.close()}delete(){this.ops.delete()}load(Zt){let tr=Zt.reduce((ir,sr)=>{let _r=this.buffer.get(sr);return _r?ir.chunks.push(_r):ir.missing.push(sr),ir},{chunks:[],missing:[]}),nr=[];return tr.missing.length>0&&(nr=this.ops.readBlocks(tr.missing,this.meta.blockSize)),tr.chunks.concat(nr)}read(Zt,tr,nr,ir){let sr=Zt.buffer;if(nr<=0||ir<0)return 0;if(ir>=this.meta.size){let Cr=new Uint8Array(sr,tr);for(let Ur=0;Ur<nr;Ur++)Cr[Ur]=0;return nr}ir=Math.max(ir,0);let _r=Math.min(nr,this.meta.size-ir),ar=ir,Or=ir+_r,Sr=At(this.meta.blockSize,ar,Or),kr=function(Cr,Ur,Wr){let Yr=new ArrayBuffer(Wr-Ur),Fr=new Uint8Array(Yr);for(let gr=0;gr<Cr.length;gr++){let Ar=Cr[gr];if(Ar.data.constructor.name!=="ArrayBuffer")throw new Error("Chunk data is not an ArrayBuffer");let wr=0,mr=Ar.data.byteLength;if(Ur>Ar.pos&&(wr=Ur-Ar.pos),Wr<Ar.pos+Ar.data.byteLength&&(mr=Wr-Ar.pos),wr>Ar.data.byteLength||mr<0)continue;let fr=mr-wr;Fr.set(new Uint8Array(Ar.data,wr,fr),Ar.pos-Ur+wr)}return Yr}(this.load(Sr),ar,Or);if(sr.byteLength-tr<kr.byteLength)throw new Error("Buffer given to `read` is too small");let Ir=new Uint8Array(sr);Ir.set(new Uint8Array(kr),tr);for(let Cr=_r;Cr<nr;Cr++)Ir[tr+Cr]=0;return nr}write(Zt,tr,nr,ir){if(this.meta.blockSize==null){let Ir=xt(new Uint8Array(Zt.buffer,Zt.byteOffset+tr));if(![512,1024,2048,4096,8192,16384,32768,65536].includes(Ir))throw new Error("File has invalid page size. (the first block of a new file must be written first)");this.setattr({blockSize:Ir})}let sr=Zt.buffer;if(nr<=0||ir<0||sr.byteLength===0)return 0;nr=Math.min(nr,sr.byteLength-tr);let _r=It(new Uint8Array(sr,tr,nr),this.meta.blockSize,ir,ir+nr),{partialWrites:ar,fullWrites:Or}=_r.reduce((Ir,Cr)=>(Cr.length!==this.meta.blockSize?Ir.partialWrites.push(Cr):Ir.fullWrites.push({pos:Cr.pos,data:Cr.data}),Ir),{fullWrites:[],partialWrites:[]}),Sr=[];ar.length>0&&(Sr=this.load(ar.map(Ir=>Ir.pos)));let kr=Or.concat(Sr.map(Ir=>{let Cr=ar.find(Ur=>Ur.pos===Ir.pos);return new Uint8Array(Ir.data).set(new Uint8Array(Cr.data,Cr.offset,Cr.length),Cr.offset,Cr.length),Ir}));return this.bufferChunks(kr),ir+nr>this.meta.size&&this.setattr({size:ir+nr}),nr}readIfFallback(){return Er(this,null,function*(){if(this.ops.readIfFallback){let Zt=yield this.ops.readIfFallback();this.meta=Zt||{size:0}}})}lock(Zt){return this._recordingLock||(this._recordingLock=!0),!!this.ops.lock(Zt)&&(Zt>=Mt&&(this.writeLock=!0),!0)}unlock(Zt){return Zt===0&&(this._recordingLock=!1),this.writeLock&&(this.fsync(),this.writeLock=!1),this.ops.unlock(Zt)}fsync(){if(this.buffer.size>0){let Zt=this.buffer.get(0);if(Zt){let tr=xt(new Uint8Array(Zt.data));if(tr!==this.meta.blockSize){let nr=this.buffer;this.buffer=new Map;let ir=[...nr.values()],sr=ir.length*this.meta.blockSize,_r=new ArrayBuffer(sr),ar=new Uint8Array(_r);for(let Or of ir)ar.set(new Uint8Array(Or.data),Or.pos);this.bufferChunks(It(ar,tr,0,sr)),this.setattr({blockSize:tr})}}this.ops.writeBlocks([...this.buffer.values()],this.meta.blockSize)}this._metaDirty&&(this.ops.writeMeta({size:this.meta.size}),this._metaDirty=!1),this.buffer=new Map}setattr(Zt){this.meta==null&&(this.meta={}),Zt.mode!==void 0&&(this.meta.mode=Zt.mode),Zt.blockSize!==void 0&&(this.meta.blockSize=Zt.blockSize),Zt.size!==void 0&&(this.meta.size=Zt.size,this._metaDirty=!0)}getattr(){return this.meta}}let Ct,Ft,Bt,Pt=3735928559;class Dt{constructor(Zt,{initialOffset:tr=4,useAtomics:nr=!0,stream:ir=!0,debug:sr,name:_r}={}){this.buffer=Zt,this.atomicView=new Int32Array(Zt),this.offset=tr,this.useAtomics=nr,this.stream=ir,this.debug=sr,this.name=_r}log(...Zt){this.debug&&console.log(`[reader: ${this.name}]`,...Zt)}waitWrite(Zt,tr=null){if(this.useAtomics){for(this.log(`waiting for ${Zt}`);Atomics.load(this.atomicView,0)===0;){if(tr!=null&&Atomics.wait(this.atomicView,0,0,tr)==="timed-out")throw new Error("timeout");Atomics.wait(this.atomicView,0,0,500)}this.log(`resumed for ${Zt}`)}else if(this.atomicView[0]!==1)throw new Error("`waitWrite` expected array to be readable")}flip(){if(this.log("flip"),this.useAtomics){if(Atomics.compareExchange(this.atomicView,0,1,0)!==1)throw new Error("Read data out of sync! This is disastrous");Atomics.notify(this.atomicView,0)}else this.atomicView[0]=0;this.offset=4}done(){this.waitWrite("done");let Zt=new DataView(this.buffer,this.offset).getUint32(0)===Pt;return Zt&&(this.log("done"),this.flip()),Zt}peek(Zt){this.peekOffset=this.offset;let tr=Zt();return this.offset=this.peekOffset,this.peekOffset=null,tr}string(Zt){this.waitWrite("string",Zt);let tr=this._int32(),nr=tr/2,ir=new DataView(this.buffer,this.offset,tr),sr=[];for(let ar=0;ar<nr;ar++)sr.push(ir.getUint16(2*ar));let _r=String.fromCharCode.apply(null,sr);return this.log("string",_r),this.offset+=tr,this.peekOffset==null&&this.flip(),_r}_int32(){let Zt=new DataView(this.buffer,this.offset).getInt32();return this.log("_int32",Zt),this.offset+=4,Zt}int32(){this.waitWrite("int32");let Zt=this._int32();return this.log("int32",Zt),this.peekOffset==null&&this.flip(),Zt}bytes(){this.waitWrite("bytes");let Zt=this._int32(),tr=new ArrayBuffer(Zt);return new Uint8Array(tr).set(new Uint8Array(this.buffer,this.offset,Zt)),this.log("bytes",tr),this.offset+=Zt,this.peekOffset==null&&this.flip(),tr}}class $t{constructor(Zt,{initialOffset:tr=4,useAtomics:nr=!0,stream:ir=!0,debug:sr,name:_r}={}){this.buffer=Zt,this.atomicView=new Int32Array(Zt),this.offset=tr,this.useAtomics=nr,this.stream=ir,this.debug=sr,this.name=_r,this.useAtomics?Atomics.store(this.atomicView,0,0):this.atomicView[0]=0}log(...Zt){this.debug&&console.log(`[writer: ${this.name}]`,...Zt)}waitRead(Zt){if(this.useAtomics){if(this.log(`waiting for ${Zt}`),Atomics.compareExchange(this.atomicView,0,0,1)!==0)throw new Error("Wrote something into unwritable buffer! This is disastrous");for(Atomics.notify(this.atomicView,0);Atomics.load(this.atomicView,0)===1;)Atomics.wait(this.atomicView,0,1,500);this.log(`resumed for ${Zt}`)}else this.atomicView[0]=1;this.offset=4}finalize(){this.log("finalizing"),new DataView(this.buffer,this.offset).setUint32(0,Pt),this.waitRead("finalize")}string(Zt){this.log("string",Zt);let tr=2*Zt.length;this._int32(tr);let nr=new DataView(this.buffer,this.offset,tr);for(let ir=0;ir<Zt.length;ir++)nr.setUint16(2*ir,Zt.charCodeAt(ir));this.offset+=tr,this.waitRead("string")}_int32(Zt){new DataView(this.buffer,this.offset).setInt32(0,Zt),this.offset+=4}int32(Zt){this.log("int32",Zt),this._int32(Zt),this.waitRead("int32")}bytes(Zt){this.log("bytes",Zt);let tr=Zt.byteLength;this._int32(tr),new Uint8Array(this.buffer,this.offset).set(new Uint8Array(Zt)),this.offset+=tr,this.waitRead("bytes")}}function Lt(er,Zt){return Math.round(er/Zt)}class Ut{constructor(Zt){this.filename=Zt}getStoreName(){return this.filename.replace(/\//g,"-")}invokeWorker(Zt,tr){if(this.reader==null||this.writer==null)throw new Error(`Attempted ${Zt} on ${this.filename} but file not open`);let nr=this.reader,ir=this.writer;switch(Zt){case"readBlocks":{let{name:sr,positions:_r,blockSize:ar}=tr,Or=[];for(let Sr of _r){ir.string("readBlock"),ir.string(sr),ir.int32(Lt(Sr,ar)),ir.finalize();let kr=nr.bytes();nr.done(),Or.push({pos:Sr,data:kr.byteLength===0?new ArrayBuffer(ar):kr})}return Or}case"writeBlocks":{let{name:sr,writes:_r,blockSize:ar}=tr;ir.string("writeBlocks"),ir.string(sr);for(let Sr of _r)ir.int32(Lt(Sr.pos,ar)),ir.bytes(Sr.data);ir.finalize();let Or=nr.int32();return nr.done(),Or}case"readMeta":{ir.string("readMeta"),ir.string(tr.name),ir.finalize();let sr=nr.int32(),_r=nr.int32();return nr.done(),sr===-1?null:{size:sr,blockSize:_r}}case"writeMeta":{let{name:sr,meta:_r}=tr;ir.string("writeMeta"),ir.string(sr),ir.int32(_r.size),ir.finalize();let ar=nr.int32();return nr.done(),ar}case"closeFile":{ir.string("closeFile"),ir.string(tr.name),ir.finalize();let sr=nr.int32();return nr.done(),sr}case"lockFile":{ir.string("lockFile"),ir.string(tr.name),ir.int32(tr.lockType),ir.finalize();let sr=nr.int32();return nr.done(),sr===0}case"unlockFile":{ir.string("unlockFile"),ir.string(tr.name),ir.int32(tr.lockType),ir.finalize();let sr=nr.int32();return nr.done(),sr===0}}}lock(Zt){return this.invokeWorker("lockFile",{name:this.getStoreName(),lockType:Zt})}unlock(Zt){return this.invokeWorker("unlockFile",{name:this.getStoreName(),lockType:Zt})}delete(){(this.reader||this.writer)&&this.close();let Zt=globalThis.indexedDB.deleteDatabase(this.getStoreName());Zt.onerror=()=>{console.warn(`Deleting ${this.filename} database failed`)},Zt.onsuccess=()=>{}}open(){let Zt=new SharedArrayBuffer(36864);this.writer=new $t(Zt,{name:"args (backend)",debug:!1});let tr=new SharedArrayBuffer(36864);var nr,ir;this.reader=new Dt(tr,{name:"results",debug:!1}),nr=this.reader,ir=this.writer,self.postMessage({type:"__absurd:spawn-idb-worker",argBuffer:ir.buffer,resultBuffer:nr.buffer}),self.addEventListener("message",sr=>{switch(sr.data.type){case"__perf-deets:start-profile":ir.string("profile-start"),ir.finalize(),nr.int32(),nr.done();break;case"__perf-deets:stop-profile":ir.string("profile-stop"),ir.finalize(),nr.int32(),nr.done()}})}close(){this.invokeWorker("closeFile",{name:this.getStoreName()}),this.reader=null,this.writer=null,this.worker=null}readMeta(){return this.invokeWorker("readMeta",{name:this.getStoreName()})}writeMeta(Zt){return this.invokeWorker("writeMeta",{name:this.getStoreName(),meta:Zt})}readBlocks(Zt,tr){return this.stats&&(this.stats.read+=Zt.length),this.invokeWorker("readBlocks",{name:this.getStoreName(),positions:Zt,blockSize:tr})}writeBlocks(Zt,tr){return this.stats&&(this.stats.writes+=Zt.length),this.invokeWorker("writeBlocks",{name:this.getStoreName(),writes:Zt,blockSize:tr})}}function qt(er,Zt){return Math.round(er/Zt)}function jt(er){return Er(this,null,function*(){return yield function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let Zt;return new Promise(tr=>{const nr=()=>indexedDB.databases().finally(tr);Zt=setInterval(nr,100),nr()}).finally(()=>clearInterval(Zt))}(),new Promise((Zt,tr)=>{let nr=globalThis.indexedDB.open(er,2);nr.onsuccess=ir=>{let sr=ir.target.result;sr.onversionchange=()=>{console.log("closing because version changed"),sr.close()},sr.onclose=()=>{},Zt(sr)},nr.onupgradeneeded=ir=>{let sr=ir.target.result;sr.objectStoreNames.contains("data")||sr.createObjectStore("data")},nr.onblocked=ir=>console.log("blocked",ir),nr.onerror=nr.onabort=ir=>tr(ir.target.error)})})}class Jt{constructor(Zt,tr){this.dbName=Zt,this._openDb=null,this.hasAlertedFailure=!1,this.onFallbackFailure=tr}getDb(){return Er(this,null,function*(){return this._openDb||(this._openDb=yield jt(this.dbName)),this._openDb})}closeDb(){this._openDb&&(this._openDb.close(),this._openDb=null)}readAll(){return Er(this,null,function*(){let Zt=yield this.getDb(this.dbName),tr=new Map,nr=Zt.transaction(["data"],"readonly").objectStore("data");return new Promise((ir,sr)=>{let _r=nr.openCursor(IDBKeyRange.lowerBound(-1));_r.onerror=sr,_r.onsuccess=ar=>{let Or=ar.target.result;Or?(tr.set(Or.key,Or.value),Or.continue()):ir(tr)}})})}write(Zt,tr,nr){return Er(this,null,function*(){let ir=(yield this.getDb(this.dbName)).transaction(["data"],"readwrite"),sr=ir.objectStore("data");yield new Promise((_r,ar)=>{let Or=sr.get(0);Or.onsuccess=Sr=>{if(nr&&!function(kr,Ir){if(kr!=null&&Ir!=null){let Cr=new Uint8Array(kr),Ur=new Uint8Array(Ir);for(let Wr=24;Wr<40;Wr++)if(Cr[Wr]!==Ur[Wr])return!1;return!0}return kr==null&&Ir==null}(Or.result,tr))return this.onFallbackFailure&&!this.hasAlertedFailure&&(this.hasAlertedFailure=!0,this.onFallbackFailure()),void ar(new Error("Fallback mode unable to write file changes"));for(let kr of Zt)sr.put(kr.value,kr.key);ir.onsuccess=()=>_r(),ir.onerror=()=>ar()},Or.onerror=ar})})}}class zt{constructor(Zt,tr){this.filename=Zt,this.dbName=this.filename.replace(/\//g,"-"),this.cachedFirstBlock=null,this.writeQueue=null,this.blocks=new Map,this.lockType=0,this.transferBlockOwnership=!1,this.persistance=new Jt(this.dbName,tr)}readIfFallback(){return Er(this,null,function*(){return this.transferBlockOwnership=!0,this.blocks=yield this.persistance.readAll(),this.readMeta()})}lock(Zt){return this.cachedFirstBlock=this.blocks.get(0),this.lockType=Zt,!0}unlock(Zt){return this.lockType>Nt&&Zt===Nt&&this.flush(),this.lockType=Zt,!0}delete(){let Zt=globalThis.indexedDB.deleteDatabase(this.dbName);Zt.onerror=()=>{console.warn(`Deleting ${this.filename} database failed`)},Zt.onsuccess=()=>{}}open(){this.writeQueue=[],this.lockType=0}close(){this.flush(),this.transferBlockOwnership?this.transferBlockOwnership=!1:this.blocks=new Map,this.persistance.closeDb()}readMeta(){let Zt=this.blocks.get(-1);if(Zt){let tr=this.blocks.get(0);return{size:Zt.size,blockSize:xt(new Uint8Array(tr))}}return null}writeMeta(Zt){this.blocks.set(-1,Zt),this.queueWrite(-1,Zt)}readBlocks(Zt,tr){let nr=[];for(let ir of Zt)nr.push({pos:ir,data:this.blocks.get(qt(ir,tr))});return nr}writeBlocks(Zt,tr){for(let nr of Zt){let ir=qt(nr.pos,tr);this.blocks.set(ir,nr.data),this.queueWrite(ir,nr.data)}this.lockType<=Nt&&this.flush()}queueWrite(Zt,tr){this.writeQueue.push({key:Zt,value:tr})}flush(){this.writeQueue.length>0&&(this.persistance.write(this.writeQueue,this.cachedFirstBlock,this.lockType>Nt),this.writeQueue=[]),this.cachedFirstBlock=null}}class Wt{constructor(Zt){this.onFallbackFailure=Zt}createFile(Zt){let tr;tr=typeof SharedArrayBuffer!="undefined"?new Ut(Zt):new zt(Zt,this.onFallbackFailure);let nr=new Tt(Zt,tr);return(ae.env.NODE_ENV!=="production"||ae.env.PERF_BUILD)&&(this._files==null&&(this._files=new Set),this._files.add(nr)),nr}startProfile(){for(let Zt of this._files)if(Zt.ops.writer){let tr=Zt.ops.writer,nr=Zt.ops.reader;tr.string("profile-start"),tr.finalize(),nr.int32(),nr.done()}}stopProfile(){for(let Zt of this._files)if(Zt.ops.writer){let tr=Zt.ops.writer,nr=Zt.ops.reader;tr.string("profile-stop"),tr.finalize(),nr.int32(),nr.done()}}}function Ht(er,Zt){if(Ct)return Ct;if(!er)throw new Error("must speciefic database file");return Ct=new Promise((tr,nr)=>{(function(sr,_r="/sql-wasm.wasm"){return Er(this,null,function*(){if(!Ft){Ft=yield Ot({locateFile:()=>_r});const Sr=new Rt(Ft.FS,new Wt);Ft.register_for_idb(Sr),Ft.FS.mkdir("/sql"),Ft.FS.mount(Sr,{},"/sql")}const ar=`/sql/${sr}`,Or=new Ft.Database(ar,{filename:!0});if(typeof SharedArrayBuffer=="undefined"){const Sr=Ft.FS.open(ar,"a+");yield Sr.node.contents.readIfFallback(),Ft.FS.close(Sr)}return Or.exec(`
    PRAGMA page_size=8192;
    PRAGMA journal_mode=MEMORY;
  `),Or})})(er,Zt).then(sr=>tr(sr)).catch(sr=>nr(sr))}),Ct}function Gt(er,Zt,tr=!1){return Er(this,null,function*(){try{const nr=function(ir,sr,_r,ar){return y(ir,sr),ir.exec(`
    SELECT * FROM 'chat_logs_${sr}' ORDER BY send_time ${ar?"ASC":"DESC"} LIMIT ${_r}
    `)}(yield Ht(),er,Zt,tr);return M(F(nr[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}function Yt(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=(JSON.parse(er)||[]).map(ir=>B(ir));if(tr.length===0)return M("");const nr=function(ir,sr){const _r=v.insert().into("local_conversations").setFieldsRows(sr).toString();return ir.exec(_r)}(Zt,tr);return M(nr)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}function Vt(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=v.insert().into("temp_cache_local_chat_logs").setFieldsRows(ir).toString();return nr.exec(sr)}(Zt,JSON.parse(er).map(nr=>B(nr)));return M(tr[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}self.$RefreshReg$=()=>{},self.$RefreshSig$=()=>()=>{};const Qt=new Map,Kt=self,Xt=new d({event:new class{constructor(er){c(this,"_currentEndpoint"),c(this,"_targetEndpoint"),c(this,"_events"),c(this,"_originOnmessage"),c(this,"_receiveMessage"),c(this,"onerror",null),c(this,"config"),c(this,"sendAdapter"),c(this,"receiveAdapter"),this._events={},this._currentEndpoint=er.currentEndpoint,this._targetEndpoint=er.targetEndpoint,this._originOnmessage=null,this.config=er.config,this.receiveAdapter=er.receiveAdapter,this.sendAdapter=er.sendAdapter;const Zt=tr=>{const nr=this.receiveAdapter?this.receiveAdapter(tr):tr.data;if(nr&&typeof nr.event=="string"){const ir=this._events[nr.event]||[];if(ir.length)return void ir.forEach(sr=>{sr(...nr.args||[])});this.onerror&&this.onerror(u(a({},l.METHOD_NOT_FOUND),{data:nr}))}};if(this._currentEndpoint.addEventListener)return"start"in this._currentEndpoint&&this._currentEndpoint.start&&this._currentEndpoint.start(),this._currentEndpoint.addEventListener("message",Zt,!1),void(this._receiveMessage=Zt);this._originOnmessage=this._currentEndpoint.onmessage,this._currentEndpoint.onmessage=tr=>{this._originOnmessage&&this._originOnmessage(tr),Zt(tr)},this._receiveMessage=this._currentEndpoint.onmessage}emit(er,...Zt){const tr={event:er,args:Zt},nr=this.sendAdapter?this.sendAdapter(tr,this._targetEndpoint):{data:tr},ir=nr.data||tr,sr=this.config?typeof this.config=="function"?this.config(ir,this._targetEndpoint)||{}:this.config||{}:{};Array.isArray(nr.transfer)&&nr.transfer.length&&(sr.transfer=nr.transfer),this._targetEndpoint.postMessage(ir,sr)}on(er,Zt){this._events[er]||(this._events[er]=[]),this._events[er].push(Zt)}off(er,Zt){if(!this._events[er])return;if(!Zt)return void(this._events[er]=[]);const tr=this._events[er]||[];this._events[er]=tr.filter(nr=>nr!==Zt)}destroy(){if(this._currentEndpoint.removeEventListener)this._currentEndpoint.removeEventListener("message",this._receiveMessage,!1);else try{this._currentEndpoint.onmessage=this._originOnmessage}catch(er){console.warn(er)}}}({currentEndpoint:Kt,targetEndpoint:Kt})});Xt.registerMethod("fileMapSet",(er,Zt)=>(Qt.set(er,Zt),M(er))),Xt.registerMethod("fileMapClear",()=>(Qt.clear(),M(""))),Xt.registerMethod("wasmOpen",er=>new Promise((Zt,tr)=>{const nr=Qt.get(er);nr?Zt(M(nr.size)):tr("file not found")})),Xt.registerMethod("wasmClose",er=>Er(this,null,function*(){return new Promise(Zt=>{Qt.delete(er),Zt(M(er))})})),Xt.registerMethod("wasmRead",(er,Zt,tr)=>{const nr=Qt.get(er);if(!nr)throw"file not found";const ir=nr.slice(Zt,Zt+tr);return new Promise((sr,_r)=>{const ar=new FileReader;ar.onload=()=>{sr(ar.result)},ar.onerror=()=>{_r(ar.error)},ar.readAsArrayBuffer(ir)})}),Xt.registerMethod("getUpload",function(er){return Er(this,null,function*(){try{const Zt=function(nr,ir){return nr.exec(`
        select * from local_uploads where part_hash = '${ir}'  limit 1;
    `)}(yield Ht(),er),tr=F(Zt[0],"CamelCase");if(tr.length===0)throw`no upload with partHash = ${er}`;return M(tr[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("insertUpload",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=v.insert().into("local_uploads").setFields(ir).toString();return nr.exec(sr)}(Zt,B(P(JSON.parse(er))));return M(tr)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("updateUpload",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=v.update().table("local_uploads").setFields(ir).where(`part_hash = '${ir.part_hash}'`).toString();return nr.exec(sr)}(Zt,B(P(JSON.parse(er))));return M(tr)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteUpload",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){const ir=v.delete().from("local_uploads").where(`part_hash = '${nr}'`).toString();return tr.exec(ir)}(yield Ht(),er);return M(Zt)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("setSqlWasmPath",function(er){Bt=er}),Xt.registerMethod("initDB",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht(`${Zt}${er}.sqlite`,Bt),nr=[],ir=function(lr){return lr.exec(`
        create table if not exists 'local_uploads' (
            'part_hash'   text,
            'upload_id'   varchar(1000),
            'upload_info'        varchar(2000),
            'expire_time' integer,
            'create_time' integer,
            PRIMARY KEY ('part_hash')
          )
      `)}(tr),sr=function(lr){return lr.exec(`
    create table if not exists 'local_stranger'
        (
            'user_id'             varchar(64),
            'name'                varchar(255),
            'face_url'            varchar(255),
            'create_time'         integer,
            'app_manger_level'    integer,
            'ex'                  varchar(1024),
            'attached_info'       varchar(1024),
            'global_recv_msg_opt' integer,
            PRIMARY KEY ('user_id')
        )
      `)}(tr),_r=function(lr){return lr.exec(`
      create table if not exists 'local_conversations' (
            'conversation_id' char(128),
            'conversation_type' integer,
            'user_id' char(64),
            'group_id' char(128),
            'show_name' varchar(255),
            'face_url' varchar(255),
            'recv_msg_opt' integer,
            'unread_count' integer,
            'group_at_type' integer,
            'latest_msg' varchar(1000),
            'latest_msg_send_time' integer,
            'draft_text' text,
            'draft_text_time' integer,
            'is_pinned' numeric,
            'burn_duration' integer,
            'is_private_chat' numeric,
            'is_not_in_group' numeric,
            'update_unread_count_time' integer,
            'attached_info' varchar(1024),
            'ex' varchar(1024),
            'max_seq' integer,
            'min_seq' integer,
            'has_read_seq' integer,
            'msg_destruct_time' integer default 604800,
            'is_msg_destruct' numeric default false,
            primary key ('conversation_id')
        )
    `)}(tr),ar=function(lr){return lr.exec(`
      create table if not exists 'local_users' (
            'user_id' varchar(64),
            'name' varchar(255),
            'face_url' varchar(255),
            'create_time' integer,
            'app_manger_level' integer,
            'ex' varchar(1024),
            'attached_info' varchar(1024),
            'global_recv_msg_opt' integer,
             primary key ('user_id')
        )
    `)}(tr),Or=function(lr){return lr.exec(`
      create table if not exists 'local_blacks' (
        'owner_user_id'     varchar(64),
        'block_user_id'     varchar(64),
        'nickname'         varchar(255),
        'face_url'         varchar(255),
        'gender'           INTEGER,
        'create_time'      INTEGER,
        'add_source'      INTEGER,
        'operator_user_id'   varchar(64),
        'ex'              varchar(1024),
        'attached_info'     varchar(1024),
        primary key  ('owner_user_id', 'block_user_id')
    ) 
      `)}(tr),Sr=function(lr){return lr.exec(`
      create table if not exists 'local_friends'
      (
          'owner_user_id'    varchar(64),
          'friend_user_id'   varchar(64),
          'remark'           varchar(255),
          'create_time'      INTEGER,
          'add_source'       INTEGER,
          'operator_user_id' varchar(64),
          'name'             varchar(255),
          'face_url'         varchar(255),
          'ex'               varchar(1024),
          'attached_info'    varchar(1024),
          'is_pinned'        numeric,
          primary key ('owner_user_id', 'friend_user_id')
      )       
      `)}(tr),kr=function(lr){return lr.exec(`
      create table if not exists 'local_groups'
      (
          'group_id'                 varchar(64) PRIMARY KEY,
          'name'                  TEXT,
          'notification'            varchar(255),
          'introduction'            varchar(255),
          'face_url'           varchar(255),
          'create_time'             INTEGER,
          'status'              INTEGER,
          'creator_user_id'      varchar(64),
          'group_type'              INTEGER,
          'owner_user_id'          varchar(64),
          'member_count'            INTEGER,
          'ex'                   varchar(1024),
          'attached_info'           varchar(1024),
          'need_verification'     INTEGER,
          'look_member_info'     INTEGER,
          'apply_member_friend'      INTEGER,
          'notification_update_time' INTEGER,
          'notification_user_id'   TEXT,
          'display_is_read'        numeric
      )  
      `)}(tr),Ir=function(lr){return lr.exec(`
    create table if not exists "local_group_requests" (
        "group_id" varchar(64),
        "group_name" text,
        "notification" varchar(255),
        "introduction" varchar(255),
        "face_url" varchar(255),
        "create_time" integer,
        "status" integer,
        "creator_user_id" varchar(64),
        "group_type" integer,
        "owner_user_id" varchar(64),
        "member_count" integer,
        "user_id" varchar(64),
        "nickname" varchar(255),
        "user_face_url" varchar(255),
        "gender" integer,
        "handle_result" integer,
        "req_msg" varchar(255),
        "handle_msg" varchar(255),
        "req_time" integer,
        "handle_user_id" varchar(64),
        "handle_time" integer,
        "ex" varchar(1024),
        "attached_info" varchar(1024),
        "join_source" integer,
        "inviter_user_id" text,
        PRIMARY KEY ("group_id", "user_id")
      );
      `)}(tr),Cr=function(lr){return lr.exec(`
      create table if not exists 'local_group_members' (
        'group_id' varchar(64),
        'user_id' varchar(64),
        'nickname' varchar(255),
        'user_group_face_url' varchar(255),
        'role_level' integer,
        'join_time' integer,
        'join_source' integer,
        'inviter_user_id' text,
        'mute_end_time' integer DEFAULT 0,
        'operator_user_id' varchar(64),
        'ex' varchar(1024),
        'attached_info' varchar(1024),
        PRIMARY KEY ('group_id', 'user_id')
    ) 
      `)}(tr),Ur=function(lr){return lr.exec(`
    create table if not exists "local_admin_group_requests" (
        "group_id" varchar(64),
        "group_name" text,
        "notification" varchar(255),
        "introduction" varchar(255),
        "face_url" varchar(255),
        "create_time" integer,
        "status" integer,
        "creator_user_id" varchar(64),
        "group_type" integer,
        "owner_user_id" varchar(64),
        "member_count" integer,
        "user_id" varchar(64),
        "nickname" varchar(255),
        "user_face_url" varchar(255),
        "gender" integer,
        "handle_result" integer,
        "req_msg" varchar(255),
        "handle_msg" varchar(255),
        "req_time" integer,
        "handle_user_id" varchar(64),
        "handle_time" integer,
        "ex" varchar(1024),
        "attached_info" varchar(1024),
        "join_source" integer,
        "inviter_user_id" text,
        PRIMARY KEY ("group_id", "user_id")
      );
      `)}(tr),Wr=function(lr){return lr.exec(`
      create table if not exists 'local_friend_requests'
      (
          'from_user_id'    varchar(64),
          'from_nickname'   varchar(255),
          'from_face_url'   varchar(255),
          'to_user_id'   varchar(64),
          'to_nickname'   varchar(255),
          'to_face_url'     varchar(255),
          'handle_result'    INTEGER,
          'req_msg'        varchar(255),
          'create_time'   INTEGER,
          'handler_user_id'  varchar(64),
          'handle_msg'    varchar(255),
          'handle_time'    INTEGER,
          'ex'           varchar(1024),
          'attached_info'   varchar(1024),
          primary key ('from_user_id', 'to_user_id')
      );  
      `)}(tr),Yr=function(lr){return lr.exec(`
      create table if not exists 'local_super_groups' (
            'group_id' varchar(64),
            'name' text,
            'notification' varchar(255),
            'introduction' varchar(255),
            'face_url' varchar(255),
            'create_time' integer,
            'status' integer,
            'creator_user_id' varchar(64),
            'group_type' integer,
            'owner_user_id' varchar(64),
            'member_count' integer,
            'ex' varchar(1024),
            'attached_info' varchar(1024),
            'need_verification' integer,
            'look_member_info' integer,
            'apply_member_friend' integer,
            'notification_update_time' integer,
            'notification_user_id' text,
        primary key ('group_id')
     )
    `)}(tr),Fr=function(lr){return lr.exec(`
    create table if not exists 'temp_cache_local_chat_logs' (
        'client_msg_id' char(64),
        'server_msg_id' char(64),
        'send_id' char(64),
        'recv_id' char(64),
        'sender_platform_id' integer,
        'sender_nick_name' varchar(255),
        'sender_face_url' varchar(255),
        'session_type' integer,
        'msg_from' integer,
        'content_type' integer,
        'content' varchar(1000),
        'is_read' numeric,
        'status' integer,
        'seq' integer DEFAULT 0,
        'send_time' integer,
        'create_time' integer,
        'attached_info' varchar(1024),
        'ex' varchar(1024),
        PRIMARY KEY ('client_msg_id')
      );
      `)}(tr),gr=function(lr){return lr.exec(`
    create table if not exists 'local_notification_seqs'
        (
            'conversation_id' char(128),
            'seq'             integer,
            PRIMARY KEY ('conversation_id')
        )
      `)}(tr),Ar=function(lr){return lr.exec(`
      create table if not exists 'local_sending_messages'
        (
            conversation_id varchar(128),
            client_msg_id   varchar(64),
            ex              varchar(1024),
            PRIMARY KEY ('conversation_id', 'client_msg_id')
        );
        `)}(tr),wr=function(lr){return lr.exec(`
      create table if not exists 'local_conversation_unread_messages' (
            'conversation_id' char(128),
            'client_msg_id' char(64),
            'send_time' integer,
            'ex' varchar(1024),
            primary key (
                'conversation_id',
                'client_msg_id'
            )
        );
    `)}(tr),mr=function(lr){return lr.exec(`
      create table if not exists 'local_app_sdk_version' (
        'version'         varchar(255),
        'installed'       numeric,
        primary key  ('version')
    ) 
      `)}(tr),fr=function(lr){return lr.exec(`
      create table if not exists 'local_sync_version' (
        'table_name'         varchar(255),
        'entity_id'         varchar(255),
        'version_id'         text,
        'version'         integer,
        'create_time'         integer,
        'id_list'         text,
        primary key  ('table_name','entity_id')
    ) 
      `)}(tr);return function(lr){(function(hr){try{hr.exec(`
        ALTER TABLE local_friends ADD COLUMN is_pinned numeric;
        `)}catch(vr){}})(lr),function(hr){try{hr.exec(`
        ALTER TABLE local_groups ADD COLUMN display_is_read numeric;
        `)}catch(vr){}}(lr),function(hr){try{hr.exec(`
        ALTER TABLE local_app_sdk_version ADD COLUMN installed numeric;
        `)}catch(vr){}}(lr)}(tr),nr.push(ir,sr,_r,ar,Yr,wr,Or,Sr,kr,Cr,Wr,Ir,Ur,Fr,gr,Ar,mr,fr),M(nr)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("close",function(){return Er(this,null,function*(){try{return yield function(){return Er(this,null,function*(){Ct&&((yield Ct).close(),Ct=void 0)})}(),M("")}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getMessage",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return y(nr,ir),nr.exec(`
    SELECT * FROM 'chat_logs_${ir}' WHERE client_msg_id = '${sr}' limit 1
    `)}(yield Ht(),er,Zt);return tr.length===0?M("",h.ErrorNoRecord,`no message with id ${Zt}`):M(F(tr[0],"CamelCase",["isRead","isReact","isExternalExtensions"])[0])}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getMultipleMessage",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
    SELECT * FROM 'chat_logs_${ir}' WHERE client_msg_id in (${sr.map(_r=>`'${_r}'`).join(",")}) order by send_time desc;
    `)}(yield Ht(),er,JSON.parse(Zt));return M(F(tr[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getSendingMessageList",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
    SELECT * FROM 'chat_logs_${nr}' WHERE status = 1;
    `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("updateMessageTimeAndStatus",function(er,Zt,tr,nr,ir){return Er(this,null,function*(){try{const sr=yield Ht(),_r=function(ar,Or,Sr,kr,Ir,Cr){return ar.exec(`
    UPDATE 'chat_logs_${Or}' SET server_msg_id = '${kr}', send_time = ${Ir}, status = ${Cr} WHERE client_msg_id = '${Sr}' and seq=0;
    `)}(sr,er,Zt,tr,nr,ir);if(sr.getRowsModified()===0)throw"updateMessageTimeAndStatus no record updated";return M(_r)}catch(sr){return console.error(sr),M(void 0,h.ErrorInit,JSON.stringify(sr))}})}),Xt.registerMethod("updateMessage",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=yield Ht(),ir=function(sr,_r,ar,Or){const Sr=v.update().table(`'chat_logs_${_r}'`).setFields(Or).where(`client_msg_id = '${ar}'`).toString();return sr.exec(Sr)}(nr,er,Zt,B(P(JSON.parse(tr))));if(nr.getRowsModified()===0)throw"updateMessage no record updated";return M(ir)}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("updateMessageBySeq",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=yield Ht(),ir=function(sr,_r,ar,Or){const Sr=v.update().table(`'chat_logs_${_r}'`).setFields(Or).where(`seq = '${ar}'`).toString();return sr.exec(Sr)}(nr,er,Zt,B(P(JSON.parse(tr))));if(nr.getRowsModified()===0)throw"updateMessageBySeq no record updated";return M(ir)}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("updateColumnsMessage",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=yield Ht(),ir=function(sr,_r,ar,Or){const Sr=v.update().table(`'chat_logs_${_r}'`).setFields(Or).where(`client_msg_id = '${ar}'`).toString();return sr.exec(Sr)}(nr,er,Zt,B(P(JSON.parse(tr))));if(nr.getRowsModified()===0)throw"updateMessage no record updated";return M(ir)}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("insertMessage",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht(),nr=function(ir,sr,_r){const ar=v.insert().into(`'chat_logs_${sr}'`).setFields(_r).toString();return ir.exec(ar)}(tr,er,B(JSON.parse(Zt)));return M(nr)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("batchInsertMessageList",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht(),nr=function(ir,sr,_r){y(ir,sr);const ar=v.insert().into(`'chat_logs_${sr}'`).setFieldsRows(_r).toString();return ir.exec(ar)}(tr,er,JSON.parse(Zt).map(ir=>B(ir)));return M(nr)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getMessageList",function(er,Zt,tr,nr=!1){return Er(this,null,function*(){if(tr<=0)return Gt(er,Zt,nr);try{const ir=function(sr,_r,ar,Or,Sr){return sr.exec(`
    SELECT * FROM 'chat_logs_${_r}' WHERE send_time ${Sr?">":"<"} ${Or} ORDER BY send_time ${Sr?"ASC":"DESC"} LIMIT ${ar}
    `)}(yield Ht(),er,Zt,tr,nr);return M(F(ir[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(ir){return console.error(ir),M(void 0,h.ErrorInit,JSON.stringify(ir))}})}),Xt.registerMethod("getMessageListNoTime",Gt),Xt.registerMethod("messageIfExists",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
      SELECT * FROM 'chat_logs_${ir}' WHERE client_msg_id = '${sr}';
      `)}(yield Ht(),er,Zt);return M(tr.length!==0)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("searchMessageByKeyword",function(er,Zt,tr,nr,ir,sr,_r,ar){return Er(this,null,function*(){try{const Or=function(Sr,kr,Ir,Cr,Ur,Wr,Yr,Fr,gr){const Ar=Yr||new Date().getTime();let wr="";const mr=Ir.map(lr=>`${lr}`).join(","),fr=Ur===0?"or ":"and ";return Cr.forEach((lr,hr)=>{hr==0&&(wr+="And ("),hr+1>=Cr.length?wr+="content like '%"+Cr[hr]+"%') ":wr+="content like '%"+Cr[hr]+"%' "+fr}),Sr.exec(`  
    SELECT * FROM 'chat_logs_${kr}' 
          WHERE send_time  between ${Wr} and ${Ar} 
          AND status <=3  
          And content_type IN (${mr}) 
          ${wr}
    ORDER BY send_time DESC LIMIT ${gr} OFFSET ${Fr};
    `)}(yield Ht(),er,JSON.parse(Zt),JSON.parse(tr),nr,ir,sr,_r,ar);return M(F(Or[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(Or){return console.error(Or),M(void 0,h.ErrorInit,JSON.stringify(Or))}})}),Xt.registerMethod("searchMessageByContentType",function(er,Zt,tr,nr,ir,sr){return Er(this,null,function*(){try{const _r=function(ar,Or,Sr,kr,Ir,Cr,Ur){const Wr=Sr.map(Fr=>`${Fr}`).join(","),Yr=Ir||new Date().getTime();return ar.exec(`  
    SELECT * FROM 'chat_logs_${Or}' 
          WHERE send_time between ${kr} and ${Yr} 
          AND status <=3 
          And content_type IN (${Wr}) 
    ORDER BY send_time DESC LIMIT ${Ur} OFFSET ${Cr};
    `)}(yield Ht(),er,JSON.parse(Zt),tr,nr,ir,sr);return M(F(_r[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(_r){return console.error(_r),M(void 0,h.ErrorInit,JSON.stringify(_r))}})}),Xt.registerMethod("searchMessageByContentTypeAndKeyword",function(er,Zt,tr,nr,ir,sr){return Er(this,null,function*(){try{const _r=function(ar,Or,Sr,kr,Ir,Cr,Ur){const Wr=Sr.map(Ar=>`${Ar}`).join(","),Yr=Ur||new Date().getTime();let Fr="";const gr=Ir===0?"or ":"and ";return kr.forEach((Ar,wr)=>{wr==0&&(Fr+="And ("),wr+1>=kr.length?Fr+="content like '%"+kr[wr]+"%') ":Fr+="content like '%"+kr[wr]+"%' "+gr}),ar.exec(`  
      SELECT * FROM 'chat_logs_${Or}' 
            WHERE send_time between ${Cr} and ${Yr} 
            AND status <=3 
            And content_type IN (${Wr}) 
            ${Fr}
      ORDER BY send_time DESC;
      `)}(yield Ht(),er,JSON.parse(Zt),JSON.parse(tr),nr,ir,sr);return M(F(_r[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(_r){return console.error(_r),M(void 0,h.ErrorInit,JSON.stringify(_r))}})}),Xt.registerMethod("updateMsgSenderFaceURLAndSenderNickname",function(er,Zt,tr,nr){return Er(this,null,function*(){try{return function(ir,sr,_r,ar,Or){y(ir,sr),ir.exec(`
      UPDATE 'chat_logs_${sr}' SET sender_face_url = '${ar}', sender_nick_name = '${Or}' WHERE send_id = '${_r}';
      `)}(yield Ht(),er,Zt,tr,nr),M("")}catch(ir){return console.error(ir),M(void 0,h.ErrorInit,JSON.stringify(ir))}})}),Xt.registerMethod("getAlreadyExistSeqList",function(er,Zt){return Er(this,null,function*(){var tr;try{const nr=function(ir,sr,_r){return ir.exec(`
    SELECT seq FROM 'chat_logs_${sr}' WHERE seq in (${_r.join(",")})
    `)}(yield Ht(),er,JSON.parse(Zt));return M((tr=F(nr[0],"CamelCase",["isRead","isReact","isExternalExtensions"]).map(ir=>ir.seq))!==null&&tr!==void 0?tr:[])}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("getMessageBySeq",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return y(nr,ir),nr.exec(`
    SELECT * FROM 'chat_logs_${ir}' WHERE seq = ${sr} limit 1;
    `)}(yield Ht(),er,Zt);return tr.length===0?M("",h.ErrorNoRecord,`no message with seq ${Zt}`):M(F(tr[0],"CamelCase",["isRead","isReact","isExternalExtensions"])[0])}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getMessagesByClientMsgIDs",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
    SELECT * FROM 'chat_logs_${ir}' WHERE client_msg_id in (${sr.map(_r=>`'${_r}'`).join(",")}) order by send_time desc;
    `)}(yield Ht(),er,JSON.parse(Zt));return tr.length===0?M("",h.ErrorNoRecord,`no message with clientMsgIDListStr ${Zt}`):M(F(tr[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getMessagesBySeqs",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return y(nr,ir),nr.exec(`
    SELECT * FROM 'chat_logs_${ir}' WHERE seq in (${sr.join(",")}) order by send_time desc;
    `)}(yield Ht(),er,JSON.parse(Zt));return M(F(tr[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getConversationNormalMsgSeq",function(er){return Er(this,null,function*(){var Zt,tr;try{const nr=function(ir,sr){return y(ir,sr),ir.exec(`
      SELECT seq FROM 'chat_logs_${sr}' order by seq desc limit 1;
      `)}(yield Ht(),er);return M((tr=(Zt=F(nr[0],"CamelCase")[0])===null||Zt===void 0?void 0:Zt.seq)!==null&&tr!==void 0?tr:0)}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("getConversationPeerNormalMsgSeq",function(er,Zt){return Er(this,null,function*(){var tr,nr;try{const ir=function(sr,_r,ar){return sr.exec(`
      SELECT seq FROM 'chat_logs_${_r}' where send_id != '${ar}' order by seq desc limit 1;
      `)}(yield Ht(),er,Zt);return M((nr=(tr=F(ir[0],"CamelCase")[0])===null||tr===void 0?void 0:tr.seq)!==null&&nr!==void 0?nr:0)}catch(ir){return console.error(ir),M(void 0,h.ErrorInit,JSON.stringify(ir))}})}),Xt.registerMethod("deleteConversationAllMessages",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`
      DELETE FROM 'chat_logs_${tr}' WHERE 1=1;
      `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("markDeleteConversationAllMessages",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`
      UPDATE 'chat_logs_${tr}' SET status = 2 WHERE (1=1) and (conversation_id = '${tr}')';
      `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getUnreadMessage",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
      SELECT * FROM 'chat_logs_${ir}' WHERE send_id != '${sr}' and is_read = 0;
      `)}(yield Ht(),er,Zt);return M(F(tr[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("markConversationMessageAsReadBySeqs",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=yield Ht();return function(ir,sr,_r,ar){y(ir,sr);const Or=_r.map(Sr=>`${Sr}`).join(",");ir.exec(`
      UPDATE 'chat_logs_${sr}' SET is_read = 1 WHERE seq IN (${Or}) and send_id != '${ar}';
      `)}(nr,er,JSON.parse(Zt),tr),M(nr.getRowsModified())}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("markConversationMessageAsRead",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=yield Ht();return function(ir,sr,_r,ar){const Or=_r.map(Sr=>`'${Sr}'`).join(",");ir.exec(`
      UPDATE 'chat_logs_${sr}' SET is_read = 1 WHERE client_msg_id IN (${Or}) and send_id != '${ar}';
      `)}(nr,er,JSON.parse(Zt),tr),M(nr.getRowsModified())}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("deleteConversationMsgs",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){const _r=sr.map(ar=>`'${ar}'`).join(",");return nr.exec(`
      DELETE FROM 'chat_logs_${ir}' WHERE client_msg_id IN (${_r});
      `)}(yield Ht(),er,JSON.parse(Zt));return M(tr)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("markConversationAllMessageAsRead",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht();return function(nr,ir,sr){nr.exec(`
      UPDATE 'chat_logs_${ir}' SET is_read = 1 WHERE is_read = 0 and send_id != '${sr}';
      `)}(tr,er,JSON.parse(Zt)),M(tr.getRowsModified())}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("searchAllMessageByContentType",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
      SELECT * FROM 'chat_logs_${ir}' WHERE content_type = ${sr};
      `)}(yield Ht(),er,JSON.parse(Zt));return M(F(tr[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("insertSendingMessage",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=v.insert().into("local_sending_messages").setFields(ir).toString();return nr.exec(sr)}(Zt,B(JSON.parse(er)));return M(tr)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteSendingMessage",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){const _r=v.delete().from("local_sending_messages").where(`conversation_id = '${ir}'`).where(`client_msg_id = '${sr}'`).toString();return nr.exec(_r)}(yield Ht(),er,Zt);return M(tr)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getAllSendingMessages",function(){return Er(this,null,function*(){try{const er=function(Zt){const tr=v.select().from("local_sending_messages").toString();return Zt.exec(tr)}(yield Ht());return M(F(er[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getLatestActiveMessage",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){y(nr,ir);const _r=sr?"ASC":"DESC";return nr.exec(`
      SELECT * FROM 'chat_logs_${ir}' WHERE status < 4 ORDER BY send_time ${_r};
    `)}(yield Ht(),er,Zt);return M(F(tr[0],"CamelCase",["isRead","isReact","isExternalExtensions"]))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getAllConversationList",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
        select * from local_conversations where latest_msg_send_time > 0 order by case when is_pinned=1 then 0 else 1 end,max(latest_msg_send_time,draft_text_time) desc;
    `)}(yield Ht());return M(F(er[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getAllConversationListToSync",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
        select * from local_conversations;
    `)}(yield Ht());return M(F(er[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getHiddenConversationList",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
        select * from local_conversations where latest_msg_send_time = 0;
    `)}(yield Ht());return M(F(er[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getConversation",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
        select * from local_conversations where conversation_id = '${nr}' limit 1;
    `)}(yield Ht(),er);return Zt.length===0?M("",h.ErrorNoRecord,`no conversation with id ${er}`):M(F(Zt[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"])[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getMultipleConversation",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=ir.map(_r=>`'${_r}'`);return nr.exec(`
        select * from local_conversations where conversation_id in (${sr.join(",")});
    `)}(Zt,JSON.parse(er));return M(F(tr[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("updateColumnsConversation",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht();let nr=Zt;typeof Zt=="string"&&(nr=B(P(JSON.parse(Zt))));const ir=function(sr,_r,ar){const Or=v.update().table("local_conversations").setFields(ar).where(`conversation_id = '${_r}'`).toString();return sr.exec(Or)}(tr,er,nr);if(tr.getRowsModified()===0)throw"updateColumnsConversation no record updated";return M(ir)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("decrConversationUnreadCount",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){nr.exec("begin"),nr.exec(`
        update local_conversations set 
            unread_count=unread_count-${sr} 
        where conversation_id = '${ir}';
    `);const _r=nr.exec(`select unread_count from local_conversations where conversation_id = '${ir}'`);return Number(_r[0].values[0])<0&&nr.exec(`
          update local_conversations set 
              unread_count=0 
          where conversation_id = '${ir}';
      `),nr.exec("commit")}(yield Ht(),er,Zt);return M(tr)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("batchInsertConversationList",Yt),Xt.registerMethod("getTotalUnreadMsgCount",function(){return Er(this,null,function*(){var er,Zt,tr;try{const nr=function(ir){return ir.exec(`
        select sum(unread_count) from local_conversations where recv_msg_opt < 2 and latest_msg_send_time > 0;
    `)}(yield Ht());return M((tr=(Zt=(er=nr[0])===null||er===void 0?void 0:er.values[0])===null||Zt===void 0?void 0:Zt[0])!==null&&tr!==void 0?tr:0)}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("insertConversation",function(er){return Er(this,null,function*(){return Yt(`[${er}]`)})}),Xt.registerMethod("getConversationByUserID",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
        select * from local_conversations where user_id = "${nr}" limit 1;
    `)}(yield Ht(),er);return Zt.length===0?M("",h.ErrorNoRecord,`no conversation with userID ${er}`):M(F(Zt[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"])[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getConversationListSplit",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
    SELECT *
    FROM local_conversations
    WHERE latest_msg_send_time > 0
    ORDER BY case
                 when is_pinned = 1 then 0
                 else 1 end, max(latest_msg_send_time, draft_text_time) DESC
    LIMIT ${sr} OFFSET ${ir}
    `)}(yield Ht(),er,Zt);return M(F(tr[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("deleteConversation",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`
    DELETE
      FROM local_conversations
      WHERE conversation_id = "${tr}"
  `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteAllConversation",function(){return Er(this,null,function*(){try{return function(er){er.exec(`
    DELETE FROM local_conversations;
  `)}(yield Ht()),M("")}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("batchUpdateConversationList",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=(JSON.parse(er)||[]).map(nr=>B(nr));return tr.length===0||tr.forEach(nr=>{(function(ir,sr){const _r=v.update().table("local_conversations").setFields(sr).where(`conversation_id = '${sr.conversation_id}'`).toString();ir.exec(_r)})(Zt,nr)}),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("conversationIfExists",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
  SELECT count(*)
  FROM local_conversations
  WHERE conversation_id = "${nr}"
  `)}(yield Ht(),er);return M(Zt.length!==0)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("resetConversation",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`
  UPDATE local_conversations
    SET unread_count=0,
    latest_msg="",
    latest_msg_send_time=0,
    draft_text="",
    draft_text_time=0
WHERE conversation_id = "${tr}"
  `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("resetAllConversation",function(){return Er(this,null,function*(){try{return function(er){er.exec(`
  UPDATE local_conversations
    SET unread_count=0,
    latest_msg="",
    latest_msg_send_time=0,
    draft_text="",
    draft_text_time=0
  `)}(yield Ht()),M("")}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("clearConversation",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`
  UPDATE local_conversations
SET unread_count=0,
    latest_msg="",
    draft_text="",
    draft_text_time=0
WHERE conversation_id = "${tr}"
  `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("clearAllConversation",function(){return Er(this,null,function*(){try{return function(er){er.exec(`
  UPDATE local_conversations
SET unread_count=0,
    latest_msg="",
    draft_text="",
    draft_text_time=0
  `)}(yield Ht()),M("")}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("setConversationDraft",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){const sr=new Date().getTime();tr.exec(`
  update local_conversations
    set draft_text='${ir}',
    draft_text_time=${sr},
    latest_msg_send_time=case when latest_msg_send_time = 0 then ${sr} else latest_msg_send_time end
    where conversation_id = "${nr}"
  `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("removeConversationDraft",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
  update local_conversations
    set draft_text="${ir}",
    draft_text_time=0
    where conversation_id = "${nr}"
  `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("unPinConversation",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
  update local_conversations
    set is_pinned=${ir},
    draft_text_time=case when draft_text = "" then 0 else draft_text_time end
    where conversation_id = "${nr}"
  `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("incrConversationUnreadCount",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
        update local_conversations set 
            unread_count=unread_count+1 
        where conversation_id = '${nr}';
    `)}(yield Ht(),er);return M(Zt)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("setMultipleConversationRecvMsgOpt",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){const sr=nr.map(_r=>`'${_r}'`).join(",");tr.exec(`
    UPDATE local_conversations
    SET recv_msg_opt=${ir}
    WHERE conversation_id IN (${sr})
    `)}(yield Ht(),JSON.parse(er),Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("findAllUnreadConversationConversationID",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
        select conversation_id from local_conversations where unread_count > 0;
    `)}(yield Ht());return M(F(er[0],"CamelCase").map(Zt=>Zt.conversationID))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getAllSingleConversationIDList",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
        select conversation_id from local_conversations where conversation_type = 1;
    `)}(yield Ht());return M(F(er[0],"CamelCase").map(Zt=>Zt.conversationID))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getAllConversationIDList",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
        select conversation_id from local_conversations;
    `)}(yield Ht());return M(F(er[0],"CamelCase").map(Zt=>Zt.conversationID))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getAllConversations",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
    SELECT * FROM local_conversations
    `)}(yield Ht());return M(F(er[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("searchConversations",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
    SELECT * FROM local_conversations
    WHERE show_name LIKE '%${nr}%'
    ORDER BY latest_msg_send_time DESC
    `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase",["isPinned","isPrivateChat","isNotInGroup","isMsgDestruct"]))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getLoginUser",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
        select *, name as nickname from local_users where user_id = '${nr}'  limit 1;
    `)}(yield Ht(),er);return Zt.length===0?M("",h.ErrorNoRecord,`no login user with id ${er}`):M(F(Zt[0],"CamelCase",[],{name:"nickname"})[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("insertLoginUser",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=v.insert().into("local_users").setFields(ir).toString();return nr.exec(sr)}(Zt,B(P(JSON.parse(er),{nickname:"name"})));return M(tr)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("updateLoginUser",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=v.update().table("local_users").setFields(ir).where(`user_id = '${ir.user_id}'`).toString();return nr.exec(sr)}(Zt,B(P(JSON.parse(er),{nickname:"name"})));if(Zt.getRowsModified()===0)throw"updateLoginUser no record updated";return M(tr)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getStrangerInfo",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return M(F(k(Zt,JSON.parse(er))[0],"CamelCase",[],{name:"nickname"}))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("setStrangerInfo",function(er){try{return JSON.parse(er).map(Zt=>B(P(Zt,{nickname:"name"}))).map(Zt=>function(tr){return Er(this,null,function*(){try{const nr=yield Ht(),ir=k(nr,[tr.user_id]);return F(ir[0]).length?function(sr,_r){const ar=v.update().table("local_stranger").setFields(_r).where(`user_id = '${_r.user_id}'`).toString();sr.exec(ar)}(nr,tr):function(sr,_r){const ar=v.insert().into("local_stranger").setFields(_r).toString();sr.exec(ar)}(nr,tr),M("")}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}(Zt)),Promise.resolve(M(""))}catch(Zt){return console.error(Zt),Promise.resolve(M(void 0,h.ErrorInit,JSON.stringify(Zt)))}}),Xt.registerMethod("getAppSDKVersion",function(){return Er(this,null,function*(){try{const er=R(yield Ht());return er.length===0?M("",h.ErrorNoRecord,"no app version with database"):M(F(er[0],"CamelCase",["installed"])[0])}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("setAppSDKVersion",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=B(P(JSON.parse(er))),nr=F(R(Zt)[0],"CamelCase",["installed"]);return nr[0]&&nr[0].version?(function(ir,sr,_r){const ar=v.update().table("local_app_sdk_version").setFields(_r).where(`version = '${sr}'`).toString();ir.exec(ar)}(Zt,nr[0].version,tr),M("")):(function(ir,sr){const _r=v.insert().into("local_app_sdk_version").setFields(sr).toString();ir.exec(_r)}(Zt,tr),M(""))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getVersionSync",function(er,Zt){return Er(this,null,function*(){try{const tr=N(yield Ht(),er,Zt);if(tr.length===0)return M("",h.ErrorNoRecord,`no sync version with tableName ${er}, entityID ${Zt}`);const nr=F(tr[0],"CamelCase",[],{id_list:"uidList"})[0];return nr.uidList=JSON.parse(nr.uidList),M(nr)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("setVersionSync",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=B(P(JSON.parse(er)));tr.id_list=JSON.stringify(tr.uid_list),delete tr.uid_list;const nr=F(N(Zt,tr.table_name,tr.entity_id)[0],"CamelCase",[]);return nr[0]&&nr[0].tableName?(function(ir,sr,_r,ar){delete ar.table;const Or=v.update().table("local_sync_version").setFields(ar).where(`table_name = '${sr}' AND entity_id = '${_r}'`).toString();ir.exec(Or)}(Zt,nr[0].tableName,nr[0].entityID,tr),M("")):(function(ir,sr){delete sr.table;const _r=v.insert().into("local_sync_version").setFields(sr).toString();ir.exec(_r)}(Zt,tr),M(""))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteVersionSync",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
    DELETE FROM local_sync_version WHERE table_name = "${nr}" AND entity_id = "${ir}";
    `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getJoinedSuperGroupList",function(){return Er(this,null,function*(){try{const er=yield Ht();return M(F(b(er)[0]))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getJoinedSuperGroupIDList",function(){return Er(this,null,function*(){try{const er=yield Ht(),Zt=F(b(er)[0]);return M(Zt.map(tr=>tr.groupID))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getSuperGroupInfoByGroupID",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
        select * from local_super_groups where group_id = '${nr}'  LIMIT 1;
    `)}(yield Ht(),er);return Zt.length===0?M("",h.ErrorNoRecord,`no super group with id ${er}`):M(F(Zt[0])[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteSuperGroup",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
        delete from local_super_groups where group_id = '${nr}';
    `)}(yield Ht(),er);return M(Zt)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("insertSuperGroup",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=v.insert().into("local_super_groups").setFields(ir).toString();return nr.exec(sr)}(Zt,B(P(JSON.parse(er),{groupName:"name"})));return M(tr)}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("updateSuperGroup",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht(),nr=function(ir,sr,_r){const ar=v.update().table("local_super_groups").setFields(_r).where(`group_id = '${sr}'`).toString();return ir.exec(ar)}(tr,er,B(P(JSON.parse(Zt),{groupName:"name"})));if(tr.getRowsModified()===0)throw"updateSuperGroup no record updated";return M(nr)}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("deleteConversationUnreadMessageList",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht();return function(nr,ir,sr){nr.exec(`
        delete from local_conversation_unread_messages where conversation_id = '${ir}' and send_time <= ${sr};
    `)}(tr,er,Zt),M(tr.getRowsModified())}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("batchInsertConversationUnreadMessageList",function(er){return Er(this,null,function*(){try{const Zt=yield Ht(),tr=function(nr,ir){const sr=v.insert().into("local_conversation_unread_messages").setFieldsRows(ir).toString();return nr.exec(sr)}(Zt,JSON.parse(er).map(nr=>B(nr)));return M(tr[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getBlackList",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
      select *
      from local_blacks
      `)}(yield Ht());return M(F(er[0],"CamelCase",[],{block_user_id:"userID"}))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getBlackListUserID",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
    SELECT block_user_id
    FROM local_blacks
      `)}(yield Ht());return M(F(er[0],"CamelCase"))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getBlackInfoByBlockUserID",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
      SELECT *
        FROM local_blacks
        WHERE owner_user_id = "${sr}"
          AND block_user_id = "${ir}"
        LIMIT 1
      `)}(yield Ht(),er,Zt);return M(F(tr[0],"CamelCase"))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getBlackInfoList",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){const ir=nr.map(sr=>`'${sr}'`);return tr.exec(`
    select *
    from local_blacks
    where block_user_id in (${ir.join(",")})
      `)}(yield Ht(),JSON.parse(er));return M(F(Zt[0],"CamelCase"))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("insertBlack",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.insert().into("local_blacks").setFields(nr).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er),{userID:"block_user_id",name:"nickname"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteBlack",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
    delete
    from local_blacks
    where owner_user_id = "${ir}"
    and block_user_id = "${nr}"
      `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("updateBlack",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.update().table("local_blacks").setFields(nr).where(`owner_user_id = '${nr.owner_user_id}' and block_user_id = '${nr.block_user_id}'`).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er)))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("insertFriendRequest",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.insert().into("local_friend_requests").setFields(nr).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er)))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteFriendRequestBothUserID",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
      delete
      from local_friend_requests
      where from_user_id = "${nr}"
        and to_user_id = "${ir}"
      `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("updateFriendRequest",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.update().table("local_friend_requests").setFields(nr).where(`from_user_id = '${nr.from_user_id}' and to_user_id = '${nr.to_user_id}'`).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er)))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getRecvFriendApplication",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
      select *
      from local_friend_requests
      where to_user_id = "${nr}"
      order by create_time desc
      `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase"))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getSendFriendApplication",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
      select * from local_friend_requests
      where from_user_id = "${nr}"
      order by create_time desc
      `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase"))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getFriendApplicationByBothID",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
      select *
        from local_friend_requests
        where from_user_id = "${ir}"
        and to_user_id = "${sr}"
        limit 1
      `)}(yield Ht(),er,Zt);return M(F(tr[0],"CamelCase"))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getBothFriendReq",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
      select *
        from local_friend_requests
        where (from_user_id = "${ir}"
        and to_user_id = "${sr}")
        or (from_user_id = "${sr}"
        and to_user_id = "${ir}")
      `)}(yield Ht(),er,Zt);return M(F(tr[0],"CamelCase"))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("insertGroup",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return E(Zt,B(P(JSON.parse(er),{groupName:"name"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteGroup",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`
    DELETE FROM local_groups 
          WHERE group_id="${tr}" 
        `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("updateGroup",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht();return function(nr,ir,sr){const _r=v.update().table("local_groups").setFields(sr).where(`group_id = '${ir}'`).toString();nr.exec(_r)}(tr,er,B(P(JSON.parse(Zt),{groupName:"name"}))),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getJoinedGroupList",function(){return Er(this,null,function*(){try{const er=yield Ht();return M(F(O(er)[0],"CamelCase",["displayIsRead"],{name:"groupName"}))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getGroupInfoByGroupID",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
    SELECT *
      FROM local_groups
      WHERE group_id = "${nr}"
    `)}(yield Ht(),er);return Zt.length===0?M("",h.ErrorNoRecord,`no group with id ${er}`):M(F(Zt[0],"CamelCase",["displayIsRead"],{name:"groupName"})[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getAllGroupInfoByGroupIDOrGroupName",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=function(ir,sr,_r,ar){let Or="";const Sr=`group_id like "%${sr}%"`,kr=`name like "%${sr}%"`;return _r&&(Or=Sr),ar&&(Or=kr),ar&&_r&&(Or=Sr+" or "+kr),ir.exec(`
    select *
    from local_groups
    where ${Or}
    order by create_time desc
    `)}(yield Ht(),er,Zt,tr);return M(F(nr[0],"CamelCase",["displayIsRead"],{name:"groupName"}))}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("subtractMemberCount",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`  
    update local_groups set member_count = member_count-1 where group_id = '${tr}'
    `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("addMemberCount",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`  
    update local_groups set member_count = member_count+1 where group_id = '${tr}'   
    `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getJoinedWorkingGroupIDList",function(){return Er(this,null,function*(){try{const er=yield Ht(),Zt=F(O(er)[0],"CamelCase",["displayIsRead"]),tr=[];return Zt.forEach(nr=>{nr.groupType===2&&tr.push(nr.groupID)}),M(JSON.stringify(tr))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getJoinedWorkingGroupList",function(){return Er(this,null,function*(){try{const er=O(yield Ht()),Zt=F(er[0],"CamelCase",["displayIsRead"],{name:"groupName"}).filter(tr=>tr.groupType===2);return M(JSON.stringify(Zt))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getGroupMemberAllGroupIDs",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
    select distinct group_id from local_group_members
    `)}(yield Ht());return M(F(er[0],"CamelCase",["displayIsRead"]).map(Zt=>Zt.groupID))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getGroups",function(er){return Er(this,null,function*(){try{const Zt=function(nr,ir){const sr=ir.map(_r=>`'${_r}'`).join(",");return nr.exec(`
    select * from local_groups where group_id in (${sr});
    `)}(yield Ht(),JSON.parse(er)),tr=F(Zt[0],"CamelCase",["displayIsRead"],{name:"groupName"});return M(JSON.stringify(tr))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("batchInsertGroup",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return JSON.parse(er).map(tr=>{const nr=B(P(tr,{groupName:"name"}));return E(Zt,nr),null}),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteAllGroup",function(){return Er(this,null,function*(){try{return function(er){er.exec(`
    DELETE FROM local_groups;
    `)}(yield Ht()),M("")}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getGroupMemberInfoByGroupIDUserID",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
      select *
      from local_group_members
      WHERE group_id = "${ir}" 
      AND user_id = "${sr}" 
      LIMIT 1
      `)}(yield Ht(),er,Zt);return M(F(tr[0],"CamelCase",[],{user_group_face_url:"faceURL"})[0])}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getAllGroupMemberList",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
    SELECT *
    FROM local_group_members
      `)}(yield Ht());return M(F(er[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getAllGroupMemberUserIDList",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
      SELECT user_id
      FROM local_group_members
        `)}(yield Ht());return M(F(er[0],"CamelCase"))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("getGroupMemberCount",function(er){return Er(this,null,function*(){var Zt,tr;try{const nr=function(ir,sr){return ir.exec(`
    SELECT count(*) FROM local_group_members 
    WHERE group_id = "${sr}" 
      `)}(yield Ht(),er);return M((tr=(Zt=nr[0])===null||Zt===void 0?void 0:Zt.values[0])===null||tr===void 0?void 0:tr[0])}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("getGroupSomeMemberInfo",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){const _r=sr.map(ar=>`'${ar}'`);return nr.exec(`
    select *
    from local_group_members
    where group_id = "${ir}"
    and user_id in (${_r.join(",")})
      `)}(yield Ht(),er,JSON.parse(Zt));return M(F(tr[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getGroupAdminID",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
    SELECT user_id FROM local_group_members 
    WHERE group_id = "${nr}" 
    And role_level = 3
      `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase").map(tr=>tr.userID))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getGroupMemberListByGroupID",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
      SELECT * FROM local_group_members 
      WHERE group_id = "${nr}" 
        `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getGroupMemberListSplit",function(er,Zt,tr,nr,ir){return Er(this,null,function*(){try{const sr=function(_r,ar,Or,Sr,kr,Ir){let Cr=`
    SELECT * FROM local_group_members 
        WHERE group_id = "${ar}" 
        ORDER BY role_level DESC,join_time ASC 
    LIMIT ${kr} OFFSET ${Sr}
    `;return Or===1&&(Cr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${ar}" 
            And role_level = 100 
        LIMIT ${kr} OFFSET ${Sr}
        `),Or===2&&(Cr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${ar}" 
            And role_level = 60 
        ORDER BY join_time ASC 
        LIMIT ${kr} OFFSET ${Sr}
        `),Or===3&&(Cr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${ar}" 
            And role_level = 20 
        ORDER BY join_time ASC 
        LIMIT ${kr} OFFSET ${Sr}
        `),Or===4&&(Cr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${ar}" 
            And ( role_level = 20 OR role_level = 60 )  
        ORDER BY role_level DESC,join_time ASC 
        LIMIT ${kr} OFFSET ${Sr}
        `),Or===5&&(Cr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${ar}" 
            And ( role_level = 100 OR role_level = 60 )  
        ORDER BY role_level DESC,join_time ASC 
        LIMIT ${kr} OFFSET ${Sr}
        `),Or===6&&(Cr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${ar}" 
            And user_id != "${Ir}" 
        LIMIT ${kr} OFFSET ${Sr}
        `),_r.exec(Cr)}(yield Ht(),er,Zt,tr,nr,ir);return M(F(sr[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(sr){return console.error(sr),M(void 0,h.ErrorInit,JSON.stringify(sr))}})}),Xt.registerMethod("getGroupMemberOwnerAndAdmin",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
      SELECT * FROM local_group_members 
      WHERE group_id = "${nr}" 
      And role_level > 1 
      ORDER BY role_level DESC
        `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getGroupMemberOwner",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
      SELECT * FROM local_group_members 
      WHERE group_id = "${nr}" 
      And role_level = 2
        `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase",[],{user_group_face_url:"faceURL"})[0])}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getGroupMemberListSplitByJoinTimeFilter",function(er,Zt,tr,nr=0,ir=1e11,sr){return Er(this,null,function*(){try{const _r=function(ar,Or,Sr,kr,Ir=0,Cr=1e11,Ur){let Wr="";return Wr=Ur.length===0?`
        SELECT * FROM local_group_members 
            WHERE group_id = "${Or}" 
            And join_time  between ${Ir} and ${Cr}  
            ORDER BY join_time DESC 
            LIMIT ${kr} OFFSET ${Sr}
        `:`
        SELECT * FROM local_group_members 
        WHERE group_id = "${Or}" 
        And join_time  between ${Ir} and ${Cr}  
        And user_id NOT IN (${Ur.map(Yr=>`'${Yr}'`).join(",")})
        ORDER BY join_time DESC 
        LIMIT ${kr} OFFSET ${Sr}
        `,ar.exec(Wr)}(yield Ht(),er,Zt,tr,nr,ir,JSON.parse(sr));return M(F(_r[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(_r){return console.error(_r),M(void 0,h.ErrorInit,JSON.stringify(_r))}})}),Xt.registerMethod("getGroupOwnerAndAdminByGroupID",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
      SELECT * FROM local_group_members 
      WHERE group_id = "${nr}" 
      And role_level > 1
        `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getGroupMemberUIDListByGroupID",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
      SELECT user_id FROM local_group_members 
      WHERE group_id = "${nr}" 
        `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase").map(tr=>tr.userID))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("insertGroupMember",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.insert().into("local_group_members").setFields(nr).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er),{faceURL:"user_group_face_url"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("batchInsertGroupMember",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.insert().into("local_group_members").setFieldsRows(nr).toString();tr.exec(ir)}(Zt,(JSON.parse(er)||[]).map(tr=>B(P(tr,{faceURL:"user_group_face_url"})))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteGroupMember",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
    DELETE FROM local_group_members 
    WHERE group_id="${nr}" 
    and user_id="${ir}"
      `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("deleteGroupAllMembers",function(er){return Er(this,null,function*(){try{return function(Zt,tr){Zt.exec(`
      DELETE FROM local_group_members 
      WHERE group_id="${tr}"
        `)}(yield Ht(),er),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("updateGroupMember",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.update().table("local_group_members").setFields(nr).where(`group_id = '${nr.group_id}' and user_id = '${nr.user_id}'`).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er),{faceURL:"user_group_face_url"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("updateGroupMemberField",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=yield Ht();return function(ir,sr,_r,ar){const Or=v.update().table("local_group_members").setFields(ar).where(`group_id = '${sr}' and user_id = '${_r}'`).toString();ir.exec(Or)}(nr,er,Zt,B(P(JSON.parse(tr),{faceURL:"user_group_face_url"}))),M("")}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("searchGroupMembers",function(er,Zt,tr,nr,ir,sr){return Er(this,null,function*(){try{const _r=function(ar,Or,Sr,kr,Ir,Cr,Ur){let Wr="";return Wr=Sr?kr&&Ir?`
            SELECT * FROM local_group_members 
            WHERE ( user_id like "%${Or}%" or nickname like "%${Or}%"  ) 
            and group_id IN ("${Sr}")  
            ORDER BY join_time DESC 
            LIMIT ${Ur} OFFSET ${Cr}
            `:kr||Ir?`
            SELECT * FROM local_group_members 
            WHERE ${kr?`nickname like "%${Or}%"`:`user_id like "%${Or}%"`}
            and group_id IN ("${Sr}")  
            ORDER BY join_time DESC 
            LIMIT ${Ur} OFFSET ${Cr}
            `:`
        SELECT * FROM local_group_members 
        WHERE group_id IN ("${Sr}")  
        ORDER BY join_time DESC 
        LIMIT ${Ur} OFFSET ${Cr}
        `:kr&&kr?`
        SELECT * FROM local_group_members 
        WHERE user_id like "%${Or}%" or nickname like "%${Or}%"  
        ORDER BY join_time DESC 
        LIMIT ${Ur} OFFSET ${Cr}
        `:kr||kr?`
        SELECT * FROM local_group_members 
        WHERE ${kr?`nickname like "%${Or}%"`:`user_id like "%${Or}%"`}  
        ORDER BY join_time DESC 
        LIMIT ${Ur} OFFSET ${Cr}
        `:`
        SELECT * FROM local_group_members 
        ORDER BY join_time DESC 
        LIMIT ${Ur} OFFSET ${Cr}
        `,ar.exec(Wr)}(yield Ht(),er,Zt,tr,nr,ir,sr);return M(F(_r[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(_r){return console.error(_r),M(void 0,h.ErrorInit,JSON.stringify(_r))}})}),Xt.registerMethod("getUserJoinedGroupIDs",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
    select group_id from local_group_members where user_id = "${nr}";
    `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase").map(tr=>tr.groupID))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getGroupMemberListByUserIDs",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=function(ir,sr,_r,ar){const Or=ar.map(kr=>`'${kr}'`);let Sr=`
    SELECT * FROM local_group_members 
        WHERE group_id = "${sr}" 
        And user_id IN (${Or.join(",")})
        ORDER BY role_level DESC,join_time ASC 
    `;return _r===1&&(Sr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${sr}" 
            And role_level = 100 
            And user_id IN (${Or.join(",")})
        `),_r===2&&(Sr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${sr}" 
            And role_level = 60 
            And user_id IN (${Or.join(",")})
        ORDER BY join_time ASC 
        `),_r===3&&(Sr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${sr}" 
            And role_level = 20 
            And user_id IN (${Or.join(",")})
        ORDER BY join_time ASC 
        `),_r===4&&(Sr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${sr}" 
            And ( role_level = 20 OR role_level = 60 )  
            And user_id IN (${Or.join(",")})
        ORDER BY role_level DESC,join_time ASC 
        `),_r===5&&(Sr=`
        SELECT * FROM local_group_members 
            WHERE group_id = "${sr}" 
            And ( role_level = 100 OR role_level = 60 )  
            And user_id IN (${Or.join(",")})
        ORDER BY role_level DESC,join_time ASC 
        `),ir.exec(Sr)}(yield Ht(),er,Zt,JSON.parse(tr));return M(F(nr[0],"CamelCase",[],{user_group_face_url:"faceURL"}))}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("insertGroupRequest",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.insert().into("local_group_requests").setFields(nr).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er),{groupFaceURL:"face_url",userFaceURL:"user_face_url",handledMsg:"handle_msg",handledTime:"handle_time"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteGroupRequest",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
        delete
        from local_group_requests
        where group_id = "${nr}"
          and user_id = "${ir}"
        `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("updateGroupRequest",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.update().table("local_group_requests").setFields(nr).where(`group_id = '${nr.group_id}' and user_id = '${nr.user_id}'`).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er),{groupFaceURL:"face_url",userFaceURL:"user_face_url",handledMsg:"handle_msg",handledTime:"handle_time"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getSendGroupApplication",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
        select *
        from local_group_requests
        order by create_time desc
        `)}(yield Ht());return M(F(er[0],"CamelCase",[],{face_url:"groupFaceURL",user_face_url:"userFaceURL",handle_msg:"handledMsg",handle_time:"handledTime"}))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("insertAdminGroupRequest",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.insert().into("local_admin_group_requests").setFields(nr).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er),{groupFaceURL:"face_url",userFaceURL:"user_face_url",handledMsg:"handle_msg",handledTime:"handle_time"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteAdminGroupRequest",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
        delete
        from local_admin_group_requests
        where group_id = "${nr}"
          and user_id = "${ir}"
        `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("updateAdminGroupRequest",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.update().table("local_admin_group_requests").setFields(nr).where(`group_id = '${nr.group_id}' and user_id = '${nr.user_id}'`).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er),{groupFaceURL:"face_url",userFaceURL:"user_face_url",handledMsg:"handle_msg",handledTime:"handle_time"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getAdminGroupApplication",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
        select *
        from local_admin_group_requests
        order by create_time desc
        `)}(yield Ht());return M(F(er[0],"CamelCase",[],{face_url:"groupFaceURL",user_face_url:"userFaceURL",handle_msg:"handledMsg",handle_time:"handledTime"}))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("insertFriend",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return w(Zt,B(P(JSON.parse(er),{userID:"friend_user_id",nickname:"name"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteFriend",function(er,Zt){return Er(this,null,function*(){try{return function(tr,nr,ir){tr.exec(`
    DELETE FROM local_friends 
          WHERE owner_user_id="${ir}" 
          and friend_user_id="${nr}"
        `)}(yield Ht(),er,Zt),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("updateFriend",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return function(tr,nr){const ir=v.update().table("local_friends").setFields(nr).where(`owner_user_id = '${nr.owner_user_id}' and friend_user_id = '${nr.friend_user_id}'`).toString();tr.exec(ir)}(Zt,B(P(JSON.parse(er),{userID:"friend_user_id",nickname:"name"}))),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getAllFriendList",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){return tr.exec(`
      select *
        from local_friends
        where owner_user_id = "${nr}"
        `)}(yield Ht(),er);return M(F(Zt[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"}))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("searchFriendList",function(er,Zt,tr,nr){return Er(this,null,function*(){try{const ir=function(sr,_r,ar,Or,Sr){let kr="";const Ir=`name like "%${_r}%"`,Cr=`remark like "%${_r}%"`;return ar&&(kr=`friend_user_id like "%${_r}%"`),Or&&(kr=kr?kr+" or "+Ir:Ir),Sr&&(kr=kr?kr+" or "+Cr:Cr),sr.exec(`
      select *
        from local_friends
        where ${kr}
        order by create_time desc
        `)}(yield Ht(),er,Zt,tr,nr);return M(F(ir[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"}))}catch(ir){return console.error(ir),M(void 0,h.ErrorInit,JSON.stringify(ir))}})}),Xt.registerMethod("getFriendInfoByFriendUserID",function(er,Zt){return Er(this,null,function*(){try{const tr=function(nr,ir,sr){return nr.exec(`
      select *
        from local_friends
        where owner_user_id = "${sr}"
         and friend_user_id = "${ir}"
        limit 1
        `)}(yield Ht(),er,Zt);return tr.length===0?M("",h.ErrorNoRecord,`no friend with id ${er}`):M(F(tr[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"})[0])}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getFriendInfoList",function(er){return Er(this,null,function*(){try{const Zt=function(tr,nr){const ir=nr.map(sr=>`'${sr}'`).join(",");return tr.exec(`
      select *
        from local_friends
        where friend_user_id in (${ir})
        `)}(yield Ht(),JSON.parse(er));return M(F(Zt[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"}))}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("getPageFriendList",function(er,Zt,tr){return Er(this,null,function*(){try{const nr=function(ir,sr,_r,ar){return ir.exec(`
      select *
        from local_friends
        where owner_user_id = "${ar}"
        order by name
        limit ${_r} offset ${sr}
        `)}(yield Ht(),er,Zt,tr);return M(F(nr[0],"CamelCase",["isPinned"],{name:"nickname",friend_user_id:"userID"}))}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("updateColumnsFriend",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht(),nr=B(P(JSON.parse(Zt),{userID:"friend_user_id",nickname:"name"}));return function(ir,sr,_r){const ar=sr.map(Sr=>`'${Sr}'`).join(","),Or=v.update().table("local_friends").setFields(_r).where(`friend_user_id IN (${ar})`).toString();ir.exec(Or)}(tr,JSON.parse(er),nr),M("")}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getFriendListCount",function(){return Er(this,null,function*(){var er,Zt,tr;try{const nr=function(ir){return ir.exec(`
      SELECT COUNT(*) FROM local_friends;
      `)}(yield Ht());return M((tr=(Zt=(er=nr[0])===null||er===void 0?void 0:er.values[0])===null||Zt===void 0?void 0:Zt[0])!==null&&tr!==void 0?tr:0)}catch(nr){return console.error(nr),M(void 0,h.ErrorInit,JSON.stringify(nr))}})}),Xt.registerMethod("batchInsertFriend",function(er){return Er(this,null,function*(){try{const Zt=yield Ht();return JSON.parse(er).map(tr=>{const nr=B(P(tr,{userID:"friend_user_id",nickname:"name"}));return w(Zt,nr),null}),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("deleteAllFriend",function(){return Er(this,null,function*(){try{return function(er){er.exec(`
      DELETE FROM local_friends;
      `)}(yield Ht()),M("")}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("batchInsertTempCacheMessageList",Vt),Xt.registerMethod("InsertTempCacheMessage",function(er){return Er(this,null,function*(){return Vt(`[${er}]`)})}),Xt.registerMethod("getNotificationAllSeqs",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec("SELECT * from local_notification_seqs where 1 = 1;")}(yield Ht());return M(F(er[0],"CamelCase"))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("batchInsertNotificationSeq",function(er){return Er(this,null,function*(){try{const Zt=JSON.parse(er),tr=yield Ht();return Zt.map(nr=>{const{conversationID:ir,seq:sr}=nr;S(tr,ir,sr)}),M("")}catch(Zt){return console.error(Zt),M(void 0,h.ErrorInit,JSON.stringify(Zt))}})}),Xt.registerMethod("setNotificationSeq",function(er,Zt){return Er(this,null,function*(){try{const tr=yield Ht();let nr=function(ir,sr,_r){return ir.exec(`UPDATE local_notification_seqs set seq = ${_r} where conversation_id = "${sr}"`)}(tr,er,Zt);return tr.getRowsModified()===0&&(nr=S(tr,er,Zt)),M(nr[0])}catch(tr){return console.error(tr),M(void 0,h.ErrorInit,JSON.stringify(tr))}})}),Xt.registerMethod("getExistedTables",function(){return Er(this,null,function*(){try{const er=function(Zt){return Zt.exec(`
      SELECT name FROM sqlite_master WHERE type="table";
    `)}(yield Ht());return M(F(er[0],"CamelCase",[],{tbl_name:"tblName"}))}catch(er){return console.error(er),M(void 0,h.ErrorInit,JSON.stringify(er))}})}),Xt.registerMethod("exec",er=>Er(this,null,function*(){const Zt=yield Ht();try{const tr=Zt.exec(er);console.info(`sql debug with exec sql = ${er.trim()} , return `,tr)}catch(tr){console.info(`sql debug with exec sql = ${er} , return `,tr)}})),Xt.registerMethod("getRowsModified",()=>Er(this,null,function*(){const er=yield Ht();try{const Zt=er.getRowsModified();console.info("sql debug with getRowsModified return ",Zt)}catch(Zt){console.info("sql debug with getRowsModified return ",Zt)}})),Xt.registerMethod("exportDB",()=>Er(this,null,function*(){const er=yield Ht();try{const Zt=er.export(),tr=new Blob([Zt]);return URL.createObjectURL(tr)}catch(Zt){console.info("sql export error, return ",Zt)}}));
}());