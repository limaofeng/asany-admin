(self.webpackChunk=self.webpackChunk||[]).push([[3848],{14336:function(de,re,t){"use strict";var ue=t(15009),o=t.n(ue),I=t(99289),w=t.n(I),te=t(97857),T=t.n(te),he=t(5574),ne=t.n(he),_=t(67294),d=t(89717),l=t(12708);function f(y,v){return y.replace(/{(\w+)}/g,function(h,P){return v[P]!==void 0?v[P]:h})}function x(y,v){var h=y(T()({fetchPolicy:"network-only"},(v==null?void 0:v.mutation)||{})),P=ne()(h,1),W=P[0],Q=(0,_.useRef)(!1),G=(0,_.useRef)(null),ce=(0,_.useCallback)(function(){var pe=w()(o()().mark(function me(F,J){var ge,Me,je,ye,K,r,le,Ce,fe;return o()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return ge=(J==null?void 0:J.dialog)||(v==null?void 0:v.dialog)||{},Me=(J==null?void 0:J.mutation)||(v==null?void 0:v.mutation)||{},je=(J==null?void 0:J.onDeleted)||(v==null?void 0:v.onDeleted),ye=ge.width,K=ge.title,r=ge.content,le=!1,Array.isArray(F)?(le=!0,typeof K=="function"&&(K=K(F,{batch:!0})),typeof r=="function"&&(r=r(F,{batch:!0}))):F&&(typeof K=="string"&&(K=f(K,F)),typeof r=="string"&&(r=f(r,F)),typeof K=="function"&&(K=K(F,{batch:!1})),typeof r=="function"&&(r=r(F,{batch:!1}))),Ce=function(){var xe=w()(o()().mark(function e(){return o()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,W(T()(T()({fetchPolicy:"network-only"},Me),{},{variables:{where:{id_in:le?F:[F==null?void 0:F.id]}}}));case 2:case"end":return ae.stop()}},e)}));return function(){return xe.apply(this,arguments)}}(),Z.next=10,d.Modal.confirm(T()(T()({},ge),{},{title:K,content:r,width:ye,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!Q.current},preConfirm:function(){var xe=w()(o()().mark(function _e(){var ae,Ee,we;return o()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return Q.current=!0,G.current=null,O.prev=2,ae=document.querySelector(".swal2-confirm"),ae.textContent="\u5220\u9664\u4E2D...",Ee=document.createElement("span"),Ee.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),ae.appendChild(Ee),O.next=10,(0,l.gw)(Ce(),350);case 10:we=O.sent,je&&je(F,we),O.next=17;break;case 14:O.prev=14,O.t0=O.catch(2),G.current=O.t0;case 17:return O.prev=17,Q.current=!1,O.finish(17);case 20:case"end":return O.stop()}},_e,null,[[2,14,17,20]])}));function e(){return xe.apply(this,arguments)}return e}()}));case 10:if(fe=Z.sent,!G.current){Z.next=14;break}return d.Toast.error("\u5220\u9664\u5931\u8D25:"+G.current.message,2e3,{placement:"top-center",progressBar:!0}),Z.abrupt("return",!1);case 14:if(fe.isConfirmed){Z.next=16;break}return Z.abrupt("return",!1);case 16:return d.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),Z.abrupt("return",!0);case 18:case"end":return Z.stop()}},me)}));return function(me,F){return pe.apply(this,arguments)}}(),[]),Pe=(0,_.useCallback)(function(pe,me){return ce(pe,me)},[v,W]),Se=(0,_.useCallback)(function(pe,me){return ce(pe,me)},[]);return{delete:Pe,deleteMany:Se}}re.Z=x},58301:function(de,re,t){"use strict";t.d(re,{Oh:function(){return he},bp:function(){return ne}});var ue=t(97857),o=t.n(ue),I=t(67294);function w(_,d){var l,f,x=_(o()({fetchPolicy:"network-only"},d)),y=x.data,v=x.loading,h=x.previousData,P=x.refetch,W=x.error,Q=(0,I.useMemo)(function(){return v?h==null?void 0:h.result.pageInfo:y==null?void 0:y.result.pageInfo},[y==null||(l=y.result)===null||l===void 0?void 0:l.pageInfo.total,v,h==null||(f=h.result)===null||f===void 0?void 0:f.pageInfo.total]),G=(0,I.useMemo)(function(){return y!=null&&y.result?y.result.edges.map(function(ce){return ce.node}):v&&h!==null&&h!==void 0&&h.result?h.result.edges.map(function(ce){return ce.node}):[]},[v,y==null?void 0:y.result,h==null?void 0:h.result]);return[G,{loading:v,pageInfo:Q,error:W,variables:{},refetch:P}]}function te(_,d){return d.split(".").reduce(function(l,f){return l&&l[f]!==void 0?l[f]:void 0},_)}function T(_,d,l){for(var f=d.split("."),x=_;f.length>1;){var y=f.shift();x[y]||(x[y]={}),x=x[y]}x[f[0]]=l}function he(_,d){var l=d.map(function(f){var x=f.source,y=f.target,v=f.transform,h=f.skip,P=te(_,x);if(P==null||h&&h(P))return"";var W=v?v(P):String(P);return"".concat(encodeURIComponent(y||x),"=").concat(encodeURIComponent(W))});return l.filter(function(f){return f}).join("&")}function ne(_,d){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},f=l;return d.forEach(function(x){var y=x.source,v=x.target,h=x.transform,P=x.skip,W=_.get(y);if(!(!W||W.trim()==="")){var Q=h?h(W):W;P&&P(Q)||(v?T(f,v,Q):f[y]=Q)}}),f}re.ZP=w},80537:function(de,re,t){"use strict";var ue=t(14336),o=t(96944),I=t(85893);function w(te){var T=(0,ue.Z)(o.nT,{onDeleted:function(){te&&te()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(d,l){var f;if(l.batch){var x=d;f="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(x.length," \u7BC7\u6587\u7AE0\u5417\uFF1F")}else f=(0,I.jsxs)(I.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,I.jsx)("strong",{children:d.title})]});return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("p",{className:"tip-confirm",children:f}),(0,I.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),he=T.delete,ne=T.deleteMany;return{delete:he,deleteMany:ne}}re.Z=w},36875:function(de,re,t){"use strict";t.r(re),t.d(re,{default:function(){return ze}});var ue=t(97857),o=t.n(ue),I=t(15009),w=t.n(I),te=t(64599),T=t.n(te),he=t(99289),ne=t.n(he),_=t(5574),d=t.n(_),l=t(67294),f=t(96974),x=t(39711),y=t(46027),v=t(30381),h=t.n(v),P=t(78277),W=t(14336),Q=t(52677),G=t.n(Q),ce=t(61227),Pe=t.n(ce),Se=t(32512),pe=t(93162),me=t.n(pe),F=t(84105),J=function(a){var b=a.split(`
`);return b.map(function(C){return C.split(",")})},ge=function(a,b){var C=Pe()(a),N=C[0],L=C.slice(1);return L.map(function(j){for(var M={},c=0,Y=Object.keys(b.fields);c<Y.length;c++){var D=Y[c],g=b.fields[D];typeof g=="number"?M[D]=j[g]:typeof g=="string"?M[D]=j[N.indexOf(g)]:G()(g)==="object"&&(M[D]=typeof g.index=="string"?j[N.indexOf(g.index)]:j[g.index],g.formatter&&(M[D]=g.formatter(M[D])))}return M})};function Me(p,a){var b=(0,l.useCallback)(function(D){var g=D[0];if(g){var R=new FileReader;R.onload=function(X){var q=g.name.split(".").pop().toLowerCase();if(q==="csv"){var k=X.target.result,se=J(k);console.log("Parsed CSV Data:",se)}else if(q==="xls"||q==="xlsx"){var ee=X.target.result,U=F.ij(ee,{type:"binary"}),z=U.SheetNames[0],S=U.Sheets[z],H=F.P6.sheet_to_json(S,{header:a.header||1,raw:!1,dateNF:"yyyy-mm-dd hh:mm:ss"}),$=ge(H,a);console.log("Formatted JSON Data:",$),p($)}else console.error("Unsupported file type")},g.type==="text/csv"||g.name.endsWith(".csv")?R.readAsText(g):R.readAsBinaryString(g)}},[p]),C=(0,Se.uI)({onDrop:b,accept:{"text/csv":[".csv"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},maxFiles:1}),N=C.getRootProps,L=C.getInputProps,j=N(),M=j.onClick,c=(0,l.useCallback)(function(D){console.log("handleImportExcel"),M&&M(D)},[M]),Y=(0,l.useCallback)(function(){var D,g,R=Object.keys(a.fields).map(function(oe){var u=a.fields[oe];return G()(u)==="object"&&u.name||oe}),X=Object.keys(a.fields).map(function(oe){var u=a.fields[oe];return G()(u)==="object"&&u.example||""}),q=[R,X],k=F.P6.aoa_to_sheet(q);(D=a.template)!==null&&D!==void 0&&D.cols&&(k["!cols"]=a.template.cols);for(var se=0,ee=1;ee<se;ee++)for(var U=0;U<R.length;U++){var z=F.P6.encode_cell({r:ee,c:U});k[z]||(k[z]={v:null});var S=a.fields[R[U]];if(G()(S)==="object"){switch(S.type){case"date":k[z].t="d";break}S.format&&(k[z].z=S.format)}}var H=F.P6.book_new();F.P6.book_append_sheet(H,k,"Sheet1");var $=F.cW(H,{bookType:"xlsx",type:"array"}),ie=new Blob([$],{type:"application/octet-stream"});me()(ie,((g=a.template)===null||g===void 0?void 0:g.filename)||"template.xlsx")},[a]);return[(0,l.createElement)("input",o()(o()({},L()),{},{key:"file-input",value:""})),c,Y,{data:{},error:"",handleImportExcel:c}]}var je=Me,ye=t(58301),K=t(73588),r=t(89717),le=t(42646),Ce=t(75981),fe=t(12708),ke=t(5618),Z=t(80537),xe=t(96944),e=t(85893);function _e(p,a){var b=r.Form.useForm(),C=(0,l.useState)(!1),N=d()(C,2),L=N[0],j=N[1],M=a||{},c=M.messages,Y=M.onSubmitted,D=Y===void 0?function(){}:Y,g=M.transform,R=g===void 0?function(S){return S}:g,X=(0,xe.uw)({fetchPolicy:"no-cache",refetchQueries:a==null?void 0:a.refetchQueries}),q=d()(X,1),k=q[0],se=(0,xe.Mq)({fetchPolicy:"no-cache",refetchQueries:a==null?void 0:a.refetchQueries}),ee=d()(se,1),U=ee[0],z=(0,l.useMemo)(function(){return p!=null&&p.id?ne()(w()().mark(function S(){var H,$,ie;return w()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return j(!0),u.prev=1,u.t0=R,u.next=5,b.validateFields();case 5:return u.t1=u.sent,H=(0,u.t0)(u.t1),u.next=9,r.Toast.promise((0,fe.gw)(U({variables:{id:p.id,input:o()({},H)}}),350),{pending:(c==null?void 0:c.pending)||"\u4FDD\u5B58\u4E2D...",success:{render:function(){return(0,e.jsxs)(e.Fragment,{children:["\u8DEF\u7531 ",(0,e.jsx)("strong",{children:H.name})," \u4FDD\u5B58\u6210\u529F"]})}},error:(c==null?void 0:c.error)||"\u4FDD\u5B58\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 9:$=u.sent,ie=$.data,D(ie.updateArticle),j(!1),u.next=18;break;case 15:u.prev=15,u.t2=u.catch(1),j(!1);case 18:case"end":return u.stop()}},S,null,[[1,15]])})):ne()(w()().mark(function S(){var H,$,ie;return w()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return j(!0),u.prev=1,u.t0=R,u.next=5,b.validateFields();case 5:return u.t1=u.sent,H=(0,u.t0)(u.t1),u.next=9,r.Toast.promise((0,fe.gw)(k({variables:{input:o()({},H)}}),350),{pending:(c==null?void 0:c.pending)||"\u63D0\u4EA4\u4E2D...",success:{render:(c==null?void 0:c.pending)||"\u63D0\u4EA4\u6210\u529F"},error:(c==null?void 0:c.error)||"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 9:$=u.sent,ie=$.data,D(ie.createArticle),j(!1),u.next=18;break;case 15:u.prev=15,u.t2=u.catch(1),j(!1);case 18:case"end":return u.stop()}},S,null,[[1,15]])}))},[k,p==null?void 0:p.id,b,D,U,R]);return[z,{form:b,submitting:L}]}var ae=_e;function Ee(p){var a=p.form;return(0,l.useEffect)(function(){var b,C=p.data;C.id||a.resetFields();var N=new RegExp("^storage://[^/]+/"),L=(b=C.content)===null||b===void 0||(b=b.rawUrl)===null||b===void 0?void 0:b.replace(N,"");a.setFieldsValue(o()(o()({},C),{},{tags:(C.tags||[]).map(function(j){return j.name}),content:L}))},[a,p.data]),(0,e.jsxs)(r.Form,{form:a,children:[(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"title",className:"d-flex flex-column mb-7",required:!0,label:"CMMF CODE",rules:[{required:!0,message:"CMMF CODE\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.Input,{solid:!0})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"tags",className:"d-flex flex-column mb-7",required:!0,label:"WMF CODE",children:(0,e.jsx)(ke.ZP,{className:"form-control form-control-solid"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"category",className:"d-flex flex-column mb-7",label:"\u6587\u6863\u7C7B\u522B",children:(0,e.jsx)(r.Select,{options:[{value:"conformity",label:"\u7B26\u5408\u6027\u7533\u660E"},{value:"manual",label:"\u8BF4\u660E\u4E66"}]})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"content",className:"d-flex flex-column mb-7",required:!0,label:"\u6587\u4EF6\u8DEF\u5F84",rules:[{required:!0,message:"\u6587\u4EF6\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.Input.TextArea,{solid:!0,autoSize:{minRows:2,maxRows:2}})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"scheduledAt",className:"d-flex flex-column mb-7",label:"\u53D1\u5E03\u65F6\u95F4",rules:[{required:!0,message:"\u53D1\u5E03\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.DatePicker,{solid:!0,className:"w-100"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"expirationAt",className:"d-flex flex-column mb-7",label:"\u8FC7\u671F\u65F6\u95F4",rules:[{required:!0,message:"\u8FC7\u671F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.DatePicker,{solid:!0,className:"w-100"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{className:"d-flex flex-column mb-7",name:"summary",label:"\u5907\u6CE8",children:(0,e.jsx)(r.Input.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:6}})})})})]})}function we(p){var a=p.data,b=p.visible,C=p.onClose,N=p.onSuccess,L=p.onDeleteSuccess,j=(0,P.Z)("drive"),M=d()(j,1),c=M[0],Y=c==null?void 0:c.values.space,D=ae(a,{transform:function(S){return o()(o()({},S),{},{content:{type:"PDF",url:"storage://".concat(Y,"/").concat(S.content)},category:"conformity"})},onSubmitted:N}),g=d()(D,2),R=g[0],X=g[1],q=X.form,k=X.submitting,se=(0,l.useMemo)(function(){return a?o()({},a):{}},[a]),ee=(0,Z.Z)(function(){return L(a)}),U=ee.delete;return(0,e.jsx)(r.Drawer,{title:a!=null&&a.id?"\u7F16\u8F91":"\u65B0\u589E",placement:"right",width:640,mask:!0,closable:!0,onClose:C,visible:b,footer:(0,e.jsxs)(r.Row,{children:[(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Button,{style:{letterSpacing:"1rem"},className:"w-100",loading:k,onClick:R,children:"\u4FDD\u5B58"})}),(0,e.jsx)(r.Col,{span:6,children:(a==null?void 0:a.id)&&(0,e.jsx)(r.Button,{style:{letterSpacing:"1rem"},className:"w-100",variant:"light-danger",onClick:function(){return U(a)},children:"\u5220\u9664"})})]}),children:a&&(0,e.jsx)(Ee,{submitting:k,data:se,form:q,submit:R,onDeleteSuccess:L})})}var Oe=we;function O(p){var a=p.data,b=p.delete,C=p.onEdit,N=(0,l.useState)(!1),L=d()(N,2),j=L[0],M=L[1],c=(0,l.useCallback)(function(Y){var D=Y.key;D==="edit"?C(a):D==="delete"&&b({name:a.title,id:a.id})},[]);return(0,e.jsx)(r.Dropdown,{overlay:(0,e.jsxs)(r.Menu,{onClick:c,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-2",children:[(0,e.jsx)(r.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(r.Menu.Item,{className:"actions-delete px-3",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:M,visible:j,children:(0,e.jsxs)(r.Button,{variant:"clean",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(y.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function Ze(){var p=(0,f.s0)(),a=(0,x.lr)(),b=d()(a,1),C=b[0],N=(0,P.Z)("drive"),L=d()(N,1),j=L[0],M=j==null?void 0:j.values.space,c=(0,l.useMemo)(function(){return(0,ye.bp)(C,[{source:"q",target:"keywords"}])},[C.get("q")]);(0,l.useState)({keywords:C.get("q")||""});var Y=(0,l.useMemo)(function(){return(0,ye.bp)(C,[{source:"q",target:"where.OR",transform:function(n){return[{tags:[n]},{title:n}]}},{source:"page",transform:function(n){return parseInt(n)}},{source:"per_page",transform:function(n){return parseInt(n)}},{source:"sort",target:"orderBy",transform:function(n){var E=n.split(":"),s=d()(E,2),B=s[0],A=s[1];return"".concat(B,"_").concat(A)}}])},[C.toString()]),D=(0,le.Y9)({fetchPolicy:"network-only"}),g=d()(D,1),R=g[0],X=(0,le.uw)(),q=d()(X,1),k=q[0],se=(0,le.Mq)(),ee=d()(se,1),U=ee[0],z=(0,ye.ZP)(le.gk,{variables:Y}),S=d()(z,2),H=S[0],$=S[1],ie=$.loading,oe=$.pageInfo,u=$.refetch,Ne=(0,l.useCallback)(function(i,n,E){var s=(0,ye.Oh)({searchForm:c,pagination:i,filters:n,sorter:E},[{source:"searchForm.keywords",target:"q",skip:function(A){return!A}},{source:"pagination.current",target:"page",skip:function(A){return A===1}},{source:"pagination.pageSize",target:"per_page",skip:function(A){return A===15}},{source:"sorter.field",target:"sort",transform:function(A){return"".concat(A,":").concat(E.order==="ascend"?"asc":"desc")}}]);p(location.pathname+"?"+s,{replace:!0})},[c]),Qe=(0,l.useCallback)(function(i){p(location.pathname+(i?"?q="+i:""),{replace:!0})},[]),Ge=(0,l.useCallback)(function(){var i=ne()(w()().mark(function n(E){var s,B,A,be,Ke,V,Ie,Te,Ye,ve,Re,He,Fe,Ve,Ae;return w()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:s={totalRecords:0,insertCount:0,updateCount:0,failureCount:0,failedRecords:[],startTime:null,endTime:null},s.totalRecords=E.length,B=r.Toast.loading("\u5F00\u59CB\u5BFC\u5165\u6587\u4EF6",{placement:"top-center"}),s.startTime=new Date,A=0,be=T()(E),m.prev=6,be.s();case 8:if((Ke=be.n()).done){m.next=49;break}return V=Ke.value,A++,m.prev=11,m.next=14,R({variables:{where:{title:V.title}}});case 14:if(Ye=m.sent,ve=Ye.data,Re={title:V.title,summary:V.summary,tags:V.tag?[V.tag]:[],scheduledAt:V.scheduledAt,expirationAt:V.expirationAt,category:"conformity",content:{type:"PDF",url:"storage://".concat(M,"/")+V.file}},(ve==null||(Ie=ve.result)===null||Ie===void 0?void 0:Ie.pageInfo.total)!==1){m.next=28;break}return B.update("\u66F4\u65B0 ".concat(V.title," - ").concat(A,"/").concat(s.totalRecords),{icon:"loading"}),m.next=21,U({variables:{id:ve.result.edges[0].node.id,input:Re}});case 21:if(He=m.sent,Fe=He.errors,!(Fe!=null&&Fe.length)){m.next=25;break}throw new Error(Fe[0].message);case 25:s.updateCount++,m.next=40;break;case 28:if((ve==null||(Te=ve.result)===null||Te===void 0?void 0:Te.pageInfo.total)!==0){m.next=39;break}return B.update("\u65B0\u589E ".concat(V.title," - ").concat(A,"/").concat(s.totalRecords),{icon:"loading"}),m.next=32,k({variables:{input:Re}});case 32:if(Ve=m.sent,Ae=Ve.errors,!(Ae!=null&&Ae.length)){m.next=36;break}throw new Error(Ae[0].message);case 36:s.insertCount++,m.next=40;break;case 39:s.failureCount++;case 40:m.next=47;break;case 42:m.prev=42,m.t0=m.catch(11),B.update("\u5931\u8D25 ".concat(V.title," - ").concat(A,"/").concat(s.totalRecords),{icon:"error"}),s.failureCount++,s.failedRecords.push({record:V,error:m.t0});case 47:m.next=8;break;case 49:m.next=54;break;case 51:m.prev=51,m.t1=m.catch(6),be.e(m.t1);case 54:return m.prev=54,be.f(),m.finish(54);case 57:s.endTime=new Date,console.log("Import Summary:",s),B.close(),u(),r.Modal.success({title:"\u64CD\u4F5C\u6210\u529F",width:600,content:(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:["\u5BFC\u5165\u5B8C\u6210, \u5171 ",s.totalRecords," \u6761\u8BB0\u5F55, \u6210\u529F"," ",s.insertCount," \u6761, \u66F4\u65B0 ",s.updateCount," \u6761, \u5931\u8D25 ",s.failureCount," \u6761"]}),(0,e.jsxs)("p",{children:["\u8017\u65F6:"," ",h()(s.endTime).diff(s.startTime,"seconds")," ","\u79D2"]}),(0,e.jsxs)("p",{children:["\u603B\u8BB0\u5F55\u6570: ",s.totalRecords]}),(0,e.jsxs)("p",{children:["\u63D2\u5165\u6570\u91CF: ",s.insertCount]}),(0,e.jsxs)("p",{children:["\u66F4\u65B0\u6570\u91CF: ",s.updateCount]}),(0,e.jsxs)("p",{children:["\u5931\u8D25\u6570\u91CF: ",s.failureCount]})]}),allowOutsideClick:!1});case 62:case"end":return m.stop()}},n,null,[[6,51,54,57],[11,42]])}));return function(n){return i.apply(this,arguments)}}(),[u,M]),Je=je(Ge,{header:1,fields:{title:{index:0,name:"CMMF CODE",example:"W22L1",formatter:function(n){return String(n).trim()}},tag:{index:1,name:"WMF CODE",example:"YS22ED",formatter:function(n){return String(n).trim()}},scheduledAt:{index:2,name:"\u53D1\u5E03\u65F6\u95F4",example:"2024/8/22 0:00",formatter:function(n){return String(n).trim()&&h()(n).format("YYYY-MM-DD HH:mm")}},expirationAt:{index:3,name:"\u7ED3\u675F\u65F6\u95F4",example:"2024/8/31 0:00",formatter:function(n){return String(n).trim()&&h()(n).format("YYYY-MM-DD HH:mm")}},file:{index:4,name:"\u6587\u4EF6\u4F4D\u7F6E",example:"3201000159 1873596030 \u7092\u9505\u94F2.pdf.pdf",formatter:function(n){return String(n).trim()}},summary:{index:5,name:"\u5907\u6CE8",example:"",formatter:function(n){return String(n).trim()}}},template:{filename:"\u7B26\u5408\u6027\u89C4\u8303\u6279\u91CF\u4E0A\u4F20.xlsx",cols:[{wch:20},{wch:20},{wch:20},{wch:20},{wch:50},{wch:30}]}}),Be=d()(Je,3),Xe=Be[0],qe=Be[1],er=Be[2],Le=(0,W.Z)(le.nT,{onDeleted:function(){return u()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(n,E){var s;if(E.batch){var B=n;s="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(B.length," \u4E2A\u6587\u4EF6\u5417\uFF1F")}else s=(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:n.name})]});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:s}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),rr=Le.delete,Ue=Le.deleteMany,tr=(0,l.useCallback)(function(i){return ne()(w()().mark(function n(){return w()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:Ue(i);case 1:case"end":return s.stop()}},n)}))},[Ue]),nr=(0,l.useState)({visible:!1}),$e=d()(nr,2),We=$e[0],De=$e[1],ar=(0,l.useCallback)(function(){De(function(i){return o()(o()({},i),{},{visible:!1})})},[]),ur=(0,l.useCallback)(function(i){De(function(n){return o()(o()({},n),{},{route:i})}),u()},[De]),lr=(0,l.useCallback)(function(i){De(function(n){var E;return((E=n.data)===null||E===void 0?void 0:E.id)!==i.id?n:o()(o()({},n),{},{visible:!1,menu:void 0})}),u()},[De]),sr=(0,l.useCallback)(function(){De(function(i){return o()(o()({},i),{},{visible:!0,data:{}})})},[]),ir=(0,l.useCallback)(function(i){De(function(n){return o()(o()({},n),{},{visible:!0,data:i})})},[]);return(0,e.jsxs)(K.vs,{header:{title:"\u7B26\u5408\u6027\u7533\u660E\u7BA1\u7406"},children:[(0,e.jsx)(Oe,{data:We.data,onClose:ar,onSuccess:ur,onDeleteSuccess:lr,visible:We.visible}),(0,e.jsxs)(r.Card,{className:"mb-5 mb-xl-10",children:[(0,e.jsxs)(r.Card.Header,{className:"pt-8",children:[(0,e.jsx)(r.Card.Title,{className:"flex-column",children:(0,e.jsx)(r.Input.Search,{solid:!0,defaultValue:c.keywords,className:"w-250px",placeholder:"\u5173\u952E\u8BCD\u641C\u7D22",onSearch:Qe})}),(0,e.jsx)(r.Card.Toolbar,{children:(0,e.jsxs)("div",{children:[(0,e.jsx)(r.Button,{onClick:sr,className:"me-4 my-1",children:"\u65B0\u5EFA"}),Xe,(0,e.jsx)(r.Button,{className:"me-4 my-1",onClick:qe,children:"\u6A21\u677F\u6570\u636E\u5BFC\u5165"}),(0,e.jsx)(r.Button,{variant:"light",className:"me-4 my-1",onClick:er,children:"\u7B26\u5408\u6027\u58F0\u660E\u6A21\u677F\u4E0B\u8F7D"})]})})]}),(0,e.jsx)(r.Card.Body,{children:(0,e.jsx)(r.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:ie,children:(0,e.jsx)(r.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(n){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:n}),"\u4E2A"]})},toolbar:function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(r.Button,{color:"danger",onClick:tr(n),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},noRowsRenderer:function(){return(0,e.jsx)(r.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"title",title:"CMMF CODE",width:130,sorter:!0,sortOrder:(0,fe.PE)(C,"title")},{key:"tags",title:"WMF CODE",width:130,render:function(n,E){return!!E.tags.length&&E.tags[0].name}},{key:"content",title:"\u89C4\u8303\u6587\u4EF6",render:function(n,E){var s,B,A=E.content,be=new RegExp("^storage://[^/]+/");return(0,e.jsxs)("div",{children:[A==null||(s=A.rawUrl)===null||s===void 0?void 0:s.replace(be,""),(A==null||(B=A.url)===null||B===void 0?void 0:B.startsWith("storage://"))&&(0,e.jsx)(r.Badge,{className:"ms-2",color:"dark",children:"\u672A\u4E0A\u4F20"}),(0,e.jsx)(r.Badge,{className:"ms-2",color:"warning",light:!0,children:"\u7B26\u5408\u6027\u7533\u660E"})]})}},{key:"status",title:"\u72B6\u6001",width:200,sorter:!0,sortOrder:(0,fe.PE)(C,"status"),render:function(n,E){switch(n){case Ce.af.Draft:return(0,e.jsx)(r.Badge,{light:!0,color:"secondary",children:"\u8349\u7A3F"});case Ce.af.Published:return(0,e.jsx)(r.Badge,{light:!0,color:"primary",children:"\u5DF2\u53D1\u5E03"});case Ce.af.Scheduled:return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(r.Badge,{light:!0,color:"info",children:["\u5C06\u4E8E"," ",h()(E.scheduledAt).format("YYYY-MM-DD HH:mm")," ","\u53D1\u5E03"]})});case Ce.af.Expired:return(0,e.jsx)(r.Badge,{color:"dark",children:"\u5DF2\u8FC7\u671F"});default:return(0,e.jsx)("span",{className:"badge badge-light-dark",children:"\u672A\u77E5"})}}},{key:"expirationAt",title:"\u7ED3\u675F\u65F6\u95F4",sorter:!0,sortOrder:(0,fe.PE)(C,"expirationAt"),width:160,render:function(n){return(0,e.jsx)("div",{className:"text-gray-700",children:n&&h()(n).format("YYYY-MM-DD HH:mm")})}},{title:"\u64CD\u4F5C",key:"action",width:120,render:function(n,E){return(0,e.jsx)(O,{data:E,delete:rr,onEdit:ir})}}],pagination:oe,onChange:Ne,dataSource:H})})})]})]})}var ze=Ze},20067:function(){},61227:function(de,re,t){var ue=t(82187),o=t(96936),I=t(96263),w=t(69094);function te(T){return ue(T)||o(T)||I(T)||w()}de.exports=te,de.exports.__esModule=!0,de.exports.default=de.exports}}]);
