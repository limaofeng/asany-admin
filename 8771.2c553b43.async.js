(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[8771],{58771:function(G,P,i){"use strict";i.r(P);var I=i(86582),F=i(2824),S=i(93224),M=i(3182),R=i(94043),b=i.n(R),_=i(67294),O=i(73727),w=i(28865),W=i(80129),k=i.n(W),A=i(81303),K=i(56902),U=i(75468),s=i(69851),e=i(85893);function Z(v){var f=v.data,p=v.history,E=v.onDelete,y=(0,_.useCallback)(function(){var c=(0,M.Z)(b().mark(function j(C){var D,g;return b().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return D="\u786E\u5B9A\u5220\u9664\u95E8\u5E97 \u201C".concat(C.name,"\u201D \u5417\uFF1F"),l.next=3,s.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:D}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(g=l.sent,g.isConfirmed){l.next=6;break}return l.abrupt("return");case 6:return l.next=8,E(C.id);case 8:s.FN.success("\u95E8\u5E97 \u201C".concat(C.name,"\u201D \u5220\u9664\u6210\u529F"),2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return l.stop()}},j)}));return function(j){return c.apply(this,arguments)}}(),[E]),m=(0,_.useCallback)(function(c){c.key=="view"?p.push("/website/landing/stores/".concat(f.id)):c.key=="delete"&&y(f)},[f,y,p]);return(0,e.jsx)(s.Lt,{overlay:(0,e.jsxs)(s.v2,{onClick:m,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold fs-8 w-125px py-4",children:[(0,e.jsx)(s.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"view"),(0,e.jsx)(s.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",children:(0,e.jsxs)(s.zx,{className:"fs-8",variant:"light",activeColor:"light-primary",children:["\u64CD\u4F5C",(0,e.jsx)(w.JO,{className:"svg-icon-5 ms-2 me-n1",name:"Duotune/arr072"})]})})}function $(v){var f,p,E=v.history,y=v.location,m=(0,_.useMemo)(function(){var n=v.location.query,r=n.q,a=(0,S.Z)(n,["q"]);return r&&(a.filter={name_contains:r}),a},[v.location]),c=(0,_.useMemo)(function(){if(!m.orderBy)return{order:"descend",field:"createdAt"};var n=m.orderBy.split("_"),r=(0,F.Z)(n,2),a=r[0],d=r[1];return{order:d=="desc"?"descend":"ascend",field:a}},[m.orderBy]),j=(0,A.OE)({refetchQueries:[A.b_]}),C=(0,F.Z)(j,1),D=C[0],g=(0,A.ZL)({fetchPolicy:"cache-and-network",variables:m}),t=g.data,l=g.loading,u=g.previousData,N=(0,_.useMemo)(function(){return l?(u==null?void 0:u.total.totalCount)||0:(t==null?void 0:t.total.totalCount)||0},[t==null?void 0:t.total.totalCount,l,u==null?void 0:u.total]),z=(0,_.useMemo)(function(){return l?(u==null?void 0:u.landingStores)||{total:0,current:1}:(t==null?void 0:t.landingStores)||{total:0,current:1}},[t==null?void 0:t.landingStores,l,u==null?void 0:u.landingStores]),H=(0,_.useMemo)(function(){var n;if(l){var r;return((u==null||(r=u.landingStores)===null||r===void 0?void 0:r.edges)||[]).map(function(a){return a.node})}return((t==null||(n=t.landingStores)===null||n===void 0?void 0:n.edges)||[]).map(function(a){return a.node})},[t==null?void 0:t.landingStores,l,u==null?void 0:u.landingStores]),J=(0,_.useCallback)(function(n){E.replace(y.pathname+"?"+k().stringify({q:n}))},[E,y.pathname]),Q=(0,_.useCallback)(function(n,r,a){var d,h={};if((d=m.filter)!==null&&d!==void 0&&d.name_contains){var o;h.q=(o=m.filter)===null||o===void 0?void 0:o.name_contains}a&&(h.orderBy=a.field+"_"+(a.order=="ascend"?"asc":"desc")),h.page=n.current,E.replace(y.pathname+"?"+k().stringify(h))},[E,y.pathname,(f=m.filter)===null||f===void 0?void 0:f.name_contains]),B=(0,_.useCallback)((0,M.Z)(b().mark(function n(){var r,a,d,h,o,T=arguments;return b().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:for(r=T.length,a=new Array(r),d=0;d<r;d++)a[d]=T[d];return x.next=3,D({variables:{ids:a}});case 3:return h=x.sent,o=h.data,x.abrupt("return",(o==null?void 0:o.deleteLandingStore)||0);case 6:case"end":return x.stop()}},n)})),[D]),L=(0,_.useCallback)(function(n){return(0,M.Z)(b().mark(function r(){var a,d;return b().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(n.length," \u4E2A\u95E8\u5E97\u5417\uFF1F"),o.next=3,s.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:a}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(d=o.sent,d.isConfirmed){o.next=6;break}return o.abrupt("return");case 6:return o.next=8,B.apply(void 0,(0,I.Z)(n));case 8:s.FN.success("\u95E8\u5E97\u6279\u91CF\u5220\u9664\u6210\u529F",2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return o.stop()}},r)}))},[B]),Y=(0,_.useMemo)(function(){return function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(s.zx,{color:"success",onClick:L(n),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},[L]);return(0,e.jsxs)(U.v,{footer:!1,children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap flex-stack pb-7",children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,e.jsxs)("h3",{className:"fw-bolder me-5",children:["\u95E8\u5E97 (",N,")"]}),(0,e.jsx)(s.II.Search,{onSearch:J,defaultValue:(p=m.filter)===null||p===void 0?void 0:p.name_contains,placeholder:"\u641C\u7D22",className:"border-body bg-body w-250px"})]}),(0,e.jsx)(K.Z,{children:(0,e.jsx)("div",{className:"d-flex my-0",children:(0,e.jsx)(s.zx,{as:O.Link,to:"/website/landing/stores/new",children:"\u65B0\u589E\u95E8\u5E97"})})})]}),!N&&!l?(0,e.jsx)(s.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(s.HY,{title:"\u8FD8\u6CA1\u6709\u95E8\u5E97",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u95E8\u5E97\u8BD5\u8BD5",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(s.zx,{as:O.Link,variant:"primary",to:"/website/landing/stores/new",children:"\u65B0\u589E\u95E8\u5E97"})})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(s.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(s.Zb.Body,{children:(0,e.jsx)(s.bH,{overlayClassName:"bg-white bg-opacity-25",loading:l,children:(0,e.jsx)(s.iA,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(r){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:r}),"\u4E2A\u95E8\u5E97"]})},toolbar:Y},noRowsRenderer:function(){return(0,e.jsx)(s.HY,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"code",title:"\u5E97\u53F7",sorter:!0,sortOrder:c.field=="code"?c.order:void 0,className:"w-80px"},{key:"name",title:"\u540D\u79F0",sorter:!0,sortOrder:c.field=="name"?c.order:void 0,render:function(r,a){return(0,e.jsx)("div",{children:(0,e.jsx)(O.Link,{className:"text-gray-700",to:"/website/landing/stores/".concat(a.id),children:r})})}},{key:"qrCode",title:"\u4E8C\u7EF4\u7801",className:"w-100px",render:function(r){return r?(0,e.jsx)("img",{src:"//api.asany.cn"+"/preview/".concat(r.id),className:"h-30px w-30px"}):(0,e.jsx)(w.JO,{className:"svg-icon-2qx text-muted",name:"Bootstrap/qr-code"})}},{key:"address.street",dataIndex:"address.fullAddress",title:"\u95E8\u5E97\u5730\u5740",className:"w-250px",sorter:!0,sortOrder:c.field=="location.street"?c.order:void 0},{key:"createdAt",title:"\u521B\u5EFA\u65F6\u95F4",className:"w-150px",sorter:!0,sortOrder:c.field=="createdAt"?c.order:void 0},{key:"actions",title:"\u64CD\u4F5C",className:"w-150px",render:function(r,a){return(0,e.jsx)(Z,{onDelete:B,history:v.history,data:a})}}],pagination:z,onChange:Q,dataSource:H})})})})})]})}P.default=$}}]);
