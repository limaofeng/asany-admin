"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5105],{14336:function(Q,O,n){var R=n(15009),E=n.n(R),_=n(99289),j=n.n(_),T=n(97857),h=n.n(T),C=n(5574),N=n.n(C),s=n(62435),d=n(79817),i=n(12708);function t(u,r){return u.replace(/{(\w+)}/g,function(m,l){return r[l]!==void 0?r[l]:m})}function o(u,r){var m=u(h()({fetchPolicy:"network-only"},(r==null?void 0:r.mutation)||{})),l=N()(m,1),M=l[0],a=(0,s.useRef)(!1),V=(0,s.useCallback)(function(){var e=j()(E()().mark(function U(v,P){var k,g,S,b,D,p,K,A,Z;return E()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return k=(P==null?void 0:P.dialog)||(r==null?void 0:r.dialog)||{},g=(P==null?void 0:P.mutation)||(r==null?void 0:r.mutation)||{},S=(P==null?void 0:P.onDeleted)||(r==null?void 0:r.onDeleted),b=k.width,D=k.title,p=k.content,K=!1,Array.isArray(v)?(K=!0,typeof D=="function"&&(D=D(v,{batch:!0})),typeof p=="function"&&(p=p(v,{batch:!0}))):v&&(typeof D=="string"&&(D=t(D,v)),typeof p=="string"&&(p=t(p,v)),typeof D=="function"&&(D=D(v,{batch:!1})),typeof p=="function"&&(p=p(v,{batch:!1}))),A=function(){var B=j()(E()().mark(function W(){return E()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,M(h()(h()({fetchPolicy:"network-only"},g),{},{variables:{where:{id_in:K?v:[v==null?void 0:v.id]}}}));case 2:case"end":return I.stop()}},W)}));return function(){return B.apply(this,arguments)}}(),w.next=10,d.Modal.confirm(h()(h()({},k),{},{title:D,content:p,width:b,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!a.current},preConfirm:function(){var B=j()(E()().mark(function G(){var I,H,Y;return E()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return a.current=!0,L.prev=1,I=document.querySelector(".swal2-confirm"),I.textContent="\u5220\u9664\u4E2D...",H=document.createElement("span"),H.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),I.appendChild(H),L.next=9,(0,i.gw)(A(),350);case 9:Y=L.sent,S&&S(Y);case 11:return L.prev=11,a.current=!1,L.finish(11);case 14:case"end":return L.stop()}},G,null,[[1,,11,14]])}));function W(){return B.apply(this,arguments)}return W}()}));case 10:if(Z=w.sent,Z.isConfirmed){w.next=13;break}return w.abrupt("return",!1);case 13:return d.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),w.abrupt("return",!0);case 15:case"end":return w.stop()}},U)}));return function(U,v){return e.apply(this,arguments)}}(),[]),z=(0,s.useCallback)(function(){var e=j()(E()().mark(function U(v,P){return E()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",V(v,P));case 1:case"end":return g.stop()}},U)}));return function(U,v){return e.apply(this,arguments)}}(),[r,M]),J=(0,s.useCallback)(function(e,U){return V(e,U)},[]);return{delete:z,deleteMany:J}}O.Z=o},58301:function(Q,O,n){n.d(O,{Oh:function(){return C},bp:function(){return N}});var R=n(97857),E=n.n(R),_=n(62435);function j(s,d){var i,t,o=s(E()({fetchPolicy:"network-only"},d)),u=o.data,r=o.loading,m=o.previousData,l=o.refetch,M=o.error,a=(0,_.useMemo)(function(){return r?m==null?void 0:m.result.pageInfo:u==null?void 0:u.result.pageInfo},[u==null||(i=u.result)===null||i===void 0?void 0:i.pageInfo.total,r,m==null||(t=m.result)===null||t===void 0?void 0:t.pageInfo.total]),V=(u==null?void 0:u.result.edges.map(function(z){return z.node}))||[];return[V,{loading:r,pageInfo:a,error:M,variables:{},refetch:l}]}function T(s,d){return d.split(".").reduce(function(i,t){return i&&i[t]!==void 0?i[t]:void 0},s)}function h(s,d,i){for(var t=d.split("."),o=s;t.length>1;){var u=t.shift();o[u]||(o[u]={}),o=o[u]}o[t[0]]=i}function C(s,d){var i=d.map(function(t){var o=t.source,u=t.target,r=t.transform,m=t.skip,l=T(s,o);if(l==null||m&&m(l))return"";var M=r?r(l):String(l);return"".concat(encodeURIComponent(u||o),"=").concat(encodeURIComponent(M))});return i.filter(function(t){return t}).join("&")}function N(s,d){var i={};return d.forEach(function(t){var o=t.source,u=t.target,r=t.transform,m=t.skip,l=s.get(o);if(!(!l||l.trim()==="")){var M=r?r(l):l;m&&m(M)||(u?h(i,u,M):i[o]=M)}}),i}O.ZP=j},70005:function(Q,O,n){var R=n(62435),E=n(96974),_=n(79817),j=n(86074);function T(h){var C=h.categoryId,N=h.append,s=(0,E.bx)(),d=s.rootCategoryId,i=s.categories,t=s.baseUrl,o=s.breadcrumbs,u=(0,R.useMemo)(function(){var r,m=i.find(function(l){return l.id===C});return((m==null||(r=m.path)===null||r===void 0?void 0:r.split("/"))||[]).map(function(l){return i.find(function(M){return M.id===l})}).filter(function(l){return l})},[i,C]);return(0,j.jsxs)(_.Breadcrumb,{className:"fw-bold fs-base text-muted my-1",children:[o.map(function(r){return(0,j.jsx)(_.Breadcrumb.Item,{href:r.url,children:r.title},r.title)}),u?(0,j.jsx)(j.Fragment,{children:u.filter(function(r){return r.id!==d}).map(function(r){return(0,j.jsx)(_.Breadcrumb.Item,{href:"".concat(t,"/categories/").concat(r.id,"/articles"),children:r.name},r.id)})}):(0,j.jsx)(_.Breadcrumb.Item,{children:"\u52A0\u8F7D\u4E2D..."}),N]})}O.Z=T},80537:function(Q,O,n){var R=n(14336),E=n(96944),_=n(86074);function j(T){var h=(0,R.Z)(E.nT,{onDeleted:function(){T&&T()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(d,i){var t;if(i.batch){var o=d;t="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(o.length," \u7BC7\u6587\u7AE0\u5417\uFF1F")}else t=(0,_.jsxs)(_.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,_.jsx)("strong",{children:d.title})]});return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("p",{className:"tip-confirm",children:t}),(0,_.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),C=h.delete,N=h.deleteMany;return{delete:C,deleteMany:N}}O.Z=j},85105:function(Q,O,n){n.r(O),n.d(O,{default:function(){return k}});var R=n(15009),E=n.n(R),_=n(99289),j=n.n(_),T=n(5574),h=n.n(T),C=n(62435),N=n(96974),s=n(39711),d=n(46027),i=n(93967),t=n.n(i),o=n(19755),u=n.n(o),r=n(30381),m=n.n(r),l=n(58301),M=n(73588),a=n(79817),V=n(70005),z=n(42646),J=n(80537),e=n(86074),U={DRAFT:{title:"\u8349\u7A3F",lightStyle:"danger"},PUBLISHED:{title:"\u5DF2\u53D1\u5E03"},SCHEDULED:{title:"\u8BA1\u5212",lightStyle:"primary"}};window._MoreshowOrhide=function(g){return u()(g).parent().siblings().show(),u()(g).parent().remove(),!1};function v(g){var S=g.data,b=g.refetch,D=g.baseUrl,p=(0,C.useState)(!1),K=h()(p,2),A=K[0],Z=K[1],X=(0,N.s0)(),w=(0,J.Z)(function(){return b()}),B=w.delete,W=(0,C.useCallback)(function(G){var I=G.key;I==="edit"?X("".concat(D,"/articles/").concat(S.id)):I==="delete"&&(Z(!1),B(S))},[B,S]);return(0,e.jsx)(a.Dropdown,{overlay:(0,e.jsxs)(a.Menu,{onClick:W,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(a.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(a.Menu.Item,{className:"px-3",children:"\u53D1\u5E03"},"publish"),(0,e.jsx)(a.Menu.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:Z,visible:A,children:(0,e.jsxs)(a.Button,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(d.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function P(){var g,S=(0,N.UO)(),b=S.cid,D=(0,N.bx)(),p=D.rootCategoryId,K=D.categories,A=D.baseUrl,Z=(0,N.s0)(),X=(0,s.lr)(),w=h()(X,1),B=w[0],W=(0,C.useMemo)(function(){return(0,l.bp)(B,[{source:"q",target:"keywords"}])},[B.get("q")]);(0,C.useState)({keywords:B.get("q")||""});var G=(0,C.useMemo)(function(){var y=(0,l.bp)(B,[{source:"q",target:"where.name_contains"},{source:"sex",target:"where.sex"},{source:"page",transform:function(c){return parseInt(c)}},{source:"per_page",transform:function(c){return parseInt(c)}},{source:"sort",target:"orderBy",transform:function(c){var $=c.split(":"),x=h()($,2),F=x[0],ne=x[1];return"".concat(F,"_").concat(ne)}}]);return y.where=y.where||{},y.where.category={id:b||p,subColumns:!0},y},[B.toString(),b,p]),I=(0,l.ZP)(z.gk,{variables:G,fetchPolicy:"network-only",skip:!p}),H=h()(I,2),Y=H[0],q=H[1],L=q.loading,ee=q.pageInfo,re=q.refetch,ae=(0,C.useCallback)(function(y,f,c){var $=(0,l.Oh)({searchForm:W,pagination:y,filters:f,sorter:c},[{source:"searchForm.keywords",target:"q",skip:function(F){return!F}},{source:"pagination.current",target:"page",skip:function(F){return F===1}},{source:"pagination.pageSize",target:"per_page",skip:function(F){return F===15}},{source:"sorter.field",target:"sort",transform:function(F){return"".concat(F,":").concat(c.order==="ascend"?"asc":"desc")}}]);Z(location.pathname+"?"+$,{replace:!0})},[W]),se=(0,J.Z)(function(){return re()}),te=se.deleteMany,ue=(0,C.useCallback)(function(y,f){return j()(E()().mark(function c(){return E()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,te(y,{dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:f.length>1?'\u60A8\u5373\u5C06\u5220\u9664\u4EE5\u4E0B\u6587\u7AE0:<ul className="py-2">'.concat(f.map(function(F,ne){return"<li ".concat(ne>=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 mb-1 fs-6"><span className="bullet bullet-dot me-2"></span><strong>').concat(F.title,"</strong></li>")}).join(""),`
                <li `).concat(f.length<=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 fs-6"><a href="javascript:void(0)" onClick="_MoreshowOrhide(this)">\u66F4\u591A</a></li></ul> '):(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:f[0].title}),"\u201D\u3002",(0,e.jsx)("br",{}),"\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})}});case 2:case"end":return x.stop()}},c)}))},[te]),le=(0,C.useCallback)(function(y){Z(location.pathname+(y?"?q="+y:""),{replace:!0})},[]);return(0,e.jsx)(M.vs,{loading:L,header:{title:(g=K.find(function(y){return y.id===b}))===null||g===void 0?void 0:g.name},breadcrumb:(0,e.jsx)(V.Z,{categoryId:b}),children:(0,e.jsx)("div",{className:"tab-content",children:(0,e.jsxs)(a.Card,{flush:!0,headerClassName:"mt-5",children:[(0,e.jsxs)(a.Card.Header,{className:"pt-8",children:[(0,e.jsx)(a.Card.Title,{className:"flex-column",children:(0,e.jsx)(a.Input.Search,{solid:!0,className:"w-250px",placeholder:"\u641C\u7D22\u6587\u7AE0",onSearch:le})}),(0,e.jsx)(a.Card.Toolbar,{children:(0,e.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,e.jsx)(a.Dropdown,{overlay:(0,e.jsxs)(a.Menu,{className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(a.Menu.Item,{className:"px-3",children:"\u6700\u65B0"},"edit"),(0,e.jsx)(a.Menu.Item,{className:"px-3",children:"\u6700\u665A"},"publish"),(0,e.jsx)(a.Menu.Item,{className:"px-3 actions-delete",children:"\u6700\u8FD1\u66F4\u65B0\u7684"},"delete"),(0,e.jsx)(a.Menu.Item,{className:"px-3 actions-delete",children:"\u70B9\u51FB\u91CF"},"delete")]}),placement:"bottomLeft",children:(0,e.jsx)(a.Button,{variant:"white",className:"me-3",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2",name:"Duotune/gen031"}),children:"\u6392\u5E8F: \u6700\u65B0"})}),(0,e.jsx)(a.Button,{as:s.rU,variant:"primary",className:"me-3",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),to:"".concat(A,"/categories/").concat(b,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]}),(0,e.jsx)(a.Card.Body,{className:"pt-0",children:ee!=null&&ee.total?(0,e.jsx)(a.Table,{rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(f){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:f}),"\u7BC7\u6587\u7AE0"]})},toolbar:function(f,c){return(0,e.jsx)("div",{children:(0,e.jsx)(a.Button,{color:"danger",onClick:ue(f,c),variant:!1,size:"sm",className:"px-4 py-2",children:"\u6279\u91CF\u5220\u9664"})})}},pagination:ee,dataSource:Y,onChange:ae,rowHeight:136,columns:[{title:"\u6807\u9898",dataIndex:"title",key:"title",render:function(f,c){var $;return(0,e.jsxs)("div",{className:"d-flex flex-row tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"d-flex flex-column align-items-start tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"meta-container no-selecto-drag",children:[(0,e.jsx)(s.rU,{to:"/xx/12",className:"user-message",children:"\u6797\u66AE\u6625"}),(0,e.jsx)("span",{className:"created-at",children:m()(c.createdAt).fromNow()}),(0,e.jsx)("div",{className:"category_list",children:c.categories.filter(function(x){return x.id!==p}).map(function(x){return(0,e.jsx)(s.rU,{to:"".concat(A,"/categories/").concat(x.id,"/articles"),className:"tag",children:x.name},x.id)})})]}),(0,e.jsx)(s.rU,{onClick:function(F){return F.stopPropagation()},to:"".concat(A,"/categories/").concat(b,"/articles/").concat(c.id),className:"mt-2 mb-2 text-gray-800 no-selecto-drag fs-4 text-hover-primary mb-1",children:f}),(0,e.jsx)("div",{className:t()("summary mb-2 w-100 tw-text-ellipsis tw-truncate w-100",{"pe-8":!c.image}),children:(0,e.jsx)("span",{className:"text-muted fs-base no-selecto-drag",children:c.summary||"\u6CA1\u6709\u4EFB\u4F55\u5185\u5BB9..."})}),(0,e.jsxs)("div",{className:"fs-base",children:[(0,e.jsxs)(s.rU,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(A,"/categories/").concat(b,"/articles/").concat(c.id),children:[(0,e.jsx)(d.ZP,{className:"svg-icon-4 me-2",name:"Bootstrap/eye"}),"41W"]}),(0,e.jsxs)(s.rU,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(A,"/categories/").concat(b,"/articles/").concat(c.id,"#comments"),children:[(0,e.jsx)(d.ZP,{className:"svg-icon-6 me-2",name:"Bootstrap/chat"}),"41W"]})]})]}),c.image&&(0,e.jsx)("div",{className:"px-8 d-flex align-items-end",children:(0,e.jsx)(a.Symbol,{className:"article-image",src:APP_CONFIG.STORAGE_URL+"/preview/".concat(($=c.image)===null||$===void 0?void 0:$.id)})})]})}},{title:"\u72B6\u6001",dataIndex:"status",width:120,render:function(f){return(0,e.jsx)(a.Badge,{light:!0,color:U[f].lightStyle,children:U[f].title})}},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(f,c){return(0,e.jsx)(v,{baseUrl:"".concat(A,"/categories/").concat(b),data:c,refetch:re})}}]}):(0,e.jsxs)(a.Empty,{title:"\u65B0\u589E\u6587\u7AE0",description:"\u8BE5\u680F\u76EE\u8FD8\u662F\u7A7A\u7684\uFF0C\u6CA1\u6709\u4EFB\u4F55\u6587\u7AE0",image:"/assets/media/illustrations/sigma-1/4.png",children:[(0,e.jsx)(a.Button,{as:s.rU,className:"me-2",variant:"light",to:"".concat(A,"/settings"),children:"\u67E5\u770B\u680F\u76EE\u4FE1\u606F"}),(0,e.jsx)(a.Button,{as:s.rU,variant:"primary",to:"".concat(A,"/categories/").concat(b,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]})})})}var k=P}}]);
