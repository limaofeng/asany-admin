"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7410],{65224:function(J,F,e){e.d(F,{Z:function(){return H}});var r=e(5574),N=e.n(r),h=e(67294),v=e(35090),$=e(93967),T=e.n($),Q=e(96486),o=e(85893),p=260,Z=768;function B(n){var l=n.minWidth,m=l===void 0?p:l,u=n.maxWidth,A=u===void 0?Z:u,j=n.collapsible,f=j===void 0?!0:j,U=n.children,g=n.className,t=n.onWidthChange,i=(0,h.useRef)({minimized:!1,width:n.width}),V=(0,h.useReducer)(function(d){return d+1},0),z=N()(V,2),C=z[1],w=(0,h.useMemo)(function(){return(0,Q.debounce)(function(){C()},10)},[]),_=(0,h.useCallback)(function(d){return f&&m-d>m/2||d<=30},[f,m]),X=(0,h.useCallback)(function(){i.current.minimized&&i.current.width>0&&(i.current.width=0)},[]),L=(0,h.useCallback)(function(d){i.current.width+=d,_(i.current.width)?i.current.minimized=!0:i.current.minimized=!1,w()},[w,_]),G=(0,h.useCallback)(function(){i.current.width=_(i.current.width)?0:Math.min(A,Math.max(m,i.current.width))},[_,A,m]),Y=(0,h.useCallback)(function(){i.current.minimized=!i.current.minimized,i.current.width||(i.current.width=m),w()},[w,m]),R=i.current,D=R.minimized,W=R.width,O=(0,h.useMemo)(function(){return Math.min(A,Math.max(m,W))},[A,m,W]);return(0,h.useEffect)(function(){t&&t(D?0:O)},[t,D,O]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"secondary_sidebar-resizer__mirror",style:{width:D?void 0:O}}),(0,o.jsxs)(v.w_,{className:T()("secondary_sidebar-resizer d-flex flex-column flex-lg-row",g,{"secondary_sidebar-resizer-minimized":D}),style:{width:D?void 0:O},onResizeStart:X,onResize:L,onResizeEnd:G,children:[f&&(0,o.jsxs)("button",{onClick:Y,className:T()("secondary_sidebar-resize-button",{collapsed:D,expanded:!D}),type:"button",children:[(0,o.jsx)("div",{className:"invisible-area"}),(0,o.jsx)("span",{className:"homemade-button",role:"presentation",children:(0,o.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",focusable:"false",role:"presentation",children:(0,o.jsx)("path",{d:"M10.294 9.698a.988.988 0 0 1 0-1.407 1.01 1.01 0 0 1 1.419 0l2.965 2.94a1.09 1.09 0 0 1 0 1.548l-2.955 2.93a1.01 1.01 0 0 1-1.42 0 .988.988 0 0 1 0-1.407l2.318-2.297-2.327-2.307z",fill:"currentColor",fillRule:"evenodd"})})})]}),(0,o.jsx)("div",{className:"secondary_sidebar-inner flex-column flex-lg-row-auto w-100 mb-10 mb-lg-0",children:U})]})]})}var H=B},79514:function(J,F,e){e.d(F,{AQ:function(){return r.AQ},Af:function(){return r.Af},G$:function(){return r.G$},I1:function(){return r.I1},KX:function(){return r.KX},Nq:function(){return r.Nq},P6:function(){return r.P6},Pw:function(){return r.Pw},WF:function(){return r.WF},Yw:function(){return r.Yw},ZO:function(){return r.ZO},_c:function(){return r._c},aA:function(){return r.aA},au:function(){return r.au},c9:function(){return r.c9},jS:function(){return r.jS},ko:function(){return r.ko},oM:function(){return r.oM},ot:function(){return r.ot},w4:function(){return r.w4},wp:function(){return r.wp}});var r=e(70694)},77410:function(J,F,e){e.r(F),e.d(F,{default:function(){return u}});var r=e(5574),N=e.n(r),h=e(67294),v=e(96974),$=e(46027),T=e(12845),Q=e(93967),o=e.n(Q),p=e(1861),Z=e(65224),B=e(89717),H=e(79514),n=e(66894),l=e(85893);function m(){var A=(0,v.TH)(),j=(0,v.s0)(),f=(0,v.bx)(),U=f.module,g=f.baseUrl,t=(0,h.useState)(!1),i=N()(t,2),V=i[0],z=i[1],C=(0,H.wp)({variables:{module:U.id},fetchPolicy:"cache-and-network"}),w=C.data,_=C.loading,X=w||{},L=X.models,G=L===void 0?[]:L,Y=(0,h.useCallback)(function(){z(!0)},[]),R=(0,h.useCallback)(function(){z(!1)},[]),D=(0,h.useCallback)(function(d){R(),j("".concat(g,"/schema/models/").concat(d.id))},[g,R,history]),W=(0,h.useCallback)(function(d){return function(){j("".concat(g,"/schema/models/").concat(d.id))}},[g,history]),O=(0,h.useMemo)(function(){var d=(0,v.LX)({path:"".concat(g,"/schema/models/:mid")},A.pathname);return d?"model_"+d.params.mid:(d=(0,v.LX)({path:"".concat(g,"/schema/models")},A.pathname),d?"model_overview":"")},[g,A.pathname]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.Z,{className:"module_secondary_sidebar",width:260,children:(0,l.jsxs)("div",{className:"h-100",children:[(0,l.jsx)("div",{className:"mx-2 p-5 mt-5",children:(0,l.jsx)("h3",{className:"fw-bold text-dark mx-0 mb-0",children:"\u7ED3\u6784\u5B9A\u4E49"})}),(0,l.jsx)(p.E,{className:"d-flex h-100 flex-column custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,l.jsxs)(B.Menu,{className:"px-7 menu-state-bg menu-title-gray-600 menu-icon-gray-400 menu-state-primary menu-state-icon-primary menu-state-bullet-primary menu-arrow-gray-500 fw-bold fs-6 my-5 my-lg-0",selectedKeys:O?[O]:[],accordion:!1,selectable:"AllMenu",fit:!0,children:[(0,l.jsxs)(B.Menu.Section,{className:"menu-section-container",sectionClassName:"d-flex align-items-center",children:[(0,l.jsxs)("span",{className:"menu-section text-muted text-uppercase fs-8 ls-1 flex-row-fluid",children:[(0,l.jsx)(T.Link,{to:"".concat(g,"/schema/models"),className:o()("menu-section__link cursor-pointer text-muted",{checked:O==="model_overview"}),children:"\u5B9E\u4F53"}),_&&" - \u52A0\u8F7D\u4E2D..."]}),(0,l.jsx)(B.Button,{icon:(0,l.jsx)($.JO,{style:{marginRight:".2rem"},name:"Duotune/arr087",className:""}),size:"sm",variant:"white",activeColor:"light",className:"px-3 me-n4",onClick:Y,children:"\u65B0\u589E"})]}),G.map(function(d){return(0,l.jsx)(B.Menu.Item,{onClick:W(d),children:d.name},"model_".concat(d.id))})]})})]})}),(0,l.jsx)(n.Z,{module:U,onSuccess:D,visible:V,onClose:R}),(0,l.jsx)(v.j3,{context:{module:U,baseUrl:g}})]})}var u=m},66894:function(J,F,e){var r=e(97857),N=e.n(r),h=e(15009),v=e.n(h),$=e(99289),T=e.n($),Q=e(5574),o=e.n(Q),p=e(67294),Z=e(93967),B=e.n(Z),H=e(91845),n=e(89717),l=e(30773),m=e(79514),u=e(85893);function A(j){var f=j.module,U=j.visible,g=j.onClose,t=j.data,i=j.onSuccess,V=(0,p.useState)("settings"),z=o()(V,2),C=z[0],w=z[1],_=n.Form.useForm(),X=(0,m.oM)(),L=o()(X,1),G=L[0],Y=(0,m.oM)(),R=o()(Y,1),D=R[0],W=(0,m.oM)(),O=o()(W,1),d=O[0],ce=(0,m.Pw)({refetchQueries:[{query:m.Yw,variables:{module:f.id}}]}),ee=o()(ce,2),ae=ee[0],ne=ee[1].loading,me=(0,m.ko)({refetchQueries:[{query:m.Yw,variables:{module:f.id}},{query:m.ZO,variables:{id:t==null?void 0:t.id}}]}),re=o()(me,2),se=re[0],te=re[1].loading,le=(0,p.useMemo)(function(){return ne||te},[ne,te]),k=(0,p.useMemo)(function(){return(f.code||"").split(".").map(function(s){return s.charAt(0).toUpperCase()+s.substring(1)}).join("")},[f]),K=(0,p.useMemo)(function(){return(f.code||"").replaceAll(".","_").toUpperCase()+"_"},[f]),he=(0,l.RO)(function(){var s=T()(v()().mark(function c(P,b,I){var y,E;return v()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!(t&&b===t.name)){M.next=2;break}return M.abrupt("return",!0);case 2:return M.next=4,G({variables:{moduleId:f.id,filter:{name:b}},fetchPolicy:"network-only",context:{fetchOptions:{signal:I}}});case 4:return y=M.sent,E=y.data,M.abrupt("return",!(E!=null&&E.models.length));case 7:case"end":return M.stop()}},c)}));return function(c,P,b){return s.apply(this,arguments)}}()),fe=(0,l.RO)(function(){var s=T()(v()().mark(function c(P,b,I){var y,E,x;return v()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(b){a.next=2;break}return a.abrupt("return",!0);case 2:if(y=k+b.charAt(0).toUpperCase()+b.substring(1),!(t&&y===t.code)){a.next=5;break}return a.abrupt("return",!0);case 5:return a.next=7,D({variables:{moduleId:f.id,filter:{code:y}},fetchPolicy:"network-only",context:{fetchOptions:{signal:I}}});case 7:return E=a.sent,x=E.data,a.abrupt("return",!(x!=null&&x.models.length));case 10:case"end":return a.stop()}},c)}));return function(c,P,b){return s.apply(this,arguments)}}()),ve=(0,l.RO)(function(){var s=T()(v()().mark(function c(P,b,I){var y,E,x,M;return v()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(E=K+(b||"").toUpperCase(),!(t&&E===((y=t.metadata)===null||y===void 0?void 0:y.databaseTableName))){S.next=3;break}return S.abrupt("return",!0);case 3:return S.next=5,d({variables:{moduleId:f.id,filter:{databaseTableName:E}},fetchPolicy:"network-only",context:{fetchOptions:{signal:I}}});case 5:return x=S.sent,M=x.data,S.abrupt("return",!(M!=null&&M.models.length));case 8:case"end":return S.stop()}},c)}));return function(c,P,b){return s.apply(this,arguments)}}()),ue=(0,p.useCallback)(function(s){return function(){w(s)}},[]),_e=(0,p.useCallback)(T()(v()().mark(function s(){var c,P,b,I,y,E,x;return v()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_.validateFields();case 2:if(c=a.sent,P=K+(c.databaseTableName||c.code).toUpperCase(),b=k+c.code.charAt(0).toUpperCase()+c.code.substring(1),a.prev=5,t){a.next=15;break}return a.next=9,ae({variables:{input:N()(N()({},c),{},{databaseTableName:P,code:b,features:["master","system-fields"],module:f.id})}});case 9:I=a.sent,y=I.data,n.Toast.success("\u5B9E\u4F53 \u201C".concat(c.name,"\u201D \u65B0\u589E\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0}),i(y==null?void 0:y.createModel),a.next=21;break;case 15:return a.next=17,se({variables:{id:t.id,input:N()(N()({},c),{},{databaseTableName:P,code:b,features:["master","system-fields"]})}});case 17:E=a.sent,x=E.data,n.Toast.success("\u5B9E\u4F53 \u201C".concat(c.name,"\u201D \u66F4\u65B0\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0}),i(x==null?void 0:x.updateModel);case 21:a.next=26;break;case 23:a.prev=23,a.t0=a.catch(5),n.Toast.error(a.t0.message,2e3,{placement:"bottom-end",progressBar:!0});case 26:case"end":return a.stop()}},s,null,[[5,23]])})),[k,ae,t,_,f.id,i,K,se]),be=(0,p.useState)(!0),ie=o()(be,2),oe=ie[0],ye=ie[1],Me=(0,p.useState)(!0),de=o()(Me,2),q=de[0],pe=de[1],Ee=(0,p.useCallback)(function(s){if(Object.hasOwn(s,"code")&&ye(!1),Object.hasOwn(s,"databaseTableName")&&pe(!1),Object.hasOwn(s,"name")&&oe){var c=(0,H.N9)(s.name,{toneType:"none",type:"array"}).join("");_.setFieldValue("code",c),q&&_.setFieldValue("databaseTableName",c.toUpperCase())}Object.hasOwn(s,"code")&&q&&_.setFieldValue("databaseTableName",s.code.toUpperCase())},[oe,q,_]);return(0,p.useEffect)(function(){if(t){var s;_.setFieldsValue(N()(N()({},t),{},{code:t.code.substring(k.length),databaseTableName:(s=t.metadata)===null||s===void 0||(s=s.databaseTableName)===null||s===void 0?void 0:s.substring(K.length)}))}},[k,t,_,K.length]),(0,u.jsxs)(n.Modal,{confirmLoading:le,maskClosable:!le,width:592,centered:!0,visible:U,closable:!1,onCancel:g,onOk:_e,children:[(0,u.jsx)(n.Modal.Header,{children:(0,u.jsx)("h4",{children:t?"\u7F16\u8F91\u5B9E\u4F53":"\u65B0\u589E\u5B9E\u4F53"})}),(0,u.jsx)(n.Modal.Body,{children:(0,u.jsxs)(n.Form,{form:_,onValuesChange:t?void 0:Ee,children:[(0,u.jsxs)("div",{className:"mb-5",children:[(0,u.jsx)(n.Button,{color:C!=="settings"&&"gray-700",variant:C==="settings"?"light-primary":!1,activeColor:C==="settings"?"light-primary":"secondary",className:"me-4 px-5",onClick:ue("settings"),children:"\u8BBE\u7F6E"}),(0,u.jsx)(n.Button,{color:C!=="advanced"&&"gray-700",variant:C==="advanced"?"light-primary":!1,activeColor:C==="advanced"?"light-primary":"secondary",className:"me-4 px-5",onClick:ue("advanced"),children:"\u9AD8\u7EA7"})]}),(0,u.jsxs)("div",{className:B()("modal-tabpane",{"d-none":C!=="settings"}),children:[(0,u.jsx)(n.Form.Item,{required:!1,className:"mb-5",name:"name",hasFeedback:!0,label:"\u663E\u793A\u540D\u79F0",help:"\u914D\u7F6E\u5B9E\u4F53\u65F6\u663E\u793A\u7684\u540D\u79F0, \u901A\u5E38\u4E3A\u4E2D\u6587",rules:[{required:!0,message:"\u663E\u793A\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"},{validator:he,message:"\u540D\u79F0\u91CD\u590D"}],children:(0,u.jsx)(n.Input,{solid:!0,boxClassName:"w-75"})}),(0,u.jsx)(n.Form.Item,{required:!1,className:"my-5",name:"code",label:"\u7F16\u7801",hasFeedback:!0,help:"\u7528\u4E8E\u901A\u8FC7 API \u8BBF\u95EE\u6B64\u5B9E\u4F53\u7684 ID, \u4E0D\u80FD\u4E3A\u4E2D\u6587",rules:[{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{pattern:/^([a-z])([a-z1-9])*(_([a-z1-9]+))*/i,message:"\u8BF7\u9075\u5FAA Java \u547D\u540D\u89C4\u8303"},{validator:fe,message:"\u7F16\u7801\u91CD\u590D"}],children:(0,u.jsx)(n.Input,{addonBefore:k,style:{textTransform:"capitalize"},solid:!0,boxClassName:"w-75"})}),(0,u.jsx)(n.Form.Item,{className:"mt-5",name:"description",label:"\u63CF\u8FF0",help:"\u4E3A\u5185\u5BB9\u7F16\u8F91\u8005\u548C API \u7528\u6237\u663E\u793A\u63D0\u793A",requiredMark:"optional",children:(0,u.jsx)(n.Input.TextArea,{className:"w-75",solid:!0,autoSize:{maxRows:4,minRows:2}})})]}),(0,u.jsx)("div",{className:B()("modal-tabpane",{"d-none":C!=="advanced"}),children:(0,u.jsx)(n.Form.Item,{className:"mb-5",name:"databaseTableName",label:"\u8868\u540D",hasFeedback:!0,help:"\u6620\u5C04\u5230\u6570\u636E\u5E93\u4E2D\u7684\u8868\u540D",rules:[{pattern:/(^_([A-Z0-9]_?)*$)|(^[A-Z](_?[A-Z0-9])*_?$)/i,message:"\u8BF7\u9075\u5FAA\u6570\u636E\u5E93\u547D\u540D\u89C4\u8303"},{validator:ve,message:"\u6570\u636E\u5E93\u8868\u540D\u91CD\u590D"}],children:(0,u.jsx)(n.Input,{solid:!0,addonBefore:K,boxClassName:"w-75",className:"text-uppercase"})})})]})})]})}F.Z=A}}]);
