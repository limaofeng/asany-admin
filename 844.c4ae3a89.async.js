(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[844],{14843:function(I,A,a){"use strict";a.d(A,{u7:function(){return u.u7},pM:function(){return u.pM},dP:function(){return u.dP},zR:function(){return u.zR},bo:function(){return u.bo},CF:function(){return u.CF},hT:function(){return u.hT},X4:function(){return u.X4},rq:function(){return u.rq},qb:function(){return u.qb},a$:function(){return u.a$},mp:function(){return u.mp},WE:function(){return u.WE},HC:function(){return u.HC},cT:function(){return B},Hr:function(){return k},r3:function(){return u.r3},bI:function(){return u.bI},A6:function(){return u.A6},LV:function(){return u.LV}});var u=a(8305),C=a(39428),R=a(3182),j=a(2824),E=a(67294),D=a(38671),m=a(85893);function t(e,l){var v,b=(0,u.rz)({variables:{id:e==null?void 0:e.id},refetchQueries:[{query:u.dP,variables:{id:e==null||(v=e.application)===null||v===void 0?void 0:v.id}}]}),h=(0,j.Z)(b,1),d=h[0],x=(0,E.useCallback)((0,R.Z)((0,C.Z)().mark(function _(){var y;return(0,C.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,D.u_.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u8DEF\u7531\u5417\uFF1F",content:(0,m.jsxs)(m.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,m.jsx)("strong",{children:e.name}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]}),okText:"\u5220 \u9664",okClassName:"btn-danger"});case 2:if(y=c.sent,!y.isConfirmed){c.next=8;break}return c.next=6,d();case 6:D.FN.success("\u5220\u9664\u6210\u529F"),l(e);case 8:case"end":return c.stop()}},_)})),[d,e,l]);return[x]}var B=t,P=a(11849),n=a(25496);function O(e,l){var v,b,h,d=D.l0.useForm(),x=(0,E.useState)(!1),_=(0,j.Z)(x,2),y=_[0],f=_[1],c=(0,u.X4)({fetchPolicy:"no-cache",refetchQueries:[{query:u.dP,variables:{id:e==null||(v=e.application)===null||v===void 0?void 0:v.id}}]}),p=(0,j.Z)(c,1),i=p[0],o=(0,u.LV)({fetchPolicy:"no-cache",refetchQueries:[{query:u.dP,variables:{id:e==null||(b=e.application)===null||b===void 0?void 0:b.id}}]}),M=(0,j.Z)(o,1),g=M[0],T=(0,E.useMemo)(function(){return e!=null&&e.id?(0,R.Z)((0,C.Z)().mark(function N(){var F,s,Z;return(0,C.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return f(!0),r.prev=1,r.next=4,d.validateFields();case 4:return F=r.sent,r.next=7,D.FN.promise((0,n.gw)(g({variables:{id:e.id,input:(0,P.Z)({},F)}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,m.jsxs)(m.Fragment,{children:["\u8DEF\u7531 ",(0,m.jsx)("strong",{children:F.name})," \u4FDD\u5B58\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:s=r.sent,Z=s.data,l(Z.updateRoute),f(!1),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(1),f(!1);case 16:case"end":return r.stop()}},N,null,[[1,13]])})):(0,R.Z)((0,C.Z)().mark(function N(){var F,s,Z;return(0,C.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return f(!0),r.prev=1,r.next=4,d.validateFields();case 4:return F=r.sent,r.next=7,D.FN.promise((0,n.gw)(i({variables:{input:(0,P.Z)((0,P.Z)({},F),{},{application:e.application.id})}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,m.jsxs)(m.Fragment,{children:["\u8DEF\u7531 ",(0,m.jsx)("strong",{children:F.name})," \u65B0\u589E\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:s=r.sent,Z=s.data,l(Z.createRoute),f(!1),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(1),f(!1);case 16:case"end":return r.stop()}},N,null,[[1,13]])}))},[i,e==null||(h=e.application)===null||h===void 0?void 0:h.id,e==null?void 0:e.id,d,l,g]);return[T,{form:d,submitting:y}]}var k=O},70844:function(I,A,a){"use strict";a.r(A);var u=a(11849),C=a(39428),R=a(3182),j=a(2824),E=a(67294),D=a(28865),m=a(18071),t=a(38671),B=a(14843),P=a(25496),n=a(85893);function O(e){var l=e.data,v=e.refetch,b=e.onEdit,h=(0,E.useState)(!1),d=(0,j.Z)(h,2),x=d[0],_=d[1],y=(0,B.rq)({variables:{id:l.id}}),f=(0,j.Z)(y,1),c=f[0],p=(0,E.useCallback)(function(){var i=(0,R.Z)((0,C.Z)().mark(function o(M){var g,T,N;return(0,C.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(g=M.key,T=M.domEvent,T.preventDefault(),T.stopPropagation(),_(!1),g!=="update"){s.next=8;break}b(l),s.next=17;break;case 8:if(g!=="delete"){s.next=17;break}return s.next=11,t.u_.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u83DC\u5355\u5417\uFF1F",content:"\u60A8\u5373\u5C06\u5220\u9664\u201C<strong>".concat(l.name,"</strong>\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"),okText:"\u5220 \u9664",cancelClassName:"btn btn-secondary btn-sm",okClassName:"btn btn-danger btn-sm"});case 11:if(N=s.sent,!N.isConfirmed){s.next=17;break}return s.next=15,c();case 15:return s.next=17,v();case 17:case"end":return s.stop()}},o)}));return function(o){return i.apply(this,arguments)}}(),[l]);return(0,n.jsx)("div",{className:"d-flex justify-content-end",children:(0,n.jsx)("div",{className:"ms-2",children:(0,n.jsx)(t.Lt,{overlay:(0,n.jsxs)(t.v2,{onClick:p,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,n.jsx)(t.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"update"),(0,n.jsx)(t.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:_,visible:x,children:(0,n.jsx)(t.zx,{as:"button",size:"sm",variant:"light",activeColor:"light-primary",className:"me-2",icon:(0,n.jsx)(D.JO,{className:"svg-icon-5 m-0",name:"Duotune/gen052"})})})})})}function k(e){var l,v=e.match;console.log("match",v.params);var b=352,h=(0,B.a$)({variables:{id:b}}),d=h.data,x=h.refetch,_=d==null||(l=d.app)===null||l===void 0?void 0:l.menus,y=(0,E.useMemo)(function(){return(0,P.G_)((_||[]).map(function(p){return(0,u.Z)({},p)}),{pidKey:"parent.id",sort:function(i,o){return i.index-o.index},converter:function(i){return(0,u.Z)((0,u.Z)({},i),{},{key:i.id,title:i.name,menuType:i.type,type:"directory"})}})},[_]),f=(0,E.useCallback)(function(){},[]),c=(0,E.useCallback)(function(){},[]);return(0,n.jsx)(m.vs,{header:{title:"\u5BFC\u822A\u83DC\u5355"},breadcrumb:(0,n.jsxs)(t.aG,{className:"fw-bold fs-base text-muted my-1",children:[(0,n.jsx)(t.aG.Item,{children:"\u8BBE\u7F6E"}),(0,n.jsx)(t.aG.Item,{children:"\u5BFC\u822A\u83DC\u5355"})]}),loading:!1,footer:!1,children:(0,n.jsxs)(t.Zb,{flush:!0,className:"mt-6 mt-xl-9",headerClassName:"mt-5",children:[(0,n.jsxs)(t.Zb.Header,{className:"pt-8",children:[(0,n.jsx)(t.Zb.Title,{}),(0,n.jsx)(t.Zb.Toolbar,{children:(0,n.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,n.jsx)(t.zx,{variant:"danger",className:"me-3",children:"\u5220\u9664"}),(0,n.jsx)(t.zx,{onClick:f,variant:"primary",children:"\u65B0\u5EFA\u83DC\u5355"})]})})]}),(0,n.jsx)(t.Zb.Body,{className:"pt-0",children:(0,n.jsx)(t.N4,{className:"app-treelist",rowKey:"id",draggable:!0,columns:[{key:"title",title:"\u540D\u79F0",render:function(i,o){var M={SECTION:{color:"info"},URL:{color:"primary"},MENU:{color:"success"},SCRIPT:{color:"dark"}};return(0,n.jsxs)("div",{className:"d-flex flex-column py-5",children:[(0,n.jsx)("span",{className:"title text-gray-800 text-hover-primary mb-1 fs-6",children:o.title}),(0,n.jsxs)("div",{className:"d-flex flex-row col-stacked",children:[(0,n.jsx)(t.Ct,{color:M[o.menuType].color,children:o.menuType}),(0,n.jsx)("span",{className:"tw-pl-2",children:o.path})]})]})}},{key:"index",title:"\u6392\u5E8F",className:"w-100px"},{key:"enabled",title:"\u542F\u7528\u72B6\u6001",className:"w-100px",render:function(i){return i?"\u542F\u7528":"\u7981\u7528"}},{key:"component",title:"\u5B50\u9762\u677F\u6E32\u67D3\u7EC4\u4EF6",className:"w-150px",render:function(i,o){return o.component?"\u6709\u7EC4\u4EF6":"\u65E0\u7EC4\u4EF6"}},{key:"actions",title:"\u64CD\u4F5C",className:"min-w-125px",render:function(i,o){return(0,n.jsx)(O,{onEdit:c,data:o,refetch:x})}}],dataSource:y})})]})})}A.default=k}}]);
