(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[6529],{66529:function(q,D,t){"use strict";t.r(D);var i=t(11849),T=t(93224),C=t(3182),j=t(2824),R=t(94043),g=t.n(R),x=t(67294),v=t(81303),k=t(75468),a=t(11974),e=t(85893);function U(A){var P,_=A.match,d=A.history,W=(0,v.ZL)({fetchPolicy:"cache-and-network",variables:{pageSize:1e3}}),b=W.data,K=(0,v.Nd)({fetchPolicy:"cache-and-network",variables:{pageSize:1e3}}),E=K.data,V=(0,v.V_)({fetchPolicy:"cache-and-network"}),B=(0,j.Z)(V,2),I=B[0],M=B[1],y=M.data,N=M.loading,z=(0,v.mp)({}),L=(0,j.Z)(z,2),O=L[0],$=L[1].loading,Q=(0,v.qV)({}),Z=(0,j.Z)(Q,2),S=Z[0],H=Z[1].loading,c=_.params.id=="new",h=a.l0.useForm(),X=(0,x.useCallback)((0,C.Z)(g().mark(function u(){var s,l,n,o;return g().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,h.validateFields();case 2:if(s=r.sent,l=s.start,n=s.end,o=(0,T.Z)(s,["start","end"]),!c){r.next=11;break}return r.next=9,O({variables:{input:(0,i.Z)((0,i.Z)({},o),{},{start:l&&l.isValid()?l.toString():void 0,end:n&&n.isValid()?n.toString():void 0})}});case 9:r.next=13;break;case 11:return r.next=13,S({variables:{id:_.params.id,input:(0,i.Z)((0,i.Z)({},o),{},{start:l&&l.isValid()?l.toString():void 0,end:n&&n.isValid()?n.toString():void 0})}});case 13:a.FN.success("\u6D3B\u52A8 \u201C".concat(o.name,"\u201D ").concat(c?"\u65B0\u589E":"\u4FEE\u6539","\u6210\u529F"),2e3,{placement:"bottom-start",progressBar:!0}),d.length?d.goBack():d.replace("/website/landing/pages");case 15:case"end":return r.stop()}},u)})),[O,_.params.id,h,d,c,S]);(0,x.useEffect)(function(){if(_.params.id!="new"){var u=new AbortController;return I({variables:{id:_.params.id},context:{fetchOptions:{signal:u.signal}}}).then(function(){var s=(0,C.Z)(g().mark(function l(n){var o,f,r,w,F,m;return g().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(F=n.data,m=F==null?void 0:F.page,m){p.next=7;break}return p.next=5,a.u_.error({content:"\u6D3B\u52A8\u4E0D\u5B58\u5728,\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5220\u9664\u4E86",timer:3e3,timerProgressBar:!0});case 5:return d.length?d.goBack():d.replace("/website/landing/pages"),p.abrupt("return");case 7:h.setFieldsValue((0,i.Z)((0,i.Z)({},m),{},{metadata:(0,i.Z)((0,i.Z)({},m.metadata),{},{thumb:(o=m.metadata)===null||o===void 0||(f=o.thumb)===null||f===void 0?void 0:f.id}),poster:(r=m.poster)===null||r===void 0?void 0:r.id,stores:(w=m.stores)===null||w===void 0?void 0:w.map(function(Y){return Y.id})}));case 8:case"end":return p.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()),function(){u.abort()}}},[h,I,d,_.params.id]);var G=(0,x.useMemo)(function(){return b==null?void 0:b.landingStores.edges.map(function(u){var s=u.node;return{value:s.id,label:s.name}})},[b]),J=(0,x.useMemo)(function(){return E==null?void 0:E.landingPosters.edges.map(function(u){var s=u.node;return{value:s.id,label:s.name}})},[E]);return(0,e.jsx)(k.v,{header:c?{title:"\u65B0\u589E\u6D3B\u52A8"}:void 0,footer:!1,children:(0,e.jsxs)(a.Zb,{className:"mb-5 mb-xl-10",children:[(0,e.jsx)(a.Zb.Header,{children:(0,e.jsx)(a.Zb.Title,{children:c?"\u65B0\u589E\u6D3B\u52A8":y==null||(P=y.page)===null||P===void 0?void 0:P.name})}),(0,e.jsxs)(a.Zb.Body,{children:[(0,e.jsx)(a.bH,{zIndex:10,overlayClassName:"bg-white bg-opacity-25",loading:N,children:(0,e.jsxs)(a.l0,{form:h,children:[(0,e.jsxs)("div",{className:"mw-800px row d-flex flex-shrink-0 flex-column-reverse flex-md-row",children:[(0,e.jsxs)("div",{className:"col-12 col-md-8",children:[(0,e.jsx)(a.l0.Item,{className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(a.II,{solid:!0,className:"w-400px"})}),(0,e.jsx)(a.l0.Item,{className:"my-5",name:"poster",label:"\u6D77\u62A5",children:(0,e.jsx)(a.ub,{solid:!0,className:"w-400px",options:J})}),(0,e.jsx)(a.l0.Item,{className:"my-5",name:"stores",label:"\u53C2\u52A0\u6D3B\u52A8\u7684\u95E8\u5E97",children:(0,e.jsx)(a.ub,{solid:!0,multiple:!0,className:"w-400px",options:G})}),(0,e.jsx)(a.l0.Item,{className:"my-5",name:"start",label:"\u5F00\u59CB\u65F6\u95F4",children:(0,e.jsx)(a.Mt,{solid:!0,className:"w-400px"})}),(0,e.jsx)(a.l0.Item,{dependencies:["start"],noStyle:!0,children:function(){return(0,e.jsx)(a.l0.Item,{className:"my-5",name:"end",label:"\u622A\u6B62\u65F6\u95F4",children:(0,e.jsx)(a.Mt,{solid:!0,minDate:h.getFieldValue("start"),className:"w-400px"})})}}),(0,e.jsx)(a.l0.Item,{className:"my-5",name:"description",label:"\u63CF\u8FF0",help:"\u8BF7\u7528\u5C11\u4E8E250\u5B57\u7B26\u63CF\u8FF0",children:(0,e.jsx)(a.II.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:8},showCount:!0,maxLength:250,className:"w-400px"})})]}),(0,e.jsx)("div",{className:"col-12 col-md-4",children:(0,e.jsx)(a.AS.iPhoneX,{children:(0,e.jsx)(a.l0.Item,{dependencies:["poster","stores"],noStyle:!0,children:function(s){var l=s.getFieldValue("poster"),n=s.getFieldValue("stores");return(0,e.jsx)("iframe",{src:"//47.103.119.188:8002"+"/lps/0?&poster=".concat(l,"&stores=").concat(n==null?void 0:n.join(",")),style:{width:"100%",height:"100%"}})}})})})]}),(0,e.jsxs)("div",{className:"row",children:[(0,e.jsx)("h4",{className:"mt-10",children:"HTML \u9875\u9762\u5143\u6570\u636E"}),(0,e.jsx)(a.Z0,{className:"mt-4 mb-8"}),(0,e.jsxs)("div",{className:"mw-800px row d-flex flex-shrink-0 flex-column-reverse flex-md-row",children:[(0,e.jsxs)("div",{className:"col-12 col-md-8",children:[(0,e.jsx)(a.l0.Item,{className:"my-5 w-400px",name:["metadata","title"],label:"\u6807\u9898",help:"\u53EF\u4F5C\u4E3A\u5FAE\u4FE1\u5206\u4EAB\u65F6,\u7684\u6807\u9898",children:(0,e.jsx)(a.II,{solid:!0,className:""})}),(0,e.jsx)(a.l0.Item,{className:"my-5 w-400px",name:["metadata","description"],label:"\u63CF\u8FF0",help:"\u8BF7\u7528\u5C11\u4E8E250\u5B57\u7B26\u63CF\u8FF0,\u53EF\u4F5C\u4E3A\u5FAE\u4FE1\u5206\u4EAB\u65F6\u7684\u526F\u6807\u9898",children:(0,e.jsx)(a.II.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:8},showCount:!0,maxLength:250})})]}),(0,e.jsx)("div",{className:"col-12 col-md-4",children:(0,e.jsx)(a.l0.Item,{className:"mb-5",name:["metadata","thumb"],label:"\u7F29\u7565\u56FE",help:"\u53EF\u4F5C\u4E3A\u5FAE\u4FE1\u5206\u4EAB\u65F6\u7684\u56FE\u7247",children:(0,e.jsx)(a.gq.Image,{width:250,height:250,space:"orX8kLOV",crop:{height:300,zoomable:!1,aspectRatio:1}})})})]})]})]})}),(0,e.jsx)(a.zx,{loading:N||$||H,onClick:X,children:c?(0,e.jsx)(e.Fragment,{children:"\u6DFB\u52A0\u6D3B\u52A8"}):(0,e.jsx)(e.Fragment,{children:"\u4FEE\u6539\u6D3B\u52A8"})})]})]})})}D.default=U}}]);
