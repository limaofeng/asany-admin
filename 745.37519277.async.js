(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[745],{50480:function(W,O,s){"use strict";var N=s(28865),A=s(51248),m=s(85893);function h(x){var d=x.layout,F=x.children,f=x.onLayout;return(0,m.jsxs)("div",{className:"d-flex flex-wrap my-1",children:[d&&(0,m.jsxs)("ul",{className:"nav nav-pills me-6 mb-2 mb-sm-0",children:[(0,m.jsx)("li",{className:"nav-item m-0 me-3",children:(0,m.jsx)(A.Z,{variant:"light",color:"muted",active:d=="card",activeColor:"primary",onClick:f==null?void 0:f.bind(null,"card"),icon:(0,m.jsx)(N.ZP,{name:"Duotune/gen024",className:"svg-icon-1"})})}),(0,m.jsx)("li",{className:"nav-item m-0",children:(0,m.jsx)(A.Z,{variant:"light",color:"muted",active:d=="table",onClick:f==null?void 0:f.bind(null,"table"),activeColor:"primary",className:"me-3",icon:(0,m.jsx)(N.ZP,{name:"Duotune/abs015",className:"svg-icon-1"})})})]}),F]})}O.Z=h},80745:function(W,O,s){"use strict";s.r(O);var N=s(86582),A=s(2824),m=s(93224),h=s(39428),x=s(3182),d=s(67294),F=s(28865),f=s(80129),w=s.n(f),k=s(73727),T=s(250),K=s(50480),$=s(18071),t=s(51186),S=s(88097),e=s(85893),z=["q"];function H(_){var y=_.data,g=_.baseUrl,p=_.history,D=_.onDelete,C=(0,d.useCallback)(function(){var b=(0,x.Z)((0,h.Z)().mark(function L(M){var B,j;return(0,h.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return B="\u786E\u5B9A\u5220\u9664\u6D77\u62A5 \u201C".concat(M.name,"\u201D \u5417\uFF1F"),u.next=3,t.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:B}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(j=u.sent,j.isConfirmed){u.next=6;break}return u.abrupt("return");case 6:return u.next=8,D(M.id);case 8:t.FN.success("\u6D77\u62A5 \u201C".concat(M.name,"\u201D \u5220\u9664\u6210\u529F"),2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return u.stop()}},L)}));return function(L){return b.apply(this,arguments)}}(),[D]),v=(0,d.useCallback)(function(b){b.key=="view"?p.push("".concat(g,"/").concat(y.id)):b.key=="delete"&&C(y)},[g,y,C,p]);return(0,e.jsx)(t.Lt,{overlay:(0,e.jsxs)(t.v2,{onClick:v,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold fs-8 w-125px py-4",children:[(0,e.jsx)(t.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"view"),(0,e.jsx)(t.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",children:(0,e.jsxs)(t.zx,{className:"fs-8",variant:"light",activeColor:"light-primary",children:["\u64CD\u4F5C",(0,e.jsx)(F.JO,{className:"svg-icon-5 ms-2 me-n1",name:"Duotune/arr072"})]})})}function J(_){var y,g,p=_.history,D=_.location,C=D.pathname,v=(0,d.useMemo)(function(){var a=_.location.query,n=a.q,r=(0,m.Z)(a,z);return n&&(r.filter={name_contains:n}),r},[_.location]),b=(0,d.useMemo)(function(){if(!v.orderBy)return{order:"descend",field:"createdAt"};var a=v.orderBy.split("_"),n=(0,A.Z)(a,2),r=n[0],c=n[1];return{order:c=="desc"?"descend":"ascend",field:r}},[v.orderBy]),L=(0,T.a7)({refetchQueries:[T.my]}),M=(0,A.Z)(L,1),B=M[0],j=(0,T.Nd)({fetchPolicy:"cache-and-network",variables:v}),l=j.data,u=j.loading,i=j.previousData,I=(0,d.useMemo)(function(){return u?(i==null?void 0:i.total.totalCount)||0:(l==null?void 0:l.total.totalCount)||0},[l==null?void 0:l.total.totalCount,u,i==null?void 0:i.total]),Q=(0,d.useMemo)(function(){return u?(i==null?void 0:i.landingPosters)||{total:0,current:1}:(l==null?void 0:l.landingPosters)||{total:0,current:1}},[l==null?void 0:l.landingPosters,u,i==null?void 0:i.landingPosters]),Y=(0,d.useMemo)(function(){var a;if(u){var n;return((i==null||(n=i.landingPosters)===null||n===void 0?void 0:n.edges)||[]).map(function(r){return r.node})}return((l==null||(a=l.landingPosters)===null||a===void 0?void 0:a.edges)||[]).map(function(r){return r.node})},[l==null?void 0:l.landingPosters,u,i==null?void 0:i.landingPosters]),G=(0,d.useCallback)(function(a){p.replace(D.pathname+"?"+w().stringify({q:a}))},[p,D.pathname]),V=(0,d.useCallback)(function(a,n,r){var c,E={};if((c=v.filter)!==null&&c!==void 0&&c.name_contains){var o;E.q=(o=v.filter)===null||o===void 0?void 0:o.name_contains}r&&(E.orderBy=r.field+"_"+(r.order=="ascend"?"asc":"desc")),E.page=a.current,p.replace(D.pathname+"?"+w().stringify(E))},[p,D.pathname,(y=v.filter)===null||y===void 0?void 0:y.name_contains]),U=(0,d.useCallback)((0,x.Z)((0,h.Z)().mark(function a(){var n,r,c,E,o,Z=arguments;return(0,h.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:for(n=Z.length,r=new Array(n),c=0;c<n;c++)r[c]=Z[c];return P.next=3,B({variables:{ids:r}});case 3:return E=P.sent,o=E.data,P.abrupt("return",(o==null?void 0:o.deleteLandingPoster)||0);case 6:case"end":return P.stop()}},a)})),[B]),R=(0,d.useCallback)(function(a){return(0,x.Z)((0,h.Z)().mark(function n(){var r,c;return(0,h.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return r="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(a.length," \u4E2A\u6D77\u62A5\u5417\uFF1F"),o.next=3,t.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:r}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(c=o.sent,c.isConfirmed){o.next=6;break}return o.abrupt("return");case 6:return o.next=8,U.apply(void 0,(0,N.Z)(a));case 8:t.FN.success("\u6D77\u62A5\u6279\u91CF\u5220\u9664\u6210\u529F",2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return o.stop()}},n)}))},[U]),X=(0,d.useMemo)(function(){return function(a){return(0,e.jsx)("div",{children:(0,e.jsx)(t.zx,{color:"success",onClick:R(a),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},[R]);return(0,e.jsxs)($.v,{footer:!1,children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap flex-stack pb-7",children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,e.jsxs)("h3",{className:"fw-bolder me-5",children:["\u6D77\u62A5 (",I,")"]}),(0,e.jsx)(t.II.Search,{placeholder:"\u641C\u7D22",onSearch:G,defaultValue:(g=v.filter)===null||g===void 0?void 0:g.name_contains,className:"border-body bg-body w-250px"})]}),(0,e.jsx)(K.Z,{children:(0,e.jsx)("div",{className:"d-flex my-0",children:(0,e.jsx)(t.zx,{as:k.Link,to:"".concat(C,"/new"),children:"\u65B0\u5EFA\u6D77\u62A5"})})})]}),!I&&!u?(0,e.jsx)(t.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(t.HY,{title:"\u8FD8\u6CA1\u6709\u6D77\u62A5",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u6D77\u62A5\u8BD5\u8BD5",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(t.zx,{as:k.Link,variant:"primary",to:"".concat(C,"/new"),children:"\u65B0\u5EFA\u6D77\u62A5"})})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(t.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(t.Zb.Body,{children:(0,e.jsx)(t.bH,{overlayClassName:"bg-white bg-opacity-25",loading:u,children:(0,e.jsx)(t.iA,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(n){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:n}),"\u4E2A\u6D77\u62A5"]})},toolbar:X},noRowsRenderer:function(){return(0,e.jsx)(t.HY,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"name",title:"\u540D\u79F0",sorter:!0,sortOrder:b.field=="name"?b.order:void 0,render:function(n,r){return(0,e.jsx)("div",{className:"ps-2",children:(0,e.jsx)(k.Link,{className:"text-gray-700",to:"".concat(C,"/").concat(r.id),children:n})})}},{key:"background",title:"\u80CC\u666F\u56FE",width:100,render:function(n){return n?(0,e.jsx)("div",{className:"d-flex w-30px justify-content-center",children:(0,e.jsx)("img",{src:"https://api.asany.cn/graphql"+"/preview/".concat(n.id),className:"h-30px w-20px"})}):(0,e.jsx)(F.JO,{className:"svg-icon-2qx text-muted",name:"Bootstrap/file-image"})}},{key:"music",title:"\u80CC\u666F\u97F3\u4E50",width:"20%",render:function(n){return(0,e.jsx)("div",{className:"d-flex list-music-preview",children:n?(0,e.jsx)(S.B,{uploadFile:n,status:"completed"}):"\u65E0"})}},{key:"actions",title:"\u64CD\u4F5C",width:100,render:function(n,r){return(0,e.jsx)(H,{baseUrl:C,onDelete:U,history:_.history,data:r})}}],pagination:Q,onChange:V,dataSource:Y})})})})})]})}O.default=J}}]);
