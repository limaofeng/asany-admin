var me=Object.prototype.hasOwnProperty;var ee=Object.getOwnPropertySymbols,ve=Object.prototype.propertyIsEnumerable;var G=Object.assign;var ae=(L,P)=>{var n={};for(var s in L)me.call(L,s)&&P.indexOf(s)<0&&(n[s]=L[s]);if(L!=null&&ee)for(var s of ee(L))P.indexOf(s)<0&&ve.call(L,s)&&(n[s]=L[s]);return n};(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[8033,3975],{33201:function(){},34106:function(L,P,n){"use strict";n.d(P,{GP:function(){return s.Z},Hk:function(){return l.ZP}});var s=n(48655),x=n(39981),l=n(21428),h=n(53851)},70800:function(L,P,n){"use strict";n.r(P),n.d(P,{default:function(){return de}});var s=n(11849),x=n(2824),l=n(67294),h=n(28865),U=n(1861),R=n(51615),X=n(73727),A=n(32669),M=n(88403),w=n(91220),S=n(39428),T=n(3182),z=n(22028),_=n(94184),J=n.n(_),W=n(96486),t=n(51186),e=n(85893),Q=n(34155);function H(o){var E=o.onClose,b=o.visible,d=o.user,v=o.namespace,f=o.name,p=o.mode,B=(0,A.hI)(),u=(0,x.Z)(B,1),O=u[0],m=t.l0.useForm(),D=(0,l.useRef)(null);(0,l.useEffect)(function(){var Z;!b||(m.setFieldsValue({name:f}),(Z=D.current)===null||Z===void 0||Z.focus(),Q.nextTick(function(){var j;(j=D.current)===null||j===void 0||j.select()}))},[b]);var y=(0,l.useCallback)((0,T.Z)((0,S.Z)().mark(function Z(){var j;return(0,S.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,m.validateFields();case 2:if(j=i.sent,p!="create"){i.next=6;break}return i.next=6,O({variables:{name:j.name,namespace:v}});case 6:E();case 7:case"end":return i.stop()}},Z)})),[m,p,E,O,v]),g=(0,l.useCallback)(function(){E()},[E]);return(0,e.jsxs)(t.u_,{centered:!0,visible:b,dialogClassName:"modal-dialog-small w-400px",onCancel:g,onOk:y,header:!1,closable:!1,okButtonProps:{className:"btn-xs"},cancelButtonProps:{className:"btn-xs"},children:[(0,e.jsxs)("div",{className:"modal-dialog-header d-flex",children:[(0,e.jsx)("div",{className:"modal-dialog-icon",children:(0,e.jsx)(h.JO,{className:"svg-icon-5x",name:"Duotune/fil012"})}),(0,e.jsxs)("div",{className:"modal-dialog-instructions",children:[(0,e.jsx)("div",{className:"modal-dialog-title",children:p=="create"?"\u65B0\u5EFA\u6587\u4EF6\u5939":"\u4FEE\u6539\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"modal-dialog-description",children:p=="create"?(0,e.jsxs)(e.Fragment,{children:['\u4E3A\u8D26\u53F7 " ',d,' " \u521B\u5EFA\u9876\u5C42\u6587\u4EF6\u5939']}):(0,e.jsxs)(e.Fragment,{children:['\u4FEE\u6539\u8D26\u53F7 " ',d,' " \u4E2D ',f," \u6587\u4EF6\u5939\u7684\u540D\u79F0"]})})]})]}),(0,e.jsx)(t.l0,{form:m,layout:"horizontal",initialValues:{name:f},size:"xs",children:(0,e.jsx)("div",{className:"d-flex last flex-row flex-center",children:(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(t.l0.Item,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u5B57"}],name:"name",label:"\u540D\u79F0",children:(0,e.jsx)(t.II,{ref:D})})})})})]})}var V=H;function ne(o){var E=o.user,b=o.onSuccess,d=o.selectedKey,v=(0,l.useState)(),f=(0,x.Z)(v,2),p=f[0],B=f[1],u=(0,l.useCallback)(function(){B(void 0)},[]),O=(0,l.useCallback)((0,T.Z)((0,S.Z)().mark(function D(){return(0,S.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:B("#custom"),b();case 2:case"end":return g.stop()}},D)})),[b]),m=(0,l.useCallback)((0,T.Z)((0,S.Z)().mark(function D(){return(0,S.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:console.log(d),b();case 2:case"end":return g.stop()}},D)})),[d,b]);return(0,e.jsxs)("div",{className:"settings-mailbox-footer",children:[(0,e.jsx)("a",{onClick:O,children:(0,e.jsx)(h.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:m,children:(0,e.jsx)(h.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})}),(0,e.jsx)(V,{mode:"create",visible:!!p,user:E,namespace:p,onClose:u})]})}var se=ne,q=[{key:"#private",title:"\u9ED8\u8BA4\u6587\u4EF6\u5939",children:[]},{key:"#smart",title:"\u667A\u80FD\u6587\u4EF6\u5939",children:[]},{key:"#custom",title:"\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939",children:[]}];function le(o){var E=o.user,b=(0,l.useRef)(null),d=(0,A.Tt)(),v=d.data,f=(0,l.useState)(),p=(0,x.Z)(f,1),B=p[0],u=(0,l.useState)(o.mailboxes),O=(0,x.Z)(u,2),m=O[0],D=O[1],y=(0,A.mf)({updateQueries:{mailUser:function(c,a){var C=a.mutationResult;return(0,s.Z)((0,s.Z)({},c),{},{mailUser:(0,s.Z)((0,s.Z)({},c.mailUser),{},{settings:(0,s.Z)((0,s.Z)({},c.mailUser.settings),{},{mailboxes:C.data.mailboxes})})})}}}),g=(0,x.Z)(y,1),Z=g[0],j=(0,l.useCallback)(function(){var r=(0,T.Z)((0,S.Z)().mark(function c(a){return(0,S.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:console.log(a);case 1:case"end":return F.stop()}},c)}));return function(c){return r.apply(this,arguments)}}(),[]),$=(0,l.useCallback)(function(r){console.log(r)},[]),i=(0,l.useCallback)(function(r){r.preventDefault(),r.stopPropagation(),console.log("handleChange",r.target.checked,r.target.value),Z({variables:{mailboxes:[r.target.value],mode:r.target.checked?"ADD":"REMOVE"}})},[Z]),I=(0,l.useMemo)(function(){if(!(v!=null&&v.mailboxes))return(0,W.cloneDeep)(q);var r=(0,W.cloneDeep)(q),c=(0,w.Z)(v.mailboxes),a;try{var C=function(){var N=a.value,K=r.find(function(Y){return Y.key==N.namespace});if(N.name=="Outbox"||N.name=="INBOX")return"continue";if(!(K!=null&&K.children))return console.warn("\u9519\u8BEF\u7684\u547D\u540D\u7A7A\u95F4",K),"continue";K.children.push((0,s.Z)((0,s.Z)({},N),{},{type:"mailbox",key:N.id,title:N.name}))};for(c.s();!(a=c.n()).done;)var F=C()}catch(k){c.e(k)}finally{c.f()}return r[0].children=r[0].children.map(function(k){var N=M.GG.findIndex(function(Y){return Y.id==k.name}),K=M.GG[N];return(0,s.Z)((0,s.Z)({},k),{},{zindex:N,title:K.name,icon:K.name})}).sort(function(k,N){return k.zindex-N.zindex}),r.filter(function(k){var N;return(N=k.children)===null||N===void 0?void 0:N.length})},[v==null?void 0:v.mailboxes]);return(0,l.useEffect)(function(){D(o.mailboxes)},[o.mailboxes]),(0,e.jsxs)("div",{className:"settings-mailbox-container",children:[(0,e.jsx)("div",{className:"settings-mailbox-notes",children:"\u8BBE\u7F6E\u9ED8\u8BA4\u6587\u4EF6\u5939\u7684\u663E\u793A\u4E0E\u9690\u85CF\uFF0C\u5E76\u53EF\u4EE5\u6DFB\u52A0\u81EA\u5B9A\u4E49\u7684\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"d-flex",children:(0,e.jsxs)(z.fQ,{tag:(0,e.jsx)("div",{ref:b,className:J()("flex-left settings-mailbox",{editing:!1})}),name:"MAIL_PREFERENCES",handler:$,children:[(0,e.jsxs)("div",{className:"settings-mailbox-header d-flex",children:[(0,e.jsx)("div",{className:"field-folder",children:"\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"field-favorites",children:"\u6536\u85CF"})]}),(0,e.jsx)(U.E,{className:"settings-mailbox-body custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(t.N4,{className:"mailbox-treelist",rowKey:"id",expandedKeys:["#private","#smart","#custom"],draggable:!1,iconRender:function(c,a){if(!a.isDirectory)return""},columns:[{key:"title",title:"\u540D\u79F0",width:"auto",render:function(c){return(0,e.jsx)("div",{className:"title d-flex",children:(0,e.jsx)("span",{className:"text-gray-800",children:c})})}},{key:"actions",title:"\u64CD\u4F5C",className:"min-w-100px",render:function(c,a){return a.type=="directory"?(0,e.jsx)("div",{}):(0,e.jsx)(t.XZ,{value:a.namespace+"."+a.name,checked:m.includes(a.namespace+"."+a.name),onChange:i,className:"mailbox-check",size:"sm"})}}],dataSource:I})}),(0,e.jsx)(se,{user:E,onSuccess:j,selectedKey:B})]})})]})}var te=le;function ie(o){var E=o.visible,b=o.onCancel,d=o.mailUser,v=(0,l.useState)(!1),f=(0,x.Z)(v,2),p=f[0],B=f[1],u=(0,l.useState)("mailbox"),O=(0,x.Z)(u,2),m=O[0],D=O[1],y=(0,l.useCallback)(function(){B(!0)},[]),g=(0,l.useCallback)(function(j){D(j)},[]),Z=(0,l.useMemo)(function(){return d!=null&&d.settings?d.settings:{mailboxes:[]}},[d]);return(0,e.jsx)(t.u_,{centered:!0,maskClosable:!1,visible:E,onCancel:b,onOk:y,confirmLoading:p,scroll:!1,dialogClassName:"mw-750px mail-preferences",header:(0,e.jsx)(t.u_.Header,{children:(0,e.jsxs)(t.JL,{onSelect:g,selectedKey:m,children:[(0,e.jsx)(t.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(t.JL.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(h.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u901A\u7528"})})]})},"general"),(0,e.jsx)(t.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(t.JL.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(h.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u8D26\u53F7"})})]})},"account"),(0,e.jsx)(t.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(t.JL.Link,{className:"btn d-flex flex-column btn-active-light-success",children:[(0,e.jsx)(h.ZP,{name:"Duotune/fil012",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u6587\u4EF6\u5939"})})]})},"mailbox"),(0,e.jsx)(t.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(t.JL.Link,{className:"btn d-flex flex-column btn-active-light-dark",children:[(0,e.jsx)(h.ZP,{name:"Duotune/art008",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u7B7E\u540D"})})]})},"signature"),(0,e.jsx)(t.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(t.JL.Link,{className:"btn d-flex flex-column btn-active-light-warning",children:[(0,e.jsx)(h.ZP,{name:"Duotune/art008",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u6A21\u7248"})})]})},"template")]})}),footer:!1,children:(0,e.jsx)(te,{user:d==null?void 0:d.name,mailboxes:Z.mailboxes})})}var re=ie,oe=n(34106);function ue(o){var E=o.onAction;return(0,e.jsx)("div",{className:"email-sidebar-footer",children:(0,e.jsx)("span",{className:"mail-settings",onClick:E,children:"\u504F\u597D\u8BBE\u7F6E"})})}function ce(){var o,E=(0,l.useState)(!1),b=(0,x.Z)(E,2),d=b[0],v=b[1],f=(0,R.$B)({path:"/mail/:folder",strict:!0,sensitive:!0}),p=(0,l.useMemo)(function(){return f!=null&&f.params.folder?[f.params.folder]:[]},[f]),B=(0,A.FW)({fetchPolicy:"cache-and-network"}),u=B.data,O=(0,A.Tt)({fetchPolicy:"cache-and-network"}),m=O.data,D=(0,A.c3)({fetchPolicy:"cache-and-network"}),y=D.data,g=(0,l.useCallback)(function(){v(!1)},[]),Z=(0,l.useCallback)(function(){v(!0)},[]),j=(0,l.useMemo)(function(){if(!(u!=null&&u.mailUser)||!(m!=null&&m.mailboxes)){var i=M.LJ.INBOX,I=M.LJ.Outbox;return{inbox:(0,s.Z)((0,s.Z)({},i),{},{title:i.name,key:i.name.toLowerCase()}),outbox:(0,s.Z)((0,s.Z)({},I),{},{title:I.name,key:I.name.toLowerCase()}),private:M.GG.filter(function(a){return!["Outbox","INBOX"].includes(a.id)}).map(function(a){return(0,s.Z)((0,s.Z)({},a),{},{title:a.name,key:a.name.toLowerCase(),count:0})}),smart:[],custom:[]}}var r=m.mailboxes.map(function(a){if(a.namespace=="#private"){var C=M.GG.findIndex(function(F){return F.id==a.name});return(0,s.Z)((0,s.Z)({},a),{},{index:C,title:M.GG[C].name,icon:M.GG[C].icon,key:a.name.toLowerCase()})}return(0,s.Z)((0,s.Z)({},a),{},{title:a.name,index:0,icon:void 0,key:a.name.toLowerCase()})}).filter(function(a){var C,F;return["Outbox","INBOX"].includes(a.name)?!0:u==null||(C=u.mailUser)===null||C===void 0||(F=C.settings)===null||F===void 0?void 0:F.mailboxes.includes(a.namespace+"."+a.name)}).sort(function(a,C){return a.index-C.index}),c=r.filter(function(a){return a.namespace=="#private"});return{inbox:c.find(function(a){return a.name=="INBOX"}),outbox:c.find(function(a){return a.name=="Outbox"}),private:c.filter(function(a){return!["Outbox","INBOX"].includes(a.name)}),smart:r.filter(function(a){return a.namespace=="#smart"}),custom:r.filter(function(a){return a.namespace=="#custom"})}},[u==null?void 0:u.mailUser,m==null?void 0:m.mailboxes]),$=(0,l.useMemo)(function(){var i;return(y==null||(i=y.inbox)===null||i===void 0?void 0:i.unread)||0},[y==null||(o=y.inbox)===null||o===void 0?void 0:o.unread]);return(0,e.jsxs)(oe.GP,{width:280,collapsible:!1,className:"email-sidebar-aside",children:[(0,e.jsxs)("div",{className:"email-sidebar",children:[(0,e.jsx)(t.zx,{as:X.Link,to:"/mail/compose",className:"email-compose text-uppercase",children:"\u5199\u4FE1"}),(0,e.jsx)(U.E,{className:"email-sidebar-body custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsxs)(t.v2,{className:"menu-title-gray-600 menu-icon-gray-400 menu-state-bg menu-state-primary menu-state-icon-primary menu-state-bullet-primary mb-10",accordion:!1,rounded:!0,selectable:"AllMenu",selectedKeys:p,children:[(0,e.jsx)(t.v2.Item,{url:"/mail/inbox",titleClassName:"fw-bolder",icon:(0,e.jsx)(h.JO,{className:"svg-icon-2 me-3",name:"Duotune/com010"}),badge:!!$&&(0,e.jsx)(t.Ct,{size:"sm",lightStyle:M.LJ.INBOX.badge,children:$}),children:j.inbox.title},"inbox"),(0,e.jsx)(t.v2.Section,{children:"\u6587\u4EF6\u5939"}),j.private.map(function(i){var I,r=(I=M.LJ[i.name])===null||I===void 0?void 0:I.badge;return(0,e.jsx)(t.v2.Item,{className:"mb-1",url:"/mail/".concat(i.key),titleClassName:"fw-bolder",icon:(0,e.jsx)(h.JO,{className:"svg-icon-2 me-3",name:i.icon}),badge:!!r&&!!i.count&&(0,e.jsx)(t.Ct,{size:"sm",lightStyle:r,children:i.count}),children:i.title},i.key)}),j.custom.length&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t.v2.Section,{children:"\u81EA\u5B9A\u4E49"}),j.custom.map(function(i){return(0,e.jsx)(t.v2.Item,{className:"mb-1",url:"/mail/".concat(i.key),titleClassName:"fw-bolder",children:i.title},i.key)})]})]})}),(0,e.jsx)(ue,{onAction:Z})]}),(0,e.jsx)(re,{mailUser:u==null?void 0:u.mailUser,visible:d,onCancel:g})]})}var de=ce},88403:function(L,P,n){"use strict";n.d(P,{LJ:function(){return x},GG:function(){return l},ss:function(){return h}});var s=n(5618),x={INBOX:{id:"INBOX",name:"\u6536\u4EF6\u7BB1",icon:"Duotune/com010",badge:"success"},Sent:{id:"Sent",name:"\u5DF2\u53D1\u9001",icon:"Duotune/gen016"},Drafts:{id:"Drafts",name:"\u8349\u7A3F",icon:"Duotune/gen009",badge:"primary"},Archive:{id:"Archive",name:"\u5F52\u6863",icon:"Duotune/lay010"},Spam:{id:"Spam",name:"\u5783\u573E\u90AE\u4EF6",icon:"Duotune/gen044"},Trash:{id:"Trash",name:"\u56DE\u6536\u7AD9",icon:"Duotune/gen027",badge:"warning"},Outbox:{id:"Outbox",name:"\u53D1\u4EF6\u7BB1",icon:"Duotune/gen027"}},l=Object.keys(x).map(function(U){return x[U]});function h(U){var R=(0,s.N8)(U);return R.name||R.address&&R.address.substring(0,R.address.indexOf("@"))}},77104:function(L,P,n){"use strict";var s=n(94184),x=n.n(s),l=n(67294),h=n(70861),U=n(76792),R=n(85893);const X={variant:"primary",active:!1,disabled:!1},A=l.forwardRef((t,W)=>{var{as:M,bsPrefix:w,variant:S,size:T,active:z,className:_}=t,J=ae(t,["as","bsPrefix","variant","size","active","className"]);const e=(0,U.vE)(w,"btn"),[Q,{tagName:H}]=(0,h.FT)(G({tagName:M},J)),V=H;return(0,R.jsx)(V,G(G(G({},Q),J),{ref:W,className:x()(_,e,z&&"active",S&&`${e}-${S}`,T&&`${e}-${T}`,J.href&&J.disabled&&"disabled")}))});A.displayName="Button",A.defaultProps=X,P.Z=A}}]);
