var ve=Object.prototype.hasOwnProperty;var ee=Object.getOwnPropertySymbols,fe=Object.prototype.propertyIsEnumerable;var X=Object.assign;var ae=(S,F)=>{var n={};for(var s in S)ve.call(S,s)&&F.indexOf(s)<0&&(n[s]=S[s]);if(S!=null&&ee)for(var s of ee(S))F.indexOf(s)<0&&fe.call(S,s)&&(n[s]=S[s]);return n};(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[8033,3975],{33201:function(){},30098:function(S,F,n){"use strict";n.d(F,{G:function(){return x.Z}});var s=n(80064),x=n(48655),t=n(39981)},70800:function(S,F,n){"use strict";n.r(F),n.d(F,{default:function(){return me}});var s=n(11849),x=n(2824),t=n(67294),j=n(28865),R=n(51615),U=n(73727),W=n(1861),A=n(40839),M=n(88403),w=n(91220),T=n(3182),z=n(94043),Z=n.n(z),Q=n(22028),J=n(94184),H=n.n(J),$=n(96486),l=n(11974),e=n(85893),V=n(34155);function Y(u){var E=u.onClose,h=u.visible,d=u.user,v=u.namespace,f=u.name,p=u.mode,B=(0,A.hI)(),o=(0,x.Z)(B,1),O=o[0],m=l.l0.useForm(),D=(0,t.useRef)(null);(0,t.useEffect)(function(){var L;!h||(m.setFieldsValue({name:f}),(L=D.current)===null||L===void 0||L.focus(),V.nextTick(function(){var g;(g=D.current)===null||g===void 0||g.select()}))},[h]);var y=(0,t.useCallback)((0,T.Z)(Z().mark(function L(){var g;return Z().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m.validateFields();case 2:if(g=r.sent,p!="create"){r.next=6;break}return r.next=6,O({variables:{name:g.name,namespace:v}});case 6:E();case 7:case"end":return r.stop()}},L)})),[m,p,E,O,v]),b=(0,t.useCallback)(function(){E()},[E]);return(0,e.jsxs)(l.u_,{centered:!0,visible:h,dialogClassName:"modal-dialog-small w-400px",onCancel:b,onOk:y,header:!1,closable:!1,okButtonProps:{className:"btn-xs"},cancelButtonProps:{className:"btn-xs"},children:[(0,e.jsxs)("div",{className:"modal-dialog-header d-flex",children:[(0,e.jsx)("div",{className:"modal-dialog-icon",children:(0,e.jsx)(j.JO,{className:"svg-icon-5x",name:"Duotune/fil012"})}),(0,e.jsxs)("div",{className:"modal-dialog-instructions",children:[(0,e.jsx)("div",{className:"modal-dialog-title",children:p=="create"?"\u65B0\u5EFA\u6587\u4EF6\u5939":"\u4FEE\u6539\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"modal-dialog-description",children:p=="create"?(0,e.jsxs)(e.Fragment,{children:['\u4E3A\u8D26\u53F7 " ',d,' " \u521B\u5EFA\u9876\u5C42\u6587\u4EF6\u5939']}):(0,e.jsxs)(e.Fragment,{children:['\u4FEE\u6539\u8D26\u53F7 " ',d,' " \u4E2D ',f," \u6587\u4EF6\u5939\u7684\u540D\u79F0"]})})]})]}),(0,e.jsx)(l.l0,{form:m,layout:"horizontal",initialValues:{name:f},size:"xs",children:(0,e.jsx)("div",{className:"d-flex last flex-row flex-center",children:(0,e.jsx)("div",{className:"d-flex flex-column-fluid",children:(0,e.jsx)(l.l0.Item,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u5B57"}],name:"name",label:"\u540D\u79F0",children:(0,e.jsx)(l.II,{ref:D})})})})})]})}var ne=Y;function se(u){var E=u.user,h=u.onSuccess,d=u.selectedKey,v=(0,t.useState)(),f=(0,x.Z)(v,2),p=f[0],B=f[1],o=(0,t.useCallback)(function(){B(void 0)},[]),O=(0,t.useCallback)((0,T.Z)(Z().mark(function D(){return Z().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:B("#custom"),h();case 2:case"end":return b.stop()}},D)})),[h]),m=(0,t.useCallback)((0,T.Z)(Z().mark(function D(){return Z().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:console.log(d),h();case 2:case"end":return b.stop()}},D)})),[d,h]);return(0,e.jsxs)("div",{className:"settings-mailbox-footer",children:[(0,e.jsx)("a",{onClick:O,children:(0,e.jsx)(j.ZP,{name:"Duotune/arr087",className:"svg-icon-2"})}),(0,e.jsx)("a",{onClick:m,children:(0,e.jsx)(j.ZP,{name:"Duotune/arr089",className:"svg-icon-2"})}),(0,e.jsx)(ne,{mode:"create",visible:!!p,user:E,namespace:p,onClose:o})]})}var le=se,q=[{key:"#private",title:"\u9ED8\u8BA4\u6587\u4EF6\u5939",children:[]},{key:"#smart",title:"\u667A\u80FD\u6587\u4EF6\u5939",children:[]},{key:"#custom",title:"\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939",children:[]}];function te(u){var E=u.user,h=(0,t.useRef)(null),d=(0,A.Tt)(),v=d.data,f=(0,t.useState)(),p=(0,x.Z)(f,1),B=p[0],o=(0,t.useState)(u.mailboxes),O=(0,x.Z)(o,2),m=O[0],D=O[1],y=(0,A.mf)({updateQueries:{mailUser:function(c,a){var C=a.mutationResult;return(0,s.Z)((0,s.Z)({},c),{},{mailUser:(0,s.Z)((0,s.Z)({},c.mailUser),{},{settings:(0,s.Z)((0,s.Z)({},c.mailUser.settings),{},{mailboxes:C.data.mailboxes})})})}}}),b=(0,x.Z)(y,1),L=b[0],g=(0,t.useCallback)(function(){var i=(0,T.Z)(Z().mark(function c(a){return Z().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:console.log(a);case 1:case"end":return P.stop()}},c)}));return function(c){return i.apply(this,arguments)}}(),[]),G=(0,t.useCallback)(function(i){console.log(i)},[]),r=(0,t.useCallback)(function(i){i.preventDefault(),i.stopPropagation(),console.log("handleChange",i.target.checked,i.target.value),L({variables:{mailboxes:[i.target.value],mode:i.target.checked?"ADD":"REMOVE"}})},[L]),I=(0,t.useMemo)(function(){if(!(v!=null&&v.mailboxes))return(0,$.cloneDeep)(q);var i=(0,$.cloneDeep)(q),c=(0,w.Z)(v.mailboxes),a;try{var C=function(){var N=a.value,K=i.find(function(_){return _.key==N.namespace});if(N.name=="Outbox"||N.name=="INBOX")return"continue";if(!(K!=null&&K.children))return console.warn("\u9519\u8BEF\u7684\u547D\u540D\u7A7A\u95F4",K),"continue";K.children.push((0,s.Z)((0,s.Z)({},N),{},{type:"mailbox",key:N.id,title:N.name}))};for(c.s();!(a=c.n()).done;)var P=C()}catch(k){c.e(k)}finally{c.f()}return i[0].children=i[0].children.map(function(k){var N=M.GG.findIndex(function(_){return _.id==k.name}),K=M.GG[N];return(0,s.Z)((0,s.Z)({},k),{},{zindex:N,title:K.name,icon:K.name})}).sort(function(k,N){return k.zindex-N.zindex}),i.filter(function(k){var N;return(N=k.children)===null||N===void 0?void 0:N.length})},[v==null?void 0:v.mailboxes]);return(0,t.useEffect)(function(){D(u.mailboxes)},[u.mailboxes]),(0,e.jsxs)("div",{className:"settings-mailbox-container",children:[(0,e.jsx)("div",{className:"settings-mailbox-notes",children:"\u8BBE\u7F6E\u9ED8\u8BA4\u6587\u4EF6\u5939\u7684\u663E\u793A\u4E0E\u9690\u85CF\uFF0C\u5E76\u53EF\u4EE5\u6DFB\u52A0\u81EA\u5B9A\u4E49\u7684\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"d-flex",children:(0,e.jsxs)(Q.fQ,{tag:(0,e.jsx)("div",{ref:h,className:H()("flex-left settings-mailbox",{editing:!1})}),name:"MAIL_PREFERENCES",handler:G,children:[(0,e.jsxs)("div",{className:"settings-mailbox-header d-flex",children:[(0,e.jsx)("div",{className:"field-folder",children:"\u6587\u4EF6\u5939"}),(0,e.jsx)("div",{className:"field-favorites",children:"\u6536\u85CF"})]}),(0,e.jsx)(W.E,{className:"settings-mailbox-body custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(l.N4,{className:"mailbox-treelist",rowKey:"id",expandedKeys:["#private","#smart","#custom"],draggable:!1,iconRender:function(c,a){if(!a.isDirectory)return""},columns:[{key:"title",title:"\u540D\u79F0",render:function(c){return(0,e.jsx)("div",{className:"title d-flex",children:(0,e.jsx)("span",{className:"text-gray-800",children:c})})}},{key:"actions",title:"\u64CD\u4F5C",className:"min-w-100px",render:function(c,a){return a.type=="directory"?(0,e.jsx)("div",{}):(0,e.jsx)(l.XZ,{value:a.namespace+"."+a.name,checked:m.includes(a.namespace+"."+a.name),onChange:r,className:"mailbox-check",size:"sm"})}}],dataSource:I})}),(0,e.jsx)(le,{user:E,onSuccess:g,selectedKey:B})]})})]})}var re=te;function ie(u){var E=u.visible,h=u.onCancel,d=u.mailUser,v=(0,t.useState)(!1),f=(0,x.Z)(v,2),p=f[0],B=f[1],o=(0,t.useState)("mailbox"),O=(0,x.Z)(o,2),m=O[0],D=O[1],y=(0,t.useCallback)(function(){B(!0)},[]),b=(0,t.useCallback)(function(g){D(g)},[]),L=(0,t.useMemo)(function(){return d!=null&&d.settings?d.settings:{mailboxes:[]}},[d]);return(0,e.jsx)(l.u_,{centered:!0,maskClosable:!1,visible:E,onCancel:h,onOk:y,confirmLoading:p,scroll:!1,dialogClassName:"mw-750px mail-preferences",header:(0,e.jsx)(l.u_.Header,{children:(0,e.jsxs)(l.JL,{onSelect:b,selectedKey:m,children:[(0,e.jsx)(l.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(l.JL.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(j.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u901A\u7528"})})]})},"general"),(0,e.jsx)(l.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(l.JL.Link,{className:"btn d-flex flex-column btn-active-light-primary",children:[(0,e.jsx)(j.ZP,{name:"Duotune/cod001",className:"svg-icon-2 me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u8D26\u53F7"})})]})},"account"),(0,e.jsx)(l.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(l.JL.Link,{className:"btn d-flex flex-column btn-active-light-success",children:[(0,e.jsx)(j.ZP,{name:"Duotune/fil012",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u6587\u4EF6\u5939"})})]})},"mailbox"),(0,e.jsx)(l.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(l.JL.Link,{className:"btn d-flex flex-column btn-active-light-dark",children:[(0,e.jsx)(j.ZP,{name:"Duotune/art008",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u7B7E\u540D"})})]})},"signature"),(0,e.jsx)(l.JL.Item,{className:"me-2 mb-md-0",children:(0,e.jsxs)(l.JL.Link,{className:"btn d-flex flex-column btn-active-light-warning",children:[(0,e.jsx)(j.ZP,{name:"Duotune/art008",className:"svg-icon-2  me-0"}),(0,e.jsx)("span",{className:"d-flex flex-column align-items-start pt-2",children:(0,e.jsx)("span",{className:"fs-7",children:"\u6A21\u7248"})})]})},"template")]})}),footer:null,children:(0,e.jsx)(re,{user:d==null?void 0:d.name,mailboxes:L.mailboxes})})}var ue=ie,oe=n(30098);function ce(u){var E=u.onAction;return(0,e.jsx)("div",{className:"email-sidebar-footer",children:(0,e.jsx)("span",{className:"mail-settings",onClick:E,children:"\u504F\u597D\u8BBE\u7F6E"})})}function de(){var u,E=(0,t.useState)(!1),h=(0,x.Z)(E,2),d=h[0],v=h[1],f=(0,R.$B)({path:"/mail/:folder",strict:!0,sensitive:!0}),p=(0,t.useMemo)(function(){return f!=null&&f.params.folder?[f.params.folder]:[]},[f]),B=(0,A.FW)({fetchPolicy:"cache-and-network"}),o=B.data,O=(0,A.Tt)({fetchPolicy:"cache-and-network"}),m=O.data,D=(0,A.c3)({fetchPolicy:"cache-and-network"}),y=D.data,b=(0,t.useCallback)(function(){v(!1)},[]),L=(0,t.useCallback)(function(){v(!0)},[]),g=(0,t.useMemo)(function(){if(!(o!=null&&o.mailUser)||!(m!=null&&m.mailboxes)){var r=M.LJ.INBOX,I=M.LJ.Outbox;return{inbox:(0,s.Z)((0,s.Z)({},r),{},{title:r.name,key:r.name.toLowerCase()}),outbox:(0,s.Z)((0,s.Z)({},I),{},{title:I.name,key:I.name.toLowerCase()}),private:M.GG.filter(function(a){return!["Outbox","INBOX"].includes(a.id)}).map(function(a){return(0,s.Z)((0,s.Z)({},a),{},{title:a.name,key:a.name.toLowerCase(),count:0})}),smart:[],custom:[]}}var i=m.mailboxes.map(function(a){if(a.namespace=="#private"){var C=M.GG.findIndex(function(P){return P.id==a.name});return(0,s.Z)((0,s.Z)({},a),{},{index:C,title:M.GG[C].name,icon:M.GG[C].icon,key:a.name.toLowerCase()})}return(0,s.Z)((0,s.Z)({},a),{},{title:a.name,index:0,icon:void 0,key:a.name.toLowerCase()})}).filter(function(a){var C,P;return["Outbox","INBOX"].includes(a.name)?!0:o==null||(C=o.mailUser)===null||C===void 0||(P=C.settings)===null||P===void 0?void 0:P.mailboxes.includes(a.namespace+"."+a.name)}).sort(function(a,C){return a.index-C.index}),c=i.filter(function(a){return a.namespace=="#private"});return{inbox:c.find(function(a){return a.name=="INBOX"}),outbox:c.find(function(a){return a.name=="Outbox"}),private:c.filter(function(a){return!["Outbox","INBOX"].includes(a.name)}),smart:i.filter(function(a){return a.namespace=="#smart"}),custom:i.filter(function(a){return a.namespace=="#custom"})}},[o==null?void 0:o.mailUser,m==null?void 0:m.mailboxes]),G=(0,t.useMemo)(function(){var r;return(y==null||(r=y.inbox)===null||r===void 0?void 0:r.unread)||0},[y==null||(u=y.inbox)===null||u===void 0?void 0:u.unread]);return(0,e.jsxs)(oe.G,{width:280,collapsible:!1,className:"email-sidebar-aside",children:[(0,e.jsxs)("div",{className:"email-sidebar",children:[(0,e.jsx)(l.zx,{as:U.Link,to:"/mail/compose",className:"email-compose text-uppercase",children:"\u5199\u4FE1"}),(0,e.jsx)(W.E,{className:"email-sidebar-body custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsxs)(l.v2,{className:"menu-title-gray-600 menu-icon-gray-400 menu-state-bg menu-state-primary menu-state-icon-primary menu-state-bullet-primary mb-10",accordion:!1,rounded:!0,selectable:"AllMenu",selectedKeys:p,children:[(0,e.jsx)(l.v2.Item,{className:"mb-3",url:"/mail/inbox",titleClassName:"fw-bolder",icon:(0,e.jsx)(j.JO,{className:"svg-icon-2 me-3",name:"Duotune/com010"}),badge:!!G&&(0,e.jsx)(l.Ct,{size:"sm",lightStyle:M.LJ.INBOX.badge,children:G}),children:g.inbox.title},"inbox"),(0,e.jsx)(l.v2.Section,{children:"\u6587\u4EF6\u5939"}),g.private.map(function(r){var I,i=(I=M.LJ[r.name])===null||I===void 0?void 0:I.badge;return(0,e.jsx)(l.v2.Item,{className:"mb-3",url:"/mail/".concat(r.key),titleClassName:"fw-bolder",icon:(0,e.jsx)(j.JO,{className:"svg-icon-2 me-3",name:r.icon}),badge:!!i&&!!r.count&&(0,e.jsx)(l.Ct,{size:"sm",lightStyle:i,children:r.count}),children:r.title},r.key)}),g.custom.length&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.v2.Section,{children:"\u81EA\u5B9A\u4E49"}),g.custom.map(function(r){return(0,e.jsx)(l.v2.Item,{className:"mb-3",url:"/mail/".concat(r.key),titleClassName:"fw-bolder",children:r.title},r.key)})]})]})}),(0,e.jsx)(ce,{onAction:L})]}),(0,e.jsx)(ue,{mailUser:o==null?void 0:o.mailUser,visible:d,onCancel:b})]})}var me=de},88403:function(S,F,n){"use strict";n.d(F,{LJ:function(){return x},GG:function(){return t},ss:function(){return j}});var s=n(5618),x={INBOX:{id:"INBOX",name:"\u6536\u4EF6\u7BB1",icon:"Duotune/com010",badge:"success"},Sent:{id:"Sent",name:"\u5DF2\u53D1\u9001",icon:"Duotune/gen016"},Drafts:{id:"Drafts",name:"\u8349\u7A3F",icon:"Duotune/gen009",badge:"primary"},Archive:{id:"Archive",name:"\u5F52\u6863",icon:"Duotune/lay010"},Spam:{id:"Spam",name:"\u5783\u573E\u90AE\u4EF6",icon:"Duotune/gen044"},Trash:{id:"Trash",name:"\u56DE\u6536\u7AD9",icon:"Duotune/gen027",badge:"warning"},Outbox:{id:"Outbox",name:"\u53D1\u4EF6\u7BB1",icon:"Duotune/gen027"}},t=Object.keys(x).map(function(R){return x[R]});function j(R){var U=(0,s.N8)(R);return U.name||U.address&&U.address.substring(0,U.address.indexOf("@"))}},77104:function(S,F,n){"use strict";var s=n(94184),x=n.n(s),t=n(67294),j=n(70861),R=n(76792),U=n(85893);const W={variant:"primary",active:!1,disabled:!1},A=t.forwardRef(($,H)=>{var{as:M,bsPrefix:w,variant:T,size:z,active:Z,className:Q}=$,J=ae($,["as","bsPrefix","variant","size","active","className"]);const l=(0,R.vE)(w,"btn"),[e,{tagName:V}]=(0,j.FT)(X({tagName:M},J)),Y=V;return(0,U.jsx)(Y,X(X(X({},e),J),{ref:H,className:x()(Q,l,Z&&"active",T&&`${l}-${T}`,z&&`${l}-${z}`,J.href&&J.disabled&&"disabled")}))});A.displayName="Button",A.defaultProps=W,F.Z=A}}]);
