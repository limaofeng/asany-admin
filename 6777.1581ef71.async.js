"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6777],{14336:function(H,T,r){var W=r(15009),x=r.n(W),K=r(97857),B=r.n(K),$=r(99289),R=r.n($),N=r(62435),_=r(79817),i=r(12708);function c(a,s){return a.replace(/{(\w+)}/g,function(n,d){return s[d]!==void 0?s[d]:n})}function l(a,s){var n=(0,N.useRef)(!1),d=(0,N.useCallback)(function(){var m=R()(x()().mark(function u(e){var w,b,C,G;return x()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return w=a.width,b=a.title,C=a.content,e&&(typeof b=="string"&&(b=c(b,e)),typeof C=="string"&&(C=c(C,e)),typeof b=="function"&&(b=b(e)),typeof C=="function"&&(C=C(e))),M.next=5,_.Modal.confirm(B()(B()({},a),{},{title:b,content:C,width:w,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!n.current},preConfirm:function(){var g=R()(x()().mark(function y(){var h,P,E;return x()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.current=!0,t.prev=1,h=document.querySelector(".swal2-confirm"),h.textContent="\u5220\u9664\u4E2D...",P=document.createElement("span"),P.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),h.appendChild(P),t.next=9,(0,i.gw)(s(e),350);case 9:E=t.sent,console.log(E);case 11:return t.prev=11,n.current=!1,t.finish(11);case 14:case"end":return t.stop()}},y,null,[[1,,11,14]])}));function f(){return g.apply(this,arguments)}return f}()}));case 5:if(G=M.sent,G.isConfirmed){M.next=8;break}return M.abrupt("return",!1);case 8:return _.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),M.abrupt("return",!0);case 10:case"end":return M.stop()}},u)}));return function(u){return m.apply(this,arguments)}}(),[s,a]);return[d]}T.Z=l},58301:function(H,T,r){r.d(T,{Oh:function(){return N},bp:function(){return _}});var W=r(97857),x=r.n(W),K=r(62435);function B(i,c){var l,a,s=i(x()({fetchPolicy:"network-only"},c)),n=s.data,d=s.loading,m=s.previousData,u=s.refetch,e=s.error,w=(0,K.useMemo)(function(){return d?m==null?void 0:m.result.pageInfo:n==null?void 0:n.result.pageInfo},[n==null||(l=n.result)===null||l===void 0?void 0:l.pageInfo.total,d,m==null||(a=m.result)===null||a===void 0?void 0:a.pageInfo.total]),b=(n==null?void 0:n.result.edges.map(function(C){return C.node}))||[];return[b,{loading:d,pageInfo:w,error:e,variables:{},refetch:u}]}function $(i,c){return c.split(".").reduce(function(l,a){return l&&l[a]!==void 0?l[a]:void 0},i)}function R(i,c,l){for(var a=c.split("."),s=i;a.length>1;){var n=a.shift();s[n]||(s[n]={}),s=s[n]}s[a[0]]=l}function N(i,c){var l=c.map(function(a){var s=a.source,n=a.target,d=a.transform,m=a.skip,u=$(i,s);if(u==null||m&&m(u))return"";var e=d?d(u):String(u);return"".concat(encodeURIComponent(n||s),"=").concat(encodeURIComponent(e))});return l.filter(function(a){return a}).join("&")}function _(i,c){var l={};return c.forEach(function(a){var s=a.source,n=a.target,d=a.transform,m=a.skip,u=i.get(s);if(!(!u||u.trim()==="")){var e=d?d(u):u;m&&m(e)||(n?R(l,n,e):l[s]=e)}}),l}T.ZP=B},66777:function(H,T,r){r.r(T),r.d(T,{default:function(){return M}});var W=r(97857),x=r.n(W),K=r(15009),B=r.n(K),$=r(99289),R=r.n($),N=r(5574),_=r.n(N),i=r(62435),c=r(46027),l=r(14336),a=r(58301),s=r(73588),n=r(79817),d=r(13769),m=r.n(d),u=r(91726),e=r(86074),w=["id"];function b(g){var f=g.form,y=g.mode;return(0,e.jsxs)(n.Form,{form:f,children:[(0,e.jsx)(n.Form.Item,{className:"d-flex flex-column mb-7",name:"id",label:"\u7F16\u7801",rules:[{required:!0}],children:(0,e.jsx)(n.Input,{solid:!0,readOnly:y==="edit"})}),(0,e.jsx)(n.Form.Item,{className:"d-flex flex-column mb-7",name:"name",label:"\u540D\u79F0",rules:[{required:!0}],children:(0,e.jsx)(n.Input,{solid:!0})}),(0,e.jsx)(n.Form.Item,{className:"d-flex flex-column mb-7",name:"description",label:"\u63CF\u8FF0",children:(0,e.jsx)(n.Input.TextArea,{solid:!0})})]})}var C=function(f){var y=(0,i.useState)(!1),h=_()(y,2),P=h[0],E=h[1],I=f.visible,t=f.data,S=f.refetch,k=(0,u.X9)(),O=_()(k,1),Z=O[0],U=(0,u.f0)(),F=_()(U,1),o=F[0],v=n.Form.useForm(),D=(0,i.useCallback)(function(){f.setVisible(!1)},[]),A=(0,i.useCallback)(R()(B()().mark(function V(){var p,L,Q;return B()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,v.validateFields();case 2:if(p=j.sent,L=p.id,Q=m()(p,w),E(!0),j.prev=6,!(t!=null&&t.id)){j.next=12;break}return j.next=10,o({variables:{id:L,input:Q}});case 10:j.next=14;break;case 12:return j.next=14,Z({variables:{input:x()({id:L},Q)}});case 14:f.setVisible(!1);case 15:return j.prev=15,E(!1),S(),j.finish(15);case 19:case"end":return j.stop()}},V,null,[[6,,15,19]])})),[S,t]);return(0,i.useEffect)(function(){I?t&&v.setFieldsValue({id:t.id,name:t.name,description:t.description}):v.resetFields()},[I,t]),(0,e.jsxs)(n.Modal,{width:640,centered:!0,onOk:A,confirmLoading:P,okText:"\u4FDD\u5B58",visible:I,onCancel:D,children:[(0,e.jsx)(n.Modal.Header,{closable:!0,className:"ms-5 border-0",children:(0,e.jsx)("h1",{className:"modal-title pt-6 pb-4",children:"\u6DFB\u52A0\u54C1\u724C"})}),(0,e.jsx)(n.Modal.Body,{children:(0,e.jsx)(b,{form:v,mode:t!=null&&t.id?"edit":"create"})})]})};function G(g){var f=g.data,y=g.refetch,h=g.onEdit,P=(0,i.useState)(!1),E=_()(P,2),I=E[0],t=E[1],S=(0,u.rD)(),k=_()(S,1),O=k[0],Z=(0,l.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(D){return(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:D.name}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})}},function(){var v=R()(B()().mark(function D(A){return B()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,O({variables:{where:{id_in:[A==null?void 0:A.id]}}});case 2:y();case 3:case"end":return p.stop()}},D)}));return function(D){return v.apply(this,arguments)}}()),U=_()(Z,1),F=U[0],o=(0,i.useCallback)(function(v){var D=v.key;D==="edit"?h():D==="delete"&&F({name:f.name,id:f.id})},[h]);return(0,e.jsx)(n.Dropdown,{overlay:(0,e.jsxs)(n.Menu,{onClick:o,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(n.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(n.Menu.Item,{className:"px-3",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:t,visible:I,children:(0,e.jsxs)(n.Button,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(c.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function X(){var g=(0,i.useState)({visible:!1}),f=_()(g,2),y=f[0],h=f[1],P=(0,a.ZP)(u.ac,{toQuery:function(o,v,D,A){var V,p={};if((V=o.filter)!==null&&V!==void 0&&V.name_contains){var L;p.q=(L=o.filter)===null||L===void 0?void 0:L.name_contains}return A&&(p.orderBy=A.field+"_"+(A.order==="ascend"?"asc":"desc")),p.page=v.current,p},toVariables:function(o){return o.q&&(o.filter={name_contains:o.q},delete o.q),o}}),E=_()(P,2),I=E[0],t=E[1],S=t.loading,k=t.pageInfo,O=t.sorter,Z=t.onChange,U=t.refetch;return(0,e.jsxs)(s.vs,{header:{title:"\u54C1\u724C\u5217\u8868"},children:[(0,e.jsx)(C,{visible:y.visible,setVisible:function(o){return h(x()(x()({},y),{},{visible:o}))},refetch:U,data:y.data}),!k.total&&!S?(0,e.jsx)(n.Card,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(n.Empty,{title:"\u8FD8\u6CA1\u6709\u54C1\u724C",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u54C1\u724C\u5427\uFF01",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(n.Button,{variant:"primary",children:"\u6DFB\u52A0\u54C1\u724C"})})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(n.Card,{className:"mb-5 mb-xl-10",children:[(0,e.jsxs)(n.Card.Header,{className:"pt-8",children:[(0,e.jsx)(n.Card.Title,{className:"flex-column"}),(0,e.jsx)(n.Card.Toolbar,{children:(0,e.jsx)("div",{className:"d-flex justify-content-end",children:(0,e.jsx)(n.Button,{variant:"primary",className:"me-3",icon:(0,e.jsx)(c.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),onClick:function(){return h({visible:!0})},children:"\u6DFB\u52A0\u54C1\u724C"})})})]}),(0,e.jsx)(n.Card.Body,{children:(0,e.jsx)(n.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:S,children:(0,e.jsx)(n.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(o){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:o}),"\u4E2A\u54C1\u724C"]})}},noRowsRenderer:function(){return(0,e.jsx)(n.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"id",title:"\u7F16\u7801",sorter:!0,sortOrder:O.field==="id"?O.order:void 0,width:120},{key:"name",title:"\u54C1\u724C\u540D\u79F0",sorter:!0,width:180,sortOrder:O.field==="name"?O.order:void 0},{key:"description",title:"\u63CF\u8FF0"},{key:"createdAt",title:"\u521B\u5EFA\u65F6\u95F4",width:120},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(o,v){return(0,e.jsx)(G,{data:v,onEdit:function(){h({visible:!0,data:v})},refetch:U})}}],pagination:k,onChange:Z,dataSource:I})})})]})})]})}var M=X}}]);
