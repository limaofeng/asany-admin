"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2990],{92990:function(ge,J,a){a.r(J),a.d(J,{default:function(){return O}});var r=a(15009),Y=a.n(r),q=a(13769),_=a.n(q),re=a(99289),se=a.n(re),ee=a(5574),oe=a.n(ee),te=a(97857),T=a.n(te),S=a(62435),ae=a(96974),ie=a(64218),de=a(93967),L=a.n(de),ne=a(73588),t=a(79817),ue=a(12708),e=a(86074);function D(h){var m,d,v=(0,S.useCallback)(function(){var s;window.open("//localhost:8001/designer?id="+((s=h.category)===null||s===void 0||(s=s.page)===null||s===void 0||(s=s.component)===null||s===void 0?void 0:s.id),"_blank")},[(m=h.category)===null||m===void 0||(m=m.page)===null||m===void 0||(m=m.component)===null||m===void 0?void 0:m.id]),R=(0,S.useCallback)(function(s){console.log(s.target.checked)},[]),j=(d=h.category)===null||d===void 0||(d=d.page)===null||d===void 0||(d=d.component)===null||d===void 0?void 0:d.template;return(0,e.jsxs)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:[(0,e.jsxs)(t.Card,{flush:!0,className:"py-4",title:"\u66F4\u591A\u529F\u80FD",bodyClassName:"pt-0",children:[(0,e.jsx)(t.Form.Item,{valuePropName:"checked",className:"mb-8",name:"xx",children:(0,e.jsx)(t.Checkbox,{value:"1",solid:!0,label:"\u542F\u7528\u8BC4\u8BBA"})}),(0,e.jsx)(t.Form.Item,{valuePropName:"checked",className:"mb-8",name:"x2",children:(0,e.jsx)(t.Checkbox,{value:"1",solid:!0,label:"\u5141\u8BB8\u6536\u85CF"})}),(0,e.jsx)(t.Form.Item,{valuePropName:"checked",className:"mb-8",name:["page","enabled"],children:(0,e.jsx)(t.Checkbox,{onChange:R,value:"1",solid:!0,className:"align-items-start",inputClassName:"mt-1",children:(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("div",{children:"\u81EA\u5B9A\u4E49\u680F\u76EE\u9875"}),(0,e.jsx)("div",{className:"form-item-help",children:"\u914D\u7F6E\u5355\u72EC\u7684\u5C55\u793A\u9875\u9762"})]})})})]}),(0,e.jsx)(t.Form.Item,{dependencies:[["page","enabled"]],noStyle:!0,children:function(G){var k=G.getFieldValue(["page","enabled"]);return k?(0,e.jsxs)(t.Card,{flush:!0,className:"py-4",title:"\u81EA\u5B9A\u4E49\u680F\u76EE\u9875",bodyClassName:"pt-0",children:[(0,e.jsx)(t.Form.Item,{className:"mb-6 mw-400px",name:["page","route","path"],label:"\u8BBF\u95EE\u5730\u5740",children:(0,e.jsx)(t.Input,{})}),(0,e.jsx)(t.Form.Item,{className:"mb-6",name:["page","component","template"],label:"\u9875\u9762\u6A21\u7248",children:(0,e.jsx)(t.Select2,{width:400,options:[{value:"cn.asany.ui.theme.canvas.Page",label:"\u666E\u901A\u680F\u76EE\u9875"},{value:"cn.asany.ui.theme.canvas.Page1",label:"\u5B9A\u5236\u6A21\u7248"}]})}),(0,e.jsx)(t.Form.Item,{dependencies:[["page","component","template"]],noStyle:!0,children:function(){var N=G.getFieldValue(["page","component","template"]),w=!N||j!==N;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t.Button,{onClick:v,disabled:w,children:"\u53BB\u914D\u7F6E\u9875\u9762"}),w&&(0,e.jsx)("div",{className:"form-item-help",children:"\u5207\u6362\u6A21\u7248\u540E\uFF0C\u9700\u8981\u5148\u4FDD\u5B58"})]})}})]}):(0,e.jsx)(e.Fragment,{})}})]})}var ve=D;function ce(){return(0,e.jsx)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:(0,e.jsxs)(t.Card,{flush:!0,className:"py-4",title:"\u901A\u7528",bodyClassName:"pt-0",children:[(0,e.jsx)(t.Form.Item,{className:"mb-8",name:"name",label:"\u540D\u79F0",required:!0,help:"\u540D\u79F0\u662F\u5FC5\u9700\u7684\uFF0C\u5EFA\u8BAE\u662F\u552F\u4E00\u7684",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(t.Input,{placeholder:"\u680F\u76EE\u540D\u79F0",className:"mw-400px"})}),(0,e.jsx)(t.Form.Item,{name:"description",label:"\u63CF\u8FF0",help:"\u4E3A\u680F\u76EE\u8BBE\u7F6E\u63CF\u8FF0\u4EE5\u83B7\u5F97\u66F4\u597D\u7684\u53EF\u89C1\u6027\u3002",children:(0,e.jsx)(t.QuillEditor,{className:"h-300px"})})]})})}var l=ce,c=a(5618);function f(){return(0,e.jsx)("div",{className:"d-flex flex-column gap-7 gap-lg-10",children:(0,e.jsxs)(t.Card,{flush:!0,className:"py-4",title:"SEO",bodyClassName:"pt-0",children:[(0,e.jsx)(t.Form.Item,{name:["meta","seo","title"],className:"mb-8",label:"\u6807\u9898",help:"\u8BBE\u7F6E\u5143\u6570\u636E\u6807\u9898, \u5EFA\u8BAE\u5173\u952E\u8BCD\u8981\u7B80\u5355, \u51C6\u786E",children:(0,e.jsx)(t.Input,{className:"mw-400px"})}),(0,e.jsx)(t.Form.Item,{name:["meta","seo","description"],className:"mb-8",label:"\u63CF\u8FF0",help:"\u8BBE\u7F6E\u5143\u6570\u636E\u63CF\u8FF0, \u4EE5\u63D0\u9AD8\u6392\u540D",children:(0,e.jsx)(t.QuillEditor,{className:"h-300px"})}),(0,e.jsx)(t.Form.Item,{name:["meta","seo","keywords"],label:"\u5173\u952E\u5B57",help:(0,e.jsxs)(e.Fragment,{children:["\u8BBE\u7F6E\u680F\u76EE\u76F8\u5173\u7684\u5173\u952E\u5B57\u5217\u8868\u3002\u901A\u8FC7\u5728\u6BCF\u4E2A\u5173\u952E\u5B57\u4E4B\u95F4\u6DFB\u52A0",(0,e.jsx)("code",{children:","}),"\u6765\u5206\u9694\u5173\u952E\u5B57"]}),children:(0,e.jsx)(c.ZP,{className:"form-control"})})]})})}var I=f,C=a(69366),x=a(42646);function P(h){var m=h.categoryTreeData,d=(0,x.St)(),v=d.data,R=(v==null?void 0:v.articleStoreTemplates)||[];return(0,e.jsxs)("div",{className:"d-flex flex-column gap-7 gap-lg-10 w-100 w-lg-300px mb-7 me-lg-10",children:[(0,e.jsxs)(t.Card,{flush:!0,className:"py-4",title:"\u7F29\u7565\u56FE",bodyClassName:"text-center pt-0",children:[(0,e.jsx)(t.Form.Item,{name:"image",children:(0,e.jsx)(t.Upload.Image,{width:150,height:150,className:"mb-3",space:"orX8kLOV",accept:".png, .jpg, .jpeg",crop:{height:300,zoomable:!1,aspectRatio:1},background:"/assets/media/svg/files/blank-image.svg"})}),(0,e.jsx)("div",{className:"text-muted fs-7",children:"\u8BBE\u7F6E\u680F\u76EE\u7F29\u7565\u56FE\u3002\u4EC5\u63A5\u53D7 *.png\u3001*.jpg \u548C *.jpeg \u683C\u5F0F\u7684\u56FE\u7247"})]}),(0,e.jsx)(t.Card,{flush:!0,className:"py-4",title:"\u4E0A\u7EA7\u680F\u76EE",children:(0,e.jsxs)(t.Card.Body,{className:"pt-0",children:[(0,e.jsx)(t.Form.Item,{className:"mb-3",name:"parent",children:(0,e.jsx)(C.Z,{style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:m,placeholder:"\u9009\u62E9\u4E0A\u7EA7\u680F\u76EE, \u9ED8\u8BA4\u6839\u680F\u76EE",treeDefaultExpandAll:!0,allowClear:!0,transitionName:""})}),(0,e.jsx)("div",{className:"text-muted fs-7",children:"\u9009\u62E9\u4E0A\u7EA7\u680F\u76EE,\u672A\u9009\u62E9\u5C06\u6DFB\u52A0\u5230\u6839\u76EE\u5F55"})]})}),(0,e.jsxs)(t.Card,{flush:!0,className:"py-4",title:"\u5B58\u50A8\u6A21\u677F",bodyClassName:"pt-0",children:[(0,e.jsx)(t.Form.Item,{className:"mb-3",name:"storeTemplate",label:"\u9009\u62E9\u5B58\u50A8\u6A21\u677F",children:(0,e.jsx)(t.Select2,{options:R.map(function(j){return{value:j.id,label:j.name}})})}),(0,e.jsx)("div",{className:"text-muted fs-7",children:"\u4ECE\u60A8\u5F53\u524D\u7684\u4E3B\u9898\u4E2D\u5206\u914D\u4E00\u4E2A\u6A21\u677F\u6765\u5B9A\u4E49\u680F\u76EE\u6587\u7AE0\u7684\u663E\u793A\u65B9\u5F0F"})]})]})}var me=P,fe=["meta","page"];function he(){var h=(0,ae.bx)(),m=h.rootCategoryId,d=h.categories,v=(0,ae.UO)();console.log("rootCategoryId",m);var R=(0,x.WP)({fetchPolicy:"cache-and-network",variables:{id:v.id}}),j=R.data,s=R.loading,G=(0,S.useMemo)(function(){return!d||!d.length?[]:(0,ue.G_)(d.map(function(o){return T()(T()({},o),{},{value:o.id,title:o.name})}),{idKey:"id",childrenKey:"children",pidKey:"parent.id",sort:function(p,y){return p.index-y.index}})},[d]),k=(0,x.Qu)(),K=oe()(k,2),N=K[0],w=K[1].loading,E=t.Form.useForm(),z=(0,S.useCallback)(se()(Y()().mark(function o(){var p,y,A,b,B,$,Q,le,W,V,X,Z,H,i,u,n;return Y()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,E.validateFields();case 2:for(b=g.sent,B=b.meta,$=b.page,Q=_()(b,fe),le={seo_title:"single_line_text_field",seo_description:"multi_line_text_field",seo_keywords:"list.single_line_text_field"},W=[],V=0,X=Object.keys(B);V<X.length;V++)for(Z=X[V],H=0,i=Object.keys(B[Z]);H<i.length;H++)u=i[H],W.push({namespace:Z,key:u,value:B[Z][u],type:le[Z+"_"+u]});return n=T()(T()({},Q),{},{page:{enabled:$.enabled,path:(p=$.route)===null||p===void 0?void 0:p.path,template:(y=$.component)===null||y===void 0?void 0:y.template,blocks:(A=$.component)===null||A===void 0?void 0:A.blocks},metafields:W}),g.next=12,N({variables:{id:v.id,input:n}});case 12:t.Toast.success("\u680F\u76EE \u201C".concat(Q.name,"\u201D \u4FEE\u6539\u6210\u529F"),2e3,{placement:"bottom-left",progressBar:!0});case 13:case"end":return g.stop()}},o)})),[E,v.id,N]),F=j==null?void 0:j.category;(0,S.useEffect)(function(){var o,p,y,A;F&&E.setFieldsValue(T()(T()({},F),{},{storeTemplate:(o=F.storeTemplate)===null||o===void 0?void 0:o.id,image:(p=F.image)===null||p===void 0?void 0:p.id,parent:((y=F.parent)===null||y===void 0?void 0:y.id)===m?null:(A=F.parent)===null||A===void 0?void 0:A.id}))},[F,E,m]);var M=(0,S.useCallback)(function(){history.back()},[]);return(0,e.jsx)(ne.vs,{loading:s,header:{title:"\u7F16\u8F91\u680F\u76EE"},children:(0,e.jsxs)(t.Form,{form:E,className:"form d-flex flex-column flex-lg-row",children:[(0,e.jsx)(me,{categoryTreeData:G}),(0,e.jsxs)("div",{className:"d-flex flex-column flex-row-fluid gap-7 gap-lg-10",children:[(0,e.jsxs)(t.Tabs,{defaultActiveKey:"general",contentContainer:!1,type:"line-tabs",className:"border-0 fs-4 fw-bold mb-n2 nav-line-tabs-2x",children:[(0,e.jsx)(t.Tabs.TabPane,{tab:"\u57FA\u672C\u4FE1\u606F",forceRender:!0,children:(0,e.jsx)(l,{})},"general"),(0,e.jsx)(t.Tabs.TabPane,{tab:"\u9AD8\u7EA7\u8BBE\u7F6E",forceRender:!0,children:(0,e.jsx)(ve,{category:F})},"advanced"),(0,e.jsx)(t.Tabs.TabPane,{tab:"\u5143\u6570\u636E",forceRender:!0,children:(0,e.jsx)(I,{})},"metadata")]}),(0,e.jsx)(ie.Z,{style:{zIndex:9},offsetBottom:16,children:(0,e.jsxs)("div",{className:L()("d-flex bg-body-color p-5 mx-4 tw-rounded-2xl justify-content-end"),children:[(0,e.jsx)(t.Button,{onClick:M,variant:"light",className:"me-5",children:"\u53D6\u6D88"}),(0,e.jsx)(t.Button,{onClick:z,loading:w,children:"\u4FDD\u5B58\u66F4\u6539"})]})})]})]})})}var O=he},64218:function(ge,J,a){a.d(J,{Z:function(){return ce}});var r=a(62435),Y=a(93967),q=a.n(Y),_=a(48555),re=a(98423),se=a(74902),ee=a(75164);function oe(l){let c;const f=C=>()=>{c=null,l.apply(void 0,(0,se.Z)(C))},I=function(){if(c==null){for(var C=arguments.length,x=new Array(C),P=0;P<C;P++)x[P]=arguments[P];c=(0,ee.Z)(f(x))}};return I.cancel=()=>{ee.Z.cancel(c),c=null},I}var te=oe,T=a(53124),S=a(92030);const ae=l=>{const{componentCls:c}=l;return{[c]:{position:"fixed",zIndex:l.zIndexPopup}}},ie=l=>({zIndexPopup:l.zIndexBase+10});var de=(0,S.I$)("Affix",ae,ie);function L(l){return l!==window?l.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function ne(l,c,f){if(f!==void 0&&Math.round(c.top)>Math.round(l.top)-f)return f+c.top}function t(l,c,f){if(f!==void 0&&Math.round(c.bottom)<Math.round(l.bottom)+f){const I=window.innerHeight-c.bottom;return f+I}}const ue=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"];function e(){return typeof window!="undefined"?window:null}var D;(function(l){l[l.None=0]="None",l[l.Prepare=1]="Prepare"})(D||(D={}));var ce=r.forwardRef((l,c)=>{var f;const{style:I,offsetTop:C,offsetBottom:x,prefixCls:P,className:me,rootClassName:fe,children:he,target:O,onChange:h}=l,{getPrefixCls:m,getTargetContainer:d}=r.useContext(T.E_),v=m("affix",P),[R,j]=r.useState(!1),[s,G]=r.useState(),[k,K]=r.useState(),N=r.useRef(D.None),w=r.useRef(null),E=r.useRef(),z=r.useRef(null),F=r.useRef(null),M=r.useRef(null),o=(f=O!=null?O:d)!==null&&f!==void 0?f:e,p=x===void 0&&C===void 0?0:C,y=()=>{if(N.current!==D.Prepare||!F.current||!z.current||!o)return;const i=o();if(i){const u={status:D.None},n=L(z.current);if(n.top===0&&n.left===0&&n.width===0&&n.height===0)return;const U=L(i),g=ne(n,U,p),pe=t(n,U,x);g!==void 0?(u.affixStyle={position:"fixed",top:g,width:n.width,height:n.height},u.placeholderStyle={width:n.width,height:n.height}):pe!==void 0&&(u.affixStyle={position:"fixed",bottom:pe,width:n.width,height:n.height},u.placeholderStyle={width:n.width,height:n.height}),u.lastAffix=!!u.affixStyle,R!==u.lastAffix&&(h==null||h(u.lastAffix)),N.current=u.status,G(u.affixStyle),K(u.placeholderStyle),j(u.lastAffix)}},A=()=>{var i;N.current=D.Prepare,y()},b=te(()=>{A()}),B=te(()=>{if(o&&s){const i=o();if(i&&z.current){const u=L(i),n=L(z.current),U=ne(n,u,p),g=t(n,u,x);if(U!==void 0&&s.top===U||g!==void 0&&s.bottom===g)return}}A()}),$=()=>{const i=o==null?void 0:o();i&&(ue.forEach(u=>{var n;E.current&&((n=w.current)===null||n===void 0||n.removeEventListener(u,E.current)),i==null||i.addEventListener(u,B)}),w.current=i,E.current=B)},Q=()=>{M.current&&(clearTimeout(M.current),M.current=null);const i=o==null?void 0:o();ue.forEach(u=>{var n;i==null||i.removeEventListener(u,B),E.current&&((n=w.current)===null||n===void 0||n.removeEventListener(u,E.current))}),b.cancel(),B.cancel()};r.useImperativeHandle(c,()=>({updatePosition:b})),r.useEffect(()=>(M.current=setTimeout($),()=>Q()),[]),r.useEffect(()=>{$()},[O,s]),r.useEffect(()=>{b()},[O,C,x]);const[le,W,V]=de(v),X=q()(fe,W,v,V),Z=q()({[X]:s});let H=(0,re.Z)(l,["prefixCls","offsetTop","offsetBottom","target","onChange","rootClassName"]);return le(r.createElement(_.Z,{onResize:b},r.createElement("div",Object.assign({style:I,className:me,ref:z},H),s&&r.createElement("div",{style:k,"aria-hidden":"true"}),r.createElement("div",{className:Z,ref:F,style:s},r.createElement(_.Z,{onResize:b},he)))))})}}]);
