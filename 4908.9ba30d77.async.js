"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4908],{97294:function(S,f,e){var R=e(97857),g=e.n(R),B=e(5574),I=e.n(B),x=e(52677),T=e.n(x),u=e(62435),j=e(59197),O=e(12845),L=e(93967),D=e.n(L),i=e(2721),y=e(8606),n=e(12708),l=e(86074),h=function(_){return _!=null&&_.url?_.url:T()(_==null?void 0:_.image)==="object"?O.APP_CONFIG.STORAGE_URL+"/preview/".concat(_.image.id):typeof(_==null?void 0:_.image)=="string"?O.APP_CONFIG.STORAGE_URL+"/preview/".concat(_.image):""};function s(b){var _=b.value,C=b.onChange,r=(0,u.useRef)({value:[],visible:!1}),P=(0,u.useReducer)(function(a){return a+1},0),U=I()(P,2),p=U[1];(0,n.KW)(function(){console.log("value",_),r.current.value=(_||[]).map(function(a){return{id:a.id,title:a.title,description:a.description,image:a.image,url:a.url,data_state:"edit"}}),p()},[_]);var E=(0,u.useCallback)(function(a){console.log("handleChange",a),C&&C(a)},[]),F=(0,u.useCallback)(function(a){r.current.value=a.map(function(d){return{id:d.id,title:d.title,description:d.description,image:d.image,url:d.url,data_state:d.data_state}}),E(r.current.value)},[]),c=(0,u.useCallback)(function(a){r.current.visible=a,p()},[]),m=(0,u.useCallback)(function(a){a.preventDefault(),a.stopPropagation(),c(!0)},[]),v=(0,u.useCallback)(function(a){r.current.value.push({id:(0,y.uuid)(),title:"",description:"",data_state:"new",image:a}),E(r.current.value)},[_]),M=(0,u.useCallback)(function(a){r.current.externalLink=a.target.value,p()},[]),A=(0,u.useCallback)(function(){r.current.value.push({id:(0,y.uuid)(),title:"",description:"",data_state:"new",image:void 0,url:r.current.externalLink}),E(r.current.value),c(!1)},[_]),k=(0,u.useCallback)(function(){c(!1)},[]),o=(0,u.useCallback)(function(a){return function(){r.current.value=r.current.value.filter(function(d){return d.id!==a}),E(r.current.value)}},[]),K=r.current.visible,t=r.current.value,G=r.current.externalLink;return(0,l.jsxs)("div",{className:"article-content-image",children:[(0,l.jsx)(i.Modal,{centered:!0,visible:K,dialogClassName:"modal-dialog-small w-500px",onCancel:k,onOk:A,title:"\u8BBE\u7F6E\u94FE\u63A5\u5F15\u7528",closable:!1,headerClassName:"border-bottom-0",bodyClassName:"py-2",footerClassName:"border-top-0",children:(0,l.jsx)(i.Input.TextArea,{value:G,autoSize:{minRows:3,maxRows:5},onChange:M})}),(0,l.jsx)("div",{className:"fv-row mb-6",children:(0,l.jsx)(i.SignleUpload,{accept:{"image/*":[".png",".jpg",".jpeg",".gif",".svg"]},title:(0,l.jsxs)(l.Fragment,{children:["\u5C06\u6587\u4EF6\u62D6\u62FD\u81F3\u6B64\u5904\u3001\u70B9\u51FB\u4E0A\u4F20\uFF0C\u6216",(0,l.jsx)("a",{onClick:m,className:"",children:"\u8BBE\u7F6E"}),"\u94FE\u63A5\u5F15\u7528\u3002"]}),description:"\u652F\u6301\u7684\u683C\u5F0F\uFF1Apng, jpg, jpeg, gif, svg",onChange:v})}),(0,l.jsx)(j.ZP,{direction:"horizontal",layout:"grid",onChange:F,tag:"div",className:"ps-0",draggable:!0,items:t,rerender:!1,itemRender:function(d,W){var N=d,w=N.data,z=N.drag,V=N.style;return(0,l.jsx)(i.Symbol.Image,{ref:z(W),labelClassName:"fs-2",size:150,style:g()({width:150,height:150},V),src:h(w),className:D()("shadow shadow-sm p-2 mb-6 me-6",{}),badge:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(i.Button,{as:"label",type:"circle",variant:!1,onClick:o(w.id),"data-kt-image-input-action":"change",className:"symbol-badge start-100 btn-icon btn-active-color-primary w-25px h-25px bg-body shadow",children:(0,l.jsx)("i",{className:"bi bi-x fs-2"})})})},w.id)},preview:{render:(0,j.HG)(function(a){var d=a,W=d.data;return(0,l.jsx)(i.Symbol.Image,{style:{width:150,height:150},labelClassName:"fs-2",size:150,src:h(W),className:D()("shadow shadow-sm p-2",{})})},{})}})]})}f.Z=s},24908:function(S,f,e){e.r(f);var R=e(15009),g=e.n(R),B=e(52677),I=e.n(B),x=e(97857),T=e.n(x),u=e(99289),j=e.n(u),O=e(5574),L=e.n(O),D=e(62435),i=e(96974),y=e(73588),n=e(2721),l=e(97294),h=e(60551),s=e(86074);function b(){var _=(0,i.s0)(),C=n.Form.useForm(),r=(0,h.ac)({variables:{pageSize:1e3},fetchPolicy:"network-only"}),P=r.data,U=(0,h.qX)(),p=L()(U,1),E=p[0],F=(0,D.useCallback)(j()(g()().mark(function m(){var v,M,A;return g()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,C.validateFields();case 2:return v=o.sent,v.images=(v.images||[]).map(function(K){var t=T()({},K);return t.hasOwnProperty("__typename")&&delete t.__typename,t.data_state==="new"&&delete t.id,delete t.data_state,t.hasOwnProperty("image")&&t.image&&(I()(t.image)==="object"&&(t.image=t.image.id),delete t.url),t}),o.next=6,E({variables:{input:v}});case 6:M=o.sent,A=M.data,n.Toast.success("\u4FDD\u5B58\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),_("/pim/products/"+A.result.id,{replace:!0});case 10:case"end":return o.stop()}},m)})),[]),c=(P==null?void 0:P.result.edges.map(function(m){return m.node}))||[];return(0,s.jsx)(y.vs,{header:{title:"\u65B0\u5EFA\u4EA7\u54C1"},children:(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.Card.Header,{children:(0,s.jsx)(n.Card.Title,{children:"\u65B0\u5EFA\u4EA7\u54C1"})}),(0,s.jsx)(n.Card.Body,{children:(0,s.jsxs)(n.Form,{form:C,className:"form d-flex flex-column",children:[(0,s.jsxs)(n.Row,{className:"mt-5",children:[(0,s.jsxs)(n.Col,{span:6,children:[(0,s.jsx)(n.Form.Item,{className:"mb-5",name:"brandId",label:"\u54C1\u724C",rules:[{required:!0,message:"\u54C1\u724C\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,s.jsx)(n.Select,{className:"w-400px",options:(c==null?void 0:c.map(function(m){return{label:m.name,value:m.id}}))||[]})}),(0,s.jsx)(n.Form.Item,{className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,s.jsx)(n.Input,{solid:!0,className:"w-400px"})})]}),(0,s.jsx)(n.Col,{span:6,children:(0,s.jsx)(n.Form.Item,{className:"mb-5",name:"images",label:"\u4EA7\u54C1\u56FE\u7247",noStyle:!0,children:(0,s.jsx)(l.Z,{})})})]}),(0,s.jsx)(n.Button,{className:"w-100px",onClick:F,children:"\u4FDD\u5B58"})]})})]})})}f.default=b}}]);
