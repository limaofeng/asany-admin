"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5107],{54278:function(je,Y,u){u.d(Y,{Nk:function(){return ie},SP:function(){return J},sW:function(){return ee}});var c=u(97857),L=u.n(c),m=u(68400),E=u.n(m),U=u(75063),y=u(37887),fe=u(50319),P,re,ae,$,g,C={},Q=(0,U.Ps)(P||(P=E()([`
    fragment ProcessModelPart on ProcessModel {
  id
  key
  name
  description
  version
  createdBy
  created
  lastUpdated
  lastUpdatedBy
}
    `]))),q=(0,U.Ps)(re||(re=E()([`
    query processModels($where: ProcessModelWhereInput, $page: Int, $pageSize: Int, $orderBy: OrderBy) {
  result: processModels(
    where: $where
    page: $page
    pageSize: $pageSize
    orderBy: $orderBy
  ) {
    pageInfo {
      total
      totalPages
      current
      pageSize
    }
    edges {
      cursor
      node {
        ...ProcessModelPart
      }
    }
  }
}
    `,""])),Q);function J(_){var T=L()(L()({},C),_);return y.a(q,T)}function n(_){var T=_objectSpread(_objectSpread({},C),_);return Apollo.useLazyQuery(q,T)}function Pe(_){var T=_objectSpread(_objectSpread({},C),_);return Apollo.useSuspenseQuery(q,T)}var G=(0,U.Ps)(ae||(ae=E()([`
    query processModel($id: ID!) {
  processModel(id: $id) {
    ...ProcessModelPart
    editorJson
  }
}
    `,""])),Q);function ee(_){var T=L()(L()({},C),_);return y.a(G,T)}function ge(_){var T=_objectSpread(_objectSpread({},C),_);return Apollo.useLazyQuery(G,T)}function se(_){var T=_objectSpread(_objectSpread({},C),_);return Apollo.useSuspenseQuery(G,T)}var pe=(0,U.Ps)($||($=E()([`
    mutation importProcessModel($file: Upload!) {
  importProcessModel(file: $file) {
    ...ProcessModelPart
  }
}
    `,""])),Q);function he(_){var T=_objectSpread(_objectSpread({},C),_);return Apollo.useMutation(pe,T)}var te=(0,U.Ps)(g||(g=E()([`
    mutation deleteProcessModel($id: ID!) {
  deleteProcessModel(id: $id)
}
    `])));function ie(_){var T=L()(L()({},C),_);return fe.D(te,T)}},36473:function(je,Y,u){u.d(Y,{SP:function(){return c.SP},sW:function(){return c.sW}});var c=u(54278)},35107:function(je,Y,u){u.r(Y),u.d(Y,{default:function(){return tn}});var c=u(67294),L=u(96974),m=u(8032),E=u(35090),U=u(97857),y=u.n(U),fe=u(5574),P=u.n(fe),re=u(17647),ae=u(13769),$=u.n(ae),g=u(67802),C=u(46027),Q=u(4104);function q(){var e=(0,Q.u)(),t=e.getNodes,o=e.setNodes,s=(0,c.useCallback)(function(a){var r=t();o(r.filter(function(i){return i.id!==a}))},[t,o]);return{removeNode:s}}var J=q,n=u(85893),Pe=["data"];function G(e){var t=e.data,o=$()(e,Pe),s=J(),a=s.removeNode,r=(0,c.useCallback)(function(i){i.stopPropagation(),i.preventDefault(),a(o.id)},[o.id,a]);return(0,n.jsxs)("div",{className:"text-updater-node selectable",children:[(0,n.jsxs)("div",{className:"react-flow__node-header",children:[(0,n.jsx)("div",{className:"react-flow__node-icon",children:(0,n.jsx)(C.JO,{name:"Bootstrap/stop-circle"})}),(0,n.jsx)("div",{className:"react-flow__node-title",children:"\u7ED3\u675F"}),(0,n.jsx)("div",{onClick:r,className:"react-flow__node-header__delete",children:(0,n.jsx)(C.JO,{name:"Bootstrap/x"})})]}),(0,n.jsx)("div",{children:t.label}),(0,n.jsx)(m.HH,{type:"target",position:g.P.Top,id:"top"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Bottom,id:"bottom"}),(0,n.jsx)(m.HH,{type:"target",position:g.P.Left,id:"left"}),(0,n.jsx)(m.HH,{type:"target",position:g.P.Right,id:"right"})]})}G.info={icon:"Bootstrap/stop-circle",type:"EndNoneEvent",name:"\u7ED3\u675F"};var ee=G;function ge(e){var t=e.data;return console.log("data",t),(0,n.jsxs)("div",{className:"inner-container",children:[(0,n.jsx)("div",{className:"shape-diamond react-flow__node-header",children:(0,n.jsx)("div",{children:(0,n.jsx)(C.JO,{name:"Bootstrap/plus"})})}),(0,n.jsx)(m.HH,{type:"target",position:g.P.Top,id:"top"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Bottom,id:"bottom"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Left,id:"left"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Right,id:"right"})]})}ge.info={icon:"Bootstrap/diamond",type:"ExclusiveGateway",name:"\u6392\u5B83\u7F51\u5173"};var se=ge,pe=["data"];function he(e){var t=e.data,o=$()(e,pe),s=J(),a=s.removeNode,r=(0,c.useCallback)(function(i){i.stopPropagation(),i.preventDefault(),a(o.id)},[o.id,a]);return(0,n.jsxs)("div",{className:"text-updater-node selectable",children:[(0,n.jsxs)("div",{className:"react-flow__node-header",children:[(0,n.jsx)("div",{className:"react-flow__node-icon",children:(0,n.jsx)(C.JO,{name:"Bootstrap/filetype-java"})}),(0,n.jsx)("div",{className:"react-flow__node-title",children:"\u670D\u52A1\u4EFB\u52A1"}),(0,n.jsx)("div",{onClick:r,className:"react-flow__node-header__delete",children:(0,n.jsx)(C.JO,{name:"Bootstrap/x"})})]}),(0,n.jsx)("div",{children:t.label}),(0,n.jsx)(m.HH,{type:"target",position:g.P.Top,id:"top"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Bottom,id:"bottom"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Left,id:"left"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Right,id:"right"}),(0,n.jsx)("div",{className:"xxx",children:"123123"})]})}he.info={icon:"Bootstrap/filetype-java",type:"ServiceTask",name:"\u670D\u52A1\u4EFB\u52A1"};var te=he;function ie(e){var t,o=J(),s=o.removeNode,a=(0,c.useCallback)(function(r){r.stopPropagation(),r.preventDefault(),s(e.id)},[e.id,s]);return(0,n.jsxs)("div",{className:"text-updater-node selectable",children:[(0,n.jsxs)("div",{className:"react-flow__node-header",children:[(0,n.jsx)("div",{className:"react-flow__node-icon",children:(0,n.jsx)(C.JO,{name:"Bootstrap/play-fill"})}),(0,n.jsx)("div",{className:"react-flow__node-title",children:"\u5F00\u59CB"}),(0,n.jsx)("div",{onClick:a,className:"react-flow__node-header__delete",children:(0,n.jsx)(C.JO,{name:"Bootstrap/x"})})]}),(0,n.jsx)("div",{children:(t=e.data)===null||t===void 0?void 0:t.label}),(0,n.jsx)(m.HH,{type:"target",position:g.P.Top,id:"top"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Bottom,id:"bottom"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Left,id:"left"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Right,id:"right"})]})}ie.info={type:"StartNoneEvent",icon:"Bootstrap/play-fill",name:"\u5F00\u59CB"};var _=ie,T=["data"];function be(e){var t=e.data,o=$()(e,T),s=J(),a=s.removeNode,r=(0,c.useCallback)(function(i){i.stopPropagation(),i.preventDefault(),a(o.id)},[o.id,a]);return(0,n.jsxs)("div",{className:"text-updater-node selectable",children:[(0,n.jsx)(m.HH,{type:"target",position:g.P.Top}),(0,n.jsxs)("div",{className:"react-flow__node-header",children:[(0,n.jsx)("div",{className:"react-flow__node-icon",children:(0,n.jsx)(C.JO,{name:"Bootstrap/person-workspace"})}),(0,n.jsx)("div",{className:"react-flow__node-title",children:"\u5BA1\u6279"}),(0,n.jsx)("div",{onClick:r,className:"react-flow__node-header__delete",children:(0,n.jsx)(C.JO,{name:"Bootstrap/x"})})]}),(0,n.jsx)("div",{children:t.label}),(0,n.jsx)(m.HH,{type:"target",position:g.P.Top,id:"top"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Bottom,id:"bottom"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Left,id:"left"}),(0,n.jsx)(m.HH,{type:"source",position:g.P.Right,id:"right"})]})}be.info={icon:"Bootstrap/person-workspace",type:"UserTask",name:"\u7528\u6237\u4EFB\u52A1"};var me=be,Ce={StartNoneEvent:_,UserTask:me,ServiceTask:te,EndNoneEvent:ee,ExclusiveGateway:se},Ne={simple:[_.info,ee.info],classics:[_.info,ee.info,me.info,te.info,se.info],quick:[me.info,te.info,se.info]},Xe=function(t){return c.createElement(Ce[t],{data:{label:"\u62D6\u62FD\u9884\u89C8"}})},Ee=Ce;function Ue(e,t){var o=Math.round(e/32)*32,s=Math.round(t/32)*32;return[o,s]}var Qe={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"};function ze(e,t,o){if(!e||!t)return{display:"none"};var s=t.x,a=t.y;if(o){s-=e.x,a-=e.y;var r=Ue(s,a),i=P()(r,2);s=i[0],a=i[1],s+=e.x,a+=e.y}var l="translate(".concat(s,"px, ").concat(a,"px)");return{transform:l,WebkitTransform:l}}function We(){var e=(0,re.f)(function(r){return{item:r.getItem(),itemType:r.getItemType(),initialOffset:r.getInitialSourceClientOffset(),currentOffset:r.getSourceClientOffset(),isDragging:r.isDragging()}}),t=e.isDragging,o=e.itemType,s=e.initialOffset,a=e.currentOffset;return t?(0,n.jsx)("div",{style:Qe,children:(0,n.jsx)("div",{className:"react-flow__node-".concat(o),style:y()({},ze(s,a)),children:Xe(o)})}):null}var Ye=We,$e=u(5856),K=(0,c.createContext)({tools:{canUndo:!1,canRedo:!1,undo:function(){},redo:function(){},reset:function(){},resetInitialState:function(){},showQuickControls:function(){},hideQuickControls:function(){}},quickControls:{visible:!1},setState:function(){},state:{nodes:[],edges:[]}}),Se=function(){var t=(0,c.useContext)(K);return[t.quickControls,{show:t.tools.showQuickControls,hide:t.tools.hideQuickControls}]},we=function(){var t=(0,c.useContext)(K);return[t.state,t.setState]},Je=function(){var t=(0,c.useContext)(K),o=t.state,s=t.setState,a=(0,m.Rr)(o.nodes),r=P()(a,3),i=r[0],l=r[1],d=r[2],f=(0,c.useRef)(o);f.current=o;var h=(0,c.useCallback)(function(p){if(typeof p=="function"){var N=p(f.current.nodes);s(y()(y()({},f.current),{},{nodes:N}))}else s(y()(y()({},f.current),{},{nodes:p}))},[s]);return(0,c.useLayoutEffect)(function(){l(o.nodes)},[o.nodes,l]),[i,h,d]},Ge=function(){var t=(0,c.useContext)(K),o=t.state,s=t.setState,a=(0,m.ll)(o.edges),r=P()(a,3),i=r[0],l=r[1],d=r[2],f=(0,c.useRef)(o);f.current=o;var h=(0,c.useCallback)(function(p){if(typeof p=="function"){var N=p(f.current.edges);s(y()(y()({},f.current),{},{edges:N}))}else s(y()(y()({},f.current),{},{edges:p}))},[s]);return(0,c.useLayoutEffect)(function(){l(o.edges)},[o.edges,l]),[i,h,d]},le=function(){var t=(0,c.useContext)(K);return t.tools},Ke=function(t){var o=t.children,s=(0,$e.Z)({nodes:[],edges:[]},{behavior:"keepFuture"}),a=P()(s,3),r=a[0],i=a[1],l=a[2],d=l.undo,f=l.canUndo,h=l.redo,p=l.canRedo,N=l.reset,S=l.resetInitialState,w=(0,c.useState)({visible:!1,rect:void 0}),x=P()(w,2),D=x[0],O=x[1],v=(0,c.useCallback)(function(I,H){O({visible:!0,edgeId:I,rect:H})},[]),B=(0,c.useCallback)(function(){O({visible:!1})},[]);return(0,n.jsx)(K.Provider,{value:{state:r,setState:i,quickControls:D,tools:{undo:d,canRedo:p,redo:h,canUndo:f,reset:N,resetInitialState:S,showQuickControls:v,hideQuickControls:B}},children:o})},nn=u(38173),ke=u(98958),Ze=u(14313),De=u(47221),Ve=De.Z.Panel;function qe(e){var t=e.name,o=e.title,s=e.cover,a=e.createDragObject,r=a(e),i=(0,ke.c)({item:function(){return y()(y()({},r),{},{id:(0,E.DO)()})},type:r.type,collect:function(h){return{opacity:h.isDragging()?.4:1}}}),l=P()(i,2),d=l[1];return(0,n.jsxs)("li",{children:[(0,n.jsx)("div",{className:"component-icon",ref:d,children:(0,n.jsx)("img",{src:s,alt:o})}),(0,n.jsx)("div",{className:"component-info",children:o||t})]})}function et(){var e=(0,E.NX)(function(l){return l.project.data.template}),t=(0,E.vQ)(e),o=(0,c.useState)(t.map(function(l){return l.title})),s=P()(o,2),a=s[0],r=s[1],i=(0,c.useCallback)(function(l){r(typeof l=="string"?[l]:l)},[]);return(0,c.useEffect)(function(){r(t.map(function(l){return l.title}))},[t.map(function(l){return l.title}).join(",")]),(0,n.jsx)("div",{className:"componet-list-wrap",children:(0,n.jsx)(De.Z,{bordered:!1,activeKey:a,expandIcon:function(d){var f=d.isActive;return(0,n.jsx)(Ze.Z,{rotate:f?90:0})},className:"site-collapse-compactness-collapse",onChange:i,children:t.map(function(l){return(0,n.jsx)(Ve,{header:l.title,children:(0,n.jsx)("ul",{className:"component-content show-list",children:l.components.map(function(d){return(0,n.jsx)(qe,y()(y()({},d),{},{createDragObject:l.createDragObject,type:l.type}),d.name)})})},l.title)})})})}var tt=c.memo(et),nt=u(18446),ot=u.n(nt);function rt(e){var t=e.onBack,o=(0,E.fQ)(function(r){return r.ui.toolbar.tools}),s=(0,E.NX)(function(r){return r.ui.toolbar.tools.reduce(function(i,l){return i[l.id]=l.useSelector&&l.useSelector(r),i},{})},ot()),a=(0,c.useCallback)(function(){return t&&t()},[t]);return(0,n.jsxs)("div",{className:"sunmao-navigation",children:[(0,n.jsxs)("div",{className:"navigation-left",children:[(0,n.jsx)(C.ZP,{name:"AsanyEditor/ToolbarBack",onClick:a,className:"back-icon toolbar-icon"}),(0,n.jsx)("span",{className:"title",children:"SUNMAO "})]}),(0,n.jsxs)("div",{className:"sunmao-navigation-container",children:[(0,n.jsx)("div",{className:"toolbar-center",children:o.filter(function(r){return r.position==="left"&&r.isVisibled(s[r.id])}).map(E.ei,s)}),(0,n.jsx)("div",{className:"toolbar-right",children:o.filter(function(r){return r.position==="right"&&r.isVisibled(s[r.id])}).map(E.ei,s)})]})]})}var at=rt,st=u(49677),_e=u.n(st),it=u(93967),z=u.n(it),lt=u(1861),ct=u(23295);function dt(e){var t=e.children,o=e.type,s=(0,c.useCallback)(function(d){d.dataTransfer.setData("application/reactflow",o),d.dataTransfer.effectAllowed="move"},[o]),a=(0,ke.c)({item:function(){return{type:o}},type:o,collect:function(f){return{opacity:f.isDragging()?.4:1}}}),r=P()(a,3),i=r[1],l=r[2];return l((0,ct.r)(),{captureDraggingState:!0}),(0,n.jsx)("div",{ref:i,className:"flow-node",onDragStart:s,draggable:!0,children:t})}var ce=dt,ne=36,Be=ne+300;function ut(e){_e()(e);var t=(0,c.useState)(!1),o=P()(t,2),s=o[0],a=o[1],r=(0,c.useRef)({prevOutlinePaneHeight:Be,outlinePaneHeight:Be,outlinePaneExpanded:!0}),i=(0,c.useReducer)(function(v){return v+1},0),l=P()(i,2),d=l[1],f=(0,c.useCallback)(function(){r.current.outlinePaneExpanded=!r.current.outlinePaneExpanded,d()},[]),h=(0,c.useCallback)(function(){r.current.outlinePaneExpanded?r.current.prevOutlinePaneHeight=r.current.outlinePaneHeight:r.current.outlinePaneHeight=ne,a(!0)},[]),p=(0,c.useCallback)(function(v){r.current.outlinePaneHeight+=v,r.current.outlinePaneExpanded=r.current.outlinePaneHeight>ne,d()},[]),N=(0,c.useCallback)(function(){r.current.outlinePaneExpanded||(r.current.outlinePaneHeight=r.current.prevOutlinePaneHeight),a(!1)},[]),S=r.current,w=S.outlinePaneExpanded,x=S.outlinePaneHeight,D=window.innerHeight-50-40,O=Math.min(D,Math.max(x,ne));return O=w?O:ne,(0,n.jsxs)("div",{className:z()("sidebar-panel",{"resizer-y-active":s}),children:[(0,n.jsx)("div",{className:"sidebar-screen-panel",children:(0,n.jsxs)("div",{className:"sidebar-subpanel",children:[(0,n.jsxs)("div",{className:"sidebar-subpanel-header",children:[(0,n.jsx)("div",{className:"header-left",children:"\u57FA\u7840\u8282\u70B9"}),(0,n.jsx)("div",{className:"header-right"})]}),(0,n.jsx)(lt.E,{options:{scrollbars:{autoHide:"scroll"}},style:{height:"calc(100% - 38px)"},children:(0,n.jsxs)("div",{style:{padding:"8px 8px 0 8px"},children:[(0,n.jsx)(ce,{type:"StartNoneEvent",children:"\u5F00\u59CB"}),(0,n.jsx)(ce,{type:"EndNoneEvent",children:"\u7ED3\u675F"}),(0,n.jsx)(ce,{type:"UserTask",children:"\u7528\u6237\u4EFB\u52A1"})]})})]})}),(0,n.jsxs)(E.w_,{className:"sidebar-subpanel",direction:"y",onResizeStart:h,onResize:p,onResizeEnd:N,style:{flexBasis:O},children:[(0,n.jsxs)("div",{className:"sidebar-subpanel-header",children:[(0,n.jsx)("div",{className:"header-left",children:"\u7ECF\u5178"}),(0,n.jsx)("div",{className:"header-right",children:(0,n.jsx)(C.ZP,{onClick:f,className:z()("header-icon",{expanded:w}),name:"AsanyEditor/Arrow"})})]}),(0,n.jsx)("div",{className:"sidebar-subpanel-body",children:(0,n.jsx)("div",{className:"sidebar-node-types-classics",children:Ne.classics.map(function(v){return(0,n.jsxs)(ce,{type:v.type,children:[(0,n.jsx)(C.ZP,{name:v.icon}),v.name]},v.type)})})})]})]})}var vt=ut,ft=function(e){return e.SET_ELEMENTS="FLOW_SET_ELEMENTS",e}({});function gt(e,t){return t.type===E.hA.PluginStateInit?{}:t.type===ft.SET_ELEMENTS?y()(y()({},e),t.payload):e}var pt=u(70681),Oe=u.n(pt),Z=new(Oe()).graphlib.Graph;Z.setDefaultEdgeLabel(function(){return{}});var ht=function(t,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"TB",a=s==="LR";return Z.setGraph({rankdir:s,ranksep:80}),t.forEach(function(r){Z.setNode(r.id,{width:r.width,height:r.height})}),o.forEach(function(r){Z.setEdge(r.source,r.target)}),Oe().layout(Z),t.forEach(function(r){var i=Z.node(r.id);r.targetPosition=a?g.P.Left:g.P.Top,r.sourcePosition=a?g.P.Right:g.P.Bottom;var l=i.width,d=i.height;return r.position={x:i.x-l/2,y:i.y-d/2},r}),{nodes:t,edges:o}};function Te(){var e=(0,Q.u)(),t=e.getNodes,o=e.getEdges,s=we(),a=P()(s,2),r=a[1],i=(0,c.useCallback)(function(l){var d=t(),f=o();o();var h=ht(d,f,l),p=h.nodes,N=h.edges;r({nodes:p,edges:N})},[t,o,r]);return i}function mt(e){var t=e.className,o=e.disabled,s=e.active,a=e.style,r=e.children,i=Te(),l=(0,c.useCallback)(function(){i("TB")},[i]);return(0,n.jsx)("a",{onClick:l,className:z()("toolbar-icon",t,{disabled:o,active:s}),style:a,children:r})}function xt(e){var t=e.className,o=e.disabled,s=e.active,a=e.style,r=e.children,i=Te(),l=(0,c.useCallback)(function(){i("LR")},[i]);return(0,n.jsx)("a",{onClick:l,className:z()("toolbar-icon",t,{disabled:o,active:s}),style:a,children:r})}function yt(e){var t=e.className,o=e.style,s=e.children,a=le(),r=a.canUndo,i=a.undo;return(0,n.jsx)("a",{onClick:i,className:z()("toolbar-icon",t,{disabled:!r}),style:o,children:s})}function jt(e){var t=e.className,o=e.style,s=e.children,a=le(),r=a.canRedo,i=a.redo;return(0,n.jsx)("a",{onClick:i,className:z()("toolbar-icon",t,{disabled:!r}),style:o,children:s})}var Pt=u(98169),bt=u(56022),Ct=u(734),Nt=u(65362),Et=u(73935),St=u(69293);function wt(e){var t=(0,c.useRef)(null),o=(0,g.b)(function(x){return x.transform[2]}),s=Se(),a=P()(s,2),r=a[0],i=r.visible,l=r.rect,d=a[1].hide,f=(0,Q.u)(),h=f.project,p=e.flowContainer;(0,St.Z)(t,function(){d()});var N=(0,c.useMemo)(function(){if(!i||!p.current||!t.current||!l)return{transform:"translate(0px, 0px)",opacity:0,pointerEvents:"unset"};var x=p.current.getBoundingClientRect(),D=x.top,O=x.left,v=t.current.getBoundingClientRect().height,B=l.x,I=l.y,H=l.width,R=l.height;if(o!==1){var F=o<1?100/o*(1-o)/100+1:100/o/100,W=h({x:B+H-O+10,y:I-D+R/2-v/2});return console.log("scale",o,F),{transform:"translate(".concat(W.x,"px, ").concat(W.y,"px) scale(").concat(F,")"),transformOrigin:"0 0"}}var V=h({x:B+H-O,y:I-D+R/2-v/2});return{transform:"translate(".concat(V.x,"px, ").concat(V.y,"px)")}},[p,h,l,i,o]),S=(0,n.jsxs)("div",{ref:t,className:"quick-controls",style:N,children:[(0,n.jsx)("div",{className:"quick-controls-arrow",children:(0,n.jsx)("span",{className:"quick-controls-arrow-content"})}),Ne.quick.map(function(x){return(0,n.jsxs)("div",{className:z()("flow-node-type","quick-controls__node-".concat(x.type)),children:[(0,n.jsx)("div",{className:"flow-node-type-icon",children:(0,n.jsx)(C.JO,{name:x.icon})}),(0,n.jsx)("div",{className:"flow-node-type-label",children:x.name})]},x.type)}),(0,n.jsx)("div",{className:"flow-node-type-separator"}),(0,n.jsxs)("div",{className:"flow-node-type",children:[(0,n.jsx)("div",{className:"flow-node-type-icon",children:(0,n.jsx)(C.JO,{name:"Bootstrap/gear"})}),(0,n.jsx)("div",{className:"flow-node-type-label",children:"\u8BBE\u7F6E"})]})]}),w=document.querySelector(".react-flow__viewport");return w?Et.createPortal(S,w):(0,n.jsx)(c.Fragment,{})}var kt=wt;function Dt(e,t){var o,s,a=(o=e[g.i])===null||o===void 0?void 0:o.handleBounds;if(!a)return[0,0];var r=a==null||(s=a.source)===null||s===void 0?void 0:s.find(function(p){return p.position===t});if(!r){var i;r=a==null||(i=a.target)===null||i===void 0?void 0:i.find(function(p){return p.position===t})}if(!r)return[0,0];var l=r.width/2,d=r.height/2,f=e.positionAbsolute.x+r.x+l,h=e.positionAbsolute.y+r.y+d;return[f,h]}function Me(e){return{x:e.positionAbsolute.x+e.width/2,y:e.positionAbsolute.y+e.height/2}}function He(e,t){var o=Me(e),s=Me(t),a=Math.abs(o.x-s.x),r=Math.abs(o.y-s.y),i;a>r?i=o.x>s.x?g.P.Left:g.P.Right:i=o.y>s.y?g.P.Top:g.P.Bottom;var l=Dt(e,i),d=P()(l,2),f=d[0],h=d[1];return[f,h,i]}function Fe(e,t){var o=He(e,t),s=P()(o,3),a=s[0],r=s[1],i=s[2],l=He(t,e),d=P()(l,3),f=d[0],h=d[1],p=d[2];return{sourceX:a,sourceY:r,targetX:f,targetY:h,sourcePosition:i,targetPosition:p}}function _t(e){var t=e.targetX,o=e.targetY,s=e.sourcePosition,a=e.targetPosition,r=e.sourceNode;if(!r)return null;var i={id:"connection-target",width:1,height:1,positionAbsolute:{x:t,y:o}},l=Fe(r,i),d=l.sourceX,f=l.sourceY,h=(0,m.OW)({sourceX:d,sourceY:f,sourcePosition:s,targetPosition:a,targetX:t,targetY:o});return(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fill:"none",stroke:"#222",strokeWidth:1.5,className:"animated",d:h}),(0,n.jsx)("circle",{cx:t,cy:o,fill:"#fff",r:3,stroke:"#222",strokeWidth:1.5})]})}var Bt=_t;function Ie(e,t){var o=e.width,s=e.height,a=e.positionAbsolute,r=t.positionAbsolute,i=o/2,l=s/2,d=a.x+i,f=a.y+l,h=r.x+i,p=r.y+l,N=(h-d)/(2*i)-(p-f)/(2*l),S=(h-d)/(2*i)+(p-f)/(2*l),w=1/(Math.abs(N)+Math.abs(S)),x=w*N,D=w*S,O=i*(x+D)+d,v=l*(-x+D)+f;return{x:O,y:v}}function Re(e,t){var o=y()(y()({},e.positionAbsolute),e),s=Math.round(o.x),a=Math.round(o.y),r=Math.round(t.x),i=Math.round(t.y);return r<=s+1?g.P.Left:r>=s+o.width-1?g.P.Right:i<=a+1?g.P.Top:i>=o.y+o.height-1?g.P.Bottom:g.P.Top}function Ot(e,t){var o=Ie(e,t),s=Ie(t,e),a=Re(e,o),r=Re(t,s);return{sx:o.x,sy:o.y,tx:s.x,ty:s.y,sourcePos:a,targetPos:r}}function Tt(e){var t=e.id,o=e.source,s=e.target,a=e.markerEnd,r=e.style,i=(0,g.b)((0,c.useCallback)(function(D){return D.nodeInternals.get(o)},[o])),l=(0,g.b)((0,c.useCallback)(function(D){return D.nodeInternals.get(s)},[s]));if(!i||!l)return null;var d=Ot(i,l),f=d.sx,h=d.sy,p=d.tx,N=d.ty,S=d.sourcePos,w=d.targetPos,x=(0,m.OW)({sourceX:f,sourceY:h,sourcePosition:S,targetPosition:w,targetX:p,targetY:N});return(0,n.jsx)("g",{className:"react-flow__connection",children:(0,n.jsx)("path",{id:t,className:"react-flow__edge-path",d:x,markerEnd:a,style:r})})}var Mt=Tt,de=40;function Ht(e){var t=e.id,o=e.source,s=e.target,a=e.markerEnd,r=e.style,i=(0,g.b)((0,c.useCallback)(function(M){return M.nodeInternals.get(o)},[o])),l=(0,g.b)((0,c.useCallback)(function(M){return M.nodeInternals.get(s)},[s])),d=(0,c.useRef)(null),f=(0,g.b)(function(M){return M.transform[2]}),h=Se(),p=P()(h,2),N=p[0].edgeId,S=p[1].show,w=(0,c.useCallback)(function(M){M.preventDefault(),M.stopPropagation();var A=d.current.getBoundingClientRect(),b=A.x,j=A.y,k=A.width,X=A.height;S(t,{x:b,y:j,width:k,height:X})},[t,S]);if((0,c.useEffect)(function(){if(N===t){var M=d.current.getBoundingClientRect(),A=M.x,b=M.y,j=M.width,k=M.height;S(t,{x:A,y:b,width:j,height:k})}},[N,t,S,f]),!i||!l)return null;var x=Fe(i,l),D=x.sourceX,O=x.sourceY,v=x.targetX,B=x.targetY,I=x.sourcePosition,H=x.targetPosition,R=(0,m.OW)({sourceX:D,sourceY:O,sourcePosition:I,targetPosition:H,targetX:v,targetY:B}),F=(0,m.Pp)({sourceX:D,sourceY:O,sourcePosition:I,targetPosition:H,targetX:v,targetY:B}),W=P()(F,2),V=W[0],xe=W[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{id:t,className:"react-flow__edge-path",d:R,markerEnd:a,style:r}),(0,n.jsx)("foreignObject",{width:de,height:de,x:V-de/2,y:xe-de/2,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:(0,n.jsx)("div",{className:"edge-container",onClick:w,children:(0,n.jsx)("button",{ref:d,type:"button",className:"edgebutton",children:(0,n.jsx)(C.JO,{name:"Bootstrap/plus"})})})})]})}var Ft=Ht,ue=40;function It(e){var t=e.id,o=e.sourceX,s=e.sourceY,a=e.targetX,r=e.targetY,i=e.sourcePosition,l=e.targetPosition,d=e.style,f=d===void 0?{}:d,h=e.markerEnd,p=(0,m.OW)({sourceX:o,sourceY:s,sourcePosition:i,targetX:a,targetY:r,targetPosition:l}),N=(0,m.Pp)({sourceX:o,sourceY:s,targetX:a,targetY:r}),S=P()(N,2),w=S[0],x=S[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{id:t,style:f,className:"react-flow__edge-path",d:p,markerEnd:h}),(0,n.jsx)("foreignObject",{width:ue,height:ue,x:w-ue/2,y:x-ue/2,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:(0,n.jsx)("div",{className:"edge-container",children:(0,n.jsx)("button",{type:"button",className:"edgebutton",children:(0,n.jsx)(C.JO,{name:"Bootstrap/plus"})})})})]})}var Rt={buttonedge:It,floating:Mt,simple_floating:Ft},Lt=0,At=function(){return"dndnode_".concat(Lt++)},Xt=function(t){var o=(0,c.useRef)(null),s=Je(),a=P()(s,3),r=a[0],i=a[1],l=a[2],d=Ge(),f=P()(d,3),h=f[0],p=f[1],N=f[2],S=(0,c.useState)(null),w=P()(S,2),x=w[0],D=w[1],O=le(),v=O.hideQuickControls,B=(0,c.useCallback)(function(b){b.source!==b.target&&p(function(j){return(0,g.c)(y()(y()({},b),{},{type:"simple_floating"}),j)})},[p]),I=(0,c.useCallback)(function(b){b.preventDefault(),b.dataTransfer.dropEffect="move"},[]),H=(0,Pt.L)({accept:Object.keys(Ee),drop:function(j){return j},canDrop:function(j,k){return k.isOver({shallow:!0})},collect:function(j){return{isOver:j.isOver(),isOverCurrent:j.isOver({shallow:!0}),handlerId:j.getHandlerId()}}}),R=P()(H,2);_e()(R[0]);var F=R[1];F(o);var W=(0,c.useCallback)(function(b){var j;b.preventDefault();var k=(j=o.current)===null||j===void 0?void 0:j.getBoundingClientRect(),X=b.dataTransfer.getData("application/reactflow");if(!(typeof X=="undefined"||!X||!k)){var oe=x.project({x:b.clientX-k.left,y:b.clientY-k.top}),ve={id:At(),type:X,position:oe,data:{label:"".concat(X," node")}};i(function(ye){return ye.concat(ve)})}},[x,i]),V=(0,c.useCallback)(function(b,j,k){console.log(j,k),i(function(X){return X.map(function(oe){var ve=k.findIndex(function(ye){return ye.id===oe.id});return ve>-1?y()(y()({},oe),{},{position:k[ve].position}):oe})})},[i]),xe=(0,c.useCallback)(function(b){var j=b.target.classList.contains("react-flow__pane");console.log("targetIsPane",j)},[]),M=t.onClick,A=(0,c.useCallback)(function(b){var j=b.target.classList.contains("react-flow__pane");j&&(M(b),v())},[v,M]);return(0,n.jsx)("div",{className:"reactflow-wrapper",style:{height:"100%"},ref:o,children:(0,n.jsxs)(m.ZP,{nodes:r,edges:h,onClick:A,onNodesChange:l,onEdgesChange:N,onEdgeClick:t.onEdgeClick,onNodeClick:t.onNodeClick,onNodesDelete:t.onNodesDelete,onEdgesDelete:t.onEdgesDelete,onNodeDragStop:V,onConnect:B,onConnectStop:xe,onInit:D,onDrop:W,onDragOver:I,fitView:!0,attributionPosition:"top-right",proOptions:{account:"paid-pro",hideAttribution:!0},edgeTypes:Rt,nodeTypes:Ee,connectionLineComponent:Bt,children:[(0,n.jsx)(bt.Z,{nodeStrokeColor:function(j){var k;return(k=j.style)!==null&&k!==void 0&&k.background?j.style.background:j.type==="StartNoneEvent"?"#0041d0":j.type==="EndNoneEvent"?"#ff0072":["UserTask","ExclusiveGateway"].includes(j.type)?"#1a192b":"#eee"},nodeColor:function(j){var k;return(k=j.style)!==null&&k!==void 0&&k.background?j.style.background:"#fff"},nodeBorderRadius:2}),(0,n.jsx)(Ct.i,{}),(0,n.jsx)(Nt.Z,{color:"#aaa",gap:16}),(0,n.jsx)(kt,{flowContainer:o})]})})},Ut=Xt,Qt=u(64599),zt=u.n(Qt);function Le(e,t){var o;return(o=t.find(function(s){return s.outgoing.some(function(a){return a.resourceId===e})}))===null||o===void 0?void 0:o.resourceId}function Ae(e){return e.target.resourceId}function Wt(e){var t={nodes:[],edges:[]},o=e.childShapes,s=o.filter(function(l){return l.stencil.id!=="SequenceFlow"}),a=zt()(o),r;try{for(a.s();!(r=a.n()).done;){var i=r.value;i.stencil.id==="SequenceFlow"?(t.edges.push({id:i.resourceId,type:"simple_floating",source:Le(i.resourceId,s),target:Ae(i),label:i.properties.name||"\u7EBF",markerEnd:{type:g.M.ArrowClosed}}),console.log(Le(i.resourceId,s),Ae(i))):(t.nodes.push({id:i.resourceId,type:i.stencil.id,data:{label:i.properties.name},position:{x:i.bounds.upperLeft.x,y:i.bounds.upperLeft.y}}),console.log("shape",i.stencil.id,i.resourceId,i.properties.name))}}catch(l){a.e(l)}finally{a.f()}return t}var Yt={title:"\u8282\u70B9\u8BBE\u7F6E",fields:[{label:" \u7F16\u7801",name:"id",type:"String"},{label:"\u540D\u79F0",name:"label",type:"String"},{label:"\u63CF\u8FF0",name:"documentation",type:"String",renderer:{component:"MultiLineText",props:{autoSize:{minRows:2,maxRows:4}}}}]},$t={title:"\u6761\u4EF6\u8BBE\u7F6E",fields:[{label:" \u7F16\u7801",name:"id",type:"String"},{label:"\u540D\u79F0",name:"label",type:"String"},{label:"\u63CF\u8FF0",name:"documentation",type:"String",renderer:{component:"MultiLineText",props:{autoSize:{minRows:2,maxRows:4}}}}]};function Jt(){var e=(0,E.pn)(),t=(0,E.NX)(function(v){return v.ui.sidebar.width}),o=(0,E.NX)(function(v){return v.ui.sidebar.minWidth}),s=(0,E.NX)(function(v){return v.ui.sidebar.minimizable}),a=(0,c.useMemo)(function(){var v=t;return s?v=0:v=Math.max(o,v),v},[t,s,o]),r=we(),i=P()(r,2),l=i[1],d=le(),f=d.reset,h=d.resetInitialState,p=(0,E.NX)(function(v){var B;return(B=v.project.data)===null||B===void 0?void 0:B.editorJson});(0,c.useEffect)(function(){if(p){var v=Wt(JSON.parse(p));l(v),h(v),f(v)}},[p]);var N=(0,c.useCallback)(function(){e.aside.close()},[e.aside]),S=(0,c.useCallback)(function(v,B){v.preventDefault(),v.stopPropagation();var I=function(F){console.log("handleUpdate",F)};console.log("handleNodeClick",v,B);var H={label:B.data.label,id:B.id};e.aside.open({customizer:Yt,value:H,update:I,watchValue:function(F){F(H)}},{width:280})},[e.aside]),w=(0,c.useCallback)(function(v,B){v.preventDefault(),v.stopPropagation();var I=function(F){console.log("handleUpdate",F)};console.log("handleNodeClick",v,B);var H={label:"1111"};e.aside.open({customizer:$t,value:H,update:I,watchValue:function(F){F(H)}},{width:280})},[e.aside]),x=(0,c.useCallback)(function(){e.aside.close()},[e.aside]),D=(0,c.useCallback)(function(){e.aside.close()},[e.aside]),O=(0,E.NX)(function(v){return v.ui.sidebar.minimizable});return console.log("minimizable",O),(0,n.jsx)("div",{style:{height:"100%",width:"100%",marginLeft:a},children:(0,n.jsx)(Ut,{onClick:N,onNodeClick:S,onEdgeClick:w,onNodesDelete:x,onEdgesDelete:D})})}var Gt=c.memo(Jt),Kt=function(){return{id:"workflow",description:"",types:["flow"],toolbar:{content:at,tools:[{id:"save",name:"\u4FDD\u5B58",position:"left",onClick:function(t){var o=t.state.project;console.log("onClick  project",o),t.save({})}}]},reducer:gt,sidebar:{minimizable:!1,content:function(){return(0,n.jsx)(vt,{})},tools:[{id:"components",icon:"AsanyEditor/LayoutGrid",name:"\u7EC4\u4EF6",position:"top",mutex:"left",onClick:function(t){return t.sidebar.open("components","\u7EC4\u4EF6",tt)}},{id:"drag",name:"\u62D6\u62FD\u753B\u5E03",icon:"AsanyEditor/HandDrag",position:"top",useSelector:function(t){return t.features.drag},isSelected:function(t){return t},onClick:function(t){return t.features.drag(!0),function(){t.features.drag(!1)}}},{id:"selecto",name:"\u9009\u62E9",icon:"AsanyEditor/SelectFilled",position:"top",mutex:"icons-actions",useSelector:function(t){return t.features.selecto},isSelected:function(t){return t},onClick:function(t){return t.features.selecto(!0),function(){t.features.selecto(!1)}}}]},scena:{screen:"fullscreen",toolbar:{tools:[{id:"undo",icon:"Bootstrap/arrow-90deg-left",position:"left",render:function(t,o){return(0,n.jsx)(yt,y()(y()({},o),{},{item:t}))}},{id:"redo",icon:"Bootstrap/arrow-90deg-right",position:"left",render:function(t,o){return(0,n.jsx)(jt,y()(y()({},o),{},{item:t}))}},{id:"vertical-divider"},{id:"horizontal",name:"\u6C34\u5E73\u5BF9\u9F50",icon:"AsanyEditor/AlignHorizontalCenters",position:"left",render:function(t,o){return(0,n.jsx)(mt,y()(y()({},o),{},{item:t}))}},{id:"vertical-divider"},{id:"vertical",name:"\u5782\u76F4\u5BF9\u9F50",icon:"AsanyEditor/AlignVerticalCenters",position:"left",render:function(t,o){return(0,n.jsx)(xt,y()(y()({},o),{},{item:t}))}}]},workspace:Gt},features:[]}};function Zt(e){var t=(0,c.useRef)(null),o=e.loading,s=e.onBack,a=e.data,r=(0,c.useCallback)(function(){},[]),i=(0,c.useMemo)(function(){return a?{id:a.id,type:"flow",name:(a==null?void 0:a.name)||"",data:a}:{type:"flow"}},[a]);return(0,n.jsxs)(m.tV,{children:[(0,n.jsx)(E.lR,{children:(0,n.jsx)(E.lg,{container:Ke,ref:t,plugins:[Kt()],onSave:r,onBack:s,loading:o,className:"flow-editor",project:i})}),(0,n.jsx)(Ye,{})]})}var Vt=Zt,qt=u(36473);function en(){var e=(0,L.UO)(),t=e.id,o=(0,L.s0)(),s=(0,qt.sW)({variables:{id:t},fetchPolicy:"cache-and-network"}),a=s.data,r=s.loading,i=(0,c.useCallback)(function(){o(-1)},[o]);return(0,n.jsx)(Vt,{onBack:i,loading:r,data:a==null?void 0:a.processModel})}var tn=en}}]);
