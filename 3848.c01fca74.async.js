(self.webpackChunk=self.webpackChunk||[]).push([[3848],{78277:function(se,V,r){"use strict";r.d(V,{Z:function(){return z}});var X=r(62435),c=r(12845),S=r(75981),P=r(90875);function Q(){var E=(0,c.useModel)("tenant"),d=E.state,a=E.reload,i=(0,c.useApp)(),h=(0,P.Z)(),f=h.data;return(0,X.useEffect)(function(){d||(i&&i.type===S.vQ.Native?(console.log("useCurrentTenant By Native"),a(i.clientId)):f&&i.type===S.vQ.SaaS&&(console.log("useCurrentTenant By SaaS"),a(i.clientId)))},[i,f]),{tenant:d,loading:!1,error:""}}var w=Q;function le(E){var d=w(),a=d.tenant,i=a==null?void 0:a.modules.find(function(h){return h.key===E});return[i]}var z=le},14336:function(se,V,r){"use strict";var X=r(15009),c=r.n(X),S=r(99289),P=r.n(S),Q=r(97857),w=r.n(Q),le=r(5574),z=r.n(le),E=r(62435),d=r(2721),a=r(12708);function i(f,p){return f.replace(/{(\w+)}/g,function(g,B){return p[B]!==void 0?p[B]:g})}function h(f,p){var g=f(w()({fetchPolicy:"network-only"},(p==null?void 0:p.mutation)||{})),B=z()(g,1),$=B[0],q=(0,E.useRef)(!1),ee=(0,E.useRef)(null),me=(0,E.useCallback)(function(){var he=P()(c()().mark(function fe(b,re){var ge,Me,je,ye,W,t,ie,Ce,ve;return c()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return ge=(re==null?void 0:re.dialog)||(p==null?void 0:p.dialog)||{},Me=(re==null?void 0:re.mutation)||(p==null?void 0:p.mutation)||{},je=(re==null?void 0:re.onDeleted)||(p==null?void 0:p.onDeleted),ye=ge.width,W=ge.title,t=ge.content,ie=!1,Array.isArray(b)?(ie=!0,typeof W=="function"&&(W=W(b,{batch:!0})),typeof t=="function"&&(t=t(b,{batch:!0}))):b&&(typeof W=="string"&&(W=i(W,b)),typeof t=="string"&&(t=i(t,b)),typeof W=="function"&&(W=W(b,{batch:!1})),typeof t=="function"&&(t=t(b,{batch:!1}))),Ce=function(){var De=P()(c()().mark(function e(){return c()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,$(w()(w()({fetchPolicy:"network-only"},Me),{},{variables:{where:{id_in:ie?b:[b==null?void 0:b.id]}}}));case 2:case"end":return ue.stop()}},e)}));return function(){return De.apply(this,arguments)}}(),G.next=10,d.Modal.confirm(w()(w()({},ge),{},{title:W,content:t,width:ye,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!q.current},preConfirm:function(){var De=P()(c()().mark(function _e(){var ue,be,Pe;return c()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return q.current=!0,ee.current=null,O.prev=2,ue=document.querySelector(".swal2-confirm"),ue.textContent="\u5220\u9664\u4E2D...",be=document.createElement("span"),be.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),ue.appendChild(be),O.next=10,(0,a.gw)(Ce(),350);case 10:Pe=O.sent,je&&je(b,Pe),O.next=17;break;case 14:O.prev=14,O.t0=O.catch(2),ee.current=O.t0;case 17:return O.prev=17,q.current=!1,O.finish(17);case 20:case"end":return O.stop()}},_e,null,[[2,14,17,20]])}));function e(){return De.apply(this,arguments)}return e}()}));case 10:if(ve=G.sent,!ee.current){G.next=14;break}return d.Toast.error("\u5220\u9664\u5931\u8D25:"+ee.current.message,2e3,{placement:"top-center",progressBar:!0}),G.abrupt("return",!1);case 14:if(ve.isConfirmed){G.next=16;break}return G.abrupt("return",!1);case 16:return d.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),G.abrupt("return",!0);case 18:case"end":return G.stop()}},fe)}));return function(fe,b){return he.apply(this,arguments)}}(),[]),Se=(0,E.useCallback)(function(he,fe){return me(he,fe)},[p,$]),we=(0,E.useCallback)(function(he,fe){return me(he,fe)},[]);return{delete:Se,deleteMany:we}}V.Z=h},58301:function(se,V,r){"use strict";r.d(V,{Oh:function(){return le},bp:function(){return z}});var X=r(97857),c=r.n(X),S=r(62435);function P(E,d){var a,i,h=E(c()({fetchPolicy:"network-only"},d)),f=h.data,p=h.loading,g=h.previousData,B=h.refetch,$=h.error,q=(0,S.useMemo)(function(){return p?g==null?void 0:g.result.pageInfo:f==null?void 0:f.result.pageInfo},[f==null||(a=f.result)===null||a===void 0?void 0:a.pageInfo.total,p,g==null||(i=g.result)===null||i===void 0?void 0:i.pageInfo.total]),ee=(0,S.useMemo)(function(){return f!=null&&f.result?f.result.edges.map(function(me){return me.node}):p&&g!==null&&g!==void 0&&g.result?g.result.edges.map(function(me){return me.node}):[]},[p,f==null?void 0:f.result,g==null?void 0:g.result]);return[ee,{loading:p,pageInfo:q,error:$,variables:{},refetch:B}]}function Q(E,d){return d.split(".").reduce(function(a,i){return a&&a[i]!==void 0?a[i]:void 0},E)}function w(E,d,a){for(var i=d.split("."),h=E;i.length>1;){var f=i.shift();h[f]||(h[f]={}),h=h[f]}h[i[0]]=a}function le(E,d){var a=d.map(function(i){var h=i.source,f=i.target,p=i.transform,g=i.skip,B=Q(E,h);if(B==null||g&&g(B))return"";var $=p?p(B):String(B);return"".concat(encodeURIComponent(f||h),"=").concat(encodeURIComponent($))});return a.filter(function(i){return i}).join("&")}function z(E,d){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=a;return d.forEach(function(h){var f=h.source,p=h.target,g=h.transform,B=h.skip,$=E.get(f);if(!(!$||$.trim()==="")){var q=g?g($):$;B&&B(q)||(p?w(i,p,q):i[f]=q)}}),i}V.ZP=P},80537:function(se,V,r){"use strict";var X=r(14336),c=r(96944),S=r(86074);function P(Q){var w=(0,X.Z)(c.nT,{onDeleted:function(){Q&&Q()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(d,a){var i;if(a.batch){var h=d;i="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(h.length," \u7BC7\u6587\u7AE0\u5417\uFF1F")}else i=(0,S.jsxs)(S.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,S.jsx)("strong",{children:d.title})]});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{className:"tip-confirm",children:i}),(0,S.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),le=w.delete,z=w.deleteMany;return{delete:le,deleteMany:z}}V.Z=P},36875:function(se,V,r){"use strict";r.r(V),r.d(V,{default:function(){return Qe}});var X=r(97857),c=r.n(X),S=r(15009),P=r.n(S),Q=r(64599),w=r.n(Q),le=r(99289),z=r.n(le),E=r(5574),d=r.n(E),a=r(62435),i=r(96974),h=r(39711),f=r(46027),p=r(30381),g=r.n(p),B=r(78277),$=r(14336),q=r(52677),ee=r.n(q),me=r(61227),Se=r.n(me),we=r(32512),he=r(93162),fe=r.n(he),b=r(84105),re=function(u){var A=u.split(`
`);return A.map(function(D){return D.split(",")})},ge=function(u,A){var D=Se()(u),N=D[0],K=D.slice(1);return K.map(function(M){for(var _={},m=0,Y=Object.keys(A.fields);m<Y.length;m++){var x=Y[m],C=A.fields[x];typeof C=="number"?_[x]=M[C]:typeof C=="string"?_[x]=M[N.indexOf(C)]:ee()(C)==="object"&&(_[x]=typeof C.index=="string"?M[N.indexOf(C.index)]:M[C.index],C.formatter&&(_[x]=C.formatter(_[x])))}return _})};function Me(y,u){var A=(0,a.useCallback)(function(x){var C=x[0];if(C){var R=new FileReader;R.onload=function(te){var ne=C.name.split(".").pop().toLowerCase();if(ne==="csv"){var k=te.target.result,oe=re(k);console.log("Parsed CSV Data:",oe)}else if(ne==="xls"||ne==="xlsx"){var ae=te.target.result,L=b.ij(ae,{type:"binary"}),J=L.SheetNames[0],I=L.Sheets[J],Z=b.P6.sheet_to_json(I,{header:u.header||1,raw:!1,dateNF:"yyyy-mm-dd hh:mm:ss"}),U=ge(Z,u);console.log("Formatted JSON Data:",U),y(U)}else console.error("Unsupported file type")},C.type==="text/csv"||C.name.endsWith(".csv")?R.readAsText(C):R.readAsBinaryString(C)}},[y]),D=(0,we.uI)({onDrop:A,accept:{"text/csv":[".csv"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},maxFiles:1}),N=D.getRootProps,K=D.getInputProps,M=N(),_=M.onClick,m=(0,a.useCallback)(function(x){console.log("handleImportExcel"),_&&_(x)},[_]),Y=(0,a.useCallback)(function(){var x,C,R=Object.keys(u.fields).map(function(ce){var s=u.fields[ce];return ee()(s)==="object"&&s.name||ce}),te=Object.keys(u.fields).map(function(ce){var s=u.fields[ce];return ee()(s)==="object"&&s.example||""}),ne=[R,te],k=b.P6.aoa_to_sheet(ne);(x=u.template)!==null&&x!==void 0&&x.cols&&(k["!cols"]=u.template.cols);for(var oe=0,ae=1;ae<oe;ae++)for(var L=0;L<R.length;L++){var J=b.P6.encode_cell({r:ae,c:L});k[J]||(k[J]={v:null});var I=u.fields[R[L]];if(ee()(I)==="object"){switch(I.type){case"date":k[J].t="d";break}I.format&&(k[J].z=I.format)}}var Z=b.P6.book_new();b.P6.book_append_sheet(Z,k,"Sheet1");var U=b.cW(Z,{bookType:"xlsx",type:"array"}),de=new Blob([U],{type:"application/octet-stream"});fe()(de,((C=u.template)===null||C===void 0?void 0:C.filename)||"template.xlsx")},[u]);return[(0,a.createElement)("input",c()(c()({},K()),{},{key:"file-input",value:""})),m,Y,{data:{},error:"",handleImportExcel:m}]}var je=Me,ye=r(58301),W=r(73588),t=r(2721),ie=r(42646),Ce=r(75981),ve=r(12708),ke=r(5618),G=r(80537),De=r(96944),e=r(86074);function _e(y,u){var A=t.Form.useForm(),D=(0,a.useState)(!1),N=d()(D,2),K=N[0],M=N[1],_=u||{},m=_.messages,Y=_.onSubmitted,x=Y===void 0?function(){}:Y,C=_.transform,R=C===void 0?function(I){return I}:C,te=(0,De.uw)({fetchPolicy:"no-cache",refetchQueries:u==null?void 0:u.refetchQueries}),ne=d()(te,1),k=ne[0],oe=(0,De.Mq)({fetchPolicy:"no-cache",refetchQueries:u==null?void 0:u.refetchQueries}),ae=d()(oe,1),L=ae[0],J=(0,a.useMemo)(function(){return y!=null&&y.id?z()(P()().mark(function I(){var Z,U,de;return P()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return M(!0),s.prev=1,s.t0=R,s.next=5,A.validateFields();case 5:return s.t1=s.sent,Z=(0,s.t0)(s.t1),s.next=9,t.Toast.promise((0,ve.gw)(L({variables:{id:y.id,input:c()({},Z)}}),350),{pending:(m==null?void 0:m.pending)||"\u4FDD\u5B58\u4E2D...",success:{render:function(){return(0,e.jsxs)(e.Fragment,{children:["\u8DEF\u7531 ",(0,e.jsx)("strong",{children:Z.name})," \u4FDD\u5B58\u6210\u529F"]})}},error:(m==null?void 0:m.error)||"\u4FDD\u5B58\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 9:U=s.sent,de=U.data,x(de.updateArticle),M(!1),s.next=18;break;case 15:s.prev=15,s.t2=s.catch(1),M(!1);case 18:case"end":return s.stop()}},I,null,[[1,15]])})):z()(P()().mark(function I(){var Z,U,de;return P()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return M(!0),s.prev=1,s.t0=R,s.next=5,A.validateFields();case 5:return s.t1=s.sent,Z=(0,s.t0)(s.t1),s.next=9,t.Toast.promise((0,ve.gw)(k({variables:{input:c()({},Z)}}),350),{pending:(m==null?void 0:m.pending)||"\u63D0\u4EA4\u4E2D...",success:{render:(m==null?void 0:m.pending)||"\u63D0\u4EA4\u6210\u529F"},error:(m==null?void 0:m.error)||"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 9:U=s.sent,de=U.data,x(de.createArticle),M(!1),s.next=18;break;case 15:s.prev=15,s.t2=s.catch(1),M(!1);case 18:case"end":return s.stop()}},I,null,[[1,15]])}))},[k,y==null?void 0:y.id,A,x,L,R]);return[J,{form:A,submitting:K}]}var ue=_e;function be(y){var u=y.form;return(0,a.useEffect)(function(){var A,D=y.data;D.id||u.resetFields(),u.setFieldsValue(c()(c()({},D),{},{tags:(D.tags||[]).map(function(N){return N.name}),content:(A=D.content)===null||A===void 0?void 0:A.rawUrl.replace("storage://","").split("/").pop()}))},[u,y.data]),(0,e.jsxs)(t.Form,{form:u,children:[(0,e.jsx)(t.Row,{children:(0,e.jsx)(t.Col,{span:6,children:(0,e.jsx)(t.Form.Item,{name:"title",className:"d-flex flex-column mb-7",required:!0,label:"CMMF CODE",rules:[{required:!0,message:"CMMF CODE\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(t.Input,{solid:!0})})})}),(0,e.jsx)(t.Row,{children:(0,e.jsx)(t.Col,{span:6,children:(0,e.jsx)(t.Form.Item,{name:"tags",className:"d-flex flex-column mb-7",required:!0,label:"WMF CODE",children:(0,e.jsx)(ke.ZP,{className:"form-control form-control-solid"})})})}),(0,e.jsx)(t.Row,{children:(0,e.jsx)(t.Col,{span:6,children:(0,e.jsx)(t.Form.Item,{name:"content",className:"d-flex flex-column mb-7",required:!0,label:"\u6587\u4EF6\u8DEF\u5F84",rules:[{required:!0,message:"\u6587\u4EF6\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(t.Input.TextArea,{solid:!0,autoSize:{minRows:2,maxRows:2}})})})}),(0,e.jsx)(t.Row,{children:(0,e.jsx)(t.Col,{span:6,children:(0,e.jsx)(t.Form.Item,{name:"scheduledAt",className:"d-flex flex-column mb-7",label:"\u53D1\u5E03\u65F6\u95F4",rules:[{required:!0,message:"\u53D1\u5E03\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(t.DatePicker,{solid:!0,className:"w-100"})})})}),(0,e.jsx)(t.Row,{children:(0,e.jsx)(t.Col,{span:6,children:(0,e.jsx)(t.Form.Item,{name:"expirationAt",className:"d-flex flex-column mb-7",label:"\u8FC7\u671F\u65F6\u95F4",rules:[{required:!0,message:"\u8FC7\u671F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(t.DatePicker,{solid:!0,className:"w-100"})})})}),(0,e.jsx)(t.Row,{children:(0,e.jsx)(t.Col,{span:6,children:(0,e.jsx)(t.Form.Item,{className:"d-flex flex-column mb-7",name:"summary",label:"\u5907\u6CE8",children:(0,e.jsx)(t.Input.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:6}})})})})]})}function Pe(y){var u=y.data,A=y.visible,D=y.onClose,N=y.onSuccess,K=y.onDeleteSuccess,M=(0,B.Z)("drive"),_=d()(M,1),m=_[0],Y=m==null?void 0:m.values.space,x=ue(u,{transform:function(I){return c()(c()({},I),{},{content:{type:"PDF",url:"storage://".concat(Y,"/").concat(I.content)},category:"conformity"})},onSubmitted:N}),C=d()(x,2),R=C[0],te=C[1],ne=te.form,k=te.submitting,oe=(0,a.useMemo)(function(){return u?c()({},u):{}},[u]),ae=(0,G.Z)(function(){return K(u)}),L=ae.delete;return(0,e.jsx)(t.Drawer,{title:u!=null&&u.id?"\u7F16\u8F91":"\u65B0\u589E",placement:"right",width:640,mask:!0,closable:!0,onClose:D,visible:A,footer:(0,e.jsxs)(t.Row,{children:[(0,e.jsx)(t.Col,{span:6,children:(0,e.jsx)(t.Button,{style:{letterSpacing:"1rem"},className:"w-100",loading:k,onClick:R,children:"\u4FDD\u5B58"})}),(0,e.jsx)(t.Col,{span:6,children:(u==null?void 0:u.id)&&(0,e.jsx)(t.Button,{style:{letterSpacing:"1rem"},className:"w-100",variant:"light-danger",onClick:function(){return L(u)},children:"\u5220\u9664"})})]}),children:u&&(0,e.jsx)(be,{submitting:k,data:oe,form:ne,submit:R,onDeleteSuccess:K})})}var Oe=Pe;function O(y){var u=y.data,A=y.delete,D=y.onEdit,N=(0,a.useState)(!1),K=d()(N,2),M=K[0],_=K[1],m=(0,a.useCallback)(function(Y){var x=Y.key;x==="edit"?D(u):x==="delete"&&A({name:u.title,id:u.id})},[]);return(0,e.jsx)(t.Dropdown,{overlay:(0,e.jsxs)(t.Menu,{onClick:m,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-2",children:[(0,e.jsx)(t.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(t.Menu.Item,{className:"actions-delete px-3",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:_,visible:M,children:(0,e.jsxs)(t.Button,{variant:"clean",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(f.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function Ve(){var y=(0,i.s0)(),u=(0,h.lr)(),A=d()(u,1),D=A[0],N=(0,B.Z)("drive"),K=d()(N,1),M=K[0],_=M==null?void 0:M.values.space,m=(0,a.useMemo)(function(){return(0,ye.bp)(D,[{source:"q",target:"keywords"}])},[D.get("q")]);(0,a.useState)({keywords:D.get("q")||""});var Y=(0,a.useMemo)(function(){return(0,ye.bp)(D,[{source:"q",target:"where.OR",transform:function(n){return[{tags:[n]},{title:n}]}},{source:"page",transform:function(n){return parseInt(n)}},{source:"per_page",transform:function(n){return parseInt(n)}},{source:"sort",target:"orderBy",transform:function(n){var j=n.split(":"),l=d()(j,2),T=l[0],F=l[1];return"".concat(T,"_").concat(F)}}])},[D.toString()]),x=(0,ie.Y9)({fetchPolicy:"network-only"}),C=d()(x,1),R=C[0],te=(0,ie.uw)(),ne=d()(te,1),k=ne[0],oe=(0,ie.Mq)(),ae=d()(oe,1),L=ae[0],J=(0,ye.ZP)(ie.gk,{variables:Y}),I=d()(J,2),Z=I[0],U=I[1],de=U.loading,ce=U.pageInfo,s=U.refetch,Ne=(0,a.useCallback)(function(o,n,j){var l=(0,ye.Oh)({searchForm:m,pagination:o,filters:n,sorter:j},[{source:"searchForm.keywords",target:"q",skip:function(F){return!F}},{source:"pagination.current",target:"page",skip:function(F){return F===1}},{source:"pagination.pageSize",target:"per_page",skip:function(F){return F===15}},{source:"sorter.field",target:"sort",transform:function(F){return"".concat(F,":").concat(j.order==="ascend"?"asc":"desc")}}]);y(location.pathname+"?"+l,{replace:!0})},[m]),ze=(0,a.useCallback)(function(o){y(location.pathname+(o?"?q="+o:""),{replace:!0})},[]),Ge=(0,a.useCallback)(function(){var o=z()(P()().mark(function n(j){var l,T,F,Ee,Ke,H,Ie,Te,Ye,pe,Re,Ze,Fe,He,Ae;return P()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:l={totalRecords:0,insertCount:0,updateCount:0,failureCount:0,failedRecords:[],startTime:null,endTime:null},l.totalRecords=j.length,T=t.Toast.loading("\u5F00\u59CB\u5BFC\u5165\u6587\u4EF6",{placement:"top-center"}),l.startTime=new Date,F=0,Ee=w()(j),v.prev=6,Ee.s();case 8:if((Ke=Ee.n()).done){v.next=49;break}return H=Ke.value,F++,v.prev=11,v.next=14,R({variables:{where:{title:H.title}}});case 14:if(Ye=v.sent,pe=Ye.data,Re={title:H.title,summary:H.summary,tags:H.tag?[H.tag]:[],scheduledAt:H.scheduledAt,expirationAt:H.expirationAt,category:"conformity",content:{type:"PDF",url:"storage://".concat(_,"/")+H.file}},(pe==null||(Ie=pe.result)===null||Ie===void 0?void 0:Ie.pageInfo.total)!==1){v.next=28;break}return T.update("\u66F4\u65B0 ".concat(H.title," - ").concat(F,"/").concat(l.totalRecords),{icon:"loading"}),v.next=21,L({variables:{id:pe.result.edges[0].node.id,input:Re}});case 21:if(Ze=v.sent,Fe=Ze.errors,!(Fe!=null&&Fe.length)){v.next=25;break}throw new Error(Fe[0].message);case 25:l.updateCount++,v.next=40;break;case 28:if((pe==null||(Te=pe.result)===null||Te===void 0?void 0:Te.pageInfo.total)!==0){v.next=39;break}return T.update("\u65B0\u589E ".concat(H.title," - ").concat(F,"/").concat(l.totalRecords),{icon:"loading"}),v.next=32,k({variables:{input:Re}});case 32:if(He=v.sent,Ae=He.errors,!(Ae!=null&&Ae.length)){v.next=36;break}throw new Error(Ae[0].message);case 36:l.insertCount++,v.next=40;break;case 39:l.failureCount++;case 40:v.next=47;break;case 42:v.prev=42,v.t0=v.catch(11),T.update("\u5931\u8D25 ".concat(H.title," - ").concat(F,"/").concat(l.totalRecords),{icon:"error"}),l.failureCount++,l.failedRecords.push({record:H,error:v.t0});case 47:v.next=8;break;case 49:v.next=54;break;case 51:v.prev=51,v.t1=v.catch(6),Ee.e(v.t1);case 54:return v.prev=54,Ee.f(),v.finish(54);case 57:l.endTime=new Date,console.log("Import Summary:",l),T.close(),s(),t.Modal.success({title:"\u64CD\u4F5C\u6210\u529F",width:600,content:(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:["\u5BFC\u5165\u5B8C\u6210, \u5171 ",l.totalRecords," \u6761\u8BB0\u5F55, \u6210\u529F"," ",l.insertCount," \u6761, \u66F4\u65B0 ",l.updateCount," \u6761, \u5931\u8D25 ",l.failureCount," \u6761"]}),(0,e.jsxs)("p",{children:["\u8017\u65F6:"," ",g()(l.endTime).diff(l.startTime,"seconds")," ","\u79D2"]}),(0,e.jsxs)("p",{children:["\u603B\u8BB0\u5F55\u6570: ",l.totalRecords]}),(0,e.jsxs)("p",{children:["\u63D2\u5165\u6570\u91CF: ",l.insertCount]}),(0,e.jsxs)("p",{children:["\u66F4\u65B0\u6570\u91CF: ",l.updateCount]}),(0,e.jsxs)("p",{children:["\u5931\u8D25\u6570\u91CF: ",l.failureCount]})]}),allowOutsideClick:!1});case 62:case"end":return v.stop()}},n,null,[[6,51,54,57],[11,42]])}));return function(n){return o.apply(this,arguments)}}(),[s,_]),Je=je(Ge,{header:1,fields:{title:{index:0,name:"CMMF CODE",example:"W22L1",formatter:function(n){return String(n).trim()}},tag:{index:1,name:"WMF CODE",example:"YS22ED",formatter:function(n){return String(n).trim()}},scheduledAt:{index:2,name:"\u53D1\u5E03\u65F6\u95F4",example:"2024/8/22 0:00",formatter:function(n){return String(n).trim()&&g()(n).format("YYYY-MM-DD HH:mm")}},expirationAt:{index:3,name:"\u7ED3\u675F\u65F6\u95F4",example:"2024/8/31 0:00",formatter:function(n){return String(n).trim()&&g()(n).format("YYYY-MM-DD HH:mm")}},file:{index:4,name:"\u6587\u4EF6\u4F4D\u7F6E",example:"3201000159 1873596030 \u7092\u9505\u94F2.pdf.pdf",formatter:function(n){return String(n).trim()}},summary:{index:5,name:"\u5907\u6CE8",example:"",formatter:function(n){return String(n).trim()}}},template:{filename:"\u7B26\u5408\u6027\u89C4\u8303\u6279\u91CF\u4E0A\u4F20.xlsx",cols:[{wch:20},{wch:20},{wch:20},{wch:20},{wch:50},{wch:30}]}}),Be=d()(Je,3),Xe=Be[0],qe=Be[1],er=Be[2],Le=(0,$.Z)(ie.nT,{onDeleted:function(){return s()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(n,j){var l;if(j.batch){var T=n;l="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(T.length," \u4E2A\u6587\u4EF6\u5417\uFF1F")}else l=(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:n.name})]});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:l}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),rr=Le.delete,Ue=Le.deleteMany,tr=(0,a.useCallback)(function(o){return z()(P()().mark(function n(){return P()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:Ue(o);case 1:case"end":return l.stop()}},n)}))},[Ue]),nr=(0,a.useState)({visible:!1}),$e=d()(nr,2),We=$e[0],xe=$e[1],ar=(0,a.useCallback)(function(){xe(function(o){return c()(c()({},o),{},{visible:!1})})},[]),ur=(0,a.useCallback)(function(o){xe(function(n){return c()(c()({},n),{},{route:o})}),s()},[xe]),sr=(0,a.useCallback)(function(o){xe(function(n){var j;return((j=n.data)===null||j===void 0?void 0:j.id)!==o.id?n:c()(c()({},n),{},{visible:!1,menu:void 0})}),s()},[xe]),lr=(0,a.useCallback)(function(){xe(function(o){return c()(c()({},o),{},{visible:!0,data:{}})})},[]),ir=(0,a.useCallback)(function(o){xe(function(n){return c()(c()({},n),{},{visible:!0,data:o})})},[]);return(0,e.jsxs)(W.vs,{header:{title:"\u7B26\u5408\u6027\u7533\u660E\u7BA1\u7406"},children:[(0,e.jsx)(Oe,{data:We.data,onClose:ar,onSuccess:ur,onDeleteSuccess:sr,visible:We.visible}),(0,e.jsxs)(t.Card,{className:"mb-5 mb-xl-10",children:[(0,e.jsxs)(t.Card.Header,{className:"pt-8",children:[(0,e.jsx)(t.Card.Title,{className:"flex-column",children:(0,e.jsx)(t.Input.Search,{solid:!0,defaultValue:m.keywords,className:"w-250px",placeholder:"\u5173\u952E\u8BCD\u641C\u7D22",onSearch:ze})}),(0,e.jsx)(t.Card.Toolbar,{children:(0,e.jsxs)("div",{children:[(0,e.jsx)(t.Button,{onClick:lr,className:"me-4 my-1",children:"\u65B0\u5EFA"}),Xe,(0,e.jsx)(t.Button,{className:"me-4 my-1",onClick:qe,children:"\u6A21\u677F\u6570\u636E\u5BFC\u5165"}),(0,e.jsx)(t.Button,{variant:"light",className:"me-4 my-1",onClick:er,children:"\u7B26\u5408\u6027\u58F0\u660E\u6A21\u677F\u4E0B\u8F7D"})]})})]}),(0,e.jsx)(t.Card.Body,{children:(0,e.jsx)(t.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:de,children:(0,e.jsx)(t.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(n){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:n}),"\u4E2A"]})},toolbar:function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(t.Button,{color:"danger",onClick:tr(n),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},noRowsRenderer:function(){return(0,e.jsx)(t.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"title",title:"CMMF CODE",width:130,sorter:!0,sortOrder:(0,ve.PE)(D,"title")},{key:"tags",title:"WMF CODE",width:130,render:function(n,j){return!!j.tags.length&&j.tags[0].name}},{key:"content",title:"\u89C4\u8303\u6587\u4EF6",render:function(n,j){var l,T,F=j.content,Ee=new RegExp("^storage://[^/]+/");return(0,e.jsxs)("div",{children:[F==null||(l=F.rawUrl)===null||l===void 0?void 0:l.replace(Ee,""),(F==null||(T=F.url)===null||T===void 0?void 0:T.startsWith("storage://"))&&(0,e.jsx)(t.Badge,{className:"ms-2",color:"dark",children:"\u672A\u4E0A\u4F20"})]})}},{key:"status",title:"\u72B6\u6001",width:200,sorter:!0,sortOrder:(0,ve.PE)(D,"status"),render:function(n,j){switch(n){case Ce.af.Draft:return(0,e.jsx)(t.Badge,{light:!0,color:"secondary",children:"\u8349\u7A3F"});case Ce.af.Published:return(0,e.jsx)(t.Badge,{light:!0,color:"primary",children:"\u5DF2\u53D1\u5E03"});case Ce.af.Scheduled:return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(t.Badge,{light:!0,color:"info",children:["\u5C06\u4E8E"," ",g()(j.scheduledAt).format("YYYY-MM-DD HH:mm")," ","\u53D1\u5E03"]})});case Ce.af.Expired:return(0,e.jsx)(t.Badge,{color:"dark",children:"\u5DF2\u8FC7\u671F"});default:return(0,e.jsx)("span",{className:"badge badge-light-dark",children:"\u672A\u77E5"})}}},{key:"expirationAt",title:"\u7ED3\u675F\u65F6\u95F4",sorter:!0,sortOrder:(0,ve.PE)(D,"expirationAt"),width:160,render:function(n){return(0,e.jsx)("div",{className:"text-gray-700",children:n&&g()(n).format("YYYY-MM-DD HH:mm")})}},{title:"\u64CD\u4F5C",key:"action",width:120,render:function(n,j){return(0,e.jsx)(O,{data:j,delete:rr,onEdit:ir})}}],pagination:ce,onChange:Ne,dataSource:Z})})})]})]})}var Qe=Ve},20067:function(){},61227:function(se,V,r){var X=r(82187),c=r(96936),S=r(96263),P=r(69094);function Q(w){return X(w)||c(w)||S(w)||P()}se.exports=Q,se.exports.__esModule=!0,se.exports.default=se.exports}}]);
