(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[9856],{69856:function(L,g,a){"use strict";a.r(g);var n=a(11849),m=a(2824),F=a(39428),b=a(3182),D=a(67294),_=a(54406),t=a(7020),y=a(14843),Z=a(17818),M=a(85893);function j(p){var e=p.data,s=p.loading,r=p.save,d=(0,D.useCallback)(function(){t.m8.goBack()},[]),c=(0,D.useCallback)(function(){var f=(0,b.Z)((0,F.Z)().mark(function h(v){var l,i;return(0,F.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return l=v.template,i=v.blocks,E.next=3,r({variables:{id:v.id,input:{template:l,blocks:i}}});case 3:Z.FN.success("\u4FDD\u5B58\u6210\u529F");case 4:case"end":return E.stop()}},h)}));return function(h){return f.apply(this,arguments)}}(),[r]),o={id:e.id,template:e.template,blocks:e.blocks};return(0,M.jsx)(_.I$,{id:e.id,name:(e==null?void 0:e.name)||"",onSave:c,onBack:d,loading:s,viewport:{size:[1280,2160]},data:o})}function B(p){var e=p.match.params.id,s=(0,y.bo)({variables:{id:e},fetchPolicy:"cache-and-network"}),r=s.data,d=s.loading,c=(0,y.r3)(),o=(0,m.Z)(c,1),f=o[0];return(0,M.jsx)(j,{save:f,data:(0,n.Z)({id:e},r==null?void 0:r.component),loading:d})}g.default=B},14843:function(L,g,a){"use strict";a.d(g,{u7:function(){return n.u7},pM:function(){return n.pM},dP:function(){return n.dP},zR:function(){return n.zR},bo:function(){return n.bo},CF:function(){return n.CF},hT:function(){return n.hT},X4:function(){return n.X4},rq:function(){return n.rq},qb:function(){return n.qb},a$:function(){return n.a$},mp:function(){return n.mp},WE:function(){return n.WE},HC:function(){return n.HC},cT:function(){return Z},Hr:function(){return p},r3:function(){return n.r3},bI:function(){return n.bI},A6:function(){return n.A6},LV:function(){return n.LV}});var n=a(8305),m=a(39428),F=a(3182),b=a(2824),D=a(67294),_=a(17818),t=a(85893);function y(e,s){var r,d=(0,n.rz)({variables:{id:e==null?void 0:e.id},refetchQueries:[{query:n.dP,variables:{id:e==null||(r=e.application)===null||r===void 0?void 0:r.id}}]}),c=(0,b.Z)(d,1),o=c[0],f=(0,D.useCallback)((0,F.Z)((0,m.Z)().mark(function h(){var v;return(0,m.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,_.u_.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u8DEF\u7531\u5417\uFF1F",content:(0,t.jsxs)(t.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,t.jsx)("strong",{children:e.name}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]}),okText:"\u5220 \u9664",okClassName:"btn-danger"});case 2:if(v=i.sent,!v.isConfirmed){i.next=8;break}return i.next=6,o();case 6:_.FN.success("\u5220\u9664\u6210\u529F"),s(e);case 8:case"end":return i.stop()}},h)})),[o,e,s]);return[f]}var Z=y,M=a(11849),j=a(25496);function B(e,s){var r,d,c,o=_.l0.useForm(),f=(0,D.useState)(!1),h=(0,b.Z)(f,2),v=h[0],l=h[1],i=(0,n.X4)({fetchPolicy:"no-cache",refetchQueries:[{query:n.dP,variables:{id:e==null||(r=e.application)===null||r===void 0?void 0:r.id}}]}),T=(0,b.Z)(i,1),E=T[0],$=(0,n.LV)({fetchPolicy:"no-cache",refetchQueries:[{query:n.dP,variables:{id:e==null||(d=e.application)===null||d===void 0?void 0:d.id}}]}),k=(0,b.Z)($,1),A=k[0],I=(0,D.useMemo)(function(){return e!=null&&e.id?(0,F.Z)((0,m.Z)().mark(function O(){var C,R,P;return(0,m.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return l(!0),u.prev=1,u.next=4,o.validateFields();case 4:return C=u.sent,u.next=7,_.FN.promise((0,j.gw)(A({variables:{id:e.id,input:(0,M.Z)({},C)}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,t.jsxs)(t.Fragment,{children:["\u8DEF\u7531 ",(0,t.jsx)("strong",{children:C.name})," \u4FDD\u5B58\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:R=u.sent,P=R.data,s(P.updateRoute),l(!1),u.next=16;break;case 13:u.prev=13,u.t0=u.catch(1),l(!1);case 16:case"end":return u.stop()}},O,null,[[1,13]])})):(0,F.Z)((0,m.Z)().mark(function O(){var C,R,P;return(0,m.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return l(!0),u.prev=1,u.next=4,o.validateFields();case 4:return C=u.sent,u.next=7,_.FN.promise((0,j.gw)(E({variables:{input:(0,M.Z)((0,M.Z)({},C),{},{application:e.application.id})}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,t.jsxs)(t.Fragment,{children:["\u8DEF\u7531 ",(0,t.jsx)("strong",{children:C.name})," \u65B0\u589E\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:R=u.sent,P=R.data,s(P.createRoute),l(!1),u.next=16;break;case 13:u.prev=13,u.t0=u.catch(1),l(!1);case 16:case"end":return u.stop()}},O,null,[[1,13]])}))},[E,e==null||(c=e.application)===null||c===void 0?void 0:c.id,e==null?void 0:e.id,o,s,A]);return[I,{form:o,submitting:v}]}var p=B}}]);
