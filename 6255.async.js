"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6255],{79514:function(I,j,r){r.d(j,{AQ:function(){return a.AQ},Af:function(){return a.Af},G$:function(){return a.G$},I1:function(){return a.I1},KX:function(){return a.KX},Nq:function(){return a.Nq},P6:function(){return a.P6},Pw:function(){return a.Pw},WF:function(){return a.WF},Yw:function(){return a.Yw},ZO:function(){return a.ZO},_c:function(){return a._c},aA:function(){return a.aA},au:function(){return a.au},c9:function(){return a.c9},jS:function(){return a.jS},ko:function(){return a.ko},oM:function(){return a.oM},ot:function(){return a.ot},w4:function(){return a.w4},wp:function(){return a.wp}});var a=r(70694)},86255:function(I,j,r){r.r(j),r.d(j,{default:function(){return K}});var a=r(5574),F=r.n(a),d=r(62435),O=r(46027),P=r(12845),R=r(73588),n=r(13757),L=r(15009),C=r.n(L),T=r(97857),S=r.n(T),$=r(99289),D=r.n($),g=r(79514),e=r(86074);function Q(v){var A=v.visible,y=v.onClose,h=v.onSuccess,s=n.Form.useForm(),o=(0,g.ot)(),B=F()(o,1),m=B[0],M=(0,g.aA)(),N=F()(M,2),p=N[0],b=N[1].loading,c=(0,d.useRef)(new AbortController),l="cn.asany",x=(0,d.useCallback)(D()(C()().mark(function k(){var i,f,w;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,s.validateFields();case 2:return i=u.sent,u.next=5,p({variables:{input:S()(S()({},i),{},{code:l+"."+i.code})}});case 5:f=u.sent,w=f.data,n.Toast.success("\u6A21\u5757 \u201C".concat(i.name,"\u201D \u65B0\u589E\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0}),h(w.createModule);case 9:case"end":return u.stop()}},k)})),[p,s,h]);return(0,e.jsxs)(n.Modal,{confirmLoading:b,maskClosable:!b,width:592,centered:!0,visible:A,closable:!1,onCancel:y,onOk:x,children:[(0,e.jsx)(n.Modal.Header,{children:(0,e.jsx)("h4",{children:"\u65B0\u6A21\u5757"})}),(0,e.jsx)(n.Modal.Body,{children:(0,e.jsxs)(n.Form,{form:s,children:[(0,e.jsx)(n.Form.Item,{required:!1,className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(n.Input,{solid:!0})}),(0,e.jsx)(n.Form.Item,{required:!1,className:"mb-5",name:"code",label:"\u7F16\u7801",hasFeedback:!0,help:"\u8BF7\u53C2\u8003\u7F16\u7A0B\u4E2D\u547D\u540D\u7A7A\u95F4\u7684\u5199\u6CD5",rules:[{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{validator:function(i,f){return D()(C()().mark(function w(){var E,u;return C()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(f){t.next=2;break}return t.abrupt("return");case 2:return c.current&&c.current.abort(),c.current=new AbortController,t.next=6,m({variables:{filter:{code:l+"."+f},limit:1},fetchPolicy:"network-only",context:{fetchOptions:{signal:c.current.signal}}});case 6:if(E=t.sent,u=E.data,console.log("validator",i,f,u==null?void 0:u.modules),!(u!=null&&u.modules.length)){t.next=11;break}throw new Error(i.message);case 11:case"end":return t.stop()}},w)}))()},message:"\u7F16\u7801\u4E0D\u80FD\u91CD\u590D"}],children:(0,e.jsx)(n.Input,{solid:!0,addonBefore:l+".",placeholder:"\u4F8B\u5982: module.text"})}),(0,e.jsx)(n.Form.Item,{className:"mt-5",name:"description",label:"\u63CF\u8FF0",requiredMark:"optional",children:(0,e.jsx)(n.Input.TextArea,{solid:!0,autoSize:{maxRows:4,minRows:2}})})]})})]})}var G=Q;function z(){var v=(0,d.useState)(!1),A=F()(v,2),y=A[0],h=A[1],s=(0,g.au)({fetchPolicy:"cache-and-network"}),o=s.data,B=s.loading,m=s.previousData,M=s.refetch,N=(0,d.useCallback)(function(){h(!1)},[]),p=(0,d.useCallback)(function(){h(!0)},[]),b=(0,d.useCallback)(function(l){M(),navigate("/modules/".concat(l.id))},[M]),c=(0,d.useMemo)(function(){return(o==null?void 0:o.modules)||(m==null?void 0:m.modules)||[]},[o==null?void 0:o.modules,m]);return(0,e.jsxs)(R.JH,{loading:B,className:"module-list",children:[(0,e.jsxs)("div",{className:"my-modules",children:[(0,e.jsxs)("h1",{className:"anchor fw-bold mb-5",children:["\u6211\u7684\u6A21\u5757(",c.length,")"]}),(0,e.jsx)(n.Row,{className:"py-2",cols:{md:2,xl:5},gutter:{default:5,xl:9},children:c.map(function(l){var x;return(0,e.jsx)(n.Col,{md:4,children:(0,e.jsxs)(n.Card,{as:P.Link,to:"/modules/".concat(l.id),className:"module-card card-p-0",children:[(0,e.jsx)(n.Card.Body,{children:(0,e.jsx)(n.Symbol,{autoColor:!1,labelClassName:"bg-dark text-inverse-info fs-5tx",src:(x=l.picture)===null||x===void 0?void 0:x.url,alt:l.name})}),(0,e.jsx)(n.Card.Footer,{className:"p-4",children:(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("h3",{children:l.name}),(0,e.jsx)("span",{className:"tw-text-ellipsis overflow-hidden",children:l.description})]})})]})},l.id)})})]}),(0,e.jsxs)("div",{className:"create-new-module",children:[(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("h1",{className:"anchor fw-bold mb-5",children:"\u521B\u5EFA\u4E00\u4E2A\u65B0\u6A21\u5757"}),(0,e.jsx)("span",{className:"tw-text-ellipsis overflow-hidden",children:"\u521B\u5EFA\u4E00\u4E2A\u7A7A\u767D\u6A21\u5757\u6216\u4ECE\u6A21\u677F\u5F00\u59CB\u3002"})]}),(0,e.jsx)(n.Row,{className:"module-templates",cols:{md:2,xl:4},gutter:{default:5,xl:9},children:(0,e.jsx)(n.Col,{md:4,children:(0,e.jsx)(n.Card,{as:"a",onClick:p,className:"module-card create-module-card card-p-0",children:(0,e.jsx)(n.Card.Body,{children:(0,e.jsxs)("div",{className:"create-module-card-inner",children:[(0,e.jsx)("div",{className:"create-module-card__blank_icon",children:(0,e.jsx)(O.JO,{name:"Bootstrap/plus"})}),(0,e.jsx)("span",{className:"create-module-card__blank_name text-gray-700",children:"\u7A7A\u767D"})]})})})})}),(0,e.jsx)(G,{visible:y,onSuccess:b,onClose:N})]})]})}var K=z}}]);
