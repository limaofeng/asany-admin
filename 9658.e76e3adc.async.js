"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9658],{89658:function(V,f,s){s.r(f);var j=s(97857),l=s.n(j),y=s(5574),D=s.n(y),O=s(52677),P=s.n(O),i=s(62435),b=s(59197),M=s(93967),v=s.n(M),u=s(79817),E=s(8606),x=s(12708),r=s(86074),p=function(a){return a!=null&&a.url?a.url:P()(a==null?void 0:a.image)==="object"?"https://storage-api.asany.cn"+"/preview/".concat(a.image.id):typeof(a==null?void 0:a.image)=="string"?"https://storage-api.asany.cn"+"/preview/".concat(a.image):""};function R(d){var a=d.value,C=d.onChange,n=(0,i.useRef)({value:a,visible:!1,images:[]}),B=(0,i.useReducer)(function(e){return e+1},0),A=D()(B,2),m=A[1];n.current.value=a,(0,x.KW)(function(){console.log("value",a),n.current.images=((a==null?void 0:a.images)||[]).map(function(e){return{id:e.id,title:e.title,description:e.description,image:e.image,url:e.url}}),m()},[a]);var o=(0,i.useCallback)(function(e){console.log("handleChange",e),C&&C(e)},[]),F=(0,i.useCallback)(function(e,_){n.current.images=e.map(function(t){return{id:t.id,title:t.title,description:t.description,image:t.image,url:t.url}}),console.log("handleSort",_),o(l()(l()({},n.current.value),{},{images:n.current.images}))},[]),c=(0,i.useCallback)(function(e){n.current.visible=e,m()},[]),L=(0,i.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),c(!0)},[]),U=(0,i.useCallback)(function(e){n.current.images.push({id:(0,E.uuid)(),title:"",description:"",image:e}),o(l()(l()({},a),{},{images:n.current.images}))},[a]),I=(0,i.useCallback)(function(e){n.current.externalLink=e.target.value,m()},[]),T=(0,i.useCallback)(function(){n.current.images.push({id:(0,E.uuid)(),title:"",description:"",image:void 0,url:n.current.externalLink}),o(l()(l()({},a),{},{images:n.current.images})),c(!1)},[a]),k=(0,i.useCallback)(function(){c(!1)},[]),K=(0,i.useCallback)(function(e){return function(){n.current.images=n.current.images.filter(function(_){return _.id!==e}),o(l()(l()({},a),{},{images:n.current.images}))}},[]),W=n.current.visible,N=n.current.images,w=n.current.externalLink;return(0,r.jsxs)("div",{className:"article-content-image",children:[(0,r.jsx)(u.Modal,{centered:!0,visible:W,dialogClassName:"modal-dialog-small w-500px",onCancel:k,onOk:T,title:"\u8BBE\u7F6E\u94FE\u63A5\u5F15\u7528",closable:!1,headerClassName:"border-bottom-0",bodyClassName:"py-2",footerClassName:"border-top-0",children:(0,r.jsx)(u.Input.TextArea,{value:w,autoSize:{minRows:3,maxRows:5},onChange:I})}),(0,r.jsx)("div",{className:"fv-row mb-6",children:(0,r.jsx)(u.SignleUpload,{accept:{"image/*":[".png",".jpg",".jpeg",".gif",".svg"]},title:(0,r.jsxs)(r.Fragment,{children:["\u5C06\u6587\u4EF6\u62D6\u62FD\u81F3\u6B64\u5904\u3001\u70B9\u51FB\u4E0A\u4F20\uFF0C\u6216",(0,r.jsx)("a",{onClick:L,className:"",children:"\u8BBE\u7F6E"}),"\u94FE\u63A5\u5F15\u7528\u3002"]}),description:"\u652F\u6301\u7684\u683C\u5F0F\uFF1Apng, jpg, jpeg, gif, svg",onChange:U})}),(0,r.jsx)(b.ZP,{direction:"horizontal",layout:"grid",onChange:F,tag:"div",className:"ps-0",draggable:!0,items:N,rerender:!1,itemRender:function(_,t){var g=_,h=g.data,S=g.drag,z=g.style;return(0,r.jsx)(u.Symbol.Image,{ref:S(t),labelClassName:"fs-2",size:150,style:l()({width:150,height:150},z),src:p(h),className:v()("shadow shadow-sm p-2 mb-6 me-6",{}),badge:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(u.Button,{as:"label",type:"circle",variant:!1,onClick:K(h.id),"data-kt-image-input-action":"change",className:"symbol-badge start-100 btn-icon btn-active-color-primary w-25px h-25px bg-body shadow",children:(0,r.jsx)("i",{className:"bi bi-x fs-2"})})})},h.id)},preview:{render:(0,b.HG)(function(e){var _=e,t=_.data;return(0,r.jsx)(u.Symbol.Image,{style:{width:150,height:150},labelClassName:"fs-2",size:150,src:p(t),className:v()("shadow shadow-sm p-2",{})})},{})}})]})}f.default=R}}]);
