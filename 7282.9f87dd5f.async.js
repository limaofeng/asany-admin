(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[7282],{27282:function(W,P,r){"use strict";r.r(P);var _=r(39428),m=r(11849),j=r(3182),p=r(2824),D=r(67294),v=r(250),k=r(18071),a=r(51186),e=r(85893);function A(w){var b,t=w.match,n=w.history,Z=(0,v.sc)({fetchPolicy:"cache-and-network"}),y=(0,p.Z)(Z,2),C=y[0],M=y[1],g=M.data,F=M.loading,N=(0,v.Yh)({}),O=(0,p.Z)(N,2),L=O[0],T=O[1].loading,R=(0,v.M0)({}),B=(0,p.Z)(R,2),I=B[0],U=B[1].loading,l=t.params.id=="new",o=a.l0.useForm(),K=(0,D.useCallback)((0,j.Z)((0,_.Z)().mark(function c(){var u;return(0,_.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.validateFields();case 2:if(u=s.sent,!l){s.next=8;break}return s.next=6,L({variables:{input:(0,m.Z)({},u)}});case 6:s.next=10;break;case 8:return s.next=10,I({variables:{id:t.params.id,input:(0,m.Z)({},u)}});case 10:a.FN.success("\u6D77\u62A5 \u201C".concat(u.name,"\u201D ").concat(l?"\u65B0\u589E":"\u4FEE\u6539","\u6210\u529F"),2e3,{placement:"bottom-start",progressBar:!0}),!n.length||l?n.replace("/website/landing/posters"):n.goBack();case 12:case"end":return s.stop()}},c)})),[L,t.params.id,o,n,l,I]);return(0,D.useEffect)(function(){if(t.params.id!="new"){var c=new AbortController;return C({variables:{id:t.params.id},context:{fetchOptions:{signal:c.signal}}}).then(function(){var u=(0,j.Z)((0,_.Z)().mark(function E(s){var f,x,h,d;return(0,_.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(h=s.data,d=h==null?void 0:h.poster,d){i.next=7;break}return i.next=5,a.u_.error({content:"\u6D77\u62A5\u4E0D\u5B58\u5728,\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5220\u9664\u4E86",timer:3e3,timerProgressBar:!0});case 5:return n.length?n.goBack():n.replace("/website/landing/posters"),i.abrupt("return");case 7:o.setFieldsValue((0,m.Z)((0,m.Z)({},d),{},{music:(f=d.music)===null||f===void 0?void 0:f.id,background:(x=d.background)===null||x===void 0?void 0:x.id}));case 8:case"end":return i.stop()}},E)}));return function(E){return u.apply(this,arguments)}}()),function(){c.abort()}}},[o,C,n,t.params.id]),(0,e.jsx)(k.v,{header:l?{title:"\u65B0\u589E\u6D77\u62A5"}:void 0,footer:!1,children:(0,e.jsxs)(a.Zb,{className:"mb-5 mb-xl-10",children:[(0,e.jsx)(a.Zb.Header,{children:(0,e.jsx)(a.Zb.Title,{children:l?"\u65B0\u589E\u6D77\u62A5":g==null||(b=g.poster)===null||b===void 0?void 0:b.name})}),(0,e.jsxs)(a.Zb.Body,{children:[(0,e.jsx)(a.bH,{overlayClassName:"bg-white bg-opacity-25",loading:F,children:(0,e.jsxs)(a.l0,{form:o,className:"w-800px row d-flex flex-shrink-0 flex-column-reverse flex-md-row",children:[(0,e.jsxs)("div",{className:"col-12 col-md-8",children:[(0,e.jsx)(a.l0.Item,{className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(a.II,{solid:!0,className:"w-400px"})}),(0,e.jsx)(a.l0.Item,{className:"my-5",name:"music",label:"\u80CC\u666F\u97F3\u4E50",children:(0,e.jsx)(a.gq,{solid:!0,accept:".aif, .cda, .mid, .mp3, .mpa, .ogg, .wav, .wma, .wpl",space:"orX8kLOV",className:"w-400px"})}),(0,e.jsx)(a.l0.Item,{className:"my-5",name:"description",label:"\u63CF\u8FF0",help:"\u8BF7\u7528\u5C11\u4E8E250\u5B57\u7B26\u63CF\u8FF0",children:(0,e.jsx)(a.II.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:8},showCount:!0,maxLength:250,className:"w-400px"})})]}),(0,e.jsx)("div",{className:"col-12 col-md-4",children:(0,e.jsx)(a.l0.Item,{className:"mb-5",name:"background",label:"\u6D77\u62A5\u56FE\u7247",children:(0,e.jsx)(a.gq.Image,{width:375,height:812,space:"orX8kLOV",crop:!1})})})]})}),(0,e.jsx)(a.zx,{loading:F||T||U,onClick:K,children:l?(0,e.jsx)(e.Fragment,{children:"\u6DFB\u52A0\u6D77\u62A5"}):(0,e.jsx)(e.Fragment,{children:"\u4FEE\u6539\u6D77\u62A5\u4FE1\u606F"})})]})]})})}P.default=A}}]);
