(self.webpackChunk=self.webpackChunk||[]).push([[8896],{88896:function(Ce,U,u){"use strict";u.d(U,{Z:function(){return ur}});var q=u(13769),H=u.n(q),O=u(15009),F=u.n(O),ye=u(99289),w=u.n(ye),k=u(5574),g=u.n(k),Z=u(97857),M=u.n(Z),W=u(19632),I=u.n(W),r=u(67294),P=u(32512),z=u(96974),m=u(46027),$=u(12845),Pe=u(93967),te=u.n(Pe),t=u(2721),Ue=u(32115),Oe=u(1861),X=u(82471),e=u(85893);function Ke(){return(0,e.jsx)("div",{className:"pt-5",children:"\u65E5\u5FD7"})}function Qe(i){var a=(0,r.useState)(i.file),c=g()(a,2),s=c[0],v=c[1],S=(0,X.lK)({fetchPolicy:"cache-and-network",variables:{id:i.file.id}}),f=S.data,B=S.loading;return(0,r.useEffect)(function(){f!=null&&f.file&&v(f.file)},[f==null?void 0:f.file]),(0,e.jsxs)(t.BlockUI,{overlayClassName:"bg-white bg-opacity-25",className:"pt-5",loading:B,children:[!s.isDirectory&&(0,e.jsx)("div",{className:"file-preview mb-6",children:(0,e.jsx)(t.Symbol,{src:$.APP_CONFIG.STORAGE_URL+"/thumbnail/".concat(s.id,"?size=120x120")})}),!1,(0,e.jsx)("div",{className:"fs-6 text-gray-800 mb-4",children:"\u7CFB\u7EDF\u5C5E\u6027"}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u7C7B\u578B"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:s.isDirectory?"\u6587\u4EF6\u5939":s.mimeType})})]}),!s.isDirectory&&(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u5927\u5C0F"}),(0,e.jsx)("div",{className:"col-lg-9 fv-row",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:(0,Ue.jb)(s.size)})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u4F4D\u7F6E"}),(0,e.jsxs)("div",{className:"col-lg-9 d-flex align-items-center flex-wrap",children:[(0,e.jsx)($.Link,{className:"tw-truncate mw-90px",to:"/drive/my-drive",children:"\u5168\u90E8\u6587\u4EF6"}),(s.parents||[]).map(function(T){return(0,e.jsxs)(r.Fragment,{children:[(0,e.jsx)(m.ZP,{name:"Duotune/arr071",className:te()("svg-icon-5 svg-icon-primary")}),(0,e.jsx)($.Link,{className:"tw-truncate mw-90px",to:"/drive/folders/".concat(T.id),children:T.name})]},T.id)})]})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u4FEE\u6539\u65F6\u95F4"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:s.lastModified})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u521B\u5EFA\u65F6\u95F4"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:s.createdAt})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u8BF4\u660E"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:s.description})})]})]})}function Xe(i){var a=i.file;return(0,e.jsxs)(t.Tabs,{type:"line-tabs",className:"nav-line-tabs-2x",children:[(0,e.jsx)(t.Tabs.TabPane,{tab:"\u6587\u4EF6\u8BE6\u60C5",children:(0,e.jsx)(Oe.E,{className:"flex-column-fluid custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(Qe,{file:a})})},"file-details"),(0,e.jsx)(t.Tabs.TabPane,{tab:"\u64CD\u4F5C\u8BB0\u5F55",children:(0,e.jsx)(Oe.E,{className:"flex-column-fluid custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(Ke,{})})},"action-records")]})}function Je(i){var a=i.files,c=i.currentFolder,s=(0,r.useMemo)(function(){return a.length===1?"file_details":a.length>1?"many_file_details":"current_folder"},[a]),v=(0,r.useMemo)(function(){return s==="file_details"?a[0].name:s==="many_file_details"?"\u591A\u4E2A\u6587\u4EF6":c!=null&&c.isRootFolder?"\u8BF7\u9009\u62E9\u4E00\u4E2A\u6587\u4EF6":(c==null?void 0:c.name)||""},[c==null?void 0:c.isRootFolder,c==null?void 0:c.name,a,s]),S=(0,r.useMemo)(function(){var G=v.lastIndexOf(".");return G===-1?[v,void 0]:[v.substring(0,G),v.substring(G+1)]},[v]),f=g()(S,2),B=f[0],T=f[1];return(0,e.jsxs)("div",{className:"preview-container",children:[(0,e.jsx)("div",{className:"preview-header",children:(0,e.jsx)("h4",{className:te()({"tw-truncate":!T,"d-flex":T}),children:T?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"file-title shrink tw-truncate",children:B}),(0,e.jsxs)("span",{className:"file-suffix",children:[".",T]})]}):B})}),(0,e.jsx)("div",{className:"preview-body",children:s==="file_details"&&(0,e.jsx)(Xe,{file:a[0]})})]})}var Ye=Je,qe=u(86366),ke=u(12708);function _e(i){var a=i.data,c=i.editable,s=i.onClick,v=i.onCancelRename,S=i.onSuccess,f=(0,r.useRef)(null),B=(0,r.useState)(!1),T=g()(B,2),G=T[0],J=T[1],me=(0,r.useState)(a.name),_=g()(me,2),N=_[0],se=_[1],ve=(0,X.Ep)(),K=g()(ve,1),ee=K[0],je=(0,r.useCallback)(function(h){se(h.target.value)},[]),le=(0,r.useCallback)(function(){var h=w()(F()().mark(function ae(pe){var Q,oe,ge;return F()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return pe.stopPropagation(),C.prev=1,J(!0),C.next=5,(0,ke.gw)(ee({variables:{id:a.id,name:N}}),350);case 5:return Q=C.sent,oe=Q.data,S(oe.file),C.next=10,(0,ke._v)(350);case 10:J(!1),v(),C.next=22;break;case 14:return C.prev=14,C.t0=C.catch(1),J(!1),C.next=19,t.Toast.error(C.t0.message,2e5,{progressBar:!0,placement:"top-center"});case 19:return C.next=21,(0,ke._v)(300);case 21:(ge=f.current)===null||ge===void 0||ge.select();case 22:case"end":return C.stop()}},ae,null,[[1,14]])}));return function(ae){return h.apply(this,arguments)}}(),[a.id,N,v,S,ee]),E=(0,r.useCallback)(function(h){h.preventDefault(),le(h)},[le]),we=(0,r.useCallback)(function(h){h.stopPropagation(),h.preventDefault(),v()},[v]),L=(0,r.useCallback)(function(h){s(a),h.preventDefault(),h.stopPropagation()},[a,s]);(0,r.useEffect)(function(){var h;se(function(){return a.name}),c&&((h=f.current)===null||h===void 0||h.select(0,a.name.length-(a.extension?a.extension.length+1:0)))},[a.extension,a.name,c]);var re=(0,r.useCallback)(function(h){c&&(h.stopPropagation(),h.preventDefault())},[c]),Y=(0,r.useMemo)(function(){var h,ae;return((h=a.mimeType)===null||h===void 0?void 0:h.startsWith("image/"))||((ae=a.mimeType)===null||ae===void 0?void 0:ae.startsWith("video/"))},[a.mimeType]),ue=(0,r.useState)(!1),he=g()(ue,2),D=he[0],Se=he[1],Be=(0,qe.Z)(),Ae=g()(Be,2),Te=Ae[1],ie=(0,r.useRef)(),R=(0,r.useCallback)(function(h){h.stopPropagation(),h.preventDefault(),Te(a.path),t.Toast.info("\u8DEF\u5F84 \u5DF2\u7ECF\u590D\u5236",3e3,{placement:"top-center"}),ie.current&&clearTimeout(ie.current),Se(!0),ie.current=setTimeout(function(){Se(!1),ie.current=null},3e3)},[a,Te]);return(0,e.jsxs)("div",{onClick:re,className:te()("d-flex align-items-center",{"no-selecto-drag":c}),children:[(0,e.jsxs)("div",{className:"title-icon-container position-relative me-1 d-flex align-items-center justify-content-center",children:[Y?(0,e.jsx)(t.Symbol,{alt:(0,e.jsx)(m.ZP,{name:"Duotune/".concat(a.isDirectory?"fil012":"fil003"),className:"svg-icon-2x svg-icon-primary"}),src:$.APP_CONFIG.STORAGE_URL+"/thumbnail/".concat(a.id,"?size=120x120")}):(0,e.jsx)(m.ZP,{name:"Duotune/".concat(a.isDirectory?"fil012":"fil003"),className:"svg-icon-2x svg-icon-primary"}),a.starred&&(0,e.jsx)(m.ZP,{name:"Bootstrap/star-fill",className:"position-absolute starred-flag"})]}),c?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t.Input,{ref:f,value:N,onChange:je,onPressEnter:E,placeholder:"\u8F93\u5165\u65B0\u6587\u4EF6\u5939\u540D\u79F0",size:"sm",className:"mw-250px me-3"}),(0,e.jsx)(t.Button,{as:"button",loading:G,variant:"light-primary",size:"sm",icon:(0,e.jsx)(m.ZP,{name:"Duotune/arr085",className:"svg-icon-1"}),className:"me-3",onClick:le}),(0,e.jsx)(t.Button,{as:"button",size:"sm",variant:"light-danger",icon:(0,e.jsx)(m.ZP,{name:"Duotune/arr088",className:"svg-icon-1"}),className:"svg-icon-1",onClick:we})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("a",{className:"text-gray-800 text-ellipsis text-hover-primary no-selecto-drag",onClick:L,href:a.isDirectory?"/drive/folders/".concat(a.id):"/preview/".concat(a.id),children:a.name}),(0,e.jsx)("div",{style:{display:"none"},children:(0,e.jsx)(t.Tooltip,{title:"\u70B9\u51FB\u590D\u5236\u6587\u4EF6\u8DEF\u5F84",children:(0,e.jsx)(m.ZP,{onClick:R,className:te()("ms-2 svg-icon-4 cursor-pointer",{"text-success":!D,"text-primary":D}),name:"Bootstrap/clipboard".concat(D?"-check":"")})})})]})]})}var er=_e;function rr(i){var a=i.visible,c=i.onCancel,s=i.onSuccess,v=i.parentFolder,S=(0,r.useState)("\u672A\u547D\u540D\u6587\u4EF6\u5939"),f=g()(S,2),B=f[0],T=f[1],G=(0,r.useState)(!1),J=g()(G,2),me=J[0],_=J[1],N=(0,X.we)(),se=g()(N,2),ve=se[0],K=se[1].loading,ee=(0,r.useRef)(null),je=(0,r.useCallback)(function(){c()},[c]),le=(0,r.useCallback)(function(L){T(L.target.value),_(!L.target.value)},[]),E=(0,r.useCallback)(w()(F()().mark(function L(){var re,Y,ue;return F()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(B){D.next=2;break}return D.abrupt("return");case 2:return D.prev=2,D.next=5,ve({variables:{name:B,parentFolder:v}});case 5:re=D.sent,Y=re.data,c&&c(),Y!=null&&Y.folder&&s(Y.folder),t.Toast.success("\u6587\u4EF6\u5939\u65B0\u589E\u6210\u529F",2e3,{progressBar:!0,placement:"bottom-start"}),D.next=19;break;case 12:return D.prev=12,D.t0=D.catch(2),D.next=16,t.Toast.error(D.t0.message,2e3,{progressBar:!0});case 16:return D.next=18,(0,ke._v)(300);case 18:(ue=ee.current)===null||ue===void 0||ue.select();case 19:case"end":return D.stop()}},L,null,[[2,12]])})),[ve,c,s,v,B]),we=(0,r.useCallback)(function(){E()},[E]);return(0,r.useEffect)(function(){if(a){var L;(L=ee.current)===null||L===void 0||L.select()}else T("\u672A\u547D\u540D\u6587\u4EF6\u5939"),_(!1)},[a]),(0,e.jsx)(t.Modal,{centered:!0,visible:a,dialogClassName:"modal-dialog-small w-400px",onCancel:je,onOk:E,title:"\u65B0\u5EFA\u6587\u4EF6\u5939",closable:!1,okButtonProps:{loading:K,className:te()({disabled:me})},headerClassName:"border-bottom-0",bodyClassName:"py-2",footerClassName:"border-top-0",children:(0,e.jsx)(t.Input,{ref:ee,onPressEnter:we,onChange:le,value:B})})}var ar=rr;function nr(i){var a=i.paths,c=i.onClick,s=(0,r.useCallback)(function(v){return function(S){S.preventDefault(),S.stopPropagation(),c(v)}},[c]);return(0,e.jsx)("div",{className:"folder-path badge badge-lg badge-white",children:(0,e.jsx)("div",{className:"d-flex align-items-center flex-wrap",children:a.map(function(v,S){var f=S===0,B=S===a.length-1;return(0,e.jsxs)(r.Fragment,{children:[!f&&(0,e.jsx)(m.ZP,{name:f?"Duotune/abs039":"Duotune/arr071",className:te()("svg-icon-2 svg-icon-primary",{"mx-1":!f,"me-3":f})}),B?v.name:(0,e.jsx)("a",{href:S===0?"/drive/my-drive":"/drive/folders/".concat(v.id),onClick:s(v),children:v.name})]},v.id)})})})}var tr=nr,sr=["onClick"];function Le(i,a){var c=i?[{id:i.id,name:i.name,isDirectory:!0,isRootFolder:!0,path:"/"}]:[];return a&&a.id!==(i==null?void 0:i.id)&&(a.parents&&c.push.apply(c,I()(a.parents)),a.isRootFolder||c.push(M()({},a))),c}function lr(i){var a,c=i.folder,s=i.rootFolder,v=i.where,S=i.toolbar,f=S===void 0?"default":S,B=(0,z.s0)(),T=(0,z.TH)(),G=(a=T.state)===null||a===void 0?void 0:a.r,J=(0,$.useModel)("cloud-drive.index",function(n){var o=n.state;return o.cloudDrive}),me=(0,$.useModel)("cloud-drive.index",function(n){return n.upload}),_=(0,$.useModel)("cloud-drive.index",function(n){return n.download}),N=(0,r.useRef)({sorter:i.orderBy||{field:"name",order:"ascend"},rootFolder:s,newFolderVisible:!1,currentFolder:i.currentFolder}),se=(0,r.useReducer)(function(n){return n+1},0),ve=g()(se,2),K=ve[1],ee=(0,r.useCallback)(function(){N.current.newFolderVisible=!0,K()},[]),je=(0,r.useCallback)(function(){N.current.newFolderVisible=!1,K()},[]),le=(0,X.rn)({fetchPolicy:"cache-and-network",variables:{folder:c}}),E=le.data,we=(0,X.J4)(),L=g()(we,1),re=L[0],Y=(0,X._D)(),ue=g()(Y,1),he=ue[0],D=(0,X.HD)(),Se=g()(D,1),Be=Se[0],Ae=(0,X.fX)(),Te=g()(Ae,1),ie=Te[0],R=N.current.sorter,h=(0,r.useMemo)(function(){return R?"isDirectory_desc,"+R.field+"_"+(R.order==="ascend"?"asc":"desc"):"isDirectory_desc,name_asc"},[R]),ae=(0,X.Eo)(s==null?void 0:s.space,v,h),pe=g()(ae,4),Q=pe[0],oe=pe[1],ge=pe[2],Fe=pe[3],C=Fe.loadedCount,ce=Fe.allItems,Ne=Fe.refetch,De=Fe.refetchForObjects,xe=Fe.refetchWithRemoveForObjects;(0,r.useEffect)(function(){G&&Ne(1)},[G]);var be=(0,r.useMemo)(function(){return{loadedCount:C,rowCount:Q.totalCount,get items(){return ce()},useItem:ge}},[ce,C,Q.totalCount,ge]),ir=(0,r.useState)([]),ze=g()(ir,2),y=ze[0],de=ze[1],fe=(0,r.useMemo)(function(){return i.currentFolder&&E!==null&&E!==void 0&&E.currentFolder&&i.currentFolder.id!==E.currentFolder.id&&i.currentFolder.path.startsWith(E.currentFolder.path)?N.current.currentFolder=i.currentFolder:E!=null&&E.currentFolder?N.current.currentFolder=E==null?void 0:E.currentFolder:N.current.currentFolder},[E==null?void 0:E.currentFolder,i.currentFolder]),or=(0,r.useCallback)(function(n){de(n)},[de]),cr=(0,r.useCallback)(function(){var n=w()(F()().mark(function o(l){return F()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,De([l],function(x,p){return x.id===p.id});case 2:case"end":return b.stop()}},o)}));return function(o){return n.apply(this,arguments)}}(),[De]),A=(0,r.useMemo)(function(){if(y.length===1)return ce().find(function(n){return n&&n.id===y[0]})},[ce,y]),dr=(0,r.useCallback)(function(){N.current.renameFile=void 0,K()},[]),fr=(0,r.useMemo)(function(){return Le(s,fe)},[s,fe]),Ve=(0,r.useCallback)(function(){var n=w()(F()().mark(function o(l){var d,b,x;return F()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(f!=="trash"){j.next=4;break}return j.next=3,t.Modal.confirm({title:(0,e.jsxs)(e.Fragment,{children:["\u6B64\u6587\u4EF6",l.isDirectory&&"\u5939","\u4F4D\u4E8E\u60A8\u7684\u56DE\u6536\u7AD9\u4E2D"]}),content:(0,e.jsxs)(e.Fragment,{children:["\u8981\u67E5\u770B\u8BE5\u6587\u4EF6",l.isDirectory&&"\u5939","\uFF0C\u60A8\u9700\u8981\u5C06\u5176\u4ECE\u56DE\u6536\u7AD9\u8FD8\u539F\u3002"]}),okText:"\u8FD8\u539F"});case 3:return j.abrupt("return");case 4:if(!l.isDirectory){j.next=9;break}return d=M()({},l),l.isRootFolder||(b=[].concat(I()(Le(N.current.rootFolder,N.current.currentFolder)),[d]),d.parents=b.slice(1,b.length-1),x=d.parents.findIndex(function(V){return V.path===l.path}),x!==-1&&(d.parents=d.parents.slice(0,x))),l.isRootFolder?B("/drive/my-drive",{state:{rootFolder:s,currentFolder:d,orderBy:N.current.sorter}}):B("/drive/folders/".concat(l.id),{state:{rootFolder:s,currentFolder:d,orderBy:N.current.sorter}}),j.abrupt("return");case 9:case"end":return j.stop()}},o)}));return function(o){return n.apply(this,arguments)}}(),[f,B,s]),mr=(0,r.useCallback)(function(){return(0,e.jsxs)("div",{className:"clouddrive-listfiles-no-rows d-flex flex-column flex-center",children:[(0,e.jsx)("img",{src:"/assets/media/illustrations/sketchy-1/5.png",className:"mw-200px"}),(0,e.jsx)("div",{className:"fs-1 fw-bolder text-dark mb-4",children:"\u5C06\u6587\u4EF6\u62D6\u62FD\u5230\u6B64\u5904"}),(0,e.jsxs)("div",{className:"fs-6",children:["\u6216\u70B9\u51FB \u201C",(0,e.jsx)("span",{className:"text-success",children:"\u4E0A\u4F20"}),"\u201D \u6309\u94AE"]})]})},[]),vr=(0,r.useCallback)(function(){return Q.totalCount===C&&C===0?oe?(0,e.jsx)(e.Fragment,{children:"\u52A0\u8F7D\u4E2D...."}):(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(e.Fragment,{children:[Q.totalCount===C?(0,e.jsx)(e.Fragment,{children:"\u5DF2\u5168\u90E8\u52A0\u8F7D"}):(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u52A0\u8F7D ",C," \u4E2A"]}),"\uFF0C\u5171 ",Q.totalCount," \u4E2A"]})},[C,oe,Q.totalCount]),Me=ce().filter(function(n){return y.includes(n.id)}).every(function(n){return n.starred}),hr=(0,r.useCallback)(function(n,o,l){N.current.sorter=l,K()},[]),Ie=(0,r.useMemo)(function(){return be.items.filter(function(n){return y.some(function(o){return o===n.id})})},[be,y]),pr=(0,r.useCallback)(function(){var n=w()(F()().mark(function o(l){var d;return F()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,Ne(1);case 2:d=ce(),d.some(function(p){return p&&p.id===l.id})&&de([l.id]);case 4:case"end":return x.stop()}},o)}));return function(o){return n.apply(this,arguments)}}(),[Ne,ce]),Re=(fe==null?void 0:fe.id)||(s==null?void 0:s.id);(0,r.useEffect)(function(){de([])},[Re,s==null?void 0:s.name]);var gr=(0,r.useCallback)(function(n){me(n,{space:J.space,folder:Re})},[J,Re,me]),He=(0,P.uI)({onDrop:gr}),Fr=He.getRootProps,xr=He.getInputProps,We=Fr(),$e=We.onClick,br=H()(We,sr),Cr=(0,r.useCallback)(function(n){$e&&$e(n)},[$e]),yr=(0,r.useCallback)(w()(F()().mark(function n(){var o,l,d;return F()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:o=be.items,l=o.filter(function(p){return y.includes(p.id)}),d=l.length===1?l[0].name:"\u3010\u6279\u91CF\u4E0B\u8F7D\u3011".concat(l[0].name," \u7B49 (").concat(l.length,").zip"),_(l,d);case 4:case"end":return x.stop()}},n)})),[be,_,y]),jr=(0,r.useCallback)(w()(F()().mark(function n(){var o,l,d,b;return F()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return o=A?A!=null&&A.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":y.length+" \u9879\u5185\u5BB9",p.next=3,t.Modal.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:"\u786E\u5B9A\u5220\u9664\u6240\u9009\u7684\u6587\u4EF6\u5417\uFF1F"}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u6587\u4EF6\u53EF\u5728 10\u5929 \u5185\u901A\u8FC7\u56DE\u6536\u7AD9\u8FD8\u539F"})]}),icon:"info",okText:"\u5220\u9664"});case 3:if(l=p.sent,l.isConfirmed){p.next=6;break}return p.abrupt("return");case 6:return p.next=8,he({variables:{ids:y}});case 8:d=p.sent,b=d.data,de([]),xe(b==null?void 0:b.files,function(j,V){return j.id===V.id}),t.Toast.success(o+" \u5DF2\u79FB\u81F3\u56DE\u6536\u7AD9",2e3,{placement:"bottom-left",progressBar:!0});case 13:case"end":return p.stop()}},n)})),[he,xe,A,y]),wr=(0,r.useCallback)(w()(F()().mark(function n(){var o;return F()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,t.Modal.confirm({title:"\u6E05\u7A7A\u56DE\u6536\u7AD9",content:"\u7CFB\u7EDF\u5C06\u6C38\u4E45\u5220\u9664\u56DE\u6536\u7AD9\u4E2D\u7684\u5185\u5BB9\uFF0C\u6B64\u64CD\u4F5C\u65E0\u6CD5\u6062\u590D \uFF1F"});case 2:if(o=d.sent,o.isConfirmed){d.next=5;break}return d.abrupt("return");case 5:return d.next=7,Be({variables:{space:s.space}});case 7:Ne(1),t.Toast.success("\u56DE\u6536\u7AD9\u5DF2\u88AB\u6E05\u7A7A",2e3,{placement:"bottom-left",progressBar:!0});case 9:case"end":return d.stop()}},n)})),[Be,c,Ne]),Ge=(0,r.useCallback)(w()(F()().mark(function n(){var o,l,d,b;return F()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return o=A?A!=null&&A.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":y.length+" \u9879\u5185\u5BB9",p.next=3,t.Modal.confirm({title:"\u786E\u5B9A\u8FD8\u539F",content:"\u786E\u8BA4\u8FD8\u539F\u9009\u4E2D\u7684 "+o+" \uFF1F"});case 3:if(l=p.sent,l.isConfirmed){p.next=6;break}return p.abrupt("return");case 6:return p.next=8,ie({variables:{ids:y}});case 8:d=p.sent,b=d.data,de([]),xe(b==null?void 0:b.files,function(j,V){return j.id===V.id}),t.Toast.success(o+" \u8FD8\u539F\u6210\u529F",2e3,{placement:"bottom-left",progressBar:!0});case 13:case"end":return p.stop()}},n)})),[xe,ie,A,y]),Ze=(0,r.useCallback)(w()(F()().mark(function n(){var o,l,d,b,x;return F()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(o=A?A!=null&&A.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":y.length+" \u9879\u5185\u5BB9",!Me){j.next=10;break}return j.next=4,re({variables:{files:y,starred:!1}});case 4:l=j.sent,d=l.data,De(d==null?void 0:d.files,function(V,Ee){return V.id===Ee.id}),t.Toast.success(o+"\u5DF2\u4ECE\u6536\u85CF\u4E2D\u79FB\u9664",2e3,{placement:"bottom-left",progressBar:!0}),j.next=16;break;case 10:return j.next=12,re({variables:{files:y,starred:!0}});case 12:b=j.sent,x=b.data,f==="starred"?(de([]),xe(x==null?void 0:x.files,function(V,Ee){return V.id===Ee.id})):De(x==null?void 0:x.files,function(V,Ee){return V.id===Ee.id}),t.Toast.success(o+" \u5DF2\u6DFB\u52A0\u5230\u6536\u85CF",2e3,{placement:"bottom-left",progressBar:!0});case 16:K();case 17:case"end":return j.stop()}},n)})),[De,xe,A,y,re,Me,f]),Nr=(0,r.useCallback)(w()(F()().mark(function n(){return F()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:N.current.renameFile=A,K();case 2:case"end":return l.stop()}},n)})),[A]),Dr=(0,r.useCallback)(function(n){var o=new URLSearchParams(T.search);n.trim()===""?o.delete("q"):o.set("q",n),B({pathname:T.pathname,search:o.toString()||void 0})},[]),ne=(0,r.useMemo)(function(){return y.length?y.length===1?"row":"multi-row":"no_rows"},[y.length]),Er=(0,r.useMemo)(function(){if(f==="starred")return function(){return(0,e.jsx)("div",{children:(0,e.jsx)(t.Button,{color:"success",variant:!1,className:"trash-restore",onClick:Ze,icon:(0,e.jsx)(m.ZP,{name:"Duotune/arr029",className:"svg-icon-4 svg-icon-success me-1"}),children:"\u53D6\u6D88\u6536\u85CF"})})};if(f==="trash")return function(){return(0,e.jsx)("div",{children:(0,e.jsxs)(t.Button,{color:"primary",variant:!1,className:"trash-restore",onClick:Ge,children:[(0,e.jsx)(m.ZP,{name:"Duotune/arr029",className:"svg-icon-4 svg-icon-success me-1"}),"\u8FD8\u539F"]})})}},[Ge,Ze,f]),kr=(0,r.useMemo)(function(){return!!Ie.length},[Ie,fe]);return(0,e.jsxs)(t.Card,{className:"list-files",flush:!0,children:[f==="default"&&(0,e.jsxs)(t.Card.Header,{className:"pt-8 flex-row-reverse",children:[(0,e.jsx)(t.Card.Title,{children:(0,e.jsx)(t.Input.Search,{size:"lg",solid:!0,className:"rounded-2 w-300px",placeholder:"\u641C\u7D22 \u6587\u4EF6 & \u6587\u4EF6\u5939",defaultValue:v==null?void 0:v.name_contains,onSearch:Dr})}),(0,e.jsx)(t.Card.Toolbar,{children:(0,e.jsxs)("div",{className:te()("d-flex justify-content-end",{"file-action-group gap-2":["row","multi-row"].includes(ne)}),children:[ne==="no_rows"&&(0,e.jsxs)(e.Fragment,{children:[f==="default"&&(0,e.jsx)(t.Button,{variant:"primary",className:"rounded-2 me-3",icon:(0,e.jsx)(m.ZP,{className:"svg-icon-2 me-1",name:"Duotune/fil018"}),onClick:Cr,children:"\u4E0A\u4F20\u6587\u4EF6"}),f==="default"&&(s==null?void 0:s.isRootFolder)&&(0,e.jsx)(t.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(m.ZP,{className:"svg-icon-2 me-1",name:"Duotune/fil013"}),onClick:ee,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"})]}),["row","multi-row"].includes(ne)&&(0,e.jsx)(t.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(m.ZP,{className:"svg-icon-2 me-1",name:"Duotune/arr095"}),children:"\u5206\u4EAB"}),["row","multi-row"].includes(ne)&&(0,e.jsx)(t.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(m.ZP,{className:"svg-icon-2 me-1",style:{transform:"rotateZ(90deg)"},name:"Duotune/arr076"}),onClick:yr,children:"\u4E0B\u8F7D"}),["row","multi-row"].includes(ne)&&(0,e.jsx)(t.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(m.ZP,{className:"svg-icon-2 me-1",name:"Duotune/gen027"}),onClick:jr,children:"\u5220\u9664"}),ne==="row"&&(0,e.jsx)(t.Button,{as:"button",variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(m.ZP,{className:"svg-icon-2 me-1",name:"Duotune/gen055"}),onClick:Nr,children:"\u91CD\u547D\u540D"}),["row","multi-row"].includes(ne)&&(0,e.jsx)(t.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(m.ZP,{className:"svg-icon-2 me-1",name:"Duotune/arr033"}),children:"\u79FB\u52A8"}),["row","multi-row"].includes(ne)&&(0,e.jsx)(t.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(m.ZP,{className:"svg-icon-2 me-1",name:"Duotune/abs024"}),onClick:Ze,children:Me?"\u53D6\u6D88\u6536\u85CF":"\u6536\u85CF"})]})})]}),(0,e.jsxs)(t.Card.Body,{className:"d-flex flex-row",children:[(0,e.jsxs)("div",M()(M()({className:"flex-row-fluid"},br),{},{children:[(0,e.jsxs)("div",{className:"d-flex flex-stack",children:[(0,e.jsx)(tr,{onClick:Ve,paths:fr}),(0,e.jsx)(t.Badge,{size:"lg",color:"white",children:vr()})]}),f==="trash"&&!!be.rowCount&&(0,e.jsx)(t.Alert,{theme:"Light",type:"primary",action:(0,e.jsx)(t.Button,{onClick:wr,variant:"light-primary",className:"me-3 ls-1",children:"\u6E05\u7A7A\u56DE\u6536\u7AD9"}),message:"\u5185\u5BB9\u79FB\u81F3\u56DE\u6536\u7AD9\u540E\u4F1A\u5728 10 \u5929\u540E\u88AB\u6C38\u4E45\u5220\u9664"}),(0,e.jsx)("input",M()({},xr())),(0,e.jsx)(t.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:oe,children:!Q.totalCount&&!oe?mr():(0,e.jsx)(t.Table,{rowKey:"id",hover:!0,rowSelection:{type:"checkbox",selectedRowKeys:y,renderTitle:function(o){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:o}),"\u4E2A\u6587\u4EF6/\u6587\u4EF6\u5939"]})},toolbar:Er,onChange:or},rowHeight:50,columns:[{key:"name",title:(0,e.jsx)("span",{className:"ps-2",children:"\u6587\u4EF6\u540D"}),className:"min-w-250px",sorter:!0,sortOrder:(R==null?void 0:R.field)==="name"?R.order:void 0,render:function(o,l){var d;return(0,e.jsx)(er,{onClick:Ve,onSuccess:cr,onCancelRename:dr,data:l,editable:l.id===((d=N.current.renameFile)===null||d===void 0?void 0:d.id)})}},{key:"lastModified",title:"\u66F4\u65B0\u65F6\u95F4",sorter:!0,width:160,sortOrder:(R==null?void 0:R.field)==="lastModified"?R.order:void 0},{key:"size",title:"\u6587\u4EF6\u5927\u5C0F",sorter:!0,width:100,sortOrder:(R==null?void 0:R.field)==="size"?R.order:void 0,render:function(o,l){return l.isDirectory?"-":(0,Ue.jb)(o)}}],dataSource:be,onChange:hr})})]})),kr&&(0,e.jsx)("div",{className:"file-details-quick-preview pb-7",children:(0,e.jsx)(Ye,{files:Ie,currentFolder:fe})}),(0,e.jsx)(ar,{onCancel:je,visible:N.current.newFolderVisible,parentFolder:Re,onSuccess:pr})]})]})}var ur=lr},20640:function(Ce,U,u){"use strict";var q=u(11742),H={"text/plain":"Text","text/html":"Url",default:"Text"},O="Copy to clipboard: #{key}, Enter";function F(w){var k=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return w.replace(/#{\s*key\s*}/g,k)}function ye(w,k){var g,Z,M,W,I,r,P=!1;k||(k={}),g=k.debug||!1;try{M=q(),W=document.createRange(),I=document.getSelection(),r=document.createElement("span"),r.textContent=w,r.ariaHidden="true",r.style.all="unset",r.style.position="fixed",r.style.top=0,r.style.clip="rect(0, 0, 0, 0)",r.style.whiteSpace="pre",r.style.webkitUserSelect="text",r.style.MozUserSelect="text",r.style.msUserSelect="text",r.style.userSelect="text",r.addEventListener("copy",function(m){if(m.stopPropagation(),k.format)if(m.preventDefault(),typeof m.clipboardData=="undefined"){g&&console.warn("unable to use e.clipboardData"),g&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var $=H[k.format]||H.default;window.clipboardData.setData($,w)}else m.clipboardData.clearData(),m.clipboardData.setData(k.format,w);k.onCopy&&(m.preventDefault(),k.onCopy(m.clipboardData))}),document.body.appendChild(r),W.selectNodeContents(r),I.addRange(W);var z=document.execCommand("copy");if(!z)throw new Error("copy command was unsuccessful");P=!0}catch(m){g&&console.error("unable to copy using execCommand: ",m),g&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(k.format||"text",w),k.onCopy&&k.onCopy(window.clipboardData),P=!0}catch($){g&&console.error("unable to copy using clipboardData: ",$),g&&console.error("falling back to prompt"),Z=F("message"in k?k.message:O),window.prompt(Z,w)}}finally{I&&(typeof I.removeRange=="function"?I.removeRange(W):I.removeAllRanges()),r&&document.body.removeChild(r),M()}return P}Ce.exports=ye},86366:function(Ce,U,u){"use strict";u.d(U,{Z:function(){return g}});var q=u(20640),H=u.n(q),O=u(67294);function F(){var Z=(0,O.useRef)(!1),M=(0,O.useCallback)(function(){return Z.current},[]);return(0,O.useEffect)(function(){return Z.current=!0,function(){Z.current=!1}},[]),M}var ye=function(Z){Z===void 0&&(Z={});var M=(0,O.useState)(Z),W=M[0],I=M[1],r=(0,O.useCallback)(function(P){I(function(z){return Object.assign({},z,P instanceof Function?P(z):P)})},[]);return[W,r]},w=ye,k=function(){var Z=F(),M=w({value:void 0,error:void 0,noUserInteraction:!0}),W=M[0],I=M[1],r=(0,O.useCallback)(function(P){if(Z()){var z,m;try{if(typeof P!="string"&&typeof P!="number"){var $=new Error("Cannot copy typeof "+typeof P+" to clipboard, must be a string");I({value:P,error:$,noUserInteraction:!0});return}else if(P===""){var $=new Error("Cannot copy empty string to clipboard.");I({value:P,error:$,noUserInteraction:!0});return}m=P.toString(),z=H()(m),I({value:m,error:void 0,noUserInteraction:z})}catch(Pe){I({value:m,error:Pe,noUserInteraction:z})}}},[]);return[W,r]},g=k},11742:function(Ce){Ce.exports=function(){var U=document.getSelection();if(!U.rangeCount)return function(){};for(var u=document.activeElement,q=[],H=0;H<U.rangeCount;H++)q.push(U.getRangeAt(H));switch(u.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":u.blur();break;default:u=null;break}return U.removeAllRanges(),function(){U.type==="Caret"&&U.removeAllRanges(),U.rangeCount||q.forEach(function(O){U.addRange(O)}),u&&u.focus()}}}}]);
