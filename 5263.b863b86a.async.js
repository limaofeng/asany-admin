(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[5263],{33442:function(ee,W,n){"use strict";var k=n(11849),A=n(3182),p=n(94043),N=n.n(p),v=n(67294),l=n(53704),w=n(25496);function H(U,Z){var I=(0,v.useRef)(!1),V=(0,v.useCallback)((0,A.Z)(N().mark(function Q(){var S,$;return N().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return S=U.width,f.next=3,l.u_.confirm((0,k.Z)((0,k.Z)({},U),{},{width:S,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!I.current},preConfirm:function(){var L=(0,A.Z)(N().mark(function Y(){var a,e,G;return N().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return I.current=!0,x.prev=1,a=document.querySelector(".swal2-confirm"),a.textContent="\u5220\u9664\u4E2D...",e=document.createElement("span"),e.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),a.appendChild(e),x.next=9,(0,w.gw)(Z(),350);case 9:G=x.sent,console.log(G);case 11:return x.prev=11,I.current=!1,x.finish(11);case 14:case"end":return x.stop()}},Y,null,[[1,,11,14]])}));function z(){return L.apply(this,arguments)}return z}()}));case 3:if($=f.sent,$.isConfirmed){f.next=6;break}return f.abrupt("return",!1);case 6:return l.FN.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),f.abrupt("return",!0);case 8:case"end":return f.stop()}},Q)})),[Z,U]);return[V]}W.Z=H},45263:function(ee,W,n){"use strict";n.r(W);var k=n(93224),A=n(3182),p=n(2824),N=n(94043),v=n.n(N),l=n(67294),w=n(28865),H=n(94184),U=n.n(H),Z=n(19755),I=n.n(Z),V=n(30381),Q=n.n(V),S=n(80129),$=n.n(S),g=n(73727),f=n(43219),L=n(8845),z=n(33442),Y=n(75468),a=n(53704),e=n(85893);window._MoreshowOrhide=function(o){return I()(o).parent().siblings().show(),I()(o).parent().remove(),!1};function G(o){var u=o.selectedRows,D=o.refetch,c=(0,L.nT)(),P=(0,p.Z)(c,1),O=P[0],y=(0,z.Z)({title:(0,e.jsxs)(e.Fragment,{children:["\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9",u.length>1&&(0,e.jsxs)(e.Fragment,{children:["\u201C",(0,e.jsx)("strong",{children:u.length}),"\u201C`"]}),"\u7BC7\u6587\u7AE0\u5417\uFF1F"]}),content:u.length>1?'\u60A8\u5373\u5C06\u5220\u9664\u4EE5\u4E0B\u6587\u7AE0:<ul className="py-2">'.concat(u.map(function(m,_){return"<li ".concat(_>=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 mb-1 fs-6"><span className="bullet bullet-dot me-2"></span><strong>').concat(m.title,"</strong></li>")}).join(""),`
              <li `).concat(u.length<=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 fs-6"><a href="javascript:void(0)" onClick="_MoreshowOrhide(this)">\u66F4\u591A</a></li></ul> '):(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:u[0].title}),"\u201D\u3002",(0,e.jsx)("br",{}),"\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})},(0,A.Z)(v().mark(function m(){return v().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,O({variables:{ids:u.map(function(b){return b.id})}});case 2:case"end":return i.stop()}},m)}))),d=(0,p.Z)(y,1),F=d[0],j=(0,l.useCallback)((0,A.Z)(v().mark(function m(){return v().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,F();case 2:return i.next=4,D();case 4:case"end":return i.stop()}},m)})),[F,D]);return(0,e.jsx)(a.zx,{color:"danger",onClick:j,variant:!1,size:"sm",className:"px-4 py-2",children:"\u6279\u91CF\u5220\u9664"})}function J(o){var u=o.data,D=o.refetch,c=o.baseUrl,P=(0,l.useState)(!1),O=(0,p.Z)(P,2),y=O[0],d=O[1],F=(0,L.eU)(),j=(0,p.Z)(F,1),m=j[0],_=(0,z.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",content:(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:u.title}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})},(0,A.Z)(v().mark(function B(){return v().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,m({variables:{id:u.id}});case 2:case"end":return h.stop()}},B)}))),i=(0,p.Z)(_,1),b=i[0],M=(0,l.useCallback)((0,A.Z)(v().mark(function B(){return v().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,b();case 2:return h.next=4,D();case 4:case"end":return h.stop()}},B)})),[b,D]),R=(0,l.useCallback)(function(B){var T=B.key;T=="edit"?f.m8.push("".concat(c,"/articles/").concat(u.id)):T=="delete"&&(d(!1),M())},[]);return(0,e.jsx)(a.Lt,{overlay:(0,e.jsxs)(a.v2,{onClick:R,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(a.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(a.v2.Item,{className:"px-3",children:"\u53D1\u5E03"},"publish"),(0,e.jsx)(a.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:d,visible:y,children:(0,e.jsxs)(a.zx,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(w.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function x(o){var u,D,c=o.match.params.id,P=o.location.state,O=P.rootCategoryId,y=P.categories,d=P.baseUrl,F=(0,l.useMemo)(function(){var t,r=y.find(function(s){return s.id==c});return((r==null||(t=r.path)===null||t===void 0?void 0:t.split("/"))||[]).map(function(s){return y.find(function(C){return C.id==s})}).filter(function(s){return s})},[y,c]),j=(0,l.useMemo)(function(){var t=o.location.query,r=t.q,s=(0,k.Z)(t,["q"]);return s.filter||(s.filter={}),r&&(s.filter={name_contains:r}),s.filter.category={id:c,subColumns:!0},s},[o.location,c]),m=(0,L.gk)({variables:j,fetchPolicy:"cache-and-network"}),_=m.data,i=m.refetch,b=m.loading,M=m.previousData,R=(0,l.useMemo)(function(){return b?(M==null?void 0:M.articles)||{edges:[],total:0,current:1}:(_==null?void 0:_.articles)||{edges:[],total:0,current:1}},[_==null?void 0:_.articles,b,M==null?void 0:M.articles]),B=(0,l.useMemo)(function(){return R.edges.map(function(t){return t.node})},[R.edges]),T=(0,l.useCallback)(function(t){console.log(t)},[]),h=(0,l.useCallback)(function(t,r,s){var C,E={};if((C=j.filter)!==null&&C!==void 0&&C.name_contains){var K;E.q=(K=j.filter)===null||K===void 0?void 0:K.name_contains}s&&(E.orderBy=s.field+"_"+(s.order=="ascend"?"asc":"desc")),E.page=t.current,f.m8.replace(location.pathname+"?"+$().stringify(E))},[(u=j.filter)===null||u===void 0?void 0:u.name_contains]),ae=(0,l.useState)([]),X=(0,p.Z)(ae,2),ne=X[0],q=X[1],te=(0,l.useCallback)(function(t,r){q(r)},[q]),se=(0,l.useMemo)(function(){return function(t,r){return(0,e.jsx)(G,{selectedRows:r,refetch:i})}},[i]);return(0,e.jsx)(Y.v,{loading:b,header:{title:(D=y.find(function(t){return t.id==c}))===null||D===void 0?void 0:D.name},breadcrumb:(0,e.jsx)(a.aG,{className:"fw-bold fs-base text-muted my-1",children:F?(0,e.jsx)(e.Fragment,{children:F.filter(function(t){return t.id!=O}).map(function(t){return t.id==c?(0,e.jsx)(a.aG.Item,{className:"text-dark",children:t.name},t.id):(0,e.jsx)(a.aG.Item,{children:(0,e.jsx)(g.Link,{to:"".concat(d,"/cms/categories/").concat(t.id,"/articles"),className:"text-muted",children:t.name})},t.id)})}):(0,e.jsx)(a.aG.Item,{children:"\u52A0\u8F7D\u4E2D..."})}),children:(0,e.jsx)("div",{className:"tab-content",children:(0,e.jsxs)(a.Zb,{flush:!0,headerClassName:"mt-5",children:[(0,e.jsxs)(a.Zb.Header,{className:"pt-8",children:[(0,e.jsx)(a.Zb.Title,{className:"flex-column",children:(0,e.jsx)(a.II.Search,{solid:!0,className:"w-250px",placeholder:"\u641C\u7D22\u6587\u7AE0",onSearch:T})}),(0,e.jsx)(a.Zb.Toolbar,{children:(0,e.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,e.jsx)(a.Lt,{overlay:(0,e.jsxs)(a.v2,{className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(a.v2.Item,{className:"px-3",children:"\u6700\u65B0"},"edit"),(0,e.jsx)(a.v2.Item,{className:"px-3",children:"\u6700\u665A"},"publish"),(0,e.jsx)(a.v2.Item,{className:"px-3 actions-delete",children:"\u6700\u8FD1\u66F4\u65B0\u7684"},"delete"),(0,e.jsx)(a.v2.Item,{className:"px-3 actions-delete",children:"\u70B9\u51FB\u91CF"},"delete")]}),placement:"bottomLeft",children:(0,e.jsx)(a.zx,{variant:"white",className:"me-3",children:"\u6392\u5E8F: \u6700\u65B0"})}),(0,e.jsx)(a.zx,{as:g.Link,variant:"primary",className:"me-3",icon:(0,e.jsx)(w.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),to:"".concat(d,"/cms/categories/").concat(c,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]}),(0,e.jsx)(a.Zb.Body,{className:"pt-0",children:R.total?(0,e.jsx)(a.iA,{rowKey:"id",rowSelection:{type:"checkbox",onChange:te,selectedRowKeys:(ne||[]).map(function(t){return t.id}),renderTitle:function(r){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:r}),"\u7BC7\u6587\u7AE0"]})},toolbar:se},pagination:R,dataSource:B,onChange:h,rowHeight:136,columns:[{title:"\u6807\u9898",dataIndex:"title",key:"title",render:function(r,s){var C;return(0,e.jsxs)("div",{className:"d-flex flex-row tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"d-flex flex-column align-items-start tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"meta-container no-selecto-drag",children:[(0,e.jsx)(g.Link,{to:"/xx/12",className:"user-message",children:"\u6797\u66AE\u6625"}),(0,e.jsx)("span",{className:"created-at",children:Q()(s.createdAt).fromNow()}),(0,e.jsx)("div",{className:"category_list",children:s.categories.filter(function(E){return E.id!==O}).map(function(E){return(0,e.jsx)(g.Link,{to:"".concat(d,"/cms/categories/").concat(E.id,"/articles"),className:"tag",children:E.name},E.id)})})]}),(0,e.jsx)(g.Link,{onClick:function(K){return K.stopPropagation()},to:"".concat(d,"/cms/categories/").concat(c,"/articles/").concat(s.id),className:"mt-2 mb-2 text-gray-800 no-selecto-drag fs-4 text-hover-primary mb-1",children:r}),(0,e.jsx)("div",{className:U()("summary mb-2 w-100 tw-text-ellipsis tw-truncate w-100",{"pe-8":!s.image}),children:(0,e.jsx)("span",{className:"text-muted fs-base no-selecto-drag",children:s.summary||"\u6CA1\u6709\u4EFB\u4F55\u5185\u5BB9..."})}),(0,e.jsxs)("div",{className:"fs-base",children:[(0,e.jsxs)(g.Link,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(d,"/cms/categories/").concat(c,"/articles/").concat(s.id),children:[(0,e.jsx)(w.ZP,{className:"svg-icon-4 me-2",name:"Bootstrap/eye"}),"41W"]}),(0,e.jsxs)(g.Link,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(d,"/cms/categories/").concat(c,"/articles/").concat(s.id,"#comments"),children:[(0,e.jsx)(w.ZP,{className:"svg-icon-6 me-2",name:"Bootstrap/chat"}),"41W"]})]})]}),s.image&&(0,e.jsx)("div",{className:"px-8 d-flex align-items-end",children:(0,e.jsx)(a.mN,{className:"article-image",src:"//47.103.119.188:8000"+"/preview/".concat((C=s.image)===null||C===void 0?void 0:C.id)})})]})}},{title:"\u72B6\u6001",dataIndex:"status",width:120,render:function(r){var s={DRAFT:{title:"\u8349\u7A3F",lightStyle:"danger"},PUBLISHED:{title:"\u5DF2\u53D1\u5E03"},SCHEDULED:{title:"\u8BA1\u5212",lightStyle:"primary"}};return(0,e.jsx)(a.Ct,{lightStyle:s[r].lightStyle,children:s[r].title})}},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(r,s){return(0,e.jsx)(J,{baseUrl:"".concat(d,"/cms/categories/").concat(c),data:s,refetch:i})}}]}):(0,e.jsxs)(a.HY,{title:"\u65B0\u589E\u6587\u7AE0",description:"\u8BE5\u680F\u76EE\u8FD8\u662F\u7A7A\u7684\uFF0C\u6CA1\u6709\u4EFB\u4F55\u6587\u7AE0",image:"/assets/media/illustrations/sigma-1/4.png",children:[(0,e.jsx)(a.zx,{as:g.Link,className:"me-2",variant:"light",to:"".concat(d,"/settings"),children:"\u67E5\u770B\u680F\u76EE\u4FE1\u606F"}),(0,e.jsx)(a.zx,{as:g.Link,variant:"primary",to:"".concat(d,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]})})})}W.default=x}}]);
