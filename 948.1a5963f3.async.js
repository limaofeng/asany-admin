"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[948],{14336:function(ue,W,n){var Z=n(15009),b=n.n(Z),G=n(99289),B=n.n(G),H=n(97857),A=n.n(H),z=n(5574),M=n.n(z),u=n(62435),g=n(79817),m=n(12708);function a(s,e){return s.replace(/{(\w+)}/g,function(f,v){return e[v]!==void 0?e[v]:f})}function i(s,e){var f=s(A()({fetchPolicy:"network-only"},(e==null?void 0:e.mutation)||{})),v=M()(f,1),P=v[0],k=(0,u.useRef)(!1),r=(0,u.useCallback)(function(){var K=B()(b()().mark(function w(_,x){var R,S,X,re,o,t,y,C,I;return b()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return R=(x==null?void 0:x.dialog)||(e==null?void 0:e.dialog)||{},S=(x==null?void 0:x.mutation)||(e==null?void 0:e.mutation)||{},X=(x==null?void 0:x.onDeleted)||(e==null?void 0:e.onDeleted),re=R.width,o=R.title,t=R.content,y=!1,Array.isArray(_)?(y=!0,typeof o=="function"&&(o=o(_,{batch:!0})),typeof t=="function"&&(t=t(_,{batch:!0}))):_&&(typeof o=="string"&&(o=a(o,_)),typeof t=="string"&&(t=a(t,_)),typeof o=="function"&&(o=o(_,{batch:!1})),typeof t=="function"&&(t=t(_,{batch:!1}))),C=function(){var l=B()(b()().mark(function j(){return b()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,P(A()(A()({fetchPolicy:"network-only"},S),{},{variables:{where:{id_in:y?_:[_==null?void 0:_.id]}}}));case 2:case"end":return D.stop()}},j)}));return function(){return l.apply(this,arguments)}}(),d.next=10,g.Modal.confirm(A()(A()({},R),{},{title:o,content:t,width:re,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!k.current},preConfirm:function(){var l=B()(b()().mark(function U(){var D,O,T;return b()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return k.current=!0,E.prev=1,D=document.querySelector(".swal2-confirm"),D.textContent="\u5220\u9664\u4E2D...",O=document.createElement("span"),O.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),D.appendChild(O),E.next=9,(0,m.gw)(C(),350);case 9:T=E.sent,X&&X(T);case 11:return E.prev=11,k.current=!1,E.finish(11);case 14:case"end":return E.stop()}},U,null,[[1,,11,14]])}));function j(){return l.apply(this,arguments)}return j}()}));case 10:if(I=d.sent,I.isConfirmed){d.next=13;break}return d.abrupt("return",!1);case 13:return g.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),d.abrupt("return",!0);case 15:case"end":return d.stop()}},w)}));return function(w,_){return K.apply(this,arguments)}}(),[]),Q=(0,u.useCallback)(function(){var K=B()(b()().mark(function w(_,x){return b()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",r(_,x));case 1:case"end":return S.stop()}},w)}));return function(w,_){return K.apply(this,arguments)}}(),[e,P]),ae=(0,u.useCallback)(function(K,w){return r(K,w)},[]);return{delete:Q,deleteMany:ae}}W.Z=i},58301:function(ue,W,n){n.d(W,{Oh:function(){return z},bp:function(){return M}});var Z=n(97857),b=n.n(Z),G=n(62435);function B(u,g){var m,a,i=u(b()({fetchPolicy:"network-only"},g)),s=i.data,e=i.loading,f=i.previousData,v=i.refetch,P=i.error;console.log("=====>",s,g);var k=(0,G.useMemo)(function(){return e?f==null?void 0:f.result.pageInfo:s==null?void 0:s.result.pageInfo},[s==null||(m=s.result)===null||m===void 0?void 0:m.pageInfo.total,e,f==null||(a=f.result)===null||a===void 0?void 0:a.pageInfo.total]),r=(s==null?void 0:s.result.edges.map(function(Q){return Q.node}))||[];return[r,{loading:e,pageInfo:k,error:P,variables:{},refetch:v}]}function H(u,g){return g.split(".").reduce(function(m,a){return m&&m[a]!==void 0?m[a]:void 0},u)}function A(u,g,m){for(var a=g.split("."),i=u;a.length>1;){var s=a.shift();i[s]||(i[s]={}),i=i[s]}i[a[0]]=m}function z(u,g){var m=g.map(function(a){var i=a.source,s=a.target,e=a.transform,f=a.skip,v=H(u,i);if(v==null||f&&f(v))return"";var P=e?e(v):String(v);return"".concat(encodeURIComponent(s||i),"=").concat(encodeURIComponent(P))});return m.filter(function(a){return a}).join("&")}function M(u,g){var m={};return g.forEach(function(a){var i=a.source,s=a.target,e=a.transform,f=a.skip,v=u.get(i);if(!(!v||v.trim()==="")){var P=e?e(v):v;f&&f(P)||(s?A(m,s,P):m[i]=P)}}),m}W.ZP=B},40948:function(ue,W,n){n.r(W),n.d(W,{default:function(){return re}});var Z=n(97857),b=n.n(Z),G=n(15009),B=n.n(G),H=n(99289),A=n.n(H),z=n(5574),M=n.n(z),u=n(62435),g=n(39711),m=n(96974),a=n(46027),i=n(58301),s=n(73588),e=n(79817),f=n(12708),v=n(13769),P=n.n(v),k=n(60551),r=n(86074),Q=["id"];function ae(o){var t=o.form,y=o.mode;return(0,r.jsxs)(e.Form,{form:t,children:[(0,r.jsx)(e.Form.Item,{className:"d-flex flex-column mb-7",name:"id",label:"\u7F16\u7801",rules:[{required:!0}],children:(0,r.jsx)(e.Input,{solid:!0,readOnly:y==="edit"})}),(0,r.jsx)(e.Form.Item,{className:"d-flex flex-column mb-7",name:"name",label:"\u540D\u79F0",rules:[{required:!0}],children:(0,r.jsx)(e.Input,{solid:!0})}),(0,r.jsx)(e.Form.Item,{className:"d-flex flex-column mb-7",name:"description",label:"\u63CF\u8FF0",children:(0,r.jsx)(e.Input.TextArea,{solid:!0})})]})}var K=function(t){var y=(0,u.useState)(!1),C=M()(y,2),I=C[0],F=C[1],d=t.visible,l=t.data,j=t.refetch,U=(0,k.X9)(),D=M()(U,1),O=D[0],T=(0,k.f0)(),ne=M()(T,1),E=ne[0],V=e.Form.useForm(),$=(0,u.useCallback)(function(){t.setVisible(!1)},[]),J=(0,u.useCallback)(A()(B()().mark(function te(){var Y,q,p;return B()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,V.validateFields();case 2:if(Y=c.sent,q=Y.id,p=P()(Y,Q),F(!0),c.prev=6,!(l!=null&&l.id)){c.next=12;break}return c.next=10,E({variables:{id:q,input:p}});case 10:c.next=14;break;case 12:return c.next=14,O({variables:{input:b()({id:q},p)}});case 14:t.setVisible(!1);case 15:return c.prev=15,F(!1),j(),c.finish(15);case 19:case"end":return c.stop()}},te,null,[[6,,15,19]])})),[j,l]);return(0,u.useEffect)(function(){d?l&&V.setFieldsValue({id:l.id,name:l.name,description:l.description}):V.resetFields()},[d,l]),(0,r.jsxs)(e.Modal,{width:640,centered:!0,onOk:J,confirmLoading:I,okText:"\u4FDD\u5B58",visible:d,onCancel:$,children:[(0,r.jsx)(e.Modal.Header,{closable:!0,className:"ms-5 border-0",children:(0,r.jsx)("h1",{className:"modal-title pt-6 pb-4",children:"\u6DFB\u52A0\u54C1\u724C"})}),(0,r.jsx)(e.Modal.Body,{children:(0,r.jsx)(ae,{form:V,mode:l!=null&&l.id?"edit":"create"})})]})},w=n(14336),_=n(86235);function x(o){var t=(0,w.Z)(_.rD,{onDeleted:function(){o&&o()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(F,d){var l;if(d.batch){var j=F;l="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(j.length," \u4E2A\u54C1\u724C\u5417\uFF1F")}else l=(0,r.jsxs)(r.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,r.jsx)("strong",{children:F.name})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"tip-confirm",children:l}),(0,r.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),y=t.delete,C=t.deleteMany;return{delete:y,deleteMany:C}}var R=x;function S(o){var t=o.data,y=o.refetch,C=o.onEdit,I=(0,u.useState)(!1),F=M()(I,2),d=F[0],l=F[1],j=R(function(){return y()}),U=j.delete,D=(0,u.useCallback)(function(O){var T=O.key;T==="edit"?C():T==="delete"&&U({name:t.name,id:t.id})},[C]);return(0,r.jsx)(e.Dropdown,{overlay:(0,r.jsxs)(e.Menu,{onClick:D,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,r.jsx)(e.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,r.jsx)(e.Menu.Item,{className:"px-3",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:l,visible:d,children:(0,r.jsxs)(e.Button,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,r.jsx)(a.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function X(){var o=(0,u.useState)({visible:!1}),t=M()(o,2),y=t[0],C=t[1],I=(0,g.lr)(),F=M()(I,1),d=F[0],l=(0,m.s0)(),j=(0,u.useMemo)(function(){return(0,i.bp)(d,[{source:"q",target:"keywords"}])},[d.get("q")]),U=(0,u.useCallback)(function(p,h,c){var L=(0,i.Oh)({searchForm:j,pagination:p,filters:h,sorter:c},[{source:"searchForm.keywords",target:"q",skip:function(N){return!N}},{source:"pagination.current",target:"page",skip:function(N){return N===1}},{source:"pagination.pageSize",target:"per_page",skip:function(N){return N===15}},{source:"sorter.field",target:"sort",transform:function(N){return"".concat(N,":").concat(c.order==="ascend"?"asc":"desc")}}]);l(location.pathname+"?"+L,{replace:!0})},[j]),D=(0,u.useMemo)(function(){return(0,i.bp)(d,[{source:"q",target:"where.name_contains"},{source:"sex",target:"where.sex"},{source:"page",transform:function(h){return parseInt(h)}},{source:"per_page",transform:function(h){return parseInt(h)}},{source:"sort",target:"orderBy",transform:function(h){var c=h.split(":"),L=M()(c,2),ee=L[0],N=L[1];return"".concat(ee,"_").concat(N)}}])},[d.toString()]),O=(0,i.ZP)(k.ac,{variables:D}),T=M()(O,2),ne=T[0],E=T[1],V=E.loading,$=E.pageInfo,J=E.refetch,te=R(function(){return J()}),Y=te.deleteMany,q=(0,u.useCallback)(function(p){return A()(B()().mark(function h(){return B()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:Y(p);case 1:case"end":return L.stop()}},h)}))},[]);return(0,r.jsxs)(s.vs,{header:{title:"\u54C1\u724C\u5217\u8868"},children:[(0,r.jsx)(K,{visible:y.visible,setVisible:function(h){return C(b()(b()({},y),{},{visible:h}))},refetch:J,data:y.data}),!($!=null&&$.total)&&!V?(0,r.jsx)(e.Card,{className:"mb-5 mb-xl-10",children:(0,r.jsx)(e.Empty,{title:"\u8FD8\u6CA1\u6709\u54C1\u724C",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u54C1\u724C\u5427\uFF01",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,r.jsx)(e.Button,{variant:"primary",children:"\u6DFB\u52A0\u54C1\u724C"})})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(e.Card,{className:"mb-5 mb-xl-10",children:[(0,r.jsxs)(e.Card.Header,{className:"pt-8",children:[(0,r.jsx)(e.Card.Title,{className:"flex-column"}),(0,r.jsx)(e.Card.Toolbar,{children:(0,r.jsx)("div",{className:"d-flex justify-content-end",children:(0,r.jsx)(e.Button,{variant:"primary",className:"me-3",icon:(0,r.jsx)(a.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),onClick:function(){return C({visible:!0})},children:"\u6DFB\u52A0\u54C1\u724C"})})})]}),(0,r.jsx)(e.Card.Body,{children:(0,r.jsx)(e.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:V,children:(0,r.jsx)(e.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(h){return(0,r.jsxs)(r.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,r.jsx)("span",{className:"mx-2",children:h}),"\u4E2A\u54C1\u724C"]})},toolbar:function(h){return(0,r.jsx)("div",{children:(0,r.jsx)(e.Button,{color:"success",onClick:q(h),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},noRowsRenderer:function(){return(0,r.jsx)(e.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"id",title:"\u7F16\u7801",sorter:!0,sortOrder:(0,f.PE)(d,"id"),width:120},{key:"name",title:"\u54C1\u724C\u540D\u79F0",sorter:!0,width:180,sortOrder:(0,f.PE)(d,"name")},{key:"description",title:"\u63CF\u8FF0"},{key:"createdAt",title:"\u521B\u5EFA\u65F6\u95F4",width:120},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(h,c){return(0,r.jsx)(S,{data:c,onEdit:function(){C({visible:!0,data:c})},refetch:J})}}],pagination:$,onChange:U,dataSource:ne})})})]})})]})}var re=X}}]);
