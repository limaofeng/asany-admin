"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1941],{31941:function(G,g,r){r.r(g);var I=r(15009),d=r.n(I),T=r(97857),m=r.n(T),U=r(99289),D=r.n(U),R=r(5574),p=r.n(R),y=r(62435),C=r(96974),k=r(73588),a=r(13757),v=r(19975),e=r(86074);function K(){var b,_=(0,C.UO)(),t=(0,C.s0)(),W=(0,v.sc)({fetchPolicy:"cache-and-network"}),M=p()(W,2),O=M[0],x=M[1],E=x.data,F=x.loading,N=(0,v.Yh)({}),w=p()(N,2),L=w[0],S=w[1].loading,$=(0,v.M0)({}),A=p()($,2),B=A[0],z=A[1].loading,n=_.id==="new",o=a.Form.useForm(),V=(0,y.useCallback)(D()(d()().mark(function c(){var l;return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.validateFields();case 2:if(l=s.sent,!n){s.next=8;break}return s.next=6,L({variables:{input:m()({},l)}});case 6:s.next=10;break;case 8:return s.next=10,B({variables:{id:_.id,input:m()({},l)}});case 10:a.Toast.success("\u6D77\u62A5 \u201C".concat(l.name,"\u201D ").concat(n?"\u65B0\u589E":"\u4FEE\u6539","\u6210\u529F"),2e3,{placement:"bottom-left",progressBar:!0}),!history.length||n?t("/website/landing/posters",{replace:!0}):t(-1);case 12:case"end":return s.stop()}},c)})),[L,_.id,o,t,n,B]);return(0,y.useEffect)(function(){if(_.id!=="new"){var c=new AbortController;return O({variables:{id:_.id},context:{fetchOptions:{signal:c.signal}}}).then(function(){var l=D()(d()().mark(function P(s){var f,j,h,i;return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(h=s.data,i=h==null?void 0:h.poster,i){u.next=7;break}return u.next=5,a.Modal.error({content:"\u6D77\u62A5\u4E0D\u5B58\u5728,\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5220\u9664\u4E86",timer:3e3,timerProgressBar:!0});case 5:return history.length?t(-1):t("/website/landing/posters",{replace:!0}),u.abrupt("return");case 7:o.setFieldsValue(m()(m()({},i),{},{music:(f=i.music)===null||f===void 0?void 0:f.id,background:(j=i.background)===null||j===void 0?void 0:j.id}));case 8:case"end":return u.stop()}},P)}));return function(P){return l.apply(this,arguments)}}()),function(){c.abort()}}},[o,O,history,_.id]),(0,e.jsx)(k.vs,{header:n?{title:"\u65B0\u589E\u6D77\u62A5"}:void 0,footer:!1,children:(0,e.jsxs)(a.Card,{className:"mb-5 mb-xl-10",children:[(0,e.jsx)(a.Card.Header,{children:(0,e.jsx)(a.Card.Title,{children:n?"\u65B0\u589E\u6D77\u62A5":E==null||(b=E.poster)===null||b===void 0?void 0:b.name})}),(0,e.jsxs)(a.Card.Body,{children:[(0,e.jsx)(a.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:F,children:(0,e.jsxs)(a.Form,{form:o,className:"w-800px row d-flex flex-shrink-0 flex-column-reverse flex-md-row",children:[(0,e.jsxs)("div",{className:"col-12 col-md-8",children:[(0,e.jsx)(a.Form.Item,{className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(a.Input,{solid:!0,className:"w-400px"})}),(0,e.jsx)(a.Form.Item,{className:"my-5",name:"music",label:"\u80CC\u666F\u97F3\u4E50",children:(0,e.jsx)(a.Upload,{solid:!0,accept:".aif, .cda, .mid, .mp3, .mpa, .ogg, .wav, .wma, .wpl",space:"orX8kLOV",className:"w-400px"})}),(0,e.jsx)(a.Form.Item,{className:"my-5",name:"description",label:"\u63CF\u8FF0",help:"\u8BF7\u7528\u5C11\u4E8E250\u5B57\u7B26\u63CF\u8FF0",children:(0,e.jsx)(a.Input.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:8},showCount:!0,maxLength:250,className:"w-400px"})})]}),(0,e.jsx)("div",{className:"col-12 col-md-4",children:(0,e.jsx)(a.Form.Item,{className:"mb-5",name:"background",label:"\u6D77\u62A5\u56FE\u7247",children:(0,e.jsx)(a.Upload.Image,{width:375,height:812,space:"orX8kLOV",crop:!1})})})]})}),(0,e.jsx)(a.Button,{loading:F||S||z,onClick:V,children:n?(0,e.jsx)(e.Fragment,{children:"\u6DFB\u52A0\u6D77\u62A5"}):(0,e.jsx)(e.Fragment,{children:"\u4FEE\u6539\u6D77\u62A5\u4FE1\u606F"})})]})]})})}g.default=K}}]);
