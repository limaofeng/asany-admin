"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5105],{14336:function(X,N,r){var w=r(15009),P=r.n(w),f=r(99289),j=r.n(f),U=r(97857),_=r.n(U),x=r(5574),F=r.n(x),a=r(67294),c=r(2721),m=r(12708);function s(u,n){return u.replace(/{(\w+)}/g,function(l,o){return n[o]!==void 0?n[o]:l})}function i(u,n){var l=u(_()({fetchPolicy:"network-only"},(n==null?void 0:n.mutation)||{})),o=F()(l,1),A=o[0],t=(0,a.useRef)(!1),R=(0,a.useRef)(null),S=(0,a.useCallback)(function(){var k=j()(P()().mark(function W(C,T){var D,K,b,Z,g,M,B,$,z;return P()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return D=(T==null?void 0:T.dialog)||(n==null?void 0:n.dialog)||{},K=(T==null?void 0:T.mutation)||(n==null?void 0:n.mutation)||{},b=(T==null?void 0:T.onDeleted)||(n==null?void 0:n.onDeleted),Z=D.width,g=D.title,M=D.content,B=!1,Array.isArray(C)?(B=!0,typeof g=="function"&&(g=g(C,{batch:!0})),typeof M=="function"&&(M=M(C,{batch:!0}))):C&&(typeof g=="string"&&(g=s(g,C)),typeof M=="string"&&(M=s(M,C)),typeof g=="function"&&(g=g(C,{batch:!1})),typeof M=="function"&&(M=M(C,{batch:!1}))),$=function(){var L=j()(P()().mark(function V(){return P()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,A(_()(_()({fetchPolicy:"network-only"},K),{},{variables:{where:{id_in:B?C:[C==null?void 0:C.id]}}}));case 2:case"end":return O.stop()}},V)}));return function(){return L.apply(this,arguments)}}(),v.next=10,c.Modal.confirm(_()(_()({},D),{},{title:g,content:M,width:Z,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!t.current},preConfirm:function(){var L=j()(P()().mark(function H(){var O,J,Q;return P()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return t.current=!0,R.current=null,p.prev=2,O=document.querySelector(".swal2-confirm"),O.textContent="\u5220\u9664\u4E2D...",J=document.createElement("span"),J.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),O.appendChild(J),p.next=10,(0,m.gw)($(),350);case 10:Q=p.sent,b&&b(C,Q),p.next=17;break;case 14:p.prev=14,p.t0=p.catch(2),R.current=p.t0;case 17:return p.prev=17,t.current=!1,p.finish(17);case 20:case"end":return p.stop()}},H,null,[[2,14,17,20]])}));function V(){return L.apply(this,arguments)}return V}()}));case 10:if(z=v.sent,!R.current){v.next=14;break}return c.Toast.error("\u5220\u9664\u5931\u8D25:"+R.current.message,2e3,{placement:"top-center",progressBar:!0}),v.abrupt("return",!1);case 14:if(z.isConfirmed){v.next=16;break}return v.abrupt("return",!1);case 16:return c.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),v.abrupt("return",!0);case 18:case"end":return v.stop()}},W)}));return function(W,C){return k.apply(this,arguments)}}(),[]),Y=(0,a.useCallback)(function(k,W){return S(k,W)},[n,A]),e=(0,a.useCallback)(function(k,W){return S(k,W)},[]);return{delete:Y,deleteMany:e}}N.Z=i},58301:function(X,N,r){r.d(N,{Oh:function(){return x},bp:function(){return F}});var w=r(97857),P=r.n(w),f=r(67294);function j(a,c){var m,s,i=a(P()({fetchPolicy:"network-only"},c)),u=i.data,n=i.loading,l=i.previousData,o=i.refetch,A=i.error,t=(0,f.useMemo)(function(){return n?l==null?void 0:l.result.pageInfo:u==null?void 0:u.result.pageInfo},[u==null||(m=u.result)===null||m===void 0?void 0:m.pageInfo.total,n,l==null||(s=l.result)===null||s===void 0?void 0:s.pageInfo.total]),R=(0,f.useMemo)(function(){return u!=null&&u.result?u.result.edges.map(function(S){return S.node}):n&&l!==null&&l!==void 0&&l.result?l.result.edges.map(function(S){return S.node}):[]},[n,u==null?void 0:u.result,l==null?void 0:l.result]);return[R,{loading:n,pageInfo:t,error:A,variables:{},refetch:o}]}function U(a,c){return c.split(".").reduce(function(m,s){return m&&m[s]!==void 0?m[s]:void 0},a)}function _(a,c,m){for(var s=c.split("."),i=a;s.length>1;){var u=s.shift();i[u]||(i[u]={}),i=i[u]}i[s[0]]=m}function x(a,c){var m=c.map(function(s){var i=s.source,u=s.target,n=s.transform,l=s.skip,o=U(a,i);if(o==null||l&&l(o))return"";var A=n?n(o):String(o);return"".concat(encodeURIComponent(u||i),"=").concat(encodeURIComponent(A))});return m.filter(function(s){return s}).join("&")}function F(a,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=m;return c.forEach(function(i){var u=i.source,n=i.target,l=i.transform,o=i.skip,A=a.get(u);if(!(!A||A.trim()==="")){var t=l?l(A):A;o&&o(t)||(n?_(s,n,t):s[u]=t)}}),s}N.ZP=j},70005:function(X,N,r){var w=r(67294),P=r(96974),f=r(2721),j=r(85893);function U(_){var x=_.categoryId,F=_.append,a=(0,P.bx)(),c=a.rootCategoryId,m=a.categories,s=a.baseUrl,i=a.breadcrumbs,u=(0,w.useMemo)(function(){var n,l=m.find(function(o){return o.id===x});return((l==null||(n=l.path)===null||n===void 0?void 0:n.split("/"))||[]).map(function(o){return m.find(function(A){return A.id===o})}).filter(function(o){return o})},[m,x]);return(0,j.jsxs)(f.Breadcrumb,{className:"fw-bold fs-base text-muted my-1",children:[i.map(function(n){return(0,j.jsx)(f.Breadcrumb.Item,{href:n.url,children:n.title},n.title)}),u?(0,j.jsx)(j.Fragment,{children:u.filter(function(n){return n.id!==c}).map(function(n){return(0,j.jsx)(f.Breadcrumb.Item,{href:"".concat(s,"/categories/").concat(n.id,"/articles"),children:n.name},n.id)})}):(0,j.jsx)(f.Breadcrumb.Item,{children:"\u52A0\u8F7D\u4E2D..."}),F]})}N.Z=U},80537:function(X,N,r){var w=r(14336),P=r(96944),f=r(85893);function j(U){var _=(0,w.Z)(P.nT,{onDeleted:function(){U&&U()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(c,m){var s;if(m.batch){var i=c;s="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(i.length," \u7BC7\u6587\u7AE0\u5417\uFF1F")}else s=(0,f.jsxs)(f.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,f.jsx)("strong",{children:c.title})]});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("p",{className:"tip-confirm",children:s}),(0,f.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),x=_.delete,F=_.deleteMany;return{delete:x,deleteMany:F}}N.Z=j},85105:function(X,N,r){r.r(N),r.d(N,{default:function(){return T}});var w=r(15009),P=r.n(w),f=r(99289),j=r.n(f),U=r(5574),_=r.n(U),x=r(67294),F=r(96974),a=r(39711),c=r(46027),m=r(93967),s=r.n(m),i=r(19755),u=r.n(i),n=r(30381),l=r.n(n),o=r(58301),A=r(73588),t=r(2721),R=r(70005),S=r(42646),Y=r(80537),e=r(85893),k={DRAFT:{title:"\u8349\u7A3F",lightStyle:"danger"},PUBLISHED:{title:"\u5DF2\u53D1\u5E03"},SCHEDULED:{title:"\u8BA1\u5212",lightStyle:"primary"}};window._MoreshowOrhide=function(D){return u()(D).parent().siblings().show(),u()(D).parent().remove(),!1};function W(D){var K=D.data,b=D.refetch,Z=D.baseUrl,g=(0,x.useState)(!1),M=_()(g,2),B=M[0],$=M[1],z=(0,F.s0)(),q=(0,Y.Z)(function(){return b()}),v=q.delete,L=(0,x.useCallback)(function(V){var H=V.key;H==="edit"?z("".concat(Z,"/articles/").concat(K.id)):H==="delete"&&($(!1),v(K))},[v,K]);return(0,e.jsx)(t.Dropdown,{overlay:(0,e.jsxs)(t.Menu,{onClick:L,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(t.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(t.Menu.Item,{className:"px-3",children:"\u53D1\u5E03"},"publish"),(0,e.jsx)(t.Menu.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:$,visible:B,children:(0,e.jsxs)(t.Button,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(c.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function C(){var D,K=(0,F.UO)(),b=K.cid,Z=(0,F.bx)(),g=Z.rootCategoryId,M=Z.categories,B=Z.baseUrl,$=(0,F.s0)(),z=(0,a.lr)(),q=_()(z,1),v=q[0],L=(0,x.useMemo)(function(){return(0,o.bp)(v,[{source:"q",target:"keywords"}])},[v.get("q")]);(0,x.useState)({keywords:v.get("q")||""});var V=(0,x.useMemo)(function(){var y=(0,o.bp)(v,[{source:"q",target:"where.name_contains"},{source:"sex",target:"where.sex"},{source:"page",transform:function(d){return parseInt(d)}},{source:"per_page",transform:function(d){return parseInt(d)}},{source:"sort",target:"orderBy",transform:function(d){var G=d.split(":"),E=_()(G,2),I=E[0],ee=E[1];return"".concat(I,"_").concat(ee)}}]);return y.where=y.where||{},y.where.category={id:b||g,subColumns:!0},y},[v.toString(),b,g]),H=(0,o.ZP)(S.gk,{variables:V,fetchPolicy:"network-only",skip:!g}),O=_()(H,2),J=O[0],Q=O[1],re=Q.loading,p=Q.pageInfo,ne=Q.refetch,ae=(0,x.useCallback)(function(y,h,d){var G=(0,o.Oh)({searchForm:L,pagination:y,filters:h,sorter:d},[{source:"searchForm.keywords",target:"q",skip:function(I){return!I}},{source:"pagination.current",target:"page",skip:function(I){return I===1}},{source:"pagination.pageSize",target:"per_page",skip:function(I){return I===15}},{source:"sorter.field",target:"sort",transform:function(I){return"".concat(I,":").concat(d.order==="ascend"?"asc":"desc")}}]);$(location.pathname+"?"+G,{replace:!0})},[L]),se=(0,Y.Z)(function(){return ne()}),te=se.deleteMany,ue=(0,x.useCallback)(function(y,h){return j()(P()().mark(function d(){return P()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,te(y,{dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:h.length>1?'\u60A8\u5373\u5C06\u5220\u9664\u4EE5\u4E0B\u6587\u7AE0:<ul className="py-2">'.concat(h.map(function(I,ee){return"<li ".concat(ee>=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 mb-1 fs-6"><span className="bullet bullet-dot me-2"></span><strong>').concat(I.title,"</strong></li>")}).join(""),`
                <li `).concat(h.length<=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 fs-6"><a href="javascript:void(0)" onClick="_MoreshowOrhide(this)">\u66F4\u591A</a></li></ul> '):(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:h[0].title}),"\u201D\u3002",(0,e.jsx)("br",{}),"\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})}});case 2:case"end":return E.stop()}},d)}))},[te]),le=(0,x.useCallback)(function(y){$(location.pathname+(y?"?q="+y:""),{replace:!0})},[]);return(0,e.jsx)(A.vs,{loading:re,header:{title:(D=M.find(function(y){return y.id===b}))===null||D===void 0?void 0:D.name},breadcrumb:(0,e.jsx)(R.Z,{categoryId:b}),children:(0,e.jsx)("div",{className:"tab-content",children:(0,e.jsxs)(t.Card,{flush:!0,headerClassName:"mt-5",children:[(0,e.jsxs)(t.Card.Header,{className:"pt-8",children:[(0,e.jsx)(t.Card.Title,{className:"flex-column",children:(0,e.jsx)(t.Input.Search,{solid:!0,className:"w-250px",placeholder:"\u641C\u7D22\u6587\u7AE0",onSearch:le})}),(0,e.jsx)(t.Card.Toolbar,{children:(0,e.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,e.jsx)(t.Dropdown,{overlay:(0,e.jsxs)(t.Menu,{className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(t.Menu.Item,{className:"px-3",children:"\u6700\u65B0"},"edit"),(0,e.jsx)(t.Menu.Item,{className:"px-3",children:"\u6700\u665A"},"publish"),(0,e.jsx)(t.Menu.Item,{className:"px-3 actions-delete",children:"\u6700\u8FD1\u66F4\u65B0\u7684"},"delete"),(0,e.jsx)(t.Menu.Item,{className:"px-3 actions-delete",children:"\u70B9\u51FB\u91CF"},"delete")]}),placement:"bottomLeft",children:(0,e.jsx)(t.Button,{variant:"white",className:"me-3",icon:(0,e.jsx)(c.ZP,{className:"svg-icon-2",name:"Duotune/gen031"}),children:"\u6392\u5E8F: \u6700\u65B0"})}),(0,e.jsx)(t.Button,{as:a.rU,variant:"primary",className:"me-3",icon:(0,e.jsx)(c.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),to:"".concat(B,"/categories/").concat(b,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]}),(0,e.jsx)(t.Card.Body,{className:"pt-0",children:p!=null&&p.total?(0,e.jsx)(t.Table,{rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(h){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:h}),"\u7BC7\u6587\u7AE0"]})},toolbar:function(h,d){return(0,e.jsx)("div",{children:(0,e.jsx)(t.Button,{color:"danger",onClick:ue(h,d),variant:!1,size:"sm",className:"px-4 py-2",children:"\u6279\u91CF\u5220\u9664"})})}},pagination:p,dataSource:J,onChange:ae,rowHeight:136,columns:[{title:"\u6807\u9898",dataIndex:"title",key:"title",render:function(h,d){var G;return(0,e.jsxs)("div",{className:"d-flex flex-row tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"d-flex flex-column align-items-start tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"meta-container no-selecto-drag",children:[(0,e.jsx)(a.rU,{to:"/xx/12",className:"user-message",children:"\u6797\u66AE\u6625"}),(0,e.jsx)("span",{className:"created-at",children:l()(d.createdAt).fromNow()}),(0,e.jsx)("div",{className:"category_list",children:d.categories.filter(function(E){return E.id!==g}).map(function(E){return(0,e.jsx)(a.rU,{to:"".concat(B,"/categories/").concat(E.id,"/articles"),className:"tag",children:E.name},E.id)})})]}),(0,e.jsx)(a.rU,{onClick:function(I){return I.stopPropagation()},to:"".concat(B,"/categories/").concat(b,"/articles/").concat(d.id),className:"mt-2 mb-2 text-gray-800 no-selecto-drag fs-4 text-hover-primary mb-1",children:h}),(0,e.jsx)("div",{className:s()("summary mb-2 w-100 tw-text-ellipsis tw-truncate w-100",{"pe-8":!d.image}),children:(0,e.jsx)("span",{className:"text-muted fs-base no-selecto-drag",children:d.summary||"\u6CA1\u6709\u4EFB\u4F55\u5185\u5BB9..."})}),(0,e.jsxs)("div",{className:"fs-base",children:[(0,e.jsxs)(a.rU,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(B,"/categories/").concat(b,"/articles/").concat(d.id),children:[(0,e.jsx)(c.ZP,{className:"svg-icon-4 me-2",name:"Bootstrap/eye"}),"41W"]}),(0,e.jsxs)(a.rU,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(B,"/categories/").concat(b,"/articles/").concat(d.id,"#comments"),children:[(0,e.jsx)(c.ZP,{className:"svg-icon-6 me-2",name:"Bootstrap/chat"}),"41W"]})]})]}),d.image&&(0,e.jsx)("div",{className:"px-8 d-flex align-items-end",children:(0,e.jsx)(t.Symbol,{className:"article-image",src:APP_CONFIG.STORAGE_URL+"/preview/".concat((G=d.image)===null||G===void 0?void 0:G.id)})})]})}},{title:"\u72B6\u6001",dataIndex:"status",width:120,render:function(h){return(0,e.jsx)(t.Badge,{light:!0,color:k[h].lightStyle,children:k[h].title})}},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(h,d){return(0,e.jsx)(W,{baseUrl:"".concat(B,"/categories/").concat(b),data:d,refetch:ne})}}]}):(0,e.jsxs)(t.Empty,{title:"\u65B0\u589E\u6587\u7AE0",description:"\u8BE5\u680F\u76EE\u8FD8\u662F\u7A7A\u7684\uFF0C\u6CA1\u6709\u4EFB\u4F55\u6587\u7AE0",image:"/assets/media/illustrations/sigma-1/4.png",children:[(0,e.jsx)(t.Button,{as:a.rU,className:"me-2",variant:"light",to:"".concat(B,"/settings"),children:"\u67E5\u770B\u680F\u76EE\u4FE1\u606F"}),(0,e.jsx)(t.Button,{as:a.rU,variant:"primary",to:"".concat(B,"/categories/").concat(b,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]})})})}var T=C}}]);
