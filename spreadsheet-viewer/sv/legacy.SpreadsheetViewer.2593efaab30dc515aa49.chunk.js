/*!
 * Spreadsheet Viewer
 * 
 * Version: 1.0.1
 * Code version: 06577ad
 * Build date: Thu, October 21, 2021, 12:29 PM GMT+2
 */(window.webpackJsonp=window.webpackJsonp||[]).push([[2],Array(159).concat([function(ot,S,i){"use strict";i.r(S),i.d(S,"duckSchema",function(){return ie}),i.d(S,"inherit",function(){return X}),i.d(S,"extend",function(){return F}),i.d(S,"deepExtend",function(){return ee}),i.d(S,"deepClone",function(){return ce}),i.d(S,"clone",function(){return G}),i.d(S,"mixin",function(){return B}),i.d(S,"isObjectEqual",function(){return V}),i.d(S,"isObject",function(){return P}),i.d(S,"defineGetter",function(){return x}),i.d(S,"objectEach",function(){return $}),i.d(S,"getProperty",function(){return fe}),i.d(S,"setProperty",function(){return H}),i.d(S,"deepObjectSize",function(){return se}),i.d(S,"createObjectPropListener",function(){return I}),i.d(S,"hasOwnProperty",function(){return de});var M=i(160);function C(l,K,ne){return K in l?Object.defineProperty(l,K,{value:ne,enumerable:!0,configurable:!0,writable:!0}):l[K]=ne,l}function pe(l){return(pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K})(l)}function ie(l){var K;return Array.isArray(l)?K=[]:(K={},$(l,function(ne,le){le!=="__children"&&(ne&&pe(ne)==="object"&&!Array.isArray(ne)?K[le]=ie(ne):Array.isArray(ne)?ne.length&&pe(ne[0])==="object"&&!Array.isArray(ne[0])?K[le]=[ie(ne[0])]:K[le]=[]:K[le]=null)})),K}function X(l,K){return K.prototype.constructor=K,l.prototype=new K,l.prototype.constructor=l,l}function F(l,K,ne){var le=Array.isArray(ne);return $(K,function(Re,De){(le===!1||ne.includes(De))&&(l[De]=Re)}),l}function ee(l,K){$(K,function(ne,le){K[le]&&pe(K[le])==="object"?(l[le]||(Array.isArray(K[le])?l[le]=[]:Object.prototype.toString.call(K[le])==="[object Date]"?l[le]=K[le]:l[le]={}),ee(l[le],K[le])):l[le]=K[le]})}function ce(l){return pe(l)==="object"?JSON.parse(JSON.stringify(l)):l}function G(l){var K={};return $(l,function(ne,le){K[le]=ne}),K}function B(l){l.MIXINS||(l.MIXINS=[]);for(var K=arguments.length,ne=new Array(K>1?K-1:0),le=1;le<K;le++)ne[le-1]=arguments[le];return Object(M.arrayEach)(ne,function(Re){l.MIXINS.push(Re.MIXIN_NAME),$(Re,function(De,He){if(l.prototype[He]!==void 0)throw new Error("Mixin conflict. Property '".concat(He,"' already exist and cannot be overwritten."));typeof De=="function"?l.prototype[He]=De:Object.defineProperty(l.prototype,He,{get:(me=He,Se=De,Ie="_".concat(me),function(){var Le;return this[Ie]===void 0&&(this[Ie]=(Le=Se,(Array.isArray(Le)||P(Le))&&(Le=ce(Le)),Le)),this[Ie]}),set:function(Le){var we="_".concat(Le);return function(Ve){this[we]=Ve}}(He),configurable:!0});var me,Se,Ie})}),l}function V(l,K){return JSON.stringify(l)===JSON.stringify(K)}function P(l){return Object.prototype.toString.call(l)==="[object Object]"}function x(l,K,ne,le){le.value=ne,le.writable=le.writable!==!1,le.enumerable=le.enumerable!==!1,le.configurable=le.configurable!==!1,Object.defineProperty(l,K,le)}function $(l,K){for(var ne in l)if((!l.hasOwnProperty||l.hasOwnProperty&&Object.prototype.hasOwnProperty.call(l,ne))&&K(l[ne],ne,l)===!1)break;return l}function fe(l,K){var ne=K.split("."),le=l;return $(ne,function(Re){if((le=le[Re])===void 0)return le=void 0,!1}),le}function H(l,K,ne){var le=K.split("."),Re=l;le.forEach(function(De,He){He!==le.length-1?(de(Re,De)||(Re[De]={}),Re=Re[De]):Re[De]=ne})}function se(l){return P(l)?function K(ne){var le=0;return P(ne)?$(ne,function(Re,De){De!=="__children"&&(le+=K(Re))}):le+=1,le}(l):0}function I(l){var K,ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",le="_".concat(ne),Re=(C(K={_touched:!1},le,l),C(K,"isTouched",function(){return this._touched}),K);return Object.defineProperty(Re,ne,{get:function(){return this[le]},set:function(De){this._touched=!0,this[le]=De},enumerable:!0,configurable:!0}),Re}function de(l,K){return Object.prototype.hasOwnProperty.call(l,K)}},function(ot,S,i){"use strict";function M(I){for(var de=I.length,l=0;l<de;)I[l]=[I[l]],l+=1}function C(I,de){for(var l=de.length,K=0;K<l;)I.push(de[K]),K+=1}function pe(I){var de=[];if(!I||I.length===0||!I[0]||I[0].length===0)return de;for(var l=I.length,K=I[0].length,ne=0;ne<l;ne++)for(var le=0;le<K;le++)de[le]||(de[le]=[]),de[le][ne]=I[ne][le];return de}function ie(I,de,l,K){var ne=-1,le=I,Re=l;Array.isArray(I)||(le=Array.from(I));var De=le.length;for(K&&De&&(Re=le[ne+=1]),ne+=1;ne<De;)Re=de(Re,le[ne],ne,le),ne+=1;return Re}function X(I,de){var l=0,K=I;Array.isArray(I)||(K=Array.from(I));for(var ne=K.length,le=[],Re=-1;l<ne;){var De=K[l];de(De,l,K)&&(le[Re+=1]=De),l+=1}return le}function F(I,de){var l=0,K=I;Array.isArray(I)||(K=Array.from(I));for(var ne=K.length,le=[],Re=-1;l<ne;){var De=K[l];le[Re+=1]=de(De,l,K),l+=1}return le}function ee(I,de){var l=0,K=I;Array.isArray(I)||(K=Array.from(I));for(var ne=K.length;l<ne&&de(K[l],l,K)!==!1;)l+=1;return I}function ce(I){return ie(I,function(de,l){return de+l},0)}function G(I){return ie(I,function(de,l){return de>l?de:l},Array.isArray(I)?I[0]:void 0)}function B(I){return ie(I,function(de,l){return de<l?de:l},Array.isArray(I)?I[0]:void 0)}function V(I){return I.length?ce(I)/I.length:0}function P(I){return ie(I,function(de,l){return de.concat(Array.isArray(l)?P(l):l)},[])}function x(I){var de=[];return ee(I,function(l){de.indexOf(l)===-1&&de.push(l)}),de}function $(){for(var I=arguments.length,de=new Array(I),l=0;l<I;l++)de[l]=arguments[l];var K=[].concat(de),ne=K[0],le=K.slice(1),Re=ne;return ee(le,function(De){Re=Re.filter(function(He){return!De.includes(He)})}),Re}function fe(){for(var I=arguments.length,de=new Array(I),l=0;l<I;l++)de[l]=arguments[l];var K=[].concat(de),ne=K[0],le=K.slice(1),Re=ne;return ee(le,function(De){Re=Re.filter(function(He){return De.includes(He)})}),Re}function H(){for(var I=arguments.length,de=new Array(I),l=0;l<I;l++)de[l]=arguments[l];var K=[].concat(de),ne=K[0],le=K.slice(1),Re=new Set(ne);return ee(le,function(De){ee(De,function(He){Re.has(He)||Re.add(He)})}),Array.from(Re)}function se(I){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return I.split(de)}i.r(S),i.d(S,"to2dArray",function(){return M}),i.d(S,"extendArray",function(){return C}),i.d(S,"pivot",function(){return pe}),i.d(S,"arrayReduce",function(){return ie}),i.d(S,"arrayFilter",function(){return X}),i.d(S,"arrayMap",function(){return F}),i.d(S,"arrayEach",function(){return ee}),i.d(S,"arraySum",function(){return ce}),i.d(S,"arrayMax",function(){return G}),i.d(S,"arrayMin",function(){return B}),i.d(S,"arrayAvg",function(){return V}),i.d(S,"arrayFlatten",function(){return P}),i.d(S,"arrayUnique",function(){return x}),i.d(S,"getDifferenceOfArrays",function(){return $}),i.d(S,"getIntersectionOfArrays",function(){return fe}),i.d(S,"getUnionOfArrays",function(){return H}),i.d(S,"stringToArray",function(){return se})},function(ot,S,i){"use strict";i.r(S),i.d(S,"getParent",function(){return P}),i.d(S,"getFrameElement",function(){return x}),i.d(S,"getParentWindow",function(){return $}),i.d(S,"hasAccessToParentWindow",function(){return fe}),i.d(S,"closest",function(){return H}),i.d(S,"closestDown",function(){return se}),i.d(S,"isChildOf",function(){return I}),i.d(S,"index",function(){return de}),i.d(S,"overlayContainsElement",function(){return l}),i.d(S,"hasClass",function(){return Re}),i.d(S,"addClass",function(){return De}),i.d(S,"removeClass",function(){return He}),i.d(S,"removeTextNodes",function(){return me}),i.d(S,"empty",function(){return Se}),i.d(S,"HTML_CHARACTERS",function(){return Ie}),i.d(S,"fastInnerHTML",function(){return Le}),i.d(S,"fastInnerText",function(){return we}),i.d(S,"isVisible",function(){return Ve}),i.d(S,"offset",function(){return je}),i.d(S,"getWindowScrollTop",function(){return Ke}),i.d(S,"getWindowScrollLeft",function(){return $e}),i.d(S,"getScrollTop",function(){return Ye}),i.d(S,"getScrollLeft",function(){return ht}),i.d(S,"clientWidth",function(){return Qe}),i.d(S,"clientHeight",function(){return ct}),i.d(S,"offsetWidth",function(){return We}),i.d(S,"offsetHeight",function(){return Ze}),i.d(S,"scrollWidth",function(){return at}),i.d(S,"scrollHeight",function(){return ut}),i.d(S,"getScrollableElement",function(){return be}),i.d(S,"getTrimmingContainer",function(){return Z}),i.d(S,"getStyle",function(){return he}),i.d(S,"matchesCSSRules",function(){return O}),i.d(S,"getComputedStyle",function(){return re}),i.d(S,"outerWidth",function(){return Oe}),i.d(S,"outerHeight",function(){return Ee}),i.d(S,"innerHeight",function(){return Ge}),i.d(S,"innerWidth",function(){return Je}),i.d(S,"addEvent",function(){return ft}),i.d(S,"removeEvent",function(){return tt}),i.d(S,"getCaretPosition",function(){return yt}),i.d(S,"getSelectionEndPosition",function(){return bt}),i.d(S,"getSelectionText",function(){return Ot}),i.d(S,"clearTextSelection",function(){return Jt}),i.d(S,"setCaretPosition",function(){return Gt}),i.d(S,"getScrollbarWidth",function(){return rn}),i.d(S,"hasVerticalScrollbar",function(){return an}),i.d(S,"hasHorizontalScrollbar",function(){return mn}),i.d(S,"setOverlayPosition",function(){return W}),i.d(S,"getCssTransform",function(){return R}),i.d(S,"resetCssTransform",function(){return U}),i.d(S,"isInput",function(){return s}),i.d(S,"isOutsideInput",function(){return u}),i.d(S,"selectElementIfAllowed",function(){return v}),i.d(S,"getBoundingClientRect",function(){return k}),i.d(S,"clearMemoizedFunctionsBeforeRender",function(){return q});var M,C,pe,ie=i(182),X=i(173),F=i(268),ee=i.n(F),ce=function(y){var _=ee()(y,{maxSize:1/0});return _.cache.orderByLru=function(Y,ue,Te){_.cache.keys[Te]=Y,_.cache.values[Te]=ue},_.clear=function(){_.cache.keys.length=0,_.cache.values.length=0},_},G=function(y){return y.clear=function(){},y};function B(y){return function(_){if(Array.isArray(_))return V(_)}(y)||function(_){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(_))return Array.from(_)}(y)||function(_,Y){if(!!_){if(typeof _=="string")return V(_,Y);var ue=Object.prototype.toString.call(_).slice(8,-1);if(ue==="Object"&&_.constructor&&(ue=_.constructor.name),ue==="Map"||ue==="Set")return Array.from(_);if(ue==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ue))return V(_,Y)}}(y)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function V(y,_){(_==null||_>y.length)&&(_=y.length);for(var Y=0,ue=new Array(_);Y<_;Y++)ue[Y]=y[Y];return ue}function P(y){for(var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Y=-1,ue=null,Te=y;Te!==null;){if(Y===_){ue=Te;break}Te.host&&Te.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Te=Te.host:(Y+=1,Te=Te.parentNode)}return ue}function x(y){return Object.getPrototypeOf(y.parent)&&y.frameElement}function $(y){return x(y)&&y.parent}function fe(y){return!!Object.getPrototypeOf(y.parent)}function H(y){for(var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Y=arguments.length>2?arguments[2]:void 0,ue=Node,Te=ue.ELEMENT_NODE,Fe=ue.DOCUMENT_FRAGMENT_NODE,Xe=y;Xe!=null&&Xe!==Y;){var lt=Xe,dt=lt.nodeType,Pt=lt.nodeName;if(dt===Te&&(_.includes(Pt)||_.includes(Xe)))return Xe;var rt=Xe,Xt=rt.host;Xe=Xt&&dt===Fe?Xt:Xe.parentNode}return null}function se(y,_,Y){for(var ue=[],Te=y;Te&&(Te=H(Te,_,Y))&&(!Y||Y.contains(Te));)ue.push(Te),Te=Te.host&&Te.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Te.host:Te.parentNode;var Fe=ue.length;return Fe?ue[Fe-1]:null}function I(y,_){var Y=y.parentNode,ue=[];for(typeof _=="string"?ue=y.defaultView?Array.prototype.slice.call(y.querySelectorAll(_),0):Array.prototype.slice.call(y.ownerDocument.querySelectorAll(_),0):ue.push(_);Y!==null;){if(ue.indexOf(Y)>-1)return!0;Y=Y.parentNode}return!1}function de(y){var _=0,Y=y;if(Y.previousSibling)for(;Y=Y.previousSibling;)_+=1;return _}function l(y,_,Y){var ue=Y.parentElement.querySelector(".ht_clone_".concat(y));return ue?ue.contains(_):null}function K(y){return y&&y.length?y.filter(function(_){return!!_}):[]}if(Object(ie.isClassListSupported)()){var ne=function(y){var _=y.createElement("div");return _.classList.add("test","test2"),_.classList.contains("test2")};M=function(y,_){return y.classList!==void 0&&typeof _=="string"&&_!==""&&y.classList.contains(_)},C=function(y,_){var Y,ue=y.ownerDocument,Te=_;if(typeof Te=="string"&&(Te=Te.split(" ")),(Te=K(Te)).length>0)if(ne(ue))(Y=y.classList).add.apply(Y,B(Te));else for(var Fe=0;Te&&Te[Fe];)y.classList.add(Te[Fe]),Fe+=1},pe=function(y,_){var Y,ue=_;if(typeof ue=="string"&&(ue=ue.split(" ")),(ue=K(ue)).length>0)if(ne)(Y=y.classList).remove.apply(Y,B(ue));else for(var Te=0;ue&&ue[Te];)y.classList.remove(ue[Te]),Te+=1}}else{var le=function(y){return new RegExp("(\\s|^)".concat(y,"(\\s|$)"))};M=function(y,_){return y.className!==void 0&&le(_).test(y.className)},C=function(y,_){var Y=y.className,ue=_;if(typeof ue=="string"&&(ue=ue.split(" ")),Y==="")Y=ue.join(" ");else for(var Te=0;Te<ue.length;Te++)ue[Te]&&!le(ue[Te]).test(Y)&&(Y+=" ".concat(ue[Te]));y.className=Y},pe=function(y,_){var Y=0,ue=y.className,Te=_;for(typeof Te=="string"&&(Te=Te.split(" "));Te&&Te[Y];)ue=ue.replace(le(Te[Y])," ").trim(),Y+=1;y.className!==ue&&(y.className=ue)}}function Re(y,_){return M(y,_)}function De(y,_){C(y,_)}function He(y,_){pe(y,_)}function me(y){if(y.nodeType===3)y.parentNode.removeChild(y);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(y.nodeName)>-1)for(var _=y.childNodes,Y=_.length-1;Y>=0;Y--)me(_[Y])}function Se(y){for(var _;_=y.lastChild;)y.removeChild(_)}var Ie=/(<(.*)>|&(.*);)/;function Le(y,_){Ie.test(_)?y.innerHTML=_:we(y,_)}function we(y,_){var Y=y.firstChild;Y&&Y.nodeType===3&&Y.nextSibling===null?ie.isTextContentSupported?Y.textContent=_:Y.data=_:(Se(y),y.appendChild(y.ownerDocument.createTextNode(_)))}function Ve(y){for(var _=y.ownerDocument.documentElement,Y=y;Y!==_;){if(Y===null)return!1;if(Y.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(Y.host){if(Y.host.impl)return Ve(Y.host.impl);if(Y.host)return Ve(Y.host);throw new Error("Lost in Web Components world")}return!1}if(Y.style&&Y.style.display==="none")return!1;Y=Y.parentNode}return!0}function je(y){var _,Y,ue,Te,Fe=y.ownerDocument,Xe=Fe.defaultView,lt=Fe.documentElement,dt=y;if(Object(ie.hasCaptionProblem)()&&dt.firstChild&&dt.firstChild.nodeName==="CAPTION")return{top:(Te=k(dt)).top+(Xe.pageYOffset||lt.scrollTop)-(lt.clientTop||0),left:Te.left+(Xe.pageXOffset||lt.scrollLeft)-(lt.clientLeft||0)};for(_=dt.offsetLeft,Y=dt.offsetTop,ue=dt;(dt=dt.offsetParent)&&dt!==Fe.body;)_+=dt.offsetLeft,Y+=dt.offsetTop,ue=dt;return ue&&ue.style.position==="fixed"&&(_+=Xe.pageXOffset||lt.scrollLeft,Y+=Xe.pageYOffset||lt.scrollTop),{left:_,top:Y}}function Ke(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,_=y.scrollY;return _===void 0&&(_=y.document.documentElement.scrollTop),_}function $e(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,_=y.scrollX;return _===void 0&&(_=y.document.documentElement.scrollLeft),_}var Ye=ce(function(y){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return y===_?Ke(_):y.scrollTop});function ht(y){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return y===_?$e(_):y.scrollLeft}var Qe=ce(function(y){return y.clientWidth}),ct=G(function(y){return y.clientHeight}),We=G(function(y){return y.offsetWidth}),Ze=G(function(y){return y.offsetHeight}),at=G(function(y){return y.scrollWidth}),ut=G(function(y){return y.scrollHeight});function be(y){var _=y.ownerDocument,Y=_?_.defaultView:void 0;_||(Y=(_=y.document?y.document:y).defaultView);for(var ue=["auto","scroll"],Te=Object(ie.isGetComputedStyleSupported)(),Fe=y.parentNode;Fe&&Fe.style&&_.body!==Fe;){var Xe=Fe.style,lt=Xe.overflow,dt=Xe.overflowX,Pt=Xe.overflowY;if([lt,dt,Pt].includes("scroll"))return Fe;if(Te){var rt=re(Fe,Y);if(lt=rt.overflow,dt=rt.overflowX,Pt=rt.overflowY,ue.includes(lt)||ue.includes(dt)||ue.includes(Pt))return Fe}if(ct(Fe)<=ut(Fe)+1&&(ue.includes(Pt)||ue.includes(lt))||Qe(Fe)<=at(Fe)+1&&(ue.includes(dt)||ue.includes(lt)))return Fe;Fe=Fe.parentNode}return Y}function Z(y){for(var _=y.ownerDocument,Y=_.defaultView,ue=y.parentNode;ue&&ue.style&&_.body!==ue;){if(ue.style.overflow!=="visible"&&ue.style.overflow!=="")return ue;var Te=re(ue,Y),Fe=["scroll","hidden","auto"],Xe=Te.getPropertyValue("overflow"),lt=Te.getPropertyValue("overflow-y"),dt=Te.getPropertyValue("overflow-x");if(Fe.includes(Xe)||Fe.includes(lt)||Fe.includes(dt))return ue;ue=ue.parentNode}return Y}function he(y,_){var Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(y){if(y===Y)return _==="width"?"".concat(Y.innerWidth,"px"):_==="height"?"".concat(Y.innerHeight,"px"):void 0;var ue=y.style[_];if(ue!==""&&ue!==void 0)return ue;var Te=re(y,Y);return Te[_]!==""&&Te[_]!==void 0?Te[_]:void 0}}function O(y,_){var Y=_.selectorText,ue=!1;return _.type===CSSRule.STYLE_RULE&&Y&&(y.msMatchesSelector?ue=y.msMatchesSelector(Y):y.matches&&(ue=y.matches(Y))),ue}var re=G(function(y){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return y.currentStyle||_.getComputedStyle(y)});function Oe(y){return We(y)}function Ee(y){return Object(ie.hasCaptionProblem)()&&y.firstChild&&y.firstChild.nodeName==="CAPTION"?Ze(y)+Ze(y.firstChild):Ze(y)}var ve,Ge=ce(function(y){return ct(y)||y.innerHeight}),Je=ce(function(y){return Qe(y)||y.innerWidth});function ft(y,_,Y){y.addEventListener(_,Y,!1)}function tt(y,_,Y){y.removeEventListener(_,Y,!1)}function yt(y){var _=y.ownerDocument;if(y.selectionStart)return y.selectionStart;if(_.selection){y.focus();var Y=_.selection.createRange();if(Y===null)return 0;var ue=y.createTextRange(),Te=ue.duplicate();return ue.moveToBookmark(Y.getBookmark()),Te.setEndPoint("EndToStart",ue),Te.text.length}return 0}function bt(y){var _=y.ownerDocument;if(y.selectionEnd)return y.selectionEnd;if(_.selection){var Y=_.selection.createRange();return Y===null?0:y.createTextRange().text.indexOf(Y.text)+Y.text.length}return 0}function Ot(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,_=y.document,Y="";return y.getSelection?Y=y.getSelection().toString():_.selection&&_.selection.type!=="Control"&&(Y=_.selection.createRange().text),Y}function Jt(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,_=y.document;y.getSelection?y.getSelection().empty?y.getSelection().empty():y.getSelection().removeAllRanges&&y.getSelection().removeAllRanges():_.selection&&_.selection.empty()}function Gt(y,_,Y){if(Y===void 0&&(Y=_),y.setSelectionRange){y.focus();try{y.setSelectionRange(_,Y)}catch(Fe){var ue=y.parentNode,Te=ue.style.display;ue.style.display="block",y.setSelectionRange(_,Y),ue.style.display=Te}}}function Qt(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,_=y.createElement("div");_.style.height="200px",_.style.width="100%";var Y=y.createElement("div");Y.style.boxSizing="content-box",Y.style.height="150px",Y.style.left="0px",Y.style.overflow="hidden",Y.style.position="absolute",Y.style.top="0px",Y.style.width="200px",Y.style.visibility="hidden",Y.appendChild(_),(y.body||y.documentElement).appendChild(Y);var ue=We(_);Y.style.overflow="scroll";var Te=We(_);return ue===Te&&(Te=Qe(Y)),(y.body||y.documentElement).removeChild(Y),ue-Te}function rn(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return ve===void 0&&(ve=Qt(y)),ve}function an(y){return We(y)!==Qe(y)}function mn(y){return Ze(y)!==ct(y)}function W(y,_,Y){Object(X.isIE9)()?(y.style.top=Y,y.style.left=_):Object(X.isSafari)()?(y.style["-webkit-transform"]="translate3d(".concat(_,",").concat(Y,",0)"),y.style["-webkit-transform"]="translate3d(".concat(_,",").concat(Y,",0)")):y.style.transform="translate3d(".concat(_,",").concat(Y,",0)")}function R(y){var _;return y.style.transform&&(_=y.style.transform)!==""?["transform",_]:y.style["-webkit-transform"]&&(_=y.style["-webkit-transform"])!==""?["-webkit-transform",_]:-1}function U(y){y.style.transform&&y.style.transform!==""?y.style.transform="":y.style["-webkit-transform"]&&y.style["-webkit-transform"]!==""&&(y.style["-webkit-transform"]="")}function s(y){return y&&(["INPUT","SELECT","TEXTAREA"].indexOf(y.nodeName)>-1||y.contentEditable==="true")}function u(y){return s(y)&&y.hasAttribute("data-hot-input")===!1}function v(y){u(y.ownerDocument.activeElement)||y.select()}var k=G(function(y){return y.getBoundingClientRect()}),j=[Ye,k,Qe,ct,We,Ze,at,ut,re,Je,Ge],q=function(){j.forEach(function(y){return y.clear()})}},,,,function(ot,S,i){"use strict";i.d(S,"d",function(){return X}),i.d(S,"a",function(){return P}),i.d(S,"b",function(){return fe}),i.d(S,"e",function(){return vr}),i.d(S,"c",function(){return mi});function M(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function C(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function pe(a,t,n){return t&&C(a.prototype,t),n&&C(a,n),a}var ie=new WeakMap,X=function(){function a(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,e=t.totalItems,o=t.itemSizeFn,c=t.overrideFn,h=t.calculationType,d=t.stretchMode,p=t.stretchingItemWidthFn,A=p===void 0?function(Q){return Q}:p;M(this,a),ie.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:e,columnWidthFn:o,overrideFn:c,calculationType:h,stretchingColumnWidthFn:A}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=d,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return pe(a,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),pe(a,[{key:"calculate",value:function(){for(var t,n=0,r=!0,e=[],o=ie.get(this),c=o.calculationType,h=o.overrideFn,d=o.scrollOffset,p=o.totalColumns,A=o.viewportWidth,Q=0;Q<p;Q++)if(t=this._getColumnWidth(Q),n<=d&&c!==2&&(this.startColumn=Q),n>=d&&n+(c===2?t:0)<=d+(d>0?A+1:A)&&(this.startColumn!==null&&this.startColumn!==void 0||(this.startColumn=Q),this.endColumn=Q),e.push(n),n+=t,c!==2&&(this.endColumn=Q),n>=d+A){r=!1;break}if(this.endColumn===p-1&&r)for(this.startColumn=this.endColumn;this.startColumn>0;){var ye=e[this.endColumn]+t-e[this.startColumn-1];if((ye<=A||c!==2)&&(this.startColumn-=1),ye>A)break}c===1&&this.startColumn!==null&&h&&h(this),this.startPosition=e[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),p<this.endColumn&&(this.endColumn=p-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if(this.stretch!=="none"){var n=t;this.totalTargetWidth=n;for(var r=ie.get(this),e=r.totalColumns,o=0,c=0;c<e;c++){var h=this._getColumnWidth(c),d=r.stretchingColumnWidthFn(void 0,c);typeof d=="number"?n-=d:o+=h}var p=n-o;if(this.stretch==="all"&&p>0)this.stretchAllRatio=n/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var A=this._getColumnWidth(e-1),Q=p+A;this.stretchLastWidth=Q>=0?Q:A}}}},{key:"getStretchedColumnWidth",value:function(t,n){var r=null;return this.stretch==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(t,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(t)),r}},{key:"_getStretchedAllColumnWidth",value:function(t,n){var r=0,e=ie.get(this),o=e.totalColumns;if(!this.stretchAllColumnsWidth[t]){var c=Math.round(n*this.stretchAllRatio),h=e.stretchingColumnWidthFn(c,t);this.stretchAllColumnsWidth[t]=h===void 0?c:isNaN(h)?this._getColumnWidth(t):h}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var d=0;d<this.stretchAllColumnsWidth.length;d++)r+=this.stretchAllColumnsWidth[d];r!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-r)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===ie.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=ie.get(this).columnWidthFn(t);return isNaN(n)&&(n=a.DEFAULT_WIDTH),n}}]),a}();function F(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function ce(a,t,n){return t&&ee(a.prototype,t),n&&ee(a,n),a}var G=new WeakMap,B=function(){function a(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,e=t.totalItems,o=t.itemSizeFn,c=t.overrideFn,h=t.calculationType,d=t.scrollbarHeight;F(this,a),G.set(this,{viewportHeight:n,scrollOffset:r,totalRows:e,rowHeightFn:o,overrideFn:c,calculationType:h,horizontalScrollbarHeight:d}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return ce(a,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),ce(a,[{key:"calculate",value:function(){for(var t,n=0,r=!0,e=[],o=G.get(this),c=o.calculationType,h=o.overrideFn,d=o.rowHeightFn,p=o.scrollOffset,A=o.totalRows,Q=o.viewportHeight,ye=o.horizontalScrollbarHeight||0,Me=0;Me<A;Me++)if(t=d(Me),isNaN(t)&&(t=a.DEFAULT_HEIGHT),n<=p&&c!==2&&(this.startRow=Me),n>=p&&n+(c===2?t:0)<=p+Q-ye&&(this.startRow===null&&(this.startRow=Me),this.endRow=Me),e.push(n),n+=t,c!==2&&(this.endRow=Me),n>=p+Q-ye){r=!1;break}if(this.endRow===A-1&&r)for(this.startRow=this.endRow;this.startRow>0;){var Be=e[this.endRow]+t-e[this.startRow-1];if((Be<=Q-ye||c!==2)&&(this.startRow-=1),Be>=Q-ye)break}c===1&&this.startRow!==null&&h&&h(this),this.startPosition=e[this.startRow],this.startPosition===void 0&&(this.startPosition=null),A<this.endRow&&(this.endRow=A-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}]),a}();function V(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var P=function(){function a(e,o){(function(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")})(this,a),this.row=null,this.col=null,e!==void 0&&o!==void 0&&(this.row=e,this.col=o)}var t,n,r;return t=a,(n=[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&this.col>=e.col}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&this.col<=e.col}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&this.col<=e.col}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&this.col>=e.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&V(t.prototype,n),r&&V(t,r),a}();function x(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function $(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var fe=function(){function a(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;x(this,a),this.highlight=e,this.from=o,this.to=c}var t,n,r;return t=a,(n=[{key:"setHighlight",value:function(e){return this.highlight=e,this}},{key:"setFrom",value:function(e){return this.from=e,this}},{key:"setTo",value:function(e){return this.to=e,this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(e){var o=e.row,c=e.col,h=this.getTopLeftCorner(),d=this.getBottomRightCorner();return h.row<=o&&d.row>=o&&h.col<=c&&d.col>=c}},{key:"includesRange",value:function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getTopRightCorner().col>=e.getTopLeftCorner().col&&this.getTopRightCorner().col<=e.getTopRightCorner().col||this.getTopLeftCorner().col<=e.getTopRightCorner().col&&this.getTopLeftCorner().col>=e.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getBottomRightCorner().row>=e.getTopRightCorner().row&&this.getBottomRightCorner().row<=e.getBottomRightCorner().row||this.getTopRightCorner().row<=e.getBottomRightCorner().row&&this.getTopRightCorner().row>=e.getTopRightCorner().row}},{key:"expand",value:function(e){var o=this.getTopLeftCorner(),c=this.getBottomRightCorner();return(e.row<o.row||e.col<o.col||e.row>c.row||e.col>c.col)&&(this.from=new P(Math.min(o.row,e.row),Math.min(o.col,e.col)),this.to=new P(Math.max(c.row,e.row),Math.max(c.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var o=this.getTopLeftCorner(),c=this.getBottomRightCorner(),h=this.getDirection(),d=e.getTopLeftCorner(),p=e.getBottomRightCorner(),A=Math.min(o.row,d.row),Q=Math.min(o.col,d.col),ye=Math.max(c.row,p.row),Me=Math.max(c.col,p.col),Be=new P(A,Q),xe=new P(ye,Me);return this.from=Be,this.to=xe,this.setDirection(h),this.highlight.row===this.getBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var o=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=o[0],this.to=o[1];break;case"NE-SW":var c=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=c[0],this.to=c[1];break;case"SE-NW":var h=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=h[0],this.to=h[1];break;case"SW-NE":var d=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=d[0],this.to=d[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getCorners",value:function(){return[Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col),Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)]}},{key:"getTopLeftCorner",value:function(){return new P(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new P(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new P(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new P(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(e,o){return!!(o&&o.includes(e)&&(this.getTopLeftCorner().isEqual(new P(o.from.row,o.from.col))||this.getTopRightCorner().isEqual(new P(o.from.row,o.to.col))||this.getBottomLeftCorner().isEqual(new P(o.to.row,o.from.col))||this.getBottomRightCorner().isEqual(new P(o.to.row,o.to.col))))||e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,o){if(!(e instanceof P))return!1;if(o&&o.includes(e)){if(this.getTopLeftCorner().isEqual(new P(o.from.row,o.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new P(o.from.row,o.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new P(o.to.row,o.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new P(o.to.row,o.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var o=Math.min(this.from.row,this.to.row),c=Math.max(this.from.row,this.to.row),h=Math.min(this.from.col,this.to.col),d=Math.max(this.from.col,this.to.col),p=Math.min(e.from.row,e.to.row),A=Math.max(e.from.row,e.to.row),Q=Math.min(e.from.col,e.to.col),ye=Math.max(e.from.col,e.to.col),Me=[];return o===p&&Me.push("top"),d===ye&&Me.push("right"),c===A&&Me.push("bottom"),h===Q&&Me.push("left"),Me}},{key:"getInner",value:function(){for(var e=this.getTopLeftCorner(),o=this.getBottomRightCorner(),c=[],h=e.row;h<=o.row;h++)for(var d=e.col;d<=o.col;d++)this.from.row===h&&this.from.col===d||this.to.row===h&&this.to.col===d||c.push(new P(h,d));return c}},{key:"getAll",value:function(){for(var e=this.getTopLeftCorner(),o=this.getBottomRightCorner(),c=[],h=e.row;h<=o.row;h++)for(var d=e.col;d<=o.col;d++)e.row===h&&e.col===d?c.push(e):o.row===h&&o.col===d?c.push(o):c.push(new P(h,d));return c}},{key:"forAll",value:function(e){for(var o=this.getTopLeftCorner(),c=this.getBottomRightCorner(),h=o.row;h<=c.row;h++)for(var d=o.col;d<=c.col;d++)if(e(h,d)===!1)return}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}])&&$(t.prototype,n),r&&$(t,r),a}();function H(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var se=function(){function a(e,o,c){(function(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")})(this,a),this.offset=e,this.total=o,this.countTH=c}var t,n,r;return t=a,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&H(t.prototype,n),r&&H(t,r),a}();function I(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var de=function(){function a(e,o,c){(function(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")})(this,a),this.offset=e,this.total=o,this.countTH=c}var t,n,r;return t=a,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&I(t.prototype,n),r&&I(t,r),a}(),l=i(161);function K(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var ne=function(){function a(){(function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")})(this,a),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var t,n,r;return t=a,(n=[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}])&&K(t.prototype,n),r&&K(t,r),a}();function le(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Re=function(){function a(){(function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")})(this,a),this.size=new ne,this.workingSpace=0,this.sharedSize=null}var t,n,r;return t=a,(n=[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof ne}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}])&&le(t.prototype,n),r&&le(t,r),a}();function De(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var He=function(){function a(e,o,c){(function(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")})(this,a),this.rootNode=e,this.nodesPool=o,this.sizeSet=new Re,this.childNodeType=c.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var t,n,r;return t=a,(n=[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,o=this.sizeSet,c=0;if(this.isSharedViewSet())for(var h=e.firstElementChild;h;){if(h.tagName===this.childNodeType)c+=1;else if(o.isPlaceOn(1))break;h=h.nextElementSibling}else c=e.childElementCount;return c}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,o=this.sizeSet,c=this.isSharedViewSet(),h=o.getViewSize().nextSize,d=this.getRenderedChildCount();d<h;){var p=this.nodesPool();!c||c&&o.isPlaceOn(2)?e.appendChild(p):e.insertBefore(p,e.firstChild),d+=1}for(var A=c&&o.isPlaceOn(1);d>h;)e.removeChild(A?e.firstChild:e.lastChild),d-=1}},{key:"render",value:function(){var e=this.rootNode,o=this.sizeSet,c=this.visualIndex;this.isSharedViewSet()&&o.isPlaceOn(2)&&(c+=o.sharedSize.nextSize);var h=e.childNodes[c];if(h.tagName!==this.childNodeType){var d=this.nodesPool();e.replaceChild(d,h),h=d}this.collectedNodes.push(h),this.visualIndex+=1}},{key:"end",value:function(){}}])&&De(t.prototype,n),r&&De(t,r),a}();function me(a){return(me=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function Se(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Ie(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Le(a,t){return(Le=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function we(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=je(a);if(t){var e=je(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return Ve(this,n)}}function Ve(a,t){return!t||me(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function je(a){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Ke=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&Le(c,h)})(o,a);var t,n,r,e=we(o);function o(){return Se(this,o),e.apply(this,arguments)}return t=o,(n=[{key:"prependView",value:function(c){return this.sizeSet.prepend(c.sizeSet),c.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(c){return this.sizeSet.append(c.sizeSet),c.sizeSet.prepend(this.sizeSet),this}}])&&Ie(t.prototype,n),r&&Ie(t,r),o}(He);function $e(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Ye=function(){function a(e){(function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")})(this,a),this.nodeType=e.toUpperCase()}var t,n,r;return t=a,(n=[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&$e(t.prototype,n),r&&$e(t,r),a}();function ht(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Qe=function(){function a(e,o){(function(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")})(this,a),this.nodesPool=typeof e=="string"?new Ye(e):null,this.nodeType=e,this.rootNode=o,this.table=null,this.renderedNodes=0}var t,n,r;return t=a,(n=[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}])&&ht(t.prototype,n),r&&ht(t,r),a}();function ct(a){return(ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function We(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Ze(a,t){return(Ze=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function at(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=be(a);if(t){var e=be(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return ut(this,n)}}function ut(a,t){return!t||ct(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function be(a){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Z=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&Ze(c,h)})(o,a);var t,n,r,e=at(o);function o(){var c;return function(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}(this,o),(c=e.call(this,"TH")).orderViews=new WeakMap,c.sourceRowIndex=0,c}return t=o,(n=[{key:"obtainOrderView",value:function(c){var h,d=this;return this.orderViews.has(c)?h=this.orderViews.get(c):(h=new Ke(c,function(p){return d.nodesPool.obtain(d.sourceRowIndex,p)},this.nodeType),this.orderViews.set(c,h)),h}},{key:"render",value:function(){for(var c=this.table,h=c.rowsToRender,d=c.rowHeaderFunctions,p=c.rowHeadersCount,A=c.rows,Q=c.cells,ye=0;ye<h;ye++){var Me=this.table.renderedRowToSource(ye),Be=A.getRenderedNode(ye);this.sourceRowIndex=Me;var xe=this.obtainOrderView(Be),nt=Q.obtainOrderView(Be);xe.appendView(nt).setSize(p).setOffset(this.table.renderedColumnToSource(0)).start();for(var qe=0;qe<p;qe++){xe.render();var mt=xe.getCurrentNode();mt.className="",mt.removeAttribute("style"),d[qe](Me,mt,qe)}xe.end()}}}])&&We(t.prototype,n),r&&We(t,r),o}(Qe);function he(a){return(he=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function O(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function re(a,t){return(re=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function Oe(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=ve(a);if(t){var e=ve(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return Ee(this,n)}}function Ee(a,t){return!t||he(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function ve(a){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Ge=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&re(c,h)})(o,a);var t,n,r,e=Oe(o);function o(c){return function(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}(this,o),e.call(this,null,c)}return t=o,(n=[{key:"adjust",value:function(){var c=this.table,h=c.columnHeadersCount,d=c.rowHeadersCount,p=this.rootNode.firstChild,A=this.table.columnsToRender;if(h||A){for(var Q=A+d,ye=0,Me=h;ye<Me;ye++){for((p=this.rootNode.childNodes[ye])||(p=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(p)),this.renderedNodes=p.childNodes.length;this.renderedNodes<Q;)p.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>Q;)p.removeChild(p.lastChild),this.renderedNodes-=1}var Be=this.rootNode.childNodes.length;if(Be>h)for(var xe=h;xe<Be;xe++)this.rootNode.removeChild(this.rootNode.lastChild)}else p&&Object(l.empty)(p)}},{key:"render",value:function(){for(var c=this.table.columnHeadersCount,h=0;h<c;h+=1)for(var d=this.table,p=d.columnHeaderFunctions,A=d.columnsToRender,Q=d.rowHeadersCount,ye=this.rootNode.childNodes[h],Me=-1*Q;Me<A;Me+=1){var Be=this.table.renderedColumnToSource(Me),xe=ye.childNodes[Me+Q];xe.className="",xe.removeAttribute("style"),p[h](Be,xe,h),Be<0&&Object(l.addClass)(xe,"wtTableCornerCell")}}}])&&O(t.prototype,n),r&&O(t,r),o}(Qe),Je=i(183);function ft(a){return(ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function tt(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function yt(a,t){return(yt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function bt(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=Jt(a);if(t){var e=Jt(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return Ot(this,n)}}function Ot(a,t){return!t||ft(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function Jt(a){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Gt=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&yt(c,h)})(o,a);var t,n,r,e=bt(o);function o(c){return function(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}(this,o),e.call(this,null,c)}return t=o,(n=[{key:"adjust",value:function(){for(var c=this.table,h=c.columnsToRender+c.rowHeadersCount;this.renderedNodes<h;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>h;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var c=this.table,h=c.columnsToRender,d=c.rowHeadersCount,p=0;p<d;p++){var A=this.table.renderedColumnToSource(p),Q=this.table.columnUtils.getHeaderWidth(A);this.rootNode.childNodes[p].style.width="".concat(Q,"px")}for(var ye=0;ye<h;ye++){var Me=this.table.renderedColumnToSource(ye),Be=this.table.columnUtils.getStretchedColumnWidth(Me);d===0&&ye===0&&(Be+=Je.a),this.rootNode.childNodes[ye+d].style.width="".concat(Be,"px")}var xe=this.rootNode.firstChild;xe&&Object(l.addClass)(xe,"rowHeader")}}])&&tt(t.prototype,n),r&&tt(t,r),o}(Qe),Qt=i(187),rn=i(181);function an(a){return(an=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function mn(){var a=function(t,n){return n||(n=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}}))}([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number 
        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number\\x20
        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]);return mn=function(){return a},a}function W(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function R(a,t){return(R=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function U(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=u(a);if(t){var e=u(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return s(this,n)}}function s(a,t){return!t||an(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function u(a){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var v=!1,k=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&R(c,h)})(o,a);var t,n,r,e=U(o);function o(c){var h;return function(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}(this,o),(h=e.call(this,"TR",c)).orderView=new He(c,function(d){return h.nodesPool.obtain(d)},h.nodeType),h}return t=o,(n=[{key:"getRenderedNode",value:function(c){return this.orderView.getNode(c)}},{key:"render",value:function(){var c=this.table.rowsToRender;!v&&c>1e3&&(v=!0,Object(Qt.b)(Object(rn.a)(mn()))),this.orderView.setSize(c).setOffset(this.table.renderedRowToSource(0)).start();for(var h=0;h<c;h++)this.orderView.render();this.orderView.end()}}])&&W(t.prototype,n),r&&W(t,r),o}(Qe);function j(a){return(j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function q(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function y(a,t){return(y=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function _(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=ue(a);if(t){var e=ue(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(a,t){return!t||j(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function ue(a){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Te=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&y(c,h)})(o,a);var t,n,r,e=_(o);function o(){var c;return function(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}(this,o),(c=e.call(this,"TD")).orderViews=new WeakMap,c.sourceRowIndex=0,c}return t=o,(n=[{key:"obtainOrderView",value:function(c){var h,d=this;return this.orderViews.has(c)?h=this.orderViews.get(c):(h=new Ke(c,function(p){return d.nodesPool.obtain(d.sourceRowIndex,p)},this.nodeType),this.orderViews.set(c,h)),h}},{key:"render",value:function(){for(var c=this.table,h=c.rowsToRender,d=c.columnsToRender,p=c.rows,A=c.rowHeaders,Q=0;Q<h;Q++){var ye=this.table.renderedRowToSource(Q),Me=p.getRenderedNode(Q);this.sourceRowIndex=ye;var Be=this.obtainOrderView(Me),xe=A.obtainOrderView(Me);Be.prependView(xe).setSize(d).setOffset(this.table.renderedColumnToSource(0)).start();for(var nt=0;nt<d;nt++){Be.render();var qe=Be.getCurrentNode(),mt=this.table.renderedColumnToSource(nt);Object(l.hasClass)(qe,"hide")||(qe.className=""),qe.removeAttribute("style"),this.table.cellRenderer(ye,mt,qe)}Be.end()}}}])&&q(t.prototype,n),r&&q(t,r),o}(Qe);function Fe(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Xe(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var lt=function(){function a(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=o.cellRenderer;Fe(this,a),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=c}var t,n,r;return t=a,(n=[{key:"setAxisUtils",value:function(e,o){this.rowUtils=e,this.columnUtils=o}},{key:"setViewportSize",value:function(e,o){this.rowsToRender=e,this.columnsToRender=o}},{key:"setFilters",value:function(e,o){this.rowFilter=e,this.columnFilter=o}},{key:"setHeaderContentRenderers",value:function(e,o){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=o,this.columnHeadersCount=o.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=e.rowHeaders,c=e.columnHeaders,h=e.colGroup,d=e.rows,p=e.cells;o.setTable(this),c.setTable(this),h.setTable(this),d.setTable(this),p.setTable(this),this.rowHeaders=o,this.columnHeaders=c,this.colGroup=h,this.rows=d,this.cells=p}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();var e=this.rowsToRender,o=this.rows;this.columnHeadersCount===0?Object(l.addClass)(o.rootNode,"afterEmptyThead"):Object(l.removeClass)(o.rootNode,"afterEmptyThead");for(var c=0;c<e;c++){var h=o.getRenderedNode(c);if(h.firstChild){var d=this.renderedRowToSource(c),p=this.rowUtils.getHeight(d);h.firstChild.style.height=p?"".concat(p-1,"px"):""}}}}])&&Xe(t.prototype,n),r&&Xe(t,r),a}();function dt(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Pt(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var rt,Xt=function(){function a(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=e.TABLE,c=e.THEAD,h=e.COLGROUP,d=e.TBODY,p=e.rowUtils,A=e.columnUtils,Q=e.cellRenderer;dt(this,a),this.renderer=new lt(o,{cellRenderer:Q}),this.renderer.setRenderers({rowHeaders:new Z,columnHeaders:new Ge(c),colGroup:new Gt(h),rows:new k(d),cells:new Te}),this.renderer.setAxisUtils(p,A)}var t,n,r;return t=a,(n=[{key:"setFilters",value:function(e,o){return this.renderer.setFilters(e,o),this}},{key:"setViewportSize",value:function(e,o){return this.renderer.setViewportSize(e,o),this}},{key:"setHeaderContentRenderers",value:function(e,o){return this.renderer.setHeaderContentRenderers(e,o),this}},{key:"render",value:function(){this.renderer.render()}}])&&Pt(t.prototype,n),r&&Pt(t,r),a}(),en=i(170),Kt=i(176);function Cn(a,t){return function(n){if(Array.isArray(n))return n}(a)||function(n,r){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var e=[],o=!0,c=!1,h=void 0;try{for(var d,p=n[Symbol.iterator]();!(o=(d=p.next()).done)&&(e.push(d.value),!r||e.length!==r);o=!0);}catch(A){c=!0,h=A}finally{try{o||p.return==null||p.return()}finally{if(c)throw h}}return e}}(a,t)||function(n,r){if(!!n){if(typeof n=="string")return yn(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return yn(n,r)}}(a,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function yn(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}var bn=/[-]{0,1}[\d]*[.]{0,1}[\d]+/g,On=new Map;function En(a){var t=On.get(a);if(t!==void 0)return t;var n=function(r){var e=Cn(r,3),o=e[0],c=e[1],h=e[2];return .2126*o+.7152*c+.0722*h}(function(r){rt.ownerDocument.body.appendChild(rt),rt.style.color=r;var e=rt.ownerDocument.defaultView,o=Object(l.getComputedStyle)(rt,e).color.match(bn);return rt.ownerDocument.body.removeChild(rt),o===null||o.length<2?[0,0,0,1]:[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10),o.length>3?parseFloat(o[3]):1]}(a));return On.set(a,n),n}function dn(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Vt=function(){function a(e){(function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")})(this,a),this.guid="wt_".concat(Object(Kt.randomString)()),this.rootDocument=e.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,function(o){(rt=o.document.createElement("span")).style.display="none"}(this.rootWindow)}var t,n,r;return t=a,(n=[{key:"getSetting",value:function(e,o,c,h,d){return this.wtSettings.getSetting(e,o,c,h,d)}},{key:"hasSetting",value:function(e){return this.wtSettings.has(e)}}])&&dn(t.prototype,n),r&&dn(t,r),a}(),un=i(188),gn=i(182),St=i(173);function Mt(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Nt=new WeakMap,cn=function(){function a(e){(function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")})(this,a),this.instance=e,this.eventManager=new en.a(e),Nt.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var t,n,r;return t=a,(n=[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",function(c){return e.onContextMenu(c)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(c){return e.onMouseOver(c)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(c){return e.onMouseOut(c)});var o=function(){e.eventManager.addEventListener(e.instance.wtTable.holder,"touchstart",function(c){return e.onTouchStart(c)}),e.eventManager.addEventListener(e.instance.wtTable.holder,"touchend",function(c){return e.onTouchEnd(c)}),e.instance.momentumScrolling||(e.instance.momentumScrolling={}),e.eventManager.addEventListener(e.instance.wtTable.holder,"scroll",function(){clearTimeout(e.instance.momentumScrolling._timeout),e.instance.momentumScrolling.ongoing||e.instance.getSetting("onBeforeTouchScroll"),e.instance.momentumScrolling.ongoing=!0,e.instance.momentumScrolling._timeout=setTimeout(function(){e.instance.touchApplied||(e.instance.momentumScrolling.ongoing=!1,e.instance.getSetting("onAfterMomentumScroll"))},200)})};Object(St.isMobileBrowser)()?o():(Object(gn.isTouchSupported)()&&o(),e.eventManager.addEventListener(e.instance.wtTable.holder,"mouseup",function(c){return e.onMouseUp(c)}),e.eventManager.addEventListener(e.instance.wtTable.holder,"mousedown",function(c){return e.onMouseDown(c)}))}},{key:"selectedCellWasTouched",value:function(e){var o=Nt.get(this),c=this.parentCell(e).coords;if(o.selectedCellBeforeTouchEnd&&c){var h=[c.row,o.selectedCellBeforeTouchEnd.from.row],d=h[0],p=h[1],A=[c.col,o.selectedCellBeforeTouchEnd.from.col];return d===p&&A[0]===A[1]}return!1}},{key:"parentCell",value:function(e){var o={},c=this.instance.wtTable.TABLE,h=Object(l.closestDown)(e,["TD","TH"],c);return h?(o.coords=this.instance.wtTable.getCoords(h),o.TD=h):Object(l.hasClass)(e,"wtBorder")&&Object(l.hasClass)(e,"current")?(o.coords=this.instance.selections.getCell().cellRange.highlight,o.TD=this.instance.wtTable.getCell(o.coords)):Object(l.hasClass)(e,"wtBorder")&&Object(l.hasClass)(e,"area")&&this.instance.selections.createOrGetArea().cellRange&&(o.coords=this.instance.selections.createOrGetArea().cellRange.to,o.TD=this.instance.wtTable.getCell(o.coords)),o}},{key:"onMouseDown",value:function(e){var o=Nt.get(this),c=this.instance.rootDocument.activeElement,h=Object(un.partial)(l.getParent,e.target),d=e.target;if(d!==c&&h(0)!==c&&h(1)!==c){var p=this.parentCell(d);Object(l.hasClass)(d,"corner")?this.instance.getSetting("onCellCornerMouseDown",e,d):p.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",e,p.coords,p.TD,this.instance),(e.button===0||this.instance.touchApplied)&&p.TD&&(o.dblClickOrigin[0]=p.TD,clearTimeout(o.dblClickTimeout[0]),o.dblClickTimeout[0]=setTimeout(function(){o.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(e){if(this.instance.hasSetting("onCellContextMenu")){var o=this.parentCell(e.target);o.TD&&this.instance.getSetting("onCellContextMenu",e,o.coords,o.TD,this.instance)}}},{key:"onMouseOver",value:function(e){if(this.instance.hasSetting("onCellMouseOver")){var o=this.instance.wtTable.TABLE,c=Object(l.closestDown)(e.target,["TD","TH"],o),h=this.instance.overlay?this.instance.overlay.master:this.instance;c&&c!==h.lastMouseOver&&Object(l.isChildOf)(c,o)&&(h.lastMouseOver=c,this.instance.getSetting("onCellMouseOver",e,this.instance.wtTable.getCoords(c),c,this.instance))}}},{key:"onMouseOut",value:function(e){if(this.instance.hasSetting("onCellMouseOut")){var o=this.instance.wtTable.TABLE,c=Object(l.closestDown)(e.target,["TD","TH"],o),h=Object(l.closestDown)(e.relatedTarget,["TD","TH"],o);c&&c!==h&&Object(l.isChildOf)(c,o)&&this.instance.getSetting("onCellMouseOut",e,this.instance.wtTable.getCoords(c),c,this.instance)}}},{key:"onMouseUp",value:function(e){var o=Nt.get(this),c=this.parentCell(e.target);c.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",e,c.coords,c.TD,this.instance),(e.button===0||this.instance.touchApplied)&&(c.TD===o.dblClickOrigin[0]&&c.TD===o.dblClickOrigin[1]?(Object(l.hasClass)(e.target,"corner")?this.instance.getSetting("onCellCornerDblClick",e,c.coords,c.TD,this.instance):this.instance.getSetting("onCellDblClick",e,c.coords,c.TD,this.instance),o.dblClickOrigin[0]=null,o.dblClickOrigin[1]=null):c.TD===o.dblClickOrigin[0]&&(o.dblClickOrigin[1]=c.TD,clearTimeout(o.dblClickTimeout[1]),o.dblClickTimeout[1]=setTimeout(function(){o.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(e){Nt.get(this).selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var o=e.target;this.selectedCellWasTouched(o)===!1&&["A","BUTTON","INPUT"].includes(o.tagName)&&e.preventDefault(),this.onMouseUp(e),this.instance.touchApplied=!1}},{key:"destroy",value:function(){var e=Nt.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}])&&Mt(t.prototype,n),r&&Mt(t,r),a}();function Dt(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Yt=function(){function a(e){(function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")})(this,a),this.wot=e}var t,n,r;return t=a,(n=[{key:"scrollViewport",value:function(e,o,c,h,d){if(e.col<0||e.row<0)return!1;var p=this.scrollViewportHorizontally(e.col,c,d),A=this.scrollViewportVertically(e.row,o,h);return p||A}},{key:"scrollViewportHorizontally",value:function(e,o,c){if(!this.wot.drawn)return!1;var h=this._getVariables(),d=h.fixedColumnsLeft,p=h.leftOverlay,A=h.totalColumns,Q=!1;if(e>=0&&e<=Math.max(A-1,0)){var ye=this.getFirstVisibleColumn(),Me=this.getLastVisibleColumn();e>=d&&ye>-1&&(e<ye||c)?Q=p.scrollTo(e):(Me===-1||Me>-1&&(e>Me||o))&&(Q=p.scrollTo(e,!0))}return Q}},{key:"scrollViewportVertically",value:function(e,o,c){if(!this.wot.drawn)return!1;var h=this._getVariables(),d=h.fixedRowsBottom,p=h.fixedRowsTop,A=h.topOverlay,Q=h.totalRows,ye=!1;if(e>=0&&e<=Math.max(Q-1,0)){var Me=this.getFirstVisibleRow(),Be=this.getLastVisibleRow();e>=p&&Me>-1&&(e<Me||o)?ye=A.scrollTo(e):(Be===-1||Be>-1&&(e>Be&&e<Q-d||c))&&(ye=A.scrollTo(e,!0))}return ye}},{key:"getFirstVisibleRow",value:function(){var e=this._getVariables(),o=e.topOverlay,c=e.wtTable,h=e.wtViewport,d=e.totalRows,p=e.fixedRowsTop,A=this.wot.rootWindow,Q=c.getFirstVisibleRow();if(o.mainTableScrollableElement===A){var ye=Object(l.offset)(c.wtRootElement),Me=Object(l.innerHeight)(c.hider),Be=Object(l.innerHeight)(A),xe=Object(l.getScrollTop)(A,A);if(ye.top+Me-Be<=xe){var nt=h.getColumnHeaderHeight();nt+=o.sumCellSizes(0,p);for(var qe=d;qe>0;qe--)if(nt+=o.sumCellSizes(qe-1,qe),ye.top+Me-nt<=xe){Q=qe;break}}}return Q}},{key:"getLastVisibleRow",value:function(){var e=this._getVariables(),o=e.topOverlay,c=e.wtTable,h=e.wtViewport,d=e.totalRows,p=this.wot.rootWindow,A=c.getLastVisibleRow();if(o.mainTableScrollableElement===p){var Q=Object(l.offset)(c.wtRootElement),ye=Object(l.getScrollTop)(p,p);if(Q.top>ye){for(var Me=Object(l.innerHeight)(p),Be=h.getColumnHeaderHeight(),xe=1;xe<=d;xe++)if(Be+=o.sumCellSizes(xe-1,xe),Q.top+Be-ye>=Me){A=xe-2;break}}}return A}},{key:"getFirstVisibleColumn",value:function(){var e=this._getVariables(),o=e.leftOverlay,c=e.wtTable,h=e.wtViewport,d=e.totalColumns,p=this.wot.rootWindow,A=c.getFirstVisibleColumn();if(o.mainTableScrollableElement===p){var Q=Object(l.offset)(c.wtRootElement),ye=Object(l.innerWidth)(c.hider),Me=Object(l.innerWidth)(p),Be=Object(l.getScrollLeft)(p,p);if(Q.left+ye-Me<=Be){for(var xe=h.getRowHeaderWidth(),nt=d;nt>0;nt--)if(xe+=o.sumCellSizes(nt-1,nt),Q.left+ye-xe<=Be){A=nt;break}}}return A}},{key:"getLastVisibleColumn",value:function(){var e=this._getVariables(),o=e.leftOverlay,c=e.wtTable,h=e.wtViewport,d=e.totalColumns,p=this.wot.rootWindow,A=c.getLastVisibleColumn();if(o.mainTableScrollableElement===p){var Q=Object(l.offset)(c.wtRootElement),ye=Object(l.getScrollLeft)(p,p);if(Q.left>ye){for(var Me=Object(l.innerWidth)(p),Be=h.getRowHeaderWidth(),xe=1;xe<=d;xe++)if(Be+=o.sumCellSizes(xe-1,xe),Q.left+Be-ye>=Me){A=xe-2;break}}}return A}},{key:"_getVariables",value:function(){var e=this.wot;return{topOverlay:e.wtOverlays.topOverlay,leftOverlay:e.wtOverlays.leftOverlay,wtTable:e.wtTable,wtViewport:e.wtViewport,totalRows:e.getSetting("totalRows"),totalColumns:e.getSetting("totalColumns"),fixedRowsTop:e.getSetting("fixedRowsTop"),fixedRowsBottom:e.getSetting("fixedRowsBottom"),fixedColumnsLeft:e.getSetting("fixedColumnsLeft")}}}])&&Dt(t.prototype,n),r&&Dt(t,r),a}();function Sn(a){return(Sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function _n(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function pn(a,t){return(pn=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function Hn(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=Mn(a);if(t){var e=Mn(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return Gn(this,n)}}function Gn(a,t){return!t||Sn(t)!=="object"&&typeof t!="function"?jn(a):t}function jn(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Mn(a){return(Mn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var rr=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&pn(c,h)})(o,a);var t,n,r,e=Hn(o);function o(c){var h;return function(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}(this,o),(h=e.call(this,c)).overlay=c.overlay,h.overlayName=c.overlay.type,h.wtSettings=h.overlay.master.wtSettings,h.wtTable=c.createTableFn(jn(h),c.table),h.wtScroll=new Yt(jn(h)),h.wtViewport=h.overlay.master.wtViewport,h.wtEvent=new cn(jn(h)),h.selections=h.overlay.master.selections,h}return t=o,(n=[{key:"drawClone",value:function(){var c=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this.wtTable.draw(c),this}},{key:"getOverlayName",value:function(){return this.overlayName}}])&&_n(t.prototype,n),r&&_n(t,r),o}(Vt);function $n(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function ar(a,t,n){return t&&$n(a.prototype,t),n&&$n(a,n),a}var Rn,Qn={},st=function(){function a(t){(function(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")})(this,a),this.master=t,this.type="",this.mainTableScrollableElement=null,this.areElementSizesAdjusted=!1}return ar(a,null,[{key:"registerOverlay",value:function(t,n){if(a.CLONE_TYPES.indexOf(t)===-1)throw new Error("Unsupported overlay (".concat(t,")."));Qn[t]=n}},{key:"createOverlay",value:function(t,n){return new Qn[t](n)}},{key:"hasOverlay",value:function(t){return Qn[t]!==void 0}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_TYPES",get:function(){return[a.CLONE_TOP,a.CLONE_BOTTOM,a.CLONE_LEFT,a.CLONE_TOP_LEFT_CORNER,a.CLONE_BOTTOM_LEFT_CORNER]}}]),ar(a,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered(),t&&!this.needFullRender&&this.resetElementsSize()}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateMainScrollableElement",value:function(){var t=this.master;Object(l.getComputedStyle)(t.wtTable.wtRootElement.parentNode,t.rootWindow).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=t.wtTable.holder:this.mainTableScrollableElement=Object(l.getScrollableElement)(t.wtTable.TABLE)}},{key:"getRelativeCellPosition",value:function(t,n,r){if(this.clone.wtTable.holder.contains(t)!==!1){var e=this.mainTableScrollableElement===this.master.rootWindow,o=r<this.master.getSetting("fixedColumnsLeft"),c=n<this.master.getSetting("fixedRowsTop"),h=n>=this.master.getSetting("totalRows")-this.master.getSetting("fixedRowsBottom"),d={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},p={left:t.offsetLeft,top:t.offsetTop};return e?this.getRelativeCellPositionWithinWindow(c,o,p,d):this.getRelativeCellPositionWithinHolder(c,h,o,p,d)}Object(Qt.b)("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeCellPositionWithinWindow",value:function(t,n,r,e){var o=Object(l.getBoundingClientRect)(this.master.wtTable.wtRootElement),c=0,h=0;return c=n?o.left<=0?-1*o.left:0:e.left,t?h=Object(l.getBoundingClientRect)(this.clone.wtTable.TABLE).top-o.top:h=e.top,{left:r.left+c,top:r.top+h}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,n,r,e,o){var c=this.clone.overlay.master.wtOverlays.leftOverlay.getScrollPosition(),h=this.clone.overlay.master.wtOverlays.topOverlay.getScrollPosition(),d=0,p=0;if(r||(d=c-o.left),n){var A=Object(l.getBoundingClientRect)(this.master.wtTable.wtRootElement);p=-1*Object(l.getBoundingClientRect)(this.clone.wtTable.TABLE).top+A.top}else t||(p=h-o.top);return{left:e.left-d,top:e.top-p}}},{key:"makeClone",value:function(t){if(a.CLONE_TYPES.indexOf(t)===-1)throw new Error('Clone type "'.concat(t,'" is not supported.'));var n=this.master,r=n.rootDocument.createElement("DIV"),e=n.rootDocument.createElement("TABLE");r.className="ht_clone_".concat(t," handsontable"),r.style.position="absolute",r.style.top=0,r.style.left=0,r.style.overflow="visible",e.className=n.wtTable.TABLE.className,r.appendChild(e),this.type=t,n.wtTable.wtRootElement.parentNode.appendChild(r);var o=n.getSetting("preventOverflow");return o===!0||o==="horizontal"&&this.type===a.CLONE_TOP||o==="vertical"&&this.type===a.CLONE_LEFT?this.mainTableScrollableElement=n.rootWindow:Object(l.getComputedStyle)(n.wtTable.wtRootElement.parentNode,n.rootWindow).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=n.wtTable.holder:this.mainTableScrollableElement=Object(l.getScrollableElement)(n.wtTable.TABLE),new rr({overlay:this,createTableFn:this.createTable,table:e})}},{key:"redrawClone",value:function(){var t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.adjustElementsPosition(),this.needFullRender&&this.clone.drawClone(t)}},{key:"resetElementsSize",value:function(){var t=this.clone;t.wtTable.holder.style.width="",t.wtTable.holder.style.height="",t.wtTable.hider.style.width="",t.wtTable.hider.style.height="",t.wtTable.wtRootElement.style.width="",t.wtTable.wtRootElement.style.height=""}},{key:"destroy",value:function(){new en.a(this.clone).destroy()}}]),a}();function sr(a,t){return function(n){if(Array.isArray(n))return n}(a)||function(n,r){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var e=[],o=!0,c=!1,h=void 0;try{for(var d,p=n[Symbol.iterator]();!(o=(d=p.next()).done)&&(e.push(d.value),!r||e.length!==r);o=!0);}catch(A){c=!0,h=A}finally{try{o||p.return==null||p.return()}finally{if(c)throw h}}return e}}(a,t)||function(n,r){if(!!n){if(typeof n=="string")return lr(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return lr(n,r)}}(a,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function lr(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}function Zn(a){a.command=""}function ur(a){a.renderedCommand!==a.command&&(a.elem.setAttribute("d",a.command),a.renderedCommand=a.command)}function ae(a,t){var n=a.split(" "),r=t.split(" "),e=parseInt(n[0],10),o=parseInt(r[0],10);n.shift(),n.shift(),r.shift(),r.shift();var c,h,d=n.join(" "),p=r.join(" ");return e>o?1:e<o?-1:(c=En(p),h=En(d),c>h?1:c<h?-1:0)}function oe(a,t,n){var r=a.get(t);if(!r){var e=n.ownerDocument.createElementNS("http://www.w3.org/2000/svg","path"),o=t.split(" "),c=parseInt(o[0],10);o.shift(),o.shift();var h=o.join(" ");e.setAttribute("stroke",h),e.setAttribute("stroke-width",c),e.setAttribute("shape-rendering","geometricPrecision"),e.setAttribute("data-stroke-style",t),Zn(r={elem:e,command:"",renderedCommand:""});for(var d=null,p=n.firstElementChild;p;){if(ae(t,p.getAttribute("data-stroke-style"))===-1){d=p;break}p=p.nextSibling}d?n.insertBefore(e,d):n.appendChild(e),a.set(t,r)}return r}function J(a){for(var t="M ",n=0;n<a.length;n++)t+=n>1&&n%2==0?" L ".concat(a[n]):" ".concat(a[n]);return t}function Ce(a){return"M ".concat(a.join(" "))}function _e(a){return function(t){if(Array.isArray(t))return Ue(t)}(a)||function(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}(a)||function(t,n){if(!!t){if(typeof t=="string")return Ue(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ue(t,n)}}(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ue(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}function Ae(a){for(var t=[],n=new Map,r=0;r<a.length;r++){var e=a[r],o=e[1]===e[3]?"h-".concat(e[1]):"v-".concat(e[0]),c=n.get(o);c?c.push(e):n.set(o,[e])}return n.forEach(function(h){h.length>1?t.push.apply(t,_e(function(d){var p=0;do{var A=d[p],Q=A[1]===A[3],ye=void 0;do{ye=!1;for(var Me=p+1;Me<d.length;Me++){var Be=d[Me];if(!Be.deleted&&(nt=A,ye=ke((qe=Be)[0],qe[1],nt)||ke(qe[2],qe[3],nt))){var xe=ze(A,Be);Q?(A[0]=xe.low[0],A[2]=xe.high[0]):(A[1]=xe.low[1],A[3]=xe.high[1]),Be.deleted=!0;break}}}while(ye);p+=1}while(p<d.length);var nt,qe;return d.filter(function(mt){return!mt.deleted})}(h))):t.push(h[0])}),t}function ke(a,t,n){return!!Pe(a,n[0],n[2])&&Pe(t,n[1],n[3])}function Pe(a,t,n){return n>t?a>=t&&a<=n:a>=n&&a<=t}function ze(a,t){var n,r,e=it(a),o=it(t);return r=o,vt((n=e).low,r.low,Math.min),vt(n.high,r.high,Math.max),n}function it(a){return{low:At(a,Math.min),high:At(a,Math.max)}}function At(a,t){return[t(a[0],a[2]),t(a[1],a[3])]}function vt(a,t,n){a[0]=n(a[0],t[0]),a[1]=n(a[1],t[1])}function qt(a){return function(t){if(Array.isArray(t))return kt(t)}(a)||function(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}(a)||function(t,n){if(!!t){if(typeof t=="string")return kt(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kt(t,n)}}(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function kt(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}function sn(a){for(var t=new Ct,n=[],r=0;r<a.length;r++){var e=a[r],o=t.insertValue({pathContext:e,reversed:!1});t.insertValueIdAtPoint(o,Wt(e));var c=t.insertValue({pathContext:e,reversed:!0});t.insertValueIdAtPoint(c,Ut(e))}var h=[];t.forEachPoint(function(p,A){if(A.length>0){var Q=[];if(Bt(t,p[0],Q,p[0]),Q.endless)n.push(Q);else{Q.reverse();var ye=Q[0];Q.forEach(function(nt){nt.reversed=!nt.reversed});var Me=Q.pop();Bt(t,Me,Q,ye),Q.length>1?(Q.endless=(Be=_t(Q[0],!0),xe=_t(Q[Q.length-1]),Be[0]===xe[0]&&Be[1]===xe[1]),n.push(Q)):h.push(Q[0].pathContext)}}var Be,xe});var d=[];return n.forEach(function(p){d.push(function(A){var Q=[];Q.push.apply(Q,qt(on(A[0].pathContext,!A[0].reversed)));for(var ye=0;ye<A.length;ye++)Q.push.apply(Q,qt(on(A[ye].pathContext,A[ye].reversed)));return Q}(p))}),h.forEach(function(p){d.push(p)}),d}function Ct(){this.reset()}function Wt(a){return a.slice(0,2)}function Ut(a){return a.slice(2,4)}function Bt(a,t,n,r){for(;t;){n.push(t);var e=on(t.pathContext,t.reversed),o=a.getElementAtPoint(e);if(!o||o.length===0)break;var c=wn(o.map(function(h){return a.values[h]}),t.pathContext);if(o.splice(0,2),!c)break;if(c.pathContext===r.pathContext){n.length>1&&(n.endless=!0);break}t=c}}function on(a,t){return t?Wt(a):Ut(a)}function wn(a,t){return a[0].pathContext===t?a[1]:a[0]}function _t(a,t){return t===a.reversed?Ut(a.pathContext):Wt(a.pathContext)}function It(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function tn(a,t,n){return t in a?Object.defineProperty(a,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[t]=n,a}Ct.prototype.reset=function(){this.insertedCount=0,this.graph={},this.index={},this.values=[]},Ct.prototype.insertValue=function(a){return this.values.push(a),this.values.length-1},Ct.prototype.insertValueIdAtPoint=function(a,t){var n=t[0],r=t[1];this.graph[n]||(this.graph[n]={});var e,o,c=this.graph[n];r in c?(o=c[r],(e=this.index[o]).push(a)):(o=this.insertedCount,c[r]=o,this.insertedCount+=1,e=[a],this.index[o]=e)},Ct.prototype.forEachPoint=function(a){for(var t=this,n=0;n<this.insertedCount;n++){var r=this.index[n];r&&r.length>0&&a(r.map(function(e){return t.values[e]}),r)}},Ct.prototype.getIdOfPoint=function(a){var t=this.graph[a[0]];if(t){var n=t[a[1]];if(n>=0)return n}},Ct.prototype.getElementAtPoint=function(a){var t=this.getIdOfPoint(a);if(t>=0)return this.index[t]};var N=function(){function a(e){(function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")})(this,a),tn(this,"rootDocument",void 0),tn(this,"uniqueDomInnerClipId",void 0),tn(this,"svg",void 0),tn(this,"rect",void 0),this.rootDocument=e,this.uniqueDomInnerClipId="".concat(Object(Kt.randomString)(),"-inner-clip"),this.createElement()}var t,n,r;return t=a,(n=[{key:"createSvgGroup",value:function(e){var o=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","g");return e&&o.setAttribute("clip-path","url(#".concat(this.uniqueDomInnerClipId)),this.svg.appendChild(o),o}},{key:"setClipAttributes",value:function(e){var o=this;Object.keys(e).forEach(function(c){o.rect.setAttribute(c,e[c])})}},{key:"createElement",value:function(){if(this.svg===void 0){var e=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","svg");e.style.top="0",e.style.left="0",e.style.width="0",e.style.height="0",e.style.position="absolute",e.style.zIndex="5",e.setAttribute("pointer-events","none"),e.setAttribute("class","wtBorders");var o=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","defs"),c=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","clipPath"),h=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("id",this.uniqueDomInnerClipId),c.appendChild(h),o.appendChild(c),e.appendChild(o),this.rect=h,this.svg=e}}}])&&It(t.prototype,n),r&&It(t,r),a}();function T(a){return(T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function b(a){return function(t){if(Array.isArray(t))return w(t)}(a)||function(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}(a)||function(t,n){if(!!t){if(typeof t=="string")return w(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(t,n)}}(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function w(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}function m(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var L=-Je.a,f=function(){function a(e,o,c){var h,d,p;(function(A,Q){if(!(A instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,a),this.overlayName=o,this.getCellFn=c,this.svgElement=new N(e.ownerDocument),this.svgResizer=(h=this.svgElement.svg,function(A,Q){A=Math.max(A,0),Q=Math.max(Q,0),A===d&&Q===p||(h.setAttribute("viewBox","0 0 ".concat(A," ").concat(Q)),A!==d&&(h.style.width="".concat(A,"px"),h.setAttribute("width",A),d=A),Q!==p&&(h.style.height="".concat(Q,"px"),h.setAttribute("height",Q),p=Q))}),this.pathGroups=[],this.containerBoundingRect=null,this.maxSvgWidth=0,this.maxSvgHeight=0,this.rootWindow=e.ownerDocument.defaultView,e.appendChild(this.svgElement.svg)}var t,n,r;return t=a,(n=[{key:"ensurePathGroup",value:function(e){var o=this.pathGroups[e];if(!o){this.pathGroups.length<e&&this.ensurePathGroup(e-1);var c=e===0,h={svgPathsRenderer:this.getSvgPathsRendererForGroup(c),stylesAndLines:new Map,styles:[],commands:[]};return this.pathGroups[e]=h,h}return o}},{key:"render",value:function(e,o,c){var h=this;this.containerBoundingRect=Object(l.getBoundingClientRect)(e),this.pathGroups.forEach(function(xe){return xe.stylesAndLines.clear()});for(var d=e.querySelector("tbody td"),p=d?Object(l.getBoundingClientRect)(d):null,A=0;A<c.length;A++)this.convertBorderEdgesDescriptorToLines(c[A]);this.pathGroups.forEach(function(xe){return h.convertLinesToCommands(xe)});var Q=Math.min(this.maxSvgWidth,this.containerBoundingRect.width),ye=Math.min(this.maxSvgHeight,this.containerBoundingRect.height);if(this.svgResizer(Q,ye),p){var Me=o.left+p.left-this.containerBoundingRect.left+L,Be=o.top+p.top-this.containerBoundingRect.top+L;this.svgElement.setClipAttributes({width:Math.max(Q-Me-o.right,0),height:Math.max(ye-Be-o.bottom,0),x:Me,y:Be})}this.pathGroups.forEach(function(xe){return xe.svgPathsRenderer(xe.styles,xe.commands)})}},{key:"sumArrayElementAtIndex",value:function(e,o){return e.reduce(function(c,h){return Math.max(c,h[o])},0)}},{key:"setIn2dMap",value:function(e,o,c,h){var d=e.get(o);d?d.set(c,h):e.set(o,new Map([[c,h]]))}},{key:"adjustTipsOfLines",value:function(e,o,c,h){if(e.length!==0)for(var d=0;d<e.length;d++){var p,A,Q=e[d],ye=Q[0]===Q[2],Me=ye?c:h,Be=ye?h:c,xe=ye?1:0,nt=Q.length,qe=nt-2,mt=nt-1,xt=ye?mt:qe,jt=(p=Me.get(Q[0]))===null||p===void 0?void 0:p.get(Q[1]),Zt=(A=Me.get(Q[qe]))===null||A===void 0?void 0:A.get(Q[mt]);if(o>1)for(var Lt=0;Lt<nt;Lt+=2)this.setIn2dMap(Be,Q[Lt],Q[Lt+1],o);if(jt&&(Q[xe]-=Math.floor(jt/2)),Q[xt]+=Je.a,Zt){var Tt=Zt%2==0?-1:0;Q[xt]+=Math.floor(Zt/2)+Tt}}}},{key:"convertLinesToCommands",value:function(e){var o=this,c=e.stylesAndLines,h=e.commands,d=b(c.keys()),p=new Map,A=new Map;h.length=0,e.styles=d.sort(ae),e.styles.forEach(function(Q){var ye=c.get(Q),Me=parseInt(Q,10);o.adjustTipsOfLines(ye,Me,p,A);var Be=function(mt,xt){for(var jt="",Zt=-1,Lt=-1,Tt=-1,$t=-1,Et=0;Et<mt.length;Et++){var Ht=mt[Et];Et===0&&(Zt=Ht[0],Lt=Ht[1]);var kn=Ht.length;Tt=Ht[kn-2],$t=Ht[kn-1],Et>0&&(jt+=" "),jt+=Rn(Ht)}var Dn=mt[0],Bn=mt[mt.length-1];if(Zt!==Tt||Lt!==$t){if(xt===1){var Un=Bn.length;jt="M ".concat(Dn[2]," ").concat(Dn[3]," ").concat(jt.substring(2)," ").concat(Bn[Un-4]," ").concat(Bn[Un-3])}}else jt+=" Z";return jt}(function(mt){return sn(Ae(mt))}(function(mt,xt){for(var jt=new Array(xt.length),Zt=mt%2!=0,Lt=0;Lt<xt.length;Lt++){var Tt=sr(xt[Lt],4),$t=Tt[0],Et=Tt[1],Ht=Tt[2],kn=Tt[3];Zt&&(Et===kn?(Et+=.5,kn+=.5):($t+=.5,Ht+=.5)),jt[Lt]=[$t,Et,Ht,kn]}return jt}(Me,ye))),xe=Math.ceil(Me/2),nt=o.sumArrayElementAtIndex(ye,2)+xe,qe=o.sumArrayElementAtIndex(ye,3)+xe;nt>o.maxSvgWidth&&(o.maxSvgWidth=nt),qe>o.maxSvgHeight&&(o.maxSvgHeight=qe),h.push(Be)})}},{key:"getSvgPathsRendererForGroup",value:function(e){return function(o){Rn||(Rn=function(h){var d=h.createElementNS("http://www.w3.org/2000/svg","path");return d.setAttribute("d","M 0 0 10 0"),d.getAttribute("d")!=="M 0 0 10 0"}(o.ownerDocument)?J:Ce),o.setAttribute("fill","none");var c=new Map;return function(h,d){c.forEach(Zn);for(var p=0;p<h.length;p++)oe(c,h[p],o).command=d[p];c.forEach(ur)}}(this.svgElement.createSvgGroup(e))}},{key:"getLayerNumber",value:function(e){switch(e.className){case"current":return 3;case"area":return 2;case"fill":return 1;default:return 0}}},{key:"convertBorderEdgesDescriptorToLines",value:function(e){var o=e.settings,c=e.selectionStart,h=e.selectionEnd,d=e.hasTopEdge,p=e.hasRightEdge,A=e.hasBottomEdge,Q=e.hasLeftEdge,ye=this.getLayerNumber(o),Me=this.ensurePathGroup(ye).stylesAndLines,Be=c.row===h.row&&c.col===h.col,xe=0,nt=0,qe=this.getCellFn(c);if(qe===-1&&(c.row+=1,qe=this.getCellFn(c),nt=-1),qe===-2&&(c.row-=1,qe=this.getCellFn(c),nt=1),qe===-4&&(c.col-=1,qe=this.getCellFn(c),xe=1),T(qe)==="object"){var mt,xt=0,jt=0;if(Be?(mt=qe,xt=xe,jt=nt):((mt=this.getCellFn(h))===-1&&(h.row+=1,mt=this.getCellFn(h),jt=-1),mt===-2&&(h.row-=1,mt=this.getCellFn(h),jt=1),mt===-4&&(h.col-=1,mt=this.getCellFn(h),xt=1)),T(mt)==="object"){var Zt=Object(l.getBoundingClientRect)(qe),Lt=qe===mt?Zt:Object(l.getBoundingClientRect)(mt),Tt=Zt.left,$t=Zt.top,Et=Lt.left+Lt.width,Ht=Lt.top+Lt.height;Tt+=xe*Zt.width,$t+=nt*Zt.height,Et+=xt*Lt.width,Ht+=jt*Lt.height;var kn=!(qe.nodeName==="TH"||qe.previousElementSibling),Dn=!qe.parentNode.previousElementSibling&&!qe.parentNode.parentNode.previousElementSibling.firstElementChild;if(kn||(Tt+=L),Dn||($t+=L),Tt+=-this.containerBoundingRect.left,$t+=-this.containerBoundingRect.top,Et+=L-this.containerBoundingRect.left,Ht+=L-this.containerBoundingRect.top,o.border&&o.border.width&&o.border.strokeAlignment==="inside"){var Bn=Math.floor(o.border.width/2),Un=Math.ceil(o.border.width/2)-1;Tt+=Bn,$t+=Bn,Et-=Un,Ht-=Un}this.overlayName!=="bottom"&&this.overlayName!=="bottom_left_corner"||Ht===-1&&(Ht=0),d&&this.hasLineAtEdge(o,"top")&&this.getLines(Me,o,"top").push([Tt,$t,Et,$t]),p&&this.hasLineAtEdge(o,"right")&&this.getLines(Me,o,"right").push([Et,$t,Et,Ht]),A&&this.hasLineAtEdge(o,"bottom")&&this.getLines(Me,o,"bottom").push([Tt,Ht,Et,Ht]),Q&&this.hasLineAtEdge(o,"left")&&this.getLines(Me,o,"left").push([Tt,$t,Tt,Ht])}}}},{key:"hasLineAtEdge",value:function(e,o){return!(e[o]&&e[o].hide)}},{key:"getLines",value:function(e,o,c){var h=1;o[c]&&o[c].width!==void 0?h=o[c].width:o.border&&o.border.width!==void 0&&(h=o.border.width);var d=o[c]&&o[c].color||o.border&&o.border.color||"black",p="".concat(h,"px solid ").concat(d),A=e.get(p);if(A)return A;var Q=[];return e.set(p,Q),Q}}])&&m(t.prototype,n),r&&m(t,r),a}(),g=i(159),E=i(160),D=i(201);function z(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var te=function(){function a(e){(function(ye,Me){if(!(ye instanceof Me))throw new TypeError("Cannot call a class as a function")})(this,a),this.wot=e;var o=this.wot,c=o.rootDocument,h=o.rootWindow,d=o.wtTable,p=parseInt(Object(l.getComputedStyle)(c.body,h).lineHeight,10),A=1.2*parseInt(Object(l.getComputedStyle)(c.body,h).fontSize,10);this.eventManager=new en.a(this.wot),this.scrollbarSize=Object(l.getScrollbarWidth)(c),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var Q=Object(l.getComputedStyle)(d.wtRootElement.parentNode,h).getPropertyValue("overflow")==="hidden";this.scrollableElement=Q?d.holder:Object(l.getScrollableElement)(d.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=p||A,this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}var t,n,r;return t=a,(n=[{key:"prepareOverlays",value:function(){this.topOverlay?this.topOverlay.updateStateOfRendering():this.topOverlay=st.createOverlay(st.CLONE_TOP,this.wot),st.hasOverlay(st.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){}}),st.hasOverlay(st.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){}}),this.bottomOverlay?this.bottomOverlay.updateStateOfRendering():this.bottomOverlay=st.createOverlay(st.CLONE_BOTTOM,this.wot),this.leftOverlay?this.leftOverlay.updateStateOfRendering():this.leftOverlay=st.createOverlay(st.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?this.topLeftCornerOverlay.updateStateOfRendering():this.topLeftCornerOverlay=st.createOverlay(st.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?this.bottomLeftCornerOverlay.updateStateOfRendering():this.bottomLeftCornerOverlay=st.createOverlay(st.CLONE_BOTTOM_LEFT_CORNER,this.wot))}},{key:"refreshMasterAndClones",value:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,o=this.wot,c=o.rootDocument,h=o.rootWindow,d=this.topOverlay.mainTableScrollableElement,p=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(c.documentElement,"keydown",function(xe){return e.onKeyDown(xe)}),this.eventManager.addEventListener(c.documentElement,"keyup",function(){return e.onKeyUp()}),this.eventManager.addEventListener(c,"visibilitychange",function(){return e.onKeyUp()}),this.eventManager.addEventListener(d,"scroll",function(xe){return e.onTableScroll(xe)},{passive:!0}),d!==p&&this.eventManager.addEventListener(p,"scroll",function(xe){return e.onTableScroll(xe)},{passive:!0});var A,Q=h.devicePixelRatio&&h.devicePixelRatio>1,ye=this.scrollableElement===h,Me=this.wot.wtSettings.getSetting("preventWheel"),Be={passive:ye};(Me||Q||!Object(St.isChrome)())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",function(xe){return e.onCloneWheel(xe,Me)},Be),[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay].forEach(function(xe){if(xe&&xe.needFullRender){var nt=xe.clone.wtTable.holder;e.eventManager.addEventListener(nt,"wheel",function(qe){return e.onCloneWheel(qe,Me)},Be)}}),this.eventManager.addEventListener(h,"resize",function(){clearTimeout(A),A=setTimeout(function(){e.wot.getSetting("onWindowResize")},200)})}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var o=this.wot.rootWindow,c=this.leftOverlay.mainTableScrollableElement,h=this.topOverlay.mainTableScrollableElement,d=e.target;this.keyPressed&&(h!==o&&d!==o&&!e.target.contains(h)||c!==o&&d!==o&&!e.target.contains(c))||(this.propagateMasterScrollPositionsToClones(),this.refreshMasterAndClones())}},{key:"onCloneWheel",value:function(e,o){var c=this.wot.rootWindow,h=this.leftOverlay.mainTableScrollableElement,d=this.topOverlay.mainTableScrollableElement,p=e.target,A=d!==c&&p!==c&&!p.contains(d),Q=h!==c&&p!==c&&!p.contains(h);if(!this.keyPressed||!A&&!Q){var ye=this.translateMouseWheelToScroll(e);(o||this.scrollableElement!==c&&ye)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=Object(D.isKey)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var o=this.browserLineHeight,c=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,h=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(h+=h*o,c+=c*o);var d=this.scrollVertically(c),p=this.scrollHorizontally(h);return d||p}},{key:"scrollVertically",value:function(e){var o=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,o!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var o=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,o!==this.scrollableElement.scrollLeft}},{key:"propagateMasterScrollPositionsToClones",value:function(){if(!this.destroyed){var e=this.wot.rootWindow,o=this.topOverlay.clone.wtTable.holder,c=this.leftOverlay.clone.wtTable.holder,h=this.bottomOverlay.clone.wtTable.holder,d=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],p=d[0],A=d[1];this.horizontalScrolling=o.scrollLeft!==p||this.lastScrollX!==e.scrollX,this.verticalScrolling=c.scrollTop!==A||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling&&(this.topOverlay.needFullRender&&(o.scrollLeft=p),this.bottomOverlay.needFullRender&&(h.scrollLeft=p)),this.verticalScrolling&&this.leftOverlay.needFullRender&&(c.scrollTop=A)}}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wot,o=e.rootWindow,c=e.wtTable;Object(l.getComputedStyle)(c.wtRootElement.parentNode,o).getPropertyValue("overflow")==="hidden"?this.scrollableElement=c.holder:this.scrollableElement=Object(l.getScrollableElement)(c.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.destroyed=!0}},{key:"refreshClones",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(e||this.prepareOverlays(),this.bottomOverlay.clone&&this.bottomOverlay.redrawClone(e),this.leftOverlay.redrawClone(e),this.topOverlay.redrawClone(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.redrawClone(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.redrawClone(e),this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var o=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,c=Object(l.clientWidth)(o),h=Object(l.clientHeight)(o);c===this.spreaderLastSize.width&&h===this.spreaderLastSize.height||(this.spreaderLastSize.width=c,this.spreaderLastSize.height=h,this.adjustElementsSizes())}else e||this.adjustElementsSizes()}},{key:"adjustElementsSizes",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],o=this.wot,c=o.wtViewport,h=o.wtTable,d=this.wot.getSetting("totalColumns"),p=this.wot.getSetting("totalRows"),A=c.getRowHeaderWidth(),Q=c.getColumnHeaderHeight(),ye=h.hider.style,Me=A||Je.a,Be=Q||Je.a;if(ye.width="".concat(Me+this.leftOverlay.sumCellSizes(0,d),"px"),ye.height="".concat(Be+this.topOverlay.sumCellSizes(0,p),"px"),this.scrollbarSize>0){var xe=h.wtRootElement,nt=xe.scrollHeight,qe=xe.scrollWidth,mt=h.holder,xt=mt.scrollHeight,jt=mt.scrollWidth;this.hasScrollbarRight=nt<xt,this.hasScrollbarBottom=qe<jt,this.hasScrollbarRight&&Object(l.scrollWidth)(h.hider)+this.scrollbarSize>qe?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&Object(l.scrollHeight)(h.hider)+this.scrollbarSize>nt&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.adjustElementsSize(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.adjustElementsSize(e)}},{key:"getParentOverlay",value:function(e){if(!e)return null;var o=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],c=null;return Object(E.arrayEach)(o,function(h){h&&h.clone&&h.clone.wtTable.TABLE.contains(e)&&(c=h.clone)}),c}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wot.wtTable.TABLE,o=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];Object(E.arrayEach)(o,function(c){c&&(c.clone.wtTable.TABLE.className=e.className)})}}])&&z(t.prototype,n),r&&z(t,r),a}();function ge(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Ne=function(){function a(e,o){var c=this;(function(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")})(this,a),this.wot=e,this.defaults={table:void 0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(h,d,p){var A=c.getSetting("data",h,d);Object(l.fastInnerText)(p,A==null?"":A)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(h){return h},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},Object(g.objectEach)(this.defaults,function(h,d){if(o[d]!==void 0)c.settings[d]=o[d];else{if(h===void 0)throw new Error('A required setting "'.concat(d,'" was not provided'));c.settings[d]=h}})}var t,n,r;return t=a,(n=[{key:"update",value:function(e,o){var c=this;return o===void 0?Object(g.objectEach)(e,function(h,d){c.settings[d]=h}):this.settings[e]=o,this.wot}},{key:"getSetting",value:function(e,o,c,h,d){return typeof this.settings[e]=="function"?this.settings[e](o,c,h,d):o!==void 0&&Array.isArray(this.settings[e])?this.settings[e][o]:this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}])&&ge(t.prototype,n),r&&ge(t,r),a}();function et(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var pt=function(){function a(e){var o=this;(function(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")})(this,a),this.wot=e,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked=!1,this.clientHeight=this._getWorkspaceHeight(),this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new en.a(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",function(){o.clientHeight=o._getWorkspaceHeight()})}var t,n,r;return t=a,(n=[{key:"getWorkspaceHeight",value:function(){return this.clientHeight}},{key:"_getWorkspaceHeight",value:function(){var e=this.wot.rootDocument,o=this.wot.wtTable.trimmingContainer;return o===this.wot.rootWindow?Object(l.clientHeight)(e.documentElement):Object(l.outerHeight)(o)>0&&Object(l.clientHeight)(o)>0?Object(l.clientHeight)(o):1/0}},{key:"getWorkspaceWidth",value:function(){return window.innerWidth}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,o){for(var c=0,h=e;h<o;)c+=this.wot.columnUtils.getWidth(h),h+=1;return c}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wot.wtTable.holder,o=this.wot.rootDocument.createElement("div");o.style.width="100%",o.style.height="1px",e.appendChild(o);var c=Object(l.offsetWidth)(o);return this.containerWidth=c,e.removeChild(o),c}},{key:"getWorkspaceOffset",value:function(){return Object(l.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return Object(l.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var e=this.wot.wtTable;return Object(l.outerWidth)(e.TABLE)||Object(l.outerWidth)(e.TBODY)||Object(l.outerWidth)(e.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return this.columnHeaderHeight||(this.wot.getSetting("columnHeaders").length?this.columnHeaderHeight||(this.columnHeaderHeight=Object(l.outerHeight)(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var o=this.getColumnHeaderHeight();return o>0&&(e-=o),e}},{key:"getRowHeaderWidth",value:function(){return this.rowHeaderWidth=50,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var o=this.getRowHeaderWidth();return o>0?e-o:e-Je.a}},{key:"createRowsCalculator",value:function(){var e,o,c,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,d=this.wot,p=d.wtSettings,A=d.wtOverlays;d.wtTable,d.rootDocument,this.rowHeaderWidth=NaN,e=p.settings.renderAllRows&&h===1?1/0:this.getViewportHeight();var Q=A.topOverlay.getScrollPosition()-A.topOverlay.getTableParentOffset();Q<0&&(Q=0);var ye=d.getSetting("fixedRowsTop"),Me=d.getSetting("fixedRowsBottom"),Be=d.getSetting("totalRows");return ye&&(Q+=c=A.topOverlay.sumCellSizes(0,ye),e-=c),Me&&A.bottomOverlay.clone&&(e-=c=A.bottomOverlay.sumCellSizes(Be-Me,Be)),o=0,new B({viewportSize:e,scrollOffset:Q,totalItems:d.getSetting("totalRows"),itemSizeFn:function(xe){return d.rowUtils.getHeight(xe)},overrideFn:p.settings.viewportRowCalculatorOverride,calculationType:h,scrollbarHeight:o})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,o=this.wot,c=o.wtSettings,h=o.wtOverlays,d=(o.wtTable,o.rootDocument,this.getViewportWidth()),p=h.leftOverlay.getScrollPosition()-h.leftOverlay.getTableParentOffset();p<0&&(p=0);var A=o.getSetting("fixedColumnsLeft");if(A){var Q=h.leftOverlay.sumCellSizes(0,A);p+=Q,d-=Q}return new X({viewportSize:d,scrollOffset:p,totalItems:o.getSetting("totalColumns"),itemSizeFn:function(ye){return o.columnUtils.getWidth(ye)},overrideFn:c.settings.viewportColumnCalculatorOverride,calculationType:e,stretchMode:o.getSetting("stretchH"),stretchingItemWidthFn:function(ye,Me){return o.getSetting("onBeforeStretchingColumnWidth",ye,Me)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],o=e;if(o){var c=this.createRowsCalculator(2),h=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(c)&&this.areAllProposedVisibleColumnsAlreadyRendered(h)||(o=!1)}return o||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,o}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var o=e.startRow,c=e.endRow,h=this.rowsRenderCalculator,d=h.startRow,p=h.endRow;return!(o<d||o===d&&o>0||c>p||c===p&&c<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var o=e.startColumn,c=e.endColumn,h=this.columnsRenderCalculator,d=h.startColumn,p=h.endColumn;return!(o<d||o===d&&o>0||c>p||c===p&&c<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){this.hasOversizedColumnHeadersMarked=!1}}])&&et(t.prototype,n),r&&et(t,r),a}();function gt(a){return(gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function wt(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Rt=function(){function a(e){(function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")})(this,a),this.wot=e,this.headerWidths=new Map}var t,n,r;return t=a,(n=[{key:"getWidth",value:function(e){var o=this.wot.wtSettings.settings.columnWidth;return typeof o=="function"?o=o(e):gt(o)==="object"&&(o=o[e]),o||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(e){var o=this.getWidth(e),c=this.wot.wtViewport.columnsRenderCalculator,h=o==null?this.wot.wtSettings.settings.defaultColumnWidth:o;if(c){var d=c.getStretchedColumnWidth(e,h);d&&(h=d)}return h}},{key:"getHeaderHeight",value:function(e){var o=this.wot.wtSettings.settings.defaultRowHeight,c=this.wot.wtViewport.oversizedColumnHeaders[e];return c!==void 0&&(o=o?Math.max(o,c):c),o}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wot,o=e.getSetting("rowHeaderWidth");(o=e.getSetting("onModifyRowHeaderWidth",o))==null&&(o=50);for(var c=e.getSetting("rowHeaders").length,h=e.getSetting("defaultColumnWidth"),d=0;d<c;d++){var p=Array.isArray(o)?o[d]:o;p=p==null?h:p,this.headerWidths.set(d,p)}}}])&&wt(t.prototype,n),r&&wt(t,r),a}();function zt(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var ln=function(){function a(e){(function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")})(this,a),this.wot=e}var t,n,r;return t=a,(n=[{key:"getHeight",value:function(e){var o=this.wot.wtSettings.settings.rowHeight(e),c=this.wot.wtViewport.oversizedRows[e];return c!==void 0&&(o=o===void 0?c:Math.max(o,c)),o}}])&&zt(t.prototype,n),r&&zt(t,r),a}();function Ft(a){return(Ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function nn(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function fn(a,t){return(fn=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function cr(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=fr(a);if(t){var e=fr(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return Mr(this,n)}}function Mr(a,t){return!t||Ft(t)!=="object"&&typeof t!="function"?An(a):t}function An(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function fr(a){return(fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var vr=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&fn(c,h)})(o,a);var t,n,r,e=cr(o);function o(c){var h;(function(Q,ye){if(!(Q instanceof ye))throw new TypeError("Cannot call a class as a function")})(this,o),(h=e.call(this,c)).wtSettings=new Ne(An(h),c),h.rowUtils=new ln(An(h)),h.columnUtils=new Rt(An(h)),h.wtTable=new _r(An(h),c.table),h.wtScroll=new Yt(An(h)),h.wtViewport=new pt(An(h)),h.wtEvent=new cn(An(h)),h.selections=h.getSetting("selections"),h.wtOverlays=new te(An(h)),h.exportSettingsAsClassNames();var d=[];if(h.wtTable.THEAD.childNodes.length&&h.wtTable.THEAD.childNodes[0].childNodes.length){for(var p=0,A=h.wtTable.THEAD.childNodes[0].childNodes.length;p<A;p++)d.push(h.wtTable.THEAD.childNodes[0].childNodes[p].innerHTML);h.getSetting("columnHeaders").length||h.update("columnHeaders",[function(Q,ye){Object(l.fastInnerText)(ye,d[Q])}])}return h.drawn=!1,h.drawInterrupted=!1,h}return t=o,(n=[{key:"draw",value:function(){var c=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Object(l.clearMemoizedFunctionsBeforeRender)(),this.drawInterrupted=!1,c||this.wtTable.isVisible()?(this.wtTable.draw(c),this.drawn=!0):this.drawInterrupted=!0,this}},{key:"getCell",value:function(c){var h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!h)return this.wtTable.getCell(c);var d=this.wtSettings.getSetting("totalRows"),p=this.wtSettings.getSetting("fixedRowsTop"),A=this.wtSettings.getSetting("fixedRowsBottom"),Q=this.wtSettings.getSetting("fixedColumnsLeft");if(c.row<p&&c.col<Q)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(c);if(c.row<p)return this.wtOverlays.topOverlay.clone.wtTable.getCell(c);if(c.col<Q&&c.row>=d-A){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(c)}else{if(c.col<Q)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(c);if(c.row<d&&c.row>=d-A&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(c)}return this.wtTable.getCell(c)}},{key:"update",value:function(c,h){return this.wtSettings.update(c,h)}},{key:"scrollViewport",value:function(c,h,d,p,A){return!(c.col<0||c.row<0)&&this.wtScroll.scrollViewport(c,h,d,p,A)}},{key:"scrollViewportHorizontally",value:function(c,h,d){return!(c<0)&&this.wtScroll.scrollViewportHorizontally(c,h,d)}},{key:"scrollViewportVertically",value:function(c,h,d){return!(c<0)&&this.wtScroll.scrollViewportVertically(c,h,d)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"exportSettingsAsClassNames",value:function(){var c=this,h=[],d=[];Object(g.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},function(p,A){c.getSetting(A).length&&d.push(p),h.push(p)}),Object(l.removeClass)(this.wtTable.wtRootElement.parentNode,h),Object(l.addClass)(this.wtTable.wtRootElement.parentNode,d)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}])&&nn(t.prototype,n),r&&nn(t,r),o}(Vt);function Fr(a,t){return function(n){if(Array.isArray(n))return n}(a)||function(n,r){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var e=[],o=!0,c=!1,h=void 0;try{for(var d,p=n[Symbol.iterator]();!(o=(d=p.next()).done)&&(e.push(d.value),!r||e.length!==r);o=!0);}catch(A){c=!0,h=A}finally{try{o||p.return==null||p.return()}finally{if(c)throw h}}return e}}(a,t)||function(n,r){if(!!n){if(typeof n=="string")return Ar(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ar(n,r)}}(a,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ar(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}function Jn(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var Xn=function(){function a(e,o){(function(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")})(this,a),this.isMaster=e instanceof vr,this.wot=e,this.TABLE=o,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.hasTableHeight=!0,this.hasTableWidth=!0,Object(l.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1,this.tableRenderer=new Xt({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.isMaster?this.wot.rowUtils:this.wot.overlay.master.rowUtils,columnUtils:this.isMaster?this.wot.columnUtils:this.wot.overlay.master.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer}),this.borderRenderer=new f(this.spreader,this.isMaster?"master":this.wot.getOverlayName(),this.getCell.bind(this))}var t,n,r;return t=a,(n=[{key:"is",value:function(e){return!this.isMaster&&this.wot.getOverlayName()===e}},{key:"createBorderPaddingObject",value:function(){var e=0,o=0,c=0,h=0;return(this.is(st.CLONE_LEFT)||this.is(st.CLONE_TOP_LEFT_CORNER)||this.is(st.CLONE_BOTTOM_LEFT_CORNER))&&(h=1,this.wot.getSetting("rowHeaders").length>0&&(o=1)),(this.is(st.CLONE_TOP)||this.is(st.CLONE_TOP_LEFT_CORNER))&&(c=1,this.wot.getSetting("columnHeaders").length>0&&(e=1)),(this.is(st.CLONE_BOTTOM)||this.is(st.CLONE_BOTTOM_LEFT_CORNER))&&(e=1),{top:e,left:o,bottom:c,right:h}}},{key:"fixTableDomTree",value:function(){var e=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(e){var o,c=e.parentNode;return c&&c.nodeType===Node.ELEMENT_NODE&&Object(l.hasClass)(c,"wtHolder")||((o=this.wot.rootDocument.createElement("div")).className="wtSpreader",c&&c.insertBefore(o,e),o.appendChild(e)),o.style.position="relative",o}},{key:"createHider",value:function(e){var o,c=e.parentNode;return c&&c.nodeType===Node.ELEMENT_NODE&&Object(l.hasClass)(c,"wtHolder")||((o=this.wot.rootDocument.createElement("div")).className="wtHider",c&&c.insertBefore(o,e),o.appendChild(e)),o}},{key:"createHolder",value:function(e){var o,c=e.parentNode;return c&&c.nodeType===Node.ELEMENT_NODE&&Object(l.hasClass)(c,"wtHolder")||((o=this.wot.rootDocument.createElement("div")).style.position="relative",o.className="wtHolder",c&&c.insertBefore(o,e),o.appendChild(e)),o}},{key:"draw",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],o=this.wot,c=o.getSetting("totalRows"),h=o.getSetting("totalColumns"),d=o.getSetting("rowHeaders"),p=d.length,A=o.getSetting("columnHeaders"),Q=A.length;if(!e){var ye=c>0?this.getFirstRenderedRow():0,Me=h>0?this.getFirstRenderedColumn():0;this.rowFilter=new de(ye,c,Q),this.columnFilter=new se(Me,h,p),this.is(st.CLONE_BOTTOM)||this.is(st.CLONE_BOTTOM_LEFT_CORNER)?this.tableRenderer.setHeaderContentRenderers(d,[]):this.tableRenderer.setHeaderContentRenderers(d,A),this.is(st.CLONE_BOTTOM)&&this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.adjustColumnHeaderHeights(),this.is(st.CLONE_BOTTOM)&&this.markOversizedRows()}this.refreshSelections(e)}},{key:"markIfOversizedColumnHeader",value:function(e){for(var o,c,h,d=this.columnFilter.renderedToSource(e),p=this.wot.getSetting("columnHeaders").length,A=this.wot.wtSettings.settings.defaultRowHeight,Q=this.wot.getSetting("columnHeaderHeight")||[];p;)p-=1,o=this.wot.columnUtils.getHeaderHeight(p),(c=this.getColumnHeader(d,p))&&(h=Object(l.innerHeight)(c),(!o&&A<h||o<h)&&(this.wot.wtViewport.oversizedColumnHeaders[p]=h),Array.isArray(Q)?Q[p]!==null&&Q[p]!==void 0&&(this.wot.wtViewport.oversizedColumnHeaders[p]=Q[p]):isNaN(Q)||(this.wot.wtViewport.oversizedColumnHeaders[p]=Q),this.wot.wtViewport.oversizedColumnHeaders[p]<(Q[p]||Q)&&(this.wot.wtViewport.oversizedColumnHeaders[p]=Q[p]||Q))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wot,o=this.THEAD.childNodes,c=e.wtViewport.oversizedColumnHeaders,h=0,d=e.getSetting("columnHeaders").length;h<d;h++)if(c[h]){if(!o[h]||o[h].childNodes.length===0)return;o[h].childNodes[0].style.height="".concat(c[h],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wot;if(!e.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),c=0;c<o;c++){var h=this.rowFilter.renderedToSource(c);e.wtViewport.oversizedRows&&e.wtViewport.oversizedRows[h]&&(e.wtViewport.oversizedRows[h]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var o=this.TABLE.querySelectorAll(".".concat(e)),c=0,h=o.length;c<h;c++)Object(l.removeClass)(o[c],e)}},{key:"refreshSelections",value:function(e){var o=this.wot;if(o.selections){var c=Array.isArray(o.selections)?o.selections:o.selections.getAll(),h=c.length;if(e){for(var d=new Set,p=o.getSetting("onBeforeRemoveCellClassNames"),A=0;A<h;A++){var Q=c[A].settings,ye=Q.highlightHeaderClassName,Me=Q.highlightRowClassName,Be=Q.highlightColumnClassName;c[A].classNames.forEach(d.add,d),ye&&d.add(ye),Me&&d.add(Me),Be&&d.add(Be)}Array.isArray(p)&&p.forEach(d.add,d),d.forEach(this.removeClassFromCells,this)}var xe=this.getRenderedRowsCount(),nt=this.getRenderedColumnsCount(),qe=this.getFirstRenderedRow(),mt=this.getFirstRenderedColumn(),xt=this.getLastRenderedRow(),jt=this.getLastRenderedColumn(),Zt=[];(this.is(st.CLONE_LEFT)||this.is(st.CLONE_TOP_LEFT_CORNER)||this.is(st.CLONE_BOTTOM_LEFT_CORNER))&&(jt+=1),(this.is(st.CLONE_TOP)||this.is(st.CLONE_TOP_LEFT_CORNER))&&(xt+=1),(this.is(st.CLONE_BOTTOM)||this.is(st.CLONE_BOTTOM_LEFT_CORNER))&&(qe-=1);for(var Lt=0;Lt<h;Lt++){var Tt=c[Lt].draw(o,xe,nt,qe,mt,xt,jt);Tt&&Zt.push(Tt)}this.wot.getSetting("columnHeaders"),this.borderRenderer.render(this.TABLE,this.createBorderPaddingObject(),Zt)}}},{key:"getCell",value:function(e){var o,c=e.row,h=e.col,d=this.wot.getSetting("onModifyGetCellCoords",c,h);if(d&&Array.isArray(d)){var p=Fr(d,2);c=p[0],h=p[1]}if(this.isRowBeforeRenderedRows(c))return-1;if(this.isRowAfterRenderedRows(c))return-2;if(this.isColumnBeforeRenderedColumns(h))return-3;if(this.isColumnAfterRenderedColumns(h))return-4;if(!(o=c<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(c)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(c)])&&c>=0)throw new Error("TR was expected to be rendered but is not");var A=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(h)];if(!A&&h>=0)throw new Error("TD or TH was expected to be rendered but is not");return A}},{key:"getColumnHeader",value:function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=this.THEAD.childNodes[o];if(c)return c.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getRowHeader",value:function(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return null;var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return o?o.childNodes[0]:void 0}},{key:"getCoords",value:function(e){var o=e;if(o.nodeName!=="TD"&&o.nodeName!=="TH"&&(o=Object(l.closest)(o,["TD","TH"])),o===null)return null;var c=o.parentNode,h=c.parentNode,d=Object(l.index)(c),p=o.cellIndex;return Object(l.overlayContainsElement)(st.CLONE_TOP_LEFT_CORNER,o,this.wtRootElement)||Object(l.overlayContainsElement)(st.CLONE_TOP,o,this.wtRootElement)?h.nodeName==="THEAD"&&(d-=h.childNodes.length):d=Object(l.overlayContainsElement)(st.CLONE_BOTTOM_LEFT_CORNER,o,this.wtRootElement)||Object(l.overlayContainsElement)(st.CLONE_BOTTOM,o,this.wtRootElement)?this.wot.getSetting("totalRows")-h.childNodes.length+d:h===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(d):this.rowFilter.renderedToSource(d),p=Object(l.overlayContainsElement)(st.CLONE_TOP_LEFT_CORNER,o,this.wtRootElement)||Object(l.overlayContainsElement)(st.CLONE_LEFT,o,this.wtRootElement)||Object(l.overlayContainsElement)(st.CLONE_BOTTOM_LEFT_CORNER,o,this.wtRootElement)?this.columnFilter.offsettedTH(p):this.columnFilter.visibleRowHeadedColumnToSourceColumn(p),new P(d,p)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var e,o,c,h,d,p=this.TBODY.childNodes.length,A=p*this.wot.wtSettings.settings.defaultRowHeight,Q=Object(l.innerHeight)(this.TBODY)-1,ye=this.isMaster?this.wot.rowUtils:this.wot.overlay.master.rowUtils;if(A!==Q||this.wot.getSetting("fixedRowsBottom"))for(;p;)p-=1,c=this.rowFilter.renderedToSource(p),e=ye.getHeight(c),o=(d=(h=this.getTrForRow(c)).querySelector("th"))?Object(l.innerHeight)(d):Object(l.innerHeight)(h)-1,(!e&&this.wot.wtSettings.settings.defaultRowHeight<o||e<o)&&(o+=1,this.wot.wtViewport.oversizedRows[c]=o)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderLevelRendered",value:function(e){return e>this.wot.getSetting("columnHeaders").length-1}},{key:"isRowHeaderLevelRendered",value:function(e){return e>this.wot.getSetting("rowHeaders").length-1}},{key:"isRowBeforeRenderedRows",value:function(e){var o=this.getFirstRenderedRow();return e<0&&(e=0),o===-1||e<o}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(e){if(e<0){var o=this.wot.getSetting("columnHeaders").length+e;return this.isColumnHeaderLevelRendered(o)}return e>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isColumnBeforeRenderedColumns",value:function(e){var o=this.getFirstRenderedColumn();return e<0&&(e=0),o===-1||e<o}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isColumnAfterRenderedColumns",value:function(e){if(e<0){var o=this.wot.getSetting("rowHeaders").length+e;return this.isRowHeaderLevelRendered(o)}return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function(){return Object(l.isVisible)(this.TABLE)}}])&&Jn(t.prototype,n),r&&Jn(t,r),a}(),yr={getFirstRenderedRow:function(){var a=this.wot.wtViewport.rowsRenderCalculator.startRow;return a===null?-1:a},getFirstVisibleRow:function(){var a=this.wot.wtViewport.rowsVisibleCalculator.startRow;return a===null?-1:a},getLastRenderedRow:function(){var a=this.wot.wtViewport.rowsRenderCalculator.endRow;return a===null?-1:a},getLastVisibleRow:function(){var a=this.wot.wtViewport.rowsVisibleCalculator.endRow;return a===null?-1:a},getRenderedRowsCount:function(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}};Object(g.defineGetter)(yr,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var br=yr,wr={getFirstRenderedColumn:function(){var a=this.wot.wtViewport.columnsRenderCalculator.startColumn;return a===null?-1:a},getFirstVisibleColumn:function(){var a=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return a===null?-1:a},getLastRenderedColumn:function(){var a=this.wot.wtViewport.columnsRenderCalculator.endColumn;return a===null?-1:a},getLastVisibleColumn:function(){var a=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return a===null?-1:a},getRenderedColumnsCount:function(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}};Object(g.defineGetter)(wr,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var Cr=wr;function Kn(a){return(Kn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function Tn(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Nr(a,t){return(Nr=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function Vr(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=In(a);if(t){var e=In(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return Wr(this,n)}}function Wr(a,t){return!t||Kn(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function In(a){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var xn=function(a){(function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),h&&Nr(c,h)})(o,a);var t,n,r,e=Vr(o);function o(c,h){var d;return function(p,A){if(!(p instanceof A))throw new TypeError("Cannot call a class as a function")}(this,o),(d=e.call(this,c,h)).holderOffset=0,d.wtRootElement.className+="ht_master handsontable",d.trimmingContainer=null,d.alignOverlaysWithTrimmingContainer(),d}return t=o,(n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){this.trimmingContainer=Object(l.getTrimmingContainer)(this.wtRootElement);var c=this.trimmingContainer,h=this.wot.rootWindow;if(c===h)this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{c.parentElement;var d=Object(l.getStyle)(c,"height",h),p=(Object(l.getStyle)(c,"overflow",h),this.holder.style),A=Object(l.getBoundingClientRect)(c),Q=A.width,ye=A.height;ye=Math.min(ye,Object(l.scrollHeight)(c)),p.height=d==="auto"?"auto":"".concat(ye,"px"),Q=Math.min(Q,Object(l.scrollWidth)(c)),p.width="".concat(Q,"px"),p.overflow="",this.hasTableHeight=p.height==="auto"||ye>0,this.hasTableWidth=Q>0}}},{key:"markOversizedColumnHeaders",value:function(){var c=this.wot,h=c.getSetting("columnHeaders").length;if(h&&!c.wtViewport.hasOversizedColumnHeadersMarked){for(var d=c.getSetting("rowHeaders").length,p=this.getRenderedColumnsCount(),A=0;A<h;A++)for(var Q=-1*d;Q<p;Q++)this.markIfOversizedColumnHeader(Q);c.wtViewport.hasOversizedColumnHeadersMarked=!0}}},{key:"draw",value:function(){var c=arguments.length>0&&arguments[0]!==void 0&&arguments[0],h=this.wot,d=h.wtOverlays,p=h.wtViewport,A=h.getSetting("totalRows"),Q=h.getSetting("totalColumns"),ye=h.getSetting("rowHeaders"),Me=ye.length,Be=h.getSetting("columnHeaders"),xe=Be.length,nt=c;if(this.holderOffset=Object(l.offset)(this.holder),nt=p.createRenderCalculators(nt))p.createVisibleCalculators(),d.refreshClones(!0),this.refreshSelections(!0);else{var qe=A>0?this.getFirstRenderedRow():0,mt=Q>0?this.getFirstRenderedColumn():0;this.rowFilter=new de(qe,A,xe),this.columnFilter=new se(mt,Q,Me),this.alignOverlaysWithTrimmingContainer();var xt={};this.wot.getSetting("beforeDraw",!0,xt);var jt=xt.skipRender!==!0;jt&&(this.tableRenderer.setHeaderContentRenderers(ye,Be),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),p.getWorkspaceWidth(),p.containerWidth=null,this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),this.markOversizedRows(),p.createVisibleCalculators(),d.refreshClones(!1),this.refreshSelections(!1),this.wot.getSetting("onDraw",!0))}}}])&&Tn(t.prototype,n),r&&Tn(t,r),o}(Xn);Object(g.mixin)(xn,br),Object(g.mixin)(xn,Cr);var _r=xn,Hr={getFirstRenderedColumn:function(){return this.wot.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var a=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),a)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Object(g.defineGetter)(Hr,"MIXIN_NAME","stickyColumnsLeft",{writable:!1,enumerable:!1});var Or=Hr;function Er(a){return(Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function Ir(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function xr(a,t){return(xr=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function Lr(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=Sr(a);if(t){var e=Sr(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return Pr(this,n)}}function Pr(a,t){return!t||Er(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function Sr(a){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var hn=function(a){(function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&xr(r,e)})(n,a);var t=Lr(n);function n(){return Ir(this,n),t.apply(this,arguments)}return n}(Xn);Object(g.mixin)(hn,br),Object(g.mixin)(hn,Or);var er=hn;function vn(a){return(vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function Ln(a,t,n){return(Ln=tr()?Reflect.construct:function(r,e,o){var c=[null];c.push.apply(c,e);var h=new(Function.bind.apply(r,c));return o&&Nn(h,o.prototype),h}).apply(null,arguments)}function Pn(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function Nn(a,t){return(Nn=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function or(a,t){return!t||vn(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function tr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function Wn(a){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Ur=function(a){(function(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),p&&Nn(d,p)})(h,a);var t,n,r,e,o,c=(t=h,n=tr(),function(){var d,p=Wn(t);if(n){var A=Wn(this).constructor;d=Reflect.construct(p,arguments,A)}else d=p.apply(this,arguments);return or(this,d)});function h(d){var p;return function(A,Q){if(!(A instanceof Q))throw new TypeError("Cannot call a class as a function")}(this,h),(p=c.call(this,d)).clone=p.makeClone(st.CLONE_LEFT),p.updateStateOfRendering(),p}return r=h,(e=[{key:"createTable",value:function(){for(var d=arguments.length,p=new Array(d),A=0;A<d;A++)p[A]=arguments[A];return Ln(er,p)}},{key:"shouldBeRendered",value:function(){return!(!this.master.getSetting("fixedColumnsLeft")&&!this.master.getSetting("rowHeaders").length)}},{key:"adjustElementsPosition",value:function(){var d=this.master,p=d.getSetting("totalColumns");if(typeof d.wtViewport.columnsRenderCalculator.startPosition=="number")d.wtTable.spreader.style.left="".concat(d.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(p!==0)throw new Error("Incorrect value of the columnsRenderCalculator");d.wtTable.spreader.style.left="0"}if(d.wtTable.spreader.style.right="",this.needFullRender&&(typeof d.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(d.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""),this.needFullRender&&d.wtTable.holder.parentNode){var A=this.clone.wtTable.wtRootElement,Q=d.getSetting("preventOverflow");if(d.wtTable.trimmingContainer!==d.rootWindow||Q&&Q==="horizontal")Object(l.resetCssTransform)(A);else{var ye,Me,Be=Object(l.getBoundingClientRect)(d.wtTable.hider),xe=Math.ceil(Be.left),nt=Math.ceil(Be.right);Me=(Me=d.wtTable.hider.style.top)===""?0:Me,ye=xe<0&&nt-Object(l.offsetWidth)(A)>0?-xe:0,ye+="px",Object(l.setOverlayPosition)(A,ye,Me)}var qe=d.wtTable.wtRootElement;d.getSetting("totalRows")?Object(l.removeClass)(qe,"emptyRows"):Object(l.addClass)(qe,"emptyRows")}}},{key:"setScrollPosition",value:function(d){var p=this.master.rootWindow,A=!1;return this.mainTableScrollableElement===p&&p.scrollX!==d?(p.scrollTo(d,Object(l.getWindowScrollTop)(p)),A=!0):this.mainTableScrollableElement.scrollLeft!==d&&(this.mainTableScrollableElement.scrollLeft=d,A=!0),A}},{key:"onScroll",value:function(){this.master.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(d,p){for(var A=this.master.wtSettings.defaultColumnWidth,Q=d,ye=0;Q<p;)ye+=this.master.columnUtils.getStretchedColumnWidth(Q)||A,Q+=1;return ye}},{key:"adjustElementsSize",value:function(){var d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||d){var p=this.clone,A=this.master,Q=p.wtTable.wtRootElement,ye=Q.style,Me=A.getSetting("preventOverflow");if(A.wtTable.trimmingContainer!==A.rootWindow||Me==="vertical"){var Be=A.wtViewport.getWorkspaceHeight();A.wtOverlays.hasScrollbarBottom&&(Be-=Object(l.getScrollbarWidth)(A.rootDocument)),Be=Math.min(Be,Object(l.scrollHeight)(A.wtTable.wtRootElement)),ye.height="".concat(Be,"px")}else ye.height="";var xe=Object(l.outerWidth)(p.wtTable.TABLE);ye.width="".concat(xe,"px"),p.wtTable.hider.style.height=A.wtTable.hider.style.height,p.wtTable.holder.style.height=ye.height,p.wtTable.holder.style.width=ye.width,d||(this.areElementSizesAdjusted=!0)}}},{key:"scrollTo",value:function(d,p){var A=this.master,Q=this.getTableParentOffset(),ye=A.wtTable.holder,Me=0;return p&&Object(l.offsetWidth)(ye)!==Object(l.clientWidth)(ye)&&(Me=Object(l.getScrollbarWidth)(A.rootDocument)),p?(Q+=this.sumCellSizes(0,d+1),Q-=A.wtViewport.getViewportWidth()):Q+=this.sumCellSizes(A.getSetting("fixedColumnsLeft"),d),Q+=Me,this.setScrollPosition(Q)}},{key:"getTableParentOffset",value:function(){var d=0;return this.master.getSetting("preventOverflow")||this.master.wtTable.trimmingContainer!==this.master.rootWindow||(d=this.master.wtTable.holderOffset.left),d}},{key:"getScrollPosition",value:function(){return Object(l.getScrollLeft)(this.mainTableScrollableElement,this.master.rootWindow)}}])&&Pn(r.prototype,e),o&&Pn(r,o),h}(st);st.registerOverlay(st.CLONE_LEFT,Ur);var hr={getFirstRenderedRow:function(){return this.wot.getSetting("totalRows")===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var a=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),a)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(g.defineGetter)(hr,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var dr=hr;function Rr(a){return(Rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function Wo(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function ao(a,t){return(ao=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function Uo(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=zr(a);if(t){var e=zr(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return zo(this,n)}}function zo(a,t){return!t||Rr(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function zr(a){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Gr=function(a){(function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&ao(r,e)})(n,a);var t=Uo(n);function n(){return Wo(this,n),t.apply(this,arguments)}return n}(Xn);Object(g.mixin)(Gr,dr),Object(g.mixin)(Gr,Cr);var Go=Gr;function so(a){return(so=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function lo(a,t,n){return(lo=fo()?Reflect.construct:function(r,e,o){var c=[null];c.push.apply(c,e);var h=new(Function.bind.apply(r,c));return o&&Xr(h,o.prototype),h}).apply(null,arguments)}function uo(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function co(a,t,n){return(co=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(r,e,o){var c=function(d,p){for(;!Object.prototype.hasOwnProperty.call(d,p)&&(d=Tr(d))!==null;);return d}(r,e);if(c){var h=Object.getOwnPropertyDescriptor(c,e);return h.get?h.get.call(o):h.value}})(a,t,n||a)}function Xr(a,t){return(Xr=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function Xo(a,t){return!t||so(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function fo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function Tr(a){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Ko=function(a){(function(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),p&&Xr(d,p)})(h,a);var t,n,r,e,o,c=(t=h,n=fo(),function(){var d,p=Tr(t);if(n){var A=Tr(this).constructor;d=Reflect.construct(p,arguments,A)}else d=p.apply(this,arguments);return Xo(this,d)});function h(d){var p;return function(A,Q){if(!(A instanceof Q))throw new TypeError("Cannot call a class as a function")}(this,h),(p=c.call(this,d)).clone=p.makeClone(st.CLONE_TOP),p.updateStateOfRendering(),p}return r=h,(e=[{key:"createTable",value:function(){for(var d=arguments.length,p=new Array(d),A=0;A<d;A++)p[A]=arguments[A];return lo(Go,p)}},{key:"shouldBeRendered",value:function(){return!(!this.master.getSetting("fixedRowsTop")&&!this.master.getSetting("columnHeaders").length)}},{key:"adjustElementsPosition",value:function(){var d=this.master,p=d.getSetting("totalRows");if(typeof d.wtViewport.rowsRenderCalculator.startPosition=="number")d.wtTable.spreader.style.top="".concat(d.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(p!==0)throw new Error("Incorrect value of the rowsRenderCalculator");d.wtTable.spreader.style.top="0"}if(d.wtTable.spreader.style.bottom="",this.needFullRender&&(typeof d.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(d.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""),this.needFullRender&&d.wtTable.holder.parentNode){var A=this.clone.wtTable.wtRootElement,Q=d.getSetting("preventOverflow");if(d.wtTable.trimmingContainer!==d.rootWindow||Q&&Q==="vertical")Object(l.resetCssTransform)(A);else{var ye,Me,Be=Object(l.getBoundingClientRect)(d.wtTable.hider),xe=Math.ceil(Be.top),nt=Math.ceil(Be.bottom);ye=(ye=d.wtTable.hider.style.left)===""?0:ye,Me=xe<0&&nt-Object(l.offsetHeight)(A)>0?-xe:0,Me+="px",Object(l.setOverlayPosition)(A,ye,Me)}}}},{key:"setScrollPosition",value:function(d){var p=this.master.rootWindow,A=!1;return this.mainTableScrollableElement===p&&p.scrollY!==d?(p.scrollTo(Object(l.getWindowScrollLeft)(p),d),A=!0):this.mainTableScrollableElement.scrollTop!==d&&(this.mainTableScrollableElement.scrollTop=d,A=!0),A}},{key:"onScroll",value:function(){this.master.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(d,p){for(var A=this.master.wtSettings.settings.defaultRowHeight,Q=d,ye=0;Q<p;){var Me=this.master.rowUtils.getHeight(Q);ye+=Me===void 0?A:Me,Q+=1}return ye}},{key:"adjustElementsSize",value:function(){var d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||d){var p=this.clone,A=this.master,Q=p.wtTable.wtRootElement,ye=Q.style,Me=A.getSetting("preventOverflow");if(A.wtTable.trimmingContainer!==A.rootWindow||Me==="horizontal"){var Be=A.wtViewport.getWorkspaceWidth();A.wtOverlays.hasScrollbarRight&&(Be-=Object(l.getScrollbarWidth)(A.rootDocument)),Be=Math.min(Be,Object(l.scrollWidth)(A.wtTable.wtRootElement)),ye.width="".concat(Be,"px")}else ye.width="";var xe=Object(l.outerHeight)(p.wtTable.TABLE);A.wtTable.hasDefinedSize()||(xe=0),ye.height="".concat(xe,"px"),p.wtTable.hider.style.width=A.wtTable.hider.style.width,p.wtTable.holder.style.width=ye.width,p.wtTable.holder.style.height=ye.height,d||(this.areElementSizesAdjusted=!0)}}},{key:"scrollTo",value:function(d,p){var A=this.master,Q=A.wtTable.holder,ye=this.getTableParentOffset(),Me=0;if(p&&Object(l.offsetHeight)(Q)!==Object(l.clientHeight)(Q)&&(Me=Object(l.getScrollbarWidth)(A.rootDocument)),p){var Be=A.getSetting("fixedRowsBottom"),xe=A.getSetting("totalRows");ye+=this.sumCellSizes(0,d+1),ye-=A.wtViewport.getViewportHeight()-this.sumCellSizes(xe-Be,xe),ye+=1}else ye+=this.sumCellSizes(A.getSetting("fixedRowsTop"),d);return ye+=Me,this.setScrollPosition(ye)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.master.rootWindow?this.master.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(l.getScrollTop)(this.mainTableScrollableElement,this.master.rootWindow)}},{key:"redrawSelectionBorders",value:function(d){if(d&&d.cellRange&&d.hasSelectionHandle()){var p=d.getSelectionHandle(this.master),A=d.getCorners();p.disappear(),p.appear(A)}}},{key:"redrawAllSelectionsBorders",value:function(){var d=this,p=this.master.selections;this.redrawSelectionBorders(p.getCell()),Object(E.arrayEach)(p.getAreas(),function(A){d.redrawSelectionBorders(A)}),this.redrawSelectionBorders(p.getFill()),this.master.wtOverlays.leftOverlay.redrawClone()}},{key:"redrawClone",value:function(){var d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(co(Tr(h.prototype),"redrawClone",this).call(this,d),!d&&this.master.getSetting("rowHeaders").length===0){var p=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(p)for(var A=0;A<p.length;A++)p[A].style["border-left-width"]=0}}}])&&uo(r.prototype,e),o&&uo(r,o),h}(st);st.registerOverlay(st.CLONE_TOP,Ko);function ho(a){return(ho=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function Yo(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function go(a,t){return(go=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function qo(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=Kr(a);if(t){var e=Kr(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return $o(this,n)}}function $o(a,t){return!t||ho(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function Kr(a){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Yr=function(a){(function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&go(r,e)})(n,a);var t=qo(n);function n(){return Yo(this,n),t.apply(this,arguments)}return n}(Xn);Object(g.mixin)(Yr,dr),Object(g.mixin)(Yr,Or);var Qo=Yr;function mo(a){return(mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function po(a,t,n){return(po=yo()?Reflect.construct:function(r,e,o){var c=[null];c.push.apply(c,e);var h=new(Function.bind.apply(r,c));return o&&qr(h,o.prototype),h}).apply(null,arguments)}function vo(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function qr(a,t){return(qr=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function Zo(a,t){return!t||mo(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function yo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function $r(a){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Jo=function(a){(function(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),p&&qr(d,p)})(h,a);var t,n,r,e,o,c=(t=h,n=yo(),function(){var d,p=$r(t);if(n){var A=$r(this).constructor;d=Reflect.construct(p,arguments,A)}else d=p.apply(this,arguments);return Zo(this,d)});function h(d){var p;return function(A,Q){if(!(A instanceof Q))throw new TypeError("Cannot call a class as a function")}(this,h),(p=c.call(this,d)).clone=p.makeClone(st.CLONE_TOP_LEFT_CORNER),p.updateStateOfRendering(),p}return r=h,(e=[{key:"createTable",value:function(){for(var d=arguments.length,p=new Array(d),A=0;A<d;A++)p[A]=arguments[A];return po(Qo,p)}},{key:"shouldBeRendered",value:function(){var d=this.master;return!(!d.getSetting("fixedRowsTop")&&!d.getSetting("columnHeaders").length||!d.getSetting("fixedColumnsLeft")&&!d.getSetting("rowHeaders").length)}},{key:"adjustElementsPosition",value:function(){var d=this.clone,p=this.master;if(p.wtTable.holder.parentNode){var A=d.wtTable.wtRootElement,Q=p.getSetting("preventOverflow");if(p.wtTable.trimmingContainer===p.rootWindow){var ye=Object(l.getBoundingClientRect)(p.wtTable.hider),Me=Math.ceil(ye.top),Be=Math.ceil(ye.left),xe=Math.ceil(ye.bottom),nt=Math.ceil(ye.right),qe="0",mt="0";Q&&Q!=="vertical"||Be<0&&nt-Object(l.offsetWidth)(A)>0&&(qe="".concat(-Be,"px")),Q&&Q!=="horizontal"||Me<0&&xe-Object(l.offsetHeight)(A)>0&&(mt="".concat(-Me,"px")),Object(l.setOverlayPosition)(A,qe,mt)}else Object(l.resetCssTransform)(A)}}},{key:"adjustElementsSize",value:function(){var d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||d){var p=this.clone,A=this.master,Q=Object(l.outerHeight)(p.wtTable.TABLE),ye=Object(l.outerWidth)(p.wtTable.TABLE),Me=p.wtTable.wtRootElement;A.wtTable.hasDefinedSize()||(Q=0),Me.style.height="".concat(Q,"px"),Me.style.width="".concat(ye,"px")}}}])&&vo(r.prototype,e),o&&vo(r,o),h}(st);st.registerOverlay(st.CLONE_TOP_LEFT_CORNER,Jo);var bo={getFirstRenderedRow:function(){var a=this.wot.getSetting("totalRows"),t=this.wot.getSetting("fixedRowsBottom"),n=a-t;return a===0||t===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var a=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),a)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(g.defineGetter)(bo,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var wo=bo;function Co(a){return(Co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function ei(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Oo(a,t){return(Oo=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function ti(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=Qr(a);if(t){var e=Qr(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return ni(this,n)}}function ni(a,t){return!t||Co(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function Qr(a){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var Zr=function(a){(function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&Oo(r,e)})(n,a);var t=ti(n);function n(){return ei(this,n),t.apply(this,arguments)}return n}(Xn);Object(g.mixin)(Zr,wo),Object(g.mixin)(Zr,Cr);var ri=Zr;function Eo(a){return(Eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function So(a,t,n){return(So=ko()?Reflect.construct:function(r,e,o){var c=[null];c.push.apply(c,e);var h=new(Function.bind.apply(r,c));return o&&Jr(h,o.prototype),h}).apply(null,arguments)}function Ro(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function To(a,t,n){return(To=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(r,e,o){var c=function(d,p){for(;!Object.prototype.hasOwnProperty.call(d,p)&&(d=kr(d))!==null;);return d}(r,e);if(c){var h=Object.getOwnPropertyDescriptor(c,e);return h.get?h.get.call(o):h.value}})(a,t,n||a)}function Jr(a,t){return(Jr=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function oi(a,t){return!t||Eo(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function ko(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function kr(a){return(kr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var ii=function(a){(function(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),p&&Jr(d,p)})(h,a);var t,n,r,e,o,c=(t=h,n=ko(),function(){var d,p=kr(t);if(n){var A=kr(this).constructor;d=Reflect.construct(p,arguments,A)}else d=p.apply(this,arguments);return oi(this,d)});function h(d){var p;return function(A,Q){if(!(A instanceof Q))throw new TypeError("Cannot call a class as a function")}(this,h),(p=c.call(this,d)).clone=p.makeClone(st.CLONE_BOTTOM),p.updateStateOfRendering(),p}return r=h,(e=[{key:"createTable",value:function(){for(var d=arguments.length,p=new Array(d),A=0;A<d;A++)p[A]=arguments[A];return So(ri,p)}},{key:"shouldBeRendered",value:function(){return!!this.master.getSetting("fixedRowsBottom")}},{key:"adjustElementsPosition",value:function(){var d=this.master,p=d.getSetting("totalRows");if(typeof d.wtViewport.rowsRenderCalculator.startPosition=="number")d.wtTable.spreader.style.top="".concat(d.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(p!==0)throw new Error("Incorrect value of the rowsRenderCalculator");d.wtTable.spreader.style.top="0"}if(d.wtTable.spreader.style.bottom="",this.needFullRender&&(typeof d.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(d.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""),this.needFullRender&&d.wtTable.holder.parentNode){var A=this.clone.wtTable.wtRootElement,Q=d.getSetting("preventOverflow");if(A.style.top="",d.wtTable.trimmingContainer!==d.rootWindow||Q&&Q==="vertical"){Object(l.resetCssTransform)(A);var ye=Object(l.getScrollbarWidth)(d.rootDocument);Object(l.clientHeight)(d.wtTable.holder)===Object(l.offsetHeight)(d.wtTable.holder)&&(ye=0),A.style.top="",A.style.bottom="".concat(ye,"px")}else{var Me,Be,xe=Object(l.getBoundingClientRect)(d.wtTable.hider),nt=Math.ceil(xe.bottom),qe=Object(l.offsetHeight)(d.rootDocument.body);Me=(Me=d.wtTable.hider.style.left)===""?0:Me,Be=nt>qe?nt-qe:0,Be+="px",A.style.top="",A.style.left=Me,A.style.bottom=Be}}}},{key:"setScrollPosition",value:function(d){var p=this.master,A=!1;return this.mainTableScrollableElement===p.rootWindow?(p.rootWindow.scrollTo(Object(l.getWindowScrollLeft)(p.rootWindow),d),A=!0):this.mainTableScrollableElement.scrollTop!==d&&(this.mainTableScrollableElement.scrollTop=d,A=!0),A}},{key:"onScroll",value:function(){this.master.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(d,p){for(var A=this.master,Q=A.wtSettings.settings.defaultRowHeight,ye=d,Me=0;ye<p;){var Be=A.rowUtils.getHeight(ye);Me+=Be===void 0?Q:Be,ye+=1}return Me}},{key:"adjustElementsSize",value:function(){var d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||d){var p=this.clone,A=this.master,Q=p.wtTable.wtRootElement,ye=Q.style,Me=A.getSetting("preventOverflow");if(A.wtTable.trimmingContainer!==A.rootWindow||Me==="horizontal"){var Be=A.wtViewport.getWorkspaceWidth();A.wtOverlays.hasScrollbarRight&&(Be-=Object(l.getScrollbarWidth)(A.rootDocument)),Be=Math.min(Be,Object(l.scrollWidth)(A.wtTable.wtRootElement)),ye.width="".concat(Be,"px")}else ye.width="";var xe=Object(l.outerHeight)(p.wtTable.TABLE);A.wtTable.hasDefinedSize()||(xe=0),ye.height="".concat(xe,"px"),p.wtTable.hider.style.width=this.master.wtTable.hider.style.width,p.wtTable.holder.style.width=ye.width,p.wtTable.holder.style.height=ye.height,d||(this.areElementSizesAdjusted=!0)}}},{key:"scrollTo",value:function(d,p){var A=this.master,Q=this.getTableParentOffset(),ye=A.wtTable.holder,Me=0;p&&Object(l.offsetHeight)(ye)!==Object(l.clientHeight)(ye)&&(Me=Object(l.getScrollbarWidth)(A.rootDocument)),p?(Q+=this.sumCellSizes(0,d+1),Q-=A.wtViewport.getViewportHeight(),Q+=1):Q+=this.sumCellSizes(A.getSetting("fixedRowsBottom"),d),Q+=Me,this.setScrollPosition(Q)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.master.rootWindow?this.master.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(l.getScrollTop)(this.mainTableScrollableElement,this.master.rootWindow)}},{key:"redrawClone",value:function(){var d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(To(kr(h.prototype),"redrawClone",this).call(this,d),!d&&this.master.getSetting("rowHeaders").length===0){var p=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");p&&(p.style["border-left-width"]=0)}}}])&&Ro(r.prototype,e),o&&Ro(r,o),h}(st);st.registerOverlay(st.CLONE_BOTTOM,ii);function jo(a){return(jo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function ai(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Mo(a,t){return(Mo=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function si(a){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var n,r=eo(a);if(t){var e=eo(this).constructor;n=Reflect.construct(r,arguments,e)}else n=r.apply(this,arguments);return li(this,n)}}function li(a,t){return!t||jo(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function eo(a){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var to=function(a){(function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&Mo(r,e)})(n,a);var t=si(n);function n(){return ai(this,n),t.apply(this,arguments)}return n}(Xn);Object(g.mixin)(to,wo),Object(g.mixin)(to,Or);var ui=to;function Ao(a){return(Ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function No(a,t,n){return(No=Ho()?Reflect.construct:function(r,e,o){var c=[null];c.push.apply(c,e);var h=new(Function.bind.apply(r,c));return o&&no(h,o.prototype),h}).apply(null,arguments)}function _o(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function no(a,t){return(no=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(a,t)}function ci(a,t){return!t||Ao(t)!=="object"&&typeof t!="function"?function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(a):t}function Ho(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function ro(a){return(ro=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(a)}var fi=function(a){(function(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(p&&p.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),p&&no(d,p)})(h,a);var t,n,r,e,o,c=(t=h,n=Ho(),function(){var d,p=ro(t);if(n){var A=ro(this).constructor;d=Reflect.construct(p,arguments,A)}else d=p.apply(this,arguments);return ci(this,d)});function h(d){var p;return function(A,Q){if(!(A instanceof Q))throw new TypeError("Cannot call a class as a function")}(this,h),(p=c.call(this,d)).clone=p.makeClone(st.CLONE_BOTTOM_LEFT_CORNER),p.updateStateOfRendering(),p}return r=h,(e=[{key:"createTable",value:function(){for(var d=arguments.length,p=new Array(d),A=0;A<d;A++)p[A]=arguments[A];return No(ui,p)}},{key:"shouldBeRendered",value:function(){var d=this.master;return!(!d.getSetting("fixedRowsBottom")||!d.getSetting("fixedColumnsLeft")&&!d.getSetting("rowHeaders").length)}},{key:"adjustElementsPosition",value:function(){var d=this.clone,p=this.master;if(p.wtTable.holder.parentNode){var A=d.wtTable.wtRootElement;if(A.style.top="",p.wtTable.trimmingContainer===p.rootWindow){var Q,ye,Me=Object(l.getBoundingClientRect)(p.wtTable.hider),Be=Math.ceil(Me.bottom),xe=Math.ceil(Me.left),nt=Object(l.offsetHeight)(p.rootDocument.body);Q=xe<0?-xe:0,ye=Be>nt?Be-nt:0,ye+="px",Q+="px",A.style.top="",A.style.left=Q,A.style.bottom=ye}else{Object(l.resetCssTransform)(A);var qe=Object(l.getScrollbarWidth)(p.rootDocument);Object(l.clientHeight)(p.wtTable.holder)===Object(l.offsetHeight)(p.wtTable.holder)&&(qe=0),A.style.top="",A.style.bottom="".concat(qe,"px")}}}},{key:"adjustElementsSize",value:function(){var d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||d){var p=this.clone,A=this.master,Q=Object(l.outerHeight)(p.wtTable.TABLE),ye=Object(l.outerWidth)(p.wtTable.TABLE),Me=p.wtTable.wtRootElement;A.wtTable.hasDefinedSize()||(Q=0),Me.style.height="".concat(Q,"px"),Me.style.width="".concat(ye,"px")}}}])&&_o(r.prototype,e),o&&_o(r,o),h}(st);st.registerOverlay(st.CLONE_BOTTOM_LEFT_CORNER,fi);var hi=i(184);function oo(a,t){return function(n){if(Array.isArray(n))return n}(a)||function(n,r){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var e=[],o=!0,c=!1,h=void 0;try{for(var d,p=n[Symbol.iterator]();!(o=(d=p.next()).done)&&(e.push(d.value),!r||e.length!==r);o=!0);}catch(A){c=!0,h=A}finally{try{o||p.return==null||p.return()}finally{if(c)throw h}}return e}}(a,t)||function(n,r){if(!!n){if(typeof n=="string")return Io(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Io(n,r)}}(a,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Io(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}function xo(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var di=function(){function a(e,o){(function(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")})(this,a),o&&(this.eventManager=new en.a(e),this.wot=e,this.settings=o,this.mouseDown=!1,this.main=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createElements(o),this.registerListeners())}var t,n,r;return t=a,(n=[{key:"registerListeners",value:function(){var e=this,o=this.wot.rootDocument.body;this.eventManager.addEventListener(o,"mousedown",function(){return e.onMouseDown()}),this.eventManager.addEventListener(o,"mouseup",function(){return e.onMouseUp()});for(var c=function(p,A){e.eventManager.addEventListener(e.main.childNodes[p],"mouseenter",function(Q){return e.onMouseEnter(Q,e.main.childNodes[p])})},h=0,d=this.main.childNodes.length;h<d;h++)c(h)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,o){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),Object(hi.stopImmediatePropagation)(e);var c=this,h=this.wot.rootDocument.body,d=Object(l.getBoundingClientRect)(o);o.style.display="none",this.eventManager.addEventListener(h,"mousemove",function p(A){var Q;((Q=A).clientY<Math.floor(d.top)||Q.clientY>Math.ceil(d.top+d.height)||Q.clientX<Math.floor(d.left)||Q.clientX>Math.ceil(d.left+d.width))&&(c.eventManager.removeEventListener(h,"mousemove",p),o.style.display="block")})}}},{key:"createElements",value:function(e){var o=this.wot.rootDocument;this.main=o.createElement("div");var c=this.main.style;c.position="absolute",c.top=0,c.left=0;var h=o.createElement("div");h.className="wtBorder ".concat(this.settings.className||""),(c=h.style).height=this.settings.corner&&this.settings.corner.width?"".concat(this.settings.corner.width,"px"):"".concat(e.border.width,"px"),c.width=this.settings.corner&&this.settings.corner.width?"".concat(this.settings.corner.width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(h),this.corner=h,this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(St.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var d=this.wot.wtTable,p=d.selectionHandlesHolder;p||((p=o.createElement("div")).className="htBorders",d.selectionHandlesHolder=p,d.spreader.appendChild(p)),p.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,o=this.wot.rootDocument;this.selectionHandles={topLeft:o.createElement("DIV"),topLeftHitArea:o.createElement("DIV"),bottomRight:o.createElement("DIV"),bottomRightHitArea:o.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var c={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};Object(g.objectEach)(c,function(d,p){e.selectionHandles.styles.bottomRightHitArea[p]=d,e.selectionHandles.styles.topLeftHitArea[p]=d});var h={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#FFFFFF","border-width":"1px","border-style":"solid"};Object(g.objectEach)(h,function(d,p){e.selectionHandles.styles.bottomRight[p]=d,e.selectionHandles.styles.topLeft[p]=d}),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(e,o){var c=this.wot.selections.createOrGetArea();return!(!c.cellRange||e===c.cellRange.to.row&&o===c.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,o,c,h,d,p){var A=parseInt(this.selectionHandles.styles.topLeft.width,10),Q=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10),ye=this.settings.corner&&this.settings.corner.color?this.settings.corner.color:this.settings.border.color;this.selectionHandles.styles.topLeft.borderColor=ye,this.selectionHandles.styles.bottomRight.borderColor=ye,this.selectionHandles.styles.topLeft.top="".concat(parseInt(c-A,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(h-A,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(c-Q/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(h-Q/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(c+p,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(h+d,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(c+p-Q/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(h+d-Q/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,o)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||o===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var o,c,h,d,p=this.wot,A=p.wtTable,Q=p.rootDocument,ye=p.rootWindow,Me=A.getRenderedRowsCount(),Be=0;Be<Me;Be+=1){var xe=A.rowFilter.renderedToSource(Be);if(xe>=e[0]&&xe<=e[2]){o=xe;break}}for(var nt=Me-1;nt>=0;nt-=1){var qe=A.rowFilter.renderedToSource(nt);if(qe>=e[0]&&qe<=e[2]){c=qe;break}}for(var mt=A.getRenderedColumnsCount(),xt=0;xt<mt;xt+=1){var jt=A.columnFilter.renderedToSource(xt);if(jt>=e[1]&&jt<=e[3]){h=jt;break}}for(var Zt=mt-1;Zt>=0;Zt-=1){var Lt=A.columnFilter.renderedToSource(Zt);if(Lt>=e[1]&&Lt<=e[3]){d=Lt;break}}if(o!==void 0&&h!==void 0){var Tt=A.getCell(new P(o,h)),$t=o!==c||h!==d,Et=$t?A.getCell(new P(c,d)):Tt,Ht=Object(l.offset)(Tt),kn=$t?Object(l.offset)(Et):Ht,Dn=Object(l.offset)(A.TABLE),Bn=Ht.top,Un=Ht.left,gr=Un-Dn.left-1,mr=kn.left+Object(l.outerWidth)(Et)-Un;if(this.isEntireColumnSelected(o,c)){var ir=this.getDimensionsFromHeader("columns",h,d,Dn),Yn=null;if(ir){var jr=oo(ir,3);Yn=jr[0],gr=jr[1],mr=jr[2]}Yn&&(Tt=Yn)}var qn=Bn-Dn.top-1,zn=kn.top+Object(l.outerHeight)(Et)-Bn;if(this.isEntireRowSelected(h,d)){var Dr=this.getDimensionsFromHeader("rows",o,c,Dn),Fn=null;if(Dr){var Vn=oo(Dr,3);Fn=Vn[0],qn=Vn[1],zn=Vn[2]}Fn&&(Tt=Fn)}var nr=this.settings.border.cornerVisible;nr=typeof nr=="function"?nr(this.settings.layerLevel):nr;var pr=this.wot.getSetting("onModifyGetCellCoords",c,d),Bo=c,Fo=d;if(pr&&Array.isArray(pr)){var Vo=oo(pr,4);Bo=Vo[2],Fo=Vo[3]}if(Object(St.isMobileBrowser)()||!nr||this.isPartRange(Bo,Fo))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(qn+zn-4,"px"),this.cornerStyle.left="".concat(gr+mr-4,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.backgroundColor=this.settings.corner&&this.settings.corner.color?this.settings.corner.color:this.settings.border.color,this.cornerStyle.display="none";var Br=this.wot.overlay?this.wot.overlay.master.wtTable.trimmingContainer:A.trimmingContainer,io=Br===ye;if(io&&(Br=Q.documentElement),d===this.wot.getSetting("totalColumns")-1){var pi=(io?Object(l.getBoundingClientRect)(Et).left:Et.offsetLeft)+Object(l.outerWidth)(Et)+parseInt(this.cornerDefaultStyle.width,10)/2,vi=this.wot.overlay?this.wot.overlay.master.columnUtils:this.wot.columnUtils;pi>=Object(l.innerWidth)(Br)-vi.scrollbarCompensation&&(this.cornerStyle.left="".concat(Math.floor(gr+mr-3-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0)}c===this.wot.getSetting("totalRows")-1&&(io?Object(l.getBoundingClientRect)(Et).top:Et.offsetTop)+Object(l.outerHeight)(Et)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(l.innerHeight)(Br)&&(this.cornerStyle.top="".concat(Math.floor(qn+zn-3-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Object(St.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(c,d,qn,gr,mr,zn)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,o){return e===this.wot.wtTable.getFirstRenderedRow()&&o===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,o){return e===this.wot.wtTable.getFirstRenderedColumn()&&o===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,o,c,h){var d=this.wot.wtTable,p=d.wtRootElement.parentNode,A=null,Q=null,ye=null,Me=null,Be=null,xe=null,nt=null,qe=null;switch(e){case"rows":A=function(){return d.getRowHeader.apply(d,arguments)},Q=function(){return l.outerHeight.apply(void 0,arguments)},ye="ht__selection--rows",xe="top";break;case"columns":A=function(){return d.getColumnHeader.apply(d,arguments)},Q=function(){return l.outerWidth.apply(void 0,arguments)},ye="ht__selection--columns",xe="left"}if(p.className.includes(ye)){var mt=this.wot.getSetting("columnHeaders").length;if(nt=A(o,mt-1),qe=A(c,mt-1),!nt||!qe)return!1;var xt=Object(l.offset)(nt),jt=Object(l.offset)(qe);return nt&&qe&&(Me=xt[xe]-h[xe]-1,Be=jt[xe]+Q(qe)-xt[xe]),[nt,Me,Be]}return!1}},{key:"disappear",value:function(){this.cornerStyle.display="none",Object(St.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}])&&xo(t.prototype,n),r&&xo(t,r),a}();function gi(a,t){return function(n){if(Array.isArray(n))return n}(a)||function(n,r){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(n)))){var e=[],o=!0,c=!1,h=void 0;try{for(var d,p=n[Symbol.iterator]();!(o=(d=p.next()).done)&&(e.push(d.value),!r||e.length!==r);o=!0);}catch(A){c=!0,h=A}finally{try{o||p.return==null||p.return()}finally{if(c)throw h}}return e}}(a,t)||function(n,r){if(!!n){if(typeof n=="string")return Lo(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Lo(n,r)}}(a,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Lo(a,t){(t==null||t>a.length)&&(t=a.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=a[n];return r}function Po(a){return(Po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}function Do(a,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}var mi=function(){function a(e,o){(function(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")})(this,a),this.settings=e,this.cellRange=o||null,this.instanceSelectionHandles=new Map,this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var t,n,r;return t=a,(n=[{key:"hasSelectionHandle",value:function(){return this.settings.border&&typeof this.settings.border.cornerVisible=="function"}},{key:"getSelectionHandle",value:function(e){var o=this.getSelectionHandleIfExists(e);if(o)return o;var c=new di(e,this.settings);return this.instanceSelectionHandles.set(e,c),c}},{key:"getSelectionHandleIfExists",value:function(e){return this.instanceSelectionHandles.get(e)}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=new fe(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,o){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=o,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=o,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){return this.cellRange.getCorners()}},{key:"addClassAtCoords",value:function(e,o,c,h){var d=arguments.length>4&&arguments[4]!==void 0&&arguments[4],p=e.getCell(new P(o,c));if(Po(p)==="object"){var A=h;d&&(A=this.classNameGenerator(p),this.classNames.includes(A)||this.classNames.push(A)),Object(l.addClass)(p,A)}return this}},{key:"linearClassNameGenerator",value:function(e,o){return function c(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(o===0||d===0)return e;var p=d>=0?d:o,A=e,Q=(p-=1)==0?e:"".concat(e,"-").concat(p);if(Object(l.hasClass)(h,Q)){var ye=p+1;A="".concat(e,"-").concat(ye)}else A=c(h,p);return A}}},{key:"addClassIfElemExists",value:function(e,o){e&&Object(l.addClass)(e,o)}},{key:"draw",value:function(e,o,c,h,d,p,A){if(!this.isEmpty()){var Q,ye=e.wtTable,Me=this.settings,Be=Me.highlightHeaderClassName,xe=Me.highlightRowClassName,nt=Me.highlightColumnClassName,qe=this.getCorners(),mt=gi(qe,4),xt=mt[0],jt=mt[1],Zt=mt[2],Lt=mt[3],Tt=Math.max(xt,h),$t=Math.max(jt,d),Et=Math.min(Zt,p),Ht=Math.min(Lt,A),kn={row:Tt,col:$t},Dn={row:Et,col:Ht},Bn=Tt===xt,Un=Ht===Lt,gr=Et===Zt,mr=$t===jt;if(c&&(Be||nt)){for(var ir=$t;ir<=Ht;ir+=1)if(this.addClassIfElemExists(ye.getColumnHeader(ir),[Be,nt]),nt){for(var Yn=0;Yn<o;Yn+=1)if(Yn<Tt||Yn>Et){var jr=ye.rowFilter.renderedToSource(Yn);this.addClassAtCoords(ye,jr,ir,nt)}}}if(o&&(Be||xe)){for(var qn=Tt;qn<=Et;qn+=1)if(this.addClassIfElemExists(ye.getRowHeader(qn),[Be,xe]),xe){for(var zn=0;zn<c;zn+=1)if(zn<$t||zn>Ht){var Dr=ye.columnFilter.renderedToSource(zn);this.addClassAtCoords(ye,qn,Dr,xe)}}}this.settings.border&&Tt<=Et&&$t<=Ht&&(Q={settings:this.settings,selectionStart:kn,selectionEnd:Dn,hasTopEdge:Bn,hasRightEdge:Un,hasBottomEdge:gr,hasLeftEdge:mr});for(var Fn=Tt;Fn<=Et;Fn+=1)for(var Vn=$t;Vn<=Ht;Vn+=1)if(Fn>=Tt&&Fn<=Et&&Vn>=$t&&Vn<=Ht&&this.settings.className&&this.addClassAtCoords(ye,Fn,Vn,this.settings.className,this.settings.markIntersections),this.settings.className){var nr=e.getSetting("onAfterDrawSelection",Fn,Vn,qe,this.settings.layerLevel);typeof nr=="string"&&this.addClassAtCoords(ye,Fn,Vn,nr)}return e.getSetting("onBeforeDrawBorders",qe,this.settings.className),this.hasSelectionHandle()&&this.getSelectionHandle(e).appear(qe),Q}if(this.hasSelectionHandle()){var pr=this.getSelectionHandleIfExists(e);pr&&pr.disappear()}}},{key:"destroy",value:function(){this.instanceSelectionHandles.forEach(function(e){return e.destroy()})}}])&&Do(t.prototype,n),r&&Do(t,r),a}()},,function(ot,S,i){"use strict";i.r(S),i.d(S,"stringify",function(){return C}),i.d(S,"isDefined",function(){return pe}),i.d(S,"isUndefined",function(){return ie}),i.d(S,"isEmpty",function(){return X}),i.d(S,"isRegExp",function(){return F}),i.d(S,"_injectProductInfo",function(){return ee}),i(181);function M(ce){return(M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G})(ce)}function C(ce){var G;switch(M(ce)){case"string":case"number":G="".concat(ce);break;case"object":G=ce===null?"":ce.toString();break;case"undefined":G="";break;default:G=ce.toString()}return G}function pe(ce){return ce!==void 0}function ie(ce){return ce===void 0}function X(ce){return ce===null||ce===""||ie(ce)}function F(ce){return Object.prototype.toString.call(ce)==="[object RegExp]"}function ee(ce,G){}},,,function(ot,S,i){"use strict";i.d(S,"b",function(){return ce});var M=i(182),C=i(184);function pe(G,B){if(!(G instanceof B))throw new TypeError("Cannot call a class as a function")}function ie(G,B){for(var V=0;V<B.length;V++){var P=B[V];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(G,P.key,P)}}var X=0,F=function(){function G(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;pe(this,G),this.context=x||this,this.context.eventListeners||(this.context.eventListeners=[])}var B,V,P;return B=G,(V=[{key:"addEventListener",value:function(x,$,fe){var H=this,se=arguments.length>3&&arguments[3]!==void 0&&arguments[3];function I(de){fe.call(this,ee(de))}return typeof se=="boolean"||Object(M.isPassiveEventSupported)()||(se=!1),this.context.eventListeners.push({element:x,event:$,callback:fe,callbackProxy:I,options:se,eventManager:this}),x.addEventListener($,I,se),X+=1,function(){H.removeEventListener(x,$,fe)}}},{key:"removeEventListener",value:function(x,$,fe){for(var H,se=arguments.length>3&&arguments[3]!==void 0&&arguments[3],I=this.context.eventListeners.length;I;)if(I-=1,(H=this.context.eventListeners[I]).event===$&&H.element===x){if(fe&&fe!==H.callback||se&&H.eventManager!==this)continue;this.context.eventListeners.splice(I,1),H.element.removeEventListener(H.event,H.callbackProxy,H.options),X-=1}}},{key:"clearEvents",value:function(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.context)for(var $=this.context.eventListeners.length;$;){$-=1;var fe=this.context.eventListeners[$];fe&&this.removeEventListener(fe.element,fe.event,fe.callback,x)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(x,$){var fe=x.document,H=x;fe||(H=(fe=x.ownerDocument?x.ownerDocument:x).defaultView);var se,I={bubbles:!0,cancelable:$!=="mousemove",view:H,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};fe.createEvent?(se=fe.createEvent("MouseEvents")).initMouseEvent($,I.bubbles,I.cancelable,I.view,I.detail,I.screenX,I.screenY,I.clientX,I.clientY,I.ctrlKey,I.altKey,I.shiftKey,I.metaKey,I.button,I.relatedTarget||fe.body.parentNode):se=fe.createEventObject(),x.dispatchEvent?x.dispatchEvent(se):x.fireEvent("on".concat($),se)}}])&&ie(B.prototype,V),P&&ie(B,P),G}();function ee(G){var B=G.stopImmediatePropagation;return G.stopImmediatePropagation=function(){B.apply(this),Object(C.stopImmediatePropagation)(this)},G}function ce(){return X}S.a=F},function(ot,S,i){"use strict";function M(F){return(M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee})(F)}function C(F){var ee=M(F);return ee=="number"?!isNaN(F)&&isFinite(F):ee=="string"?!!F.length&&(F.length==1?/\d/.test(F):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(F)):ee=="object"&&!(!F||typeof F.valueOf()!="number"||F instanceof Date)}function pe(F,ee,ce){var G=-1;for(typeof ee=="function"?(ce=ee,ee=F):G=F-1;++G<=ee&&ce(G)!==!1;);}function ie(F,ee,ce){var G=F+1;for(typeof ee=="function"&&(ce=ee,ee=0);--G>=ee&&ce(G)!==!1;);}function X(F,ee){return ee=parseInt(ee.toString().replace("%",""),10),ee=parseInt(F*ee/100,10)}i.r(S),i.d(S,"isNumeric",function(){return C}),i.d(S,"rangeEach",function(){return pe}),i.d(S,"rangeEachReverse",function(){return ie}),i.d(S,"valueAccordingPercent",function(){return X})},function(ot,S,i){"use strict";i.r(S),i.d(S,"CONTEXT_MENU_ITEMS_NAMESPACE",function(){return M}),i.d(S,"CONTEXTMENU_ITEMS_NO_ITEMS",function(){return C}),i.d(S,"CONTEXTMENU_ITEMS_ROW_ABOVE",function(){return pe}),i.d(S,"CONTEXTMENU_ITEMS_ROW_BELOW",function(){return ie}),i.d(S,"CONTEXTMENU_ITEMS_INSERT_LEFT",function(){return X}),i.d(S,"CONTEXTMENU_ITEMS_INSERT_RIGHT",function(){return F}),i.d(S,"CONTEXTMENU_ITEMS_REMOVE_ROW",function(){return ee}),i.d(S,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",function(){return ce}),i.d(S,"CONTEXTMENU_ITEMS_UNDO",function(){return G}),i.d(S,"CONTEXTMENU_ITEMS_REDO",function(){return B}),i.d(S,"CONTEXTMENU_ITEMS_READ_ONLY",function(){return V}),i.d(S,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",function(){return P}),i.d(S,"CONTEXTMENU_ITEMS_COPY",function(){return x}),i.d(S,"CONTEXTMENU_ITEMS_CUT",function(){return $}),i.d(S,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",function(){return fe}),i.d(S,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",function(){return H}),i.d(S,"CONTEXTMENU_ITEMS_MERGE_CELLS",function(){return se}),i.d(S,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",function(){return I}),i.d(S,"CONTEXTMENU_ITEMS_ADD_COMMENT",function(){return de}),i.d(S,"CONTEXTMENU_ITEMS_EDIT_COMMENT",function(){return l}),i.d(S,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",function(){return K}),i.d(S,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",function(){return ne}),i.d(S,"CONTEXTMENU_ITEMS_ALIGNMENT",function(){return le}),i.d(S,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",function(){return Re}),i.d(S,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",function(){return De}),i.d(S,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",function(){return He}),i.d(S,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",function(){return me}),i.d(S,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",function(){return Se}),i.d(S,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",function(){return Ie}),i.d(S,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",function(){return Le}),i.d(S,"CONTEXTMENU_ITEMS_BORDERS",function(){return we}),i.d(S,"CONTEXTMENU_ITEMS_BORDERS_TOP",function(){return Ve}),i.d(S,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",function(){return je}),i.d(S,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",function(){return Ke}),i.d(S,"CONTEXTMENU_ITEMS_BORDERS_LEFT",function(){return $e}),i.d(S,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",function(){return Ye}),i.d(S,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",function(){return ht}),i.d(S,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",function(){return Qe}),i.d(S,"CONTEXTMENU_ITEMS_HIDE_COLUMN",function(){return ct}),i.d(S,"CONTEXTMENU_ITEMS_SHOW_COLUMN",function(){return We}),i.d(S,"CONTEXTMENU_ITEMS_HIDE_ROW",function(){return Ze}),i.d(S,"CONTEXTMENU_ITEMS_SHOW_ROW",function(){return at}),i.d(S,"FILTERS_NAMESPACE",function(){return ut}),i.d(S,"FILTERS_CONDITIONS_NAMESPACE",function(){return be}),i.d(S,"FILTERS_CONDITIONS_NONE",function(){return Z}),i.d(S,"FILTERS_CONDITIONS_EMPTY",function(){return he}),i.d(S,"FILTERS_CONDITIONS_NOT_EMPTY",function(){return O}),i.d(S,"FILTERS_CONDITIONS_EQUAL",function(){return re}),i.d(S,"FILTERS_CONDITIONS_NOT_EQUAL",function(){return Oe}),i.d(S,"FILTERS_CONDITIONS_BEGINS_WITH",function(){return Ee}),i.d(S,"FILTERS_CONDITIONS_ENDS_WITH",function(){return ve}),i.d(S,"FILTERS_CONDITIONS_CONTAINS",function(){return Ge}),i.d(S,"FILTERS_CONDITIONS_NOT_CONTAIN",function(){return Je}),i.d(S,"FILTERS_CONDITIONS_BY_VALUE",function(){return ft}),i.d(S,"FILTERS_CONDITIONS_GREATER_THAN",function(){return tt}),i.d(S,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",function(){return yt}),i.d(S,"FILTERS_CONDITIONS_LESS_THAN",function(){return bt}),i.d(S,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",function(){return Ot}),i.d(S,"FILTERS_CONDITIONS_BETWEEN",function(){return Jt}),i.d(S,"FILTERS_CONDITIONS_NOT_BETWEEN",function(){return Gt}),i.d(S,"FILTERS_CONDITIONS_AFTER",function(){return Qt}),i.d(S,"FILTERS_CONDITIONS_BEFORE",function(){return rn}),i.d(S,"FILTERS_CONDITIONS_TODAY",function(){return an}),i.d(S,"FILTERS_CONDITIONS_TOMORROW",function(){return mn}),i.d(S,"FILTERS_CONDITIONS_YESTERDAY",function(){return W}),i.d(S,"FILTERS_DIVS_FILTER_BY_CONDITION",function(){return R}),i.d(S,"FILTERS_DIVS_FILTER_BY_VALUE",function(){return U}),i.d(S,"FILTERS_LABELS_CONJUNCTION",function(){return s}),i.d(S,"FILTERS_LABELS_DISJUNCTION",function(){return u}),i.d(S,"FILTERS_VALUES_BLANK_CELLS",function(){return v}),i.d(S,"FILTERS_BUTTONS_SELECT_ALL",function(){return k}),i.d(S,"FILTERS_BUTTONS_CLEAR",function(){return j}),i.d(S,"FILTERS_BUTTONS_OK",function(){return q}),i.d(S,"FILTERS_BUTTONS_CANCEL",function(){return y}),i.d(S,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",function(){return _}),i.d(S,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",function(){return Y}),i.d(S,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",function(){return ue});var M="ContextMenu:items",C="".concat(M,".noItems"),pe="".concat(M,".insertRowAbove"),ie="".concat(M,".insertRowBelow"),X="".concat(M,".insertColumnOnTheLeft"),F="".concat(M,".insertColumnOnTheRight"),ee="".concat(M,".removeRow"),ce="".concat(M,".removeColumn"),G="".concat(M,".undo"),B="".concat(M,".redo"),V="".concat(M,".readOnly"),P="".concat(M,".clearColumn"),x="".concat(M,".copy"),$="".concat(M,".cut"),fe="".concat(M,".freezeColumn"),H="".concat(M,".unfreezeColumn"),se="".concat(M,".mergeCells"),I="".concat(M,".unmergeCells"),de="".concat(M,".addComment"),l="".concat(M,".editComment"),K="".concat(M,".removeComment"),ne="".concat(M,".readOnlyComment"),le="".concat(M,".align"),Re="".concat(M,".align.left"),De="".concat(M,".align.center"),He="".concat(M,".align.right"),me="".concat(M,".align.justify"),Se="".concat(M,".align.top"),Ie="".concat(M,".align.middle"),Le="".concat(M,".align.bottom"),we="".concat(M,".borders"),Ve="".concat(M,".borders.top"),je="".concat(M,".borders.right"),Ke="".concat(M,".borders.bottom"),$e="".concat(M,".borders.left"),Ye="".concat(M,".borders.remove"),ht="".concat(M,".nestedHeaders.insertChildRow"),Qe="".concat(M,".nestedHeaders.detachFromParent"),ct="".concat(M,".hideColumn"),We="".concat(M,".showColumn"),Ze="".concat(M,".hideRow"),at="".concat(M,".showRow"),ut="Filters:",be="".concat(ut,"conditions"),Z="".concat(be,".none"),he="".concat(be,".isEmpty"),O="".concat(be,".isNotEmpty"),re="".concat(be,".isEqualTo"),Oe="".concat(be,".isNotEqualTo"),Ee="".concat(be,".beginsWith"),ve="".concat(be,".endsWith"),Ge="".concat(be,".contains"),Je="".concat(be,".doesNotContain"),ft="".concat(be,".byValue"),tt="".concat(be,".greaterThan"),yt="".concat(be,".greaterThanOrEqualTo"),bt="".concat(be,".lessThan"),Ot="".concat(be,".lessThanOrEqualTo"),Jt="".concat(be,".isBetween"),Gt="".concat(be,".isNotBetween"),Qt="".concat(be,".after"),rn="".concat(be,".before"),an="".concat(be,".today"),mn="".concat(be,".tomorrow"),W="".concat(be,".yesterday"),R="".concat(ut,"labels.filterByCondition"),U="".concat(ut,"labels.filterByValue"),s="".concat(ut,"labels.conjunction"),u="".concat(ut,"labels.disjunction"),v="".concat(ut,"values.blankCells"),k="".concat(ut,"buttons.selectAll"),j="".concat(ut,"buttons.clear"),q="".concat(ut,"buttons.ok"),y="".concat(ut,"buttons.cancel"),_="".concat(ut,"buttons.placeholder.search"),Y="".concat(ut,"buttons.placeholder.value"),ue="".concat(ut,"buttons.placeholder.secondValue")},function(ot,S,i){"use strict";i.r(S),i.d(S,"setBrowserMeta",function(){return X}),i.d(S,"setPlatformMeta",function(){return F}),i.d(S,"isChrome",function(){return ee}),i.d(S,"isEdge",function(){return ce}),i.d(S,"isIE",function(){return G}),i.d(S,"isIE9",function(){return B}),i.d(S,"isMSBrowser",function(){return V}),i.d(S,"isMobileBrowser",function(){return P}),i.d(S,"isSafari",function(){return x}),i.d(S,"isFirefox",function(){return $}),i.d(S,"isWindowsOS",function(){return fe}),i.d(S,"isMacOS",function(){return H}),i.d(S,"isLinuxOS",function(){return se});var M=i(159),C=function(I){var de={value:!1,test:function(l,K){de.value=I(l,K)}};return de},pe={chrome:C(function(I,de){return/Chrome/.test(I)&&/Google/.test(de)}),edge:C(function(I){return/Edge/.test(I)}),firefox:C(function(I){return/Firefox/.test(I)}),ie:C(function(I){return/Trident/.test(I)}),ie9:C(function(){return!!document.documentMode}),mobile:C(function(I){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(I)}),safari:C(function(I,de){return/Safari/.test(I)&&/Apple Computer/.test(de)})},ie={mac:C(function(I){return/^Mac/.test(I)}),win:C(function(I){return/^Win/.test(I)}),linux:C(function(I){return/^Linux/.test(I)})};function X(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},de=I.userAgent,l=de===void 0?navigator.userAgent:de,K=I.vendor,ne=K===void 0?navigator.vendor:K;Object(M.objectEach)(pe,function(le){(0,le.test)(l,ne)})}function F(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},de=I.platform,l=de===void 0?navigator.platform:de;Object(M.objectEach)(ie,function(K){(0,K.test)(l)})}function ee(){return pe.chrome.value}function ce(){return pe.edge.value}function G(){return pe.ie.value}function B(){return pe.ie9.value}function V(){return pe.ie.value||pe.edge.value}function P(){return pe.mobile.value}function x(){return pe.safari.value}function $(){return pe.firefox.value}function fe(){return ie.win.value}function H(){return ie.mac.value}function se(){return ie.linux.value}X(),F()},function(ot,S,i){"use strict";i.d(S,"d",function(){return X}),i.d(S,"a",function(){return F}),i.d(S,"c",function(){return ee}),i.d(S,"b",function(){return ce});var M=i(186),C=i(159),pe=i(176),ie=new WeakMap;function X(G,B){var V=Object(pe.toUpperCaseFirst)(G);M.a.getSingleton().add("construct",function(){ie.has(this)||ie.set(this,{});var P=ie.get(this);P[V]||(P[V]=new B(this))}),M.a.getSingleton().add("afterDestroy",function(){if(ie.has(this)){var P=ie.get(this);Object(C.objectEach)(P,function(x){return x.destroy()}),ie.delete(this)}})}function F(G,B){if(typeof B!="string")throw Error('Only strings can be passed as "plugin" parameter');var V=Object(pe.toUpperCaseFirst)(B);if(ie.has(G)&&ie.get(G)[V])return ie.get(G)[V]}function ee(G){return ie.has(G)?Object.keys(ie.get(G)):[]}function ce(G,B){var V=null;return ie.has(G)&&Object(C.objectEach)(ie.get(G),function(P,x){P===B&&(V=x)}),V}},,function(ot,S,i){"use strict";i.r(S),i.d(S,"toUpperCaseFirst",function(){return C}),i.d(S,"equalsIgnoreCase",function(){return pe}),i.d(S,"randomString",function(){return ie}),i.d(S,"isPercentValue",function(){return X}),i.d(S,"substitute",function(){return F}),i.d(S,"stripTags",function(){return ce});var M=i(167);function C(G){return G[0].toUpperCase()+G.substr(1)}function pe(){for(var G=[],B=arguments.length,V=new Array(B),P=0;P<B;P++)V[P]=arguments[P];for(var x=V.length;x;){x-=1;var $=Object(M.stringify)(V[x]).toLowerCase();G.indexOf($)===-1&&G.push($)}return G.length===1}function ie(){function G(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return G()+G()+G()+G()}function X(G){return/^([0-9][0-9]?%$)|(^100%$)/.test(G)}function F(G){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(G).replace(/(?:\\)?\[([^[\]]+)]/g,function(V,P){return V.charAt(0)==="\\"?V.substr(1,V.length-1):B[P]===void 0?"":B[P]})}var ee=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi;function ce(G){return"".concat(G).replace(ee,"")}},,,function(ot,S,i){"use strict";i.d(S,"a",function(){return pe});var M=i(1),C=i.n(M),pe=function(ie){var X=ie.description;return C.a.createElement("p",{className:"toolbar-mobile-menu-item-text"},X)}},function(ot,S,i){"use strict";function M(X){return function(F){if(Array.isArray(F))return C(F)}(X)||function(F){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(F))return Array.from(F)}(X)||function(F,ee){if(!!F){if(typeof F=="string")return C(F,ee);var ce=Object.prototype.toString.call(F).slice(8,-1);if(ce==="Object"&&F.constructor&&(ce=F.constructor.name),ce==="Map"||ce==="Set")return Array.from(F);if(ce==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ce))return C(F,ee)}}(X)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function C(X,F){(F==null||F>X.length)&&(F=X.length);for(var ee=0,ce=new Array(F);ee<F;ee++)ce[ee]=X[ee];return ce}i.d(S,"a",function(){return ie});var pe=new Map;function ie(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";pe.has(X)||pe.set(X,new Map);var F=pe.get(X);function ee(P,x){F.set(P,x)}function ce(P){return F.get(P)}function G(P){return F.has(P)}function B(){return M(F.keys())}function V(){return M(F.values())}return{register:ee,getItem:ce,hasItem:G,getNames:B,getValues:V}}},function(ot,S,i){"use strict";i.d(S,"a",function(){return C});var M=i(160);function C(pe){for(var ie=arguments.length,X=new Array(ie>1?ie-1:0),F=1;F<ie;F++)X[F-1]=arguments[F];var ee=Object(M.arrayReduce)(pe,function(ce,G,B){return ce+G.replace(/\r?\n\s*/g,"")+(X[B]?X[B]:"")},"");return ee.trim()}},function(ot,S,i){"use strict";i.r(S),i.d(S,"requestAnimationFrame",function(){return V}),i.d(S,"isClassListSupported",function(){return P}),i.d(S,"isTextContentSupported",function(){return x}),i.d(S,"isGetComputedStyleSupported",function(){return $}),i.d(S,"cancelAnimationFrame",function(){return fe}),i.d(S,"isTouchSupported",function(){return H}),i.d(S,"hasCaptionProblem",function(){return se}),i.d(S,"getComparisonFunction",function(){return I}),i.d(S,"isPassiveEventSupported",function(){return de});var M=i(161);function C(l){return(C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K})(l)}for(var pe,ie,X,F=0,ee=["ms","moz","webkit","o"],ce=window.requestAnimationFrame,G=window.cancelAnimationFrame,B=0;B<ee.length&&!ce;++B)ce=window["".concat(ee[B],"RequestAnimationFrame")],G=window["".concat(ee[B],"CancelAnimationFrame")]||window["".concat(ee[B],"CancelRequestAnimationFrame")];function V(l){return ce.call(window,l)}function P(){return!!document.documentElement.classList}function x(){return!!document.createTextNode("test").textContent}function $(){return!!window.getComputedStyle}function fe(l){G.call(window,l)}function H(){return"ontouchstart"in window}function se(){return pe===void 0&&function(){var l=document.createElement("TABLE");l.style.borderSpacing="0",l.style.borderWidth="0",l.style.padding="0";var K=document.createElement("TBODY");l.appendChild(K),K.appendChild(document.createElement("TR")),K.firstChild.appendChild(document.createElement("TD")),K.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var ne=document.createElement("CAPTION");ne.innerHTML="c<br>c<br>c<br>c",ne.style.padding="0",ne.style.margin="0",l.insertBefore(ne,K),document.body.appendChild(l),pe=Object(M.offsetHeight)(l)<2*Object(M.offsetHeight)(l.lastChild),document.body.removeChild(l)}(),pe}function I(l){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ie||(ie=(typeof Intl=="undefined"?"undefined":C(Intl))==="object"?new Intl.Collator(l,K).compare:typeof String.prototype.localeCompare=="function"?function(ne,le){return"".concat(ne).localeCompare(le)}:function(ne,le){return ne===le?0:ne>le?-1:1})}function de(){if(X!==void 0)return X;try{var l={get passive(){X=!0}};window.addEventListener("test",l,l),window.removeEventListener("test",l,l)}catch(K){X=!1}return X}ce||(ce=function(l){var K=new Date().getTime(),ne=Math.max(0,16-(K-F)),le=window.setTimeout(function(){l(K+ne)},ne);return F=K+ne,le}),G||(G=function(l){clearTimeout(l)})},function(ot,S,i){"use strict";i.d(S,"a",function(){return M});var M=1},function(ot,S,i){"use strict";function M(X){X.isImmediatePropagationEnabled=!1,X.cancelBubble=!0}function C(X){return X.isImmediatePropagationEnabled===!1}function pe(X){return X.button===2}function ie(X){return X.button===0}i.r(S),i.d(S,"stopImmediatePropagation",function(){return M}),i.d(S,"isImmediatePropagationStopped",function(){return C}),i.d(S,"isRightClick",function(){return pe}),i.d(S,"isLeftClick",function(){return ie})},,function(ot,S,i){"use strict";var M=i(160),C=i(159),pe=i(176),ie=i(187),X=i(181);function F(fe,H){for(var se=0;se<H.length;se++){var I=H[se];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(fe,I.key,I)}}function ee(fe,H,se){return H&&F(fe.prototype,H),se&&F(fe,se),fe}function ce(){var fe=function(H,se){return se||(se=H.slice(0)),Object.freeze(Object.defineProperties(H,{raw:{value:Object.freeze(se)}}))}([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to learn about the migration path.`]);return ce=function(){return fe},fe}var G=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand"],B=Object(X.a)(ce()),V=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),P=new Map([]),x=function(){function fe(){(function(H,se){if(!(H instanceof se))throw new TypeError("Cannot call a class as a function")})(this,fe),this.globalBucket=this.createEmptyBucket()}return ee(fe,null,[{key:"getSingleton",value:function(){return $}}]),ee(fe,[{key:"createEmptyBucket",value:function(){var H=Object.create(null);return Object(M.arrayEach)(G,function(se){return H[se]=[]}),H}},{key:"getBucket",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return H?(H.pluginHookBucket||(H.pluginHookBucket=this.createEmptyBucket()),H.pluginHookBucket):this.globalBucket}},{key:"add",value:function(H,se){var I=this,de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(se))Object(M.arrayEach)(se,function(ne){return I.add(H,ne,de)});else{V.has(H)&&Object(ie.b)(Object(pe.substitute)(B,{hookName:H,removedInVersion:V.get(H)})),P.has(H)&&Object(ie.b)(P.get(H));var l=this.getBucket(de);if(l[H]===void 0&&(this.register(H),l[H]=[]),se.skip=!1,l[H].indexOf(se)===-1){var K=!1;se.initialHook&&Object(M.arrayEach)(l[H],function(ne,le){if(ne.initialHook)return l[H][le]=se,K=!0,!1}),K||l[H].push(se)}}return this}},{key:"once",value:function(H,se){var I=this,de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(se)?Object(M.arrayEach)(se,function(l){return I.once(H,l,de)}):(se.runOnce=!0,this.add(H,se,de))}},{key:"remove",value:function(H,se){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,de=this.getBucket(I);return de[H]!==void 0&&de[H].indexOf(se)>=0&&(se.skip=!0,!0)}},{key:"has",value:function(H){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,I=this.getBucket(se);return!(I[H]===void 0||!I[H].length)}},{key:"run",value:function(H,se,I,de,l,K,ne,le){var Re=this.globalBucket[se],De=Re?Re.length:0,He=0;if(De)for(;He<De;)if(Re[He]&&!Re[He].skip){var me=Re[He].call(H,I,de,l,K,ne,le);me!==void 0&&(I=me),Re[He]&&Re[He].runOnce&&this.remove(se,Re[He]),He+=1}else He+=1;var Se=this.getBucket(H)[se],Ie=Se?Se.length:0,Le=0;if(Ie)for(;Le<Ie;)if(Se[Le]&&!Se[Le].skip){var we=Se[Le].call(H,I,de,l,K,ne,le);we!==void 0&&(I=we),Se[Le]&&Se[Le].runOnce&&this.remove(se,Se[Le],H),Le+=1}else Le+=1;return I}},{key:"destroy",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Object(C.objectEach)(this.getBucket(H),function(se,I,de){return de[I].length=0})}},{key:"register",value:function(H){this.isRegistered(H)||G.push(H)}},{key:"deregister",value:function(H){this.isRegistered(H)&&G.splice(G.indexOf(H),1)}},{key:"isDeprecated",value:function(H){return P.has(H)||V.has(H)}},{key:"isRegistered",value:function(H){return G.indexOf(H)>=0}},{key:"getRegistered",value:function(){return G}}]),fe}(),$=new x;S.a=x},function(ot,S,i){"use strict";i.d(S,"b",function(){return C}),i.d(S,"a",function(){return pe});var M=i(167);function C(){var ie;Object(M.isDefined)(console)&&(ie=console).warn.apply(ie,arguments)}function pe(){var ie;Object(M.isDefined)(console)&&(ie=console).error.apply(ie,arguments)}},function(ot,S,i){"use strict";i.r(S),i.d(S,"isFunction",function(){return C}),i.d(S,"throttle",function(){return pe}),i.d(S,"throttleAfterHits",function(){return ie}),i.d(S,"debounce",function(){return X}),i.d(S,"pipe",function(){return F}),i.d(S,"partial",function(){return ee}),i.d(S,"curry",function(){return ce}),i.d(S,"curryRight",function(){return G});var M=i(160);function C(B){return typeof B=="function"}function pe(B){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,P=0,x={lastCallThrottled:!0},$=null;function fe(){for(var H=this,se=arguments.length,I=new Array(se),de=0;de<se;de++)I[de]=arguments[de];var l=Date.now(),K=!1;x.lastCallThrottled=!0,P||(P=l,K=!0);var ne=V-(l-P);return K?(x.lastCallThrottled=!1,B.apply(this,I)):($&&clearTimeout($),$=setTimeout(function(){x.lastCallThrottled=!1,B.apply(H,I),P=0,$=void 0},ne)),x}return fe}function ie(B){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,x=pe(B,V),$=P;function fe(){$=P}function H(){for(var se=arguments.length,I=new Array(se),de=0;de<se;de++)I[de]=arguments[de];return $?($-=1,B.apply(this,I)):x.apply(this,I)}return H.clearHits=fe,H}function X(B){var V,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,x=null;function $(){for(var fe=this,H=arguments.length,se=new Array(H),I=0;I<H;I++)se[I]=arguments[I];return x&&clearTimeout(x),x=setTimeout(function(){V=B.apply(fe,se)},P),V}return $}function F(){for(var B=arguments.length,V=new Array(B),P=0;P<B;P++)V[P]=arguments[P];var x=V[0],$=V.slice(1);return function(){for(var fe=arguments.length,H=new Array(fe),se=0;se<fe;se++)H[se]=arguments[se];return Object(M.arrayReduce)($,function(I,de){return de(I)},x.apply(this,H))}}function ee(B){for(var V=arguments.length,P=new Array(V>1?V-1:0),x=1;x<V;x++)P[x-1]=arguments[x];return function(){for(var $=arguments.length,fe=new Array($),H=0;H<$;H++)fe[H]=arguments[H];return B.apply(this,P.concat(fe))}}function ce(B){var V=B.length;return function P(x){return function(){for(var $=arguments.length,fe=new Array($),H=0;H<$;H++)fe[H]=arguments[H];var se=x.concat(fe);return se.length>=V?B.apply(this,se):P(se)}}([])}function G(B){var V=B.length;return function P(x){return function(){for(var $=arguments.length,fe=new Array($),H=0;H<$;H++)fe[H]=arguments[H];var se=x.concat(fe.reverse());return se.length>=V?B.apply(this,se):P(se)}}([])}},function(ot,S,i){"use strict";var M=i(160),C=i(159),pe={_localHooks:Object.create(null),addLocalHook:function(ie,X){return this._localHooks[ie]||(this._localHooks[ie]=[]),this._localHooks[ie].push(X),this},runLocalHooks:function(ie){for(var X=this,F=arguments.length,ee=new Array(F>1?F-1:0),ce=1;ce<F;ce++)ee[ce-1]=arguments[ce];this._localHooks[ie]&&Object(M.arrayEach)(this._localHooks[ie],function(G){return G.apply(X,ee)})},clearLocalHooks:function(){return this._localHooks={},this}};Object(C.defineGetter)(pe,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),S.a=pe},function(ot,S){},,,function(ot,S,i){"use strict";i.d(S,"a",function(){return ce});var M=i(1),C=i.n(M),pe=i(194),ie=function(G){var B=G.state,V=G.close;return C.a.createElement(C.a.Fragment,null,B[pe.b]&&C.a.createElement(pe.a,{onClose:function(){return V(pe.b)}}))};function X(G,B,V){return B in G?Object.defineProperty(G,B,{value:V,enumerable:!0,configurable:!0,writable:!0}):G[B]=V,G}function F(G,B){return function(V){if(Array.isArray(V))return V}(G)||function(V,P){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(V)))){var x=[],$=!0,fe=!1,H=void 0;try{for(var se,I=V[Symbol.iterator]();!($=(se=I.next()).done)&&(x.push(se.value),!P||x.length!==P);$=!0);}catch(de){fe=!0,H=de}finally{try{$||I.return==null||I.return()}finally{if(fe)throw H}}return x}}(G,B)||function(V,P){if(!!V){if(typeof V=="string")return ee(V,P);var x=Object.prototype.toString.call(V).slice(8,-1);if(x==="Object"&&V.constructor&&(x=V.constructor.name),x==="Map"||x==="Set")return Array.from(V);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return ee(V,P)}}(G,B)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ee(G,B){(B==null||B>G.length)&&(B=G.length);for(var V=0,P=new Array(B);V<B;V++)P[V]=G[V];return P}var ce=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},B=Object(M.useState)(function(){return G}),V=F(B,2),P=V[0],x=V[1],$=function(se){x(function(I){return Object.assign(Object.assign({},I),X({},se,!0))})},fe=function(se){x(function(I){return Object.assign(Object.assign({},I),X({},se,!1))})},H=function(){return C.a.createElement(ie,{state:P,close:fe})};return{Modals:H,openModal:$,closeModal:fe}}},function(ot,S,i){"use strict";i.d(S,"b",function(){return F}),i.d(S,"a",function(){return ee});var M=i(1),C=i.n(M),pe=i(316),ie=function(ce){var G=ce.onClose,B=ce.isMobile;return C.a.createElement("svg",Object.assign({viewBox:"0 0 16 16",className:"close-icon-modal",onClick:G,"data-cy":"close-modal"},B?{width:24,height:24}:{width:16,height:16}),C.a.createElement("path",{d:"M12.054 4.95l-.844-.844a.066.066 0 00-.093 0l-3 3a.066.066 0 01-.093 0l-3-3a.066.066 0 00-.093 0l-.838.844a.066.066 0 000 .093l3 3a.066.066 0 010 .093l-3 3a.066.066 0 000 .093l.844.844a.066.066 0 00.093 0l3-3a.066.066 0 01.093 0l3 3a.066.066 0 00.093 0l.844-.844a.066.066 0 000-.093l-3-3a.066.066 0 010-.093l3-3a.066.066 0 00-.006-.093z",fill:"#1d1d1d"}))},X=i(65),F="feedback",ee=function(ce){var G=ce.onClose,B=Object(X.b)();return C.a.createElement(pe.a,{open:!0,onClose:G,PaperComponent:function(){return C.a.createElement("div",{className:"modal modal-feedback","data-cy":"modal-feedback"},C.a.createElement(ie,{onClose:G,isMobile:B}),C.a.createElement("p",{className:"modal-title"},"Feedback"),C.a.createElement("p",{className:"modal-description"},"Are you missing a feature?",C.a.createElement("br",null),"Do you think an existing function could be improved?"),C.a.createElement("a",{href:"https://handsoncode.typeform.com/to/LqlEyO8z",target:"_blank",rel:"noopener noreferrer",className:"sv-button ".concat(B?"mobile-feedback-button":"")},"Fill out the feedback form"))},classes:{root:"modal-feedback-background"}})}},,function(ot,S,i){"use strict";i.d(S,"a",function(){return ie});var M=i(1);function C(X,F){return function(ee){if(Array.isArray(ee))return ee}(X)||function(ee,ce){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(ee)))){var G=[],B=!0,V=!1,P=void 0;try{for(var x,$=ee[Symbol.iterator]();!(B=(x=$.next()).done)&&(G.push(x.value),!ce||G.length!==ce);B=!0);}catch(fe){V=!0,P=fe}finally{try{B||$.return==null||$.return()}finally{if(V)throw P}}return G}}(X,F)||function(ee,ce){if(!!ee){if(typeof ee=="string")return pe(ee,ce);var G=Object.prototype.toString.call(ee).slice(8,-1);if(G==="Object"&&ee.constructor&&(G=ee.constructor.name),G==="Map"||G==="Set")return Array.from(ee);if(G==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(G))return pe(ee,ce)}}(X,F)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function pe(X,F){(F==null||F>X.length)&&(F=X.length);for(var ee=0,ce=new Array(F);ee<F;ee++)ce[ee]=X[ee];return ce}var ie=function(X){var F=C(Object(M.useState)(void 0),2),ee=F[0],ce=F[1];return Object(M.useEffect)(function(){if(typeof X=="string")return X.indexOf("data:")===0||X.indexOf("blob:"),void ce(X);var G=URL.createObjectURL(new Blob([X]));return ce(G),function(){return URL.revokeObjectURL(G)}},[X]),ee}},,,function(ot,S,i){"use strict";var M;i.d(S,"a",function(){return C});var C=function(){var pe;return M===void 0&&(M="download"in document.createElement("a")&&!((pe=window.webkit)===null||pe===void 0?void 0:pe.messageHandlers)),M}},function(ot,S,i){"use strict";(function(M){i(264),i(265),i(266),i(267);var C=i(214),pe=i(224),ie=i(215),X=i(216),F=i(269),ee=i(274),ce=i(170),G=i(219),B=i(186),V=i(220),P=i(217),x=i(160),$=i(173),fe=i(202),H=i(275),se=i(182),I=i(188),de=i(167),l=i(171),K=i(159),ne=i(176),le=i(201),Re=i(161),De=i(184),He=i(277),me=i(174),Se=i(251),Ie=i(245),Le=i(254),we=i(172),Ve=i(206);function je(Ye,ht){var Qe=new F.a(Ye,ht||{},Ie.d);return Qe.init(),Qe}Object(ee.a)(je),je.Core=function(Ye){var ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new F.a(Ye,ht,Ie.d)},je.DefaultSettings=Object(Se.c)(),je.EventManager=ce.a,je._getListenersCounter=ce.b,je._getRegisteredMapsCounter=G.b,je.packageName="handsontable",je.buildDate=M.env.HOT_BUILD_DATE,je.version=M.env.HOT_VERSION,je.hooks=B.a.getSingleton(),je.__GhostTable=V.a;var Ke=[x,$,fe,H,se,I,de,l,K,ne,le,P],$e=[Re,De];je.helper={},je.dom={},x.arrayEach(Ke,function(Ye){x.arrayEach(Object.getOwnPropertyNames(Ye),function(ht){ht.charAt(0)!=="_"&&(je.helper[ht]=Ye[ht])})}),x.arrayEach($e,function(Ye){x.arrayEach(Object.getOwnPropertyNames(Ye),function(ht){ht.charAt(0)!=="_"&&(je.dom[ht]=Ye[ht])})}),je.cellTypes={},x.arrayEach(Object(X.b)(),function(Ye){je.cellTypes[Ye]=Object(X.a)(Ye)}),je.cellTypes.registerCellType=X.c,je.cellTypes.getCellType=X.a,je.editors={},x.arrayEach(Object(C.c)(),function(Ye){je.editors["".concat(ne.toUpperCaseFirst(Ye),"Editor")]=Object(C.a)(Ye)}),je.editors.registerEditor=C.d,je.editors.getEditor=C.a,je.renderers={},x.arrayEach(Object(pe.a)(),function(Ye){var ht=Object(pe.b)(Ye);Ye==="base"&&(je.renderers.cellDecorator=ht),je.renderers["".concat(ne.toUpperCaseFirst(Ye),"Renderer")]=ht}),je.renderers.registerRenderer=pe.c,je.renderers.getRenderer=pe.b,je.validators={},x.arrayEach(Object(ie.a)(),function(Ye){je.validators["".concat(ne.toUpperCaseFirst(Ye),"Validator")]=Object(ie.b)(Ye)}),je.validators.registerValidator=ie.c,je.validators.getValidator=ie.b,je.plugins={},x.arrayEach(Object.getOwnPropertyNames(He),function(Ye){var ht=He[Ye];Ye==="Base"?je.plugins["".concat(Ye,"Plugin")]=ht:je.plugins[Ye]=ht}),je.plugins.registerPlugin=me.d,je.languages={},je.languages.dictionaryKeys=we,je.languages.getLanguageDictionary=Ve.b,je.languages.getLanguagesDictionaries=Ve.c,je.languages.registerLanguageDictionary=Ve.e,je.languages.getTranslatedPhrase=function(){return Le.a.apply(void 0,arguments)},S.a=je}).call(this,i(242))},function(ot,S,i){"use strict";i.r(S),i.d(S,"KEY_CODES",function(){return C}),i.d(S,"isPrintableChar",function(){return pe}),i.d(S,"isMetaKey",function(){return ie}),i.d(S,"isCtrlKey",function(){return X}),i.d(S,"isCtrlMetaKey",function(){return F}),i.d(S,"isKey",function(){return ee});var M=i(160),C={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};function pe(ce){return ce===32||ce>=48&&ce<=57||ce>=96&&ce<=111||ce>=186&&ce<=192||ce>=219&&ce<=222||ce>=226||ce>=65&&ce<=90}function ie(ce){return[C.ARROW_DOWN,C.ARROW_UP,C.ARROW_LEFT,C.ARROW_RIGHT,C.HOME,C.END,C.DELETE,C.BACKSPACE,C.F1,C.F2,C.F3,C.F4,C.F5,C.F6,C.F7,C.F8,C.F9,C.F10,C.F11,C.F12,C.TAB,C.PAGE_DOWN,C.PAGE_UP,C.ENTER,C.ESCAPE,C.SHIFT,C.CAPS_LOCK,C.ALT].indexOf(ce)!==-1}function X(ce){var G=[];return navigator.platform.includes("Mac")?G.push(C.COMMAND_LEFT,C.COMMAND_RIGHT,C.COMMAND_FIREFOX):G.push(C.CONTROL),G.includes(ce)}function F(ce){return[C.CONTROL,C.COMMAND_LEFT,C.COMMAND_RIGHT,C.COMMAND_FIREFOX].includes(ce)}function ee(ce,G){var B=G.split("|"),V=!1;return Object(M.arrayEach)(B,function(P){if(ce===C[P])return V=!0,!1}),V}},function(ot,S,i){"use strict";i.r(S),i.d(S,"spreadsheetColumnLabel",function(){return ie}),i.d(S,"spreadsheetColumnIndex",function(){return X}),i.d(S,"createSpreadsheetData",function(){return F}),i.d(S,"createSpreadsheetObjectData",function(){return ee}),i.d(S,"createEmptySpreadsheetData",function(){return ce}),i.d(S,"translateRowsToColumns",function(){return G}),i.d(S,"cellMethodLookupFactory",function(){return B}),i.d(S,"dataRowToChangesArray",function(){return V}),i.d(S,"countFirstRowKeys",function(){return P});var M=i(216),C=i(159),pe="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;function ie(x){for(var $,fe=x+1,H="";fe>0;)$=(fe-1)%pe,H=String.fromCharCode(65+$)+H,fe=parseInt((fe-$)/pe,10);return H}function X(x){var $=0;if(x)for(var fe=0,H=x.length-1;fe<x.length;fe+=1,H-=1)$+=Math.pow(pe,H)*("ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(x[fe])+1);return $-=1}function F(){var x,$,fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,se=[];for(x=0;x<fe;x++){var I=[];for($=0;$<H;$++)I.push(ie($)+(x+1));se.push(I)}return se}function ee(){var x,$,fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,se=[];for(x=0;x<fe;x++){var I={};for($=0;$<H;$++)I["prop".concat($)]=ie($)+(x+1);se.push(I)}return se}function ce(x,$){for(var fe,H=[],se=0;se<x;se++){fe=[];for(var I=0;I<$;I++)fe.push("");H.push(fe)}return H}function G(x){var $,fe,H,se,I=[],de=0;for($=0,fe=x.length;$<fe;$++)for(H=0,se=x[$].length;H<se;H++)H===de&&(I.push([]),de+=1),I[H].push(x[$][H]);return I}function B(x,$){var fe=$===void 0||$;return function(H,se){return function I(de){if(de){if(Object(C.hasOwnProperty)(de,x)&&de[x]!==void 0)return de[x];if(Object(C.hasOwnProperty)(de,"type")&&de.type){if(typeof de.type!="string")throw new Error('Cell "type" must be a string');var l=Object(M.a)(de.type);if(Object(C.hasOwnProperty)(l,x))return l[x];if(fe)return}return I(Object.getPrototypeOf(de))}}(typeof H=="number"?this.getCellMeta(H,se):H)}}function V(x){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,fe=x,H=[];return Array.isArray(x)&&Array.isArray(x[0])||(fe=[x]),fe.forEach(function(se,I){Array.isArray(se)?se.forEach(function(de,l){H.push([I+$,l,de])}):Object.keys(se).forEach(function(de){H.push([I+$,de,se[de]])})}),H}function P(x){var $=0;return Array.isArray(x)&&(x[0]&&Array.isArray(x[0])?$=x[0].length:x[0]&&Object(C.isObject)(x[0])&&($=Object(C.deepObjectSize)(x[0]))),$}},,function(ot,S,i){"use strict";i.d(S,"a",function(){return F});var M=i(1),C=i.n(M),pe=function(){return C.a.createElement("svg",{viewBox:"0 0 24 24"},C.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),C.a.createElement("rect",{className:"svg-icon",width:14,height:2,rx:.095,transform:"translate(5 3)"}),C.a.createElement("path",{className:"svg-icon",d:"M8.116 12h2.789a.1.1 0 01.095.1v8.809a.1.1 0 00.095.1h1.81a.1.1 0 00.095-.1V12.1a.1.1 0 01.095-.1h2.789a.1.1 0 00.067-.163l-3.884-3.874a.1.1 0 00-.134 0l-3.884 3.874a.1.1 0 00.067.163z"}))},ie=i(179),X=function(ee,ce,G,B){return new(G||(G=Promise))(function(V,P){function x(H){try{fe(B.next(H))}catch(se){P(se)}}function $(H){try{fe(B.throw(H))}catch(se){P(se)}}function fe(H){var se;H.done?V(H.value):(se=H.value,se instanceof G?se:new G(function(I){I(se)})).then(x,$)}fe((B=B.apply(ee,ce||[])).next())})},F=function(ee){var ce=ee.renderWorkbook,G=ee.mobile,B=function(P){return new Promise(function(x,$){P.name&&console.log("RECEIVED FILE: ".concat(P.name));var fe=new FileReader;fe.readAsArrayBuffer(P),fe.addEventListener("load",function(H){var se;((se=H.target)===null||se===void 0?void 0:se.result)instanceof ArrayBuffer?x(H.target.result):$()})})},V=G?"toolbar-upload-input-mobile":"toolbar-upload-input";return C.a.createElement("label",{htmlFor:V},C.a.createElement("input",{type:"file",onChange:function(P){var x,$;((x=P.target)===null||x===void 0?void 0:x.files)&&($=P.target.files,X(void 0,void 0,void 0,regeneratorRuntime.mark(function fe(){var H,se;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if($.length!==0){I.next=2;break}return I.abrupt("return");case 2:if((H=$.item(0))!==null){I.next=5;break}return I.abrupt("return");case 5:return I.next=7,B(H);case 7:se=I.sent,ce({type:"arraybuffer",arrayBuffer:se,fileName:H.name});case 9:case"end":return I.stop()}},fe)})))},hidden:!0,"data-cy":V,id:V}),C.a.createElement("div",{className:"icon","data-cy":G?"toolbar-upload-button-mobile":"toolbar-upload-button"},C.a.createElement(pe,null),G?C.a.createElement(ie.a,{description:"Upload"}):C.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},C.a.createElement("span",null,"Upload"))))}},function(ot,S,i){"use strict";i.d(S,"a",function(){return F});var M=i(1),C=i.n(M),pe=function(){return C.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},C.a.createElement("path",{className:"svg-icon",d:"M447.46,404.216l0,3.4a2.286,2.286,0,0,1-2.279,2.279l-9.45-.007a1.089,1.089,0,0,0-.77.319l-2.33,2.1a.1.1,0,0,1-.169-.07V401.209a2.321,2.321,0,0,1,2.279-2.319h5.393a.1.1,0,0,0,.07-.029l1.781-1.8a.1.1,0,0,0-.07-.169h-7.174a4.327,4.327,0,0,0-4.279,4.319V414.89a1,1,0,0,0,.62.92.839.839,0,0,0,.38.08,1.007,1.007,0,0,0,.71-.29l3.919-3.688a.1.1,0,0,1,.07-.029l9.119.007a4.185,4.185,0,0,0,4.18-4.18l0-5.3a.1.1,0,0,0-.169-.07l-1.8,1.8A.1.1,0,0,0,447.46,404.216Z",transform:"translate(-427.46 -393.89)"}),C.a.createElement("path",{className:"svg-icon",d:"M466.282,397.81a3.005,3.005,0,0,0-4.249,0l-6.578,6.578a1,1,0,0,0-.293.707v2.835a1,1,0,0,0,1,1H459a1,1,0,0,0,.707-.293l6.578-6.578A3.005,3.005,0,0,0,466.282,397.81Zm-1.414,1.414.006.007a1,1,0,0,1-.006,1.414l0,0-1.421-1.42,0,0A1.008,1.008,0,0,1,464.868,399.224Zm-6.285,7.706h-1.421v-1.421l4.868-4.868,1.421,1.42Z",transform:"translate(-445.162 -394.93)"}))},ie=i(179),X=i(194),F=C.a.forwardRef(function(ee,ce){var G=ee.open,B=ee.mobile,V=B!==void 0&&B;return C.a.createElement("button",{type:"button",className:"icon",id:"feedback-icon",onClick:function(){return G(X.b)},"data-cy":V?"toolbar-feedback-button-mobile":"toolbar-feedback-button",ref:ce},C.a.createElement(pe,null),V?C.a.createElement(ie.a,{description:"Feedback"}):C.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},C.a.createElement("span",null,"Feedback")))})},function(ot,S,i){"use strict";i.d(S,"e",function(){return $}),i.d(S,"b",function(){return fe}),i.d(S,"d",function(){return H}),i.d(S,"c",function(){return se}),i.d(S,"a",function(){return ce});var M,C=i(159),pe=i(246),ie=i(180),X=i(172);function F(I,de,l){return de in I?Object.defineProperty(I,de,{value:l,enumerable:!0,configurable:!0,writable:!0}):I[de]=l,I}/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var ee=(F(M={languageCode:"en-US"},X.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),F(M,X.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),F(M,X.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),F(M,X.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),F(M,X.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),F(M,X.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),F(M,X.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),F(M,X.CONTEXTMENU_ITEMS_UNDO,"Undo"),F(M,X.CONTEXTMENU_ITEMS_REDO,"Redo"),F(M,X.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),F(M,X.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),F(M,X.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),F(M,X.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),F(M,X.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),F(M,X.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),F(M,X.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),F(M,X.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),F(M,X.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),F(M,X.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),F(M,X.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),F(M,X.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),F(M,X.CONTEXTMENU_ITEMS_BORDERS,"Borders"),F(M,X.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),F(M,X.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),F(M,X.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),F(M,X.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),F(M,X.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),F(M,X.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),F(M,X.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),F(M,X.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),F(M,X.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),F(M,X.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),F(M,X.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),F(M,X.CONTEXTMENU_ITEMS_COPY,"Copy"),F(M,X.CONTEXTMENU_ITEMS_CUT,"Cut"),F(M,X.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),F(M,X.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),F(M,X.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),F(M,X.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),F(M,X.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),F(M,X.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),F(M,X.FILTERS_CONDITIONS_NONE,"None"),F(M,X.FILTERS_CONDITIONS_EMPTY,"Is empty"),F(M,X.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),F(M,X.FILTERS_CONDITIONS_EQUAL,"Is equal to"),F(M,X.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),F(M,X.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),F(M,X.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),F(M,X.FILTERS_CONDITIONS_CONTAINS,"Contains"),F(M,X.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),F(M,X.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),F(M,X.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),F(M,X.FILTERS_CONDITIONS_LESS_THAN,"Less than"),F(M,X.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),F(M,X.FILTERS_CONDITIONS_BETWEEN,"Is between"),F(M,X.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),F(M,X.FILTERS_CONDITIONS_AFTER,"After"),F(M,X.FILTERS_CONDITIONS_BEFORE,"Before"),F(M,X.FILTERS_CONDITIONS_TODAY,"Today"),F(M,X.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),F(M,X.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),F(M,X.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),F(M,X.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),F(M,X.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),F(M,X.FILTERS_LABELS_CONJUNCTION,"And"),F(M,X.FILTERS_LABELS_DISJUNCTION,"Or"),F(M,X.FILTERS_BUTTONS_SELECT_ALL,"Select all"),F(M,X.FILTERS_BUTTONS_CLEAR,"Clear"),F(M,X.FILTERS_BUTTONS_OK,"OK"),F(M,X.FILTERS_BUTTONS_CANCEL,"Cancel"),F(M,X.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),F(M,X.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),F(M,X.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),M),ce=ee.languageCode,G=Object(ie.a)("languagesDictionaries"),B=G.register,V=G.getItem,P=G.hasItem,x=G.getValues;function $(I,de){var l=I,K=de;return Object(C.isObject)(I)&&(l=(K=I).languageCode),function(ne,le){ne!==ce&&Object(pe.a)(le,V(ce))}(l,K),B(l,Object(C.deepClone)(K)),Object(C.deepClone)(K)}function fe(I){return H(I)?Object(C.deepClone)(V(I)):null}function H(I){return P(I)}function se(){return x()}$(ee)},,function(ot,S,i){"use strict";i.d(S,"a",function(){return M}),i.d(S,"b",function(){return C}),new Map([["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.ms-excel","xls"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/x-iwork-numbers-sffnumbers","numbers"],["application/vnd.apple.numbers","numbers"]]);var M=function(pe){return pe.fileName!==void 0||pe.type==="arraybuffer"?pe.fileName:function(ie){if(!ie.startsWith("data:")){var X=ie.split("/").pop();if(X!==void 0&&X.length!==0)return X}}(pe.url)},C="Unnamed file"},function(ot,S,i){"use strict";var M=i(190);i.o(M,"useModals")&&i.d(S,"useModals",function(){return M.useModals});var C=i(193);i.d(S,"useModals",function(){return C.a})},,,,,function(ot,S,i){"use strict";i.d(S,"d",function(){return P}),i.d(S,"a",function(){return V}),i.d(S,"b",function(){return B}),i.d(S,"c",function(){return ce});var M=i(180),C=i(186),pe=new WeakMap,ie=Object(M.a)("editors"),X=ie.register,F=ie.getItem,ee=ie.hasItem,ce=ie.getNames;ie.getValues;function G(x){var $={},fe=x;this.getConstructor=function(){return x},this.getInstance=function(H){return H.guid in $||($[H.guid]=new fe(H)),$[H.guid]},C.a.getSingleton().add("afterDestroy",function(){$[this.guid]=null})}function B(x,$){var fe;if(typeof x=="function")pe.get(x)||P(null,x),fe=pe.get(x);else{if(typeof x!="string")throw Error('Only strings and functions can be passed as "editor" parameter');fe=F(x)}if(!fe)throw Error('No editor registered under name "'.concat(x,'"'));return fe.getInstance($)}function V(x){if(!ee(x))throw Error('No registered editor found under "'.concat(x,'" name'));return F(x).getConstructor()}function P(x,$){var fe=new G($);typeof x=="string"&&X(x,fe),pe.set($,fe)}},function(ot,S,i){"use strict";i.d(S,"c",function(){return pe}),i.d(S,"b",function(){return ee}),i.d(S,"a",function(){return F});var M=i(180),C=Object(M.a)("validators"),pe=C.register,ie=C.getItem,X=C.hasItem,F=C.getNames;C.getValues;function ee(ce){if(typeof ce=="function")return ce;if(!X(ce))throw Error('No registered validator found under "'.concat(ce,'" name'));return ie(ce)}},function(ot,S,i){"use strict";i.d(S,"c",function(){return V}),i.d(S,"a",function(){return B}),i.d(S,"b",function(){return G});var M=i(180),C=i(214),pe=i(224),ie=i(215),X=Object(M.a)("cellTypes"),F=X.register,ee=X.getItem,ce=X.hasItem,G=X.getNames;X.getValues;function B(P){if(!ce(P))throw Error('You declared cell type "'.concat(P,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method`));return ee(P)}function V(P,x){var $=x.editor,fe=x.renderer,H=x.validator;$&&Object(C.d)(P,$),fe&&Object(pe.c)(P,fe),H&&Object(ie.c)(P,H),F(P,x)}},function(ot,S,i){"use strict";i.r(S),i.d(S,"instanceToHTML",function(){return ce}),i.d(S,"_dataToHTML",function(){return G}),i.d(S,"htmlToGridSettings",function(){return B});var M=i(161),C=i(167);function pe(V){return function(P){if(Array.isArray(P))return ie(P)}(V)||function(P){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(P))return Array.from(P)}(V)||function(P,x){if(!!P){if(typeof P=="string")return ie(P,x);var $=Object.prototype.toString.call(P).slice(8,-1);if($==="Object"&&P.constructor&&($=P.constructor.name),$==="Map"||$==="Set")return Array.from(P);if($==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return ie(P,x)}}(V)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ie(V,P){(P==null||P>V.length)&&(P=V.length);for(var x=0,$=new Array(P);x<P;x++)$[x]=V[x];return $}var X={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},F=new RegExp(Object.keys(X).map(function(V){return"(".concat(V,")")}).join("|"),"gi");function ee(V){return(V&&V.nodeName||"")==="TABLE"}function ce(V){for(var P=V.hasColHeaders(),x=V.hasRowHeaders(),$=[P?-1:0,x?-1:0,V.countRows()-1,V.countCols()-1],fe=V.getData.apply(V,$),H=fe.length,se=H>0?fe[0].length:0,I=["<table>","</table>"],de=P?["<thead>","</thead>"]:[],l=["<tbody>","</tbody>"],K=x?1:0,ne=P?1:0,le=0;le<H;le+=1){for(var Re=P&&le===0,De=[],He=0;He<se;He+=1){var me=!Re&&x&&He===0,Se="";if(Re)Se="<th>".concat(V.getColHeader(He-K),"</th>");else if(me)Se="<th>".concat(V.getRowHeader(le-ne),"</th>");else{var Ie=fe[le][He],Le=V.getCellMeta(le-K,He-ne),we=Le.hidden,Ve=Le.rowspan,je=Le.colspan;if(!we){var Ke=[];if(Ve&&Ke.push('rowspan="'.concat(Ve,'"')),je&&Ke.push('colspan="'.concat(je,'"')),Object(C.isEmpty)(Ie))Se="<td ".concat(Ke.join(" "),"></td>");else{var $e=Ie.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");Se="<td ".concat(Ke.join(" "),">").concat($e,"</td>")}}}De.push(Se)}var Ye=["<tr>"].concat(De,["</tr>"]).join("");Re?de.splice(1,0,Ye):l.splice(-1,0,Ye)}return I.splice(1,0,de.join(""),l.join("")),I.join("")}function G(V){for(var P=V.length,x=["<table>"],$=0;$<P;$+=1){var fe=V[$],H=fe.length,se=[];$===0&&x.push("<tbody>");for(var I=0;I<H;I+=1){var de=fe[I],l=Object(C.isEmpty)(de)?"":de.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");se.push("<td>".concat(l,"</td>"))}x.push.apply(x,["<tr>"].concat(se,["</tr>"])),$+1===P&&x.push("</tbody>")}return x.push("</table>"),x.join("")}function B(V){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,x={},$=P.createDocumentFragment(),fe=P.createElement("div");$.appendChild(fe);var H=V;if(typeof H=="string"){var se=H.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(Ze){var at=Ze.match(/<td\b[^>]*?>/g)[0],ut=Ze.substring(at.length,Ze.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(at).concat(ut).concat("</td>")});fe.insertAdjacentHTML("afterbegin","".concat(se)),H=fe.querySelector("table")}if(H&&ee(H)){var I=fe.querySelector("style"),de=null,l=[];I&&(P.body.appendChild(I),I.disabled=!0,de=I.sheet,l=de?Array.from(de.cssRules):[],P.body.removeChild(I));var K=fe.querySelector('meta[name$="enerator"]'),ne=H.querySelector("tbody th")!==null,le=Array.from(H.querySelector("tr").cells).reduce(function(Ze,at){return Ze+at.colSpan},0)-(ne?1:0),Re=H.tFoot&&Array.from(H.tFoot.rows)||[],De=[],He=!1,me=0,Se=0;if(H.tHead){var Ie=Array.from(H.tHead.rows).filter(function(Ze){var at=Ze.querySelector("td")!==null;return at&&De.push(Ze),!at});He=(me=Ie.length)>0,me>1?x.nestedHeaders=Array.from(Ie).reduce(function(Ze,at){var ut=Array.from(at.cells).reduce(function(be,Z,he){if(ne&&he===0)return be;var O=Z.colSpan,re=Z.innerHTML,Oe=O>1?{label:re,colspan:O}:re;return be.push(Oe),be},[]);return Ze.push(ut),Ze},[]):He&&(x.colHeaders=Array.from(Ie[0].children).reduce(function(Ze,at,ut){return ne&&ut===0||Ze.push(at.innerHTML),Ze},[]))}De.length&&(x.fixedRowsTop=De.length),Re.length&&(x.fixedRowsBottom=Re.length);var Le=[].concat(De,pe(Array.from(H.tBodies).reduce(function(Ze,at){return Ze.push.apply(Ze,pe(Array.from(at.rows))),Ze},[])),pe(Re));Se=Le.length;for(var we=new Array(Se),Ve=0;Ve<Se;Ve++)we[Ve]=new Array(le);for(var je=[],Ke=[],$e=0;$e<Se;$e++)for(var Ye=Le[$e],ht=Array.from(Ye.cells),Qe=ht.length,ct=function(Ze){var at=ht[Ze],ut=at.nodeName,be=at.innerHTML,Z=at.rowSpan,he=at.colSpan,O=we[$e].findIndex(function(Ge){return Ge===void 0});if(ut==="TD"){if(Z>1||he>1){for(var re=$e;re<$e+Z;re++)if(re<Se)for(var Oe=O;Oe<O+he;Oe++)we[re][Oe]=null;var Ee=at.getAttribute("style");Ee&&Ee.includes("mso-ignore:colspan")||je.push({col:O,row:$e,rowspan:Z,colspan:he})}var ve="";ve=l.reduce(function(Ge,Je){if(Object(M.matchesCSSRules)(at,Je)){var ft=Je.style.whiteSpace;ft&&(Ge.whiteSpace=ft)}return Ge},{}).whiteSpace==="nowrap"?be.replace(/[\r\n][\x20]{0,2}/gim," ").replace(/<br(\s*|\/)>/gim,`\r
`):K&&/excel/gi.test(K.content)?be.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):be.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),we[$e][O]=ve.replace(F,function(Ge){return X[Ge]})}else Ke.push(be)},We=0;We<Qe;We++)ct(We);return je.length&&(x.mergeCells=je),Ke.length&&(x.rowHeaders=Ke),we.length&&(x.data=we),x}}},function(ot,S,i){"use strict";i.d(S,"a",function(){return X});var M=i(184),C=i(165);function pe(F){var ee=F.isShiftKey,ce=F.isLeftClick,G=F.isRightClick,B=F.coords,V=F.selection,P=F.controller,x=V.isSelected()?V.getSelectedRange().current():null,$=V.isSelectedByCorner(),fe=V.isSelectedByRowHeader();if(ee&&x)B.row>=0&&B.col>=0&&!P.cells?V.setRangeEnd(B):($||fe)&&B.row>=0&&B.col>=0&&!P.cells?V.setRangeEnd(new C.a(B.row,B.col)):$&&B.row<0&&!P.column?V.setRangeEnd(new C.a(x.to.row,B.col)):fe&&B.col<0&&!P.row?V.setRangeEnd(new C.a(B.row,x.to.col)):(!$&&!fe&&B.col<0||$&&B.col<0)&&!P.row?V.selectRows(x.from.row,B.row):(!$&&!fe&&B.row<0||fe&&B.row<0)&&!P.column&&V.selectColumns(x.from.col,B.col);else{var H=new C.a(B.row,B.col);H.row<0&&(H.row=0),H.col<0&&(H.col=0);var se=!V.inInSelection(H),I=ce||G&&se;B.row<0&&B.col>=0&&!P.column?I&&V.selectColumns(B.col):B.col<0&&B.row>=0&&!P.row?I&&V.selectRows(B.row):B.col>=0&&B.row>=0&&!P.cells?I&&V.setRangeStart(B):B.col<0&&B.row<0&&V.selectAll()}}var ie=new Map([["mousedown",pe],["mouseover",function(F){var ee=F.isLeftClick,ce=F.coords,G=F.selection,B=F.controller;if(ee){var V=G.isSelectedByRowHeader(),P=G.isSelectedByColumnHeader(),x=G.tableProps.countCols(),$=G.tableProps.countRows();P&&!B.column?G.setRangeEnd(new C.a($-1,ce.col)):V&&!B.row?G.setRangeEnd(new C.a(ce.row,x-1)):B.cell||G.setRangeEnd(ce)}}],["touchstart",pe]]);function X(F,ee){var ce=ee.coords,G=ee.selection,B=ee.controller;ie.get(F.type)({coords:ce,selection:G,controller:B,isShiftKey:F.shiftKey,isLeftClick:Object(M.isLeftClick)(F)||F.type==="touchstart",isRightClick:Object(M.isRightClick)(F)})}},function(ot,S,i){"use strict";i.d(S,"b",function(){return ee});var M=i(167),C=i(159),pe=i(189);function ie(ce,G){for(var B=0;B<G.length;B++){var V=G[B];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(ce,V.key,V)}}var X=0,F=function(){function ce(){(function(P,x){if(!(P instanceof x))throw new TypeError("Cannot call a class as a function")})(this,ce),this.collection=new Map}var G,B,V;return G=ce,(B=[{key:"register",value:function(P,x){var $=this;this.collection.has(P)===!1&&(this.collection.set(P,x),x.addLocalHook("change",function(){return $.runLocalHooks("change",x)}),X+=1)}},{key:"unregister",value:function(P){var x=this.collection.get(P);Object(M.isDefined)(x)&&(x.clearLocalHooks(),this.collection.delete(P),this.runLocalHooks("change",x),X-=1)}},{key:"get",value:function(P){return Object(M.isUndefined)(P)?Array.from(this.collection.values()):this.collection.get(P)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(P){this.collection.forEach(function(x){x.remove(P)})}},{key:"insertToEvery",value:function(P,x){this.collection.forEach(function($){$.insert(P,x)})}},{key:"initEvery",value:function(P){this.collection.forEach(function(x){x.init(P)})}}])&&ie(G.prototype,B),V&&ie(G,V),ce}();function ee(){return X}Object(C.mixin)(F,pe.a),S.a=F},function(ot,S,i){"use strict";var M=i(161),C=i(160),pe=i(183);function ie(F,ee){for(var ce=0;ce<ee.length;ce++){var G=ee[ce];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(F,G.key,G)}}var X=function(){function F(B){(function(V,P){if(!(V instanceof P))throw new TypeError("Cannot call a class as a function")})(this,F),this.hot=B,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}var ee,ce,G;return ee=F,(ce=[{key:"addRow",value:function(B,V){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var P={row:B};this.rows.push(P),this.samples=V,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(B)),this.container.container.appendChild(this.table.fragment),P.table=this.table.table}},{key:"addColumnHeadersRow",value:function(B){var V=this.hot.getColHeader(0);if(V!=null){var P={row:-1};this.rows.push(P),this.container=this.createContainer(this.hot.rootElement.className),this.samples=B,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),P.table=this.table.table,Object(M.removeClass)(this.table.tBody,"afterEmptyThead")}else Object(M.addClass)(this.table.tBody,"afterEmptyThead")}},{key:"addColumn",value:function(B,V){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var P={col:B};this.columns.push(P),this.samples=V,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(B)!==null&&this.hot.view.appendColHeader(B,this.table.th),this.table.tBody.appendChild(this.createCol(B)),this.container.container.appendChild(this.table.fragment),P.table=this.table.table}},{key:"getHeights",value:function(B){this.injected||this.injectTable(),Object(C.arrayEach)(this.rows,function(V){B(V.row,Object(M.outerHeight)(V.table)-pe.a)})}},{key:"getWidths",value:function(B){this.injected||this.injectTable(),Object(C.arrayEach)(this.columns,function(V){var P=V.table.getBoundingClientRect().width,x=Math.ceil(P);B(V.col,x)})}},{key:"setSettings",value:function(B){this.settings=B}},{key:"setSetting",value:function(B,V){this.settings||(this.settings={}),this.settings[B]=V}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(B){return this.settings?this.settings[B]:null}},{key:"createColGroupsCol",value:function(){var B=this,V=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&V.appendChild(this.createColElement(-1)),this.samples.forEach(function(P){Object(C.arrayEach)(P.strings,function(x){V.appendChild(B.createColElement(x.col))})}),V}},{key:"createRow",value:function(B){var V=this,P=this.hot.rootDocument,x=P.createDocumentFragment(),$=P.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(B,$),x.appendChild($)),this.samples.forEach(function(fe){Object(C.arrayEach)(fe.strings,function(H){var se=H.col,I=V.hot.getCellMeta(B,se);I.col=se,I.row=B;var de=V.hot.getCellRenderer(I),l=P.createElement("td");l.setAttribute("ghost-table",1),de(V.hot,l,B,se,V.hot.colToProp(se),H.value,I),x.appendChild(l)})}),x}},{key:"createColumnHeadersRow",value:function(){var B=this,V=this.hot.rootDocument,P=V.createDocumentFragment();if(this.hot.hasRowHeaders()){var x=V.createElement("th");this.hot.view.appendColHeader(-1,x),P.appendChild(x)}return this.samples.forEach(function($){Object(C.arrayEach)($.strings,function(fe){var H=fe.col,se=V.createElement("th");B.hot.view.appendColHeader(H,se),P.appendChild(se)})}),P}},{key:"createCol",value:function(B){var V=this,P=this.hot.rootDocument,x=P.createDocumentFragment();return this.samples.forEach(function($){Object(C.arrayEach)($.strings,function(fe){var H=fe.row,se=V.hot.getCellMeta(H,B);se.col=B,se.row=H;var I=V.hot.getCellRenderer(se),de=P.createElement("td"),l=P.createElement("tr");de.setAttribute("ghost-table",1),I(V.hot,de,H,B,V.hot.colToProp(B),fe.value,se),l.appendChild(de),x.appendChild(l)})}),x}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((B||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(B){var V=this.hot.rootDocument.createElement("col");return V.style.width="".concat(this.hot.view.wt.columnUtils.getStretchedColumnWidth(B),"px"),V}},{key:"createTable",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",V=this.hot.rootDocument,P=V.createDocumentFragment(),x=V.createElement("table"),$=V.createElement("thead"),fe=V.createElement("tbody"),H=V.createElement("colgroup"),se=V.createElement("tr"),I=V.createElement("th");return this.isVertical()&&x.appendChild(H),this.isHorizontal()&&(se.appendChild(I),$.appendChild(se),x.style.tableLayout="auto",x.style.width="auto"),x.appendChild($),this.isVertical()&&fe.appendChild(se),Object(M.addClass)(fe,"afterEmptyThead"),x.appendChild(fe),Object(M.addClass)(x,B),P.appendChild(x),{fragment:P,table:x,tHead:$,tBody:fe,colGroup:H,tr:se,th:I}}},{key:"createContainer",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",V=this.hot.rootDocument,P=V.createDocumentFragment(),x=V.createElement("div"),$="htGhostTable htAutoSize ".concat(B.trim());return Object(M.addClass)(x,$),P.appendChild(x),{fragment:P,container:x}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}])&&ie(ee.prototype,ce),G&&ie(ee,G),F}();S.a=X},function(ot,S,i){"use strict";i.d(S,"b",function(){return C}),i.d(S,"a",function(){return pe}),i.d(S,"c",function(){return ie}),i.d(S,"d",function(){return X});var M=0,C=function(){(M+=1)===1&&delete document.body.dataset.embedsLoaded},pe=function(){(M=Math.max(M-1,0))===0&&setTimeout(function(){document.body.dataset.embedsLoaded=""},0)},ie=function(){M=0,C()},X=function(){pe()}},function(ot,S,i){"use strict";i.d(S,"a",function(){return mn}),i.d(S,"b",function(){return Ke});var M=i(160);function C(W){return function(R){if(Array.isArray(R))return pe(R)}(W)||function(R){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(R))return Array.from(R)}(W)||function(R,U){if(!!R){if(typeof R=="string")return pe(R,U);var s=Object.prototype.toString.call(R).slice(8,-1);if(s==="Object"&&R.constructor&&(s=R.constructor.name),s==="Map"||s==="Set")return Array.from(R);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return pe(R,U)}}(W)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function pe(W,R){(R==null||R>W.length)&&(R=W.length);for(var U=0,s=new Array(R);U<R;U++)s[U]=W[U];return s}function ie(W,R,U){return[].concat(C(W.slice(0,R)),C(U),C(W.slice(R)))}function X(W,R){return Object(M.arrayFilter)(W,function(U){return R.includes(U)===!1})}var F=i(171),ee=i(159),ce=i(188),G=i(189);function B(W,R){if(!(W instanceof R))throw new TypeError("Cannot call a class as a function")}function V(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}var P=function(){function W(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;B(this,W),this.indexedValues=[],this.initValueOrFn=u}var R,U,s;return R=W,(U=[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(u){var v=this.getValues();if(u<v.length)return v[u]}},{key:"setValues",value:function(u){this.indexedValues=u.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(u,v){return u<this.getLength()&&(this.indexedValues[u]=v,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var u=this,v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Object(ce.isFunction)(this.initValueOrFn)?Object(F.rangeEach)(v-1,function(k){return u.indexedValues.push(u.initValueOrFn(k))}):Object(F.rangeEach)(v-1,function(){return u.indexedValues.push(u.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(u){return this.setDefaultValues(u),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}}])&&V(R.prototype,U),s&&V(R,s),W}();Object(ee.mixin)(P,G.a);var x=P;function $(W){return function(R){if(Array.isArray(R))return fe(R)}(W)||function(R){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(R))return Array.from(R)}(W)||function(R,U){if(!!R){if(typeof R=="string")return fe(R,U);var s=Object.prototype.toString.call(R).slice(8,-1);if(s==="Object"&&R.constructor&&(s=R.constructor.name),s==="Map"||s==="Set")return Array.from(R);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return fe(R,U)}}(W)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function fe(W,R){(R==null||R>W.length)&&(R=W.length);for(var U=0,s=new Array(R);U<R;U++)s[U]=W[U];return s}function H(W,R,U,s){var u=U[0];return[].concat($(W.slice(0,u)),$(U.map(function(v,k){return Object(ce.isFunction)(s)?s(v,k):s})),$(W.slice(u)))}function se(W,R){return Object(M.arrayFilter)(W,function(U,s){return R.includes(s)===!1})}new Map([["indexesSequence",{getListWithInsertedItems:ie,getListWithRemovedItems:X}],["physicallyIndexed",{getListWithInsertedItems:H,getListWithRemovedItems:se}]]);function I(W){return(I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}function de(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}function l(W,R,U){return(l=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(s,u,v){var k=function(q,y){for(;!Object.prototype.hasOwnProperty.call(q,y)&&(q=Re(q))!==null;);return q}(s,u);if(k){var j=Object.getOwnPropertyDescriptor(k,u);return j.get?j.get.call(v):j.value}})(W,R,U||W)}function K(W,R){return(K=Object.setPrototypeOf||function(U,s){return U.__proto__=s,U})(W,R)}function ne(W){var R=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}();return function(){var U,s=Re(W);if(R){var u=Re(this).constructor;U=Reflect.construct(s,arguments,u)}else U=s.apply(this,arguments);return le(this,U)}}function le(W,R){return!R||I(R)!=="object"&&typeof R!="function"?function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}(W):R}function Re(W){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})(W)}var De=function(W){(function(k,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(j&&j.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),j&&K(k,j)})(v,W);var R,U,s,u=ne(v);function v(){return function(k,j){if(!(k instanceof j))throw new TypeError("Cannot call a class as a function")}(this,v),u.call(this,function(k){return k})}return R=v,(U=[{key:"insert",value:function(k,j){var q=function(y,_,Y){var ue=Y[0],Te=Y.length;return Object(M.arrayMap)(y,function(Fe){return Fe>=ue?Fe+Te:Fe})}(this.indexedValues,0,j);this.indexedValues=ie(q,k,j),l(Re(v.prototype),"insert",this).call(this,k,j)}},{key:"remove",value:function(k){var j=X(this.indexedValues,k);this.indexedValues=function(q,y){return Object(M.arrayMap)(q,function(_){return _-y.filter(function(Y){return Y<_}).length})}(j,k),l(Re(v.prototype),"remove",this).call(this,k)}}])&&de(R.prototype,U),s&&de(R,s),v}(x);function He(W){return(He=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}function me(W,R){if(!(W instanceof R))throw new TypeError("Cannot call a class as a function")}function Se(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}function Ie(W,R,U){return(Ie=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(s,u,v){var k=function(q,y){for(;!Object.prototype.hasOwnProperty.call(q,y)&&(q=je(q))!==null;);return q}(s,u);if(k){var j=Object.getOwnPropertyDescriptor(k,u);return j.get?j.get.call(v):j.value}})(W,R,U||W)}function Le(W,R){return(Le=Object.setPrototypeOf||function(U,s){return U.__proto__=s,U})(W,R)}function we(W){var R=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}();return function(){var U,s=je(W);if(R){var u=je(this).constructor;U=Reflect.construct(s,arguments,u)}else U=s.apply(this,arguments);return Ve(this,U)}}function Ve(W,R){return!R||He(R)!=="object"&&typeof R!="function"?function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}(W):R}function je(W){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})(W)}var Ke=function(W){(function(k,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(j&&j.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),j&&Le(k,j)})(v,W);var R,U,s,u=we(v);function v(){return me(this,v),u.apply(this,arguments)}return R=v,(U=[{key:"insert",value:function(k,j){this.indexedValues=H(this.indexedValues,0,j,this.initValueOrFn),Ie(je(v.prototype),"insert",this).call(this,k,j)}},{key:"remove",value:function(k){this.indexedValues=se(this.indexedValues,k),Ie(je(v.prototype),"remove",this).call(this,k)}}])&&Se(R.prototype,U),s&&Se(R,s),v}(x);function $e(W){return($e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}function Ye(W,R){if(!(W instanceof R))throw new TypeError("Cannot call a class as a function")}function ht(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}function Qe(W,R){return(Qe=Object.setPrototypeOf||function(U,s){return U.__proto__=s,U})(W,R)}function ct(W){var R=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}();return function(){var U,s=Ze(W);if(R){var u=Ze(this).constructor;U=Reflect.construct(s,arguments,u)}else U=s.apply(this,arguments);return We(this,U)}}function We(W,R){return!R||$e(R)!=="object"&&typeof R!="function"?function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}(W):R}function Ze(W){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})(W)}var at=function(W){(function(k,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(j&&j.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),j&&Qe(k,j)})(v,W);var R,U,s,u=ct(v);function v(){var k=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Ye(this,v),u.call(this,k)}return R=v,(U=[{key:"getTrimmedIndexes",value:function(){return Object(M.arrayReduce)(this.getValues(),function(k,j,q){return j&&k.push(q),k},[])}}])&&ht(R.prototype,U),s&&ht(R,s),v}(Ke);function ut(W){return(ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}function be(W,R){if(!(W instanceof R))throw new TypeError("Cannot call a class as a function")}function Z(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}function he(W,R){return(he=Object.setPrototypeOf||function(U,s){return U.__proto__=s,U})(W,R)}function O(W){var R=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}();return function(){var U,s=Oe(W);if(R){var u=Oe(this).constructor;U=Reflect.construct(s,arguments,u)}else U=s.apply(this,arguments);return re(this,U)}}function re(W,R){return!R||ut(R)!=="object"&&typeof R!="function"?function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}(W):R}function Oe(W){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})(W)}var Ee=function(W){(function(k,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(j&&j.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),j&&he(k,j)})(v,W);var R,U,s,u=O(v);function v(){var k=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return be(this,v),u.call(this,k)}return R=v,(U=[{key:"getHiddenIndexes",value:function(){return Object(M.arrayReduce)(this.getValues(),function(k,j,q){return j&&k.push(q),k},[])}}])&&Z(R.prototype,U),s&&Z(R,s),v}(Ke),ve=i(219),Ge=i(167);function Je(W){return(Je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}function ft(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}function tt(W,R){return(tt=Object.setPrototypeOf||function(U,s){return U.__proto__=s,U})(W,R)}function yt(W){var R=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}();return function(){var U,s=Ot(W);if(R){var u=Ot(this).constructor;U=Reflect.construct(s,arguments,u)}else U=s.apply(this,arguments);return bt(this,U)}}function bt(W,R){return!R||Je(R)!=="object"&&typeof R!="function"?function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}(W):R}function Ot(W){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})(W)}var Jt=function(W){(function(k,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(j&&j.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),j&&tt(k,j)})(v,W);var R,U,s,u=yt(v);function v(k,j){var q;return function(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}(this,v),(q=u.call(this)).mergedValuesCache=[],q.aggregationFunction=k,q.fallbackValue=j,q}return R=v,(U=[{key:"getMergedValues",value:function(){var k=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];if(k===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var j=Object(M.arrayMap)(this.get(),function(Te){return Te.getValues()}),q=[],y=Object(Ge.isDefined)(j[0])&&j[0].length||0,_=0;_<y;_+=1){for(var Y=[],ue=0;ue<this.getLength();ue+=1)Y.push(j[ue][_]);q.push(Y)}return Object(M.arrayMap)(q,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(k,j){var q=this.getMergedValues(j)[k];return Object(Ge.isDefined)(q)?q:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}])&&ft(R.prototype,U),s&&ft(R,s),v}(ve.a);function Gt(W){return function(R){if(Array.isArray(R))return Qt(R)}(W)||function(R){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(R))return Array.from(R)}(W)||function(R,U){if(!!R){if(typeof R=="string")return Qt(R,U);var s=Object.prototype.toString.call(R).slice(8,-1);if(s==="Object"&&R.constructor&&(s=R.constructor.name),s==="Map"||s==="Set")return Array.from(R);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Qt(R,U)}}(W)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Qt(W,R){(R==null||R>W.length)&&(R=W.length);for(var U=0,s=new Array(R);U<R;U++)s[U]=W[U];return s}function rn(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}var an=function(){function W(){var u=this;(function(v,k){if(!(v instanceof k))throw new TypeError("Cannot call a class as a function")})(this,W),this.indexesSequence=new De,this.trimmingMapsCollection=new Jt(function(v){return v.some(function(k){return k===!0})},!1),this.hidingMapsCollection=new Jt(function(v){return v.some(function(k){return k===!0})},!1),this.variousMapsCollection=new ve.a,this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){u.indexesSequenceChanged=!0,u.updateCache(),u.runLocalHooks("change",u.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(v){u.trimmedIndexesChanged=!0,u.updateCache(),u.runLocalHooks("change",v,u.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(v){u.hiddenIndexesChanged=!0,u.updateCache(),u.runLocalHooks("change",v,u.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(v){u.runLocalHooks("change",v,u.variousMapsCollection)})}var R,U,s;return R=W,(U=[{key:"executeBatchOperations",value:function(u){var v=this.isBatched;this.isBatched=!0,u(),this.isBatched=v,this.updateCache()}},{key:"registerMap",value:function(u,v){if(this.trimmingMapsCollection.get(u)||this.hidingMapsCollection.get(u)||this.variousMapsCollection.get(u))throw Error('Map with name "'.concat(u,'" has been already registered.'));v instanceof at?this.trimmingMapsCollection.register(u,v):v instanceof Ee?this.hidingMapsCollection.register(u,v):this.variousMapsCollection.register(u,v);var k=this.getNumberOfIndexes();return k>0&&v.init(k),v}},{key:"unregisterMap",value:function(u){this.trimmingMapsCollection.unregister(u),this.hidingMapsCollection.unregister(u),this.variousMapsCollection.unregister(u)}},{key:"getPhysicalFromVisualIndex",value:function(u){var v=this.notTrimmedIndexesCache[u];return Object(Ge.isDefined)(v)?v:null}},{key:"getPhysicalFromRenderableIndex",value:function(u){var v=this.renderablePhysicalIndexesCache[u];return Object(Ge.isDefined)(v)?v:null}},{key:"getVisualFromPhysicalIndex",value:function(u){var v=this.fromPhysicalToVisualIndexesCache.get(u);return Object(Ge.isDefined)(v)?v:null}},{key:"getVisualFromRenderableIndex",value:function(u){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(u))}},{key:"getRenderableFromVisualIndex",value:function(u){var v=this.fromVisualToRenderableIndexesCache.get(u);return Object(Ge.isDefined)(v)?v:null}},{key:"getFirstNotHiddenIndex",value:function(u,v){var k=arguments.length>2&&arguments[2]!==void 0&&arguments[2],j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:u-v,q=this.getPhysicalFromVisualIndex(u);return q===null?k===!0&&j!==u-v?this.getFirstNotHiddenIndex(j,-v,!1,j):null:this.isHidden(q)===!1?u:this.getFirstNotHiddenIndex(u+v,v,k,j)}},{key:"initToLength",value:function(){var u=this,v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Gt(new Array(v).keys()),this.notHiddenIndexesCache=Gt(new Array(v).keys()),this.executeBatchOperations(function(){u.indexesSequence.init(v),u.trimmingMapsCollection.initEvery(v)}),this.executeBatchOperations(function(){u.hidingMapsCollection.initEvery(v),u.variousMapsCollection.initEvery(v)}),this.runLocalHooks("init")}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(u){this.indexesSequence.setValues(u)}},{key:"getNotTrimmedIndexes",value:function(){var u=this,v=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return v===!0?this.notTrimmedIndexesCache:Object(M.arrayFilter)(this.getIndexesSequence(),function(k){return u.isTrimmed(k)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var u=this,v=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return v===!0?this.notHiddenIndexesCache:Object(M.arrayFilter)(this.getIndexesSequence(),function(k){return u.isHidden(k)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var u=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];if(u===!0)return this.renderablePhysicalIndexesCache;var v=this.getNotTrimmedIndexes(),k=this.getNotHiddenIndexes();return v.filter(function(j){return k.includes(j)})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(u,v){var k=this;typeof u=="number"&&(u=[u]);var j=Object(M.arrayMap)(u,function(Te){return k.getPhysicalFromVisualIndex(Te)}),q=this.getNotTrimmedIndexesLength(),y=u.length,_=X(this.getIndexesSequence(),j),Y=q-y;if(v+y<q){var ue=_.filter(function(Te){return k.isTrimmed(Te)===!1})[v];Y=_.indexOf(ue)}this.setIndexesSequence(ie(_,Y,j))}},{key:"isTrimmed",value:function(u){return this.trimmingMapsCollection.getMergedValueAtIndex(u)}},{key:"isHidden",value:function(u){return this.hidingMapsCollection.getMergedValueAtIndex(u)}},{key:"insertIndexes",value:function(u,v){var k=this,j=this.getNotTrimmedIndexes()[u],q=Object(Ge.isDefined)(j)?j:this.getNumberOfIndexes(),y=this.getIndexesSequence().includes(j)?this.getIndexesSequence().indexOf(j):this.getNumberOfIndexes(),_=Object(M.arrayMap)(new Array(v).fill(q),function(Y,ue){return Y+ue});this.executeBatchOperations(function(){k.indexesSequence.insert(y,_),k.trimmingMapsCollection.insertToEvery(y,_),k.hidingMapsCollection.insertToEvery(y,_),k.variousMapsCollection.insertToEvery(y,_)})}},{key:"removeIndexes",value:function(u){var v=this;this.executeBatchOperations(function(){v.indexesSequence.remove(u),v.trimmingMapsCollection.removeFromEvery(u),v.hidingMapsCollection.removeFromEvery(u),v.variousMapsCollection.removeFromEvery(u)})}},{key:"updateCache",value:function(){var u=arguments.length>0&&arguments[0]!==void 0&&arguments[0],v=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(u===!0||this.isBatched===!1&&v===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.runLocalHooks("cacheUpdated",this.indexesSequenceChanged,this.trimmedIndexesChanged,this.hiddenIndexesChanged),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var u=this.notTrimmedIndexesCache,v=this.getIndexesSequence(),k=v.length;this.fromPhysicalToVisualIndexesCache.clear();for(var j=0;j<k;j+=1){var q=v[j],y=u.indexOf(q);y!==-1&&this.fromPhysicalToVisualIndexesCache.set(q,y)}}},{key:"cacheFromVisualToRenderabIendexes",value:function(){var u=this,v=this.notTrimmedIndexesCache,k=v.length,j=v.map(function(Y){return u.isHidden(Y)});this.fromVisualToRenderableIndexesCache.clear();for(var q=0,y=0;y<k;y+=1)if(j[y])q+=1;else{var _=y-q;this.fromVisualToRenderableIndexesCache.set(y,_)}}}])&&rn(R.prototype,U),s&&rn(R,s),W}();Object(ee.mixin)(an,G.a);var mn=an},function(ot,S,i){"use strict";i.d(S,"c",function(){return I}),i.d(S,"b",function(){return l}),i.d(S,"a",function(){return K});var M=i(1),C=i.n(M),pe=function(){return C.a.createElement("svg",{viewBox:"0 0 18 18"},C.a.createElement("defs",null,C.a.createElement("linearGradient",{id:"sv_svg__b",x1:"1",x2:"0",y2:"1",gradientUnits:"objectBoundingBox"},C.a.createElement("stop",{offset:"0",stopColor:"#0443c1"}),C.a.createElement("stop",{offset:"1",stopColor:"#c2c8f0"})),C.a.createElement("clipPath",{id:"sv_svg__a"}," ",C.a.createElement("path",{d:"M2 0h14a2 2 0 012 2v14a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2z",fill:"#0f9d58"}))),C.a.createElement("g",{clipPath:"url(#sv_svg__a)"},C.a.createElement("path",{transform:"rotate(90 9 9)",fill:"url(#sv_svg__b)",d:"M0 0h18v18H0z"}),C.a.createElement("path",{d:"M0 0l9-9 6 6-9 9z",fill:"#c2c8f0"}),C.a.createElement("path",{d:"M-9 9l9-9 6 6-9 9z",fill:"#98a5e6"}),C.a.createElement("path",{d:"M6 6l9-9 6 6-9 9z",fill:"#6c82dc"}),C.a.createElement("path",{d:"M-3 15l9-9 6 6-9 9z",fill:"#4767d4"}),C.a.createElement("path",{d:"M12 12l9-9 6 6-9 9z",fill:"#104acc"}),C.a.createElement("path",{d:"M3 21l9-9 6 6-9 9z",fill:"#0443c1"})))},ie=i(204),X=function(){return C.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24"},C.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),C.a.createElement("rect",{className:"svg-icon",width:14,height:2,rx:.099,transform:"translate(5 19)"}),C.a.createElement("path",{className:"svg-icon",d:"M8.124 12h2.777a.1.1 0 00.1-.1V3.1a.1.1 0 01.1-.1h1.8a.1.1 0 01.1.1v8.8a.1.1 0 00.1.1h2.778a.1.1 0 01.069.168l-3.876 3.866a.1.1 0 01-.139 0l-3.876-3.866A.1.1 0 018.124 12z"}))},F=i(196),ee=i(179),ce=i(199),G=function(ne){var le=ne.workbookLocation,Re=ne.fileName,De=ne.mobile,He=Object(F.a)(le);if(!Object(ce.a)())return null;var me=He?"download-anchor":void 0,Se=me&&De?"download-anchor-mobile":me;return C.a.createElement("button",{type:"button",className:"icon",id:"download-icon"},C.a.createElement("a",{href:He,download:Re,"data-cy":Se},C.a.createElement(X,null),De&&C.a.createElement(ee.a,{description:"Download"})),!De&&C.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},C.a.createElement("span",null,"Download")))},B=i(205),V=function(ne){return C.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24"},ne),C.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),C.a.createElement("path",{d:"M14.25 6.007a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007zm0 6.074a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007zm0 6.074a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007z",fill:"#fff"}))},P=i(314),x=function(ne){var le=ne.children;return C.a.createElement(P.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{style:{maxHeight:192,width:200}},classes:{paper:"toolbar-mobile-menu-wrapper",list:"toolbar-mobile-menu-list"}},ne),le)};function $(ne,le){return function(Re){if(Array.isArray(Re))return Re}(ne)||function(Re,De){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(Re)))){var He=[],me=!0,Se=!1,Ie=void 0;try{for(var Le,we=Re[Symbol.iterator]();!(me=(Le=we.next()).done)&&(He.push(Le.value),!De||He.length!==De);me=!0);}catch(Ve){Se=!0,Ie=Ve}finally{try{me||we.return==null||we.return()}finally{if(Se)throw Ie}}return He}}(ne,le)||function(Re,De){if(!!Re){if(typeof Re=="string")return fe(Re,De);var He=Object.prototype.toString.call(Re).slice(8,-1);if(He==="Object"&&Re.constructor&&(He=Re.constructor.name),He==="Map"||He==="Set")return Array.from(Re);if(He==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(He))return fe(Re,De)}}(ne,le)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function fe(ne,le){(le==null||le>ne.length)&&(le=ne.length);for(var Re=0,De=new Array(le);Re<le;Re++)De[Re]=ne[Re];return De}var H=function(ne){var le=ne.children,Re=$(C.a.useState(void 0),2),De=Re[0],He=Re[1];return C.a.createElement("button",{type:"button",className:"icon icon-mobile","data-cy":"mobile-menu-icon"},C.a.createElement(V,{onClick:function(me){He(me.currentTarget)}}),C.a.createElement(x,{anchorEl:De,keepMounted:!0,open:Boolean(De),onClose:function(){He(void 0)}},le))},se=i(65),I=function(ne){var le=ne.children;return C.a.createElement("div",{className:"toolbar"},le)},de=function(ne){var le=ne.children,Re=ne.fileName;return C.a.createElement("div",{className:"toolbar-left-pane"},C.a.createElement("div",{className:"icon",id:"sv-icon"},le),C.a.createElement("p",{className:"file-title"},Re))},l=function(ne){var le=ne.children;return C.a.createElement("div",{className:"toolbar-right-pane"},C.a.createElement("div",{className:"icons-wrapper"},le))},K=function(ne){var le=ne.fileName,Re=ne.workbookLocation,De=ne.renderWorkbook,He=ne.openModal,me=Object(se.b)();return C.a.createElement(I,null,C.a.createElement(de,{fileName:le},C.a.createElement(pe,null)),C.a.createElement(l,null,me?C.a.createElement(H,null,C.a.createElement(B.a,{open:He,mobile:!0}),C.a.createElement(ie.a,{renderWorkbook:De,mobile:!0}),C.a.createElement(G,{workbookLocation:Re,fileName:le,mobile:!0})):C.a.createElement(C.a.Fragment,null,C.a.createElement(ie.a,{renderWorkbook:De}),C.a.createElement(G,{workbookLocation:Re,fileName:le}),C.a.createElement(B.a,{open:He}))))}},function(ot,S,i){"use strict";i.d(S,"c",function(){return ee}),i.d(S,"b",function(){return V}),i.d(S,"a",function(){return B});var M=i(180),C=i(161),pe=function(P,x,$,fe,H,se,I){var de=[],l=[];I.className&&Object(C.addClass)(x,I.className),I.readOnly&&de.push(I.readOnlyCellClassName),I.valid===!1&&I.invalidCellClassName?de.push(I.invalidCellClassName):l.push(I.invalidCellClassName),I.wordWrap===!1&&I.noWordWrapClassName&&de.push(I.noWordWrapClassName),!se&&I.placeholder&&de.push(I.placeholderCellClassName),Object(C.removeClass)(x,l),Object(C.addClass)(x,de)},ie=i(167),X=function(P,x,$,fe,H,se,I){V("base").apply(this,[P,x,$,fe,H,se,I]);var de=se;if(!de&&I.placeholder&&(de=I.placeholder),de=Object(ie.stringify)(de),P.getSettings().trimWhitespace||P.getSettings().wordWrap||(de=de.replace(/ /g,String.fromCharCode(160))),I.rendererTemplate){Object(C.empty)(x);var l=P.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=I.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=P.getSourceDataAtRow($),x.appendChild(l)}else Object(C.fastInnerText)(x,de)},F=Object(M.a)("renderers"),ee=F.register,ce=F.getItem,G=F.hasItem,B=F.getNames;F.getValues;function V(P){if(typeof P=="function")return P;if(!G(P))throw Error('No registered renderer found under "'.concat(P,'" name'));return ce(P)}ee("base",pe),ee("text",X)},,,,,,,,,,,,,,,,,,,,,function(ot,S,i){"use strict";i.d(S,"d",function(){return C}),i.d(S,"c",function(){return pe}),i.d(S,"a",function(){return ie}),i.d(S,"b",function(){return X});var M=new WeakMap,C=Symbol("rootInstance");function pe(F){M.set(F,!0)}function ie(F){return F===C}function X(F){return M.has(F)}},function(ot,S,i){"use strict";i.d(S,"a",function(){return ee}),i.d(S,"c",function(){return ce}),i.d(S,"b",function(){return G}),i.d(S,"d",function(){return B});var M=i(167),C=i(159),pe=i(187),ie=i(181),X=i(206);function F(){var V=function(P,x){return x||(x=P.slice(0)),Object.freeze(Object.defineProperties(P,{raw:{value:Object.freeze(x)}}))}(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`]);return F=function(){return V},V}function ee(V,P){return Object(C.objectEach)(P,function(x,$){Object(M.isUndefined)(V[$])&&(V[$]=x)}),V}function ce(V){var P=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(V);return P?"".concat(P[1].toLowerCase(),"-").concat(P[2].toUpperCase()):V}function G(V){var P=ce(V);return Object(X.d)(P)||(P=X.a,B(V)),P}function B(V){Object(M.isDefined)(V)&&Object(pe.a)(Object(ie.a)(F(),V))}},function(ot,S,i){"use strict";i.d(S,"a",function(){return ce}),i.d(S,"b",function(){return F}),i.d(S,"c",function(){return ee});var M=i(170),C=i(201),pe=new M.a,ie=new Set,X=0;function F(G){X===0&&(pe.addEventListener(G,"keydown",function(B){ie.has(B.keyCode)||ie.add(B.keyCode)}),pe.addEventListener(G,"keyup",function(B){ie.has(B.keyCode)&&ie.delete(B.keyCode)}),pe.addEventListener(G,"visibilitychange",function(){G.hidden&&ie.clear()}),pe.addEventListener(G.defaultView,"blur",function(){ie.clear()})),X+=1}function ee(){X>0&&(X-=1),X===0&&(pe.clearEvents(),ie.clear(),X=0)}function ce(){return Array.from(ie.values()).some(function(G){return Object(C.isCtrlMetaKey)(G)})}},function(ot,S,i){var M,C,pe,ie,X;M=/^(\r\n|\n\r|\r|\n)/,C=/^[^\t\r\n]+/,pe=/^\t/,ie=function(F){var ee=[[""]];if(F.length===0)return ee;for(var ce,G=0,B=0;F.length>0&&ce!==F.length;)if(ce=F.length,F.match(pe))F=F.replace(pe,""),G+=1,ee[B][G]="";else if(F.match(M))F=F.replace(M,""),G=0,ee[B+=1]=[""];else{var V="";if(F.startsWith('"')){for(var P=0,x=!0;x;){var $=F.slice(0,1);$==='"'&&(P+=1),V+=$,((F=F.slice(1)).length===0||F.match(/^[\t\r\n]/)&&P%2==0)&&(x=!1)}V=V.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(H){return new Array(Math.floor(H.length/2)).fill('"').join("")})}else{var fe=F.match(C);V=fe?fe[0]:"",F=F.slice(V.length)}ee[B][G]=V}return ee},X=function(F){var ee,ce,G,B,V,P="";for(ee=0,ce=F.length;ee<ce;ee+=1){for(B=F[ee].length,G=0;G<B;G+=1)G>0&&(P+="	"),typeof(V=F[ee][G])=="string"?V.indexOf(`
`)>-1?P+='"'.concat(V.replace(/"/g,'""'),'"'):P+=V:P+=V==null?"":V;ee!==ce-1&&(P+=`
`)}return P},S.parse=ie,S.stringify=X},,function(ot,S,i){"use strict";i.d(S,"a",function(){return mn}),i.d(S,"b",function(){return tt}),i.d(S,"c",function(){return yt});var M=i(180),C=i(165);function pe(W){return(pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}function ie(W,R){if(!(W instanceof R))throw new TypeError("Cannot call a class as a function")}function X(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}function F(W,R,U){return(F=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(s,u,v){var k=function(q,y){for(;!Object.prototype.hasOwnProperty.call(q,y)&&(q=B(q))!==null;);return q}(s,u);if(k){var j=Object.getOwnPropertyDescriptor(k,u);return j.get?j.get.call(v):j.value}})(W,R,U||W)}function ee(W,R){return(ee=Object.setPrototypeOf||function(U,s){return U.__proto__=s,U})(W,R)}function ce(W){var R=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}();return function(){var U,s=B(W);if(R){var u=B(this).constructor;U=Reflect.construct(s,arguments,u)}else U=s.apply(this,arguments);return G(this,U)}}function G(W,R){return!R||pe(R)!=="object"&&typeof R!="function"?function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}(W):R}function B(W){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})(W)}var V=function(W){(function(k,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(j&&j.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),j&&ee(k,j)})(v,W);var R,U,s,u=ce(v);function v(){var k;ie(this,v);for(var j=arguments.length,q=new Array(j),y=0;y<j;y++)q[y]=arguments[y];return(k=u.call.apply(u,[this].concat(q))).visualCellRange=null,k}return R=v,(U=[{key:"add",value:function(k){return this.visualCellRange===null?this.visualCellRange=new C.b(k):this.visualCellRange.expand(k),this}},{key:"clear",value:function(){return this.visualCellRange=null,F(B(v.prototype),"clear",this).call(this)}},{key:"findVisibleCoordsInRange",value:function(k,j,q){var y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:q,_=k.row,Y=k.col,ue=j.row,Te=j.col,Fe=this.settings.visualToRenderableCoords(k),Xe=Fe.row,lt=Fe.col;return ue===_&&Xe===null||Te===Y&&lt===null?null:Xe===null&&lt===null?this.findVisibleCoordsInRange(new C.a(_+q,Y+y),j,q,y):Xe===null?this.findVisibleCoordsInRange(new C.a(_+q,Y),j,q,y):lt===null?this.findVisibleCoordsInRange(new C.a(_,Y+y),j,q,y):k}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var k=this.getRowSearchDirection(this.visualCellRange),j=this.getColumnSearchDirection(this.visualCellRange),q=this.findVisibleCoordsInRange(this.visualCellRange.from,this.visualCellRange.to,k,j),y=this.findVisibleCoordsInRange(this.visualCellRange.to,this.visualCellRange.from,-k,-j);if(q===null)return this.cellRange=null,this;var _=this.settings.visualToRenderableCoords(q),Y=this.settings.visualToRenderableCoords(y);return this.cellRange=new C.b(_,_,Y),this}},{key:"adjustCoordinates",value:function(k){if(this.cellRange===null&&k){var j=this.getRowSearchDirection(k),q=this.getColumnSearchDirection(k),y=this.findVisibleCoordsInRange(k.from,k.to,j,q);if(y!==null){var _=this.settings.visualToRenderableCoords(y);return this.cellRange=new C.b(_),k.setHighlight(y),this}}return k.setHighlight(k.from),this}},{key:"getVisualCorners",value:function(){var k=this.settings.renderableToVisualCoords(this.cellRange.getTopLeftCorner()),j=this.settings.renderableToVisualCoords(this.cellRange.getBottomRightCorner());return[k.row,k.col,j.row,j.col]}},{key:"getRowSearchDirection",value:function(k){return k.from.row<k.to.row?1:-1}},{key:"getColumnSearchDirection",value:function(k){return k.from.col<k.to.col?1:-1}}])&&X(R.prototype,U),s&&X(R,s),v}(C.c),P=function(W){var R=W.visualToRenderableCoords,U=W.renderableToVisualCoords,s=W.activeHeaderClassName;return new V({visualToRenderableCoords:R,renderableToVisualCoords:U,highlightHeaderClassName:s})},x=function(W){var R=W.BorderStyle,U=W.visualToRenderableCoords,s=W.renderableToVisualCoords,u=W.layerLevel,v=W.areaCornerVisible,k=new R;return k.cornerVisible=v,new V({visualToRenderableCoords:U,renderableToVisualCoords:s,className:"area",markIntersections:!0,layerLevel:Math.min(u,7),border:k})},$=function(W){var R=W.BorderStyle,U=W.visualToRenderableCoords,s=W.renderableToVisualCoords,u=W.cellCornerVisible,v=new R;return v.cornerVisible=u,new V({visualToRenderableCoords:U,renderableToVisualCoords:s,className:"current",border:v})};function fe(W,R){var U=Object.keys(W);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(W);R&&(s=s.filter(function(u){return Object.getOwnPropertyDescriptor(W,u).enumerable})),U.push.apply(U,s)}return U}function H(W,R,U){return R in W?Object.defineProperty(W,R,{value:U,enumerable:!0,configurable:!0,writable:!0}):W[R]=U,W}var se=function(W){var R=W.visualToRenderableCoords,U=W.renderableToVisualCoords,s=W.border,u=W.cellRange;return new V(function(v){for(var k=1;k<arguments.length;k++){var j=arguments[k]!=null?arguments[k]:{};k%2?fe(Object(j),!0).forEach(function(q){H(v,q,j[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(j)):fe(Object(j)).forEach(function(q){Object.defineProperty(v,q,Object.getOwnPropertyDescriptor(j,q))})}return v}({visualToRenderableCoords:R,renderableToVisualCoords:U},s),u)},I=function(W){var R=W.BorderStyle,U=W.visualToRenderableCoords,s=W.renderableToVisualCoords,u=new R;return new V({visualToRenderableCoords:U,renderableToVisualCoords:s,className:"fill",border:u})},de=function(W){var R=W.visualToRenderableCoords,U=W.renderableToVisualCoords,s=W.headerClassName,u=W.rowClassName,v=W.columnClassName;return new V({visualToRenderableCoords:R,renderableToVisualCoords:U,className:"highlight",highlightHeaderClassName:s,highlightRowClassName:u,highlightColumnClassName:v})},l=new Map,K=Object(M.a)("highlight/types"),ne=K.register,le=K.getItem;function Re(W,R,U){U&&l.set(W,U),ne(W,R)}function De(W,R){return le(W)(R)}Re("active-header",P),Re("area",x,{width:1,color:"#4b89ff",strokeAlignment:"inside"}),Re("cell",$,{width:2,color:"#4b89ff",strokeAlignment:"inside"}),Re("custom-selection",se),Re("fill",I,{width:1,color:"#ff0000",strokeAlignment:"inside"}),Re("header",de);var He=i(160),me=i(159);function Se(W){return(Se=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}function Ie(W,R){return(Ie=Object.setPrototypeOf||function(U,s){return U.__proto__=s,U})(W,R)}function Le(W){var R=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(U){return!1}}();return function(){var U,s=Ve(W);if(R){var u=Ve(this).constructor;U=Reflect.construct(s,arguments,u)}else U=s.apply(this,arguments);return we(this,U)}}function we(W,R){return!R||Se(R)!=="object"&&typeof R!="function"?function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}(W):R}function Ve(W){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})(W)}function je(W,R){if(!(W instanceof R))throw new TypeError("Cannot call a class as a function")}function Ke(W){var R=function U(){je(this,U)};return Object(me.extend)(R.prototype,W),function(U){(function(v,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(k&&k.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),k&&Ie(v,k)})(u,U);var s=Le(u);function u(){return je(this,u),s.apply(this,arguments)}return u}(R)}function $e(W){return function(R){if(Array.isArray(R))return Ye(R)}(W)||function(R){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(R))return Array.from(R)}(W)||function(R,U){if(!!R){if(typeof R=="string")return Ye(R,U);var s=Object.prototype.toString.call(R).slice(8,-1);if(s==="Object"&&R.constructor&&(s=R.constructor.name),s==="Map"||s==="Set")return Array.from(R);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Ye(R,U)}}(W)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ye(W,R){(R==null||R>W.length)&&(R=W.length);for(var U=0,s=new Array(R);U<R;U++)s[U]=W[U];return s}function ht(W,R){var U=Object.keys(W);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(W);R&&(s=s.filter(function(u){return Object.getOwnPropertyDescriptor(W,u).enumerable})),U.push.apply(U,s)}return U}function Qe(W){for(var R=1;R<arguments.length;R++){var U=arguments[R]!=null?arguments[R]:{};R%2?ht(Object(U),!0).forEach(function(s){ct(W,s,U[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(U)):ht(Object(U)).forEach(function(s){Object.defineProperty(W,s,Object.getOwnPropertyDescriptor(U,s))})}return W}function ct(W,R,U){return R in W?Object.defineProperty(W,R,{value:U,enumerable:!0,configurable:!0,writable:!0}):W[R]=U,W}function We(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}var Ze=function(){function W(u){(function(v,k){if(!(v instanceof k))throw new TypeError("Cannot call a class as a function")})(this,W),this.options=u,this.layerLevel=0,this.borderStyles=new Map([["cell",this._createBorderStyleClass("cell")],["fill",this._createBorderStyleClass("fill")],["area",this._createBorderStyleClass("area")]]),this.cell=De("cell",Qe({BorderStyle:this.borderStyles.get("cell")},u)),this.fill=De("fill",Qe({BorderStyle:this.borderStyles.get("fill")},u)),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=new Map}var R,U,s;return R=W,(U=[{key:"isEnabledFor",value:function(u){var v=u==="current"?"cell":u,k=this.options.disableHighlight;return typeof k=="string"&&(k=[k]),k===!1||Array.isArray(k)&&!k.includes(v)}},{key:"useLayerLevel",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=u,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var u,v=this.layerLevel;return this.areas.has(v)?u=this.areas.get(v):(u=De("area",Qe({BorderStyle:this.borderStyles.get("area"),layerLevel:v},this.options)),this.areas.set(v,u)),u}},{key:"getAreas",value:function(){return $e(this.areas.values())}},{key:"createOrGetHeader",value:function(){var u,v=this.layerLevel;return this.headers.has(v)?u=this.headers.get(v):(u=De("header",Qe({},this.options)),this.headers.set(v,u)),u}},{key:"getHeaders",value:function(){return $e(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var u,v=this.layerLevel;return this.activeHeaders.has(v)?u=this.activeHeaders.get(v):(u=De("active-header",Qe({},this.options)),this.activeHeaders.set(v,u)),u}},{key:"getCommonBorderStyle",value:function(u){var v;return(v=this.borderStyles.get(u))===null||v===void 0?void 0:v.prototype}},{key:"getActiveHeaders",value:function(){return $e(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return $e(this.customSelections.values())}},{key:"addCustomSelection",value:function(u,v){this.customSelections.set(u,De("custom-selection",Qe(Qe({},this.options),v)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(He.arrayEach)(this.areas.values(),function(u){u.clear()}),Object(He.arrayEach)(this.headers.values(),function(u){u.clear()}),Object(He.arrayEach)(this.activeHeaders.values(),function(u){u.clear()})}},{key:"getAll",value:function(){return[this.cell,this.fill].concat($e(this.areas.values()),$e(this.headers.values()),$e(this.activeHeaders.values()),$e(this.customSelections.values()))}},{key:"_createBorderStyleClass",value:function(u){var v=function(k){return l.get(k)||{}}(u);if(v)return Ke(v)}}])&&We(R.prototype,U),s&&We(R,s),W}();function at(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}var ut=function(){function W(){(function(u,v){if(!(u instanceof v))throw new TypeError("Cannot call a class as a function")})(this,W),this.ranges=[]}var R,U,s;return R=W,(U=[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(u){return this.clear(),this.ranges.push(new C.b(u)),this}},{key:"add",value:function(u){return this.ranges.push(new C.b(u)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(u){return this.ranges.some(function(v){return v.includes(u)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var u,v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,k=this.size()+v-1;return k>=0&&(u=this.ranges[k]),u}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}])&&at(R.prototype,U),s&&at(R,s),W}(),be=i(247),Z=i(167),he=i(189);function O(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}var re=function(){function W(u,v){(function(k,j){if(!(k instanceof j))throw new TypeError("Cannot call a class as a function")})(this,W),this.range=u,this.options=v}var R,U,s;return R=W,(U=[{key:"transformStart",value:function(u,v,k){var j=new C.a(u,v),q=this.range.current().highlight,y=this.options.visualToRenderableCoords(q),_=y.row,Y=y.col,ue=q,Te=0,Fe=0;if(this.runLocalHooks("beforeTransformStart",j),_!==null&&Y!==null){var Xe=this.options.countRows(),lt=this.options.countCols(),dt=this.options.fixedRowsBottom(),Pt=this.options.minSpareRows(),rt=this.options.minSpareCols(),Xt=this.options.autoWrapRow(),en=this.options.autoWrapCol();_+u>Xe-1?k&&Pt>0&&!(dt&&_>=Xe-dt-1)?(this.runLocalHooks("insertRowRequire",Xe),Xe=this.options.countRows()):en&&(j.row=1-Xe,j.col=Y+j.col===lt-1?1-lt:1):en&&_+j.row<0&&Y+j.col>=0&&(j.row=Xe-1,j.col=Y+j.col===0?lt-1:-1),Y+j.col>lt-1?k&&rt>0?(this.runLocalHooks("insertColRequire",lt),lt=this.options.countCols()):Xt&&(j.row=_+j.row===Xe-1?1-Xe:1,j.col=1-lt):Xt&&Y+j.col<0&&_+j.row>=0&&(j.row=_+j.row===0?Xe-1:-1,j.col=lt-1);var Kt=new C.a(_+j.row,Y+j.col);Te=0,Fe=0,Kt.row<0?(Te=-1,Kt.row=0):Kt.row>0&&Kt.row>=Xe&&(Te=1,Kt.row=Xe-1),Kt.col<0?(Fe=-1,Kt.col=0):Kt.col>0&&Kt.col>=lt&&(Fe=1,Kt.col=lt-1),ue=this.options.renderableToVisualCoords(Kt)}return this.runLocalHooks("afterTransformStart",ue,Te,Fe),ue}},{key:"transformEnd",value:function(u,v){var k=new C.a(u,v),j=this.range.current(),q=j.to,y=0,_=0;this.runLocalHooks("beforeTransformEnd",k);var Y=this.options.visualToRenderableCoords(j.highlight),ue=Y.row,Te=Y.col;if(ue!==null&&Te!==null){var Fe=this.options.countRows(),Xe=this.options.countCols(),lt=this.options.visualToRenderableCoords(j.to),dt=lt.row,Pt=lt.col,rt=new C.a(dt+k.row,Pt+k.col);y=0,_=0,rt.row<0?(y=-1,rt.row=0):rt.row>0&&rt.row>=Fe&&(y=1,rt.row=Fe-1),rt.col<0?(_=-1,rt.col=0):rt.col>0&&rt.col>=Xe&&(_=1,rt.col=Xe-1),q=this.options.renderableToVisualCoords(rt)}return this.runLocalHooks("afterTransformEnd",q,y,_),q}}])&&O(R.prototype,U),s&&O(R,s),W}();Object(me.mixin)(re,he.a);var Oe=re;function Ee(W){return(Ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})(W)}var ve=[3,2],Ge=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Je=Symbol("root"),ft=Symbol("child");function tt(W){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Je;if(R!==Je&&R!==ft)throw new Error("The second argument is used internally only and cannot be overwritten.");var U=Array.isArray(W),s=R===Je,u=0;if(U){var v=W[0];if(W.length===0)u=1;else if(s&&v instanceof C.b)u=3;else if(s&&Array.isArray(v))u=tt(v,ft);else if(W.length>=2&&W.length<=4){var k=!W.some(function(j,q){return!Ge[q].includes(Ee(j))});k&&(u=2)}}return u}function yt(W){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},U=R.keepDirection,s=U!==void 0&&U,u=R.propToCol;if(!ve.includes(W))throw new Error("Unsupported selection ranges schema type was provided.");return function(v){var k=W===3,j=k?v.from.row:v[0],q=k?v.from.col:v[1],y=k?v.to.row:v[2],_=k?v.to.col:v[3];if(typeof u=="function"&&(typeof q=="string"&&(q=u(q)),typeof _=="string"&&(_=u(_))),Object(Z.isUndefined)(y)&&(y=j),Object(Z.isUndefined)(_)&&(_=q),!s){var Y=j,ue=q,Te=y,Fe=_;j=Math.min(Y,Te),q=Math.min(ue,Fe),y=Math.max(Y,Te),_=Math.max(ue,Fe)}return[j,q,y,_]}}function bt(W){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof W=="number"&&W>=0&&W<R}var Ot=i(181);function Jt(W,R){return function(U){if(Array.isArray(U))return U}(W)||function(U,s){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(U)))){var u=[],v=!0,k=!1,j=void 0;try{for(var q,y=U[Symbol.iterator]();!(v=(q=y.next()).done)&&(u.push(q.value),!s||u.length!==s);v=!0);}catch(_){k=!0,j=_}finally{try{v||y.return==null||y.return()}finally{if(k)throw j}}return u}}(W,R)||function(U,s){if(!!U){if(typeof U=="string")return Gt(U,s);var u=Object.prototype.toString.call(U).slice(8,-1);if(u==="Object"&&U.constructor&&(u=U.constructor.name),u==="Map"||u==="Set")return Array.from(U);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return Gt(U,s)}}(W,R)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Gt(W,R){(R==null||R>W.length)&&(R=W.length);for(var U=0,s=new Array(R);U<R;U++)s[U]=W[U];return s}function Qt(){var W=function(R,U){return U||(U=R.slice(0)),Object.freeze(Object.defineProperties(R,{raw:{value:Object.freeze(U)}}))}([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) 
        or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]])\\x20
        or as an array of CellRange objects.`]);return Qt=function(){return W},W}function rn(W,R){for(var U=0;U<R.length;U++){var s=R[U];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(W,s.key,s)}}var an=function(){function W(u,v){var k=this;(function(j,q){if(!(j instanceof q))throw new TypeError("Cannot call a class as a function")})(this,W),this.settings=u,this.tableProps=v,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new ut,this.highlight=new Ze({headerClassName:u.currentHeaderClassName,activeHeaderClassName:u.activeHeaderClassName,rowClassName:u.currentRowClassName,columnClassName:u.currentColClassName,disableHighlight:u.disableVisualSelection,cellCornerVisible:function(){return k.isCellCornerVisible.apply(k,arguments)},areaCornerVisible:function(){return k.isAreaCornerVisible.apply(k,arguments)},visualToRenderableCoords:function(j){return k.tableProps.visualToRenderableCoords(j)},renderableToVisualCoords:function(j){return k.tableProps.renderableToVisualCoords(j)}}),this.transformation=new Oe(this.selectedRange,{countRows:function(){return k.tableProps.countRowsTranslated()},countCols:function(){return k.tableProps.countColsTranslated()},visualToRenderableCoords:function(j){return k.tableProps.visualToRenderableCoords(j)},renderableToVisualCoords:function(j){return k.tableProps.renderableToVisualCoords(j)},fixedRowsBottom:function(){return u.fixedRowsBottom},minSpareRows:function(){return u.minSpareRows},minSpareCols:function(){return u.minSpareCols},autoWrapRow:function(){return u.autoWrapRow},autoWrapCol:function(){return u.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var j=arguments.length,q=new Array(j),y=0;y<j;y++)q[y]=arguments[y];return k.runLocalHooks.apply(k,["beforeModifyTransformStart"].concat(q))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var j=arguments.length,q=new Array(j),y=0;y<j;y++)q[y]=arguments[y];return k.runLocalHooks.apply(k,["afterModifyTransformStart"].concat(q))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var j=arguments.length,q=new Array(j),y=0;y<j;y++)q[y]=arguments[y];return k.runLocalHooks.apply(k,["beforeModifyTransformEnd"].concat(q))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var j=arguments.length,q=new Array(j),y=0;y<j;y++)q[y]=arguments[y];return k.runLocalHooks.apply(k,["afterModifyTransformEnd"].concat(q))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var j=arguments.length,q=new Array(j),y=0;y<j;y++)q[y]=arguments[y];return k.runLocalHooks.apply(k,["insertRowRequire"].concat(q))}),this.transformation.addLocalHook("insertColRequire",function(){for(var j=arguments.length,q=new Array(j),y=0;y<j;y++)q[y]=arguments[y];return k.runLocalHooks.apply(k,["insertColRequire"].concat(q))})}var R,U,s;return R=W,(U=[{key:"updateBorderStyle",value:function(u){var v=this;Object(He.arrayEach)(["cell","area","fill"],function(k){var j,q,y=Object(me.isObject)(u[k])?u[k]:{};j=v.highlight.getCommonBorderStyle(k),(q=y).borderWidth?j.width=q.borderWidth:j.hasOwnProperty("width")&&delete j.width,q.borderColor?j.color=q.borderColor:j.hasOwnProperty("color")&&delete j.color})}},{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(u,v){var k=arguments.length>2&&arguments[2]!==void 0&&arguments[2],j=this.settings.selectionMode==="multiple",q=Object(Z.isUndefined)(v)?Object(be.a)():v,y=u.row<0,_=u.col<0,Y=y&&_;y&&(u.row=0),_&&(u.col=0),this.selectedByCorner=Y,this.runLocalHooks("beforeSetRangeStart".concat(k?"Only":""),u),(!j||j&&!q&&Object(Z.isUndefined)(v))&&this.selectedRange.clear(),this.selectedRange.add(u),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!Y&&_&&this.selectedByRowHeader.add(this.getLayerLevel()),!Y&&y&&this.selectedByColumnHeader.add(this.getLayerLevel()),k||this.setRangeEnd(u)}},{key:"setRangeStartOnly",value:function(u,v){this.setRangeStart(u,v,!0)}},{key:"setRangeEnd",value:function(u){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",u),this.begin();var v=this.selectedRange.current();if(this.settings.selectionMode!=="single"&&v.setTo(new C.a(u.row,u.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor("cell")){var k=this.tableProps.expandCoordsToRangeIncludingSpans(this.selectedRange.current().highlight);this.highlight.getCell().add(k.from).add(k.to).commit().adjustCoordinates(v)}var j=this.getLayerLevel();j<this.highlight.layerLevel&&(Object(He.arrayEach)(this.highlight.getAreas(),function(Y){Y.clear()}),Object(He.arrayEach)(this.highlight.getHeaders(),function(Y){Y.clear()}),Object(He.arrayEach)(this.highlight.getActiveHeaders(),function(Y){Y.clear()})),this.highlight.useLayerLevel(j);var q=this.highlight.createOrGetArea(),y=this.highlight.createOrGetHeader(),_=this.highlight.createOrGetActiveHeader();q.clear(),y.clear(),_.clear(),this.highlight.isEnabledFor("area")&&(this.isMultiple()||j>=1)&&(q.add(v.from).add(v.to).commit(),j===1&&(this.highlight.useLayerLevel(j-1).createOrGetArea().add(this.selectedRange.previous().from).commit(),this.highlight.useLayerLevel(j))),this.highlight.isEnabledFor("header")&&(this.settings.selectionMode==="single"?y.add(v.highlight).commit():y.add(v.from).add(v.to).commit()),this.isSelectedByRowHeader()&&this.tableProps.countCols()===v.getWidth()&&_.add(new C.a(v.from.row,-1)).add(new C.a(v.to.row,-1)).commit(),this.isSelectedByColumnHeader()&&this.tableProps.countRows()===v.getHeight()&&_.add(new C.a(-1,v.from.col)).add(new C.a(-1,v.to.col)).commit(),this.runLocalHooks("afterSetRangeEnd",u)}}},{key:"isMultiple",value:function(){var u=Object(me.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",u),u.value}},{key:"transformStart",value:function(u,v,k){var j=this.transformation.transformStart(u,v,k);this.getSelectedRange().current().highlight!==j&&this.setRangeStart(j)}},{key:"transformEnd",value:function(u,v){this.setRangeEnd(this.transformation.transformEnd(u,v))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return u===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(u)}},{key:"isSelectedByColumnHeader",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return u===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(u)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(u){return this.selectedRange.includes(u)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(u){return(!Number.isInteger(u)||u===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var u=this.tableProps.countRows(),v=this.tableProps.countCols();u!==0&&v!==0&&(this.clear(),this.setRangeStartOnly(new C.a(-1,-1)),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new C.a(u-1,v-1)),this.finish())}},{key:"selectCells",value:function(u){var v=this,k=tt(u);if(k===1)return!1;if(k===0)throw new Error(Object(Ot.a)(Qt()));var j=yt(k,{propToCol:function(Y){return v.tableProps.propToCol(Y)},keepDirection:!0}),q=this.tableProps.countRows(),y=this.tableProps.countCols(),_=!u.some(function(Y){var ue=Jt(j(Y),4),Te=ue[0],Fe=ue[1],Xe=ue[2],lt=ue[3];return!(bt(Te,q)&&bt(Fe,y)&&bt(Xe,q)&&bt(lt,y))});return _&&(this.clear(),Object(He.arrayEach)(u,function(Y){var ue=Jt(j(Y),4),Te=ue[0],Fe=ue[1],Xe=ue[2],lt=ue[3];v.setRangeStartOnly(new C.a(Te,Fe),!1),v.setRangeEnd(new C.a(Xe,lt)),v.finish()})),_}},{key:"selectColumns",value:function(u){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,k=typeof u=="string"?this.tableProps.propToCol(u):u,j=typeof v=="string"?this.tableProps.propToCol(v):v,q=this.tableProps.countCols(),y=this.tableProps.countRows(),_=y>0&&bt(k,q)&&bt(j,q);return _&&(this.setRangeStartOnly(new C.a(-1,k)),this.setRangeEnd(new C.a(y-1,j)),this.finish()),_}},{key:"selectRows",value:function(u){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,k=this.tableProps.countRows(),j=this.tableProps.countCols(),q=bt(u,k)&&bt(v,k);return q&&(this.setRangeStartOnly(new C.a(u,-1)),this.setRangeEnd(new C.a(v,j>0?j-1:0)),this.finish()),q}},{key:"refresh",value:function(){if(this.isSelected()){var u=this.highlight.getCell(),v=this.getLayerLevel();u.commit().adjustCoordinates(this.selectedRange.current());for(var k=0;k<this.selectedRange.size();k+=1){this.highlight.useLayerLevel(k);var j=this.highlight.createOrGetArea(),q=this.highlight.createOrGetHeader(),y=this.highlight.createOrGetActiveHeader();j.commit(),q.commit(),y.commit()}this.highlight.useLayerLevel(v)}}}])&&rn(R.prototype,U),s&&rn(R,s),W}();Object(me.mixin)(an,he.a);var mn=an;i(218)},function(ot,S,i){"use strict";i.d(S,"a",function(){return P}),i.d(S,"b",function(){return ut}),i.d(S,"c",function(){return He});var M=i(248),C=i.n(M),pe=i(202),ie=i(159),X=i(160),F=i(171),ee=i(167);function ce(be){return(ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z})(be)}function G(be,Z){for(var he=0;he<Z.length;he++){var O=Z[he];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(be,O.key,O)}}function B(be,Z,he){return Z&&G(be.prototype,Z),he&&G(be,he),be}var V=Object(pe.cellMethodLookupFactory)("copyable",!1),P=function(){function be(Z,he,O){(function(re,Oe){if(!(re instanceof Oe))throw new TypeError("Cannot call a class as a function")})(this,be),this.instance=Z,this.tableMeta=O,this.dataSource=he,this.duckSchema=this.dataSource&&this.dataSource[0]?Object(ie.duckSchema)(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return B(be,null,[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),B(be,[{key:"createMap",value:function(){var Z=this.getSchema();if(Z===void 0)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var he,O=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,O){var re=0,Oe=0,Ee=!1;if(typeof O=="function"){var ve=Object(ie.deepObjectSize)(Z);re=ve>0?ve:this.countFirstRowKeys(),Ee=!0}else{var Ge=this.tableMeta.maxCols;re=Math.min(Ge,O.length)}for(he=0;he<re;he++){var Je=Ee?O(he):O[he];if(Object(ie.isObject)(Je)){if(Je.data!==void 0){var ft=Ee?Oe:he;this.colToPropCache[ft]=Je.data,this.propToColCache.set(Je.data,ft)}Oe+=1}}}else this.recursiveDuckColumns(Z)}},{key:"countFirstRowKeys",value:function(){return Object(pe.countFirstRowKeys)(this.dataSource)}},{key:"recursiveDuckColumns",value:function(Z,he,O){var re,Oe=this,Ee=he,ve=O;return Ee===void 0&&(Ee=0,ve=""),ce(Z)!=="object"||Array.isArray(Z)||Object(ie.objectEach)(Z,function(Ge,Je){Ge===null?(re=ve+Je,Oe.colToPropCache.push(re),Oe.propToColCache.set(re,Ee),Ee+=1):Ee=Oe.recursiveDuckColumns(Ge,Ee,"".concat(Je,"."))}),Ee}},{key:"colToProp",value:function(Z){if(Number.isInteger(Z)===!1)return Z;var he=this.instance.toPhysicalColumn(Z);return he===null?Z:this.colToPropCache&&Object(ee.isDefined)(this.colToPropCache[he])?this.colToPropCache[he]:he}},{key:"propToCol",value:function(Z){var he=this.propToColCache.get(Z);if(Object(ee.isDefined)(he))return this.instance.toVisualColumn(he);var O=this.instance.toVisualColumn(Z);return O===null?Z:O}},{key:"getSchema",value:function(){var Z=this.tableMeta.dataSchema;return Z?typeof Z=="function"?Z():Z:this.duckSchema}},{key:"createRow",value:function(Z){var he=this,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,re=arguments.length>2?arguments[2]:void 0,Oe=this.instance.countSourceRows(),Ee=Oe,ve=0,Ge=Z;(typeof Ge!="number"||Ge>=Oe)&&(Ge=Oe),Ge<this.instance.countRows()&&(Ee=this.instance.toPhysicalRow(Ge));var Je=this.instance.runHooks("beforeCreateRow",Ge,O,re);if(Je===!1||Ee===null)return 0;for(var ft=this.tableMeta.maxRows,tt=this.instance.countCols(),yt=[],bt=function(){var Ot=null;he.instance.dataType==="array"?he.tableMeta.dataSchema?Ot=Object(ie.deepClone)(he.getSchema()):(Ot=[],Object(F.rangeEach)(tt-1,function(){return Ot.push(null)})):he.instance.dataType==="function"?Ot=he.tableMeta.dataSchema(Ge):(Ot={},Object(ie.deepExtend)(Ot,he.getSchema())),yt.push(Ot),ve+=1};ve<O&&Oe+ve<ft;)bt();return this.instance.rowIndexMapper.insertIndexes(Ge,ve),this.spliceData.apply(this,[Ee,0].concat(yt)),this.instance.runHooks("afterCreateRow",Ge,ve,re),this.instance.forceFullRender=!0,ve}},{key:"createCol",value:function(Z){var he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,O=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var re=this.dataSource,Oe=this.tableMeta.maxCols,Ee=Z;(typeof Ee!="number"||Ee>=this.instance.countSourceCols())&&(Ee=this.instance.countSourceCols());var ve=this.instance.runHooks("beforeCreateCol",Ee,he,O);if(ve===!1)return 0;var Ge=this.instance.countSourceCols();Ee<this.instance.countCols()&&(Ge=this.instance.toPhysicalColumn(Ee));for(var Je=this.instance.countSourceRows(),ft=this.instance.countCols(),tt=0,yt=Ge;tt<he&&ft<Oe;){if(typeof Ee!="number"||Ee>=ft)if(Je>0)for(var bt=0;bt<Je;bt+=1)re[bt]===void 0&&(re[bt]=[]),re[bt].push(null);else re.push([null]);else for(var Ot=0;Ot<Je;Ot++)re[Ot].splice(yt,0,null);tt+=1,yt+=1,ft+=1}return this.instance.columnIndexMapper.insertIndexes(Ee,tt),this.instance.runHooks("afterCreateCol",Ee,tt,O),this.instance.forceFullRender=!0,tt}},{key:"removeRow",value:function(Z){var he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,O=arguments.length>2?arguments[2]:void 0,re=typeof Z!="number"?-he:Z,Oe=this.instance.runHooks("modifyRemovedAmount",he,re),Ee=this.instance.countSourceRows();re=(Ee+re)%Ee;var ve=this.visualRowsToPhysical(re,Oe),Ge=this.instance.runHooks("beforeRemoveRow",re,Oe,ve,O);if(Ge===!1)return!1;var Je=this.dataSource,ft=this.filterData(re,Oe);if(ft&&(Je.length=0,Array.prototype.push.apply(Je,ft)),re<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(ve);var tt=Object(ee.isDefined)(this.tableMeta.columns)||Object(ee.isDefined)(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&tt===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",re,Oe,ve,O),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(Z){var he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,O=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var re=typeof Z!="number"?-he:Z;re=(this.instance.countCols()+re)%this.instance.countCols();var Oe=this.visualColumnsToPhysical(re,he),Ee=Oe.slice(0).sort(function(Qt,rn){return rn-Qt}),ve=this.instance.runHooks("beforeRemoveCol",re,he,Oe,O);if(ve===!1)return!1;for(var Ge=!0,Je=Ee.length,ft=this.dataSource,tt=0;tt<Je;tt++)Ge&&Oe[0]!==Oe[tt]-tt&&(Ge=!1);if(Ge)for(var yt=0,bt=this.instance.countSourceRows();yt<bt;yt++)ft[yt].splice(Oe[0],he);else for(var Ot=0,Jt=this.instance.countSourceRows();Ot<Jt;Ot++)for(var Gt=0;Gt<Je;Gt++)ft[Ot].splice(Ee[Gt],1);return re<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(Oe),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",re,he,Oe,O),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(Z,he,O){for(var re=this.instance.getDataAtCol(Z),Oe=re.slice(he,he+O),Ee=re.slice(he+O),ve=arguments.length,Ge=new Array(ve>3?ve-3:0),Je=3;Je<ve;Je++)Ge[Je-3]=arguments[Je];Object(X.extendArray)(Ge,Ee);for(var ft=0;ft<O;)Ge.push(null),ft+=1;return Object(X.to2dArray)(Ge),this.instance.populateFromArray(he,Z,Ge,null,null,"spliceCol"),Oe}},{key:"spliceRow",value:function(Z,he,O){for(var re=this.instance.getSourceDataAtRow(Z),Oe=re.slice(he,he+O),Ee=re.slice(he+O),ve=arguments.length,Ge=new Array(ve>3?ve-3:0),Je=3;Je<ve;Je++)Ge[Je-3]=arguments[Je];Object(X.extendArray)(Ge,Ee);for(var ft=0;ft<O;)Ge.push(null),ft+=1;return this.instance.populateFromArray(Z,he,[Ge],null,null,"spliceRow"),Oe}},{key:"spliceData",value:function(Z,he){for(var O=arguments.length,re=new Array(O>2?O-2:0),Oe=2;Oe<O;Oe++)re[Oe-2]=arguments[Oe];var Ee,ve=this.instance.runHooks("beforeDataSplice",Z,he,re);ve!==!1&&(Ee=this.dataSource).splice.apply(Ee,[Z,he].concat(re))}},{key:"filterData",value:function(Z,he){var O=this.visualRowsToPhysical(Z,he);if(this.instance.runHooks("beforeDataFilter",Z,he,O)!==!1)return this.dataSource.filter(function(re,Oe){return O.indexOf(Oe)===-1})}},{key:"get",value:function(Z,he){var O=this.instance.toPhysicalRow(Z),re=this.dataSource[O],Oe=this.instance.runHooks("modifyRowData",O),Ee=null;if((re=isNaN(Oe)?Oe:re)&&re.hasOwnProperty&&Object(ie.hasOwnProperty)(re,he))Ee=re[he];else if(typeof he=="string"&&he.indexOf(".")>-1){var ve=he.split("."),Ge=re;if(!Ge)return null;for(var Je=0,ft=ve.length;Je<ft;Je++)if((Ge=Ge[ve[Je]])===void 0)return null;Ee=Ge}else typeof he=="function"&&(Ee=he(this.dataSource.slice(O,O+1)[0]));if(this.instance.hasHook("modifyData")){var tt=Object(ie.createObjectPropListener)(Ee);this.instance.runHooks("modifyData",O,this.propToCol(he),tt,"get"),tt.isTouched()&&(Ee=tt.value)}return Ee}},{key:"getCopyable",value:function(Z,he){return V.call(this.instance,Z,this.propToCol(he))?this.get(Z,he):""}},{key:"set",value:function(Z,he,O){var re=this.instance.toPhysicalRow(Z),Oe=O,Ee=this.dataSource[re],ve=this.instance.runHooks("modifyRowData",re);if(Ee=isNaN(ve)?ve:Ee,this.instance.hasHook("modifyData")){var Ge=Object(ie.createObjectPropListener)(Oe);this.instance.runHooks("modifyData",re,this.propToCol(he),Ge,"set"),Ge.isTouched()&&(Oe=Ge.value)}if(Ee&&Ee.hasOwnProperty&&Object(ie.hasOwnProperty)(Ee,he))Ee[he]=Oe;else if(typeof he=="string"&&he.indexOf(".")>-1){var Je,ft=he.split("."),tt=Ee,yt=0;for(yt=0,Je=ft.length-1;yt<Je;yt++)tt[ft[yt]]===void 0&&(tt[ft[yt]]={}),tt=tt[ft[yt]];tt[ft[yt]]=Oe}else typeof he=="function"?he(this.dataSource.slice(re,re+1)[0],Oe):Ee[he]=Oe}},{key:"visualRowsToPhysical",value:function(Z,he){for(var O,re=this.instance.countSourceRows(),Oe=[],Ee=(re+Z)%re,ve=he;Ee<re&&ve;)O=this.instance.toPhysicalRow(Ee),Oe.push(O),ve-=1,Ee+=1;return Oe}},{key:"visualColumnsToPhysical",value:function(Z,he){for(var O=this.instance.countCols(),re=[],Oe=(O+Z)%O,Ee=he;Oe<O&&Ee;){var ve=this.instance.toPhysicalColumn(Oe);re.push(ve),Ee-=1,Oe+=1}return re}},{key:"clear",value:function(){for(var Z=0;Z<this.instance.countSourceRows();Z++)for(var he=0;he<this.instance.countCols();he++)this.set(Z,this.colToProp(he),"")}},{key:"getLength",value:function(){var Z,he=this.tableMeta.maxRows;Z=he<0||he===0?0:he||1/0;var O=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(O,Z)}},{key:"getAll",value:function(){var Z={row:0,col:0},he={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return Z.row-he.row!=0||this.instance.countSourceRows()?this.getRange(Z,he,be.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(Z,he,O){var re,Oe,Ee,ve=[],Ge=this.tableMeta.maxRows,Je=this.tableMeta.maxCols;if(Ge===0||Je===0)return[];var ft=O===be.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,tt=Math.min(Math.max(Ge-1,0),Math.max(Z.row,he.row)),yt=Math.min(Math.max(Je-1,0),Math.max(Z.col,he.col));for(re=Math.min(Z.row,he.row);re<=tt;re++){Ee=[];var bt=re>=0?this.instance.toPhysicalRow(re):re;for(Oe=Math.min(Z.col,he.col);Oe<=yt&&bt!==null;Oe++)Ee.push(ft.call(this,re,this.colToProp(Oe)));bt!==null&&ve.push(Ee)}return ve}},{key:"getText",value:function(Z,he){return C.a.stringify(this.getRange(Z,he,be.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(Z,he){return C.a.stringify(this.getRange(Z,he,be.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}]),be}(),x=i(216);function $(be){return($=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z})(be)}function fe(be,Z){if(!(be instanceof Z))throw new TypeError("Cannot call a class as a function")}function H(be,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Super expression must either be null or a function");be.prototype=Object.create(Z&&Z.prototype,{constructor:{value:be,writable:!0,configurable:!0}}),Z&&se(be,Z)}function se(be,Z){return(se=Object.setPrototypeOf||function(he,O){return he.__proto__=O,he})(be,Z)}function I(be){var Z=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(he){return!1}}();return function(){var he,O=l(be);if(Z){var re=l(this).constructor;he=Reflect.construct(O,arguments,re)}else he=O.apply(this,arguments);return de(this,he)}}function de(be,Z){return!Z||$(Z)!=="object"&&typeof Z!="function"?function(he){if(he===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return he}(be):Z}function l(be){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(Z){return Z.__proto__||Object.getPrototypeOf(Z)})(be)}function K(be,Z){var he=typeof be=="string"?Object(x.a)(be):be;if(Object(ie.isObject)(he)){var O=Object(ie.isObject)(Z),re={};return Object(ie.objectEach)(he,function(Oe,Ee){(!O||O&&!Object(ie.hasOwnProperty)(Z,Ee))&&(re[Ee]=Oe)}),re}}function ne(be){return Number.isInteger(be)&&be>=0}function le(be,Z){if(!be())throw new Error("Assertion failed: ".concat(Z))}function Re(be){return be==null}function De(be){return(De=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z})(be)}var He=function(){return{licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(be){var Z,he,O,re;for(Z=0,he=this.countCols();Z<he;Z++)if((O=this.getDataAtCell(be,Z))!==""&&O!==null&&Object(ee.isDefined)(O))return De(O)==="object"&&(re=this.getCellMeta(be,Z),Object(ie.isObjectEqual)(this.getSchema()[re.prop],O));return!0},isEmptyCol:function(be){var Z,he,O;for(Z=0,he=this.countRows();Z<he;Z++)if((O=this.getDataAtCell(Z,be))!==""&&O!==null&&Object(ee.isDefined)(O))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,skipRowOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,preventWheel:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0,selectionStyle:void 0}};function me(be,Z){for(var he=0;he<Z.length;he++){var O=Z[he];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(be,O.key,O)}}function Se(be,Z){if(!(be instanceof Z))throw new TypeError("Cannot call a class as a function")}var Ie=function(){function be(){Se(this,be),this.metaCtor=function re(){Se(this,re)},this.meta=this.metaCtor.prototype,Object(ie.extend)(this.meta,He())}var Z,he,O;return Z=be,(he=[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(re){Object(ie.extend)(this.meta,re),Object(ie.extend)(this.meta,K(re.type,re))}}])&&me(Z.prototype,he),O&&me(Z,O),be}();function Le(be,Z){for(var he=0;he<Z.length;he++){var O=Z[he];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(be,O.key,O)}}var we=function(){function be(re){(function(Ee,ve){if(!(Ee instanceof ve))throw new TypeError("Cannot call a class as a function")})(this,be);var Oe=re.getMetaConstructor();this.meta=new Oe}var Z,he,O;return Z=be,(he=[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(re){Object(ie.extend)(this.meta,re),Object(ie.extend)(this.meta,K(re.type,re))}}])&&Le(Z.prototype,he),O&&Le(Z,O),be}();function Ve(be,Z){for(var he=0;he<Z.length;he++){var O=Z[he];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(be,O.key,O)}}var je=function(){function be(re){(function(Oe,Ee){if(!(Oe instanceof Ee))throw new TypeError("Cannot call a class as a function")})(this,be),this.valueFactory=re,this.data=[],this.index=[],this.holes=new Set}var Z,he,O;return Z=be,(he=[{key:"obtain",value:function(re){le(function(){return ne(re)},"Expecting an unsigned number.");var Oe,Ee=this._getStorageIndexByKey(re);if(Ee>=0)(Oe=this.data[Ee])===void 0&&(Oe=this.valueFactory(re),this.data[Ee]=Oe);else if(Oe=this.valueFactory(re),this.holes.size>0){var ve=this.holes.values().next().value;this.holes.delete(ve),this.data[ve]=Oe,this.index[re]=ve}else this.data.push(Oe),this.index[re]=this.data.length-1;return Oe}},{key:"insert",value:function(re){var Oe,Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;le(function(){return ne(re)||Re(re)},"Expecting an unsigned number or null/undefined argument.");for(var ve=[],Ge=this.data.length,Je=0;Je<Ee;Je++)ve.push(Ge+Je),this.data.push(void 0);(Oe=this.index).splice.apply(Oe,[Re(re)?this.index.length:re,0].concat(ve))}},{key:"remove",value:function(re){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;le(function(){return ne(re)||Re(re)},"Expecting an unsigned number or null/undefined argument.");for(var Ee=this.index.splice(Re(re)?this.index.length-Oe:re,Oe),ve=0;ve<Ee.length;ve++){var Ge=Ee[ve];typeof Ge=="number"&&this.holes.add(Ge)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var re=this;return Object(X.arrayFilter)(this.data,function(Oe,Ee){return!re.holes.has(Ee)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var re=[],Oe=0;Oe<this.data.length;Oe++){var Ee=this._getKeyByStorageIndex(Oe);Ee!==-1&&re.push([Ee,this.data[Oe]])}var ve=0;return{next:function(){if(ve<re.length){var Ge=re[ve];return ve+=1,{value:Ge,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(re){return this.index.length>re?this.index[re]:-1}},{key:"_getKeyByStorageIndex",value:function(re){return this.index.indexOf(re)}},{key:Symbol.iterator,value:function(){return this.entries()}}])&&Ve(Z.prototype,he),O&&Ve(Z,O),be}();function Ke(be,Z){for(var he=0;he<Z.length;he++){var O=Z[he];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(be,O.key,O)}}var $e=["data","width"],Ye=function(){function be(re){var Oe=this;(function(Ee,ve){if(!(Ee instanceof ve))throw new TypeError("Cannot call a class as a function")})(this,be),this.globalMeta=re,this.metas=new je(function(){return Oe._createMeta()})}var Z,he,O;return Z=be,(he=[{key:"updateMeta",value:function(re,Oe){var Ee=this.getMeta(re);Object(ie.extend)(Ee,Oe),Object(ie.extend)(Ee,K(Oe.type,Ee))}},{key:"createColumn",value:function(re,Oe){this.metas.insert(re,Oe)}},{key:"removeColumn",value:function(re,Oe){this.metas.remove(re,Oe)}},{key:"getMeta",value:function(re){return this.metas.obtain(re)}},{key:"getMetaConstructor",value:function(re){return this.metas.obtain(re).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(re){for(var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Ee=function(Ge){H(ft,Ge);var Je=I(ft);function ft(){return fe(this,ft),Je.apply(this,arguments)}return ft}(re),ve=0;ve<Oe.length;ve++)Ee.prototype[Oe[ve]]=void 0;return Ee}(this.globalMeta.getMetaConstructor(),$e).prototype}}])&&Ke(Z.prototype,he),O&&Ke(Z,O),be}();function ht(be){return function(Z){if(Array.isArray(Z))return Qe(Z)}(be)||function(Z){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(Z))return Array.from(Z)}(be)||function(Z,he){if(!!Z){if(typeof Z=="string")return Qe(Z,he);var O=Object.prototype.toString.call(Z).slice(8,-1);if(O==="Object"&&Z.constructor&&(O=Z.constructor.name),O==="Map"||O==="Set")return Array.from(Z);if(O==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(O))return Qe(Z,he)}}(be)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Qe(be,Z){(Z==null||Z>be.length)&&(Z=be.length);for(var he=0,O=new Array(Z);he<Z;he++)O[he]=be[he];return O}function ct(be,Z){for(var he=0;he<Z.length;he++){var O=Z[he];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(be,O.key,O)}}var We=function(){function be(re){var Oe=this;(function(Ee,ve){if(!(Ee instanceof ve))throw new TypeError("Cannot call a class as a function")})(this,be),this.columnMeta=re,this.metas=new je(function(){return Oe._createRow()})}var Z,he,O;return Z=be,(he=[{key:"updateMeta",value:function(re,Oe,Ee){var ve=this.getMeta(re,Oe);Object(ie.extend)(ve,Ee),Object(ie.extend)(ve,K(Ee.type,ve))}},{key:"createRow",value:function(re,Oe){this.metas.insert(re,Oe)}},{key:"createColumn",value:function(re,Oe){for(var Ee=0;Ee<this.metas.size();Ee++)this.metas.obtain(Ee).insert(re,Oe)}},{key:"removeRow",value:function(re,Oe){this.metas.remove(re,Oe)}},{key:"removeColumn",value:function(re,Oe){for(var Ee=0;Ee<this.metas.size();Ee++)this.metas.obtain(Ee).remove(re,Oe)}},{key:"getMeta",value:function(re,Oe,Ee){var ve=this.metas.obtain(re).obtain(Oe);return Ee===void 0?ve:ve[Ee]}},{key:"setMeta",value:function(re,Oe,Ee,ve){this.metas.obtain(re).obtain(Oe)[Ee]=ve}},{key:"removeMeta",value:function(re,Oe,Ee){delete this.metas.obtain(re).obtain(Oe)[Ee]}},{key:"getMetas",value:function(){for(var re=[],Oe=Array.from(this.metas.values()),Ee=0;Ee<Oe.length;Ee++)re.push.apply(re,ht(Oe[Ee].values()));return re}},{key:"getMetasAtRow",value:function(re){le(function(){return ne(re)},"Expecting an unsigned number.");var Oe=new Map(this.metas);return Oe.has(re)?Array.from(Oe.get(re).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var re=this;return new je(function(Oe){return re._createMeta(Oe)})}},{key:"_createMeta",value:function(re){return new(this.columnMeta.getMetaConstructor(re))}}])&&ct(Z.prototype,he),O&&ct(Z,O),be}();function Ze(be,Z){if(!(be instanceof Z))throw new TypeError("Cannot call a class as a function")}function at(be,Z){for(var he=0;he<Z.length;he++){var O=Z[he];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(be,O.key,O)}}var ut=function(){function be(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ze(this,be),this.globalMeta=new Ie,this.globalMeta.updateMeta(re),this.tableMeta=new we(this.globalMeta),this.columnMeta=new Ye(this.globalMeta),this.cellMeta=new We(this.columnMeta)}var Z,he,O;return Z=be,(he=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(re){this.globalMeta.updateMeta(re)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(re){this.tableMeta.updateMeta(re)}},{key:"getColumnMeta",value:function(re){return this.columnMeta.getMeta(re)}},{key:"updateColumnMeta",value:function(re,Oe){this.columnMeta.updateMeta(re,Oe)}},{key:"getCellMeta",value:function(re,Oe,Ee){return this.cellMeta.getMeta(re,Oe,Ee)}},{key:"setCellMeta",value:function(re,Oe,Ee,ve){this.cellMeta.setMeta(re,Oe,Ee,ve)}},{key:"updateCellMeta",value:function(re,Oe,Ee){this.cellMeta.updateMeta(re,Oe,Ee)}},{key:"removeCellMeta",value:function(re,Oe,Ee){this.cellMeta.removeMeta(re,Oe,Ee)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(re){return this.cellMeta.getMetasAtRow(re)}},{key:"createRow",value:function(re){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(re,Oe)}},{key:"removeRow",value:function(re){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(re,Oe)}},{key:"createColumn",value:function(re){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(re,Oe),this.columnMeta.createColumn(re,Oe)}},{key:"removeColumn",value:function(re){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(re,Oe),this.columnMeta.removeColumn(re,Oe)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}])&&at(Z.prototype,he),O&&at(Z,O),be}()},,,function(ot,S,i){"use strict";i.d(S,"a",function(){return ce});var M=i(160),C=i(206),pe=i(180),ie=Object(pe.a)("phraseFormatters"),X=ie.register,F=ie.getValues;X("pluralize",function(G,B){return Array.isArray(G)&&Number.isInteger(B)?G[B]:G});var ee=i(167);function ce(G,B,V){var P=Object(C.b)(G);if(P===null)return null;var x=P[B];if(Object(ee.isUndefined)(x))return null;var $=function(fe,H){var se=fe;return Object(M.arrayEach)(function(){return F()}(),function(I){se=I(fe,H)}),se}(x,V);return Array.isArray($)?$[0]:$}},function(ot,S,i){"use strict";i.d(S,"a",function(){return pe});var M=i(1),C=i.n(M),pe=function(){return C.a.createElement("div",{className:"sv-chart-image-wrapper"},C.a.createElement("div",{className:"sv-chart-image-placeholder"},C.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},C.a.createElement("path",{fill:"#f5f5f5",d:`M11.094,13.019h7.735c0.057,0,0.105,0.049,0.104,0.106c-0.068,4.946-5.015,
          7.789-9.648,6.554c-2.773-0.739-4.59-2.882-5.139-5.665c-0.433-2.197,0.142-4.497,1.572-6.223c1.379-1.665,
          2.977-2.684,5.142-2.723c0.057-0.001,0.106,0.047,0.106,0.104l0.028,7.748C10.994,12.975,11.039,13.019,
          11.094,13.019z`}),C.a.createElement("path",{fill:"#f5f5f5",d:`M13.009,10.878V3.294c0-0.057,0.048-0.105,0.105-0.104C17.163,3.247,21,6.917,21,
          10.978c0,0.002,0,0.004,0,0.006l-7.891-0.006C13.054,10.978,13.009,10.934,13.009,10.878z`}))))}},,,,,,,,,function(ot,S,i){},function(ot,S,i){},function(ot,S,i){},function(ot,S,i){},,function(ot,S,i){"use strict";(function(M,C){i.d(S,"a",function(){return ht});var pe=i(161),ie=i(188),X=i(167),F=i(173),ee=i(278),ce=i(170),G=i(159),B=i(160),V=i(217),P=i(174),x=i(224),$=i(215),fe=i(176),H=i(171),se=i(271),I=i(272),de=i(202),l=i(222),K=i(245),ne=i(165),le=i(186),Re=i(254),De=i(206),He=i(246),me=i(247),Se=i(250),Ie=i(251),Le=i(273);function we(Qe){return(we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ct){return typeof ct}:function(ct){return ct&&typeof Symbol=="function"&&ct.constructor===Symbol&&ct!==Symbol.prototype?"symbol":typeof ct})(Qe)}function Ve(Qe,ct){return function(We){if(Array.isArray(We))return We}(Qe)||function(We,Ze){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(We)))){var at=[],ut=!0,be=!1,Z=void 0;try{for(var he,O=We[Symbol.iterator]();!(ut=(he=O.next()).done)&&(at.push(he.value),!Ze||at.length!==Ze);ut=!0);}catch(re){be=!0,Z=re}finally{try{ut||O.return==null||O.return()}finally{if(be)throw Z}}return at}}(Qe,ct)||Ke(Qe,ct)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function je(Qe){return function(ct){if(Array.isArray(ct))return $e(ct)}(Qe)||function(ct){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(ct))return Array.from(ct)}(Qe)||Ke(Qe)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ke(Qe,ct){if(Qe){if(typeof Qe=="string")return $e(Qe,ct);var We=Object.prototype.toString.call(Qe).slice(8,-1);return We==="Object"&&Qe.constructor&&(We=Qe.constructor.name),We==="Map"||We==="Set"?Array.from(Qe):We==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(We)?$e(Qe,ct):void 0}}function $e(Qe,ct){(ct==null||ct>Qe.length)&&(ct=Qe.length);for(var We=0,Ze=new Array(ct);We<ct;We++)Ze[We]=Qe[We];return Ze}var Ye=null;function ht(Qe,ct){var We,Ze,at,ut,be=this,Z=arguments.length>2&&arguments[2]!==void 0&&arguments[2],he=!1,O=this,re=new ce.a(O),Oe=!0;ct.language=Object(He.b)(ct.language);var Ee=new Ie.b(ct),ve=Ee.getTableMeta(),Ge=Ee.getGlobalMeta();Object(K.a)(Z)&&Object(K.c)(this),this.rootElement=Qe,this.rootDocument=Qe.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Object(me.b)(this.rootDocument),this.isDestroyed=!1,this.container=this.rootDocument.createElement("div"),this.renderCall=!1,Qe.insertBefore(this.container,Qe.firstChild),Object(K.b)(this)&&Object(X._injectProductInfo)(ct.licenseKey,Qe),this.guid="ht_".concat(Object(fe.randomString)()),this.columnIndexMapper=new l.a,this.rowIndexMapper=new l.a,Ze=new I.a(O),this.rootElement.id&&this.rootElement.id.substring(0,3)!=="ht_"||(this.rootElement.id=this.guid);var Je=function(s){var u=s.row,v=s.col;return new ne.a(u>=0?O.rowIndexMapper.getRenderableFromVisualIndex(u):u,v>=0?O.columnIndexMapper.getRenderableFromVisualIndex(v):v)},ft=function(s){var u=s.row,v=s.col;return new ne.a(u>=0?O.rowIndexMapper.getVisualFromRenderableIndex(u):u,v>=0?O.columnIndexMapper.getVisualFromRenderableIndex(v):v)},tt=new Se.a(ve,{countCols:function(){return O.countCols()},countRows:function(){return O.countRows()},propToCol:function(s){return We.propToCol(s)},isEditorOpened:function(){return!!O.getActiveEditor()&&O.getActiveEditor().isOpened()},countColsTranslated:function(){return be.view.countRenderableColumns()},countRowsTranslated:function(){return be.view.countRenderableRows()},visualToRenderableCoords:Je,renderableToVisualCoords:ft,expandCoordsToRangeIncludingSpans:function(s){return Object(Le.a)(O,s)}});this.selection=tt;var yt=function(s,u,v){v&&be.selection.refresh()};function bt(s){var u=Object(He.c)(s);Object(De.d)(u)?(O.runHooks("beforeLanguageChange",u),Ge.language=u,O.runHooks("afterLanguageChange",u)):Object(He.d)(s)}function Ot(s,u){var v=s==="className"?O.rootElement:O.table;if(Oe)Object(pe.addClass)(v,u);else{var k=[],j=[];Ge[s]&&(k=Array.isArray(Ge[s])?Ge[s]:Object(B.stringToArray)(Ge[s])),u&&(j=Array.isArray(u)?u:Object(B.stringToArray)(u));var q=Object(B.getDifferenceOfArrays)(k,j),y=Object(B.getDifferenceOfArrays)(j,k);q.length&&Object(pe.removeClass)(v,q),y.length&&Object(pe.addClass)(v,y)}Ge[s]=u}function Jt(){var s=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,s=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&s===!1&&(s=!0,this.onQueueEmpty(this.valid))}}}function Gt(s){var u=s.replace(",",".");return isNaN(parseFloat(u))===!1?parseFloat(u):s}function Qt(s,u,v){if(s.length){var k=O.getActiveEditor(),j=O.runHooks("beforeChange",s,u||"edit"),q=!0;if(j!==!1){var y,_=new Jt;_.onQueueEmpty=function(Pt){k&&q&&k.cancelChanges(),v(Pt)};for(var Y=s.length-1;Y>=0;Y--)if(s[Y]===null)s.splice(Y,1);else{var ue=Ve(s[Y],4),Te=ue[0],Fe=ue[1],Xe=ue[3],lt=We.propToCol(Fe),dt=O.getCellMeta(Te,lt);dt.type==="numeric"&&typeof Xe=="string"&&(y=Xe).length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(y)&&(s[Y][3]=Gt(Xe)),O.getCellValidator(dt)&&(_.addValidatorToQueue(),O.validateCell(s[Y][3],dt,function(Pt,rt){return function(Xt){if(typeof Xt!="boolean")throw new Error("Validation error: result is not boolean");if(Xt===!1&&rt.allowInvalid===!1){q=!1,s.splice(Pt,1),rt.valid=!0;var en=O.getCell(rt.visualRow,rt.visualCol);en!==null&&Object(pe.removeClass)(en,ve.invalidCellClassName)}_.removeValidatorFormQueue()}}(Y,dt),u))}_.checkIfQueueIsEmpty()}else k&&k.cancelChanges()}}function rn(s,u){var v=s.length-1;if(!(v<0)){for(;v>=0;v--){var k=!1;if(s[v]!==null){if(s[v][2]!==null&&s[v][2]!==void 0||s[v][3]!==null&&s[v][3]!==void 0){if(ve.allowInsertRow)for(;s[v][0]>O.countRows()-1;){var j=We.createRow(void 0,void 0,u);if(!(j>=1)){k=!0;break}Ee.createRow(null,j)}if(O.dataType==="array"&&(!ve.columns||ve.columns.length===0)&&ve.allowInsertColumn)for(;We.propToCol(s[v][1])>O.countCols()-1;){var q=We.createCol(void 0,void 0,u);if(!(q>=1)){k=!0;break}Ee.createColumn(null,q)}k||We.set(s[v][0],s[v][1],s[v][3])}}else s.splice(v,1)}O.forceFullRender=!0,at.adjustRowsAndCols(),O.runHooks("beforeChangeRender",s,u),ut.lockEditor(),O._refreshBorders(null),ut.unlockEditor(),O.view.wt.wtOverlays.adjustElementsSizes(),O.runHooks("afterChange",s,u||"edit");var y=O.getActiveEditor();y&&Object(X.isDefined)(y.refreshValue)&&y.refreshValue()}}function an(s,u,v){return we(s)==="object"?s:[[s,u,v]]}this.columnIndexMapper.addLocalHook("cacheUpdated",yt),this.rowIndexMapper.addLocalHook("cacheUpdated",yt),this.selection.addLocalHook("beforeSetRangeStart",function(s){be.runHooks("beforeSetRangeStart",s)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(s){be.runHooks("beforeSetRangeStartOnly",s)}),this.selection.addLocalHook("beforeSetRangeEnd",function(s){be.runHooks("beforeSetRangeEnd",s),s.row<0&&(s.row=be.view.wt.wtTable.getFirstVisibleRow()),s.col<0&&(s.col=be.view.wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(s){var u=Object(G.createObjectPropListener)(!1),v=be.selection.getSelectedRange(),k=v.current(),j=k.from,q=k.to,y=v.size()-1;be.runHooks("afterSelection",j.row,j.col,q.row,q.col,u,y),be.runHooks("afterSelectionByProp",j.row,O.colToProp(j.col),q.row,O.colToProp(q.col),u,y);var _=be.selection.isSelectedByAnyHeader(),Y=be.selection.selectedRange.current(),ue=!0;he&&(ue=!1),u.isTouched()&&(ue=!u.value);var Te=be.selection.isSelectedByRowHeader(),Fe=be.selection.isSelectedByColumnHeader();ue!==!1&&(_?Te?be.view.scrollViewportVertically(O.rowIndexMapper.getRenderableFromVisualIndex(s.row)):Fe&&be.view.scrollViewportHorizontally(O.columnIndexMapper.getRenderableFromVisualIndex(s.col)):Y&&!be.selection.isMultiple()?be.view.scrollViewport(Je(Y.from)):be.view.scrollViewport(Je(s))),Te&&Fe?Object(pe.addClass)(be.rootElement,["ht__selection--rows","ht__selection--columns"]):Te?(Object(pe.removeClass)(be.rootElement,"ht__selection--columns"),Object(pe.addClass)(be.rootElement,"ht__selection--rows")):Fe?(Object(pe.removeClass)(be.rootElement,"ht__selection--rows"),Object(pe.addClass)(be.rootElement,"ht__selection--columns")):Object(pe.removeClass)(be.rootElement,["ht__selection--rows","ht__selection--columns"]),be._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(s){var u=s.length-1,v=s[u],k=v.from,j=v.to;be.runHooks("afterSelectionEnd",k.row,k.col,j.row,j.col,u),be.runHooks("afterSelectionEndByProp",k.row,O.colToProp(k.col),j.row,O.colToProp(j.col),u)}),this.selection.addLocalHook("afterIsMultipleSelection",function(s){var u=be.runHooks("afterIsMultipleSelection",s.value);s.value&&(s.value=u)}),this.selection.addLocalHook("beforeModifyTransformStart",function(s){be.runHooks("modifyTransformStart",s)}),this.selection.addLocalHook("afterModifyTransformStart",function(s,u,v){be.runHooks("afterModifyTransformStart",s,u,v)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(s){be.runHooks("modifyTransformEnd",s)}),this.selection.addLocalHook("afterModifyTransformEnd",function(s,u,v){be.runHooks("afterModifyTransformEnd",s,u,v)}),this.selection.addLocalHook("afterDeselect",function(){ut.destroyEditor(),be._refreshBorders(),Object(pe.removeClass)(be.rootElement,["ht__selection--rows","ht__selection--columns"]),be.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(s){be.alter("insert_row",s,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(s){be.alter("insert_col",s,1,"auto")}),at={alter:function(s,u){var v,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,j=arguments.length>3?arguments[3]:void 0,q=arguments.length>4?arguments[4]:void 0,y=function(dn){if(dn.length===0)return[];var Vt=je(dn);return Vt.sort(function(un,gn){var St=Ve(un,1)[0],Mt=Ve(gn,1)[0];return St===Mt?0:St>Mt?1:-1}),Object(B.arrayReduce)(Vt,function(un,gn){var St=Ve(gn,2),Mt=St[0],Nt=St[1],cn=un[un.length-1],Dt=Ve(cn,2),Yt=Dt[0]+Dt[1];if(Mt<=Yt){var Sn=Math.max(Nt-(Yt-Mt),0);cn[1]+=Sn}else un.push([Mt,Nt]);return un},[Vt[0]])};switch(s){case"insert_row":var _=O.countSourceRows();if(ve.maxRows===_)return;if(u=Object(X.isDefined)(u)?u:_,v=We.createRow(u,k,j)){Ee.createRow(O.toPhysicalRow(u),k);var Y=tt.selectedRange.current(),ue=Y==null?void 0:Y.from,Te=ue==null?void 0:ue.row;if(Object(X.isDefined)(Te)&&Te>=u){var Fe=Y.to,Xe=Fe.row,lt=Fe.col,dt=ue.col;tt.isSelectedByRowHeader()&&(dt=-1),tt.setRangeStartOnly(new ne.a(Te+v,dt)),tt.setRangeEnd(new ne.a(Xe+v,lt))}else O._refreshBorders()}break;case"insert_col":if(v=We.createCol(u,k,j)){if(Ee.createColumn(O.toPhysicalColumn(u),k),Array.isArray(ve.colHeaders)){var Pt=[u,0];Pt.length+=v,Array.prototype.splice.apply(ve.colHeaders,Pt)}var rt=tt.selectedRange.current(),Xt=rt==null?void 0:rt.from,en=Xt==null?void 0:Xt.col;if(Object(X.isDefined)(en)&&en>=u){var Kt=rt.to,Cn=Kt.row,yn=Kt.col,bn=Xt.row;tt.isSelectedByColumnHeader()&&(bn=-1),tt.setRangeStartOnly(new ne.a(bn,en+v)),tt.setRangeEnd(new ne.a(Cn,yn+v))}else O._refreshBorders()}break;case"remove_row":var On=function(dn){var Vt=0;Object(B.arrayEach)(dn,function(un){var gn=Ve(un,2),St=gn[0],Mt=gn[1],Nt=Object(X.isEmpty)(St)?O.countRows()-1:Math.max(St-Vt,0);if(Number.isInteger(St)&&(St=Math.max(St-Vt,0)),We.removeRow(St,Mt,j)){Ee.removeRow(O.toPhysicalRow(Nt),Mt);var cn=O.countRows(),Dt=ve.fixedRowsTop;Dt>=Nt+1&&(ve.fixedRowsTop-=Math.min(Mt,Dt-Nt));var Yt=ve.fixedRowsBottom;Yt&&Nt>=cn-Yt&&(ve.fixedRowsBottom-=Math.min(Mt,Yt)),Vt+=Mt}})};Array.isArray(u)?On(y(u)):On([[u,k]]),at.adjustRowsAndCols(),O._refreshBorders();break;case"remove_col":var En=function(dn){var Vt=0;Object(B.arrayEach)(dn,function(un){var gn=Ve(un,2),St=gn[0],Mt=gn[1],Nt=Object(X.isEmpty)(St)?O.countCols()-1:Math.max(St-Vt,0),cn=O.toPhysicalColumn(Nt);if(Number.isInteger(St)&&(St=Math.max(St-Vt,0)),We.removeCol(St,Mt,j)){Ee.removeColumn(cn,Mt);var Dt=ve.fixedColumnsLeft;Dt>=Nt+1&&(ve.fixedColumnsLeft-=Math.min(Mt,Dt-Nt)),Array.isArray(ve.colHeaders)&&(cn===void 0&&(cn=-1),ve.colHeaders.splice(cn,Mt)),Vt+=Mt}})};Array.isArray(u)?En(y(u)):En([[u,k]]),at.adjustRowsAndCols(),O._refreshBorders();break;default:throw new Error('There is no such action "'.concat(s,'"'))}q||at.adjustRowsAndCols()},adjustRowsAndCols:function(){if(ve.minRows){var s=O.countRows();if(s<ve.minRows)for(var u=0,v=ve.minRows;u<v-s;u++)We.createRow(O.countRows(),1,"auto")}if(ve.minSpareRows){var k=O.countEmptyRows(!0);if(k<ve.minSpareRows)for(;k<ve.minSpareRows&&O.countSourceRows()<ve.maxRows;k++)We.createRow(O.countRows(),1,"auto")}var j;if((ve.minCols||ve.minSpareCols)&&(j=O.countEmptyCols(!0)),ve.minCols&&!ve.columns&&O.countCols()<ve.minCols)for(;O.countCols()<ve.minCols;j++)We.createCol(O.countCols(),1,"auto");if(ve.minSpareCols&&!ve.columns&&O.dataType==="array"&&j<ve.minSpareCols)for(;j<ve.minSpareCols&&O.countCols()<ve.maxCols;j++)We.createCol(O.countCols(),1,"auto");var q=O.countRows(),y=O.countCols();q!==0&&y!==0||tt.deselect(),tt.isSelected()&&Object(B.arrayEach)(tt.selectedRange,function(_){var Y=!1,ue=_.from.row,Te=_.from.col,Fe=_.to.row,Xe=_.to.col;ue>q-1?(Y=!0,Fe>(ue=q-1)&&(Fe=ue)):Fe>q-1&&(Y=!0,ue>(Fe=q-1)&&(ue=Fe)),Te>y-1?(Y=!0,Xe>(Te=y-1)&&(Xe=Te)):Xe>y-1&&(Y=!0,Te>(Xe=y-1)&&(Te=Xe)),Y&&O.selectCell(ue,Te,Fe,Xe)}),O.view&&O.view.wt.wtOverlays.adjustElementsSizes()},populateFromArray:function(s,u,v,k,j,q,y){var _,Y,ue,Te,Fe,Xe,lt,dt,Pt=[],rt={};if((Y=u.length)===0)return!1;switch(j){case"shift_down":for(Fe=v?v.col-s.col+1:0,Xe=v?v.row-s.row+1:0,ue=0,Te=(u=Object(de.translateRowsToColumns)(u)).length,lt=Math.max(Te,Fe);ue<lt;ue++)if(ue<Te){var Xt;for(_=0,Y=u[ue].length;_<Xe-Y;_++)u[ue].push(u[ue][_%Y]);u[ue].unshift(s.col+ue,s.row,0),(Xt=O).spliceCol.apply(Xt,je(u[ue]))}else{var en;u[ue%Te][0]=s.col+ue,(en=O).spliceCol.apply(en,je(u[ue%Te]))}break;case"shift_right":for(Fe=v?v.col-s.col+1:0,Xe=v?v.row-s.row+1:0,_=0,Y=u.length,dt=Math.max(Y,Xe);_<dt;_++)if(_<Y){var Kt;for(ue=0,Te=u[_].length;ue<Fe-Te;ue++)u[_].push(u[_][ue%Te]);u[_].unshift(s.row+_,s.col,0),(Kt=O).spliceRow.apply(Kt,je(u[_]))}else{var Cn;u[_%Y][0]=s.row+_,(Cn=O).spliceRow.apply(Cn,je(u[_%Y]))}break;case"overwrite":default:rt.row=s.row,rt.col=s.col;var yn,bn={row:v&&s?v.row-s.row+1:1,col:v&&s?v.col-s.col+1:1},On=0,En=0,dn=!0,Vt=function(Gn){var jn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Mn=u[Gn%u.length];return jn!==null?Mn[jn%Mn.length]:Mn},un=u.length,gn=v?v.row-s.row+1:0;for(Y=v?gn:Math.max(un,gn),_=0;_<Y&&!(v&&rt.row>v.row&&gn>un||!ve.allowInsertRow&&rt.row>O.countRows()-1||rt.row>=ve.maxRows);_++){var St=_-On,Mt=Vt(St).length,Nt=v?v.col-s.col+1:0;if(Te=v?Nt:Math.max(Mt,Nt),rt.col=s.col,yn=O.getCellMeta(rt.row,rt.col),k!=="CopyPaste.paste"&&k!=="Autofill.fill"||!yn.skipRowOnPaste){for(En=0,ue=0;ue<Te&&!(v&&rt.col>v.col&&Nt>Mt||!ve.allowInsertColumn&&rt.col>O.countCols()-1||rt.col>=ve.maxCols);ue++)if(yn=O.getCellMeta(rt.row,rt.col),k!=="CopyPaste.paste"&&k!=="Autofill.fill"||!yn.skipColumnOnPaste)if(yn.readOnly)rt.col+=1;else{var cn=ue-En,Dt=Vt(St,cn),Yt=O.getDataAtCell(rt.row,rt.col),Sn={row:St,col:cn};if(k==="Autofill.fill"){var _n=O.runHooks("beforeAutofillInsidePopulate",Sn,q,u,y,{},bn);_n&&(Dt=Object(X.isUndefined)(_n.value)?Dt:_n.value)}if(Dt!==null&&we(Dt)==="object")if(Array.isArray(Dt)&&Yt===null&&(Yt=[]),Yt===null||we(Yt)!=="object")dn=!1;else{var pn=Object(G.duckSchema)(Array.isArray(Yt)?Yt:Yt[0]||Yt),Hn=Object(G.duckSchema)(Array.isArray(Dt)?Dt:Dt[0]||Dt);Object(G.isObjectEqual)(pn,Hn)?Dt=Object(G.deepClone)(Dt):dn=!1}else Yt!==null&&we(Yt)==="object"&&(dn=!1);dn&&Pt.push([rt.row,rt.col,Dt]),dn=!0,rt.col+=1}else En+=1,rt.col+=1,Te+=1;rt.row+=1}else On+=1,rt.row+=1,Y+=1}O.setDataAtCell(Pt,null,null,k||"populateFromArray")}}},this.executeBatchOperations=function(s){var u=this;this.columnIndexMapper.executeBatchOperations(function(){u.rowIndexMapper.executeBatchOperations(function(){s()})})},this.init=function(){Ze.setData(ve.data),O.runHooks("beforeInit"),Object(F.isMobileBrowser)()&&Object(pe.addClass)(O.rootElement,"mobile"),this.updateSettings(ve,!0),this.view=new se.a(this),ut=ee.a.getInstance(O,ve,tt),O.runHooks("init"),this.forceFullRender=!0,this.view.render(),we(Oe)==="object"&&(O.runHooks("afterChange",Oe[0],Oe[1]),Oe=!1),O.runHooks("afterInit")},this.validateCell=function(s,u,v,k){var j,q=O.getCellValidator(u);function y(_){var Y=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(Y&&u.hidden!==!0){var ue=u.visualCol,Te=u.visualRow,Fe=O.getCell(Te,ue,!0);Fe&&Fe.nodeName!=="TH"&&O.view.wt.wtSettings.settings.cellRenderer(Te,ue,Fe),v(_)}else v(_)}Object(X.isRegExp)(q)&&(j=q,q=function(_,Y){Y(j.test(_))}),Object(ie.isFunction)(q)?(s=O.runHooks("beforeValidate",s,u.visualRow,u.prop,k),O._registerImmediate(function(){q.call(u,s,function(_){O&&(_=O.runHooks("afterValidate",_,s,u.visualRow,u.prop,k),u.valid=_,y(_),O.runHooks("postAfterValidate",_,s,u.visualRow,u.prop,k))})})):O._registerImmediate(function(){u.valid=!0,y(u.valid,!1)})},this.setDataAtCell=function(s,u,v,k){var j,q,y,_=an(s,u,v),Y=[],ue=k;for(j=0,q=_.length;j<q;j++){if(we(_[j])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof _[j][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");y=_[j][1]>=this.countCols()?_[j][1]:We.colToProp(_[j][1]),Y.push([_[j][0],y,Ze.getAtCell(this.toPhysicalRow(_[j][0]),_[j][1]),_[j][2]])}ue||we(s)!=="object"||(ue=u),O.runHooks("afterSetDataAtCell",Y,ue),Qt(Y,ue,function(){rn(Y,ue)})},this.setDataAtRowProp=function(s,u,v,k){var j,q,y=an(s,u,v),_=[],Y=k;for(j=0,q=y.length;j<q;j++)_.push([y[j][0],y[j][1],Ze.getAtCell(this.toPhysicalRow(y[j][0]),y[j][1]),y[j][2]]);Y||we(s)!=="object"||(Y=u),O.runHooks("afterSetDataAtRowProp",_,Y),Qt(_,Y,function(){rn(_,Y)})},this.listen=function(){O&&!O.isListening()&&(Ye=O.guid,O.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Ye=null,O.runHooks("afterUnlisten"))},this.isListening=function(){return Ye===O.guid},this.destroyEditor=function(){var s=arguments.length>0&&arguments[0]!==void 0&&arguments[0],u=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];O._refreshBorders(s,u)},this.populateFromArray=function(s,u,v,k,j,q,y,_,Y){if(we(v)!=="object"||we(v[0])!=="object")throw new Error("populateFromArray parameter `input` must be an array of arrays");var ue=typeof k=="number"?new ne.a(k,j):null;return at.populateFromArray(new ne.a(s,u),v,ue,q,y,_,Y)},this.spliceCol=function(s,u,v){for(var k,j=arguments.length,q=new Array(j>3?j-3:0),y=3;y<j;y++)q[y-3]=arguments[y];return(k=We).spliceCol.apply(k,[s,u,v].concat(q))},this.spliceRow=function(s,u,v){for(var k,j=arguments.length,q=new Array(j>3?j-3:0),y=3;y<j;y++)q[y-3]=arguments[y];return(k=We).spliceRow.apply(k,[s,u,v].concat(q))},this.getSelected=function(){if(tt.isSelected())return Object(B.arrayMap)(tt.getSelectedRange(),function(s){var u=s.from,v=s.to;return[u.row,u.col,v.row,v.col]})},this.getSelectedLast=function(){var s,u=this.getSelected();return u&&u.length>0&&(s=u[u.length-1]),s},this.getSelectedRange=function(){if(tt.isSelected())return Array.from(tt.getSelectedRange())},this.getSelectedRangeLast=function(){var s,u=this.getSelectedRange();return u&&u.length>0&&(s=u[u.length-1]),s},this.emptySelectedCells=function(s){var u=this;if(tt.isSelected()){var v=[];Object(B.arrayEach)(tt.getSelectedRange(),function(k){var j=k.getTopLeftCorner(),q=k.getBottomRightCorner();Object(H.rangeEach)(j.row,q.row,function(y){Object(H.rangeEach)(j.col,q.col,function(_){u.getCellMeta(y,_).readOnly||v.push([y,_,null])})})}),v.length>0&&this.setDataAtCell(v,s)}},this.render=function(){O.view&&(O.renderCall=!0,O.forceFullRender=!0,ut.lockEditor(),O._refreshBorders(null),ut.unlockEditor())},this.refreshDimensions=function(){if(O.view){var s=O.view.getLastSize(),u=s.width,v=s.height,k=Object(pe.getBoundingClientRect)(O.rootElement),j=k.width,q=k.height,y=j!==u||q!==v;O.runHooks("beforeRefreshDimensions",{width:u,height:v},{width:j,height:q},y)===!1||((y||O.view.wt.wtOverlays.scrollableElement===O.rootWindow)&&(O.view.setLastSize(j,q),O.render()),O.runHooks("afterRefreshDimensions",{width:u,height:v},{width:j,height:q},y))}},this.loadData=function(s){if(Array.isArray(ve.dataSchema)?O.dataType="array":Object(ie.isFunction)(ve.dataSchema)?O.dataType="function":O.dataType="object",We&&We.destroy(),We=new Ie.a(O,s,ve),we(s)==="object"&&s!==null)s.push&&s.splice||(s=[s]);else{if(s!==null)throw new Error("loadData only accepts array of objects or array of arrays (".concat(we(s)," given)"));var u,v=We.getSchema();s=[];var k,j=0;for(j=0,k=ve.startRows;j<k;j++)if(O.dataType!=="object"&&O.dataType!=="function"||!ve.dataSchema)if(O.dataType==="array")u=Object(G.deepClone)(v[0]),s.push(u);else{u=[];for(var q=0,y=ve.startCols;q<y;q++)u.push(null);s.push(u)}else u=Object(G.deepClone)(v),s.push(u)}Array.isArray(s[0])&&(O.dataType="array"),ve.data=s,O.runHooks("beforeLoadData",s,Oe),We.dataSource=s,Ze.data=s,Ze.dataType=O.dataType,Ze.colToProp=We.colToProp.bind(We),Ze.propToCol=We.propToCol.bind(We),Ze.countCachedColumns=We.countCachedColumns.bind(We),Ee.clearCellsCache(),O.initIndexMappers(),at.adjustRowsAndCols(),O.runHooks("afterLoadData",s,Oe),Oe?Oe=[null,"loadData"]:(O.runHooks("afterChange",null,"loadData"),O.render())},this.initIndexMappers=function(){var s=ve.columns,u=0;if(Array.isArray(s))u=s.length;else if(Object(ie.isFunction)(s))if(O.dataType==="array")for(var v=this.countSourceCols(),k=0;k<v;k+=1)s(k)&&(u+=1);else O.dataType!=="object"&&O.dataType!=="function"||(u=We.colToPropCache.length);else if(Object(X.isDefined)(ve.dataSchema)){var j=We.getSchema();u=Array.isArray(j)?j.length:Object(G.deepObjectSize)(j)}else u=this.countSourceCols();this.columnIndexMapper.initToLength(u),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(s,u,v,k){return Object(X.isUndefined)(s)?We.getAll():We.getRange(new ne.a(s,u),new ne.a(v,k),We.DESTINATION_RENDERER)},this.getCopyableText=function(s,u,v,k){return We.getCopyableText(new ne.a(s,u),new ne.a(v,k))},this.getCopyableData=function(s,u){return We.getCopyable(s,We.colToProp(u))},this.getSchema=function(){return We.getSchema()},this.updateSettings=function(s){var u,v,k=arguments.length>1&&arguments[1]!==void 0&&arguments[1],j=!1;if(Object(X.isDefined)(s.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(Object(X.isDefined)(s.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(u in s)u!=="data"&&(u!=="language"?u==="className"?Ot("className",s.className):u==="tableClassName"&&O.table?(Ot("tableClassName",s.tableClassName),O.view.wt.wtOverlays.syncOverlayTableClassNames()):le.a.getSingleton().isRegistered(u)||le.a.getSingleton().isDeprecated(u)?(Object(ie.isFunction)(s[u])||Array.isArray(s[u]))&&(s[u].initialHook=!0,O.addHook(u,s[u])):!k&&Object(G.hasOwnProperty)(s,u)&&(Ge[u]=s[u]):bt(s.language));s.data===void 0&&ve.data===void 0?O.loadData(null):s.data!==void 0?O.loadData(s.data):s.columns!==void 0&&(We.createMap(),O.initIndexMappers());var q=O.countCols(),y=ve.columns;if(y&&Object(ie.isFunction)(y)&&(j=!0),s.cell===void 0&&s.cells===void 0&&s.columns===void 0||Ee.clearCache(),q>0)for(u=0,v=0;u<q;u++){if(y){var _=j?y(u):y[v];_&&Ee.updateColumnMeta(v,_)}v+=1}Object(X.isDefined)(s.cell)&&Object(G.objectEach)(s.cell,function(lt){O.setCellMetaObject(lt.row,lt.col,lt)}),O.runHooks("afterCellMetaReset");var Y=O.rootElement.style.height;Y!==""&&(Y=parseInt(O.rootElement.style.height,10));var ue=s.height;if(Object(ie.isFunction)(ue)&&(ue=ue()),k){var Te=O.rootElement.getAttribute("style");Te&&O.rootElement.setAttribute("data-initialstyle",O.rootElement.getAttribute("style"))}if(ue===null){var Fe=O.rootElement.getAttribute("data-initialstyle");Fe&&(Fe.indexOf("height")>-1||Fe.indexOf("overflow")>-1)?O.rootElement.setAttribute("style",Fe):(O.rootElement.style.height="",O.rootElement.style.overflow="")}else ue!==void 0&&(O.rootElement.style.height=isNaN(ue)?"".concat(ue):"".concat(ue,"px"),O.rootElement.style.overflow="hidden");if(s.width!==void 0){var Xe=s.width;Object(ie.isFunction)(Xe)&&(Xe=Xe()),O.rootElement.style.width=isNaN(Xe)?"".concat(Xe):"".concat(Xe,"px")}if(s.selectionStyle!==void 0){if(!Object(G.isObject)(s.selectionStyle))throw new Error("The value of the option `selectionStyle` must be an object. To reset `selectionStyle` to the defaults, provide an empty object as the value.");this.selection.updateBorderStyle(s.selectionStyle)}k||(O.view&&O.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),O.runHooks("afterUpdateSettings",s)),at.adjustRowsAndCols(),O.view&&!Oe&&(O.forceFullRender=!0,ut.lockEditor(),O._refreshBorders(null),ut.unlockEditor()),k||!O.view||Y!==""&&ue!==""&&ue!==void 0||Y===ue||O.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var s=O.getSelectedLast();if(ve.getValue){if(Object(ie.isFunction)(ve.getValue))return ve.getValue.call(O);if(s)return O.getData()[s[0][0]][ve.getValue]}else if(s)return O.getDataAtCell(s[0],s[1])},this.getSettings=function(){return ve},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(s,u,v,k,j){at.alter(s,u,v,k,j)},this.getCell=function(s,u){var v=arguments.length>2&&arguments[2]!==void 0&&arguments[2],k=u,j=s;if(u>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(u)))return null;k=this.columnIndexMapper.getRenderableFromVisualIndex(u)}if(s>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(s)))return null;j=this.rowIndexMapper.getRenderableFromVisualIndex(s)}return j===null||k===null?null:O.view.getCellAtCoords(new ne.a(j,k),v)},this.getCoords=function(s){var u=this.view.wt.wtTable.getCoords(s);if(u===null)return null;var v=u.row,k=u.col,j=v,q=k;return v>=0&&(j=this.rowIndexMapper.getVisualFromRenderableIndex(v)),k>=0&&(q=this.columnIndexMapper.getVisualFromRenderableIndex(k)),new ne.a(j,q)},this.colToProp=function(s){return We.colToProp(s)},this.propToCol=function(s){return We.propToCol(s)},this.toVisualRow=function(s){return be.rowIndexMapper.getVisualFromPhysicalIndex(s)},this.toVisualColumn=function(s){return be.columnIndexMapper.getVisualFromPhysicalIndex(s)},this.toPhysicalRow=function(s){return be.rowIndexMapper.getPhysicalFromVisualIndex(s)},this.toPhysicalColumn=function(s){return be.columnIndexMapper.getPhysicalFromVisualIndex(s)},this.getDataAtCell=function(s,u){return We.get(s,We.colToProp(u))},this.getDataAtRowProp=function(s,u){return We.get(s,u)},this.getDataAtCol=function(s){var u;return(u=[]).concat.apply(u,je(We.getRange(new ne.a(0,s),new ne.a(ve.data.length-1,s),We.DESTINATION_RENDERER)))},this.getDataAtProp=function(s){var u,v=We.getRange(new ne.a(0,We.propToCol(s)),new ne.a(ve.data.length-1,We.propToCol(s)),We.DESTINATION_RENDERER);return(u=[]).concat.apply(u,je(v))},this.getSourceData=function(s,u,v,k){return s===void 0?Ze.getData():Ze.getByRange(new ne.a(s,u),new ne.a(v,k))},this.getSourceDataArray=function(s,u,v,k){return s===void 0?Ze.getData(!0):Ze.getByRange(new ne.a(s,u),new ne.a(v,k),!0)},this.getSourceDataAtCol=function(s){return Ze.getAtColumn(s)},this.setSourceDataAtCell=function(s,u,v,k){var j=an(s,u,v),q=[];j.forEach(function(y,_){var Y=Ve(y,3),ue=Y[0],Te=Y[1],Fe=Y[2];q.push([j[_][0],j[_][1],Ze.getAtCell(j[_][0],j[_][1]),j[_][2]]),Ze.setAtCell(ue,Te,Fe)}),this.runHooks("afterSetSourceDataAtCell",q,k),this.render()},this.getSourceDataAtRow=function(s){return Ze.getAtRow(s)},this.getSourceDataAtCell=function(s,u){return Ze.getAtCell(s,u)},this.getDataAtRow=function(s){return We.getRange(new ne.a(s,0),new ne.a(s,this.countCols()-1),We.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(s,u,v,k){var j=this,q=s===void 0?[0,0,this.countRows(),this.countCols()]:[s,u,v,k],y=q[0],_=q[1],Y=q[2],ue=q[3],Te=null,Fe=null;Y===void 0&&(Y=y),ue===void 0&&(ue=_);var Xe="mixed";return Object(H.rangeEach)(Math.max(Math.min(y,Y),0),Math.max(y,Y),function(lt){var dt=!0;return Object(H.rangeEach)(Math.max(Math.min(_,ue),0),Math.max(_,ue),function(Pt){var rt=j.getCellMeta(lt,Pt);return Fe=rt.type,Te?dt=Te===Fe:Te=Fe,dt}),Xe=dt?Fe:"mixed",dt}),Xe},this.removeCellMeta=function(s,u,v){var k=[this.toPhysicalRow(s),this.toPhysicalColumn(u)],j=k[0],q=k[1],y=Ee.getCellMeta(j,q,v);O.runHooks("beforeRemoveCellMeta",s,u,v,y)!==!1&&(Ee.removeCellMeta(j,q,v),O.runHooks("afterRemoveCellMeta",s,u,v,y)),y=null},this.spliceCellsMeta=function(s){for(var u=this,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=arguments.length,j=new Array(k>2?k-2:0),q=2;q<k;q++)j[q-2]=arguments[q];if(j.length>0&&!Array.isArray(j[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&Ee.removeRow(this.toPhysicalRow(s),v),j.length>0&&Object(B.arrayEach)(j.reverse(),function(y){Ee.createRow(u.toPhysicalRow(s)),Object(B.arrayEach)(y,function(_,Y){return u.setCellMetaObject(s,Y,_)})})},this.setCellMetaObject=function(s,u,v){var k=this;we(v)==="object"&&Object(G.objectEach)(v,function(j,q){k.setCellMeta(s,u,q,j)})},this.setCellMeta=function(s,u,v,k){if(O.runHooks("beforeSetCellMeta",s,u,v,k)!==!1){var j=s,q=u;s<this.countRows()&&(j=this.toPhysicalRow(s)),u<this.countCols()&&(q=this.toPhysicalColumn(u)),Ee.setCellMeta(j,q,v,k),O.runHooks("afterSetCellMeta",s,u,v,k)}},this.getCellsMeta=function(){return Ee.getCellsMeta()},this.getCellMeta=function(s,u){var v=this.toPhysicalRow(s),k=this.toPhysicalColumn(u);v===null&&(v=s),k===null&&(k=u);var j=We.colToProp(u),q=Ee.getCellMeta(v,k);if(q.row=v,q.col=k,q.visualRow=s,q.visualCol=u,q.prop=j,q.instance=O,O.runHooks("beforeGetCellMeta",s,u,q),O.hasHook("beforeGetCellMeta")&&Object(G.hasOwnProperty)(q,"type")&&Ee.updateCellMeta(v,k,{type:q.type}),q.cells){var y=q.cells(v,k,j);y&&Ee.updateCellMeta(v,k,y)}return O.runHooks("afterGetCellMeta",s,u,q),q},this.getCellMetaAtRow=function(s){return Ee.getCellsMetaAtRow(s)},this.isColumnModificationAllowed=function(){return!(O.dataType==="object"||ve.columns)};var mn=Object(de.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(s,u){return Object(x.b)(mn.call(this,s,u))},this.getCellEditor=Object(de.cellMethodLookupFactory)("editor");var W=Object(de.cellMethodLookupFactory)("validator");this.getCellValidator=function(s,u){var v=W.call(this,s,u);return typeof v=="string"&&(v=Object($.b)(v)),v},this.validateCells=function(s){this._validateCells(s)},this.validateRows=function(s,u){if(!Array.isArray(s))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(u,s)},this.validateColumns=function(s,u){if(!Array.isArray(s))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(u,void 0,s)},this._validateCells=function(s,u,v){var k=new Jt;s&&(k.onQueueEmpty=s);for(var j=O.countRows()-1;j>=0;)if(u===void 0||u.indexOf(j)!==-1){for(var q=O.countCols()-1;q>=0;)(v===void 0||v.indexOf(q)!==-1)&&(k.addValidatorToQueue(),O.validateCell(O.getDataAtCell(j,q),O.getCellMeta(j,q),function(y){if(typeof y!="boolean")throw new Error("Validation error: result is not boolean");y===!1&&(k.valid=!1),k.removeValidatorFormQueue()},"validateCells")),q-=1;j-=1}else j-=1;k.checkIfQueueIsEmpty()},this.getRowHeader=function(s){var u=ve.rowHeaders,v=s;return v!==void 0&&(v=O.runHooks("modifyRowHeader",v)),v===void 0?(u=[],Object(H.rangeEach)(O.countRows()-1,function(k){u.push(O.getRowHeader(k))})):Array.isArray(u)&&u[v]!==void 0?u=u[v]:Object(ie.isFunction)(u)?u=u(v):u&&typeof u!="string"&&typeof u!="number"&&(u=v+1),u},this.hasRowHeaders=function(){return!!ve.rowHeaders},this.hasColHeaders=function(){if(ve.colHeaders!==void 0&&ve.colHeaders!==null)return!!ve.colHeaders;for(var s=0,u=O.countCols();s<u;s++)if(O.getColHeader(s))return!0;return!1},this.getColHeader=function(s){var u=O.runHooks("modifyColHeader",s),v=ve.colHeaders;if(u===void 0){for(var k=[],j=O.countCols(),q=0;q<j;q++)k.push(O.getColHeader(q));v=k}else{var y=O.toPhysicalColumn(u),_=function(Y){for(var ue=[],Te=O.countCols(),Fe=0;Fe<Te;Fe++)Object(ie.isFunction)(ve.columns)&&ve.columns(Fe)&&ue.push(Fe);return ue[Y]}(y);ve.colHeaders===!1?v=null:ve.columns&&Object(ie.isFunction)(ve.columns)&&ve.columns(_)&&ve.columns(_).title?v=ve.columns(_).title:ve.columns&&ve.columns[y]&&ve.columns[y].title?v=ve.columns[y].title:Array.isArray(ve.colHeaders)&&ve.colHeaders[y]!==void 0?v=ve.colHeaders[y]:Object(ie.isFunction)(ve.colHeaders)?v=ve.colHeaders(y):ve.colHeaders&&typeof ve.colHeaders!="string"&&typeof ve.colHeaders!="number"&&(v=Object(de.spreadsheetColumnLabel)(u))}return v},this._getColWidthFromSettings=function(s){var u;if(s>=0&&(u=O.getCellMeta(0,s).width),u!==void 0&&u!==ve.width||(u=ve.colWidths),u!=null){switch(we(u)){case"object":u=u[s];break;case"function":u=u(s)}typeof u=="string"&&(u=parseInt(u,10))}return u},this.getColWidth=function(s){var u=O._getColWidthFromSettings(s);return(u=O.runHooks("modifyColWidth",u,s))===void 0&&(u=ne.d.DEFAULT_WIDTH),u},this._getRowHeightFromSettings=function(s){var u=ve.rowHeights;if(u!=null){switch(we(u)){case"object":u=u[s];break;case"function":u=u(s)}typeof u=="string"&&(u=parseInt(u,10))}return u},this.getRowHeight=function(s){var u=O._getRowHeightFromSettings(s);return u=O.runHooks("modifyRowHeight",u,s)},this.countSourceRows=function(){return Ze.countRows()},this.countSourceCols=function(){return Ze.countFirstRowKeys()},this.countRows=function(){return We.getLength()},this.countCols=function(){var s=ve.maxCols,u=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(s,u)},this.countRenderedRows=function(){return O.view.wt.drawn?O.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return O.view.wt.drawn?O.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return O.view.wt.drawn?O.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return O.view.wt.drawn?O.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var s=arguments.length>0&&arguments[0]!==void 0&&arguments[0],u=0;return Object(H.rangeEachReverse)(O.countRows()-1,function(v){if(O.isEmptyRow(v))u+=1;else if(s===!0)return!1}),u},this.countEmptyCols=function(){var s=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(O.countRows()<1)return 0;var u=0;return Object(H.rangeEachReverse)(O.countCols()-1,function(v){if(O.isEmptyCol(v))u+=1;else if(s===!0)return!1}),u},this.isEmptyRow=function(s){return ve.isEmptyRow.call(O,s)},this.isEmptyCol=function(s){return ve.isEmptyCol.call(O,s)},this.selectCell=function(s,u,v,k){var j=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],q=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];return!Object(X.isUndefined)(s)&&!Object(X.isUndefined)(u)&&this.selectCells([[s,u,v,k]],j,q)},this.selectCells=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],u=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],v=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];u===!1&&(he=!0);var k=tt.selectCells(s);return k&&v&&O.listen(),he=!1,k},this.selectColumns=function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s;return tt.selectColumns(s,u)},this.selectRows=function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s;return tt.selectRows(s,u)},this.deselectCell=function(){tt.deselect()},this.selectAll=function(){he=!0,tt.selectAll(),he=!1};var R=function(s,u){return s.getFirstNotHiddenIndex(u,1,!0)};function U(s){return function(){throw new Error('The "'.concat(s,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(s,u){var v=arguments.length>2&&arguments[2]!==void 0&&arguments[2],k=arguments.length>3&&arguments[3]!==void 0&&arguments[3],j=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],q=!v,y=!k,_=s,Y=u;if(j){var ue=Number.isInteger(s),Te=Number.isInteger(u),Fe=ue?R(this.rowIndexMapper,s):void 0,Xe=Te?R(this.columnIndexMapper,u):void 0;if(Fe===null||Xe===null)return!1;_=ue?O.rowIndexMapper.getRenderableFromVisualIndex(Fe):void 0,Y=Te?O.columnIndexMapper.getRenderableFromVisualIndex(Xe):void 0}var lt=Number.isInteger(_),dt=Number.isInteger(Y);return lt&&dt?O.view.scrollViewport(new ne.a(_,Y),q,k,v,y):lt&&dt===!1?O.view.scrollViewportVertically(_,q,v):!(!dt||lt!==!1)&&O.view.scrollViewportHorizontally(Y,k,y)},this.destroy=function(){if(O._clearTimeouts(),O._clearImmediates(),O.view&&O.view.destroy(),Ze&&Ze.destroy(),Ze=null,Ee.clearCache(),Object(me.c)(),Object(K.b)(O)){var s=this.rootDocument.querySelector("#hot-display-license-info");s&&s.parentNode.removeChild(s)}Object(pe.empty)(O.rootElement),re.destroy(),ut&&ut.destroy(),O.executeBatchOperations(function(){O.runHooks("afterDestroy")}),le.a.getSingleton().destroy(O),Object(G.objectEach)(O,function(u,v,k){Object(ie.isFunction)(u)?k[v]=U(v):v!=="guid"&&(k[v]=null)}),O.isDestroyed=!0,We&&We.destroy(),O.rowIndexMapper=null,O.columnIndexMapper=null,We=null,at=null,tt=null,ut=null,O=null},this.getActiveEditor=function(){return ut.getActiveEditor()},this.getPlugin=function(s){return Object(P.a)(this,s)},this.getInstance=function(){return O},this.addHook=function(s,u){le.a.getSingleton().add(s,u,O)},this.hasHook=function(s){return le.a.getSingleton().has(s,O)},this.addHookOnce=function(s,u){le.a.getSingleton().once(s,u,O)},this.removeHook=function(s,u){le.a.getSingleton().remove(s,u,O)},this.runHooks=function(s,u,v,k,j,q,y){return le.a.getSingleton().run(O,s,u,v,k,j,q,y)},this.getTranslatedPhrase=function(s,u){return Object(Re.a)(ve.language,s,u)},this.toHTML=function(){return Object(V.instanceToHTML)(be)},this.toTableElement=function(){var s=be.rootDocument.createElement("div");return s.insertAdjacentHTML("afterbegin",Object(V.instanceToHTML)(be)),s.firstElementChild},this.timeouts=[],this._registerTimeout=function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=s;typeof v=="function"&&(v=setTimeout(v,u)),this.timeouts.push(v)},this._clearTimeouts=function(){Object(B.arrayEach)(this.timeouts,function(s){clearTimeout(s)})},this.immediates=[],this._registerImmediate=function(s){this.immediates.push(M(s))},this._clearImmediates=function(){Object(B.arrayEach)(this.immediates,function(s){C(s)})},this._refreshBorders=function(){var s=arguments.length>0&&arguments[0]!==void 0&&arguments[0],u=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];ut.destroyEditor(s),O.view.render(),u&&tt.isSelected()&&ut.prepareEditor()},le.a.getSingleton().run(O,"construct")}}).call(this,i(243).setImmediate,i(243).clearImmediate)},,function(ot,S,i){"use strict";var M=i(161),C=i(170),pe=i(184),ie=i(165),X=i(218);function F(H,se){return function(I){if(Array.isArray(I))return I}(H)||function(I,de){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(I)))){var l=[],K=!0,ne=!1,le=void 0;try{for(var Re,De=I[Symbol.iterator]();!(K=(Re=De.next()).done)&&(l.push(Re.value),!de||l.length!==de);K=!0);}catch(He){ne=!0,le=He}finally{try{K||De.return==null||De.return()}finally{if(ne)throw le}}return l}}(H,se)||V(H,se)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ee(H,se,I){return(ee=ce()?Reflect.construct:function(de,l,K){var ne=[null];ne.push.apply(ne,l);var le=new(Function.bind.apply(de,ne));return K&&G(le,K.prototype),le}).apply(null,arguments)}function ce(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(H){return!1}}function G(H,se){return(G=Object.setPrototypeOf||function(I,de){return I.__proto__=de,I})(H,se)}function B(H){return function(se){if(Array.isArray(se))return P(se)}(H)||function(se){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(se))return Array.from(se)}(H)||V(H)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function V(H,se){if(H){if(typeof H=="string")return P(H,se);var I=Object.prototype.toString.call(H).slice(8,-1);return I==="Object"&&H.constructor&&(I=H.constructor.name),I==="Map"||I==="Set"?Array.from(H):I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I)?P(H,se):void 0}}function P(H,se){(se==null||se>H.length)&&(se=H.length);for(var I=0,de=new Array(se);I<se;I++)de[I]=H[I];return de}function x(H,se){for(var I=0;I<se.length;I++){var de=se[I];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(H,de.key,de)}}var $=new WeakMap,fe=function(){function H(l){(function(K,ne){if(!(K instanceof ne))throw new TypeError("Cannot call a class as a function")})(this,H),this.instance=l,this.eventManager=new C.a(l),this.settings=l.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,$.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var se,I,de;return se=H,(I=[{key:"render",value:function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1}},{key:"getCellAtCoords",value:function(l,K){var ne=this.wt.getCell(l,K);return ne<0?null:ne}},{key:"scrollViewport",value:function(l,K,ne,le,Re){return this.wt.scrollViewport(l,K,ne,le,Re)}},{key:"scrollViewportHorizontally",value:function(l,K,ne){return this.wt.scrollViewportHorizontally(l,K,ne)}},{key:"scrollViewportVertically",value:function(l,K,ne){return this.wt.scrollViewportVertically(l,K,ne)}},{key:"createElements",value:function(){var l=$.get(this),K=this.instance,ne=K.rootElement,le=K.rootDocument,Re=ne.getAttribute("style");Re&&ne.setAttribute("data-originalstyle",Re),Object(M.addClass)(ne,"handsontable"),l.table=le.createElement("TABLE"),Object(M.addClass)(l.table,"htCore"),this.instance.getSettings().tableClassName&&Object(M.addClass)(l.table,this.instance.getSettings().tableClassName),this.THEAD=le.createElement("THEAD"),l.table.appendChild(this.THEAD),this.TBODY=le.createElement("TBODY"),l.table.appendChild(this.TBODY),this.instance.table=l.table,this.instance.container.insertBefore(l.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var l=this,K=$.get(this),ne=this.instance,le=ne.rootElement,Re=ne.rootDocument,De=Re.documentElement;this.eventManager.addEventListener(le,"mousedown",function(He){if(K.selectionMouseDown=!0,!l.isTextSelectionAllowed(He.target)){var me=l.instance.rootWindow;Object(M.clearTextSelection)(me),He.preventDefault(),me.focus()}}),this.eventManager.addEventListener(le,"mouseup",function(){K.selectionMouseDown=!1}),this.eventManager.addEventListener(le,"mousemove",function(He){K.selectionMouseDown&&!l.isTextSelectionAllowed(He.target)&&(l.settings.fragmentSelection&&Object(M.clearTextSelection)(l.instance.rootWindow),He.preventDefault())}),this.eventManager.addEventListener(De,"keyup",function(He){l.instance.selection.isInProgress()&&!He.shiftKey&&l.instance.selection.finish()}),this.eventManager.addEventListener(De,"mouseup",function(He){l.instance.selection.isInProgress()&&Object(pe.isLeftClick)(He)&&l.instance.selection.finish(),K.mouseDown=!1,(Object(M.isOutsideInput)(Re.activeElement)||!l.instance.selection.isSelected()&&!Object(pe.isRightClick)(He))&&l.instance.unlisten()}),this.eventManager.addEventListener(De,"contextmenu",function(He){l.instance.selection.isInProgress()&&Object(pe.isRightClick)(He)&&(l.instance.selection.finish(),K.mouseDown=!1)}),this.eventManager.addEventListener(De,"touchend",function(){l.instance.selection.isInProgress()&&l.instance.selection.finish(),K.mouseDown=!1}),this.eventManager.addEventListener(De,"mousedown",function(He){var me=He.target,Se=He.x||He.clientX,Ie=He.y||He.clientY,Le=He.target;if(!K.mouseDown&&le&&l.instance.view){var we=l.instance.view.wt.wtTable.holder;if(Le===we){var Ve=Object(M.getScrollbarWidth)(Re);if(Re.elementFromPoint(Se+Ve,Ie)!==we||Re.elementFromPoint(Se,Ie+Ve)!==we)return}else for(;Le!==De;){if(Le===null){if(He.isTargetWebComponent)break;return}if(Le===le)return;Le=Le.parentNode}(typeof l.settings.outsideClickDeselects=="function"?l.settings.outsideClickDeselects(me):l.settings.outsideClickDeselects)?l.instance.deselectCell():l.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(K.table,"selectstart",function(He){l.settings.fragmentSelection||Object(M.isInput)(He.target)||He.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(l){var K=l.row,ne=l.col;return ee(ie.a,B(this.translateFromRenderableToVisualIndex(K,ne)))}},{key:"translateFromRenderableToVisualIndex",value:function(l,K){var ne=l>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(l):l,le=K>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(K):K;return ne===null&&(ne=l),le===null&&(le=K),[ne,le]}},{key:"countRenderableColumns",value:function(){return Math.min(this.instance.columnIndexMapper.getRenderableIndexesLength(),this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return Math.min(this.instance.rowIndexMapper.getRenderableIndexesLength(),this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(l,K){return this.countNotHiddenIndexes(l,K,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(l,K){return this.countNotHiddenIndexes(l,K,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(l,K,ne,le){if(isNaN(l)||l<0)return 0;var Re=ne.getFirstNotHiddenIndex(l,K),De=ne.getRenderableFromVisualIndex(Re);if(!Number.isInteger(De))return 0;var He=0;return K<0?He=De+1:K>0&&(He=le-De),He}},{key:"initializeWalkontable",value:function(){var l=this,K=$.get(this),ne={externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:K.table,preventOverflow:function(){return l.settings.preventOverflow},preventWheel:function(){return l.settings.preventWheel},stretchH:function(){return l.settings.stretchH},data:function(me,Se){var Ie;return(Ie=l.instance).getDataAtCell.apply(Ie,B(l.translateFromRenderableToVisualIndex(me,Se)))},totalRows:function(){return l.countRenderableRows()},totalColumns:function(){return l.countRenderableColumns()},fixedColumnsLeft:function(){var me=parseInt(l.settings.fixedColumnsLeft,10);return l.countNotHiddenColumnIndexes(me-1,-1)},fixedRowsTop:function(){var me=parseInt(l.settings.fixedRowsTop,10);return l.countNotHiddenRowIndexes(me-1,-1)},fixedRowsBottom:function(){var me=parseInt(l.settings.fixedRowsBottom,10);return l.countNotHiddenRowIndexes(l.instance.countRows()-me,1)},minSpareRows:function(){return l.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var me=[];return l.instance.hasRowHeaders()&&me.push(function(Se,Ie){var Le=Se>=0?l.instance.rowIndexMapper.getVisualFromRenderableIndex(Se):Se;l.appendRowHeader(Le,Ie)}),l.instance.runHooks("afterGetRowHeaderRenderers",me),me},columnHeaders:function(){var me=[];return l.instance.hasColHeaders()&&me.push(function(Se,Ie){var Le=Se>=0?l.instance.columnIndexMapper.getVisualFromRenderableIndex(Se):Se;l.appendColHeader(Le,Ie)}),l.instance.runHooks("afterGetColumnHeaderRenderers",me),me},columnWidth:function(me){var Se=l.instance.columnIndexMapper.getVisualFromRenderableIndex(me);return l.instance.getColWidth(Se===null?me:Se)},rowHeight:function(me){var Se=l.instance.rowIndexMapper.getVisualFromRenderableIndex(me);return l.instance.getRowHeight(Se===null?me:Se)},cellRenderer:function(me,Se,Ie){var Le=F(l.translateFromRenderableToVisualIndex(me,Se),2),we=Le[0],Ve=Le[1],je=l.instance.getCellMeta(we,Ve),Ke=l.instance.colToProp(Ve),$e=l.instance.getDataAtRowProp(we,Ke);l.instance.hasHook("beforeValueRender")&&($e=l.instance.runHooks("beforeValueRender",$e,je)),l.instance.runHooks("beforeRenderer",Ie,we,Ve,Ke,$e,je),l.instance.getCellRenderer(je)(l.instance,Ie,we,Ve,Ke,$e,je),l.instance.runHooks("afterRenderer",Ie,we,Ve,Ke,$e,je)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return l.settings.fragmentSelection},onWindowResize:function(){l.instance&&!l.instance.isDestroyed&&l.instance.refreshDimensions()},onCellMouseDown:function(me,Se,Ie,Le){var we=l.translateFromRenderableToVisualCoords(Se),Ve={row:!1,column:!1,cell:!1};l.instance.listen(),l.activeWt=Le,K.mouseDown=!0,l.instance.runHooks("beforeOnCellMouseDown",me,we,Ie,Ve),Object(pe.isImmediatePropagationStopped)(me)||(Object(X.a)(me,{coords:we,selection:l.instance.selection,controller:Ve}),l.instance.runHooks("afterOnCellMouseDown",me,we,Ie),l.activeWt=l.wt)},onCellContextMenu:function(me,Se,Ie,Le){var we=l.translateFromRenderableToVisualCoords(Se);l.activeWt=Le,K.mouseDown=!1,l.instance.selection.isInProgress()&&l.instance.selection.finish(),l.instance.runHooks("beforeOnCellContextMenu",me,we,Ie),Object(pe.isImmediatePropagationStopped)(me)||(l.instance.runHooks("afterOnCellContextMenu",me,we,Ie),l.activeWt=l.wt)},onCellMouseOut:function(me,Se,Ie,Le){var we=l.translateFromRenderableToVisualCoords(Se);l.activeWt=Le,l.instance.runHooks("beforeOnCellMouseOut",me,we,Ie),Object(pe.isImmediatePropagationStopped)(me)||(l.instance.runHooks("afterOnCellMouseOut",me,we,Ie),l.activeWt=l.wt)},onCellMouseOver:function(me,Se,Ie,Le){var we=l.translateFromRenderableToVisualCoords(Se),Ve={row:!1,column:!1,cell:!1};l.activeWt=Le,l.instance.runHooks("beforeOnCellMouseOver",me,we,Ie,Ve),Object(pe.isImmediatePropagationStopped)(me)||(K.mouseDown&&Object(X.a)(me,{coords:we,selection:l.instance.selection,controller:Ve}),l.instance.runHooks("afterOnCellMouseOver",me,we,Ie),l.activeWt=l.wt)},onCellMouseUp:function(me,Se,Ie,Le){var we=l.translateFromRenderableToVisualCoords(Se);l.activeWt=Le,l.instance.runHooks("beforeOnCellMouseUp",me,we,Ie),Object(pe.isImmediatePropagationStopped)(me)||(l.instance.runHooks("afterOnCellMouseUp",me,we,Ie),l.activeWt=l.wt)},onCellCornerMouseDown:function(me){me.preventDefault(),l.instance.runHooks("afterOnCellCornerMouseDown",me)},onCellCornerDblClick:function(me){me.preventDefault(),l.instance.runHooks("afterOnCellCornerDblClick",me)},beforeDraw:function(me,Se){return l.beforeRender(me,Se)},onDraw:function(me){return l.onDraw(me)},onScrollVertically:function(){return l.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return l.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return l.instance.runHooks("beforeRemoveCellClassNames")},onAfterDrawSelection:function(me,Se,Ie,Le){var we=F(l.translateFromRenderableToVisualIndex(me,Se),2),Ve=we[0],je=we[1];return l.instance.runHooks("afterDrawSelection",Ve,je,Ie,Le)},onBeforeDrawBorders:function(me,Se){var Ie=F(me,4),Le=Ie[0],we=Ie[1],Ve=Ie[2],je=Ie[3],Ke=[l.instance.rowIndexMapper.getVisualFromRenderableIndex(Le),l.instance.columnIndexMapper.getVisualFromRenderableIndex(we),l.instance.rowIndexMapper.getVisualFromRenderableIndex(Ve),l.instance.columnIndexMapper.getVisualFromRenderableIndex(je)];return l.instance.runHooks("beforeDrawBorders",Ke,Se)},onBeforeTouchScroll:function(){return l.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return l.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(me,Se){var Ie=l.instance.columnIndexMapper.getVisualFromRenderableIndex(Se);return l.instance.runHooks("beforeStretchingColumnWidth",me,Ie)},onModifyRowHeaderWidth:function(me){return l.instance.runHooks("modifyRowHeaderWidth",me)},onModifyGetCellCoords:function(me,Se,Ie){var Le=Se>=0?l.instance.columnIndexMapper.getVisualFromRenderableIndex(Se):Se,we=me>=0?l.instance.rowIndexMapper.getVisualFromRenderableIndex(me):me;return l.instance.runHooks("modifyGetCellCoords",we,Le,Ie)},viewportRowCalculatorOverride:function(me){var Se=l.settings.viewportRowRenderingOffset;if(Se==="auto"&&l.settings.fixedRowsTop&&(Se=10),Se>0||Se==="auto"){var Ie=l.countRenderableRows();if(typeof Se=="number")me.startRow=Math.max(me.startRow-Se,0),me.endRow=Math.min(me.endRow+Se,Ie-1);else if(Se==="auto"){var Le=me.startRow+me.endRow-me.startRow,we=Math.ceil(Le/Ie*12);me.startRow=Math.max(me.startRow-we,0),me.endRow=Math.min(me.endRow+we,Ie-1)}}l.instance.runHooks("afterViewportRowCalculatorOverride",me)},viewportColumnCalculatorOverride:function(me){var Se=l.settings.viewportColumnRenderingOffset;if(Se==="auto"&&l.settings.fixedColumnsLeft&&(Se=10),Se>0||Se==="auto"){var Ie=l.countRenderableColumns();if(typeof Se=="number"&&(me.startColumn=Math.max(me.startColumn-Se,0),me.endColumn=Math.min(me.endColumn+Se,Ie-1)),Se==="auto"){var Le=me.startColumn+me.endColumn-me.startColumn,we=Math.ceil(Le/Ie*12);me.startRow=Math.max(me.startColumn-we,0),me.endColumn=Math.min(me.endColumn+we,Ie-1)}}l.instance.runHooks("afterViewportColumnCalculatorOverride",me)},rowHeaderWidth:function(){return l.settings.rowHeaderWidth},columnHeaderHeight:function(){var me=l.instance.runHooks("modifyColumnHeaderHeight");return l.settings.columnHeaderHeight||me}};this.instance.runHooks("beforeInitWalkontable",ne),this.wt=new ie.e(ne),this.activeWt=this.wt;var le=this.wt.wtTable.spreader,Re=Object(M.getBoundingClientRect)(this.instance.rootElement),De=Re.width,He=Re.height;this.setLastSize(De,He),this.eventManager.addEventListener(le,"mousedown",function(me){me.target===le&&me.which===3&&me.stopPropagation()}),this.eventManager.addEventListener(le,"contextmenu",function(me){me.target===le&&me.which===3&&me.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){l.settings.observeDOMVisibility&&l.wt.drawInterrupted&&(l.instance.forceFullRender=!0,l.render())})}},{key:"isTextSelectionAllowed",value:function(l){if(Object(M.isInput)(l))return!0;var K=Object(M.isChildOf)(l,this.instance.view.wt.wtTable.spreader);return!(this.settings.fragmentSelection!==!0||!K)||!(this.settings.fragmentSelection!=="cell"||!this.isSelectedOnlyCell()||!K)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return $.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var l=F(this.instance.getSelectedLast()||[],4),K=l[0],ne=l[1],le=l[2],Re=l[3];return K!==void 0&&K===le&&ne===Re}},{key:"isCellEdited",value:function(){var l=this.instance.getActiveEditor();return l&&l.isOpened()}},{key:"beforeRender",value:function(l,K){l&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,K)}},{key:"onDraw",value:function(l){l&&this.instance.runHooks("afterRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(l,K){if(K.firstChild){var ne=K.firstChild;if(!Object(M.hasClass)(ne,"relative"))return Object(M.empty)(K),void this.appendRowHeader(l,K);this.updateCellHeader(ne.querySelector(".rowHeader"),l,this.instance.getRowHeader)}else{var le=this.instance,Re=le.rootDocument,De=le.getRowHeader,He=Re.createElement("div"),me=Re.createElement("span");He.className="relative",me.className="rowHeader",this.updateCellHeader(me,l,De),He.appendChild(me),K.appendChild(He)}this.instance.runHooks("afterGetRowHeader",l,K)}},{key:"appendColHeader",value:function(l,K){if(K.firstChild){var ne=K.firstChild;Object(M.hasClass)(ne,"relative")?this.updateCellHeader(ne.querySelector(".colHeader"),l,this.instance.getColHeader):(Object(M.empty)(K),this.appendColHeader(l,K))}else{var le=this.instance.rootDocument,Re=le.createElement("div"),De=le.createElement("span");Re.className="relative",De.className="colHeader",this.updateCellHeader(De,l,this.instance.getColHeader),Re.appendChild(De),K.appendChild(Re)}this.instance.runHooks("afterGetColHeader",l,K)}},{key:"updateCellHeader",value:function(l,K,ne){var le=K,Re=this.wt.wtOverlays.getParentOverlay(l)||this.wt;l.parentNode&&(Object(M.hasClass)(l,"colHeader")?le=Re.wtTable.columnFilter.sourceToRendered(K):Object(M.hasClass)(l,"rowHeader")&&(le=Re.wtTable.rowFilter.sourceToRendered(K))),le>-1?Object(M.fastInnerHTML)(l,ne(K)):(Object(M.fastInnerText)(l,String.fromCharCode(160)),Object(M.addClass)(l,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(l){var K=this.wt.wtViewport.getWorkspaceWidth()-l;return K>0?K:0}},{key:"maximumVisibleElementHeight",value:function(l){var K=this.wt.wtViewport.getWorkspaceHeight()-l;return K>0?K:0}},{key:"setLastSize",value:function(l,K){var ne=$.get(this),le=[l,K];ne.lastWidth=le[0],ne.lastHeight=le[1]}},{key:"getLastSize",value:function(){var l=$.get(this);return{width:l.lastWidth,height:l.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}])&&x(se.prototype,I),de&&x(se,de),H}();S.a=fe},function(ot,S,i){"use strict";var M=i(159),C=i(202),pe=i(160),ie=i(171),X=i(188);function F(G,B){if(!(G instanceof B))throw new TypeError("Cannot call a class as a function")}function ee(G,B){for(var V=0;V<B.length;V++){var P=B[V];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(G,P.key,P)}}var ce=function(){function G(x){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];F(this,G),this.hot=x,this.data=$,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var B,V,P;return B=G,(V=[{key:"modifyRowData",value:function(x){var $;return this.hot.hasHook("modifyRowData")&&($=this.hot.runHooks("modifyRowData",x)),$===void 0||Number.isInteger($)?this.data[x]:$}},{key:"getData",value:function(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this.data&&this.data.length!==0?this.getByRange(null,null,x):this.data}},{key:"setData",value:function(x){this.data=x}},{key:"getAtColumn",value:function(x){var $=this,fe=[];return Object(pe.arrayEach)(this.data,function(H,se){var I=$.getAtCell(se,x);fe.push(I)}),fe}},{key:"getAtRow",value:function(x,$,fe){var H=this,se=arguments.length>3&&arguments[3]!==void 0&&arguments[3],I=$===void 0&&fe===void 0,de=null,l=null;if(de=this.modifyRowData(x),Array.isArray(de))l=[],I?de.forEach(function(le,Re){l[Re]=H.getAtPhysicalCell(x,Re,de)}):Object(ie.rangeEach)($,fe,function(le){l[le-$]=H.getAtPhysicalCell(x,le,de)});else if(Object(M.isObject)(de)||Object(X.isFunction)(de))if(l=se?[]:{},!I||se){var K=0,ne=this.countFirstRowKeys()-1;Object(ie.rangeEach)(K,ne,function(le){var Re=H.colToProp(le);if(le>=($||K)&&le<=(fe||ne)&&!Number.isInteger(Re)){var De=H.getAtPhysicalCell(x,Re,de);se?l.push(De):Object(M.setProperty)(l,Re,De)}})}else Object(M.objectEach)(de,function(le,Re){Object(M.setProperty)(l,Re,H.getAtPhysicalCell(x,Re,de))});return l}},{key:"setAtCell",value:function(x,$,fe){if(!(x>=this.countRows()||$>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var H=Object(M.createObjectPropListener)(fe);this.hot.runHooks("modifySourceData",x,this.propToCol($),H,"set"),H.isTouched()&&(fe=H.value)}Number.isInteger($)?this.data[x][$]=fe:Object(M.setProperty)(this.data[x],$,fe)}}},{key:"getAtPhysicalCell",value:function(x,$,fe){var H=null;if(fe&&(H=typeof $=="string"?Object(M.getProperty)(fe,$):typeof $=="function"?$(fe):fe[$]),this.hot.hasHook("modifySourceData")){var se=Object(M.createObjectPropListener)(H);this.hot.runHooks("modifySourceData",x,this.colToProp($),se,"get"),se.isTouched()&&(H=se.value)}return H}},{key:"getAtCell",value:function(x,$){var fe=this.modifyRowData(x);return this.getAtPhysicalCell(x,this.colToProp($),fe)}},{key:"getByRange",value:function(){var x=this,$=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,H=arguments.length>2&&arguments[2]!==void 0&&arguments[2],se=!1,I=null,de=null,l=null,K=null;$===null||fe===null?(se=!0,I=0,l=this.countRows()-1):(I=Math.min($.row,fe.row),de=Math.min($.col,fe.col),l=Math.max($.row,fe.row),K=Math.max($.col,fe.col));var ne=[];return Object(ie.rangeEach)(I,l,function(le){ne.push(se?x.getAtRow(le,void 0,void 0,H):x.getAtRow(le,de,K,H))}),ne}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var x=this.hot.runHooks("modifySourceLength");if(Number.isInteger(x))return x}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Object(C.countFirstRowKeys)(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}])&&ee(B.prototype,V),P&&ee(B,P),G}();S.a=ce},function(ot,S,i){"use strict";i.d(S,"a",function(){return C});var M=i(165);function C(pe,ie){var X=new M.b(ie),F=pe.getCellMeta(ie.row,ie.col);if(F.rowspan||F.colspan){var ee=F.rowspan||1,ce=F.colspan||1;X.to=new M.a(ie.row+ee-1,ie.col+ce-1)}return X}},function(ot,S,i){"use strict";function M(C){var pe=typeof window!="undefined"&&window.jQuery;pe&&(pe.fn.handsontable=function(ie){var X,F=this.first(),ee=F.data("handsontable");if(typeof ie!="string"){var ce=ie||{};return ee?ee.updateSettings(ce):(ee=new C.Core(F[0],ce),F.data("handsontable",ee),ee.init()),F}if(ee){if(ee[ie]===void 0)throw new Error("Handsontable do not provide action: ".concat(ie));for(var G,B=arguments.length,V=new Array(B>1?B-1:0),P=1;P<B;P++)V[P-1]=arguments[P];X=(G=ee[ie]).call.apply(G,[ee].concat(V)),ie==="destroy"&&F.removeData()}return X})}i.d(S,"a",function(){return M})},function(ot,S,i){"use strict";function M(C){var pe=new Date(C);return isNaN(new Date("".concat(C,"T00:00")).getDate())?pe:new Date(pe.getTime()+6e4*pe.getTimezoneOffset())}i.r(S),i.d(S,"getNormalizedDate",function(){return M})},,function(ot,S,i){"use strict";i.r(S),i.d(S,"AutoColumnSize",function(){return we}),i.d(S,"AutoRowSize",function(){return be}),i.d(S,"Base",function(){return ee}),i.d(S,"CopyPaste",function(){return Y}),i.d(S,"CustomBorders",function(){return gn}),i.d(S,"MergeCells",function(){return sn}),i.d(S,"TouchScroll",function(){return tn});var M=i(159),C=i(160),pe=i(174);function ie(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}var X=new WeakMap,F=null,ee=function(){function N(m){var L=this;(function(f,g){if(!(f instanceof g))throw new TypeError("Cannot call a class as a function")})(this,N),Object(M.defineGetter)(this,"hot",m,{writable:!1}),X.set(this,{hooks:{}}),F=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return L.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(f){return L.onUpdateSettings(f)}),this.hot.addHook("beforeInit",function(){return L.init()})}var T,b,w;return T=N,(b=[{key:"init",value:function(){this.pluginName=Object(pe.b)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),F||(F=Object(pe.c)(this.hot)),F.indexOf(this.pluginName)>=0&&F.splice(F.indexOf(this.pluginName),1),F.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(m,L){X.get(this).hooks[m]=X.get(this).hooks[m]||[];var f=X.get(this).hooks[m];this.hot.addHook(m,L),f.push(L),X.get(this).hooks[m]=f}},{key:"removeHooks",value:function(m){var L=this;Object(C.arrayEach)(X.get(this).hooks[m]||[],function(f){L.hot.removeHook(m,f)})}},{key:"clearHooks",value:function(){var m=this,L=X.get(this).hooks;Object(M.objectEach)(L,function(f,g){return m.removeHooks(g)}),L.length=0}},{key:"callOnPluginsReady",value:function(m){this.isPluginsReady?m():this.pluginsInitializedCallbacks.push(m)}},{key:"onAfterPluginsInitialized",value:function(){Object(C.arrayEach)(this.pluginsInitializedCallbacks,function(m){return m()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var m=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(M.objectEach)(this,function(L,f){f!=="hot"&&(m[f]=null)}),delete this.t,delete this.hot}}])&&ie(T.prototype,b),w&&ie(T,w),N}(),ce=i(182),G=i(220),B=i(171),V=i(167);function P(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}function x(N,T,b){return T&&P(N.prototype,T),b&&P(N,b),N}var $=function(){function N(T){(function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")})(this,N),this.samples=null,this.dataFactory=T,this.customSampleCount=null,this.allowDuplicates=!1}return x(N,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),x(N,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:N.SAMPLE_COUNT}},{key:"setSampleCount",value:function(T){this.customSampleCount=T}},{key:"setAllowDuplicates",value:function(T){this.allowDuplicates=T}},{key:"generateRowSamples",value:function(T,b){return this.generateSamples("row",b,T)}},{key:"generateColumnSamples",value:function(T,b){return this.generateSamples("col",b,T)}},{key:"generateSamples",value:function(T,b,w){var m=this,L=new Map,f=typeof w=="number"?{from:w,to:w}:w,g=f.from,E=f.to;return Object(B.rangeEach)(g,E,function(D){var z=m.generateSample(T,b,D);L.set(D,z)}),L}},{key:"generateSample",value:function(T,b,w){var m=this;if(T!=="row"&&T!=="col")throw new Error("Unsupported sample type");var L=new Map,f=T==="row"?"col":"row",g=[];return Object(B.rangeEach)(b.from,b.to,function(E){var D,z=T==="row"?m.dataFactory(w,E):m.dataFactory(E,w),te=z.value,ge=z.bundleCountSeed,Ne=ge>0;D=Object(M.isObject)(te)?Object.keys(te).length:Array.isArray(te)?te.length:Object(V.stringify)(te).length,Ne&&(D+=ge),L.has(D)||L.set(D,{needed:m.getSampleCount(),strings:[]});var et=L.get(D);et.needed&&(!(g.indexOf(te)>-1)||m.allowDuplicates||Ne)&&(et.strings.push(function(pt,gt,wt){return gt in pt?Object.defineProperty(pt,gt,{value:wt,enumerable:!0,configurable:!0,writable:!0}):pt[gt]=wt,pt}({value:te},f,E)),g.push(te),et.needed-=1)}),L}}]),N}(),fe=i(176),H=i(165),se=i(222);function I(N){return(I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T})(N)}function de(N,T){return function(b){if(Array.isArray(b))return b}(N)||function(b,w){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var m=[],L=!0,f=!1,g=void 0;try{for(var E,D=b[Symbol.iterator]();!(L=(E=D.next()).done)&&(m.push(E.value),!w||m.length!==w);L=!0);}catch(z){f=!0,g=z}finally{try{L||D.return==null||D.return()}finally{if(f)throw g}}return m}}(N,T)||function(b,w){if(!!b){if(typeof b=="string")return l(b,w);var m=Object.prototype.toString.call(b).slice(8,-1);if(m==="Object"&&b.constructor&&(m=b.constructor.name),m==="Map"||m==="Set")return Array.from(b);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return l(b,w)}}(N,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function l(N,T){(T==null||T>N.length)&&(T=N.length);for(var b=0,w=new Array(T);b<T;b++)w[b]=N[b];return w}function K(N,T,b){return(K=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(w,m,L){var f=function(E,D){for(;!Object.prototype.hasOwnProperty.call(E,D)&&(E=Se(E))!==null;);return E}(w,m);if(f){var g=Object.getOwnPropertyDescriptor(f,m);return g.get?g.get.call(L):g.value}})(N,T,b||N)}function ne(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}function le(N,T,b){return T&&ne(N.prototype,T),b&&ne(N,b),N}function Re(N,T){return(Re=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(N,T)}function De(N){var T=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}();return function(){var b,w=Se(N);if(T){var m=Se(this).constructor;b=Reflect.construct(w,arguments,m)}else b=w.apply(this,arguments);return He(this,b)}}function He(N,T){return!T||I(T)!=="object"&&typeof T!="function"?me(N):T}function me(N){if(N===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N}function Se(N){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(T){return T.__proto__||Object.getPrototypeOf(T)})(N)}var Ie=new WeakMap,Le=function(N){(function(w,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(m&&m.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),m&&Re(w,m)})(b,N);var T=De(b);function b(w){var m;return function(L,f){if(!(L instanceof f))throw new TypeError("Cannot call a class as a function")}(this,b),m=T.call(this,w),Ie.set(me(m),{cachedColumnHeaders:[]}),m.ghostTable=new G.a(m.hot),m.samplesGenerator=new $(function(L,f){var g=m.hot.getCellMeta(L,f),E="";g.spanned||(E=m.hot.getDataAtCell(L,f));var D=0;if(g.label){var z=g.label,te=z.value,ge=z.property,Ne="";if(te)Ne=typeof te=="function"?te(L,f,m.hot.colToProp(f),E):te;else if(ge){var et=m.hot.getDataAtRowProp(L,ge);Ne=et!==null?et:""}D=Ne.length}return{value:E,bundleCountSeed:D}}),m.firstCalculation=!0,m.inProgress=!1,m.measuredColumns=0,m.columnWidthsMap=new se.b,m.addHook("beforeColumnResize",function(L,f,g){return m.onBeforeColumnResize(L,f,g)}),m.hot.columnIndexMapper.registerMap("autoColumnSize",m.columnWidthsMap),m}return le(b,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),le(b,[{key:"isEnabled",value:function(){return this.hot.getSettings().autoColumnSize!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var w=this;if(!this.enabled){var m=this.hot.getSettings().autoColumnSize;m&&m.useHeaders!==null&&m.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",m.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return w.onAfterLoadData()}),this.addHook("beforeChange",function(L){return w.onBeforeChange(L)}),this.addHook("beforeRender",function(L){return w.onBeforeRender(L)}),this.addHook("modifyColWidth",function(L,f){return w.getColumnWidth(f,L)}),this.addHook("afterInit",function(){return w.onAfterInit()}),K(Se(b.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var w=this.findColumnsWhereHeaderWasChanged();w.length&&this.clearCache(w),K(Se(b.prototype),"updatePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var w=this,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},f=arguments.length>2&&arguments[2]!==void 0&&arguments[2],g=typeof m=="number"?{from:m,to:m}:m,E=typeof L=="number"?{from:L,to:L}:L;Object(B.rangeEach)(g.from,g.to,function(D){var z=w.hot.toPhysicalColumn(D);if(z===null&&(z=D),f||w.columnWidthsMap.getValueAtIndex(z)===null&&!w.hot._getColWidthFromSettings(z)){var te=w.samplesGenerator.generateColumnSamples(D,E);Object(C.arrayEach)(te,function(ge){var Ne=de(ge,2),et=Ne[0],pt=Ne[1];return w.ghostTable.addColumn(et,pt)})}}),this.ghostTable.columns.length&&(this.hot.executeBatchOperations(function(){w.ghostTable.getWidths(function(D,z){var te=w.hot.toPhysicalColumn(D);w.columnWidthsMap.setValueAtIndex(te,z)})}),this.measuredColumns=g.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var w=this,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},L=0,f=this.hot.countCols()-1,g=null;this.inProgress=!0;var E=function z(){if(!w.hot)return Object(ce.cancelAnimationFrame)(g),void(w.inProgress=!1);w.calculateColumnsWidth({from:L,to:Math.min(L+b.CALCULATION_STEP,f)},m),(L=L+b.CALCULATION_STEP+1)<f?g=Object(ce.requestAnimationFrame)(z):(Object(ce.cancelAnimationFrame)(g),w.inProgress=!1,w.hot.view.wt.wtOverlays.adjustElementsSizes())},D=this.getSyncCalculationLimit();this.firstCalculation&&D>=0&&(this.calculateColumnsWidth({from:0,to:D},m),this.firstCalculation=!1,L=D+1),L<f?E():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var w=this.hot.getSettings().autoColumnSize,m=w&&Object(M.hasOwnProperty)(w,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,L=w&&Object(M.hasOwnProperty)(w,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;m&&!isNaN(m)&&this.samplesGenerator.setSampleCount(parseInt(m,10)),L&&this.samplesGenerator.setAllowDuplicates(L)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var w=b.SYNC_CALCULATION_LIMIT,m=this.hot.countCols()-1;return Object(M.isObject)(this.hot.getSettings().autoColumnSize)&&(w=this.hot.getSettings().autoColumnSize.syncLimit,Object(fe.isPercentValue)(w)?w=Object(B.valueAccordingPercent)(m,w):w>>=0),Math.min(w,m)}},{key:"getColumnWidth",value:function(w){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,L=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],f=m;return f===void 0&&(f=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(w)),L&&typeof f=="number"&&(f=Math.max(f,H.d.DEFAULT_WIDTH))),f}},{key:"getFirstVisibleColumn",value:function(){var w=this.hot.view.wt;if(w.wtViewport.columnsVisibleCalculator){var m=w.wtTable.getFirstVisibleColumn();if(m!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(m)}if(w.wtViewport.columnsRenderCalculator){var L=w.wtTable.getFirstRenderedColumn();if(L!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(L)}return-1}},{key:"getLastVisibleColumn",value:function(){var w=this.hot.view.wt;if(w.wtViewport.columnsVisibleCalculator){var m=w.wtTable.getLastVisibleColumn();if(m!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(m)}if(w.wtViewport.columnsRenderCalculator){var L=w.wtTable.getLastRenderedColumn();if(L!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(L)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var w=this.hot.getColHeader(),m=Ie.get(this).cachedColumnHeaders;return Object(C.arrayReduce)(w,function(L,f,g){var E=m.length;return(E-1<g||m[g]!==f)&&L.push(g),E-1<g?m.push(f):m[g]=f,L},[])}},{key:"clearCache",value:function(){var w=this,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];m.length?this.hot.executeBatchOperations(function(){Object(C.arrayEach)(m,function(L){w.columnWidthsMap.setValueAtIndex(L,null)})}):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Object(C.arrayFilter)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(w){return w===null}).length}},{key:"onBeforeRender",value:function(){var w=this.hot.renderCall,m=this.hot.countRows(),L=this.getFirstVisibleColumn(),f=this.getLastVisibleColumn();L!==-1&&f!==-1&&m&&(this.calculateColumnsWidth({from:L,to:f},void 0,w),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var w=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){w.hot&&w.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(w){var m=this,L=Object(C.arrayMap)(w,function(f){var g=de(f,2)[1];return m.hot.toPhysicalColumn(m.hot.propToCol(g))});this.clearCache(Array.from(new Set(L)))}},{key:"onBeforeColumnResize",value:function(w,m,L){var f=w;return L&&(this.calculateColumnsWidth(m,void 0,!0),f=this.getColumnWidth(m,void 0,!1)),f}},{key:"onAfterInit",value:function(){Ie.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"disablePlugin",value:function(){K(Se(b.prototype),"disablePlugin",this).call(this)}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap("autoColumnSize"),this.ghostTable.clean(),K(Se(b.prototype),"destroy",this).call(this)}}]),b}(ee);Object(pe.d)("autoColumnSize",Le);var we=Le,Ve=i(161);function je(N){return(je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T})(N)}function Ke(N,T){return function(b){if(Array.isArray(b))return b}(N)||function(b,w){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var m=[],L=!0,f=!1,g=void 0;try{for(var E,D=b[Symbol.iterator]();!(L=(E=D.next()).done)&&(m.push(E.value),!w||m.length!==w);L=!0);}catch(z){f=!0,g=z}finally{try{L||D.return==null||D.return()}finally{if(f)throw g}}return m}}(N,T)||function(b,w){if(!!b){if(typeof b=="string")return $e(b,w);var m=Object.prototype.toString.call(b).slice(8,-1);if(m==="Object"&&b.constructor&&(m=b.constructor.name),m==="Map"||m==="Set")return Array.from(b);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return $e(b,w)}}(N,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function $e(N,T){(T==null||T>N.length)&&(T=N.length);for(var b=0,w=new Array(T);b<T;b++)w[b]=N[b];return w}function Ye(N,T,b){return(Ye=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(w,m,L){var f=function(E,D){for(;!Object.prototype.hasOwnProperty.call(E,D)&&(E=at(E))!==null;);return E}(w,m);if(f){var g=Object.getOwnPropertyDescriptor(f,m);return g.get?g.get.call(L):g.value}})(N,T,b||N)}function ht(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}function Qe(N,T,b){return T&&ht(N.prototype,T),b&&ht(N,b),N}function ct(N,T){return(ct=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(N,T)}function We(N){var T=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}();return function(){var b,w=at(N);if(T){var m=at(this).constructor;b=Reflect.construct(w,arguments,m)}else b=w.apply(this,arguments);return Ze(this,b)}}function Ze(N,T){return!T||je(T)!=="object"&&typeof T!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(N):T}function at(N){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(T){return T.__proto__||Object.getPrototypeOf(T)})(N)}var ut=function(N){(function(w,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(m&&m.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),m&&ct(w,m)})(b,N);var T=We(b);function b(w){var m;return function(L,f){if(!(L instanceof f))throw new TypeError("Cannot call a class as a function")}(this,b),(m=T.call(this,w)).rowHeightsMap=void 0,m.headerHeight=null,m.ghostTable=new G.a(m.hot),m.samplesGenerator=new $(function(L,f){var g;return L>=0?g=m.hot.getDataAtCell(L,f):L===-1&&(g=m.hot.getColHeader(f)),{value:g}}),m.firstCalculation=!0,m.inProgress=!1,m.measuredRows=0,m.addHook("beforeRowResize",function(L,f,g){return m.onBeforeRowResize(L,f,g)}),m.rowHeightsMap=new se.b,m.hot.rowIndexMapper.registerMap("autoRowSize",m.rowHeightsMap),m}return Qe(b,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),Qe(b,[{key:"isEnabled",value:function(){return this.hot.getSettings().autoRowSize===!0||Object(M.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var w=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return w.onAfterLoadData()}),this.addHook("beforeChange",function(m){return w.onBeforeChange(m)}),this.addHook("beforeColumnResize",function(){return w.recalculateAllRowsHeight()}),this.addHook("beforeRender",function(m){return w.onBeforeRender(m)}),this.addHook("modifyRowHeight",function(m,L){return w.getRowHeight(L,m)}),this.addHook("modifyColumnHeaderHeight",function(){return w.getColumnHeaderHeight()}),Ye(at(b.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.headerHeight=null,Ye(at(b.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var w=this,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},f=arguments.length>2&&arguments[2]!==void 0&&arguments[2],g=typeof m=="number"?{from:m,to:m}:m,E=typeof L=="number"?{from:L,to:L}:L;if(this.hot.getColHeader(0)!==null){var D=this.samplesGenerator.generateRowSamples(-1,E);this.ghostTable.addColumnHeadersRow(D.get(-1))}Object(B.rangeEach)(g.from,g.to,function(z){if(f||w.rowHeightsMap.getValueAtIndex(z)===null){var te=w.samplesGenerator.generateRowSamples(z,E);Object(C.arrayEach)(te,function(ge){var Ne=Ke(ge,2),et=Ne[0],pt=Ne[1];return w.ghostTable.addRow(et,pt)})}}),this.ghostTable.rows.length&&(this.hot.executeBatchOperations(function(){w.ghostTable.getHeights(function(z,te){z<0?w.headerHeight=te:w.rowHeightsMap.setValueAtIndex(w.hot.toPhysicalRow(z),te)})}),this.measuredRows=g.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var w=this,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},L=0,f=this.hot.countRows()-1,g=null;this.inProgress=!0;var E=function z(){if(!w.hot)return Object(ce.cancelAnimationFrame)(g),void(w.inProgress=!1);w.calculateRowsHeight({from:L,to:Math.min(L+b.CALCULATION_STEP,f)},m),(L=L+b.CALCULATION_STEP+1)<f?g=Object(ce.requestAnimationFrame)(z):(Object(ce.cancelAnimationFrame)(g),w.inProgress=!1,w.hot.view.wt.wtOverlays.adjustElementsSizes(!0),w.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&w.hot.view.wt.wtOverlays.leftOverlay.clone.drawClone())},D=this.getSyncCalculationLimit();this.firstCalculation&&D>=0&&(this.calculateRowsHeight({from:0,to:D},m),this.firstCalculation=!1,L=D+1),L<f?E():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSizes(!1))}},{key:"setSamplingOptions",value:function(){var w=this.hot.getSettings().autoRowSize,m=w&&Object(M.hasOwnProperty)(w,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,L=w&&Object(M.hasOwnProperty)(w,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;m&&!isNaN(m)&&this.samplesGenerator.setSampleCount(parseInt(m,10)),L&&this.samplesGenerator.setAllowDuplicates(L)}},{key:"recalculateAllRowsHeight",value:function(){Object(Ve.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var w=b.SYNC_CALCULATION_LIMIT,m=this.hot.countRows()-1;return Object(M.isObject)(this.hot.getSettings().autoRowSize)&&(w=this.hot.getSettings().autoRowSize.syncLimit,Object(fe.isPercentValue)(w)?w=Object(B.valueAccordingPercent)(m,w):w>>=0),Math.min(w,m)}},{key:"getRowHeight",value:function(w){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,L=w<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(w)),f=m;return L!==null&&L>(m||0)&&(f=L),f}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var w=this.hot.view.wt;return w.wtViewport.rowsVisibleCalculator?w.wtTable.getFirstVisibleRow():w.wtViewport.rowsRenderCalculator?w.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var w=this.hot.view.wt;return w.wtViewport.rowsVisibleCalculator?w.wtTable.getLastVisibleRow():w.wtViewport.rowsRenderCalculator?w.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(w){var m=this,L=typeof w=="number"?{from:w,to:w}:w,f=L.from,g=L.to;this.hot.executeBatchOperations(function(){Object(B.rangeEach)(Math.min(f,g),Math.max(f,g),function(E){m.rowHeightsMap.setValueAtIndex(E,null)})})}},{key:"isNeedRecalculate",value:function(){return!!Object(C.arrayFilter)(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(w){return w===null}).length}},{key:"onBeforeRender",value:function(){var w=this.hot.renderCall,m=this.hot.getSettings().fixedRowsBottom,L=this.getFirstVisibleRow(),f=this.getLastVisibleRow();if(L!==-1&&f!==-1){if(this.calculateRowsHeight({from:L,to:f},void 0,w),m){var g=this.hot.countRows()-1;this.calculateRowsHeight({from:g-m,to:g})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(w,m){this.clearCacheByRange({from:w,to:m}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(w,m,L){var f=w;return L&&(this.calculateRowsHeight(m,void 0,!0),f=this.getRowHeight(m)),f}},{key:"onAfterLoadData",value:function(){var w=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){w.hot&&w.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(w){var m=null;w.length===1?m=w[0][0]:w.length>1&&(m={from:w[0][0],to:w[w.length-1][0]}),m!==null&&this.clearCacheByRange(m)}},{key:"destroy",value:function(){this.hot.rowIndexMapper.unregisterMap("autoRowSize"),this.ghostTable.clean(),Ye(at(b.prototype),"destroy",this).call(this)}}]),b}(ee);Object(pe.d)("autoRowSize",ut);var be=ut,Z=i(186),he=i(248),O=i.n(he),re=i(172);function Oe(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}var Ee=function(){function N(){(function(m,L){if(!(m instanceof L))throw new TypeError("Cannot call a class as a function")})(this,N),this.data={}}var T,b,w;return T=N,(b=[{key:"setData",value:function(m,L){this.data[m]=L}},{key:"getData",value:function(m){return this.data[m]||void 0}}])&&Oe(T.prototype,b),w&&Oe(T,w),N}(),ve=function N(){(function(T,b){if(!(T instanceof b))throw new TypeError("Cannot call a class as a function")})(this,N),this.clipboardData=new Ee},Ge=i(170),Je=i(189),ft=i(173);function tt(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}var yt=function(){function N(m){(function(L,f){if(!(L instanceof f))throw new TypeError("Cannot call a class as a function")})(this,N),this.rootDocument=m.defaultView?m:m.ownerDocument,this.mainElement=null,this.eventManager=new Ge.a(this),this.listenersCount=new WeakSet,this.container=m}var T,b,w;return T=N,(b=[{key:"useSecondaryElement",value:function(){var m=function(L){var f=Gt.get(L);if(f)return f.parentElement||L.appendChild(f),f;var g=(L.defaultView?L:L.ownerDocument).createElement("textarea");return Gt.set(L,g),g.setAttribute("data-hot-input",""),g.className="HandsontableCopyPaste",g.tabIndex=-1,g.autocomplete="off",g.wrap="hard",g.value=" ",L.appendChild(g),g}(this.container);this.listenersCount.has(m)||(this.listenersCount.add(m),Jt(this.eventManager,m,this)),this.mainElement=m}},{key:"setFocusableElement",value:function(m){this.listenersCount.has(m)||(this.listenersCount.add(m),Jt(this.eventManager,m,this)),this.mainElement=m}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Object(ft.isMobileBrowser)()||Object(Ve.selectElementIfAllowed)(this.mainElement)}}])&&tt(T.prototype,b),w&&tt(T,w),N}();Object(M.mixin)(yt,Je.a);var bt=new WeakMap,Ot=function(N,T){return function(b){return T.runLocalHooks(N,b)}};function Jt(N,T,b){N.addEventListener(T,"copy",Ot("copy",b)),N.addEventListener(T,"cut",Ot("cut",b)),N.addEventListener(T,"paste",Ot("paste",b))}var Gt=new WeakMap;function Qt(N){if(N instanceof yt){var T=bt.get(N.container);if((T=isNaN(T)?0:T)>0&&(T-=1),function(w){w.eventManager.clear()}(N),T<=0){T=0;var b=Gt.get(N.container);b&&b.parentNode&&(b.parentNode.removeChild(b),Gt.delete(N.container)),N.mainElement=null}bt.set(N.container,T)}}var rn=i(217);function an(N,T){return function(b){if(Array.isArray(b))return b}(N)||function(b,w){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var m=[],L=!0,f=!1,g=void 0;try{for(var E,D=b[Symbol.iterator]();!(L=(E=D.next()).done)&&(m.push(E.value),!w||m.length!==w);L=!0);}catch(z){f=!0,g=z}finally{try{L||D.return==null||D.return()}finally{if(f)throw g}}return m}}(N,T)||function(b,w){if(!!b){if(typeof b=="string")return mn(b,w);var m=Object.prototype.toString.call(b).slice(8,-1);if(m==="Object"&&b.constructor&&(m=b.constructor.name),m==="Map"||m==="Set")return Array.from(b);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return mn(b,w)}}(N,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function mn(N,T){(T==null||T>N.length)&&(T=N.length);for(var b=0,w=new Array(T);b<T;b++)w[b]=N[b];return w}function W(N){return(W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T})(N)}function R(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}function U(N,T,b){return(U=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(w,m,L){var f=function(E,D){for(;!Object.prototype.hasOwnProperty.call(E,D)&&(E=j(E))!==null;);return E}(w,m);if(f){var g=Object.getOwnPropertyDescriptor(f,m);return g.get?g.get.call(L):g.value}})(N,T,b||N)}function s(N,T){return(s=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(N,T)}function u(N){var T=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}();return function(){var b,w=j(N);if(T){var m=j(this).constructor;b=Reflect.construct(w,arguments,m)}else b=w.apply(this,arguments);return v(this,b)}}function v(N,T){return!T||W(T)!=="object"&&typeof T!="function"?k(N):T}function k(N){if(N===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N}function j(N){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(T){return T.__proto__||Object.getPrototypeOf(T)})(N)}Z.a.getSingleton().register("afterCopyLimit"),Z.a.getSingleton().register("modifyCopyableRange"),Z.a.getSingleton().register("beforeCut"),Z.a.getSingleton().register("afterCut"),Z.a.getSingleton().register("beforePaste"),Z.a.getSingleton().register("afterPaste"),Z.a.getSingleton().register("beforeCopy"),Z.a.getSingleton().register("afterCopy");var q=new WeakMap,y=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),_=function(N){(function(f,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(g&&g.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),g&&s(f,g)})(L,N);var T,b,w,m=u(L);function L(f){var g;return function(E,D){if(!(E instanceof D))throw new TypeError("Cannot call a class as a function")}(this,L),(g=m.call(this,f)).columnsLimit=1e3,g.copyableRanges=[],g.focusableElement=void 0,g.pasteMode="overwrite",g.rowsLimit=1e3,g.uiContainer=g.hot.rootDocument.body,q.set(k(g),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),g}return T=L,(b=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var f=this;if(!this.enabled){var g,E,D,z=this.hot.getSettings(),te=z.copyPaste,ge=z.fragmentSelection;q.get(this).isFragmentSelectionEnabled=!!ge,W(te)==="object"&&(this.pasteMode=te.pasteMode||this.pasteMode,this.rowsLimit=isNaN(te.rowsLimit)?this.rowsLimit:te.rowsLimit,this.columnsLimit=isNaN(te.columnsLimit)?this.columnsLimit:te.columnsLimit,this.uiContainer=te.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",function(Ne){return f.onAfterContextMenuDefaultOptions(Ne)}),this.addHook("afterOnCellMouseUp",function(){return f.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return f.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return f.onBeforeKeyDown()}),this.focusableElement=(g=this.uiContainer,E=new yt(g),D=bt.get(g),D=isNaN(D)?0:D,bt.set(g,D+1),E),this.focusableElement.addLocalHook("copy",function(Ne){return f.onCopy(Ne)}).addLocalHook("cut",function(Ne){return f.onCut(Ne)}).addLocalHook("paste",function(Ne){return f.onPaste(Ne)}),U(j(L.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),U(j(L.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&Qt(this.focusableElement),U(j(L.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){q.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){q.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(f){var g=this,E=[],D=[],z=[];return Object(C.arrayEach)(f,function(te){Object(B.rangeEach)(te.startRow,te.endRow,function(ge){D.indexOf(ge)===-1&&D.push(ge)}),Object(B.rangeEach)(te.startCol,te.endCol,function(ge){z.indexOf(ge)===-1&&z.push(ge)})}),Object(C.arrayEach)(D,function(te){var ge=[];Object(C.arrayEach)(z,function(Ne){ge.push(g.hot.getCopyableData(te,Ne))}),E.push(ge)}),O.a.stringify(E)}},{key:"getRangedData",value:function(f){var g=this,E=[],D=[],z=[];return Object(C.arrayEach)(f,function(te){Object(B.rangeEach)(te.startRow,te.endRow,function(ge){D.indexOf(ge)===-1&&D.push(ge)}),Object(B.rangeEach)(te.startCol,te.endCol,function(ge){z.indexOf(ge)===-1&&z.push(ge)})}),Object(C.arrayEach)(D,function(te){var ge=[];Object(C.arrayEach)(z,function(Ne){ge.push(g.hot.getCopyableData(te,Ne))}),E.push(ge)}),E}},{key:"paste",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f;if(f||g){var E=new ve;f&&E.clipboardData.setData("text/plain",f),g&&E.clipboardData.setData("text/html",g),this.getOrCreateFocusableElement(),this.onPaste(E)}}},{key:"setCopyableText",value:function(){var f=this.hot.getSelectedRangeLast();if(f){var g=f.getTopLeftCorner(),E=f.getBottomRightCorner(),D=g.row,z=g.col,te=E.row,ge=E.col,Ne=Math.min(te,D+this.rowsLimit-1),et=Math.min(ge,z+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:D,startCol:z,endRow:Ne,endCol:et}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),te===Ne&&ge===et||this.hot.runHooks("afterCopyLimit",te-D+1,ge-z+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var f=this.hot.getActiveEditor(),g=f?f.TEXTAREA:void 0;g?this.focusableElement.setFocusableElement(g):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var f=this.hot.getActiveEditor();return f&&f.isOpened()}},{key:"populateValues",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedLast();if(f.length){for(var E=f.length-1,D=f[0].length-1,z=Math.min(g[0],g[2]),te=Math.max(g[0],g[2],E+z),ge=Math.min(g[1],g[3]),Ne=Math.max(g[1],g[3],D+ge),et=[],pt=z,gt=0;pt<=te;pt+=1){for(var wt=[],Rt=ge,zt=0;Rt<=Ne;Rt+=1)wt.push(f[gt][zt]),zt=zt===D?0:zt+=1;et.push(wt),gt=gt===E?0:gt+=1}return this.hot.populateFromArray(z,ge,et,void 0,void 0,"CopyPaste.paste",this.pasteMode),[z,ge,te,Ne]}}},{key:"onCopy",value:function(f){var g=q.get(this);if((this.hot.isListening()||g.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),g.isTriggeredByCopy=!1;var E=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",E,this.copyableRanges)){var D=O.a.stringify(E);if(f&&f.clipboardData){var z=Object(rn._dataToHTML)(E,this.hot.rootDocument);f.clipboardData.setData("text/plain",D),f.clipboardData.setData("text/html",[y,z].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",D);this.hot.runHooks("afterCopy",E,this.copyableRanges)}f.preventDefault()}}},{key:"onCut",value:function(f){var g=q.get(this);if((this.hot.isListening()||g.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),g.isTriggeredByCut=!1;var E=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",E,this.copyableRanges)){var D=O.a.stringify(E);if(f&&f.clipboardData){var z=Object(rn._dataToHTML)(E,this.hot.rootDocument);f.clipboardData.setData("text/plain",D),f.clipboardData.setData("text/html",[y,z].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",D);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",E,this.copyableRanges)}f.preventDefault()}}},{key:"onPaste",value:function(f){if(this.hot.isListening()&&!this.isEditorOpened()){var g;if(f&&f.preventDefault&&f.preventDefault(),f&&f.clipboardData!==void 0){var E=f.clipboardData.getData("text/html");g=E&&/(<table)|(<TABLE)/g.test(E)?Object(rn.htmlToGridSettings)(E,this.hot.rootDocument).data:f.clipboardData.getData("text/plain")}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData!==void 0&&(g=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof g=="string"&&(g=O.a.parse(g)),(!g||g.length!==0)&&this.hot.runHooks("beforePaste",g,this.copyableRanges)!==!1){var D=an(this.populateValues(g),4),z=D[0],te=D[1],ge=D[2],Ne=D[3];this.hot.selectCell(z,te,Math.min(this.hot.countRows()-1,ge),Math.min(this.hot.countCols()-1,Ne)),this.hot.runHooks("afterPaste",g,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(f){var g;f.items.push({name:"---------"},(g=this,{key:"copy",name:function(){return this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_COPY)},callback:function(){g.copy()},disabled:function(){var E=this.getSelected();return!E||E.length>1},hidden:!1}),function(E){return{key:"cut",name:function(){return this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_CUT)},callback:function(){E.cut()},disabled:function(){var D=this.getSelected();return!D||D.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){this.hot.isListening()&&!this.isEditorOpened()&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var f=q.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),f&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(Ve.getSelectionText)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var f=this.hot.rootDocument.activeElement,g=this.hot.getActiveEditor();!g||f!==this.focusableElement.getFocusableElement()&&f!==g.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(Qt(this.focusableElement),this.focusableElement=null),U(j(L.prototype),"destroy",this).call(this)}}])&&R(T.prototype,b),w&&R(T,w),L}(ee);Object(pe.d)("CopyPaste",_);var Y=_;function ue(N,T){return"border_row".concat(N,"col").concat(T)}function Te(N,T){return{id:ue(N,T),border:{width:1,color:"#000",cornerVisible:!1},row:N,col:T,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}}function Fe(N,T){var b=!1;return Object(C.arrayEach)(N.getSelectedRange(),function(w){w.forAll(function(m,L){var f=N.getCellMeta(m,L).borders;if(f&&(!T||!Object(M.hasOwnProperty)(f[T],"hide")||f[T].hide===!1))return b=!0,!1})}),b}function Xe(N){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(N)}function lt(N){return{key:"borders:bottom",name:function(){var T=this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return Fe(this,"bottom")&&(T=Xe(T)),T},callback:function(T,b){var w=Fe(this,"bottom");N.prepareBorder(b,"bottom",w),N.render()}}}function dt(N){return{key:"borders:left",name:function(){var T=this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_BORDERS_LEFT);return Fe(this,"left")&&(T=Xe(T)),T},callback:function(T,b){var w=Fe(this,"left");N.prepareBorder(b,"left",w),N.render()}}}function Pt(N){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(T,b){N.prepareBorder(b,"noBorders"),N.render()},disabled:function(){return!Fe(this)}}}function rt(N){return{key:"borders:right",name:function(){var T=this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return Fe(this,"right")&&(T=Xe(T)),T},callback:function(T,b){var w=Fe(this,"right");N.prepareBorder(b,"right",w),N.render()}}}var Xt=i(250);function en(N){return(en=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T})(N)}function Kt(N,T){return function(b){if(Array.isArray(b))return b}(N)||function(b,w){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var m=[],L=!0,f=!1,g=void 0;try{for(var E,D=b[Symbol.iterator]();!(L=(E=D.next()).done)&&(m.push(E.value),!w||m.length!==w);L=!0);}catch(z){f=!0,g=z}finally{try{L||D.return==null||D.return()}finally{if(f)throw g}}return m}}(N,T)||function(b,w){if(!!b){if(typeof b=="string")return Cn(b,w);var m=Object.prototype.toString.call(b).slice(8,-1);if(m==="Object"&&b.constructor&&(m=b.constructor.name),m==="Map"||m==="Set")return Array.from(b);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return Cn(b,w)}}(N,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Cn(N,T){(T==null||T>N.length)&&(T=N.length);for(var b=0,w=new Array(T);b<T;b++)w[b]=N[b];return w}function yn(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}function bn(N,T,b){return(bn=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(w,m,L){var f=function(E,D){for(;!Object.prototype.hasOwnProperty.call(E,D)&&(E=Vt(E))!==null;);return E}(w,m);if(f){var g=Object.getOwnPropertyDescriptor(f,m);return g.get?g.get.call(L):g.value}})(N,T,b||N)}function On(N,T){return(On=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(N,T)}function En(N){var T=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}();return function(){var b,w=Vt(N);if(T){var m=Vt(this).constructor;b=Reflect.construct(w,arguments,m)}else b=w.apply(this,arguments);return dn(this,b)}}function dn(N,T){return!T||en(T)!=="object"&&typeof T!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(N):T}function Vt(N){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(T){return T.__proto__||Object.getPrototypeOf(T)})(N)}var un=function(N){(function(f,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(g&&g.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),g&&On(f,g)})(L,N);var T,b,w,m=En(L);function L(f){var g;return function(E,D){if(!(E instanceof D))throw new TypeError("Cannot call a class as a function")}(this,L),(g=m.call(this,f)).savedBorders=[],g.savedBordersById=new Map,g}return T=L,(b=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var f=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(g){return f.onAfterContextMenuDefaultOptions(g)}),this.addHook("init",function(){return f.onAfterInit()}),bn(Vt(L.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),this.render(),bn(Vt(L.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),bn(Vt(L.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(f,g){var E=this,D=g?Object.keys(g):["top","right","bottom","left"],z=Object(Xt.b)(f),te=Object(Xt.c)(z);Object(C.arrayEach)(f,function(ge){for(var Ne=Kt(te(ge),4),et=Ne[0],pt=Ne[1],gt=Ne[2],wt=Ne[3],Rt=function(ln){for(var Ft=function(fn){Object(C.arrayEach)(D,function(cr){E.prepareBorderFromCustomAdded(ln,fn,g,cr)})},nn=pt;nn<=wt;nn+=1)Ft(nn)},zt=et;zt<=gt;zt+=1)Rt(zt)}),this.render()}},{key:"render",value:function(){this.hot.view.render()}},{key:"getBorders",value:function(f){var g=this;if(!Array.isArray(f))return this.savedBorders;var E=Object(Xt.b)(f),D=Object(Xt.c)(E),z=[];return Object(C.arrayEach)(f,function(te){for(var ge=Kt(D(te),4),Ne=ge[0],et=ge[1],pt=ge[2],gt=ge[3],wt=function(zt){for(var ln=function(nn){Object(C.arrayEach)(g.savedBorders,function(fn){fn.row===zt&&fn.col===nn&&z.push(fn)})},Ft=et;Ft<=gt;Ft+=1)ln(Ft)},Rt=Ne;Rt<=pt;Rt+=1)wt(Rt)}),z}},{key:"clearBorders",value:function(f){var g=this;f?this.setBorders(f):(Object(C.arrayEach)(this.savedBorders,function(E){g.clearBordersFromSelectionSettings(E.id),g.hot.removeCellMeta(E.row,E.col,"borders")}),this.savedBorders.length=0,this.savedBordersById.clear()),this.render()}},{key:"insertBorderIntoSettings",value:function(f){var g=this.savedBordersById.get(f.id);if(g){var E=this.savedBorders.indexOf(g);this.savedBorders[E]=f}else this.savedBorders.push(f);this.savedBordersById.set(f.id,f);var D={row:f.row,col:f.col},z=new H.b(D,D,D);this.checkCustomSelections(f,z)||this.hot.selection.highlight.addCustomSelection(f.id,{border:f,cellRange:z})}},{key:"prepareBorderFromCustomAdded",value:function(f,g,E,D){var z,te,ge=Te(f,g);if(E){z=ge,te=E,Object(M.hasOwnProperty)(te,"border")&&(z.border=te.border),Object(M.hasOwnProperty)(te,"top")&&(te.top?(Object(M.isObject)(te.top)||(te.top={width:1,color:"#000"}),z.top=te.top):(te.top={hide:!0},z.top=te.top)),Object(M.hasOwnProperty)(te,"right")&&(te.right?(Object(M.isObject)(te.right)||(te.right={width:1,color:"#000"}),z.right=te.right):(te.right={hide:!0},z.right=te.right)),Object(M.hasOwnProperty)(te,"bottom")&&(te.bottom?(Object(M.isObject)(te.bottom)||(te.bottom={width:1,color:"#000"}),z.bottom=te.bottom):(te.bottom={hide:!0},z.bottom=te.bottom)),Object(M.hasOwnProperty)(te,"left")&&(te.left?(Object(M.isObject)(te.left)||(te.left={width:1,color:"#000"}),z.left=te.left):(te.left={hide:!0},z.left=te.left)),ge=z;var Ne=this.hot.selection.highlight.customSelections.get(ge.id);Ne&&(Object.assign(Ne.settings,E),ge=Ne.settings)}this.hot.setCellMeta(f,g,"borders",ge),this.insertBorderIntoSettings(ge,D)}},{key:"prepareBorderFromCustomAddedRange",value:function(f){var g=this,E=f.range;Object(B.rangeEach)(E.from.row,E.to.row,function(D){Object(B.rangeEach)(E.from.col,E.to.col,function(z){var te=Te(D,z),ge=0;D===E.from.row&&Object(M.hasOwnProperty)(f,"top")&&(ge+=1,te.top=f.top),D===E.to.row&&Object(M.hasOwnProperty)(f,"bottom")&&(ge+=1,te.bottom=f.bottom),z===E.from.col&&Object(M.hasOwnProperty)(f,"left")&&(ge+=1,te.left=f.left),z===E.to.col&&Object(M.hasOwnProperty)(f,"right")&&(ge+=1,te.right=f.right),ge>0&&(g.hot.setCellMeta(D,z,"borders",te),g.insertBorderIntoSettings(te))})})}},{key:"removeAllBorders",value:function(f,g){var E=ue(f,g);this.spliceBorder(E),this.clearBordersFromSelectionSettings(E),this.hot.removeCellMeta(f,g,"borders")}},{key:"setBorder",value:function(f,g,E,D){var z=this.hot.getCellMeta(f,g).borders;z&&z.border!==void 0||(z=Te(f,g)),D?(z[E]={hide:!0},this.areAllEdgesDisabled(z)?this.removeAllBorders(f,g):(this.checkCustomSelectionsFromContextMenu(z,E,D)||this.insertBorderIntoSettings(z),this.hot.setCellMeta(f,g,"borders",z))):(z[E]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(z,E,D)||this.insertBorderIntoSettings(z),this.hot.setCellMeta(f,g,"borders",z))}},{key:"prepareBorder",value:function(f,g,E){var D=this;Object(C.arrayEach)(f,function(z){var te=z.start,ge=z.end;if(te.row===ge.row&&te.col===ge.col)g==="noBorders"?D.removeAllBorders(te.row,te.col):D.setBorder(te.row,te.col,g,E);else switch(g){case"noBorders":Object(B.rangeEach)(te.col,ge.col,function(Ne){Object(B.rangeEach)(te.row,ge.row,function(et){D.removeAllBorders(et,Ne)})});break;case"top":Object(B.rangeEach)(te.col,ge.col,function(Ne){D.setBorder(te.row,Ne,g,E)});break;case"right":Object(B.rangeEach)(te.row,ge.row,function(Ne){D.setBorder(Ne,ge.col,g,E)});break;case"bottom":Object(B.rangeEach)(te.col,ge.col,function(Ne){D.setBorder(ge.row,Ne,g,E)});break;case"left":Object(B.rangeEach)(te.row,ge.row,function(Ne){D.setBorder(Ne,te.col,g,E)})}})}},{key:"createCustomBorders",value:function(f){var g=this;Object(C.arrayEach)(f,function(E){E.range?g.prepareBorderFromCustomAddedRange(E):g.prepareBorderFromCustomAdded(E.row,E.col,E)})}},{key:"areAllEdgesDisabled",value:function(f){return!(this.isEdgeEnabled(f.left)||this.isEdgeEnabled(f.right)||this.isEdgeEnabled(f.top)||this.isEdgeEnabled(f.bottom))}},{key:"isEdgeEnabled",value:function(f){return f===void 0||f.hide===void 0||!f.hide}},{key:"clearBordersFromSelectionSettings",value:function(f){var g=this.hot.selection.highlight.customSelections.get(f);g&&(g.clear(),this.hot.selection.highlight.customSelections.delete(g.settings.id))}},{key:"hideBorders",value:function(){var f=this;Object(C.arrayEach)(this.savedBorders,function(g){f.clearBordersFromSelectionSettings(g.id)})}},{key:"spliceBorder",value:function(f){var g=this.savedBordersById.get(f);if(g){var E=this.savedBorders.indexOf(g);this.savedBorders.splice(E,1),this.savedBordersById.delete(f)}}},{key:"checkCustomSelectionsFromContextMenu",value:function(f){return this.hot.selection.highlight.customSelections.has(f.id)}},{key:"checkCustomSelections",value:function(f,g){if(this.areAllEdgesDisabled(f))return this.removeAllBorders(f.row,f.col),!0;var E=this.hot.selection.highlight.customSelections.get(f.id);return!!E&&(E.cellRange=g,!0)}},{key:"changeBorderSettings",value:function(){var f=this.hot.getSettings().customBorders;Array.isArray(f)?(f.length||(this.savedBorders=f),this.createCustomBorders(f)):f!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(f){var g;this.hot.getSettings().customBorders&&f.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(g=this,{key:"borders:top",name:function(){var E=this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_BORDERS_TOP);return Fe(this,"top")&&(E=Xe(E)),E},callback:function(E,D){var z=Fe(this,"top");g.prepareBorder(D,"top",z),g.render()}}),rt(this),lt(this),dt(this),Pt(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){bn(Vt(L.prototype),"destroy",this).call(this)}}])&&yn(T.prototype,b),w&&yn(T,w),L}(ee);Object(pe.d)("customBorders",un);var gn=un,St=i(184),Mt=i(181);function Nt(){var N=Sn(["The merged cell declared at [",", ",`] has "rowspan" or "colspan" declared as 
      "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan" or "colspan" declared as\\x20
      "0", which is not supported. It cannot be added to the collection.`]);return Nt=function(){return N},N}function cn(){var N=Sn(["The merged cell declared at [",", ",`] has both "rowspan" 
     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`]);return cn=function(){return N},N}function Dt(){var N=Sn(["The merged cell declared at [",", ",`] is positioned (or positioned partially) 
       outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned (or positioned partially)\\x20
       outside of the table range. It was not added to the table, please fix your setup.`]);return Dt=function(){return N},N}function Yt(){var N=Sn(["The merged cell declared with {row: ",", col: ",`, rowspan: 
    `,", colspan: ",`} contains negative values, which is not supported. It 
    will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`, rowspan:\\x20
    `,", colspan: ",`} contains negative values, which is not supported. It\\x20
    will not be added to the collection.`]);return Yt=function(){return N},N}function Sn(N,T){return T||(T=N.slice(0)),Object.freeze(Object.defineProperties(N,{raw:{value:Object.freeze(T)}}))}function _n(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}var pn=function(){function N(m,L,f,g){(function(E,D){if(!(E instanceof D))throw new TypeError("Cannot call a class as a function")})(this,N),this.row=m,this.col=L,this.rowspan=f,this.colspan=g,this.removed=!1}var T,b,w;return T=N,w=[{key:"NEGATIVE_VALUES_WARNING",value:function(m){return Object(Mt.a)(Yt(),m.row,m.col,m.rowspan,m.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(m){return Object(Mt.a)(Dt(),m.row,m.col)}},{key:"IS_SINGLE_CELL",value:function(m){return Object(Mt.a)(cn(),m.row,m.col)}},{key:"ZERO_SPAN_WARNING",value:function(m){return Object(Mt.a)(Nt(),m.row,m.col)}},{key:"containsNegativeValues",value:function(m){return m.row<0||m.col<0||m.rowspan<0||m.colspan<0}},{key:"isSingleCell",value:function(m){return m.colspan===1&&m.rowspan===1}},{key:"containsZeroSpan",value:function(m){return m.colspan===0||m.rowspan===0}},{key:"isOutOfBounds",value:function(m,L,f){return m.row<0||m.col<0||m.row>=L||m.row+m.rowspan-1>=L||m.col>=f||m.col+m.colspan-1>=f}}],(b=[{key:"normalize",value:function(m){var L=m.countRows(),f=m.countCols();this.row<0?this.row=0:this.row>L-1&&(this.row=L-1),this.col<0?this.col=0:this.col>f-1&&(this.col=f-1),this.row+this.rowspan>L-1&&(this.rowspan=L-this.row),this.col+this.colspan>f-1&&(this.colspan=f-this.col)}},{key:"includes",value:function(m,L){return this.row<=m&&this.col<=L&&this.row+this.rowspan-1>=m&&this.col+this.colspan-1>=L}},{key:"includesHorizontally",value:function(m){return this.col<=m&&this.col+this.colspan-1>=m}},{key:"includesVertically",value:function(m){return this.row<=m&&this.row+this.rowspan-1>=m}},{key:"shift",value:function(m,L){var f=m[0]||m[1],g=L+Math.abs(m[0]||m[1])-1,E=m[0]?"colspan":"rowspan",D=m[0]?"col":"row",z=Math.min(L,g),te=Math.max(L,g),ge=this[D],Ne=this[D]+this[E]-1;if(ge>=L&&(this[D]+=f),f>0)L<=Ne&&L>ge&&(this[E]+=f);else if(f<0){if(z<=ge&&te>=Ne)return this.removed=!0,!1;if(ge>=z&&ge<=te){var et=te-ge+1,pt=Math.abs(f)-et;this[D]-=pt+f,this[E]-=et}else if(ge<=z&&Ne>=te)this[E]+=f;else if(ge<=z&&Ne>=z&&Ne<te){var gt=Ne-z+1;this[E]-=gt}}return!0}},{key:"isFarther",value:function(m,L){return!m||(L==="down"?m.row+m.rowspan-1<this.row+this.rowspan-1:L==="up"?m.row>this.row:L==="right"?m.col+m.colspan-1<this.col+this.colspan-1:L==="left"?m.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new H.b(new H.a(this.row,this.col),new H.a(this.row,this.col),new H.a(this.getLastRow(),this.getLastColumn()))}}])&&_n(T.prototype,b),w&&_n(T,w),N}(),Hn=i(187);function Gn(N,T,b,w){T?T.row===b&&T.col===w?(N.setAttribute("rowspan",T.rowspan.toString()),N.setAttribute("colspan",T.colspan.toString())):(N.removeAttribute("rowspan"),N.removeAttribute("colspan"),N.style.display="none"):(N.removeAttribute("rowspan"),N.removeAttribute("colspan"),N.style.display="")}function jn(){var N=function(T,b){return b||(b=T.slice(0)),Object.freeze(Object.defineProperties(T,{raw:{value:Object.freeze(b)}}))}(["The merged cell declared at [",", ",`], overlaps with the other declared merged 
    cell. The overlapping merged cell was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`], overlaps with the other declared merged\\x20
    cell. The overlapping merged cell was not added to the table, please fix your setup.`]);return jn=function(){return N},N}function Mn(N){return function(T){if(Array.isArray(T))return rr(T)}(N)||function(T){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(T))return Array.from(T)}(N)||function(T,b){if(!!T){if(typeof T=="string")return rr(T,b);var w=Object.prototype.toString.call(T).slice(8,-1);if(w==="Object"&&T.constructor&&(w=T.constructor.name),w==="Map"||w==="Set")return Array.from(T);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return rr(T,b)}}(N)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function rr(N,T){(T==null||T>N.length)&&(T=N.length);for(var b=0,w=new Array(T);b<T;b++)w[b]=N[b];return w}function $n(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}var ar=function(){function N(m){(function(L,f){if(!(L instanceof f))throw new TypeError("Cannot call a class as a function")})(this,N),this.plugin=m,this.mergedCells=[],this.hot=m.hot}var T,b,w;return T=N,w=[{key:"IS_OVERLAPPING_WARNING",value:function(m){return Object(Mt.a)(jn(),m.row,m.col)}}],(b=[{key:"get",value:function(m,L){var f=this.mergedCells,g=!1;return Object(C.arrayEach)(f,function(E){return!(E.row<=m&&E.row+E.rowspan-1>=m&&E.col<=L&&E.col+E.colspan-1>=L&&(g=E,1))}),g}},{key:"getByRange",value:function(m){var L=this.mergedCells,f=!1;return Object(C.arrayEach)(L,function(g){return!(g.row<=m.from.row&&g.row+g.rowspan-1>=m.to.row&&g.col<=m.from.col&&g.col+g.colspan-1>=m.to.col)||(f=g)}),f}},{key:"getWithinRange",value:function(m){var L=arguments.length>1&&arguments[1]!==void 0&&arguments[1],f=this.mergedCells,g=[],E=m;if(!E.includesRange){var D=new H.a(E.from.row,E.from.col),z=new H.a(E.to.row,E.to.col);E=new H.b(D,D,z)}return Object(C.arrayEach)(f,function(te){var ge=new H.a(te.row,te.col),Ne=new H.a(te.row+te.rowspan-1,te.col+te.colspan-1),et=new H.b(ge,ge,Ne);L?E.overlaps(et)&&g.push(te):E.includesRange(et)&&g.push(te)}),!!g.length&&g}},{key:"add",value:function(m){var L=this.mergedCells,f=m.row,g=m.col,E=m.rowspan,D=m.colspan,z=new pn(f,g,E,D),te=this.get(f,g),ge=this.isOverlapping(z);return te||ge?(Object(Hn.b)(N.IS_OVERLAPPING_WARNING(z)),!1):(this.hot&&z.normalize(this.hot),L.push(z),z)}},{key:"remove",value:function(m,L){var f=this.mergedCells,g=this.get(m,L),E=g?this.mergedCells.indexOf(g):null;return!(!g||E===!1)&&(f.splice(E,1),g)}},{key:"clear",value:function(){var m=this,L=this.mergedCells,f=[],g=[];Object(C.arrayEach)(L,function(E){var D=m.hot.getCell(E.row,E.col);D&&f.push([D,m.get(E.row,E.col),E.row,E.col])}),this.mergedCells.length=0,Object(C.arrayEach)(f,function(E,D){Object(B.rangeEach)(0,E.rowspan-1,function(z){Object(B.rangeEach)(0,E.colspan-1,function(te){if(te!==0||z!==0){var ge=m.hot.getCell(E.row+z,E.col+te);ge&&g.push([ge,null,null,null])}})}),f[D][1]=null}),Object(C.arrayEach)(f,function(E){Gn.apply(void 0,Mn(E))}),Object(C.arrayEach)(g,function(E){Gn.apply(void 0,Mn(E))})}},{key:"isOverlapping",value:function(m){var L=new H.b(null,new H.a(m.row,m.col),new H.a(m.row+m.rowspan-1,m.col+m.colspan-1)),f=!1;return Object(C.arrayEach)(this.mergedCells,function(g){return!new H.b(null,new H.a(g.row,g.col),new H.a(g.row+g.rowspan-1,g.col+g.colspan-1)).overlaps(L)||(f=!0,!1)}),f}},{key:"isMergedParent",value:function(m,L){var f=this.mergedCells,g=!1;return Object(C.arrayEach)(f,function(E){return E.row!==m||E.col!==L||(g=!0,!1)}),g}},{key:"shiftCollections",value:function(m,L,f){var g=this,E=[0,0];switch(m){case"right":E[0]+=f;break;case"left":E[0]-=f;break;case"down":E[1]+=f;break;case"up":E[1]-=f}Object(C.arrayEach)(this.mergedCells,function(D){D.shift(E,L)}),Object(B.rangeEachReverse)(this.mergedCells.length-1,0,function(D){var z=g.mergedCells[D];z&&z.removed&&g.mergedCells.splice(g.mergedCells.indexOf(z),1)})}}])&&$n(T.prototype,b),w&&$n(T,w),N}();function Rn(N,T){return function(b){if(Array.isArray(b))return b}(N)||function(b,w){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var m=[],L=!0,f=!1,g=void 0;try{for(var E,D=b[Symbol.iterator]();!(L=(E=D.next()).done)&&(m.push(E.value),!w||m.length!==w);L=!0);}catch(z){f=!0,g=z}finally{try{L||D.return==null||D.return()}finally{if(f)throw g}}return m}}(N,T)||function(b,w){if(!!b){if(typeof b=="string")return Qn(b,w);var m=Object.prototype.toString.call(b).slice(8,-1);if(m==="Object"&&b.constructor&&(m=b.constructor.name),m==="Map"||m==="Set")return Array.from(b);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return Qn(b,w)}}(N,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Qn(N,T){(T==null||T>N.length)&&(T=N.length);for(var b=0,w=new Array(T);b<T;b++)w[b]=N[b];return w}function st(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}var sr=function(){function N(m){(function(L,f){if(!(L instanceof f))throw new TypeError("Cannot call a class as a function")})(this,N),this.plugin=m,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var T,b,w;return T=N,(b=[{key:"correctSelectionAreaSize",value:function(m){if(m[0]===m[2]&&m[1]===m[3]){var L=this.mergedCellsCollection.get(m[0],m[1]);L&&(m[2]=m[0]+L.rowspan-1,m[3]=m[1]+L.colspan-1)}}},{key:"getDirection",value:function(m,L){return L[0]===m[0]&&L[1]===m[1]&&L[3]===m[3]?"down":L[2]===m[2]&&L[1]===m[1]&&L[3]===m[3]?"up":L[1]===m[1]&&L[2]===m[2]?"right":"left"}},{key:"snapDragArea",value:function(m,L,f,g){var E=L.slice(0),D=this.getAutofillSize(m,L,f),z=Rn(m,4),te=z[0],ge=z[1],Ne=z[2],et=z[3],pt=["up","down"].indexOf(f)>-1?Ne-te+1:et-ge+1,gt=D-Math.floor(D/pt)*pt,wt=this.getFarthestCollection(m,L,f,g);if(wt){if(f==="down"){var Rt=wt.row+wt.rowspan-te-gt;E[2]+Rt>=this.plugin.hot.countRows()?E[2]-=gt:E[2]+=gt?Rt:0}else if(f==="right"){var zt=wt.col+wt.colspan-ge-gt;E[3]+zt>=this.plugin.hot.countCols()?E[3]-=gt:E[3]+=gt?zt:0}else if(f==="up"){var ln=Ne-gt-wt.row+1;E[0]+ln<0?E[0]+=gt:E[0]-=gt?ln:0}else if(f==="left"){var Ft=et-gt-wt.col+1;E[1]+Ft<0?E[1]+=gt:E[1]-=gt?Ft:0}}return this.updateCurrentFillCache({baseArea:m,dragDirection:f,foundMergedCells:g,fillSize:D,dragArea:E,cycleLength:pt}),E}},{key:"updateCurrentFillCache",value:function(m){this.currentFillData||(this.currentFillData={}),Object(M.extend)(this.currentFillData,m)}},{key:"getAutofillSize",value:function(m,L,f){var g=Rn(m,4),E=g[0],D=g[1],z=g[2],te=g[3],ge=Rn(L,4),Ne=ge[0],et=ge[1],pt=ge[2],gt=ge[3];switch(f){case"up":return E-Ne;case"down":return pt-z;case"left":return D-et;case"right":return gt-te;default:return null}}},{key:"getDragArea",value:function(m,L,f){var g=Rn(m,4),E=g[0],D=g[1],z=g[2],te=g[3],ge=Rn(L,4),Ne=ge[0],et=ge[1],pt=ge[2],gt=ge[3];switch(f){case"up":return[Ne,et,E-1,te];case"down":return[z+1,D,pt,te];case"left":return[Ne,et,z,D-1];case"right":return[E,te+1,pt,gt];default:return null}}},{key:"getFarthestCollection",value:function(m,L,f,g){var E=Rn(m,4),D=E[0],z=E[1],te=E[2],ge=E[3],Ne=["up","down"].indexOf(f)>-1,et=Ne?te:ge,pt=Ne?D:z,gt=this.getAutofillSize(m,L,f),wt=Ne?te-D+1:ge-z+1,Rt=gt-Math.floor(gt/wt)*wt,zt=null,ln=null,Ft=null;switch(f){case"up":zt="includesVertically",Ft=et-Rt+1;break;case"left":zt="includesHorizontally",Ft=et-Rt+1;break;case"down":zt="includesVertically",Ft=pt+Rt-1;break;case"right":zt="includesHorizontally",Ft=pt+Rt-1}return Object(C.arrayEach)(g,function(nn){nn[zt](Ft)&&nn.isFarther(ln,f)&&(ln=nn)}),ln}},{key:"recreateAfterDataPopulation",value:function(m){if(this.currentFillData){var L=this.getRangeFromChanges(m),f=this.currentFillData.foundMergedCells,g=this.currentFillData.dragDirection,E=function(Ne,et){switch(g){case"up":return Ne.row-et>=L.from.row;case"down":return Ne.row+Ne.rowspan-1+et<=L.to.row;case"left":return Ne.col-et>=L.from.column;case"right":return Ne.col+Ne.colspan-1+et<=L.to.column;default:return null}},D=0,z=null,te=1;do for(var ge=0;ge<f.length;ge+=1){if(E(z=f[ge],D=te*this.currentFillData.cycleLength))switch(g){case"up":this.plugin.mergedCellsCollection.add({row:z.row-D,rowspan:z.rowspan,col:z.col,colspan:z.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:z.row+D,rowspan:z.rowspan,col:z.col,colspan:z.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:z.row,rowspan:z.rowspan,col:z.col-D,colspan:z.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:z.row,rowspan:z.rowspan,col:z.col+D,colspan:z.colspan})}ge===f.length-1&&(te+=1)}while(E(z,D));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(m){var L=this,f={min:null,max:null},g={min:null,max:null};return Object(C.arrayEach)(m,function(E){var D=E[0],z=L.plugin.hot.propToCol(E[1]);(f.min===null||D<f.min)&&(f.min=D),(f.max===null||D>f.max)&&(f.max=D),(g.min===null||z<g.min)&&(g.min=z),(g.max===null||z>g.max)&&(g.max=z)}),{from:{row:f.min,column:g.min},to:{row:f.max,column:g.max}}}},{key:"dragAreaOverlapsCollections",value:function(m,L,f){var g=Rn(this.getDragArea(m,L,f),4),E=g[0],D=g[1],z=g[2],te=g[3],ge=new H.a(E,D),Ne=new H.a(z,te),et=new H.b(ge,ge,Ne);return!!this.mergedCellsCollection.getWithinRange(et,!0)}}])&&st(T.prototype,b),w&&st(T,w),N}();function lr(N,T){return function(b){if(Array.isArray(b))return b}(N)||function(b,w){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var m=[],L=!0,f=!1,g=void 0;try{for(var E,D=b[Symbol.iterator]();!(L=(E=D.next()).done)&&(m.push(E.value),!w||m.length!==w);L=!0);}catch(z){f=!0,g=z}finally{try{L||D.return==null||D.return()}finally{if(f)throw g}}return m}}(N,T)||function(b,w){if(!!b){if(typeof b=="string")return Zn(b,w);var m=Object.prototype.toString.call(b).slice(8,-1);if(m==="Object"&&b.constructor&&(m=b.constructor.name),m==="Map"||m==="Set")return Array.from(b);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return Zn(b,w)}}(N,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Zn(N,T){(T==null||T>N.length)&&(T=N.length);for(var b=0,w=new Array(T);b<T;b++)w[b]=N[b];return w}function ur(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}var ae=function(){function N(m){(function(L,f){if(!(L instanceof f))throw new TypeError("Cannot call a class as a function")})(this,N),this.plugin=m,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var T,b,w;return T=N,(b=[{key:"snapDelta",value:function(m,L,f){var g=L.to,E=g.row+m.row,D=g.col+m.col;m.row?this.jumpOverMergedCell(m,f,E):m.col&&this.jumpOverMergedCell(m,f,D)}},{key:"jumpOverMergedCell",value:function(m,L,f){var g=m.row||m.col,E=null,D=null,z=null;m.row?(E=L.includesVertically(f),D=L.row,z=L.getLastRow()):m.col&&(E=L.includesHorizontally(f),D=L.col,z=L.getLastColumn()),g!==0&&(g>0?E&&f!==D&&(g+=z-f+1):E&&f!==z&&(g-=f-D+1),m.row?m.row=g:m.col&&(m.col=g))}},{key:"getUpdatedSelectionRange",value:function(m,L){return new H.b(m.highlight,m.from,new H.a(m.to.row+L.row,m.to.col+L.col))}},{key:"getSelectedMergedCellClassName",value:function(m,L,f,g){var E=lr(f,4),D=E[0],z=E[1],te=E[2],ge=E[3];if(g!==void 0&&m>=D&&m<=te&&L>=z&&L<=ge){if(!this.plugin.mergedCellsCollection.isMergedParent(m,L))return;var Ne=this.plugin.mergedCellsCollection.get(m,L);if(!Ne)return;if(Ne.row+Ne.rowspan-1<=te&&Ne.col+Ne.colspan-1<=ge)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(g);if(this.plugin.selectionCalculations.isMergeCellFullySelected(Ne,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}},{key:"isMergeCellFullySelected",value:function(m,L){var f=[];if(!L||!m)return!1;for(var g=0;g<m.rowspan;g+=1)for(var E=0;E<m.colspan;E+=1)f.push(new H.a(m.row+g,m.col+E));for(var D=0;D<f.length;D+=1){for(var z=[],te=0;te<L.length;te+=1)z[te]=L[te].includes(f[D]);if(!z.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var m=[],L=0;L<=7;L+=1)m.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(L));return m.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),m}}])&&ur(T.prototype,b),w&&ur(T,w),N}();function oe(N){return(oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T})(N)}function J(N,T){return function(b){if(Array.isArray(b))return b}(N)||function(b,w){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var m=[],L=!0,f=!1,g=void 0;try{for(var E,D=b[Symbol.iterator]();!(L=(E=D.next()).done)&&(m.push(E.value),!w||m.length!==w);L=!0);}catch(z){f=!0,g=z}finally{try{L||D.return==null||D.return()}finally{if(f)throw g}}return m}}(N,T)||_e(N,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ce(N){return function(T){if(Array.isArray(T))return Ue(T)}(N)||function(T){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(T))return Array.from(T)}(N)||_e(N)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function _e(N,T){if(N){if(typeof N=="string")return Ue(N,T);var b=Object.prototype.toString.call(N).slice(8,-1);return b==="Object"&&N.constructor&&(b=N.constructor.name),b==="Map"||b==="Set"?Array.from(N):b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?Ue(N,T):void 0}}function Ue(N,T){(T==null||T>N.length)&&(T=N.length);for(var b=0,w=new Array(T);b<T;b++)w[b]=N[b];return w}function Ae(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}function ke(N,T,b){return(ke=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(w,m,L){var f=function(E,D){for(;!Object.prototype.hasOwnProperty.call(E,D)&&(E=vt(E))!==null;);return E}(w,m);if(f){var g=Object.getOwnPropertyDescriptor(f,m);return g.get?g.get.call(L):g.value}})(N,T,b||N)}function Pe(N,T){return(Pe=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(N,T)}function ze(N){var T=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}();return function(){var b,w=vt(N);if(T){var m=vt(this).constructor;b=Reflect.construct(w,arguments,m)}else b=w.apply(this,arguments);return it(this,b)}}function it(N,T){return!T||oe(T)!=="object"&&typeof T!="function"?At(N):T}function At(N){if(N===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N}function vt(N){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(T){return T.__proto__||Object.getPrototypeOf(T)})(N)}Z.a.getSingleton().register("beforeMergeCells"),Z.a.getSingleton().register("afterMergeCells"),Z.a.getSingleton().register("beforeUnmergeCells"),Z.a.getSingleton().register("afterUnmergeCells");var qt=new WeakMap,kt=function(N){(function(f,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(g&&g.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),g&&Pe(f,g)})(L,N);var T,b,w,m=ze(L);function L(f){var g;return function(E,D){if(!(E instanceof D))throw new TypeError("Cannot call a class as a function")}(this,L),g=m.call(this,f),qt.set(At(g),{lastDesiredCoords:null}),g.mergedCellsCollection=null,g.autofillCalculations=null,g.selectionCalculations=null,g}return T=L,(b=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var f=this;this.enabled||(this.mergedCellsCollection=new ar(this),this.autofillCalculations=new sr(this),this.selectionCalculations=new ae(this),this.addHook("afterInit",function(){return f.onAfterInit.apply(f,arguments)}),this.addHook("beforeKeyDown",function(){return f.onBeforeKeyDown.apply(f,arguments)}),this.addHook("modifyTransformStart",function(){return f.onModifyTransformStart.apply(f,arguments)}),this.addHook("afterModifyTransformStart",function(){return f.onAfterModifyTransformStart.apply(f,arguments)}),this.addHook("modifyTransformEnd",function(){return f.onModifyTransformEnd.apply(f,arguments)}),this.addHook("modifyGetCellCoords",function(){return f.onModifyGetCellCoords.apply(f,arguments)}),this.addHook("beforeSetRangeEnd",function(){return f.onBeforeSetRangeEnd.apply(f,arguments)}),this.addHook("afterIsMultipleSelection",function(){return f.onAfterIsMultipleSelection.apply(f,arguments)}),this.addHook("afterRenderer",function(){return f.onAfterRenderer.apply(f,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return f.addMergeActionsToContextMenu.apply(f,arguments)}),this.addHook("afterGetCellMeta",function(){return f.onAfterGetCellMeta.apply(f,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return f.onAfterViewportRowCalculatorOverride.apply(f,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return f.onAfterViewportColumnCalculatorOverride.apply(f,arguments)}),this.addHook("modifyAutofillRange",function(){return f.onModifyAutofillRange.apply(f,arguments)}),this.addHook("afterCreateCol",function(){return f.onAfterCreateCol.apply(f,arguments)}),this.addHook("afterRemoveCol",function(){return f.onAfterRemoveCol.apply(f,arguments)}),this.addHook("afterCreateRow",function(){return f.onAfterCreateRow.apply(f,arguments)}),this.addHook("afterRemoveRow",function(){return f.onAfterRemoveRow.apply(f,arguments)}),this.addHook("afterChange",function(){return f.onAfterChange.apply(f,arguments)}),this.addHook("beforeDrawBorders",function(){return f.onBeforeDrawAreaBorders.apply(f,arguments)}),this.addHook("afterDrawSelection",function(){return f.onAfterDrawSelection.apply(f,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return f.onBeforeRemoveCellClassNames.apply(f,arguments)}),ke(vt(L.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),ke(vt(L.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var f=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(f),ke(vt(L.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(f){var g=!0;return!!f&&(pn.containsNegativeValues(f)?(Object(Hn.b)(pn.NEGATIVE_VALUES_WARNING(f)),g=!1):pn.isOutOfBounds(f,this.hot.countRows(),this.hot.countCols())?(Object(Hn.b)(pn.IS_OUT_OF_BOUNDS_WARNING(f)),g=!1):pn.isSingleCell(f)?(Object(Hn.b)(pn.IS_SINGLE_CELL(f)),g=!1):pn.containsZeroSpan(f)&&(Object(Hn.b)(pn.ZERO_SPAN_WARNING(f)),g=!1),g)}},{key:"generateFromSettings",value:function(f){var g=this;if(Array.isArray(f)){var E,D=[];Object(C.arrayEach)(f,function(te){if(g.validateSetting(te)){var ge=new H.a(te.row,te.col),Ne=new H.a(te.row+te.rowspan-1,te.col+te.colspan-1),et=new H.b(ge,ge,Ne);D.push(g.mergeRange(et,!0,!0))}}),D=D.filter(function(te){return te!==!0});var z=this.getBulkCollectionData(D);(E=this.hot).populateFromArray.apply(E,Ce(z))}}},{key:"getBulkCollectionData",value:function(f){var g,E=this.getBulkCollectionDataRange(f),D=(g=this.hot).getData.apply(g,Ce(E)).splice(0);return Object(C.arrayEach)(f,function(z){var te=J(z,3),ge=te[0],Ne=te[1],et=te[2];Object(C.arrayEach)(et,function(pt,gt){Object(C.arrayEach)(pt,function(wt,Rt){D[ge-E[0]+gt][Ne-E[1]+Rt]=wt})})}),[E[0],E[1],D]}},{key:"getBulkCollectionDataRange",value:function(f){var g=[0,0],E=[0,0],D=null,z=null,te=null;return Object(C.arrayEach)(f,function(ge){D=ge[0],z=ge[1],te=ge[2],g[0]=Math.min(D,g[0]),g[1]=Math.min(z,g[1]),E[0]=Math.max(D+te.length-1,E[0]),E[1]=Math.max(z+te[0].length-1,E[1])}),[].concat(g,E)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(f){var g=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return!!g||this.validateSetting(f)}},{key:"toggleMergeOnSelection",value:function(){var f=this.hot.getSelectedRangeLast();if(f){f.setDirection("NW-SE");var g=f.from,E=f.to;this.toggleMerge(f),this.hot.selectCell(g.row,g.col,E.row,E.col,!1)}}},{key:"mergeSelection",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(f){f.setDirection("NW-SE");var g=f.from,E=f.to;this.unmergeRange(f,!0),this.mergeRange(f),this.hot.selectCell(g.row,g.col,E.row,E.col,!1)}}},{key:"unmergeSelection",value:function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(f){var g=f.from,E=f.to;this.unmergeRange(f,!0),this.hot.selectCell(g.row,g.col,E.row,E.col,!1)}}},{key:"mergeRange",value:function(f){var g=this,E=arguments.length>1&&arguments[1]!==void 0&&arguments[1],D=arguments.length>2&&arguments[2]!==void 0&&arguments[2],z=f.getTopLeftCorner(),te=f.getBottomRightCorner(),ge={row:z.row,col:z.col,rowspan:te.row-z.row+1,colspan:te.col-z.col+1},Ne=[],et=null;if(!this.canMergeRange(ge,E))return!1;this.hot.runHooks("beforeMergeCells",f,E),Object(B.rangeEach)(0,ge.rowspan-1,function(gt){Object(B.rangeEach)(0,ge.colspan-1,function(wt){var Rt=null;Ne[gt]||(Ne[gt]=[]),gt===0&&wt===0?Rt=g.hot.getDataAtCell(ge.row,ge.col):g.hot.setCellMeta(ge.row+gt,ge.col+wt,"hidden",!0),Ne[gt][wt]=Rt})}),this.hot.setCellMeta(ge.row,ge.col,"spanned",!0);var pt=this.mergedCellsCollection.add(ge);return!pt||(D?et=[ge.row,ge.col,Ne]:this.hot.populateFromArray(ge.row,ge.col,Ne,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",f,ge,E),et)}},{key:"unmergeRange",value:function(f){var g=this,E=arguments.length>1&&arguments[1]!==void 0&&arguments[1],D=this.mergedCellsCollection.getWithinRange(f);D&&(this.hot.runHooks("beforeUnmergeCells",f,E),Object(C.arrayEach)(D,function(z){g.mergedCellsCollection.remove(z.row,z.col),Object(B.rangeEach)(0,z.rowspan-1,function(te){Object(B.rangeEach)(0,z.colspan-1,function(ge){g.hot.removeCellMeta(z.row+te,z.col+ge,"hidden")})}),g.hot.removeCellMeta(z.row,z.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",f,E),this.hot.render())}},{key:"toggleMerge",value:function(f){var g=this.mergedCellsCollection.get(f.from.row,f.from.col);g.row===f.from.row&&g.col===f.from.col&&g.row+g.rowspan-1===f.to.row&&g.col+g.colspan-1===f.to.col?this.unmergeRange(f):this.mergeSelection(f)}},{key:"merge",value:function(f,g,E,D){var z=new H.a(f,g),te=new H.a(E,D);this.mergeRange(new H.b(z,z,te))}},{key:"unmerge",value:function(f,g,E,D){var z=new H.a(f,g),te=new H.a(E,D);this.unmergeRange(new H.b(z,z,te))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(f){(f.ctrlKey||f.metaKey)&&!f.altKey&&f.keyCode===77&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),Object(St.stopImmediatePropagation)(f))}},{key:"onAfterIsMultipleSelection",value:function(f){if(f){for(var g=this.mergedCellsCollection.mergedCells,E=this.hot.getSelectedRangeLast(),D=0;D<g.length;D+=1)if(E.highlight.row===g[D].row&&E.highlight.col===g[D].col&&E.to.row===g[D].row+g[D].rowspan-1&&E.to.col===g[D].col+g[D].colspan-1)return!1}return f}},{key:"onModifyTransformStart",value:function(f){var g,E=qt.get(this),D=this.hot.getSelectedRangeLast(),z={row:f.row,col:f.col},te=new H.a(D.highlight.row,D.highlight.col),ge=this.mergedCellsCollection.get(te.row,te.col);if(E.lastDesiredCoords||(E.lastDesiredCoords=new H.a(null,null)),ge){var Ne=new H.a(ge.row,ge.col),et=new H.a(ge.row+ge.rowspan-1,ge.col+ge.colspan-1);new H.b(Ne,Ne,et).includes(E.lastDesiredCoords)||(E.lastDesiredCoords=new H.a(null,null)),z.row=E.lastDesiredCoords.row?E.lastDesiredCoords.row-te.row:z.row,z.col=E.lastDesiredCoords.col?E.lastDesiredCoords.col-te.col:z.col,f.row>0?z.row=ge.row+ge.rowspan-1-te.row+f.row:f.row<0&&(z.row=te.row-ge.row+f.row),f.col>0?z.col=ge.col+ge.colspan-1-te.col+f.col:f.col<0&&(z.col=te.col-ge.col+f.col)}g=new H.a(D.highlight.row+z.row,D.highlight.col+z.col);var pt=this.mergedCellsCollection.get(g.row,g.col);pt&&(E.lastDesiredCoords=g,z={row:pt.row-te.row,col:pt.col-te.col}),z.row!==0&&(f.row=z.row),z.col!==0&&(f.col=z.col)}},{key:"onModifyTransformEnd",value:function(f){var g=this,E=this.hot.getSelectedRangeLast(),D=Object(M.clone)(f),z=this.selectionCalculations.getUpdatedSelectionRange(E,f),te=Object(M.clone)(D),ge=this.mergedCellsCollection.getWithinRange(z,!0);do te=Object(M.clone)(D),this.selectionCalculations.getUpdatedSelectionRange(E,D),Object(C.arrayEach)(ge,function(Ne){g.selectionCalculations.snapDelta(D,E,Ne)});while(D.row!==te.row||D.col!==te.col);f.row=D.row,f.col=D.col}},{key:"onModifyGetCellCoords",value:function(f,g){if(!(f<0||g<0)){var E=this.mergedCellsCollection.get(f,g);if(E){var D=E.row,z=E.col,te=E.colspan,ge=E.rowspan;return[].concat(Ce(this.translateMergedCellToRenderable(D,0,z,0)),Ce(this.translateMergedCellToRenderable(D,ge,z,te)))}}}},{key:"addMergeActionsToContextMenu",value:function(f){var g;f.items.push({name:"---------"},(g=this,{key:"mergeCells",name:function(){var E=this.getSelectedLast();if(E){var D=g.mergedCellsCollection.get(E[0],E[1]);if(D.row===E[0]&&D.col===E[1]&&D.row+D.rowspan-1===E[2]&&D.col+D.colspan-1===E[3])return this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(re.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){g.toggleMergeOnSelection()},disabled:function(){var E=this.getSelectedLast();return!E||pn.isSingleCell({row:E[0],col:E[1],rowspan:E[2]-E[0]+1,colspan:E[3]-E[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}},{key:"onAfterRenderer",value:function(f,g,E){var D=this.mergedCellsCollection.get(g,E),z=Object(M.isObject)(D)?Object(M.clone)(D):void 0;if(Object(M.isObject)(z)){var te=this.hot,ge=te.rowIndexMapper,Ne=te.columnIndexMapper,et=z.row,pt=z.col,gt=z.colspan,wt=z.rowspan,Rt=J(this.translateMergedCellToRenderable(et,wt,pt,gt),2),zt=Rt[0],ln=Rt[1],Ft=zt-ge.getRenderableFromVisualIndex(g)+1,nn=ln-Ne.getRenderableFromVisualIndex(E)+1;z.row=ge.getFirstNotHiddenIndex(z.row,1),z.col=Ne.getFirstNotHiddenIndex(z.col,1),z.rowspan=Math.min(z.rowspan,Ft),z.colspan=Math.min(z.colspan,nn)}Gn(f,z,g,E)}},{key:"onBeforeSetRangeEnd",value:function(f){var g=this.hot.getSelectedRangeLast();g.highlight=new H.a(g.highlight.row,g.highlight.col),g.to=f;var E=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{E=!1;for(var D=0;D<this.mergedCellsCollection.mergedCells.length;D+=1){var z=this.mergedCellsCollection.mergedCells[D].getRange();g.expandByRange(z)&&(f.row=g.to.row,f.col=g.to.col,E=!0)}}while(E)}},{key:"onAfterGetCellMeta",value:function(f,g,E){var D=this.mergedCellsCollection.get(f,g);D&&(D.row!==f||D.col!==g?E.copyable=!1:(E.rowspan=D.rowspan,E.colspan=D.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(f){var g=this.hot.countCols();this.modifyViewportRowStart(f,g),this.modifyViewportRowEnd(f,g)}},{key:"modifyViewportRowStart",value:function(f,g){for(var E=this.hot.rowIndexMapper,D=E.getVisualFromRenderableIndex(f.startRow),z=0;z<g;z+=1){var te=this.mergedCellsCollection.get(D,z);if(Object(M.isObject)(te)){var ge=E.getRenderableFromVisualIndex(E.getFirstNotHiddenIndex(te.row,1));if(ge<f.startRow)return f.startRow=ge,void this.modifyViewportRowStart(f,g)}}}},{key:"modifyViewportRowEnd",value:function(f,g){for(var E=this.hot.rowIndexMapper,D=E.getVisualFromRenderableIndex(f.endRow),z=0;z<g;z+=1){var te=this.mergedCellsCollection.get(D,z);if(Object(M.isObject)(te)){var ge=te.row+te.rowspan-1,Ne=E.getRenderableFromVisualIndex(E.getFirstNotHiddenIndex(ge,-1));if(Ne>f.endRow)return f.endRow=Ne,void this.modifyViewportRowEnd(f,g)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(f){var g=this.hot.countRows();this.modifyViewportColumnStart(f,g),this.modifyViewportColumnEnd(f,g)}},{key:"modifyViewportColumnStart",value:function(f,g){for(var E=this.hot.columnIndexMapper,D=E.getVisualFromRenderableIndex(f.startColumn),z=0;z<g;z+=1){var te=this.mergedCellsCollection.get(z,D);if(Object(M.isObject)(te)){var ge=E.getRenderableFromVisualIndex(E.getFirstNotHiddenIndex(te.col,1));if(ge<f.startColumn)return f.startColumn=ge,void this.modifyViewportColumnStart(f,g)}}}},{key:"modifyViewportColumnEnd",value:function(f,g){for(var E=this.hot.columnIndexMapper,D=E.getVisualFromRenderableIndex(f.endColumn),z=0;z<g;z+=1){var te=this.mergedCellsCollection.get(z,D);if(Object(M.isObject)(te)){var ge=te.col+te.colspan-1,Ne=E.getRenderableFromVisualIndex(E.getFirstNotHiddenIndex(ge,-1));if(Ne>f.endColumn)return f.endColumn=Ne,void this.modifyViewportColumnEnd(f,g)}}}},{key:"translateMergedCellToRenderable",value:function(f,g,E,D){var z,te,ge=this.hot,Ne=ge.rowIndexMapper,et=ge.columnIndexMapper;return z=g===0?Ne.getFirstNotHiddenIndex(f,1):Ne.getFirstNotHiddenIndex(f+g-1,-1),te=D===0?et.getFirstNotHiddenIndex(E,1):et.getFirstNotHiddenIndex(E+D-1,-1),[f>=0?Ne.getRenderableFromVisualIndex(z):f,E>=0?et.getRenderableFromVisualIndex(te):E]}},{key:"onModifyAutofillRange",value:function(f,g){this.autofillCalculations.correctSelectionAreaSize(g);var E=this.autofillCalculations.getDirection(g,f),D=f;if(this.autofillCalculations.dragAreaOverlapsCollections(g,D,E))return D=g;var z=this.mergedCellsCollection.getWithinRange({from:{row:g[0],col:g[1]},to:{row:g[2],col:g[3]}});return z?D=this.autofillCalculations.snapDragArea(g,D,E,z):D}},{key:"onAfterCreateCol",value:function(f,g){this.mergedCellsCollection.shiftCollections("right",f,g)}},{key:"onAfterRemoveCol",value:function(f,g){this.mergedCellsCollection.shiftCollections("left",f,g)}},{key:"onAfterCreateRow",value:function(f,g,E){E!=="auto"&&this.mergedCellsCollection.shiftCollections("down",f,g)}},{key:"onAfterRemoveRow",value:function(f,g){this.mergedCellsCollection.shiftCollections("up",f,g)}},{key:"onAfterChange",value:function(f,g){g==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(f)}},{key:"onBeforeDrawAreaBorders",value:function(f,g){if(g&&g==="area"){var E=this.hot.getSelectedRangeLast(),D=this.mergedCellsCollection.getWithinRange(E);Object(C.arrayEach)(D,function(z){E.getBottomRightCorner().row===z.getLastRow()&&E.getBottomRightCorner().col===z.getLastColumn()&&(f[2]=z.row,f[3]=z.col)})}}},{key:"onAfterModifyTransformStart",value:function(f,g,E){if(this.enabled){var D=this.mergedCellsCollection.get(f.row,f.col);if(D){var z=g>0,te=g<0,ge=E<0,Ne=E>0,et=D.row+D.rowspan-1==this.hot.countRows()-1,pt=D.row===0,gt=D.col+D.colspan-1==this.hot.countCols()-1,wt=D.col===0;(z&&et||te&&pt||Ne&&gt||ge&&wt)&&(f.row=D.row,f.col=D.col)}}}},{key:"onAfterDrawSelection",value:function(f,g,E,D){return this.selectionCalculations.getSelectedMergedCellClassName(f,g,E,D)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}])&&Ae(T.prototype,b),w&&Ae(T,w),L}(ee);Object(pe.d)("mergeCells",kt);var sn=kt;function Ct(N){return(Ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T})(N)}function Wt(N,T){for(var b=0;b<T.length;b++){var w=T[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}function Ut(N,T,b){return(Ut=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(w,m,L){var f=function(E,D){for(;!Object.prototype.hasOwnProperty.call(E,D)&&(E=_t(E))!==null;);return E}(w,m);if(f){var g=Object.getOwnPropertyDescriptor(f,m);return g.get?g.get.call(L):g.value}})(N,T,b||N)}function Bt(N,T){return(Bt=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(N,T)}function on(N){var T=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}();return function(){var b,w=_t(N);if(T){var m=_t(this).constructor;b=Reflect.construct(w,arguments,m)}else b=w.apply(this,arguments);return wn(this,b)}}function wn(N,T){return!T||Ct(T)!=="object"&&typeof T!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(N):T}function _t(N){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(T){return T.__proto__||Object.getPrototypeOf(T)})(N)}var It=function(N){(function(f,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(g&&g.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),g&&Bt(f,g)})(L,N);var T,b,w,m=on(L);function L(f){var g;return function(E,D){if(!(E instanceof D))throw new TypeError("Cannot call a class as a function")}(this,L),(g=m.call(this,f)).scrollbars=[],g.clones=[],g.lockedCollection=!1,g.freezeOverlays=!1,g}return T=L,(b=[{key:"isEnabled",value:function(){return Object(ce.isTouchSupported)()}},{key:"enablePlugin",value:function(){var f=this;this.enabled||(this.addHook("afterRender",function(){return f.onAfterRender()}),this.registerEvents(),Ut(_t(L.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Ut(_t(L.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ut(_t(L.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var f=this;this.addHook("beforeTouchScroll",function(){return f.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return f.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var f=this.hot.view.wt.wtOverlays,g=f.topOverlay,E=f.bottomOverlay,D=f.leftOverlay,z=f.topLeftCornerOverlay,te=f.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(g),E.clone&&this.scrollbars.push(E),this.scrollbars.push(D),z&&this.scrollbars.push(z),te&&te.clone&&this.scrollbars.push(te),this.clones.length=0,g.needFullRender&&this.clones.push(g.clone.wtTable.wtRootElement),E.needFullRender&&this.clones.push(E.clone.wtTable.wtRootElement),D.needFullRender&&this.clones.push(D.clone.wtTable.wtRootElement),z&&this.clones.push(z.clone.wtTable.wtRootElement),te&&te.clone&&this.clones.push(te.clone.wtTable.wtRootElement)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Object(C.arrayEach)(this.clones,function(f){Object(Ve.addClass)(f,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var f=this;this.freezeOverlays=!1,Object(C.arrayEach)(this.clones,function(g){Object(Ve.removeClass)(g,"hide-tween"),Object(Ve.addClass)(g,"show-tween")}),setTimeout(function(){Object(C.arrayEach)(f.clones,function(g){Object(Ve.removeClass)(g,"show-tween")})},400),Object(C.arrayEach)(this.scrollbars,function(g){g.redrawClone(),g.adjustElementsPosition()}),this.hot.view.wt.wtOverlays.propagateMasterScrollPositionsToClones()}}])&&Wt(T.prototype,b),w&&Wt(T,w),L}(ee);Object(pe.d)("touchScroll",It);var tn=It},function(ot,S,i){"use strict";var M=i(165),C=i(201),pe=i(184),ie=i(214),X=i(170),F=i(167),ee=i(159),ce=i(160),G={_hooksStorage:Object.create(null),addHook:function(me,Se){return this._hooksStorage[me]||(this._hooksStorage[me]=[]),this.hot.addHook(me,Se),this._hooksStorage[me].push(Se),this},removeHooksByKey:function(me){var Se=this;Object(ce.arrayEach)(this._hooksStorage[me]||[],function(Ie){Se.hot.removeHook(me,Ie)})},clearHooks:function(){var me=this;Object(ee.objectEach)(this._hooksStorage,function(Se,Ie){return me.removeHooksByKey(Ie)}),this._hooksStorage={}}};Object(ee.defineGetter)(G,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var B=G;function V(me){return(V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Se){return typeof Se}:function(Se){return Se&&typeof Symbol=="function"&&Se.constructor===Symbol&&Se!==Symbol.prototype?"symbol":typeof Se})(me)}function P(me,Se){return(P=Object.setPrototypeOf||function(Ie,Le){return Ie.__proto__=Le,Ie})(me,Se)}function x(me){var Se=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(Ie){return!1}}();return function(){var Ie,Le=fe(me);if(Se){var we=fe(this).constructor;Ie=Reflect.construct(Le,arguments,we)}else Ie=Le.apply(this,arguments);return $(this,Ie)}}function $(me,Se){return!Se||V(Se)!=="object"&&typeof Se!="function"?function(Ie){if(Ie===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ie}(me):Se}function fe(me){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(Se){return Se.__proto__||Object.getPrototypeOf(Se)})(me)}function H(me,Se){if(!(me instanceof Se))throw new TypeError("Cannot call a class as a function")}function se(me,Se){for(var Ie=0;Ie<Se.length;Ie++){var Le=Se[Ie];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(me,Le.key,Le)}}var I="STATE_VIRGIN",de="STATE_EDITING",l="STATE_WAITING",K="STATE_FINISHED",ne=function(){function me(we){H(this,me),this.hot=we,this.instance=we,this.state=I,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}var Se,Ie,Le;return Se=me,(Ie=[{key:"_fireCallbacks",value:function(we){this._closeCallback&&(this._closeCallback(we),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(we,Ve,je,Ke,$e,Ye){this.TD=Ke,this.row=we,this.col=Ve,this.prop=je,this.originalValue=$e,this.cellProperties=Ye,this.state=I}},{key:"extend",value:function(){return function(we){(function(Ke,$e){if(typeof $e!="function"&&$e!==null)throw new TypeError("Super expression must either be null or a function");Ke.prototype=Object.create($e&&$e.prototype,{constructor:{value:Ke,writable:!0,configurable:!0}}),$e&&P(Ke,$e)})(je,we);var Ve=x(je);function je(){return H(this,je),Ve.apply(this,arguments)}return je}(this.constructor)}},{key:"saveValue",value:function(we,Ve){var je,Ke;Ve?((je=this.hot.getSelectedLast())[0]>je[2]&&(Ke=je[0],je[0]=je[2],je[2]=Ke),je[1]>je[3]&&(Ke=je[1],je[1]=je[3],je[3]=Ke)):je=[this.row,this.col,null,null],this.hot.populateFromArray(je[0],je[1],we,je[2],je[3],"edit")}},{key:"beginEditing",value:function(we,Ve){if(this.state===I){if(this.hot.view.scrollViewport(new M.a(this.row,this.col)),this.state=de,this.isInFullEditMode()){var je=typeof we=="string"?we:Object(F.stringify)(this.originalValue);this.setValue(je)}this.open(Ve),this._opened=!0,this.focus(),this.hot.view.render(),this.hot.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(we,Ve,je){var Ke,$e=this;if(je){var Ye=this._closeCallback;this._closeCallback=function(Qe){Ye&&Ye(Qe),je(Qe),$e.hot.view.render()}}if(!this.isWaiting())if(this.state!==I){if(this.state===de){if(we)return this.cancelChanges(),void this.hot.view.render();var ht=this.getValue();Ke=this.hot.getSettings().trimWhitespace?[[typeof ht=="string"?String.prototype.trim.call(ht||""):ht]]:[[ht]],this.state=l,this.saveValue(Ke,Ve),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(Qe){$e.state=K,$e.discardEditor(Qe)}):(this.state=K,this.discardEditor(!0))}}else this.hot._registerTimeout(function(){$e._fireCallbacks(!0)})}},{key:"cancelChanges",value:function(){this.state=K,this.discardEditor()}},{key:"discardEditor",value:function(we){this.state===K&&(we===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=de,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=I,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===l}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var we=this.hot.countRows(),Ve="";return this.row<this.hot.getSettings().fixedRowsTop?Ve=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=we-this.hot.getSettings().fixedRowsBottom?Ve=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(Ve="left"),Ve}}])&&se(Se.prototype,Ie),Le&&se(Se,Le),me}();Object(ee.mixin)(ne,B);var le=i(161);function Re(me,Se){for(var Ie=0;Ie<Se.length;Ie++){var Le=Se[Ie];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(me,Le.key,Le)}}var De=function(){function me(we,Ve,je){var Ke=this;(function(Ye,ht){if(!(Ye instanceof ht))throw new TypeError("Cannot call a class as a function")})(this,me),this.instance=we,this.tableMeta=Ve,this.selection=je,this.eventManager=new X.a(we),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",function(Ye){return Ke.onAfterDocumentKeyDown(Ye)});for(var $e=this.instance.rootWindow;$e;)this.eventManager.addEventListener($e.document.documentElement,"keydown",function(Ye){Ke.destroyed||Ke.instance.runHooks("afterDocumentKeyDown",Ye)}),$e=Object(le.getParentWindow)($e);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(Ye){!Ke.destroyed&&Ke.activeEditor&&!Ke.activeEditor.isOpened()&&Ke.instance.isListening()&&Ke.openEditor("",Ye)}),this.instance.view.wt.update("onCellDblClick",function(Ye,ht,Qe){return Ke.onCellDblClick(Ye,ht,Qe)})}var Se,Ie,Le;return Se=me,(Ie=[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(we){this.lock||this.closeEditor(we)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var we=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,function(We){We&&we.prepareEditor()});else{var Ve=this.instance.selection.selectedRange.current().highlight,je=Ve.row,Ke=Ve.col;this.cellProperties=this.instance.getCellMeta(je,Ke);var $e=this.instance.rootDocument.activeElement;if($e&&$e.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var Ye=this.instance.getCellEditor(this.cellProperties),ht=this.instance.getCell(je,Ke,!0);if(Ye&&ht){var Qe=this.instance.colToProp(Ke),ct=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(je),Ke);this.activeEditor=Object(ie.b)(Ye,this.instance),this.activeEditor.prepare(je,Ke,Qe,ht,ct,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(we,Ve){this.activeEditor&&this.activeEditor.beginEditing(we,Ve)}},{key:"closeEditor",value:function(we,Ve,je){this.activeEditor?this.activeEditor.finishEditing(we,Ve,je):je&&je(!1)}},{key:"closeEditorAndSaveChanges",value:function(we){this.closeEditor(!1,we)}},{key:"closeEditorAndRestoreOriginalValue",value:function(we){this.closeEditor(!0,we)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(we){var Ve=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;we?this.selection.transformStart(-Ve.row,-Ve.col):this.selection.transformStart(Ve.row,Ve.col,!0)}},{key:"moveSelectionUp",value:function(we){we?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(we){we?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(we){we?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}},{key:"moveSelectionLeft",value:function(we){we?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}},{key:"onAfterDocumentKeyDown",value:function(we){if(this.instance.isListening()&&(this.instance.runHooks("beforeKeyDown",we),!this.destroyed&&we.keyCode!==229&&!Object(pe.isImmediatePropagationStopped)(we)&&(this.lastKeyCode=we.keyCode,this.selection.isSelected()))){var Ve=(we.ctrlKey||we.metaKey)&&!we.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||Object(C.isMetaKey)(we.keyCode)||Object(C.isCtrlMetaKey)(we.keyCode)||Ve||this.isEditorOpened()){var je,Ke=we.shiftKey,$e=Ke?this.selection.setRangeEnd:this.selection.setRangeStart;switch(we.keyCode){case C.KEY_CODES.A:!this.isEditorOpened()&&Ve&&(this.instance.selectAll(),we.preventDefault(),we.stopPropagation());break;case C.KEY_CODES.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(Ve),this.moveSelectionUp(Ke),we.preventDefault(),we.stopPropagation();break;case C.KEY_CODES.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(Ve),this.moveSelectionDown(Ke),we.preventDefault(),we.stopPropagation();break;case C.KEY_CODES.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(Ve),this.moveSelectionRight(Ke),we.preventDefault(),we.stopPropagation();break;case C.KEY_CODES.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(Ve),this.moveSelectionLeft(Ke),we.preventDefault(),we.stopPropagation();break;case C.KEY_CODES.TAB:je=typeof this.tableMeta.tabMoves=="function"?this.tableMeta.tabMoves(we):this.tableMeta.tabMoves,Ke?this.selection.transformStart(-je.row,-je.col):this.selection.transformStart(je.row,je.col,!0),we.preventDefault(),we.stopPropagation();break;case C.KEY_CODES.BACKSPACE:case C.KEY_CODES.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),we.preventDefault();break;case C.KEY_CODES.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,we),we.preventDefault();break;case C.KEY_CODES.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==l&&this.closeEditorAndSaveChanges(Ve),this.moveSelectionAfterEnter(Ke)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,we)):this.moveSelectionAfterEnter(Ke),we.preventDefault(),Object(pe.stopImmediatePropagation)(we);break;case C.KEY_CODES.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(Ve),this.activeEditor.focus()),we.preventDefault();break;case C.KEY_CODES.HOME:we.ctrlKey||we.metaKey?$e.call(this.selection,new M.a(0,this.selection.selectedRange.current().from.col)):$e.call(this.selection,new M.a(this.selection.selectedRange.current().from.row,0)),we.preventDefault(),we.stopPropagation();break;case C.KEY_CODES.END:we.ctrlKey||we.metaKey?$e.call(this.selection,new M.a(this.instance.countRows()-1,this.selection.selectedRange.current().from.col)):$e.call(this.selection,new M.a(this.selection.selectedRange.current().from.row,this.instance.countCols()-1)),we.preventDefault(),we.stopPropagation();break;case C.KEY_CODES.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),we.preventDefault(),we.stopPropagation();break;case C.KEY_CODES.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),we.preventDefault(),we.stopPropagation()}}else this.openEditor("",we)}}},{key:"onCellDblClick",value:function(we,Ve,je){je.nodeName==="TD"&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,we))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}])&&Re(Se.prototype,Ie),Le&&Re(Se,Le),me}(),He=new WeakMap;De.getInstance=function(me,Se,Ie){var Le=He.get(me);return Le||(Le=new De(me,Se,Ie),He.set(me,Le)),Le},S.a=De},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(ot,S,i){"use strict";i.r(S);var M=i(1),C=i.n(M),pe=function(){return C.a.createElement("div",{className:"developer-screen"},C.a.createElement("h1",{className:"developer-screen--title"},"Handsontable Spreadsheet Viewer"),C.a.createElement("p",null,"Hello, developer!"),C.a.createElement("p",null,"This app is intended to be run:"),C.a.createElement("ul",null,C.a.createElement("li",null,"with URL parameters, as explained in"," ",C.a.createElement("a",{href:"https://github.com/handsontable/spreadsheet-viewer/wiki/Query-String-API",target:"_blank",rel:"noopener noreferrer"},"Query String API")),C.a.createElement("li",null,"or, in an iframe driven by asynchronous messages, as explained in"," ",C.a.createElement("a",{href:"https://github.com/handsontable/spreadsheet-viewer/wiki/JavaScript-API",target:"_blank",rel:"noopener noreferrer"},"JavaScript API"))))},ie=i(62),X=i(209),F=i(263),ee=i(5),ce=i(33),G=i(63),B=i(34),V=i(200);function P(ae){return(P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(oe){return typeof oe}:function(oe){return oe&&typeof Symbol=="function"&&oe.constructor===Symbol&&oe!==Symbol.prototype?"symbol":typeof oe})(ae)}function x(ae,oe){for(var J=0;J<oe.length;J++){var Ce=oe[J];Ce.enumerable=Ce.enumerable||!1,Ce.configurable=!0,"value"in Ce&&(Ce.writable=!0),Object.defineProperty(ae,Ce.key,Ce)}}function $(ae,oe,J){return($=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(Ce,_e,Ue){var Ae=function(Pe,ze){for(;!Object.prototype.hasOwnProperty.call(Pe,ze)&&(Pe=I(Pe))!==null;);return Pe}(Ce,_e);if(Ae){var ke=Object.getOwnPropertyDescriptor(Ae,_e);return ke.get?ke.get.call(Ue):ke.value}})(ae,oe,J||ae)}function fe(ae,oe){return(fe=Object.setPrototypeOf||function(J,Ce){return J.__proto__=Ce,J})(ae,oe)}function H(ae){var oe=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(J){return!1}}();return function(){var J,Ce=I(ae);if(oe){var _e=I(this).constructor;J=Reflect.construct(Ce,arguments,_e)}else J=Ce.apply(this,arguments);return se(this,J)}}function se(ae,oe){return!oe||P(oe)!=="object"&&typeof oe!="function"?function(J){if(J===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return J}(ae):oe}function I(ae){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(oe){return oe.__proto__||Object.getPrototypeOf(oe)})(ae)}var de=function(ae){(function(Ae,ke){if(typeof ke!="function"&&ke!==null)throw new TypeError("Super expression must either be null or a function");Ae.prototype=Object.create(ke&&ke.prototype,{constructor:{value:Ae,writable:!0,configurable:!0}}),ke&&fe(Ae,ke)})(Ue,ae);var oe,J,Ce,_e=H(Ue);function Ue(Ae){var ke;return function(Pe,ze){if(!(Pe instanceof ze))throw new TypeError("Cannot call a class as a function")}(this,Ue),(ke=_e.call(this,Ae)).floatingBoxSettings=[],ke.floatingBoxMeta=new WeakMap,ke.isFirstRender=!0,ke.floatingBoxSettings=[],ke.floatingBoxMeta=new WeakMap,ke.resetState(),ke}return oe=Ue,(J=[{key:"resetState",value:function(){this.floatingBoxSettings=[],this.floatingBoxMeta=new WeakMap}},{key:"getExtendedHotSettings",value:function(){return this.hot.getSettings()}},{key:"isEnabled",value:function(){return!!this.getExtendedHotSettings().floatingBox}},{key:"enablePlugin",value:function(){this.enabled||(this.addHook("afterLoadData",this.afterLoadData.bind(this)),this.addHook("afterUpdateSettings",this.afterUpdateSettings.bind(this)),this.addHook("afterRenderer",this.afterRenderer.bind(this)),this.addHook("beforeRender",this.beforeRender.bind(this)),this.addHook("afterRender",this.afterRender.bind(this)),$(I(Ue.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.resetState(),$(I(Ue.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),$(I(Ue.prototype),"updatePlugin",this).call(this)}},{key:"afterLoadData",value:function(){this.afterUpdateSettings()}},{key:"afterRenderer",value:function(Ae,ke,Pe){var ze=this;this.floatingBoxSettings.forEach(function(it){var At,vt,qt,kt,sn=ze.floatingBoxMeta.get(it);if(sn&&it.topLeftRow<=ke&&it.topLeftColumn<=Pe&&it.bottomRightRow>=ke&&it.bottomRightColumn>=Pe){var Ct=((kt=(qt=(vt=(At=Ae.parentElement)===null||At===void 0?void 0:At.parentElement)===null||vt===void 0?void 0:vt.parentElement)===null||qt===void 0?void 0:qt.parentElement)===null||kt===void 0?void 0:kt.parentElement)||void 0;Ct&&!sn.containerParents.has(Ct)&&sn.containerParents.add(Ct)}})}},{key:"beforeRender",value:function(){var Ae=this;this.floatingBoxSettings.forEach(function(ke){var Pe=Ae.floatingBoxMeta.get(ke);Pe||(Pe={top:void 0,left:void 0,width:void 0,height:void 0,containerParents:new Set,containers:new Map},Ae.floatingBoxMeta.set(ke,Pe))})}},{key:"afterRender",value:function(){var Ae=this;this.isFirstRender&&(this.isFirstRender=!1,this.getExtendedHotSettings().mergeCells.length>0)||this.floatingBoxSettings.length!==0&&(this.floatingBoxSettings.forEach(function(ke){var Pe=Ae.floatingBoxMeta.get(ke);if(Pe&&Pe.containerParents.size>0&&Pe.width===void 0){var ze=Ae.hot.view.wt,it=-ze.getSetting("columnHeaders").length,At=-ze.getSetting("rowHeaders").length;Pe.left=-1+ke.topLeftOffsetX+ze.wtOverlays.leftOverlay.sumCellSizes(it,ke.topLeftColumn),Pe.top=3+ke.topLeftOffsetY+ze.wtOverlays.topOverlay.sumCellSizes(At,ke.topLeftRow);var vt=ze.wtOverlays.leftOverlay.sumCellSizes(ke.topLeftColumn,ke.bottomRightColumn+1);Pe.width=-1+ke.bottomRightOffsetX-ke.topLeftOffsetX+vt;var qt=ze.wtOverlays.topOverlay.sumCellSizes(ke.topLeftRow,ke.bottomRightRow+1);Pe.height=-1+ke.bottomRightOffsetY-ke.topLeftOffsetY+qt}}),this.floatingBoxSettings.forEach(function(ke){var Pe=Ae.floatingBoxMeta.get(ke);Pe&&Pe.containerParents.size>Pe.containers.size&&Pe.containerParents.forEach(function(ze){if(!Pe.containers.has(ze)){var it=function(At,vt,qt){var kt=document.createElement("div");if(kt.classList.add("sv-handsontable-floating-box"),kt.style.left="".concat(vt.left,"px"),kt.style.top="".concat(vt.top,"px"),kt.style.width="".concat(vt.width,"px"),kt.style.height="".concat(vt.height,"px"),qt.appendChild(kt),vt.width===void 0||vt.height===void 0)throw new Error("Could not retrieve sizes of the floating box");return At.renderer(kt,vt.width,vt.height),kt}(ke,Pe,ze);Pe.containers.set(ze,it)}})}))}},{key:"afterUpdateSettings",value:function(){var Ae=this.getExtendedHotSettings();Array.isArray(Ae.floatingBox)?this.floatingBoxSettings=Ae.floatingBox:this.floatingBoxSettings=[]}},{key:"destroy",value:function(){$(I(Ue.prototype),"destroy",this).call(this)}}])&&x(oe.prototype,J),Ce&&x(oe,Ce),Ue}(V.a.plugins.BasePlugin);V.a.plugins.registerPlugin("FloatingBoxPlugin",de);var l=i(9),K=i(276),ne=i.n(K),le=i(46),Re={Arial:"Liberation Sans","Times New Roman":"Liberation Serif","Courier New":"Liberation Mono",Calibri:"Carlito",Cambria:"Caladea"},De={"Liberation Serif":"serif","Liberation Mono":"monospace","Liberation Sans":"sans-serif",Carlito:"sans-serif",Caladea:"sans-serif"},He=new Map,me=1,Se,Ie;function Le(ae){var oe=document.createElement("span");oe.innerHTML=Array(100).join("wi"),oe.style.position="absolute",oe.style.fontSize="128px",oe.style.left="-99999px",oe.style.fontFamily=ae,document.body.appendChild(oe);var J=oe.clientWidth;if(document.body.removeChild(oe),J<1)throw new Error("Could not measure the text size. Maybe you called too early?");return J}var we=new Map,Ve=function(){(me-=1)===0&&(document.body.dataset.webfontsLoaded="")};function je(ae,oe,J){var Ce=[],_e=Object(le.b)(Re,ae,void 0);if(function(ke){if(Se===void 0&&(Se=Le("sans-serif")),Ie===void 0&&(Ie=Le("serif")),we.has(ke))return we.get(ke);var Pe=Le("".concat(ke,", sans-serif")),ze=Le("".concat(ke,", serif")),it=!(Se===Pe&&Ie===ze);return we.set(ke,it),it}(ae))Ce.push('"'.concat(ae,'"'));else if(_e){Ce.push('"'.concat(_e,'"')),Ce.push('"'.concat(function(ke){return Object(le.b)(De,ke,"sans-serif")}(_e),'"'));var Ue="".concat(_e," ").concat(oe," ").concat(J);if(!He.has(Ue)){(me+=1)===1&&delete document.body.dataset.webfontsLoaded;var Ae=function(ke,Pe,ze){return new ne.a(ke,{weight:Pe,style:ze}).load(null,1e4)}(_e,oe,J).then(function(){console.log("Font loaded",_e,oe,J),Ve()}).catch(function(){console.log("Font failed to load",_e,oe,J),Ve()});He.set(Ue,Ae)}}else Ce.push('"'.concat("Arial",'"')),Ce.push('"'.concat("sans-serif",'"'));return Ce.join(", ")}Ve();var Ke,$e=i(64),Ye=i(221),ht=function(ae,oe,J,Ce){return new(J||(J=Promise))(function(_e,Ue){function Ae(ze){try{Pe(Ce.next(ze))}catch(it){Ue(it)}}function ke(ze){try{Pe(Ce.throw(ze))}catch(it){Ue(it)}}function Pe(ze){var it;ze.done?_e(ze.value):(it=ze.value,it instanceof J?it:new J(function(At){At(it)})).then(Ae,ke)}Pe((Ce=Ce.apply(ae,oe||[])).next())})};(function(ae){ae.CHART="chart",ae.IMAGE="image"})(Ke||(Ke={}));var Qe=i(255),ct=i(68),We=function(ae,oe){return ae.type===Ke.IMAGE?function(J){return function(Ce,_e,Ue){Ce.classList.add("sv-handsontable-image"),Object($e.render)(M.createElement("img",{src:J.imageData,alt:"",style:{width:_e,height:Ue}}),Ce)}}(ae):Object(ct.a)()?function(J,Ce){return function(_e,Ue,Ae){var ke=this;Object(Ye.b)(),ht(ke,void 0,void 0,regeneratorRuntime.mark(function Pe(){return regeneratorRuntime.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,Promise.all([i.e(6),i.e(3)]).then(i.bind(null,311));case 2:ze.sent.getChartRenderer(J,Ce)(_e,Ue,Ae);case 5:case"end":return ze.stop()}},Pe)}))}}(ae,oe):function(J,Ce,_e){J.classList.add("sv-handsontable-chart"),Object($e.render)(C.a.createElement(Qe.a,null),J)}},Ze=function(ae){return ae===null},at=i(65),ut=["$","\u20BF","\xA3","\xA4","\xA5","\u20B1","\u20AD","\u20A6","\u20AE","\u20AC","\u0E3F","\u20A1","\u20B2","\u20AA","\u20B9","\u20BA","Ar","B/.","Br","Bs.","Bs.S.","BTC","C$","CHF","EC$","HK$","kr","Ksh","L","MOP","Nfk","NT$","P","Q","R","R$","RF","RM","Rp","Rs","Rs.","S","S/","US$","XBT","XDR","\u0930\u0942","\u0DBB\u0DD4","\u1265\u122D","AED","ADP","AFA","AFN","ALL","AMD","ANG","AOA","ARS","ATS","AUD","AWG","AZM","AZN","BAM","BBD","BDT","BEF","BGN","BGL","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTC","BTN","BWP","BYB","BYR","BYN","BZD","CAD","CDF","CHE","CHW","CLF","CLN","CLP","CNY","COP","COU","CSD","CRC","CUC","CUP","CVE","CYP","CZK","DJF","DEM","DKK","DOP","DZD","ECS","ECV","EEK","ESP","EGP","ERN","ETB","ETH","EUR","FJD","FIM","FKP","FRF","GBP","GEL","GGP","GHC","GHS","GIP","GMD","GNF","GTQ","GYD","GRD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","IEP","IMP","INR","IQD","IRR","ILS","IQD","ISK","ITL","JEP","JMD","JOD","JPY","KAF","KES","KGS","KHR","KMF","KPW","KRW","KPW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LTC","LTL","LVL","LYD","MAD","MDL","MGA","MGF","MKD","MMK","MNT","MOP","MRO","MRU","MUR","MVR","MWK","MXN","MYR","MZN","MZM","NAD","NGN","NIO","NOK","NLG","NPR","NTD","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","PTE","QAR","RMB","RON","ROL","RSD","RUB","RUR","RWF","SAR","SBD","SCR","SDD","SDP","SDG","SEK","SGD","SHP","SLL","SKK","SIT","SOS","SRD","SSP","SPL","STD","STN","SVC","SYP","SZL","THB","TJS","TJR","TMT","TND","TMM","TOP","TRL","TRY","TTD","TVD","TWD","TZS","UAH","UGX","USD","USN","USS","UYU","UYI","UZS","VEB","VEF","VES","VND","VUV","WST","XAF","XAG","XBT","XAU","XCD","XOF","XB5","XBA","XBB","XBC","XBD","XDR","XFO","XFU","XPD","XPF","XPT","XTS","XXX","YER","YUM","ZAR","ZWD","ZWL","ZWN","ZWR"];function be(ae,oe){return function(J){if(Array.isArray(J))return J}(ae)||function(J,Ce){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(J)))){var _e=[],Ue=!0,Ae=!1,ke=void 0;try{for(var Pe,ze=J[Symbol.iterator]();!(Ue=(Pe=ze.next()).done)&&(_e.push(Pe.value),!Ce||_e.length!==Ce);Ue=!0);}catch(it){Ae=!0,ke=it}finally{try{Ue||ze.return==null||ze.return()}finally{if(Ae)throw ke}}return _e}}(ae,oe)||function(J,Ce){if(!!J){if(typeof J=="string")return Z(J,Ce);var _e=Object.prototype.toString.call(J).slice(8,-1);if(_e==="Object"&&J.constructor&&(_e=J.constructor.name),_e==="Map"||_e==="Set")return Array.from(J);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return Z(J,Ce)}}(ae,oe)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Z(ae,oe){(oe==null||oe>ae.length)&&(oe=ae.length);for(var J=0,Ce=new Array(oe);J<oe;J++)Ce[J]=ae[J];return Ce}var he,O={viewportRowRenderingOffset:1e4,viewportColumnRenderingOffset:256},re=function(ae){return ae/9525},Oe=function(ae,oe){return ae/9525-oe},Ee=function(ae,oe){var J=ae/9525-oe;return-Math.round(Math.abs(J))};function ve(){Object(ee.c)(ee.a.presentationHotRendering)}function Ge(){this.getSettings().showGrid||this.rootElement.classList.add("sv-hide-gridlines")}(function(ae){ae.General="general",ae.Accounting="accounting",ae.Currency="currency"})(he||(he={}));var Je=["color","fontSize","lineHeight","textDecoration","textShadow","overflow","textAlign","verticalAlign","direction","wordBreak","whiteSpace","display"],ft=function(ae){var oe,J,Ce=ae.patternType==="solid",_e=Object.assign({backgroundColor:Ce&&ae.fgColor?"#".concat(ae.fgColor.rgb):"",fontFamily:(oe=ae.fontFamily)!==null&&oe!==void 0?oe:"",fontStyle:(J=ae.fontStyle)!==null&&J!==void 0?J:"",borderRightColor:Ce&&!Ze(ae.border)?"transparent":"",borderBottomColor:Ce&&!Ze(ae.border)?"transparent":""},ae.fontFamily?function(){var Ue,Ae=function(Pe){if(typeof Pe=="number")return Pe;if(Pe===void 0)return 400;var ze=parseInt(Pe,10);return ze||(Pe==="bold"?700:400)}(ae.fontWeight||400),ke=(Ue=ae.fontStyle)!==null&&Ue!==void 0?Ue:"normal";return{fontWeight:Ae,fontStyle:ke,fontFamily:je(ae.fontFamily,Ae,ke)}}():{});return Je.forEach(function(Ue){ae[Ue]&&(_e[Ue]=ae[Ue])}),_e},tt=function(ae){var oe=ae.s,J=ae.e,Ce=J.r-oe.r,_e=J.c-oe.c;return Ce>=0&&(Ce+=1),_e>=0&&(_e+=1),{row:oe.r,col:oe.c,rowspan:Ce,colspan:_e,mergedColumn:Ce>1e4,mergedRow:_e>256}};function yt(ae,oe,J,Ce,_e,Ue,Ae){oe.firstElementChild||function(_t){var It=document.createElement("div"),tn=document.createElement("div");tn.className="sv-cell-text-wrapper__currency";var N=document.createElement("div");N.className="sv-cell-text-wrapper__value",It.appendChild(tn),It.appendChild(N),_t.appendChild(It)}(oe);var ke=oe.firstElementChild,Pe=ke==null?void 0:ke.firstElementChild,ze=ke==null?void 0:ke.lastElementChild;ke.removeAttribute("style"),ke.className="sv-cell-text-wrapper";var it=j(J,Ce);if(!Ae.svMultiRowCells.has(it)&&Array.isArray(Ae.rowHeights)){var At=Ae.rowHeights[J],vt=Number(At)-1,qt=Ae.horizontalOverlap.styleMap;if(ke.style.maxHeight="".concat(vt,"px"),Ae.cellClassName){var kt=qt[Ae.cellClassName].lineHeight;if(kt){var sn=parseInt(kt,10);ke.style.lineHeight="".concat(Math.min(vt,sn),"px ")}}}var Ct=Ae.horizontalOverlap.obscuredNonText.get(it),Wt=Ae.numberFormat;(function(_t){return(_t==null?void 0:_t.format)===he.Accounting&&_t.currencySymbol&&_t.currencyValue})(Ae.numberFormat)&&!Ct?(ke.classList.add("sv-cell-text-wrapper--accounting"),V.a.dom.fastInnerText(Pe," ".concat(Wt.currencySymbol," ")),V.a.dom.fastInnerText(ze,Wt.currencyValue)):V.a.dom.fastInnerText(ze,Ct||Ue||"");var Ut=Ae.rowClassNames.get(J);Ut&&oe.classList.add(Ut);var Bt=Ae.columnClassNames.get(Ce);Bt&&oe.classList.add(Bt),Ae.cellClassName&&oe.classList.add(Ae.cellClassName);var on=Ae.horizontalOverlap,wn=on.overlapStartCells.get(it);return wn&&(ke.classList.add("sv-handsontable-horizontal-overlay"),Object.assign(ke.style,wn)),on.hideRightGridlineTds.has(it)&&oe.classList.add("sv-handsontable-hide-right-gridline"),oe}var bt=function(ae,oe,J){var Ce={row:oe,col:J};return["left","right","bottom","top"].forEach(function(_e){var Ue,Ae=ae[_e];(Ae==null?void 0:Ae.width)&&(Ce[_e]={width:(Ue=Ae.width,Ue==="thin"?1:Ue==="medium"?2:Ue==="thick"?3:1),color:"#".concat(Ae.color||"000")})}),Ce},Ot=function(ae,oe,J){if(!ae||oe==="General")return he.General;var Ce=ae.trim()!==ae;return J==="n"&&Ce?he.Accounting:J!=="n"||Ce?he.General:he.Currency},Jt=function(ae,oe){if(oe===he.Accounting&&ae){var J,Ce,_e=ae.search(/[-\\(0-9]/);if(_e>0){var Ue=be((Ce=_e,[(J=ae).substring(0,Ce),J.substring(Ce)]),2),Ae=Ue[0],ke=Ue[1],Pe=Ae.trim();if(ut.includes(Pe))return{currencySymbol:Pe,currencyValue:ke}}}},Gt=function(ae,oe,J){return Math.min(J,Math.max(oe,ae))};function Qt(ae){return(Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(oe){return typeof oe}:function(oe){return oe&&typeof Symbol=="function"&&oe.constructor===Symbol&&oe!==Symbol.prototype?"symbol":typeof oe})(ae)}function rn(ae,oe){return function(J){if(Array.isArray(J))return J}(ae)||function(J,Ce){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(J)))){var _e=[],Ue=!0,Ae=!1,ke=void 0;try{for(var Pe,ze=J[Symbol.iterator]();!(Ue=(Pe=ze.next()).done)&&(_e.push(Pe.value),!Ce||_e.length!==Ce);Ue=!0);}catch(it){Ae=!0,ke=it}finally{try{Ue||ze.return==null||ze.return()}finally{if(Ae)throw ke}}return _e}}(ae,oe)||function(J,Ce){if(!!J){if(typeof J=="string")return an(J,Ce);var _e=Object.prototype.toString.call(J).slice(8,-1);if(_e==="Object"&&J.constructor&&(_e=J.constructor.name),_e==="Map"||_e==="Set")return Array.from(J);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return an(J,Ce)}}(ae,oe)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function an(ae,oe){(oe==null||oe>ae.length)&&(oe=ae.length);for(var J=0,Ce=new Array(oe);J<oe;J++)Ce[J]=ae[J];return Ce}function mn(ae,oe){if(!(ae instanceof oe))throw new TypeError("Cannot call a class as a function")}function W(ae,oe){for(var J=0;J<oe.length;J++){var Ce=oe[J];Ce.enumerable=Ce.enumerable||!1,Ce.configurable=!0,"value"in Ce&&(Ce.writable=!0),Object.defineProperty(ae,Ce.key,Ce)}}function R(ae,oe,J){return(R=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(Ce,_e,Ue){var Ae=function(Pe,ze){for(;!Object.prototype.hasOwnProperty.call(Pe,ze)&&(Pe=v(Pe))!==null;);return Pe}(Ce,_e);if(Ae){var ke=Object.getOwnPropertyDescriptor(Ae,_e);return ke.get?ke.get.call(Ue):ke.value}})(ae,oe,J||ae)}function U(ae,oe){return(U=Object.setPrototypeOf||function(J,Ce){return J.__proto__=Ce,J})(ae,oe)}function s(ae){var oe=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(J){return!1}}();return function(){var J,Ce=v(ae);if(oe){var _e=v(this).constructor;J=Reflect.construct(Ce,arguments,_e)}else J=Ce.apply(this,arguments);return u(this,J)}}function u(ae,oe){return!oe||Qt(oe)!=="object"&&typeof oe!="function"?function(J){if(J===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return J}(ae):oe}function v(ae){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(oe){return oe.__proto__||Object.getPrototypeOf(oe)})(ae)}var k,j=function(ae,oe){return"".concat(ae,",").concat(oe)},q=new Map,y=new Map,_=function(){q.clear(),y.clear(),k=function(ae){if(document.getElementById(ae))throw new Error("measuringContainer already exists");var oe=document.createElement("div");return oe.setAttribute("id",ae),document.body.appendChild(oe),oe}("sv-handsontable-horizontal-overlay-measuring")},Y=function(ae,oe){var J="".concat(ae,"|").concat(oe),Ce=y.get(J);if(Ce!==void 0)return Ce;var _e=q.get(oe);_e||(_e=function(Ae){var ke=document.createElement("canvas");if(k===void 0)throw new Error("measuringContainer doesn't exist");k.appendChild(ke);var Pe=ke.getContext("2d");if(Pe===null)throw new Error("Failed to obtain CanvasRenderingContext2D");return Pe.font=Ae,Pe}(oe),q.set(oe,_e));var Ue=_e.measureText(ae).width;return y.set(J,Ue),Ue},ue=function(ae){(function(Ae,ke){if(typeof ke!="function"&&ke!==null)throw new TypeError("Super expression must either be null or a function");Ae.prototype=Object.create(ke&&ke.prototype,{constructor:{value:Ae,writable:!0,configurable:!0}}),ke&&U(Ae,ke)})(Ue,ae);var oe,J,Ce,_e=s(Ue);function Ue(){return mn(this,Ue),_e.apply(this,arguments)}return oe=Ue,(J=[{key:"resetState",value:function(){this.measureAllCells()}},{key:"getExtendedHotSettings",value:function(){return this.hot.getSettings()}},{key:"isEnabled",value:function(){return!!this.getExtendedHotSettings().horizontalOverlap}},{key:"enablePlugin",value:function(){this.enabled||(this.addHook("init",this.onInit.bind(this)),R(v(Ue.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.resetState(),R(v(Ue.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),R(v(Ue.prototype),"updatePlugin",this).call(this)}},{key:"onInit",value:function(){this.resetState()}},{key:"createCustomBordersMap",value:function(Ae){for(var ke=new Map,Pe=0;Pe<Ae.length;Pe++){var ze=Ae[Pe],it=ze.row,At=ze.col,vt=j(it,At);ke.set(vt,Ae[Pe])}return ke}},{key:"measureAllCells",value:function(){var Ae,ke=this,Pe=this.getExtendedHotSettings(),ze=Pe.customBorders,it=Pe.horizontalOverlap,At=this.createCustomBordersMap(ze),vt=this.hot.getData(),qt=vt[0].length;_(),it.startCells.forEach(function(kt){var sn=rn(kt.split(",").map(function(Bt){return parseInt(Bt,10)}),2),Ct=sn[0],Wt=sn[1],Ut=vt[Ct];ke.performTextOverlapping(Ct,Wt,qt,Ut,At)}),(Ae=k==null?void 0:k.parentElement)===null||Ae===void 0||Ae.removeChild(k)}},{key:"hideBorderLeftEdge",value:function(Ae,ke,Pe){var ze=j(ke,Pe),it=Ae.get(ze);it&&this.hideBorderEdge(it.left)}},{key:"hideBorderRightEdge",value:function(Ae,ke,Pe){var ze=j(ke,Pe),it=Ae.get(ze);it&&this.hideBorderEdge(it.right)}},{key:"hideBorderEdge",value:function(Ae){Ae&&!Ae.hide&&(Ae.hide=!0)}},{key:"obscureString",value:function(Ae){return Array(Ae.length).fill("#").join("")}},{key:"performTextOverlapping",value:function(Ae,ke,Pe,ze,it){var At="left",vt=!1,qt=0,kt=this.getCellProperties(Ae,ke),sn=this.getExtendedHotSettings(),Ct=sn.columns,Wt=sn.colWidths,Ut=sn.rowHeights,Bt=sn.horizontalOverlap,on=Bt.stopCells.has(j(Ae,ke-1)),wn=Bt.stopCells.has(j(Ae,ke+1));if(!(kt.isTextContent&&on&&wn)){var _t=kt.cellClassName||"",It=Bt.styleMap[_t];if(It&&(It.textAlign&&(At=It.textAlign),It.indent&&(qt=9*It.indent),It.wordBreak==="break-word"&&(vt=!0)),kt.isTextContent){if(vt)return;if(At==="right"){if(ke===0||on)return}else if(wn)return}var tn=j(Ae,ke);if(!Array.isArray(Wt))throw new Error("colWidths must be an Array");if(!Array.isArray(Ut))throw new Error("rowHeights must be an Array");var N=Wt[ke],T=It?"".concat(It.fontStyle||""," ").concat(It.fontWeight||""," ").concat(It.fontStretch||""," ").concat(It.fontSize," ").concat(It.fontFamily):"",b=ze[ke];if(b===null)throw new Error("rowData[".concat(ke,"] must be a string"));var w=Y(b,T)+qt;if(w){var m=w+5;if(m>N){if(!kt.isTextContent)return void Bt.obscuredNonText.set(tn,this.obscureString(b));var L=0,f=N,g=!1;At==="right"&&(g=!0);for(var E=ke-1,D=ke+1;f<m;){if(g){if(E<0||Bt.stopCells.has(j(Ae,E)))break;var z=Wt[E];f+=Number(z),L-=Number(z),Bt.hideRightGridlineTds.add(j(Ae,E)),this.hideBorderLeftEdge(it,Ae,E+1),this.hideBorderRightEdge(it,Ae,E),E-=1}else{if(D===Pe){Ct.length===Pe&&(Ct.length=Pe+1,Wt[Pe]=0,this.hot.initIndexMappers());var te=m-f+4;Wt[Pe]<te&&(Wt[Pe]=te)}if(Bt.stopCells.has(j(Ae,D)))break;var ge=Wt[D];f+=Number(ge),Bt.hideRightGridlineTds.add(j(Ae,D-1)),this.hideBorderLeftEdge(it,Ae,D),this.hideBorderRightEdge(it,Ae,D-1),D+=1}At==="center"&&(g=!g)}var Ne=Number(Ut[Ae])-1;Bt.overlapStartCells.set(tn,{left:"".concat(L,"px"),width:"".concat(f-4-1,"px"),height:"".concat(Ne,"px")})}}}}},{key:"getCellProperties",value:function(Ae,ke){return this.hot.getCellMeta(Ae,ke)}},{key:"destroy",value:function(){R(v(Ue.prototype),"destroy",this).call(this)}}])&&W(oe.prototype,J),Ce&&W(oe,Ce),Ue}(V.a.plugins.BasePlugin);V.a.plugins.registerPlugin("HorizontalOverlapPlugin",ue);var Te=i(4);function Fe(ae,oe){return function(J){if(Array.isArray(J))return J}(ae)||function(J,Ce){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(J)))){var _e=[],Ue=!0,Ae=!1,ke=void 0;try{for(var Pe,ze=J[Symbol.iterator]();!(Ue=(Pe=ze.next()).done)&&(_e.push(Pe.value),!Ce||_e.length!==Ce);Ue=!0);}catch(it){Ae=!0,ke=it}finally{try{Ue||ze.return==null||ze.return()}finally{if(Ae)throw ke}}return _e}}(ae,oe)||function(J,Ce){if(!!J){if(typeof J=="string")return Xe(J,Ce);var _e=Object.prototype.toString.call(J).slice(8,-1);if(_e==="Object"&&J.constructor&&(_e=J.constructor.name),_e==="Map"||_e==="Set")return Array.from(J);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return Xe(J,Ce)}}(ae,oe)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Xe(ae,oe){(oe==null||oe>ae.length)&&(oe=ae.length);for(var J=0,Ce=new Array(oe);J<oe;J++)Ce[J]=ae[J];return Ce}var lt=function(ae){var oe=ae.children,J=ae.holdDownChildRenderPromise,Ce=Fe(Object(M.useState)(),2),_e=Ce[0],Ue=Ce[1];return Object(M.useEffect)(function(){var Ae=!0;return J?J.then(function(){Ae&&Ue(oe)}):Ue(oe),function(){Ae=!1}},[oe,J]),C.a.createElement(C.a.Fragment,null,_e)};function dt(ae){return(dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(oe){return typeof oe}:function(oe){return oe&&typeof Symbol=="function"&&oe.constructor===Symbol&&oe!==Symbol.prototype?"symbol":typeof oe})(ae)}function Pt(ae,oe){if(!(ae instanceof oe))throw new TypeError("Cannot call a class as a function")}function rt(ae,oe){for(var J=0;J<oe.length;J++){var Ce=oe[J];Ce.enumerable=Ce.enumerable||!1,Ce.configurable=!0,"value"in Ce&&(Ce.writable=!0),Object.defineProperty(ae,Ce.key,Ce)}}function Xt(ae,oe){return(Xt=Object.setPrototypeOf||function(J,Ce){return J.__proto__=Ce,J})(ae,oe)}function en(ae){var oe=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(J){return!1}}();return function(){var J,Ce=Cn(ae);if(oe){var _e=Cn(this).constructor;J=Reflect.construct(Ce,arguments,_e)}else J=Ce.apply(this,arguments);return Kt(this,J)}}function Kt(ae,oe){return!oe||dt(oe)!=="object"&&typeof oe!="function"?function(J){if(J===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return J}(ae):oe}function Cn(ae){return(Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(oe){return oe.__proto__||Object.getPrototypeOf(oe)})(ae)}var yn=function(ae){return function(oe,J,Ce,_e){Object(ce.c)(ae,[oe,J,Ce,_e])}},bn=function(ae){(function(Ae,ke){if(typeof ke!="function"&&ke!==null)throw new TypeError("Super expression must either be null or a function");Ae.prototype=Object.create(ke&&ke.prototype,{constructor:{value:Ae,writable:!0,configurable:!0}}),ke&&Xt(Ae,ke)})(Ue,ae);var oe,J,Ce,_e=en(Ue);function Ue(){return Pt(this,Ue),_e.apply(this,arguments)}return oe=Ue,(J=[{key:"componentDidCatch",value:function(Ae){throw new Te.k(Ae==null?void 0:Ae.message)}},{key:"render",value:function(){return this.props.children}}])&&rt(oe.prototype,J),Ce&&rt(oe,Ce),Ue}(M.PureComponent),On=function(ae){var oe=ae.parsedData,J=ae.sheet,Ce=ae.shouldSimulateHandsontableError,_e=ae.shouldSimulateInterpreterError,Ue=ae.requestMessageOnError,Ae=ae.fullPage,ke=ae.svId,Pe=Object(M.useRef)(),ze=Object(at.b)();Object(G.a)(B.f,B.c,Ue,function(Ct){var Wt,Ut=Ct.range;(Wt=Pe.current)===null||Wt===void 0||Wt.selectCells([Ut])});var it=function(Ct){Pe.current=Ct==null?void 0:Ct.hotInstance},At=Object(M.useMemo)(function(){Object(Ye.c)();try{if(Object(ee.c)(ee.a.interpreter),_e)throw new Error("This is a simulation of an error in the interpreter");Object(ee.c)(ee.a.interpreterStyleClone);var Ct=JSON.parse(JSON.stringify(oe.styleMap));Object(ee.b)(ee.a.interpreterStyleClone),Object(ee.c)(ee.a.interpreterCss);var Wt=(wn=Ct,Object.entries(wn).map(function(_t){var It=be(_t,2),tn=It[0],N=It[1],T=document.createElement("style");document.head.appendChild(T);var b=T.sheet,w=tn.includes("cell")?4:3,m=new Array(w).fill(".".concat(tn)).join("");b.insertRule("".concat(m," {}"),0);var L=b.cssRules[0],f=ft(N);Object.assign(L.style,f),Object.assign(N,f);var g=L.cssText;if(document.head.removeChild(T),N.indent&&N.indent>0){var E=N.indent,D=9*Number(E),z=N.textAlign==="left"?"padding-left":"padding-right";g+=`
        .handsontable td.`.concat(tn,` .sv-cell-text-wrapper {
          `).concat(z,": ").concat(D,`px;
         }
        `)}return g+=function(te,ge){switch(te.textAlign){case"right":return`
      .handsontable td.`.concat(ge,` .sv-cell-text-wrapper {
        margin-right: `).concat(4,`px;
        justify-content: flex-end;
        }
    `);case"center":return`
      .handsontable td.`.concat(ge,` .sv-cell-text-wrapper {
        justify-content: center;
        min-width: 100%;
        }
    `);default:return`
    .handsontable td.`.concat(ge,` .sv-cell-text-wrapper {
      margin-left: `).concat(4,`px;
      justify-content: flex-start;
      }
  `)}}(N,tn),N.wordBreak==="break-word"?g+=function(te,ge){var Ne="";switch(te.verticalAlign){case"top":Ne=`
        position: absolute;
        top: 0;
        align-items: flex-start;
      `;break;case"bottom":Ne=`
        position: absolute;
        bottom: 0;
        align-items: flex-end;
      `;break;default:Ne=`
        position: relative;
        align-items: center;
      `}return`
    .handsontable td.`.concat(ge,` {
      position: relative;
    }
    .handsontable td.`).concat(ge,` .sv-cell-text-wrapper {
      display: flex;
      white-space: pre-wrap;
      `).concat(Ne,`
    }
  `)}(N,tn):g+=function(te,ge){var Ne="";switch(te.verticalAlign){case"top":Ne=`
        align-items: flex-start;
      `;break;case"bottom":Ne=`
        align-items: flex-end;
      `;break;default:Ne=`
        align-items: center;
      `}return`
    .handsontable td.`.concat(ge,` .sv-handsontable-horizontal-overlay {
      `).concat(Ne,`
    }
  `)}(N,tn),g}).join(" "));Object(ee.b)(ee.a.interpreterCss),Object(ee.c)(ee.a.interpreterHotConfig);var Ut=Object.values(oe.sheetsData)[J];if(!Ut)throw new Error("Could not retrieve parsed data for the given sheet number (".concat(J,")"));var Bt=Ut.data;if(!Bt)throw new Error("Could not retrieve parsed data for the given sheet (".concat(Ut.title,")"));var on=function(_t,It){var tn,N;if(!_t||_t.hidden)return{};for(var T=new Map,b={data:[],cell:[],afterLoadData:ve,afterInit:Ge,readOnly:!0,colHeaders:!0,rowHeaders:!0,licenseKey:"non-commercial-and-evaluation",showGrid:!0,cells:function(){return{renderer:yt}},beforePaste:function(){return!1},columns:[],mergeCells:[],colWidths:[],rowHeights:[],fixedRowsTop:0,fixedColumnsLeft:0,fillHandle:!1,customBorders:new Array,floatingBox:[],selectionMode:"range",selectionStyle:{cell:{borderWidth:2,borderColor:"rgb(16, 74, 204)"},area:{borderWidth:1,borderColor:"rgb(16, 74, 204)"}},horizontalOverlap:{startCells:new Set,stopCells:new Set,styleMap:It,overlapStartCells:new Map,hideRightGridlineTds:new Set,obscuredNonText:new Map},svMultiRowCells:new Set,rowClassNames:new Map,columnClassNames:new Map,beforeInitWalkontable:function(hn){hn.externalRowCalculator=!0}},w=_t[l.b],m=w.columns.wpx,L=w.rows.hpx,f=-1,g=-1,E=0,D=Object.entries(_t);E<D.length;E++){var z=be(D[E],2),te=z[0],ge=z[1];switch(te){case l.c:ge.forEach(function(hn){var er=hn.s,vn=hn.e,Ln=tt({s:er,e:vn});b.mergeCells.push(Ln);var Pn=Ln.mergedColumn||Ln.mergedRow,Nn=er.c,or=er.r,tr=Math.min(255,vn.c),Wn=Math.min(9999,vn.r);if(tr>f&&!Pn&&(f=tr),Wn>g&&!Pn&&(g=Wn),or<Wn){var Ur=j(or,Nn);b.svMultiRowCells.add(Ur)}for(var hr=or;hr<=Wn;hr++)for(var dr=Nn;dr<=tr;dr++){var Rr=j(hr,dr);b.horizontalOverlap.stopCells.add(Rr),b.horizontalOverlap.startCells.delete(Rr)}});break;case l.a:var Ne=ge;Ne.length>256&&(Ne.length=256);for(var et=0;et<Ne.length;et++){var pt=Ne[et];b.colWidths[et]=(pt==null?void 0:pt.wpx)||m,(pt==null?void 0:pt.svStyleId)&&b.columnClassNames.set(et,pt.svStyleId),(pt==null?void 0:pt.hidden)&&b.fixedColumnsLeft&&b.fixedColumnsLeft>0&&et<b.fixedColumnsLeft&&(console.log("This sheet contains an unsupported hidden column inside a frozen pane. To avoid potentially incorrect rendering, we have disabled the frozen pane on the left."),b.fixedColumnsLeft=0)}break;case l.e:var gt=ge;gt.length>1e4&&(gt.length=1e4);for(var wt=0;wt<gt.length;wt++){var Rt=gt[wt],zt=Rt==null?void 0:Rt.hpx;b.rowHeights[wt]=zt||L,(Rt==null?void 0:Rt.svStyleId)&&b.rowClassNames.set(wt,Rt.svStyleId),(Rt==null?void 0:Rt.hidden)&&b.fixedRowsTop&&b.fixedRowsTop>0&&wt<b.fixedRowsTop&&(console.log("This sheet contains an unsupported hidden row inside a frozen pane. To avoid potentially incorrect rendering, we have disabled the frozen pane on top."),b.fixedRowsTop=0)}break;case l.h:Object(at.b)()||(b.fixedColumnsLeft=parseInt(ge,10));break;case l.i:Object(at.b)()||(b.fixedRowsTop=parseInt(ge,10));break;case l.f:ge!==!1&&ge!==0||(b.showGrid=!1);break;case l.d:ge.forEach(function(hn){if(hn&&hn.anchor&&hn.type){var er,vn=hn.anchor,Ln=typeof vn.dxL=="number",Pn=parseInt(vn.colR,10),Nn=parseInt(vn.rwB,10),or=b.colWidths[Pn]===void 0?m:b.colWidths[Pn],tr=b.rowHeights[Nn]===void 0?L:b.rowHeights[Nn],Wn={topLeftRow:parseInt(vn.rwT,10),topLeftColumn:parseInt(vn.colL,10),bottomRightColumn:Pn,bottomRightRow:Nn,topLeftOffsetX:Ln?0:(er=parseInt(vn.dxL,10),er/9525),topLeftOffsetY:Ln?0:re(parseInt(vn.dyT,10)),bottomRightOffsetX:Ln?0:Oe(parseInt(vn.dxR,10),or),bottomRightOffsetY:Ln?0:Ee(parseInt(vn.dyB,10),tr),renderer:We(hn,_t)};b.floatingBox.push(Wn),Pn>f&&(f=Pn),Nn>g&&(g=Nn)}else console.warn("Skipping an embedded object of an unsupported type")});break;default:if(!ge)break;var ln=te.match(/^([a-zA-Z]+)([0-9]+)/);if(!ln||!ln[1]||!ln[2]||Number(ln[2])>1e4)break;var Ft=Number(ln[2])-1,nn=V.a.helper.spreadsheetColumnIndex(ln[1]);if(nn+1>256)break;var fn=ge,cr=b.data&&b.data[Ft]?b.data[Ft]:[],Mr=!1,An=!1;if(fn.svStyleId){var fr=It[fn.svStyleId],vr=fr.border,Fr=fr.wordBreak;if(vr){Mr=!0;var Ar=bt(vr,Ft,nn);b.customBorders.push(Ar)}An=Fr===void 0}var Jn=fn.w||fn.v||"";An&&typeof Jn=="string"&&(Jn=Jn.replace(/[\r\n]+/gm,""));var Xn=!!Jn;if((Xn||Mr)&&(cr[nn]=Jn,b.data&&(b.data[Ft]=cr),nn>f&&(f=nn),Ft>g&&(g=Ft),Xn)){var yr=j(Ft,nn);b.horizontalOverlap.stopCells.add(yr),b.horizontalOverlap.startCells.add(yr)}var br=Ot(fn.w,fn.z,fn.t),wr=Jt(fn.w,br),Cr={row:Ft,col:nn,cellClassName:fn.svStyleId,isTextContent:fn.isTextContent,numberFormat:Object.assign({format:br},wr&&Object.assign({},wr))};T.set(j(Ft,nn),fn),(tn=b.cell)===null||tn===void 0||tn.push(Cr)}}var Kn=Gt(f+1,6,256),Tn=Gt(g+1,20,1e4);if(b.mergeCells=b.mergeCells.map(function(hn){return Object.assign(Object.assign({},hn),{rowspan:Math.min(Tn-hn.row,hn.rowspan),colspan:Math.min(Kn-hn.col,hn.colspan)})}),b.data){if(b.data.length>Tn)b.data.splice(Tn);else if(b.data.length<Tn){var Nr=b.data.length;b.data.length=Tn,b.data.fill([],Nr,Tn)}}if(b.rowHeights.length<Tn){var Vr=b.rowHeights.length;b.rowHeights.length=Tn,b.rowHeights.fill(L,Vr,Tn)}if(b.colWidths.length<Kn){var Wr=b.colWidths.length;b.colWidths.length=Kn,b.colWidths.fill(m,Wr,Kn)}for(var In=0;In<Tn;In++)for(var xn=0;xn<Kn;xn++){var _r=(N=b.data)===null||N===void 0?void 0:N[In],Hr=_r&&_r[xn],Or=T.get(j(In,xn));if(Hr===void 0&&!Or){var Er=b.columnClassNames.get(xn);if(Er){var Ir=It[Er];if(Ir.border){var xr=bt(Ir.border,In,xn);b.customBorders.push(xr)}}var Lr=b.rowClassNames.get(In);if(Lr){var Pr=It[Lr];if(Pr.border){var Sr=bt(Pr.border,In,xn);b.customBorders.push(Sr)}}}}return b.columns.length=Kn,{tableProps:b}}(Bt,Ct).tableProps;if(!(on=Ae?Object.assign(Object.assign({},on),O):Object.assign(Object.assign({},on),{width:"100%",height:"100%"})))throw new Error("Could not create a `tableProps` object for the given sheet");return{cssText:Wt,tableProps:on,fontsLoadedPromise:Promise.all(Array.from(He.values()))}}catch(_t){throw console.error("interpreter:",_t),new Te.f(_t==null?void 0:_t.message)}finally{Object(ee.b)(ee.a.interpreterHotConfig),Object(ee.b)(ee.a.interpreter)}var wn},[oe,J,_e,Ae]),vt=At.cssText,qt=At.tableProps,kt=At.fontsLoadedPromise,sn=Object(M.useMemo)(function(){var Ct=Math.random().toString(32).substring(2);return C.a.createElement(F.a,{settings:qt,afterSelection:function(Wt,Ut,Bt,on,wn){ze&&(wn.value=!0)},afterSelectionEnd:yn(ke),afterRender:function(){if(Object(ee.b)(ee.a.presentationHotRendering),Object(ee.b)(ee.a.presentation),Object(Ye.d)(),Ce)throw new Error("This is a simulation of an error in rendering of Handsontable")},copyPaste:!ze||{uiContainer:document.createElement("div")},ref:it,key:Ct})},[Ce,qt,ze,ke]);return C.a.createElement("div",{className:"sv-hottable-wrapper",role:"tabpanel"},C.a.createElement(lt,{holdDownChildRenderPromise:kt},C.a.createElement("style",null,vt),Ae&&C.a.createElement("style",null,`
.sv-hottable-wrapper {
  width: initial;
  height: initial;
  margin-bottom: initial;
  margin-top: initial;
  position: static;
}
.handsontable {
  transform: none !important; /*disable row and column headings fixing to the viewport edge*/
}
`),C.a.createElement(bn,null,sn)))},En=i(319),dn=i(308),Vt=i(310),un=i(168),gn=i(313),St=function(ae){return M.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 16 16",preserveAspectRatio:"none"},ae),M.createElement("path",{d:"M11.201 11.999V4.085a.074.074 0 00-.123-.066l-6.33 3.958a.074.074 0 000 .131l6.329 3.957a.074.074 0 00.123-.066z"}))},Mt=function(ae){return M.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 16 16",preserveAspectRatio:"none"},ae),M.createElement("path",{d:"M5 4.082v7.92a.082.082 0 00.126.07l6.335-3.96a.082.082 0 000-.14L5.126 4.011A.083.083 0 005 4.082z"}))};function Nt(ae,oe,J){return oe in ae?Object.defineProperty(ae,oe,{value:J,enumerable:!0,configurable:!0,writable:!0}):ae[oe]=J,ae}var cn=function(ae,oe){var J={};for(var Ce in ae)Object.prototype.hasOwnProperty.call(ae,Ce)&&oe.indexOf(Ce)<0&&(J[Ce]=ae[Ce]);if(ae!=null&&typeof Object.getOwnPropertySymbols=="function"){var _e=0;for(Ce=Object.getOwnPropertySymbols(ae);_e<Ce.length;_e++)oe.indexOf(Ce[_e])<0&&Object.prototype.propertyIsEnumerable.call(ae,Ce[_e])&&(J[Ce[_e]]=ae[Ce[_e]])}return J},Dt=function(ae){return Object.entries(ae).filter(function(oe){return oe[1]}).map(function(oe){return oe[0]}).join(" ")},Yt=M.forwardRef(function(ae,oe){var J,Ce=ae.classes,_e=ae.className,Ue=ae.direction,Ae=ae.orientation,ke=ae.disabled,Pe=cn(ae,["classes","className","direction","orientation","disabled"]);return M.createElement(gn.a,Object.assign({component:"div",className:Dt((J={},Nt(J,Ce.root||"",!0),Nt(J,Ce.vertical||"",Ae==="vertical"),Nt(J,"sv-tab-scroll-button-disabled",Boolean(ke)),Nt(J,_e||"",!0),Nt(J,"sv-tab-scroll-button",!0),J)),ref:oe},Pe),Ue==="left"?M.createElement(St,{"data-cy":"tabbar-left-caret"}):M.createElement(Mt,{"data-cy":"tabbar-right-caret"}))}),Sn=Object(un.a)({root:{width:40,flexShrink:0},disabled:{}})(Yt),_n=i(317),pn=function(ae){var oe=ae.isActive;return C.a.createElement(C.a.Fragment,null,C.a.createElement("svg",{height:"16",width:"16",viewBox:"5 4 16 16",className:oe?"active":"inactive"},C.a.createElement("path",{className:"sv-hamburger-icon",d:"M19.922 11H4.078a.09.09 0 00-.078.1v1.8a.089.089 0 00.078.1h15.844a.089.089 0 00.078-.1v-1.8a.09.09 0 00-.078-.1zM19.922 6H4.078A.09.09 0 004 6.1v1.8a.089.089 0 00.078.1h15.844A.089.089 0 0020 7.9V6.1a.09.09 0 00-.078-.1zM19.922 16H4.078a.09.09 0 00-.078.1v1.8a.089.089 0 00.078.1h15.844a.089.089 0 00.078-.1v-1.8a.09.09 0 00-.078-.1z"})),C.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},C.a.createElement("span",null,"More sheets")))},Hn=function(ae){var oe=ae.isActive;return C.a.createElement(C.a.Fragment,null,C.a.createElement("svg",{height:"24",width:"24",viewBox:"0 0 24 24",className:oe?"active":"inactive"},C.a.createElement("g",{transform:"translate(-679.64 -429.029)"},C.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 433.029)"}),C.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 440.029)"}),C.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 447.029)"}))))},Gn=function(ae){var oe=ae.onClick,J=ae.isClicked,Ce=ae.isMobile;return C.a.createElement("div",{className:"sv-dropup-menu-button",role:"button",tabIndex:0,onClick:oe,"data-cy":"dropup-menu-button"},Ce?C.a.createElement(Hn,{isActive:J}):C.a.createElement(pn,{isActive:J}))},jn=i(314),Mn=function(ae){var oe=ae.anchorEl,J=ae.handleCloseMenu,Ce=ae.children,_e=ae.isMobile;return C.a.createElement(jn.a,{anchorEl:oe,keepMounted:!0,open:Boolean(oe),onClose:J,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{style:_e?{maxHeight:232,width:232}:{maxHeight:267,width:152}},classes:{paper:"sv-dropup-menu-container",list:"sv-dropup-menu-list"}},Ce)};function rr(ae,oe){return function(J){if(Array.isArray(J))return J}(ae)||function(J,Ce){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(J)))){var _e=[],Ue=!0,Ae=!1,ke=void 0;try{for(var Pe,ze=J[Symbol.iterator]();!(Ue=(Pe=ze.next()).done)&&(_e.push(Pe.value),!Ce||_e.length!==Ce);Ue=!0);}catch(it){Ae=!0,ke=it}finally{try{Ue||ze.return==null||ze.return()}finally{if(Ae)throw ke}}return _e}}(ae,oe)||function(J,Ce){if(!!J){if(typeof J=="string")return $n(J,Ce);var _e=Object.prototype.toString.call(J).slice(8,-1);if(_e==="Object"&&J.constructor&&(_e=J.constructor.name),_e==="Map"||_e==="Set")return Array.from(J);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return $n(J,Ce)}}(ae,oe)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function $n(ae,oe){(oe==null||oe>ae.length)&&(oe=ae.length);for(var J=0,Ce=new Array(oe);J<oe;J++)Ce[J]=ae[J];return Ce}var ar=function(ae){var oe=ae.currentTabIndex,J=ae.onTabChange,Ce=ae.titles,_e=rr(Object(M.useState)(void 0),2),Ue=_e[0],Ae=_e[1],ke=Object(at.b)();return C.a.createElement(C.a.Fragment,null,C.a.createElement(Gn,{onClick:function(Pe){Ae(Pe.currentTarget)},isClicked:!!Ue,isMobile:ke}),C.a.createElement(Mn,{anchorEl:Ue,handleCloseMenu:function(){Ae(void 0)},isMobile:ke},Ce.map(function(Pe,ze){var it=oe===ze?"active":"";return C.a.createElement(_n.a,{key:ze,selected:Boolean(it),classes:{root:"sv-dropup-menu-item",selected:it},onMouseDown:function(){return J(ze)},disableRipple:!0,"data-cy":"dropup-menu-item-".concat(ze)},C.a.createElement("div",null,Pe))})))},Rn=function(ae){var oe=ae.currentTabIndex,J=ae.onTabChange,Ce=ae.titles;Object(M.useMemo)(function(){return Object(ee.c)(ee.a.presentationTabsRendering)},[]),Object(M.useLayoutEffect)(function(){return Object(ee.b)(ee.a.presentationTabsRendering)},[]),Object(ee.c)(ee.a.presentationTabsParsing);var _e=C.a.createElement(dn.a,{position:"static",color:"default",className:"sv-tabbar"},C.a.createElement(ar,{onTabChange:J,currentTabIndex:oe,titles:Ce}),C.a.createElement(Vt.a,{value:oe,onChange:function(Ue,Ae){return J(Number(Ae))},textColor:"primary",variant:"scrollable",scrollButtons:"auto",ScrollButtonComponent:Sn,"aria-label":"scrollable auto tabs example",classes:{indicator:"sv-tab-indicator",scrollable:"sv-tabs-scrollable"},className:"sv-tabs","data-cy":"tabbar"},Ce.map(function(Ue,Ae){return function(ke,Pe,ze){return C.a.createElement(En.a,{label:ke,key:Pe,className:"sv-tab","data-cy":"tabbar-workbook-tab",disableRipple:!0,onMouseDown:function(it){it.preventDefault(),ze()}})}(Ue,Ae,function(){return J(Ae)})})));return Object(ee.b)(ee.a.presentationTabsParsing),_e},Qn=i(223);function st(ae,oe){return function(J){if(Array.isArray(J))return J}(ae)||function(J,Ce){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(J)))){var _e=[],Ue=!0,Ae=!1,ke=void 0;try{for(var Pe,ze=J[Symbol.iterator]();!(Ue=(Pe=ze.next()).done)&&(_e.push(Pe.value),!Ce||_e.length!==Ce);Ue=!0);}catch(it){Ae=!0,ke=it}finally{try{Ue||ze.return==null||ze.return()}finally{if(Ae)throw ke}}return _e}}(ae,oe)||function(J,Ce){if(!!J){if(typeof J=="string")return sr(J,Ce);var _e=Object.prototype.toString.call(J).slice(8,-1);if(_e==="Object"&&J.constructor&&(_e=J.constructor.name),_e==="Map"||_e==="Set")return Array.from(J);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return sr(J,Ce)}}(ae,oe)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function sr(ae,oe){(oe==null||oe>ae.length)&&(oe=ae.length);for(var J=0,Ce=new Array(oe);J<oe;J++)Ce[J]=ae[J];return Ce}var lr=i(24),Zn=i(208),ur=function(ae){ae.preventDefault()};S.default=function(ae){var oe,J,Ce,_e,Ue=ae.onSheetChange,Ae=ae.simulateError,ke=ae.loadWorkbook,Pe=ae.workbookState,ze=ae.latestLoadedSheet,it=ae.requestMessageOnError,At=ae.svId,vt=Object(X.useModals)(),qt=vt.Modals,kt=vt.openModal,sn=(oe=1e3,J=st(Object(M.useState)(!1),2),Ce=J[0],_e=J[1],Object(M.useEffect)(function(){var Ct=setTimeout(function(){return _e(!0)},oe);return function(){return clearTimeout(Ct)}},[oe]),Ce);return Object(M.useEffect)(function(){if(Ae===Te.l.REACT_INITIALIZATION_ERROR)throw new Error(Te.l.REACT_INITIALIZATION_ERROR)},[Ae]),function(){var Ct;if(Pe===void 0)return sn?C.a.createElement(pe,null):C.a.createElement(ie.a,null);if(Pe.type==="initialising")return null;var Wt=Pe.sheetHistory.latestSheet,Ut=ze===void 0?void 0:Pe.sheets.get(ze),Bt=Object(ct.b)();Object(lr.a)(Bt,Pe.sheetNames.length);var on=Pe.input;return C.a.createElement(C.a.Fragment,null,C.a.createElement("div",{className:"sv-app-container",onContextMenu:ur},C.a.createElement(qt,null),!Bt&&C.a.createElement(Qn.a,{fileName:(Ct=Object(Zn.a)(on))!==null&&Ct!==void 0?Ct:Zn.b,workbookLocation:on.type==="url"?on.url:on.arrayBuffer,renderWorkbook:ke,openModal:kt}),ze!==void 0&&(Ut==null?void 0:Ut.type)==="ready"&&C.a.createElement(On,{shouldSimulateHandsontableError:Ae===Te.l.RENDER_ERROR,shouldSimulateInterpreterError:Ae===Te.l.INTERPRETER_ERROR,parsedData:Ut.parsedData,sheet:ze,requestMessageOnError:it,fullPage:Bt,svId:At}),!Bt&&C.a.createElement(Rn,{currentTabIndex:Wt,onTabChange:Ue,titles:Pe.sheetNames})))}()||C.a.createElement(ie.a,null)}}])]);
