var ur=Math.pow;/*!
 * Spreadsheet Viewer
 * 
 * Version: 1.0.1
 * Code version: 06577ad
 * Build date: Thu, October 21, 2021, 12:29 PM GMT+2
 */(window.webpackJsonp=window.webpackJsonp||[]).push([[2],Array(32).concat([function(De,d,o){"use strict";o.r(d),o.d(d,"duckSchema",function(){return c}),o.d(d,"inherit",function(){return X}),o.d(d,"extend",function(){return w}),o.d(d,"deepExtend",function(){return x}),o.d(d,"deepClone",function(){return _}),o.d(d,"clone",function(){return f}),o.d(d,"mixin",function(){return S}),o.d(d,"isObjectEqual",function(){return C}),o.d(d,"isObject",function(){return N}),o.d(d,"defineGetter",function(){return h}),o.d(d,"objectEach",function(){return E}),o.d(d,"getProperty",function(){return M}),o.d(d,"setProperty",function(){return y}),o.d(d,"deepObjectSize",function(){return z}),o.d(d,"createObjectPropListener",function(){return U}),o.d(d,"hasOwnProperty",function(){return te});var R=o(33);function c(D){var k;return Array.isArray(D)?k=[]:(k={},E(D,(T,G)=>{G!=="__children"&&(T&&typeof T=="object"&&!Array.isArray(T)?k[G]=c(T):Array.isArray(T)?T.length&&typeof T[0]=="object"&&!Array.isArray(T[0])?k[G]=[c(T[0])]:k[G]=[]:k[G]=null)})),k}function X(D,k){return k.prototype.constructor=k,D.prototype=new k,D.prototype.constructor=D,D}function w(D,k,T){var G=Array.isArray(T);return E(k,(W,P)=>{(G===!1||T.includes(P))&&(D[P]=W)}),D}function x(D,k){E(k,(T,G)=>{k[G]&&typeof k[G]=="object"?(D[G]||(Array.isArray(k[G])?D[G]=[]:Object.prototype.toString.call(k[G])==="[object Date]"?D[G]=k[G]:D[G]={}),x(D[G],k[G])):D[G]=k[G]})}function _(D){return typeof D=="object"?JSON.parse(JSON.stringify(D)):D}function f(D){var k={};return E(D,(T,G)=>{k[G]=T}),k}function S(D){D.MIXINS||(D.MIXINS=[]);for(var k=arguments.length,T=new Array(k>1?k-1:0),G=1;G<k;G++)T[G-1]=arguments[G];return Object(R.arrayEach)(T,W=>{D.MIXINS.push(W.MIXIN_NAME),E(W,(P,Q)=>{if(D.prototype[Q]!==void 0)throw new Error("Mixin conflict. Property '".concat(Q,"' already exist and cannot be overwritten."));typeof P=="function"?D.prototype[Q]=P:Object.defineProperty(D.prototype,Q,{get:(O=Q,A=P,Z="_".concat(O),function(){var ee;return this[Z]===void 0&&(this[Z]=(ee=A,(Array.isArray(ee)||N(ee))&&(ee=_(ee)),ee)),this[Z]}),set:function(ee){var de="_".concat(ee);return function(be){this[de]=be}}(Q),configurable:!0});var O,A,Z})}),D}function C(D,k){return JSON.stringify(D)===JSON.stringify(k)}function N(D){return Object.prototype.toString.call(D)==="[object Object]"}function h(D,k,T,G){G.value=T,G.writable=G.writable!==!1,G.enumerable=G.enumerable!==!1,G.configurable=G.configurable!==!1,Object.defineProperty(D,k,G)}function E(D,k){for(var T in D)if((!D.hasOwnProperty||D.hasOwnProperty&&Object.prototype.hasOwnProperty.call(D,T))&&k(D[T],T,D)===!1)break;return D}function M(D,k){var T=k.split("."),G=D;return E(T,W=>{if((G=G[W])===void 0)return G=void 0,!1}),G}function y(D,k,T){var G=k.split("."),W=D;G.forEach((P,Q)=>{Q!==G.length-1?(te(W,P)||(W[P]={}),W=W[P]):W[P]=T})}function z(D){return N(D)?function k(T){var G=0;return N(T)?E(T,(W,P)=>{P!=="__children"&&(G+=k(W))}):G+=1,G}(D):0}function U(D){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",T="_".concat(k),G={_touched:!1,[T]:D,isTouched(){return this._touched}};return Object.defineProperty(G,k,{get(){return this[T]},set(W){this._touched=!0,this[T]=W},enumerable:!0,configurable:!0}),G}function te(D,k){return Object.prototype.hasOwnProperty.call(D,k)}},function(De,d,o){"use strict";function R(D){for(var k=D.length,T=0;T<k;)D[T]=[D[T]],T+=1}function c(D,k){for(var T=k.length,G=0;G<T;)D.push(k[G]),G+=1}function X(D){var k=[];if(!D||D.length===0||!D[0]||D[0].length===0)return k;for(var T=D.length,G=D[0].length,W=0;W<T;W++)for(var P=0;P<G;P++)k[P]||(k[P]=[]),k[P][W]=D[W][P];return k}function w(D,k,T,G){var W=-1,P=D,Q=T;Array.isArray(D)||(P=Array.from(D));var O=P.length;for(G&&O&&(Q=P[W+=1]),W+=1;W<O;)Q=k(Q,P[W],W,P),W+=1;return Q}function x(D,k){var T=0,G=D;Array.isArray(D)||(G=Array.from(D));for(var W=G.length,P=[],Q=-1;T<W;){var O=G[T];k(O,T,G)&&(P[Q+=1]=O),T+=1}return P}function _(D,k){var T=0,G=D;Array.isArray(D)||(G=Array.from(D));for(var W=G.length,P=[],Q=-1;T<W;){var O=G[T];P[Q+=1]=k(O,T,G),T+=1}return P}function f(D,k){var T=0,G=D;Array.isArray(D)||(G=Array.from(D));for(var W=G.length;T<W&&k(G[T],T,G)!==!1;)T+=1;return D}function S(D){return w(D,(k,T)=>k+T,0)}function C(D){return w(D,(k,T)=>k>T?k:T,Array.isArray(D)?D[0]:void 0)}function N(D){return w(D,(k,T)=>k<T?k:T,Array.isArray(D)?D[0]:void 0)}function h(D){return D.length?S(D)/D.length:0}function E(D){return w(D,(k,T)=>k.concat(Array.isArray(T)?E(T):T),[])}function M(D){var k=[];return f(D,T=>{k.indexOf(T)===-1&&k.push(T)}),k}function y(){for(var D=arguments.length,k=new Array(D),T=0;T<D;T++)k[T]=arguments[T];var[G,...W]=[...k],P=G;return f(W,Q=>{P=P.filter(O=>!Q.includes(O))}),P}function z(){for(var D=arguments.length,k=new Array(D),T=0;T<D;T++)k[T]=arguments[T];var[G,...W]=[...k],P=G;return f(W,Q=>{P=P.filter(O=>Q.includes(O))}),P}function U(){for(var D=arguments.length,k=new Array(D),T=0;T<D;T++)k[T]=arguments[T];var[G,...W]=[...k],P=new Set(G);return f(W,Q=>{f(Q,O=>{P.has(O)||P.add(O)})}),Array.from(P)}function te(D){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return D.split(k)}o.r(d),o.d(d,"to2dArray",function(){return R}),o.d(d,"extendArray",function(){return c}),o.d(d,"pivot",function(){return X}),o.d(d,"arrayReduce",function(){return w}),o.d(d,"arrayFilter",function(){return x}),o.d(d,"arrayMap",function(){return _}),o.d(d,"arrayEach",function(){return f}),o.d(d,"arraySum",function(){return S}),o.d(d,"arrayMax",function(){return C}),o.d(d,"arrayMin",function(){return N}),o.d(d,"arrayAvg",function(){return h}),o.d(d,"arrayFlatten",function(){return E}),o.d(d,"arrayUnique",function(){return M}),o.d(d,"getDifferenceOfArrays",function(){return y}),o.d(d,"getIntersectionOfArrays",function(){return z}),o.d(d,"getUnionOfArrays",function(){return U}),o.d(d,"stringToArray",function(){return te})},function(De,d,o){"use strict";o.r(d),o.d(d,"getParent",function(){return N}),o.d(d,"getFrameElement",function(){return h}),o.d(d,"getParentWindow",function(){return E}),o.d(d,"hasAccessToParentWindow",function(){return M}),o.d(d,"closest",function(){return y}),o.d(d,"closestDown",function(){return z}),o.d(d,"isChildOf",function(){return U}),o.d(d,"index",function(){return te}),o.d(d,"overlayContainsElement",function(){return D}),o.d(d,"hasClass",function(){return W}),o.d(d,"addClass",function(){return P}),o.d(d,"removeClass",function(){return Q}),o.d(d,"removeTextNodes",function(){return O}),o.d(d,"empty",function(){return A}),o.d(d,"HTML_CHARACTERS",function(){return Z}),o.d(d,"fastInnerHTML",function(){return ee}),o.d(d,"fastInnerText",function(){return de}),o.d(d,"isVisible",function(){return be}),o.d(d,"offset",function(){return Ne}),o.d(d,"getWindowScrollTop",function(){return Me}),o.d(d,"getWindowScrollLeft",function(){return pe}),o.d(d,"getScrollTop",function(){return Be}),o.d(d,"getScrollLeft",function(){return Ce}),o.d(d,"clientWidth",function(){return Oe}),o.d(d,"clientHeight",function(){return Ae}),o.d(d,"offsetWidth",function(){return Ue}),o.d(d,"offsetHeight",function(){return ze}),o.d(d,"scrollWidth",function(){return Ge}),o.d(d,"scrollHeight",function(){return I}),o.d(d,"getScrollableElement",function(){return ge}),o.d(d,"getTrimmingContainer",function(){return V}),o.d(d,"getStyle",function(){return q}),o.d(d,"matchesCSSRules",function(){return B}),o.d(d,"getComputedStyle",function(){return se}),o.d(d,"outerWidth",function(){return ie}),o.d(d,"outerHeight",function(){return Ee}),o.d(d,"innerHeight",function(){return _e}),o.d(d,"innerWidth",function(){return st}),o.d(d,"addEvent",function(){return at}),o.d(d,"removeEvent",function(){return it}),o.d(d,"getCaretPosition",function(){return Xe}),o.d(d,"getSelectionEndPosition",function(){return vt}),o.d(d,"getSelectionText",function(){return lt}),o.d(d,"clearTextSelection",function(){return yt}),o.d(d,"setCaretPosition",function(){return Rt}),o.d(d,"getScrollbarWidth",function(){return rt}),o.d(d,"hasVerticalScrollbar",function(){return Mt}),o.d(d,"hasHorizontalScrollbar",function(){return g}),o.d(d,"setOverlayPosition",function(){return v}),o.d(d,"getCssTransform",function(){return F}),o.d(d,"resetCssTransform",function(){return re}),o.d(d,"isInput",function(){return le}),o.d(d,"isOutsideInput",function(){return fe}),o.d(d,"selectElementIfAllowed",function(){return Se}),o.d(d,"getBoundingClientRect",function(){return ve}),o.d(d,"clearMemoizedFunctionsBeforeRender",function(){return Re});var R,c,X,w=o(55),x=o(46),_=o(141),f=o.n(_),S=L=>{var l=f()(L,{maxSize:1/0});return l.cache.orderByLru=(t,i,a)=>{l.cache.keys[a]=t,l.cache.values[a]=i},l.clear=()=>{l.cache.keys.length=0,l.cache.values.length=0},l},C=L=>(L.clear=()=>{},L);function N(L){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,i=null,a=L;a!==null;){if(t===l){i=a;break}a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a=a.host:(t+=1,a=a.parentNode)}return i}function h(L){return Object.getPrototypeOf(L.parent)&&L.frameElement}function E(L){return h(L)&&L.parent}function M(L){return!!Object.getPrototypeOf(L.parent)}function y(L){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:a}=Node,m=L;m!=null&&m!==t;){var{nodeType:b,nodeName:H}=m;if(b===i&&(l.includes(H)||l.includes(m)))return m;var{host:$}=m;m=$&&b===a?$:m.parentNode}return null}function z(L,l,t){for(var i=[],a=L;a&&(a=y(a,l,t))&&(!t||t.contains(a));)i.push(a),a=a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a.host:a.parentNode;var m=i.length;return m?i[m-1]:null}function U(L,l){var t=L.parentNode,i=[];for(typeof l=="string"?i=L.defaultView?Array.prototype.slice.call(L.querySelectorAll(l),0):Array.prototype.slice.call(L.ownerDocument.querySelectorAll(l),0):i.push(l);t!==null;){if(i.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function te(L){var l=0,t=L;if(t.previousSibling)for(;t=t.previousSibling;)l+=1;return l}function D(L,l,t){var i=t.parentElement.querySelector(".ht_clone_".concat(L));return i?i.contains(l):null}function k(L){return L&&L.length?L.filter(l=>!!l):[]}if(Object(w.isClassListSupported)()){var T=function(L){var l=L.createElement("div");return l.classList.add("test","test2"),l.classList.contains("test2")};R=function(L,l){return L.classList!==void 0&&typeof l=="string"&&l!==""&&L.classList.contains(l)},c=function(L,l){var t=L.ownerDocument,i=l;if(typeof i=="string"&&(i=i.split(" ")),(i=k(i)).length>0)if(T(t))L.classList.add(...i);else for(var a=0;i&&i[a];)L.classList.add(i[a]),a+=1},X=function(L,l){var t=l;if(typeof t=="string"&&(t=t.split(" ")),(t=k(t)).length>0)if(T)L.classList.remove(...t);else for(var i=0;t&&t[i];)L.classList.remove(t[i]),i+=1}}else{var G=function(L){return new RegExp("(\\s|^)".concat(L,"(\\s|$)"))};R=function(L,l){return L.className!==void 0&&G(l).test(L.className)},c=function(L,l){var t=L.className,i=l;if(typeof i=="string"&&(i=i.split(" ")),t==="")t=i.join(" ");else for(var a=0;a<i.length;a++)i[a]&&!G(i[a]).test(t)&&(t+=" ".concat(i[a]));L.className=t},X=function(L,l){var t=0,i=L.className,a=l;for(typeof a=="string"&&(a=a.split(" "));a&&a[t];)i=i.replace(G(a[t])," ").trim(),t+=1;L.className!==i&&(L.className=i)}}function W(L,l){return R(L,l)}function P(L,l){c(L,l)}function Q(L,l){X(L,l)}function O(L){if(L.nodeType===3)L.parentNode.removeChild(L);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(L.nodeName)>-1)for(var l=L.childNodes,t=l.length-1;t>=0;t--)O(l[t])}function A(L){for(var l;l=L.lastChild;)L.removeChild(l)}var Z=/(<(.*)>|&(.*);)/;function ee(L,l){Z.test(l)?L.innerHTML=l:de(L,l)}function de(L,l){var t=L.firstChild;t&&t.nodeType===3&&t.nextSibling===null?w.isTextContentSupported?t.textContent=l:t.data=l:(A(L),L.appendChild(L.ownerDocument.createTextNode(l)))}function be(L){for(var l=L.ownerDocument.documentElement,t=L;t!==l;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return be(t.host.impl);if(t.host)return be(t.host);throw new Error("Lost in Web Components world")}return!1}if(t.style&&t.style.display==="none")return!1;t=t.parentNode}return!0}function Ne(L){var l,t,i,a,m=L.ownerDocument,b=m.defaultView,H=m.documentElement,$=L;if(Object(w.hasCaptionProblem)()&&$.firstChild&&$.firstChild.nodeName==="CAPTION")return{top:(a=ve($)).top+(b.pageYOffset||H.scrollTop)-(H.clientTop||0),left:a.left+(b.pageXOffset||H.scrollLeft)-(H.clientLeft||0)};for(l=$.offsetLeft,t=$.offsetTop,i=$;($=$.offsetParent)&&$!==m.body;)l+=$.offsetLeft,t+=$.offsetTop,i=$;return i&&i.style.position==="fixed"&&(l+=b.pageXOffset||H.scrollLeft,t+=b.pageYOffset||H.scrollTop),{left:l,top:t}}function Me(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,l=L.scrollY;return l===void 0&&(l=L.document.documentElement.scrollTop),l}function pe(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,l=L.scrollX;return l===void 0&&(l=L.document.documentElement.scrollLeft),l}var Be=S(function(L){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return L===l?Me(l):L.scrollTop});function Ce(L){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return L===l?pe(l):L.scrollLeft}var Oe=S(L=>L.clientWidth),Ae=C(L=>L.clientHeight),Ue=C(L=>L.offsetWidth),ze=C(L=>L.offsetHeight),Ge=C(L=>L.scrollWidth),I=C(L=>L.scrollHeight);function ge(L){var l=L.ownerDocument,t=l?l.defaultView:void 0;l||(t=(l=L.document?L.document:L).defaultView);for(var i=["auto","scroll"],a=Object(w.isGetComputedStyleSupported)(),m=L.parentNode;m&&m.style&&l.body!==m;){var{overflow:b,overflowX:H,overflowY:$}=m.style;if([b,H,$].includes("scroll")||a&&({overflow:b,overflowX:H,overflowY:$}=se(m,t),i.includes(b)||i.includes(H)||i.includes($))||Ae(m)<=I(m)+1&&(i.includes($)||i.includes(b))||Oe(m)<=Ge(m)+1&&(i.includes(H)||i.includes(b)))return m;m=m.parentNode}return t}function V(L){for(var l=L.ownerDocument,t=l.defaultView,i=L.parentNode;i&&i.style&&l.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;var a=se(i,t),m=["scroll","hidden","auto"],b=a.getPropertyValue("overflow"),H=a.getPropertyValue("overflow-y"),$=a.getPropertyValue("overflow-x");if(m.includes(b)||m.includes(H)||m.includes($))return i;i=i.parentNode}return t}function q(L,l){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(L){if(L===t)return l==="width"?"".concat(t.innerWidth,"px"):l==="height"?"".concat(t.innerHeight,"px"):void 0;var i=L.style[l];if(i!==""&&i!==void 0)return i;var a=se(L,t);return a[l]!==""&&a[l]!==void 0?a[l]:void 0}}function B(L,l){var{selectorText:t}=l,i=!1;return l.type===CSSRule.STYLE_RULE&&t&&(L.msMatchesSelector?i=L.msMatchesSelector(t):L.matches&&(i=L.matches(t))),i}var se=C(function(L){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return L.currentStyle||l.getComputedStyle(L)});function ie(L){return Ue(L)}function Ee(L){return Object(w.hasCaptionProblem)()&&L.firstChild&&L.firstChild.nodeName==="CAPTION"?ze(L)+ze(L.firstChild):ze(L)}var ye,_e=S(L=>Ae(L)||L.innerHeight),st=S(L=>Oe(L)||L.innerWidth);function at(L,l,t){L.addEventListener(l,t,!1)}function it(L,l,t){L.removeEventListener(l,t,!1)}function Xe(L){var l=L.ownerDocument;if(L.selectionStart)return L.selectionStart;if(l.selection){L.focus();var t=l.selection.createRange();if(t===null)return 0;var i=L.createTextRange(),a=i.duplicate();return i.moveToBookmark(t.getBookmark()),a.setEndPoint("EndToStart",i),a.text.length}return 0}function vt(L){var l=L.ownerDocument;if(L.selectionEnd)return L.selectionEnd;if(l.selection){var t=l.selection.createRange();return t===null?0:L.createTextRange().text.indexOf(t.text)+t.text.length}return 0}function lt(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,l=L.document,t="";return L.getSelection?t=L.getSelection().toString():l.selection&&l.selection.type!=="Control"&&(t=l.selection.createRange().text),t}function yt(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,l=L.document;L.getSelection?L.getSelection().empty?L.getSelection().empty():L.getSelection().removeAllRanges&&L.getSelection().removeAllRanges():l.selection&&l.selection.empty()}function Rt(L,l,t){if(t===void 0&&(t=l),L.setSelectionRange){L.focus();try{L.setSelectionRange(l,t)}catch(m){var i=L.parentNode,a=i.style.display;i.style.display="block",L.setSelectionRange(l,t),i.style.display=a}}}function Et(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,l=L.createElement("div");l.style.height="200px",l.style.width="100%";var t=L.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(l),(L.body||L.documentElement).appendChild(t);var i=Ue(l);t.style.overflow="scroll";var a=Ue(l);return i===a&&(a=Oe(t)),(L.body||L.documentElement).removeChild(t),i-a}function rt(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return ye===void 0&&(ye=Et(L)),ye}function Mt(L){return Ue(L)!==Oe(L)}function g(L){return ze(L)!==Ae(L)}function v(L,l,t){Object(x.isIE9)()?(L.style.top=t,L.style.left=l):Object(x.isSafari)()?(L.style["-webkit-transform"]="translate3d(".concat(l,",").concat(t,",0)"),L.style["-webkit-transform"]="translate3d(".concat(l,",").concat(t,",0)")):L.style.transform="translate3d(".concat(l,",").concat(t,",0)")}function F(L){var l;return L.style.transform&&(l=L.style.transform)!==""?["transform",l]:L.style["-webkit-transform"]&&(l=L.style["-webkit-transform"])!==""?["-webkit-transform",l]:-1}function re(L){L.style.transform&&L.style.transform!==""?L.style.transform="":L.style["-webkit-transform"]&&L.style["-webkit-transform"]!==""&&(L.style["-webkit-transform"]="")}function le(L){return L&&(["INPUT","SELECT","TEXTAREA"].indexOf(L.nodeName)>-1||L.contentEditable==="true")}function fe(L){return le(L)&&L.hasAttribute("data-hot-input")===!1}function Se(L){fe(L.ownerDocument.activeElement)||L.select()}var ve=C(L=>L.getBoundingClientRect()),He=[Be,ve,Oe,Ae,Ue,ze,Ge,I,se,st,_e],Re=()=>{He.forEach(L=>L.clear())}},,,,function(De,d,o){"use strict";o.d(d,"d",function(){return X}),o.d(d,"a",function(){return f}),o.d(d,"b",function(){return S}),o.d(d,"e",function(){return me}),o.d(d,"c",function(){return St});var R=new WeakMap;class c{static get DEFAULT_WIDTH(){return 50}constructor(){var{viewportSize:e,scrollOffset:n,totalItems:s,itemSizeFn:u,overrideFn:p,calculationType:j,stretchMode:K,stretchingItemWidthFn:J=ne=>ne}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};R.set(this,{viewportWidth:e,scrollOffset:n,totalColumns:s,columnWidthFn:u,overrideFn:p,calculationType:j,stretchingColumnWidthFn:J}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=K,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){for(var e,n=0,s=!0,u=[],p=R.get(this),j=p.calculationType,K=p.overrideFn,J=p.scrollOffset,ne=p.totalColumns,he=p.viewportWidth,ue=0;ue<ne;ue++)if(e=this._getColumnWidth(ue),n<=J&&j!==2&&(this.startColumn=ue),n>=J&&n+(j===2?e:0)<=J+(J>0?he+1:he)&&(this.startColumn!==null&&this.startColumn!==void 0||(this.startColumn=ue),this.endColumn=ue),u.push(n),n+=e,j!==2&&(this.endColumn=ue),n>=J+he){s=!1;break}if(this.endColumn===ne-1&&s)for(this.startColumn=this.endColumn;this.startColumn>0;){var je=u[this.endColumn]+e-u[this.startColumn-1];if((je<=he||j!==2)&&(this.startColumn-=1),je>he)break}j===1&&this.startColumn!==null&&K&&K(this),this.startPosition=u[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),ne<this.endColumn&&(this.endColumn=ne-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch!=="none"){var n=e;this.totalTargetWidth=n;for(var s=R.get(this),u=s.totalColumns,p=0,j=0;j<u;j++){var K=this._getColumnWidth(j),J=s.stretchingColumnWidthFn(void 0,j);typeof J=="number"?n-=J:p+=K}var ne=n-p;if(this.stretch==="all"&&ne>0)this.stretchAllRatio=n/p,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var he=this._getColumnWidth(u-1),ue=ne+he;this.stretchLastWidth=ue>=0?ue:he}}}getStretchedColumnWidth(e,n){var s=null;return this.stretch==="all"&&this.stretchAllRatio!==0?s=this._getStretchedAllColumnWidth(e,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(s=this._getStretchedLastColumnWidth(e)),s}_getStretchedAllColumnWidth(e,n){var s=0,u=R.get(this),p=u.totalColumns;if(!this.stretchAllColumnsWidth[e]){var j=Math.round(n*this.stretchAllRatio),K=u.stretchingColumnWidthFn(j,e);this.stretchAllColumnsWidth[e]=K===void 0?j:isNaN(K)?this._getColumnWidth(e):K}if(this.stretchAllColumnsWidth.length===p&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var J=0;J<this.stretchAllColumnsWidth.length;J++)s+=this.stretchAllColumnsWidth[J];s!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-s)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===R.get(this).totalColumns-1?this.stretchLastWidth:null}_getColumnWidth(e){var n=R.get(this).columnWidthFn(e);return isNaN(n)&&(n=c.DEFAULT_WIDTH),n}}var X=c,w=new WeakMap;class x{static get DEFAULT_HEIGHT(){return 23}constructor(){var{viewportSize:e,scrollOffset:n,totalItems:s,itemSizeFn:u,overrideFn:p,calculationType:j,scrollbarHeight:K}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};w.set(this,{viewportHeight:e,scrollOffset:n,totalRows:s,rowHeightFn:u,overrideFn:p,calculationType:j,horizontalScrollbarHeight:K}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}calculate(){for(var e,n=0,s=!0,u=[],p=w.get(this),j=p.calculationType,K=p.overrideFn,J=p.rowHeightFn,ne=p.scrollOffset,he=p.totalRows,ue=p.viewportHeight,je=p.horizontalScrollbarHeight||0,We=0;We<he;We++)if(e=J(We),isNaN(e)&&(e=x.DEFAULT_HEIGHT),n<=ne&&j!==2&&(this.startRow=We),n>=ne&&n+(j===2?e:0)<=ne+ue-je&&(this.startRow===null&&(this.startRow=We),this.endRow=We),u.push(n),n+=e,j!==2&&(this.endRow=We),n>=ne+ue-je){s=!1;break}if(this.endRow===he-1&&s)for(this.startRow=this.endRow;this.startRow>0;){var Pe=u[this.endRow]+e-u[this.startRow-1];if((Pe<=ue-je||j!==2)&&(this.startRow-=1),Pe>=ue-je)break}j===1&&this.startRow!==null&&K&&K(this),this.startPosition=u[this.startRow],this.startPosition===void 0&&(this.startPosition=null),he<this.endRow&&(this.endRow=he-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}var _=x,f=class{constructor(r,e){this.row=null,this.col=null,r!==void 0&&e!==void 0&&(this.row=r,this.col=e)}isValid(r){return!(this.row<0||this.col<0)&&!(this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}isEqual(r){return r===this||this.row===r.row&&this.col===r.col}isSouthEastOf(r){return this.row>=r.row&&this.col>=r.col}isNorthWestOf(r){return this.row<=r.row&&this.col<=r.col}isSouthWestOf(r){return this.row>=r.row&&this.col<=r.col}isNorthEastOf(r){return this.row<=r.row&&this.col>=r.col}toObject(){return{row:this.row,col:this.col}}},S=class{constructor(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;this.highlight=r,this.from=e,this.to=n}setHighlight(r){return this.highlight=r,this}setFrom(r){return this.from=r,this}setTo(r){return this.to=r,this}isValid(r){return this.from.isValid(r)&&this.to.isValid(r)}isSingle(){return this.from.row===this.to.row&&this.from.col===this.to.col}getHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}includes(r){var{row:e,col:n}=r,s=this.getTopLeftCorner(),u=this.getBottomRightCorner();return s.row<=e&&u.row>=e&&s.col<=n&&u.col>=n}includesRange(r){return this.includes(r.getTopLeftCorner())&&this.includes(r.getBottomRightCorner())}isEqual(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}overlaps(r){return r.isSouthEastOf(this.getTopLeftCorner())&&r.isNorthWestOf(this.getBottomRightCorner())}isSouthEastOf(r){return this.getTopLeftCorner().isSouthEastOf(r)||this.getBottomRightCorner().isSouthEastOf(r)}isNorthWestOf(r){return this.getTopLeftCorner().isNorthWestOf(r)||this.getBottomRightCorner().isNorthWestOf(r)}isOverlappingHorizontally(r){return this.getTopRightCorner().col>=r.getTopLeftCorner().col&&this.getTopRightCorner().col<=r.getTopRightCorner().col||this.getTopLeftCorner().col<=r.getTopRightCorner().col&&this.getTopLeftCorner().col>=r.getTopLeftCorner().col}isOverlappingVertically(r){return this.getBottomRightCorner().row>=r.getTopRightCorner().row&&this.getBottomRightCorner().row<=r.getBottomRightCorner().row||this.getTopRightCorner().row<=r.getBottomRightCorner().row&&this.getTopRightCorner().row>=r.getTopRightCorner().row}expand(r){var e=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(r.row<e.row||r.col<e.col||r.row>n.row||r.col>n.col)&&(this.from=new f(Math.min(e.row,r.row),Math.min(e.col,r.col)),this.to=new f(Math.max(n.row,r.row),Math.max(n.col,r.col)),!0)}expandByRange(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),s=this.getDirection(),u=r.getTopLeftCorner(),p=r.getBottomRightCorner(),j=Math.min(e.row,u.row),K=Math.min(e.col,u.col),J=Math.max(n.row,p.row),ne=Math.max(n.col,p.col),he=new f(j,K),ue=new f(J,ne);return this.from=he,this.to=ue,this.setDirection(s),this.highlight.row===this.getBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(r){switch(r){case"NW-SE":[this.from,this.to]=[this.getTopLeftCorner(),this.getBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getTopRightCorner(),this.getBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getBottomRightCorner(),this.getTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getBottomLeftCorner(),this.getTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getCorners(){return[Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col),Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)]}getTopLeftCorner(){return new f(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getBottomRightCorner(){return new f(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getTopRightCorner(){return new f(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getBottomLeftCorner(){return new f(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}isCorner(r,e){return!!(e&&e.includes(r)&&(this.getTopLeftCorner().isEqual(new f(e.from.row,e.from.col))||this.getTopRightCorner().isEqual(new f(e.from.row,e.to.col))||this.getBottomLeftCorner().isEqual(new f(e.to.row,e.from.col))||this.getBottomRightCorner().isEqual(new f(e.to.row,e.to.col))))||r.isEqual(this.getTopLeftCorner())||r.isEqual(this.getTopRightCorner())||r.isEqual(this.getBottomLeftCorner())||r.isEqual(this.getBottomRightCorner())}getOppositeCorner(r,e){if(!(r instanceof f))return!1;if(e&&e.includes(r)){if(this.getTopLeftCorner().isEqual(new f(e.from.row,e.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new f(e.from.row,e.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new f(e.to.row,e.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new f(e.to.row,e.to.col)))return this.getTopLeftCorner()}return r.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():r.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():r.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():r.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}getBordersSharedWith(r){if(!this.includesRange(r))return[];var e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),s=Math.min(this.from.col,this.to.col),u=Math.max(this.from.col,this.to.col),p=Math.min(r.from.row,r.to.row),j=Math.max(r.from.row,r.to.row),K=Math.min(r.from.col,r.to.col),J=Math.max(r.from.col,r.to.col),ne=[];return e===p&&ne.push("top"),u===J&&ne.push("right"),n===j&&ne.push("bottom"),s===K&&ne.push("left"),ne}getInner(){for(var r=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],s=r.row;s<=e.row;s++)for(var u=r.col;u<=e.col;u++)this.from.row===s&&this.from.col===u||this.to.row===s&&this.to.col===u||n.push(new f(s,u));return n}getAll(){for(var r=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],s=r.row;s<=e.row;s++)for(var u=r.col;u<=e.col;u++)r.row===s&&r.col===u?n.push(r):e.row===s&&e.col===u?n.push(e):n.push(new f(s,u));return n}forAll(r){for(var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),s=e.row;s<=n.row;s++)for(var u=e.col;u<=n.col;u++)if(r(s,u)===!1)return}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}},C=class{constructor(r,e,n){this.offset=r,this.total=e,this.countTH=n}offsetted(r){return r+this.offset}unOffsetted(r){return r-this.offset}renderedToSource(r){return this.offsetted(r)}sourceToRendered(r){return this.unOffsetted(r)}offsettedTH(r){return r-this.countTH}unOffsettedTH(r){return r+this.countTH}visibleRowHeadedColumnToSourceColumn(r){return this.renderedToSource(this.offsettedTH(r))}sourceColumnToVisibleRowHeadedColumn(r){return this.unOffsettedTH(this.sourceToRendered(r))}},N=class{constructor(r,e,n){this.offset=r,this.total=e,this.countTH=n}offsetted(r){return r+this.offset}unOffsetted(r){return r-this.offset}renderedToSource(r){return this.offsetted(r)}sourceToRendered(r){return this.unOffsetted(r)}offsettedTH(r){return r-this.countTH}unOffsettedTH(r){return r+this.countTH}visibleColHeadedRowToSourceRow(r){return this.renderedToSource(this.offsettedTH(r))}sourceRowToVisibleColHeadedRow(r){return this.unOffsettedTH(this.sourceToRendered(r))}},h=o(34);class E{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class M{constructor(){this.size=new E,this.workingSpace=0,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof E}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}class y{constructor(e,n,s){this.rootNode=e,this.nodesPool=n,this.sizeSet=new M,this.childNodeType=s.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){var{rootNode:e,sizeSet:n}=this,s=0;if(this.isSharedViewSet())for(var u=e.firstElementChild;u;){if(u.tagName===this.childNodeType)s+=1;else if(n.isPlaceOn(1))break;u=u.nextElementSibling}else s=e.childElementCount;return s}start(){this.collectedNodes.length=0,this.visualIndex=0;for(var{rootNode:e,sizeSet:n}=this,s=this.isSharedViewSet(),{nextSize:u}=n.getViewSize(),p=this.getRenderedChildCount();p<u;){var j=this.nodesPool();!s||s&&n.isPlaceOn(2)?e.appendChild(j):e.insertBefore(j,e.firstChild),p+=1}for(var K=s&&n.isPlaceOn(1);p>u;)e.removeChild(K?e.firstChild:e.lastChild),p-=1}render(){var{rootNode:e,sizeSet:n}=this,s=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(2)&&(s+=n.sharedSize.nextSize);var u=e.childNodes[s];if(u.tagName!==this.childNodeType){var p=this.nodesPool();e.replaceChild(p,u),u=p}this.collectedNodes.push(u),this.visualIndex+=1}end(){}}class z extends y{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class U{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class te{constructor(e,n){this.nodesPool=typeof e=="string"?new U(e):null,this.nodeType=e,this.rootNode=n,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class D extends te{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){var n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new z(e,s=>this.nodesPool.obtain(this.sourceRowIndex,s),this.nodeType),this.orderViews.set(e,n)),n}render(){for(var{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:s,rows:u,cells:p}=this.table,j=0;j<e;j++){var K=this.table.renderedRowToSource(j),J=u.getRenderedNode(j);this.sourceRowIndex=K;var ne=this.obtainOrderView(J),he=p.obtainOrderView(J);ne.appendView(he).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var ue=0;ue<s;ue++){ne.render();var je=ne.getCurrentNode();je.className="",je.removeAttribute("style"),n[ue](K,je,ue)}ne.end()}}}class k extends te{constructor(e){super(null,e)}adjust(){var{columnHeadersCount:e,rowHeadersCount:n}=this.table,s=this.rootNode.firstChild,{columnsToRender:u}=this.table;if(e||u){for(var p=u+n,j=0,K=e;j<K;j++){for((s=this.rootNode.childNodes[j])||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<p;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>p;)s.removeChild(s.lastChild),this.renderedNodes-=1}var J=this.rootNode.childNodes.length;if(J>e)for(var ne=e;ne<J;ne++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&Object(h.empty)(s)}render(){for(var{columnHeadersCount:e}=this.table,n=0;n<e;n+=1)for(var{columnHeaderFunctions:s,columnsToRender:u,rowHeadersCount:p}=this.table,j=this.rootNode.childNodes[n],K=-1*p;K<u;K+=1){var J=this.table.renderedColumnToSource(K),ne=j.childNodes[K+p];ne.className="",ne.removeAttribute("style"),s[n](J,ne,n),J<0&&Object(h.addClass)(ne,"wtTableCornerCell")}}}var T=o(56);class G extends te{constructor(e){super(null,e)}adjust(){for(var{columnsToRender:e,rowHeadersCount:n}=this.table,s=e+n;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();for(var{columnsToRender:e,rowHeadersCount:n}=this.table,s=0;s<n;s++){var u=this.table.renderedColumnToSource(s),p=this.table.columnUtils.getHeaderWidth(u);this.rootNode.childNodes[s].style.width="".concat(p,"px")}for(var j=0;j<e;j++){var K=this.table.renderedColumnToSource(j),J=this.table.columnUtils.getStretchedColumnWidth(K);n===0&&j===0&&(J+=T.a),this.rootNode.childNodes[j+n].style.width="".concat(J,"px")}var ne=this.rootNode.firstChild;ne&&Object(h.addClass)(ne,"rowHeader")}}var W=o(60),P=o(54);function Q(){var r=function(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number 
        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number\\x20
        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]);return Q=function(){return r},r}var O=!1;class A extends te{constructor(e){super("TR",e),this.orderView=new y(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){var{rowsToRender:e}=this.table;!O&&e>1e3&&(O=!0,Object(W.b)(Object(P.a)(Q()))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var n=0;n<e;n++)this.orderView.render();this.orderView.end()}}class Z extends te{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){var n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new z(e,s=>this.nodesPool.obtain(this.sourceRowIndex,s),this.nodeType),this.orderViews.set(e,n)),n}render(){for(var{rowsToRender:e,columnsToRender:n,rows:s,rowHeaders:u}=this.table,p=0;p<e;p++){var j=this.table.renderedRowToSource(p),K=s.getRenderedNode(p);this.sourceRowIndex=j;var J=this.obtainOrderView(K),ne=u.obtainOrderView(K);J.prependView(ne).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var he=0;he<n;he++){J.render();var ue=J.getCurrentNode(),je=this.table.renderedColumnToSource(he);Object(h.hasClass)(ue,"hide")||(ue.className=""),ue.removeAttribute("style"),this.table.cellRenderer(j,je,ue)}J.end()}}}class ee{constructor(e){var{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){var{rowHeaders:e,columnHeaders:n,colGroup:s,rows:u,cells:p}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),s.setTable(this),u.setTable(this),p.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=s,this.rows=u,this.cells=p}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();var{rowsToRender:e,rows:n,columnHeadersCount:s}=this;s===0?Object(h.addClass)(n.rootNode,"afterEmptyThead"):Object(h.removeClass)(n.rootNode,"afterEmptyThead");for(var u=0;u<e;u++){var p=n.getRenderedNode(u);if(p.firstChild){var j=this.renderedRowToSource(u),K=this.rowUtils.getHeight(j);p.firstChild.style.height=K?"".concat(K-1,"px"):""}}}}class de{constructor(){var{TABLE:e,THEAD:n,COLGROUP:s,TBODY:u,rowUtils:p,columnUtils:j,cellRenderer:K}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new ee(e,{cellRenderer:K}),this.renderer.setRenderers({rowHeaders:new D,columnHeaders:new k(n),colGroup:new G(s),rows:new A(u),cells:new Z}),this.renderer.setAxisUtils(p,j)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}render(){this.renderer.render()}}var be,Ne=o(43),Me=o(49),pe=/[-]{0,1}[\d]*[.]{0,1}[\d]+/g,Be=new Map;function Ce(r){var e=Be.get(r);if(e!==void 0)return e;var n=function(s){var[u,p,j]=s;return .2126*u+.7152*p+.0722*j}(function(s){be.ownerDocument.body.appendChild(be),be.style.color=s;var u=be.ownerDocument.defaultView,p=Object(h.getComputedStyle)(be,u).color.match(pe);return be.ownerDocument.body.removeChild(be),p===null||p.length<2?[0,0,0,1]:[parseInt(p[0],10),parseInt(p[1],10),parseInt(p[2],10),p.length>3?parseFloat(p[3]):1]}(r));return Be.set(r,n),n}var Oe=class{constructor(r){this.guid="wt_".concat(Object(Me.randomString)()),this.rootDocument=r.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,function(e){(be=e.document.createElement("span")).style.display="none"}(this.rootWindow)}getSetting(r,e,n,s,u){return this.wtSettings.getSetting(r,e,n,s,u)}hasSetting(r){return this.wtSettings.has(r)}},Ae=o(61),Ue=o(55),ze=o(46),Ge=new WeakMap,I=class{constructor(r){this.instance=r,this.eventManager=new Ne.a(r),Ge.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",e=>this.onContextMenu(e)),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",e=>this.onMouseOver(e)),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",e=>this.onMouseOut(e));var r=()=>{this.eventManager.addEventListener(this.instance.wtTable.holder,"touchstart",e=>this.onTouchStart(e)),this.eventManager.addEventListener(this.instance.wtTable.holder,"touchend",e=>this.onTouchEnd(e)),this.instance.momentumScrolling||(this.instance.momentumScrolling={}),this.eventManager.addEventListener(this.instance.wtTable.holder,"scroll",()=>{clearTimeout(this.instance.momentumScrolling._timeout),this.instance.momentumScrolling.ongoing||this.instance.getSetting("onBeforeTouchScroll"),this.instance.momentumScrolling.ongoing=!0,this.instance.momentumScrolling._timeout=setTimeout(()=>{this.instance.touchApplied||(this.instance.momentumScrolling.ongoing=!1,this.instance.getSetting("onAfterMomentumScroll"))},200)})};Object(ze.isMobileBrowser)()?r():(Object(Ue.isTouchSupported)()&&r(),(()=>{this.eventManager.addEventListener(this.instance.wtTable.holder,"mouseup",e=>this.onMouseUp(e)),this.eventManager.addEventListener(this.instance.wtTable.holder,"mousedown",e=>this.onMouseDown(e))})())}selectedCellWasTouched(r){var e=Ge.get(this),n=this.parentCell(r).coords;if(e.selectedCellBeforeTouchEnd&&n){var[s,u]=[n.row,e.selectedCellBeforeTouchEnd.from.row],[p,j]=[n.col,e.selectedCellBeforeTouchEnd.from.col];return s===u&&p===j}return!1}parentCell(r){var e={},n=this.instance.wtTable.TABLE,s=Object(h.closestDown)(r,["TD","TH"],n);return s?(e.coords=this.instance.wtTable.getCoords(s),e.TD=s):Object(h.hasClass)(r,"wtBorder")&&Object(h.hasClass)(r,"current")?(e.coords=this.instance.selections.getCell().cellRange.highlight,e.TD=this.instance.wtTable.getCell(e.coords)):Object(h.hasClass)(r,"wtBorder")&&Object(h.hasClass)(r,"area")&&this.instance.selections.createOrGetArea().cellRange&&(e.coords=this.instance.selections.createOrGetArea().cellRange.to,e.TD=this.instance.wtTable.getCell(e.coords)),e}onMouseDown(r){var e=Ge.get(this),n=this.instance.rootDocument.activeElement,s=Object(Ae.partial)(h.getParent,r.target),u=r.target;if(u!==n&&s(0)!==n&&s(1)!==n){var p=this.parentCell(u);Object(h.hasClass)(u,"corner")?this.instance.getSetting("onCellCornerMouseDown",r,u):p.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",r,p.coords,p.TD,this.instance),(r.button===0||this.instance.touchApplied)&&p.TD&&(e.dblClickOrigin[0]=p.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout(()=>{e.dblClickOrigin[0]=null},1e3))}}onContextMenu(r){if(this.instance.hasSetting("onCellContextMenu")){var e=this.parentCell(r.target);e.TD&&this.instance.getSetting("onCellContextMenu",r,e.coords,e.TD,this.instance)}}onMouseOver(r){if(this.instance.hasSetting("onCellMouseOver")){var e=this.instance.wtTable.TABLE,n=Object(h.closestDown)(r.target,["TD","TH"],e),s=this.instance.overlay?this.instance.overlay.master:this.instance;n&&n!==s.lastMouseOver&&Object(h.isChildOf)(n,e)&&(s.lastMouseOver=n,this.instance.getSetting("onCellMouseOver",r,this.instance.wtTable.getCoords(n),n,this.instance))}}onMouseOut(r){if(this.instance.hasSetting("onCellMouseOut")){var e=this.instance.wtTable.TABLE,n=Object(h.closestDown)(r.target,["TD","TH"],e),s=Object(h.closestDown)(r.relatedTarget,["TD","TH"],e);n&&n!==s&&Object(h.isChildOf)(n,e)&&this.instance.getSetting("onCellMouseOut",r,this.instance.wtTable.getCoords(n),n,this.instance)}}onMouseUp(r){var e=Ge.get(this),n=this.parentCell(r.target);n.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",r,n.coords,n.TD,this.instance),(r.button===0||this.instance.touchApplied)&&(n.TD===e.dblClickOrigin[0]&&n.TD===e.dblClickOrigin[1]?(Object(h.hasClass)(r.target,"corner")?this.instance.getSetting("onCellCornerDblClick",r,n.coords,n.TD,this.instance):this.instance.getSetting("onCellDblClick",r,n.coords,n.TD,this.instance),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):n.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout(()=>{e.dblClickOrigin[1]=null},500)))}onTouchStart(r){Ge.get(this).selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(r)}onTouchEnd(r){var e=r.target;this.selectedCellWasTouched(e)===!1&&["A","BUTTON","INPUT"].includes(e.tagName)&&r.preventDefault(),this.onMouseUp(r),this.instance.touchApplied=!1}destroy(){var r=Ge.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}},ge=class{constructor(r){this.wot=r}scrollViewport(r,e,n,s,u){if(r.col<0||r.row<0)return!1;var p=this.scrollViewportHorizontally(r.col,n,u),j=this.scrollViewportVertically(r.row,e,s);return p||j}scrollViewportHorizontally(r,e,n){if(!this.wot.drawn)return!1;var{fixedColumnsLeft:s,leftOverlay:u,totalColumns:p}=this._getVariables(),j=!1;if(r>=0&&r<=Math.max(p-1,0)){var K=this.getFirstVisibleColumn(),J=this.getLastVisibleColumn();r>=s&&K>-1&&(r<K||n)?j=u.scrollTo(r):(J===-1||J>-1&&(r>J||e))&&(j=u.scrollTo(r,!0))}return j}scrollViewportVertically(r,e,n){if(!this.wot.drawn)return!1;var{fixedRowsBottom:s,fixedRowsTop:u,topOverlay:p,totalRows:j}=this._getVariables(),K=!1;if(r>=0&&r<=Math.max(j-1,0)){var J=this.getFirstVisibleRow(),ne=this.getLastVisibleRow();r>=u&&J>-1&&(r<J||e)?K=p.scrollTo(r):(ne===-1||ne>-1&&(r>ne&&r<j-s||n))&&(K=p.scrollTo(r,!0))}return K}getFirstVisibleRow(){var{topOverlay:r,wtTable:e,wtViewport:n,totalRows:s,fixedRowsTop:u}=this._getVariables(),p=this.wot.rootWindow,j=e.getFirstVisibleRow();if(r.mainTableScrollableElement===p){var K=Object(h.offset)(e.wtRootElement),J=Object(h.innerHeight)(e.hider),ne=Object(h.innerHeight)(p),he=Object(h.getScrollTop)(p,p);if(K.top+J-ne<=he){var ue=n.getColumnHeaderHeight();ue+=r.sumCellSizes(0,u);for(var je=s;je>0;je--)if(ue+=r.sumCellSizes(je-1,je),K.top+J-ue<=he){j=je;break}}}return j}getLastVisibleRow(){var{topOverlay:r,wtTable:e,wtViewport:n,totalRows:s}=this._getVariables(),u=this.wot.rootWindow,p=e.getLastVisibleRow();if(r.mainTableScrollableElement===u){var j=Object(h.offset)(e.wtRootElement),K=Object(h.getScrollTop)(u,u);if(j.top>K){for(var J=Object(h.innerHeight)(u),ne=n.getColumnHeaderHeight(),he=1;he<=s;he++)if(ne+=r.sumCellSizes(he-1,he),j.top+ne-K>=J){p=he-2;break}}}return p}getFirstVisibleColumn(){var{leftOverlay:r,wtTable:e,wtViewport:n,totalColumns:s}=this._getVariables(),u=this.wot.rootWindow,p=e.getFirstVisibleColumn();if(r.mainTableScrollableElement===u){var j=Object(h.offset)(e.wtRootElement),K=Object(h.innerWidth)(e.hider),J=Object(h.innerWidth)(u),ne=Object(h.getScrollLeft)(u,u);if(j.left+K-J<=ne){for(var he=n.getRowHeaderWidth(),ue=s;ue>0;ue--)if(he+=r.sumCellSizes(ue-1,ue),j.left+K-he<=ne){p=ue;break}}}return p}getLastVisibleColumn(){var{leftOverlay:r,wtTable:e,wtViewport:n,totalColumns:s}=this._getVariables(),u=this.wot.rootWindow,p=e.getLastVisibleColumn();if(r.mainTableScrollableElement===u){var j=Object(h.offset)(e.wtRootElement),K=Object(h.getScrollLeft)(u,u);if(j.left>K){for(var J=Object(h.innerWidth)(u),ne=n.getRowHeaderWidth(),he=1;he<=s;he++)if(ne+=r.sumCellSizes(he-1,he),j.left+ne-K>=J){p=he-2;break}}}return p}_getVariables(){var{wot:r}=this;return{topOverlay:r.wtOverlays.topOverlay,leftOverlay:r.wtOverlays.leftOverlay,wtTable:r.wtTable,wtViewport:r.wtViewport,totalRows:r.getSetting("totalRows"),totalColumns:r.getSetting("totalColumns"),fixedRowsTop:r.getSetting("fixedRowsTop"),fixedRowsBottom:r.getSetting("fixedRowsBottom"),fixedColumnsLeft:r.getSetting("fixedColumnsLeft")}}},V=class extends Oe{constructor(r){super(r),this.overlay=r.overlay,this.overlayName=r.overlay.type,this.wtSettings=this.overlay.master.wtSettings,this.wtTable=r.createTableFn(this,r.table),this.wtScroll=new ge(this),this.wtViewport=this.overlay.master.wtViewport,this.wtEvent=new I(this),this.selections=this.overlay.master.selections}drawClone(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this.wtTable.draw(r),this}getOverlayName(){return this.overlayName}},q={};class B{static get CLONE_TOP(){return"top"}static get CLONE_BOTTOM(){return"bottom"}static get CLONE_LEFT(){return"left"}static get CLONE_TOP_LEFT_CORNER(){return"top_left_corner"}static get CLONE_BOTTOM_LEFT_CORNER(){return"bottom_left_corner"}static get CLONE_TYPES(){return[B.CLONE_TOP,B.CLONE_BOTTOM,B.CLONE_LEFT,B.CLONE_TOP_LEFT_CORNER,B.CLONE_BOTTOM_LEFT_CORNER]}static registerOverlay(e,n){if(B.CLONE_TYPES.indexOf(e)===-1)throw new Error("Unsupported overlay (".concat(e,")."));q[e]=n}static createOverlay(e,n){return new q[e](n)}static hasOverlay(e){return q[e]!==void 0}constructor(e){this.master=e,this.type="",this.mainTableScrollableElement=null,this.areElementSizesAdjusted=!1}updateStateOfRendering(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered(),e&&!this.needFullRender&&this.resetElementsSize()}shouldBeRendered(){return!0}updateMainScrollableElement(){var{master:e}=this;Object(h.getComputedStyle)(e.wtTable.wtRootElement.parentNode,e.rootWindow).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.wtTable.holder:this.mainTableScrollableElement=Object(h.getScrollableElement)(e.wtTable.TABLE)}getRelativeCellPosition(e,n,s){if(this.clone.wtTable.holder.contains(e)!==!1){var u=this.mainTableScrollableElement===this.master.rootWindow,p=s<this.master.getSetting("fixedColumnsLeft"),j=n<this.master.getSetting("fixedRowsTop"),K=n>=this.master.getSetting("totalRows")-this.master.getSetting("fixedRowsBottom"),J={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},ne={left:e.offsetLeft,top:e.offsetTop};return u?this.getRelativeCellPositionWithinWindow(j,p,ne,J):this.getRelativeCellPositionWithinHolder(j,K,p,ne,J)}Object(W.b)("The provided element is not a child of the ".concat(this.type," overlay"))}getRelativeCellPositionWithinWindow(e,n,s,u){var p=Object(h.getBoundingClientRect)(this.master.wtTable.wtRootElement),j=0,K=0;return j=n?p.left<=0?-1*p.left:0:u.left,e?K=Object(h.getBoundingClientRect)(this.clone.wtTable.TABLE).top-p.top:K=u.top,{left:s.left+j,top:s.top+K}}getRelativeCellPositionWithinHolder(e,n,s,u,p){var j=this.clone.overlay.master.wtOverlays.leftOverlay.getScrollPosition(),K=this.clone.overlay.master.wtOverlays.topOverlay.getScrollPosition(),J=0,ne=0;if(s||(J=j-p.left),n){var he=Object(h.getBoundingClientRect)(this.master.wtTable.wtRootElement);ne=-1*Object(h.getBoundingClientRect)(this.clone.wtTable.TABLE).top+he.top}else e||(ne=K-p.top);return{left:u.left-J,top:u.top-ne}}makeClone(e){if(B.CLONE_TYPES.indexOf(e)===-1)throw new Error('Clone type "'.concat(e,'" is not supported.'));var{master:n}=this,s=n.rootDocument.createElement("DIV"),u=n.rootDocument.createElement("TABLE");s.className="ht_clone_".concat(e," handsontable"),s.style.position="absolute",s.style.top=0,s.style.left=0,s.style.overflow="visible",u.className=n.wtTable.TABLE.className,s.appendChild(u),this.type=e,n.wtTable.wtRootElement.parentNode.appendChild(s);var p=n.getSetting("preventOverflow");return p===!0||p==="horizontal"&&this.type===B.CLONE_TOP||p==="vertical"&&this.type===B.CLONE_LEFT?this.mainTableScrollableElement=n.rootWindow:Object(h.getComputedStyle)(n.wtTable.wtRootElement.parentNode,n.rootWindow).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=n.wtTable.holder:this.mainTableScrollableElement=Object(h.getScrollableElement)(n.wtTable.TABLE),new V({overlay:this,createTableFn:this.createTable,table:u})}redrawClone(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.adjustElementsPosition(),this.needFullRender&&this.clone.drawClone(e)}resetElementsSize(){var{clone:e}=this;e.wtTable.holder.style.width="",e.wtTable.holder.style.height="",e.wtTable.hider.style.width="",e.wtTable.hider.style.height="",e.wtTable.wtRootElement.style.width="",e.wtTable.wtRootElement.style.height=""}destroy(){new Ne.a(this.clone).destroy()}}var se,ie=B;function Ee(r){r.command=""}function ye(r){r.renderedCommand!==r.command&&(r.elem.setAttribute("d",r.command),r.renderedCommand=r.command)}function _e(r,e){var n=r.split(" "),s=e.split(" "),u=parseInt(n[0],10),p=parseInt(s[0],10);n.shift(),n.shift(),s.shift(),s.shift();var j,K,J=n.join(" "),ne=s.join(" ");return u>p?1:u<p?-1:(j=Ce(ne),K=Ce(J),j>K?1:j<K?-1:0)}function st(r,e,n){var s=r.get(e);if(!s){var u=n.ownerDocument.createElementNS("http://www.w3.org/2000/svg","path"),p=e.split(" "),j=parseInt(p[0],10);p.shift(),p.shift();var K=p.join(" ");u.setAttribute("stroke",K),u.setAttribute("stroke-width",j),u.setAttribute("shape-rendering","geometricPrecision"),u.setAttribute("data-stroke-style",e),Ee(s={elem:u,command:"",renderedCommand:""});for(var J=null,ne=n.firstElementChild;ne;){if(_e(e,ne.getAttribute("data-stroke-style"))===-1){J=ne;break}ne=ne.nextSibling}J?n.insertBefore(u,J):n.appendChild(u),r.set(e,s)}return s}function at(r){for(var e="M ",n=0;n<r.length;n++)e+=n>1&&n%2==0?" L ".concat(r[n]):" ".concat(r[n]);return e}function it(r){return"M ".concat(r.join(" "))}function Xe(r){for(var e=[],n=new Map,s=0;s<r.length;s++){var u=r[s],p=u[1]===u[3]?"h-".concat(u[1]):"v-".concat(u[0]),j=n.get(p);j?j.push(u):n.set(p,[u])}return n.forEach(K=>{K.length>1?e.push(...function(J){var ne=0;do{var he=J[ne],ue=he[1]===he[3],je=void 0;do{je=!1;for(var We=ne+1;We<J.length;We++){var Pe=J[We];if(!Pe.deleted&&(Je=he,je=vt((Ze=Pe)[0],Ze[1],Je)||vt(Ze[2],Ze[3],Je))){var Qe=yt(he,Pe);ue?(he[0]=Qe.low[0],he[2]=Qe.high[0]):(he[1]=Qe.low[1],he[3]=Qe.high[1]),Pe.deleted=!0;break}}}while(je);ne+=1}while(ne<J.length);var Je,Ze;return J.filter(qe=>!qe.deleted)}(K)):e.push(K[0])}),e}function vt(r,e,n){return!!lt(r,n[0],n[2])&&lt(e,n[1],n[3])}function lt(r,e,n){return n>e?r>=e&&r<=n:r>=n&&r<=e}function yt(r,e){var n,s,u=Rt(r),p=Rt(e);return s=p,rt((n=u).low,s.low,Math.min),rt(n.high,s.high,Math.max),n}function Rt(r){return{low:Et(r,Math.min),high:Et(r,Math.max)}}function Et(r,e){return[e(r[0],r[2]),e(r[1],r[3])]}function rt(r,e,n){r[0]=n(r[0],e[0]),r[1]=n(r[1],e[1])}function Mt(r){for(var e=new g,n=[],s=0;s<r.length;s++){var u=r[s],p=e.insertValue({pathContext:u,reversed:!1});e.insertValueIdAtPoint(p,v(u));var j=e.insertValue({pathContext:u,reversed:!0});e.insertValueIdAtPoint(j,F(u))}var K=[];e.forEachPoint((ne,he)=>{if(he.length>0){var ue=[];if(re(e,ne[0],ue,ne[0]),ue.endless)n.push(ue);else{ue.reverse();var je=ue[0];ue.forEach(Je=>{Je.reversed=!Je.reversed});var We=ue.pop();re(e,We,ue,je),ue.length>1?(ue.endless=(Pe=Se(ue[0],!0),Qe=Se(ue[ue.length-1]),Pe[0]===Qe[0]&&Pe[1]===Qe[1]),n.push(ue)):K.push(ue[0].pathContext)}}var Pe,Qe});var J=[];return n.forEach(ne=>{J.push(function(he){var ue=[];ue.push(...le(he[0].pathContext,!he[0].reversed));for(var je=0;je<he.length;je++)ue.push(...le(he[je].pathContext,he[je].reversed));return ue}(ne))}),K.forEach(ne=>{J.push(ne)}),J}function g(){this.reset()}function v(r){return r.slice(0,2)}function F(r){return r.slice(2,4)}function re(r,e,n,s){for(;e;){n.push(e);var u=le(e.pathContext,e.reversed),p=r.getElementAtPoint(u);if(!p||p.length===0)break;var j=fe(p.map(K=>r.values[K]),e.pathContext);if(p.splice(0,2),!j)break;if(j.pathContext===s.pathContext){n.length>1&&(n.endless=!0);break}e=j}}function le(r,e){return e?v(r):F(r)}function fe(r,e){return r[0].pathContext===e?r[1]:r[0]}function Se(r,e){return e===r.reversed?F(r.pathContext):v(r.pathContext)}function ve(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}g.prototype.reset=function(){this.insertedCount=0,this.graph={},this.index={},this.values=[]},g.prototype.insertValue=function(r){return this.values.push(r),this.values.length-1},g.prototype.insertValueIdAtPoint=function(r,e){var n=e[0],s=e[1];this.graph[n]||(this.graph[n]={});var u,p,j=this.graph[n];s in j?(p=j[s],(u=this.index[p]).push(r)):(p=this.insertedCount,j[s]=p,this.insertedCount+=1,u=[r],this.index[p]=u)},g.prototype.forEachPoint=function(r){for(var e=0;e<this.insertedCount;e++){var n=this.index[e];n&&n.length>0&&r(n.map(s=>this.values[s]),n)}},g.prototype.getIdOfPoint=function(r){var e=this.graph[r[0]];if(e){var n=e[r[1]];if(n>=0)return n}},g.prototype.getElementAtPoint=function(r){var e=this.getIdOfPoint(r);if(e>=0)return this.index[e]};class He{constructor(e){ve(this,"rootDocument",void 0),ve(this,"uniqueDomInnerClipId",void 0),ve(this,"svg",void 0),ve(this,"rect",void 0),this.rootDocument=e,this.uniqueDomInnerClipId="".concat(Object(Me.randomString)(),"-inner-clip"),this.createElement()}createSvgGroup(e){var n=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","g");return e&&n.setAttribute("clip-path","url(#".concat(this.uniqueDomInnerClipId)),this.svg.appendChild(n),n}setClipAttributes(e){Object.keys(e).forEach(n=>{this.rect.setAttribute(n,e[n])})}createElement(){if(this.svg===void 0){var e=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","svg");e.style.top="0",e.style.left="0",e.style.width="0",e.style.height="0",e.style.position="absolute",e.style.zIndex="5",e.setAttribute("pointer-events","none"),e.setAttribute("class","wtBorders");var n=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","defs"),s=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","clipPath"),u=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("id",this.uniqueDomInnerClipId),s.appendChild(u),n.appendChild(s),e.appendChild(n),this.rect=u,this.svg=e}}}var Re=-T.a;class L{constructor(e,n,s){var u,p,j;this.overlayName=n,this.getCellFn=s,this.svgElement=new He(e.ownerDocument),this.svgResizer=(u=this.svgElement.svg,(K,J)=>{K=Math.max(K,0),J=Math.max(J,0),K===p&&J===j||(u.setAttribute("viewBox","0 0 ".concat(K," ").concat(J)),K!==p&&(u.style.width="".concat(K,"px"),u.setAttribute("width",K),p=K),J!==j&&(u.style.height="".concat(J,"px"),u.setAttribute("height",J),j=J))}),this.pathGroups=[],this.containerBoundingRect=null,this.maxSvgWidth=0,this.maxSvgHeight=0,this.rootWindow=e.ownerDocument.defaultView,e.appendChild(this.svgElement.svg)}ensurePathGroup(e){var n=this.pathGroups[e];if(!n){this.pathGroups.length<e&&this.ensurePathGroup(e-1);var s=e===0,u={svgPathsRenderer:this.getSvgPathsRendererForGroup(s),stylesAndLines:new Map,styles:[],commands:[]};return this.pathGroups[e]=u,u}return n}render(e,n,s){this.containerBoundingRect=Object(h.getBoundingClientRect)(e),this.pathGroups.forEach(ue=>ue.stylesAndLines.clear());for(var u=e.querySelector("tbody td"),p=u?Object(h.getBoundingClientRect)(u):null,j=0;j<s.length;j++)this.convertBorderEdgesDescriptorToLines(s[j]);this.pathGroups.forEach(ue=>this.convertLinesToCommands(ue));var K=Math.min(this.maxSvgWidth,this.containerBoundingRect.width),J=Math.min(this.maxSvgHeight,this.containerBoundingRect.height);if(this.svgResizer(K,J),p){var ne=n.left+p.left-this.containerBoundingRect.left+Re,he=n.top+p.top-this.containerBoundingRect.top+Re;this.svgElement.setClipAttributes({width:Math.max(K-ne-n.right,0),height:Math.max(J-he-n.bottom,0),x:ne,y:he})}this.pathGroups.forEach(ue=>ue.svgPathsRenderer(ue.styles,ue.commands))}sumArrayElementAtIndex(e,n){return e.reduce((s,u)=>Math.max(s,u[n]),0)}setIn2dMap(e,n,s,u){var p=e.get(n);p?p.set(s,u):e.set(n,new Map([[s,u]]))}adjustTipsOfLines(e,n,s,u){if(e.length!==0)for(var p=0;p<e.length;p++){var j,K,J=e[p],ne=J[0]===J[2],he=ne?s:u,ue=ne?u:s,je=ne?1:0,We=J.length,Pe=We-2,Qe=We-1,Je=ne?Qe:Pe,Ze=(j=he.get(J[0]))===null||j===void 0?void 0:j.get(J[1]),qe=(K=he.get(J[Pe]))===null||K===void 0?void 0:K.get(J[Qe]);if(n>1)for(var tt=0;tt<We;tt+=2)this.setIn2dMap(ue,J[tt],J[tt+1],n);if(Ze&&(J[je]-=Math.floor(Ze/2)),J[Je]+=T.a,qe){var nt=qe%2==0?-1:0;J[Je]+=Math.floor(qe/2)+nt}}}convertLinesToCommands(e){var{stylesAndLines:n,commands:s}=e,u=[...n.keys()],p=new Map,j=new Map;s.length=0,e.styles=u.sort(_e),e.styles.forEach(K=>{var J=n.get(K),ne=parseInt(K,10);this.adjustTipsOfLines(J,ne,p,j);var he=function(Pe,Qe){for(var Je="",Ze=-1,qe=-1,tt=-1,nt=-1,ut=0;ut<Pe.length;ut++){var dt=Pe[ut];ut===0&&(Ze=dt[0],qe=dt[1]);var ft=dt.length;tt=dt[ft-2],nt=dt[ft-1],ut>0&&(Je+=" "),Je+=se(dt)}var Vt=Pe[0],Dt=Pe[Pe.length-1];if(Ze!==tt||qe!==nt){if(Qe===1){var Ot=Dt.length;Je="M ".concat(Vt[2]," ").concat(Vt[3]," ").concat(Je.substring(2)," ").concat(Dt[Ot-4]," ").concat(Dt[Ot-3])}}else Je+=" Z";return Je}(function(Pe){return Mt(Xe(Pe))}(function(Pe,Qe){for(var Je=new Array(Qe.length),Ze=Pe%2!=0,qe=0;qe<Qe.length;qe++){var[tt,nt,ut,dt]=Qe[qe];Ze&&(nt===dt?(nt+=.5,dt+=.5):(tt+=.5,ut+=.5)),Je[qe]=[tt,nt,ut,dt]}return Je}(ne,J))),ue=Math.ceil(ne/2),je=this.sumArrayElementAtIndex(J,2)+ue,We=this.sumArrayElementAtIndex(J,3)+ue;je>this.maxSvgWidth&&(this.maxSvgWidth=je),We>this.maxSvgHeight&&(this.maxSvgHeight=We),s.push(he)})}getSvgPathsRendererForGroup(e){return function(n){se||(se=function(u){var p=u.createElementNS("http://www.w3.org/2000/svg","path");return p.setAttribute("d","M 0 0 10 0"),p.getAttribute("d")!=="M 0 0 10 0"}(n.ownerDocument)?at:it),n.setAttribute("fill","none");var s=new Map;return(u,p)=>{s.forEach(Ee);for(var j=0;j<u.length;j++)st(s,u[j],n).command=p[j];s.forEach(ye)}}(this.svgElement.createSvgGroup(e))}getLayerNumber(e){switch(e.className){case"current":return 3;case"area":return 2;case"fill":return 1;default:return 0}}convertBorderEdgesDescriptorToLines(e){var{settings:n,selectionStart:s,selectionEnd:u,hasTopEdge:p,hasRightEdge:j,hasBottomEdge:K,hasLeftEdge:J}=e,ne=this.getLayerNumber(n),he=this.ensurePathGroup(ne).stylesAndLines,ue=s.row===u.row&&s.col===u.col,je=0,We=0,Pe=this.getCellFn(s);if(Pe===-1&&(s.row+=1,Pe=this.getCellFn(s),We=-1),Pe===-2&&(s.row-=1,Pe=this.getCellFn(s),We=1),Pe===-4&&(s.col-=1,Pe=this.getCellFn(s),je=1),typeof Pe=="object"){var Qe,Je=0,Ze=0;if(ue?(Qe=Pe,Je=je,Ze=We):((Qe=this.getCellFn(u))===-1&&(u.row+=1,Qe=this.getCellFn(u),Ze=-1),Qe===-2&&(u.row-=1,Qe=this.getCellFn(u),Ze=1),Qe===-4&&(u.col-=1,Qe=this.getCellFn(u),Je=1)),typeof Qe=="object"){var qe=Object(h.getBoundingClientRect)(Pe),tt=Pe===Qe?qe:Object(h.getBoundingClientRect)(Qe),nt=qe.left,ut=qe.top,dt=tt.left+tt.width,ft=tt.top+tt.height;nt+=je*qe.width,ut+=We*qe.height,dt+=Je*tt.width,ft+=Ze*tt.height;var Vt=!(Pe.nodeName==="TH"||Pe.previousElementSibling),Dt=!Pe.parentNode.previousElementSibling&&!Pe.parentNode.parentNode.previousElementSibling.firstElementChild;if(Vt||(nt+=Re),Dt||(ut+=Re),nt+=-this.containerBoundingRect.left,ut+=-this.containerBoundingRect.top,dt+=Re-this.containerBoundingRect.left,ft+=Re-this.containerBoundingRect.top,n.border&&n.border.width&&n.border.strokeAlignment==="inside"){var Ot=Math.floor(n.border.width/2),Ht=Math.ceil(n.border.width/2)-1;nt+=Ot,ut+=Ot,dt-=Ht,ft-=Ht}this.overlayName!=="bottom"&&this.overlayName!=="bottom_left_corner"||ft===-1&&(ft=0),p&&this.hasLineAtEdge(n,"top")&&this.getLines(he,n,"top").push([nt,ut,dt,ut]),j&&this.hasLineAtEdge(n,"right")&&this.getLines(he,n,"right").push([dt,ut,dt,ft]),K&&this.hasLineAtEdge(n,"bottom")&&this.getLines(he,n,"bottom").push([nt,ft,dt,ft]),J&&this.hasLineAtEdge(n,"left")&&this.getLines(he,n,"left").push([nt,ut,nt,ft])}}}hasLineAtEdge(e,n){return!(e[n]&&e[n].hide)}getLines(e,n,s){var u=1;n[s]&&n[s].width!==void 0?u=n[s].width:n.border&&n.border.width!==void 0&&(u=n.border.width);var p=n[s]&&n[s].color||n.border&&n.border.color||"black",j="".concat(u,"px solid ").concat(p),K=e.get(j);if(K)return K;var J=[];return e.set(j,J),J}}var l=o(32),t=o(33),i=o(74),a=class{constructor(r){this.wot=r;var{rootDocument:e,rootWindow:n,wtTable:s}=this.wot,u=parseInt(Object(h.getComputedStyle)(e.body,n).lineHeight,10),p=1.2*parseInt(Object(h.getComputedStyle)(e.body,n).fontSize,10);this.eventManager=new Ne.a(this.wot),this.scrollbarSize=Object(h.getScrollbarWidth)(e),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var j=Object(h.getComputedStyle)(s.wtRootElement.parentNode,n).getPropertyValue("overflow")==="hidden";this.scrollableElement=j?s.holder:Object(h.getScrollableElement)(s.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=u||p,this.registerListeners(),this.lastScrollX=n.scrollX,this.lastScrollY=n.scrollY}prepareOverlays(){this.topOverlay?this.topOverlay.updateStateOfRendering():this.topOverlay=ie.createOverlay(ie.CLONE_TOP,this.wot),ie.hasOverlay(ie.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:()=>{}}),ie.hasOverlay(ie.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:()=>{}}),this.bottomOverlay?this.bottomOverlay.updateStateOfRendering():this.bottomOverlay=ie.createOverlay(ie.CLONE_BOTTOM,this.wot),this.leftOverlay?this.leftOverlay.updateStateOfRendering():this.leftOverlay=ie.createOverlay(ie.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?this.topLeftCornerOverlay.updateStateOfRendering():this.topLeftCornerOverlay=ie.createOverlay(ie.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?this.bottomLeftCornerOverlay.updateStateOfRendering():this.bottomLeftCornerOverlay=ie.createOverlay(ie.CLONE_BOTTOM_LEFT_CORNER,this.wot))}refreshMasterAndClones(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){var{rootDocument:r,rootWindow:e}=this.wot,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:s}=this.leftOverlay;this.eventManager.addEventListener(r.documentElement,"keydown",ne=>this.onKeyDown(ne)),this.eventManager.addEventListener(r.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",ne=>this.onTableScroll(ne),{passive:!0}),n!==s&&this.eventManager.addEventListener(s,"scroll",ne=>this.onTableScroll(ne),{passive:!0});var u,p=e.devicePixelRatio&&e.devicePixelRatio>1,j=this.scrollableElement===e,K=this.wot.wtSettings.getSetting("preventWheel"),J={passive:j};(K||p||!Object(ze.isChrome)())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",ne=>this.onCloneWheel(ne,K),J),[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay].forEach(ne=>{if(ne&&ne.needFullRender){var{holder:he}=ne.clone.wtTable;this.eventManager.addEventListener(he,"wheel",ue=>this.onCloneWheel(ue,K),J)}}),this.eventManager.addEventListener(e,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wot.getSetting("onWindowResize")},200)})}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(r){var e=this.wot.rootWindow,n=this.leftOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,u=r.target;this.keyPressed&&(s!==e&&u!==e&&!r.target.contains(s)||n!==e&&u!==e&&!r.target.contains(n))||(this.propagateMasterScrollPositionsToClones(),this.refreshMasterAndClones())}onCloneWheel(r,e){var{rootWindow:n}=this.wot,s=this.leftOverlay.mainTableScrollableElement,u=this.topOverlay.mainTableScrollableElement,p=r.target,j=u!==n&&p!==n&&!p.contains(u),K=s!==n&&p!==n&&!p.contains(s);if(!this.keyPressed||!j&&!K){var J=this.translateMouseWheelToScroll(r);(e||this.scrollableElement!==n&&J)&&r.preventDefault()}}onKeyDown(r){this.keyPressed=Object(i.isKey)(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(r){var e=this.browserLineHeight,n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,s=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(s+=s*e,n+=n*e);var u=this.scrollVertically(n),p=this.scrollHorizontally(s);return u||p}scrollVertically(r){var e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,e!==this.scrollableElement.scrollTop}scrollHorizontally(r){var e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,e!==this.scrollableElement.scrollLeft}propagateMasterScrollPositionsToClones(){if(!this.destroyed){var{rootWindow:r}=this.wot,e=this.topOverlay.clone.wtTable.holder,n=this.leftOverlay.clone.wtTable.holder,s=this.bottomOverlay.clone.wtTable.holder,[u,p]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];this.horizontalScrolling=e.scrollLeft!==u||this.lastScrollX!==r.scrollX,this.verticalScrolling=n.scrollTop!==p||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling&&(this.topOverlay.needFullRender&&(e.scrollLeft=u),this.bottomOverlay.needFullRender&&(s.scrollLeft=u)),this.verticalScrolling&&this.leftOverlay.needFullRender&&(n.scrollTop=p)}}updateMainScrollableElements(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var{rootWindow:r,wtTable:e}=this.wot;Object(h.getComputedStyle)(e.wtRootElement.parentNode,r).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Object(h.getScrollableElement)(e.TABLE),this.registerListeners()}destroy(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.destroyed=!0}refreshClones(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(r||this.prepareOverlays(),this.bottomOverlay.clone&&this.bottomOverlay.redrawClone(r),this.leftOverlay.redrawClone(r),this.topOverlay.redrawClone(r),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.redrawClone(r),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.redrawClone(r),this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var e=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=Object(h.clientWidth)(e),s=Object(h.clientHeight)(e);n===this.spreaderLastSize.width&&s===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=s,this.adjustElementsSizes())}else r||this.adjustElementsSizes()}adjustElementsSizes(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],{wtViewport:e,wtTable:n}=this.wot,s=this.wot.getSetting("totalColumns"),u=this.wot.getSetting("totalRows"),p=e.getRowHeaderWidth(),j=e.getColumnHeaderHeight(),K=n.hider.style,J=p||T.a,ne=j||T.a;if(K.width="".concat(J+this.leftOverlay.sumCellSizes(0,s),"px"),K.height="".concat(ne+this.topOverlay.sumCellSizes(0,u),"px"),this.scrollbarSize>0){var{scrollHeight:he,scrollWidth:ue}=n.wtRootElement,{scrollHeight:je,scrollWidth:We}=n.holder;this.hasScrollbarRight=he<je,this.hasScrollbarBottom=ue<We,this.hasScrollbarRight&&Object(h.scrollWidth)(n.hider)+this.scrollbarSize>ue?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&Object(h.scrollHeight)(n.hider)+this.scrollbarSize>he&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.leftOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.adjustElementsSize(r),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.adjustElementsSize(r)}getParentOverlay(r){if(!r)return null;var e=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return Object(t.arrayEach)(e,s=>{s&&s.clone&&s.clone.wtTable.TABLE.contains(r)&&(n=s.clone)}),n}syncOverlayTableClassNames(){var r=this.wot.wtTable.TABLE,e=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];Object(t.arrayEach)(e,n=>{n&&(n.clone.wtTable.TABLE.className=r.className)})}},m=class{constructor(r,e){this.wot=r,this.defaults={table:void 0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(n,s,u)=>{var p=this.getSetting("data",n,s);Object(h.fastInnerText)(u,p==null?"":p)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:n=>n,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},Object(l.objectEach)(this.defaults,(n,s)=>{if(e[s]!==void 0)this.settings[s]=e[s];else{if(n===void 0)throw new Error('A required setting "'.concat(s,'" was not provided'));this.settings[s]=n}})}update(r,e){return e===void 0?Object(l.objectEach)(r,(n,s)=>{this.settings[s]=n}):this.settings[r]=e,this.wot}getSetting(r,e,n,s,u){return typeof this.settings[r]=="function"?this.settings[r](e,n,s,u):e!==void 0&&Array.isArray(this.settings[r])?this.settings[r][e]:this.settings[r]}has(r){return!!this.settings[r]}},b=class{constructor(r){this.wot=r,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked=!1,this.clientHeight=this._getWorkspaceHeight(),this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new Ne.a(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",()=>{this.clientHeight=this._getWorkspaceHeight()})}getWorkspaceHeight(){return this.clientHeight}_getWorkspaceHeight(){var r=this.wot.rootDocument,e=this.wot.wtTable.trimmingContainer,n=0;return e===this.wot.rootWindow?n=Object(h.clientHeight)(r.documentElement):n=Object(h.outerHeight)(e)>0&&Object(h.clientHeight)(e)>0?Object(h.clientHeight)(e):1/0,n}getWorkspaceWidth(){return window.innerWidth}hasVerticalScroll(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}sumColumnWidths(r,e){for(var n=0,s=r;s<e;)n+=this.wot.columnUtils.getWidth(s),s+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;var r=this.wot.wtTable.holder,e=this.wot.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",r.appendChild(e);var n=Object(h.offsetWidth)(e);return this.containerWidth=n,r.removeChild(e),n}getWorkspaceOffset(){return Object(h.offset)(this.wot.wtTable.TABLE)}getWorkspaceActualHeight(){return Object(h.outerHeight)(this.wot.wtTable.TABLE)}getWorkspaceActualWidth(){var{wtTable:r}=this.wot;return Object(h.outerWidth)(r.TABLE)||Object(h.outerWidth)(r.TBODY)||Object(h.outerWidth)(r.THEAD)}getColumnHeaderHeight(){return this.columnHeaderHeight||(this.wot.getSetting("columnHeaders").length?this.columnHeaderHeight||(this.columnHeaderHeight=Object(h.outerHeight)(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0),this.columnHeaderHeight}getViewportHeight(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var e=this.getColumnHeaderHeight();return e>0&&(r-=e),r}getRowHeaderWidth(){return this.rowHeaderWidth=50,this.rowHeaderWidth}getViewportWidth(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var e=this.getRowHeaderWidth();return e>0?r-e:r-T.a}createRowsCalculator(){var r,e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{wot:s}=this,{wtSettings:u,wtOverlays:p,wtTable:j,rootDocument:K}=s;this.rowHeaderWidth=NaN,r=u.settings.renderAllRows&&n===1?1/0:this.getViewportHeight();var J=p.topOverlay.getScrollPosition()-p.topOverlay.getTableParentOffset();J<0&&(J=0);var ne=s.getSetting("fixedRowsTop"),he=s.getSetting("fixedRowsBottom"),ue=s.getSetting("totalRows");return ne&&(J+=e=p.topOverlay.sumCellSizes(0,ne),r-=e),he&&p.bottomOverlay.clone&&(r-=e=p.bottomOverlay.sumCellSizes(ue-he,ue)),new _({viewportSize:r,scrollOffset:J,totalItems:s.getSetting("totalRows"),itemSizeFn:je=>s.rowUtils.getHeight(je),overrideFn:u.settings.viewportRowCalculatorOverride,calculationType:n,scrollbarHeight:0})}createColumnsCalculator(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{wot:e}=this,{wtSettings:n,wtOverlays:s,wtTable:u,rootDocument:p}=e,j=this.getViewportWidth(),K=s.leftOverlay.getScrollPosition()-s.leftOverlay.getTableParentOffset();K<0&&(K=0);var J=e.getSetting("fixedColumnsLeft");if(J){var ne=s.leftOverlay.sumCellSizes(0,J);K+=ne,j-=ne}return new X({viewportSize:j,scrollOffset:K,totalItems:e.getSetting("totalColumns"),itemSizeFn:he=>e.columnUtils.getWidth(he),overrideFn:n.settings.viewportColumnCalculatorOverride,calculationType:r,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:(he,ue)=>e.getSetting("onBeforeStretchingColumnWidth",he,ue)})}createRenderCalculators(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(r){var e=this.createRowsCalculator(2),n=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(e)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(r=!1)}return r||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,r}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}areAllProposedVisibleRowsAlreadyRendered(r){if(!this.rowsVisibleCalculator)return!1;var{startRow:e,endRow:n}=r,{startRow:s,endRow:u}=this.rowsRenderCalculator;return!(e<s||e===s&&e>0)&&!(n>u||n===u&&n<this.wot.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(r){if(!this.columnsVisibleCalculator)return!1;var{startColumn:e,endColumn:n}=r,{startColumn:s,endColumn:u}=this.columnsRenderCalculator;return!(e<s||e===s&&e>0)&&!(n>u||n===u&&n<this.wot.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){this.hasOversizedColumnHeadersMarked=!1}};class H{constructor(e){this.wot=e,this.headerWidths=new Map}getWidth(e){var n=this.wot.wtSettings.settings.columnWidth;return typeof n=="function"?n=n(e):typeof n=="object"&&(n=n[e]),n||this.wot.wtSettings.settings.defaultColumnWidth}getStretchedColumnWidth(e){var n=this.getWidth(e),s=this.wot.wtViewport.columnsRenderCalculator,u=n==null?this.wot.wtSettings.settings.defaultColumnWidth:n;if(s){var p=s.getStretchedColumnWidth(e,u);p&&(u=p)}return u}getHeaderHeight(e){var n=this.wot.wtSettings.settings.defaultRowHeight,s=this.wot.wtViewport.oversizedColumnHeaders[e];return s!==void 0&&(n=n?Math.max(n,s):s),n}getHeaderWidth(e){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){var{wot:e}=this,n=e.getSetting("rowHeaderWidth");(n=e.getSetting("onModifyRowHeaderWidth",n))==null&&(n=50);for(var s=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth"),p=0;p<s;p++){var j=Array.isArray(n)?n[p]:n;j=j==null?u:j,this.headerWidths.set(p,j)}}}class ${constructor(e){this.wot=e}getHeight(e){var n=this.wot.wtSettings.settings.rowHeight(e),s=this.wot.wtViewport.oversizedRows[e];return s!==void 0&&(n=n===void 0?s:Math.max(n,s)),n}}var me=class extends Oe{constructor(r){super(r),this.wtSettings=new m(this,r),this.rowUtils=new $(this),this.columnUtils=new H(this),this.wtTable=new ae(this,r.table),this.wtScroll=new ge(this),this.wtViewport=new b(this),this.wtEvent=new I(this),this.selections=this.getSetting("selections"),this.wtOverlays=new a(this),this.exportSettingsAsClassNames();var e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,s=this.wtTable.THEAD.childNodes[0].childNodes.length;n<s;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(u,p){Object(h.fastInnerText)(p,e[u])}])}this.drawn=!1,this.drawInterrupted=!1}draw(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return Object(h.clearMemoizedFunctionsBeforeRender)(),this.drawInterrupted=!1,r||this.wtTable.isVisible()?(this.wtTable.draw(r),this.drawn=!0):this.drawInterrupted=!0,this}getCell(r){if(!(arguments.length>1&&arguments[1]!==void 0&&arguments[1]))return this.wtTable.getCell(r);var e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),u=this.wtSettings.getSetting("fixedColumnsLeft");if(r.row<n&&r.col<u)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(r);if(r.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<u&&r.row>=e-s){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<u)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(r);if(r.row<e&&r.row>=e-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}update(r,e){return this.wtSettings.update(r,e)}scrollViewport(r,e,n,s,u){return!(r.col<0||r.row<0)&&this.wtScroll.scrollViewport(r,e,n,s,u)}scrollViewportHorizontally(r,e,n){return!(r<0)&&this.wtScroll.scrollViewportHorizontally(r,e,n)}scrollViewportVertically(r,e,n){return!(r<0)&&this.wtScroll.scrollViewportVertically(r,e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}exportSettingsAsClassNames(){var r=[],e=[];Object(l.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(n,s)=>{this.getSetting(s).length&&e.push(n),r.push(n)}),Object(h.removeClass)(this.wtTable.wtRootElement.parentNode,r),Object(h.addClass)(this.wtTable.wtRootElement.parentNode,e)}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},Te=class{constructor(r,e){this.isMaster=r instanceof me,this.wot=r,this.TABLE=e,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.hasTableHeight=!0,this.hasTableWidth=!0,Object(h.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1,this.tableRenderer=new de({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.isMaster?this.wot.rowUtils:this.wot.overlay.master.rowUtils,columnUtils:this.isMaster?this.wot.columnUtils:this.wot.overlay.master.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer}),this.borderRenderer=new L(this.spreader,this.isMaster?"master":this.wot.getOverlayName(),this.getCell.bind(this))}is(r){return!this.isMaster&&this.wot.getOverlayName()===r}createBorderPaddingObject(){var r=0,e=0,n=0,s=0;return(this.is(ie.CLONE_LEFT)||this.is(ie.CLONE_TOP_LEFT_CORNER)||this.is(ie.CLONE_BOTTOM_LEFT_CORNER))&&(s=1,this.wot.getSetting("rowHeaders").length>0&&(e=1)),(this.is(ie.CLONE_TOP)||this.is(ie.CLONE_TOP_LEFT_CORNER))&&(n=1,this.wot.getSetting("columnHeaders").length>0&&(r=1)),(this.is(ie.CLONE_BOTTOM)||this.is(ie.CLONE_BOTTOM_LEFT_CORNER))&&(r=1),{top:r,left:e,bottom:n,right:s}}fixTableDomTree(){var r=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(r){var e,n=r.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(h.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).className="wtSpreader",n&&n.insertBefore(e,r),e.appendChild(r)),e.style.position="relative",e}createHider(r){var e,n=r.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(h.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(e,r),e.appendChild(r)),e}createHolder(r){var e,n=r.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(h.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",n&&n.insertBefore(e,r),e.appendChild(r)),e}draw(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],{wot:e}=this,n=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),u=e.getSetting("rowHeaders"),p=u.length,j=e.getSetting("columnHeaders"),K=j.length;if(!r){var J=n>0?this.getFirstRenderedRow():0,ne=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new N(J,n,K),this.columnFilter=new C(ne,s,p),this.is(ie.CLONE_BOTTOM)||this.is(ie.CLONE_BOTTOM_LEFT_CORNER)?this.tableRenderer.setHeaderContentRenderers(u,[]):this.tableRenderer.setHeaderContentRenderers(u,j),this.is(ie.CLONE_BOTTOM)&&this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.adjustColumnHeaderHeights(),this.is(ie.CLONE_BOTTOM)&&this.markOversizedRows()}this.refreshSelections(r)}markIfOversizedColumnHeader(r){for(var e,n,s,u=this.columnFilter.renderedToSource(r),p=this.wot.getSetting("columnHeaders").length,j=this.wot.wtSettings.settings.defaultRowHeight,K=this.wot.getSetting("columnHeaderHeight")||[];p;)p-=1,e=this.wot.columnUtils.getHeaderHeight(p),(n=this.getColumnHeader(u,p))&&(s=Object(h.innerHeight)(n),(!e&&j<s||e<s)&&(this.wot.wtViewport.oversizedColumnHeaders[p]=s),Array.isArray(K)?K[p]!==null&&K[p]!==void 0&&(this.wot.wtViewport.oversizedColumnHeaders[p]=K[p]):isNaN(K)||(this.wot.wtViewport.oversizedColumnHeaders[p]=K),this.wot.wtViewport.oversizedColumnHeaders[p]<(K[p]||K)&&(this.wot.wtViewport.oversizedColumnHeaders[p]=K[p]||K))}adjustColumnHeaderHeights(){for(var{wot:r}=this,e=this.THEAD.childNodes,n=r.wtViewport.oversizedColumnHeaders,s=0,u=r.getSetting("columnHeaders").length;s<u;s++)if(n[s]){if(!e[s]||e[s].childNodes.length===0)return;e[s].childNodes[0].style.height="".concat(n[s],"px")}}resetOversizedRows(){var{wot:r}=this;if(!r.getSetting("externalRowCalculator"))for(var e=this.getRenderedRowsCount(),n=0;n<e;n++){var s=this.rowFilter.renderedToSource(n);r.wtViewport.oversizedRows&&r.wtViewport.oversizedRows[s]&&(r.wtViewport.oversizedRows[s]=void 0)}}removeClassFromCells(r){for(var e=this.TABLE.querySelectorAll(".".concat(r)),n=0,s=e.length;n<s;n++)Object(h.removeClass)(e[n],r)}refreshSelections(r){var{wot:e}=this;if(e.selections){var n=Array.isArray(e.selections)?e.selections:e.selections.getAll(),s=n.length;if(r){for(var u=new Set,p=e.getSetting("onBeforeRemoveCellClassNames"),j=0;j<s;j++){var{highlightHeaderClassName:K,highlightRowClassName:J,highlightColumnClassName:ne}=n[j].settings;n[j].classNames.forEach(u.add,u),K&&u.add(K),J&&u.add(J),ne&&u.add(ne)}Array.isArray(p)&&p.forEach(u.add,u),u.forEach(this.removeClassFromCells,this)}var he=this.getRenderedRowsCount(),ue=this.getRenderedColumnsCount(),je=this.getFirstRenderedRow(),We=this.getFirstRenderedColumn(),Pe=this.getLastRenderedRow(),Qe=this.getLastRenderedColumn(),Je=[];(this.is(ie.CLONE_LEFT)||this.is(ie.CLONE_TOP_LEFT_CORNER)||this.is(ie.CLONE_BOTTOM_LEFT_CORNER))&&(Qe+=1),(this.is(ie.CLONE_TOP)||this.is(ie.CLONE_TOP_LEFT_CORNER))&&(Pe+=1),(this.is(ie.CLONE_BOTTOM)||this.is(ie.CLONE_BOTTOM_LEFT_CORNER))&&(je-=1);for(var Ze=0;Ze<s;Ze++){var qe=n[Ze].draw(e,he,ue,je,We,Pe,Qe);qe&&Je.push(qe)}this.wot.getSetting("columnHeaders"),this.borderRenderer.render(this.TABLE,this.createBorderPaddingObject(),Je)}}getCell(r){var e,n=r.row,s=r.col,u=this.wot.getSetting("onModifyGetCellCoords",n,s);if(u&&Array.isArray(u)&&([n,s]=u),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(s))return-3;if(this.isColumnAfterRenderedColumns(s))return-4;if(!(e=n<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)])&&n>=0)throw new Error("TR was expected to be rendered but is not");var p=e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(s)];if(!p&&s>=0)throw new Error("TD or TH was expected to be rendered but is not");return p}getColumnHeader(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=this.THEAD.childNodes[e];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}getRowHeader(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return null;var e=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return e?e.childNodes[0]:void 0}getCoords(r){var e=r;if(e.nodeName!=="TD"&&e.nodeName!=="TH"&&(e=Object(h.closest)(e,["TD","TH"])),e===null)return null;var n=e.parentNode,s=n.parentNode,u=Object(h.index)(n),p=e.cellIndex;return Object(h.overlayContainsElement)(ie.CLONE_TOP_LEFT_CORNER,e,this.wtRootElement)||Object(h.overlayContainsElement)(ie.CLONE_TOP,e,this.wtRootElement)?s.nodeName==="THEAD"&&(u-=s.childNodes.length):Object(h.overlayContainsElement)(ie.CLONE_BOTTOM_LEFT_CORNER,e,this.wtRootElement)||Object(h.overlayContainsElement)(ie.CLONE_BOTTOM,e,this.wtRootElement)?u=this.wot.getSetting("totalRows")-s.childNodes.length+u:u=s===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(u):this.rowFilter.renderedToSource(u),p=Object(h.overlayContainsElement)(ie.CLONE_TOP_LEFT_CORNER,e,this.wtRootElement)||Object(h.overlayContainsElement)(ie.CLONE_LEFT,e,this.wtRootElement)||Object(h.overlayContainsElement)(ie.CLONE_BOTTOM_LEFT_CORNER,e,this.wtRootElement)?this.columnFilter.offsettedTH(p):this.columnFilter.visibleRowHeadedColumnToSourceColumn(p),new f(u,p)}markOversizedRows(){if(!this.wot.getSetting("externalRowCalculator")){var r,e,n,s,u,p=this.TBODY.childNodes.length,j=p*this.wot.wtSettings.settings.defaultRowHeight,K=Object(h.innerHeight)(this.TBODY)-1,J=this.isMaster?this.wot.rowUtils:this.wot.overlay.master.rowUtils;if(j!==K||this.wot.getSetting("fixedRowsBottom"))for(;p;)p-=1,n=this.rowFilter.renderedToSource(p),r=J.getHeight(n),e=(u=(s=this.getTrForRow(n)).querySelector("th"))?Object(h.innerHeight)(u):Object(h.innerHeight)(s)-1,(!r&&this.wot.wtSettings.settings.defaultRowHeight<e||r<e)&&(e+=1,this.wot.wtViewport.oversizedRows[n]=e)}}getTrForRow(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}isColumnHeaderLevelRendered(r){return r>this.wot.getSetting("columnHeaders").length-1}isRowHeaderLevelRendered(r){return r>this.wot.getSetting("rowHeaders").length-1}isRowBeforeRenderedRows(r){var e=this.getFirstRenderedRow();return r<0&&(r=0),e===-1||r<e}isRowAfterViewport(r){return this.rowFilter&&r>this.getLastVisibleRow()}isRowAfterRenderedRows(r){if(r<0){var e=this.wot.getSetting("columnHeaders").length+r;return this.isColumnHeaderLevelRendered(e)}return r>this.getLastRenderedRow()}isColumnBeforeViewport(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}isColumnBeforeRenderedColumns(r){var e=this.getFirstRenderedColumn();return r<0&&(r=0),e===-1||r<e}isColumnAfterViewport(r){return this.columnFilter&&r>this.getLastVisibleColumn()}isColumnAfterRenderedColumns(r){if(r<0){var e=this.wot.getSetting("rowHeaders").length+r;return this.isRowHeaderLevelRendered(e)}return this.columnFilter&&r>this.getLastRenderedColumn()}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}isVisible(){return Object(h.isVisible)(this.TABLE)}},Ie={getFirstRenderedRow(){var r=this.wot.wtViewport.rowsRenderCalculator.startRow;return r===null?-1:r},getFirstVisibleRow(){var r=this.wot.wtViewport.rowsVisibleCalculator.startRow;return r===null?-1:r},getLastRenderedRow(){var r=this.wot.wtViewport.rowsRenderCalculator.endRow;return r===null?-1:r},getLastVisibleRow(){var r=this.wot.wtViewport.rowsVisibleCalculator.endRow;return r===null?-1:r},getRenderedRowsCount(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount(){return this.wot.wtViewport.rowsVisibleCalculator.count}};Object(l.defineGetter)(Ie,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var Fe=Ie,Ke={getFirstRenderedColumn(){var r=this.wot.wtViewport.columnsRenderCalculator.startColumn;return r===null?-1:r},getFirstVisibleColumn(){var r=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return r===null?-1:r},getLastRenderedColumn(){var r=this.wot.wtViewport.columnsRenderCalculator.endColumn;return r===null?-1:r},getLastVisibleColumn(){var r=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return r===null?-1:r},getRenderedColumnsCount(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount(){return this.wot.wtViewport.columnsVisibleCalculator.count}};Object(l.defineGetter)(Ke,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var $e=Ke;class et extends Te{constructor(e,n){super(e,n),this.holderOffset=0,this.wtRootElement.className+="ht_master handsontable",this.trimmingContainer=null,this.alignOverlaysWithTrimmingContainer()}alignOverlaysWithTrimmingContainer(){this.trimmingContainer=Object(h.getTrimmingContainer)(this.wtRootElement);var e=this.trimmingContainer,{rootWindow:n}=this.wot;if(e===n)this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{e.parentElement;var s=Object(h.getStyle)(e,"height",n),u=(Object(h.getStyle)(e,"overflow",n),this.holder.style),{width:p,height:j}=Object(h.getBoundingClientRect)(e);j=Math.min(j,Object(h.scrollHeight)(e)),u.height=s==="auto"?"auto":"".concat(j,"px"),p=Math.min(p,Object(h.scrollWidth)(e)),u.width="".concat(p,"px"),u.overflow="",this.hasTableHeight=u.height==="auto"||j>0,this.hasTableWidth=p>0}}markOversizedColumnHeaders(){var{wot:e}=this,n=e.getSetting("columnHeaders").length;if(n&&!e.wtViewport.hasOversizedColumnHeadersMarked){for(var s=e.getSetting("rowHeaders").length,u=this.getRenderedColumnsCount(),p=0;p<n;p++)for(var j=-1*s;j<u;j++)this.markIfOversizedColumnHeader(j);e.wtViewport.hasOversizedColumnHeadersMarked=!0}}draw(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],{wot:n}=this,{wtOverlays:s,wtViewport:u}=n,p=n.getSetting("totalRows"),j=n.getSetting("totalColumns"),K=n.getSetting("rowHeaders"),J=K.length,ne=n.getSetting("columnHeaders"),he=ne.length,ue=e;if(this.holderOffset=Object(h.offset)(this.holder),ue=u.createRenderCalculators(ue))u.createVisibleCalculators(),s.refreshClones(!0),this.refreshSelections(!0);else{var je=p>0?this.getFirstRenderedRow():0,We=j>0?this.getFirstRenderedColumn():0;this.rowFilter=new N(je,p,he),this.columnFilter=new C(We,j,J),this.alignOverlaysWithTrimmingContainer();var Pe={};this.wot.getSetting("beforeDraw",!0,Pe),Pe.skipRender!==!0&&(this.tableRenderer.setHeaderContentRenderers(K,ne),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),u.getWorkspaceWidth(),u.containerWidth=null,this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),this.markOversizedRows(),u.createVisibleCalculators(),s.refreshClones(!1),this.refreshSelections(!1),this.wot.getSetting("onDraw",!0))}}}Object(l.mixin)(et,Fe),Object(l.mixin)(et,$e);var ae=et,Y={getFirstRenderedColumn(){return this.wot.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){var r=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),r)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};Object(l.defineGetter)(Y,"MIXIN_NAME","stickyColumnsLeft",{writable:!1,enumerable:!1});var oe=Y;class ce extends Te{}Object(l.mixin)(ce,Fe),Object(l.mixin)(ce,oe);var we=ce;class xe extends ie{constructor(e){super(e),this.clone=this.makeClone(ie.CLONE_LEFT),this.updateStateOfRendering()}createTable(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return new we(...n)}shouldBeRendered(){return!(!this.master.getSetting("fixedColumnsLeft")&&!this.master.getSetting("rowHeaders").length)}adjustElementsPosition(){var{master:e}=this,n=e.getSetting("totalColumns");if(typeof e.wtViewport.columnsRenderCalculator.startPosition=="number")e.wtTable.spreader.style.left="".concat(e.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(n!==0)throw new Error("Incorrect value of the columnsRenderCalculator");e.wtTable.spreader.style.left="0"}if(e.wtTable.spreader.style.right="",this.needFullRender&&(typeof e.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(e.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""),this.needFullRender&&e.wtTable.holder.parentNode){var s=this.clone.wtTable.wtRootElement,u=e.getSetting("preventOverflow");if(e.wtTable.trimmingContainer!==e.rootWindow||u&&u==="horizontal")Object(h.resetCssTransform)(s);else{var p,j,K=Object(h.getBoundingClientRect)(e.wtTable.hider),J=Math.ceil(K.left),ne=Math.ceil(K.right);j=(j=e.wtTable.hider.style.top)===""?0:j,p=J<0&&ne-Object(h.offsetWidth)(s)>0?-J:0,p+="px",Object(h.setOverlayPosition)(s,p,j)}var he=e.wtTable.wtRootElement;e.getSetting("totalRows")?Object(h.removeClass)(he,"emptyRows"):Object(h.addClass)(he,"emptyRows")}}setScrollPosition(e){var{rootWindow:n}=this.master,s=!1;return this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,Object(h.getWindowScrollTop)(n)),s=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,s=!0),s}onScroll(){this.master.getSetting("onScrollVertically")}sumCellSizes(e,n){for(var s=this.master.wtSettings.defaultColumnWidth,u=e,p=0;u<n;)p+=this.master.columnUtils.getStretchedColumnWidth(u)||s,u+=1;return p}adjustElementsSize(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||e){var{clone:n,master:s}=this,u=n.wtTable.wtRootElement.style,p=s.getSetting("preventOverflow");if(s.wtTable.trimmingContainer!==s.rootWindow||p==="vertical"){var j=s.wtViewport.getWorkspaceHeight();s.wtOverlays.hasScrollbarBottom&&(j-=Object(h.getScrollbarWidth)(s.rootDocument)),j=Math.min(j,Object(h.scrollHeight)(s.wtTable.wtRootElement)),u.height="".concat(j,"px")}else u.height="";var K=Object(h.outerWidth)(n.wtTable.TABLE);u.width="".concat(K,"px"),n.wtTable.hider.style.height=s.wtTable.hider.style.height,n.wtTable.holder.style.height=u.height,n.wtTable.holder.style.width=u.width,e||(this.areElementSizesAdjusted=!0)}}scrollTo(e,n){var{master:s}=this,u=this.getTableParentOffset(),p=s.wtTable.holder,j=0;return n&&Object(h.offsetWidth)(p)!==Object(h.clientWidth)(p)&&(j=Object(h.getScrollbarWidth)(s.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=s.wtViewport.getViewportWidth()):u+=this.sumCellSizes(s.getSetting("fixedColumnsLeft"),e),u+=j,this.setScrollPosition(u)}getTableParentOffset(){var e=0;return this.master.getSetting("preventOverflow")||this.master.wtTable.trimmingContainer!==this.master.rootWindow||(e=this.master.wtTable.holderOffset.left),e}getScrollPosition(){return Object(h.getScrollLeft)(this.mainTableScrollableElement,this.master.rootWindow)}}ie.registerOverlay(ie.CLONE_LEFT,xe);var Le={getFirstRenderedRow(){return this.wot.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){var r=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};Object(l.defineGetter)(Le,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var ke=Le;class Ve extends Te{}Object(l.mixin)(Ve,ke),Object(l.mixin)(Ve,$e);var Ye=Ve;class ot extends ie{constructor(e){super(e),this.clone=this.makeClone(ie.CLONE_TOP),this.updateStateOfRendering()}createTable(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return new Ye(...n)}shouldBeRendered(){return!(!this.master.getSetting("fixedRowsTop")&&!this.master.getSetting("columnHeaders").length)}adjustElementsPosition(){var{master:e}=this,n=e.getSetting("totalRows");if(typeof e.wtViewport.rowsRenderCalculator.startPosition=="number")e.wtTable.spreader.style.top="".concat(e.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(n!==0)throw new Error("Incorrect value of the rowsRenderCalculator");e.wtTable.spreader.style.top="0"}if(e.wtTable.spreader.style.bottom="",this.needFullRender&&(typeof e.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(e.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""),this.needFullRender&&e.wtTable.holder.parentNode){var s=this.clone.wtTable.wtRootElement,u=e.getSetting("preventOverflow");if(e.wtTable.trimmingContainer!==e.rootWindow||u&&u==="vertical")Object(h.resetCssTransform)(s);else{var p,j,K=Object(h.getBoundingClientRect)(e.wtTable.hider),J=Math.ceil(K.top),ne=Math.ceil(K.bottom);p=(p=e.wtTable.hider.style.left)===""?0:p,j=J<0&&ne-Object(h.offsetHeight)(s)>0?-J:0,j+="px",Object(h.setOverlayPosition)(s,p,j)}}}setScrollPosition(e){var n=this.master.rootWindow,s=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Object(h.getWindowScrollLeft)(n),e),s=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,s=!0),s}onScroll(){this.master.getSetting("onScrollHorizontally")}sumCellSizes(e,n){for(var s=this.master.wtSettings.settings.defaultRowHeight,u=e,p=0;u<n;){var j=this.master.rowUtils.getHeight(u);p+=j===void 0?s:j,u+=1}return p}adjustElementsSize(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||e){var{clone:n,master:s}=this,u=n.wtTable.wtRootElement.style,p=s.getSetting("preventOverflow");if(s.wtTable.trimmingContainer!==s.rootWindow||p==="horizontal"){var j=s.wtViewport.getWorkspaceWidth();s.wtOverlays.hasScrollbarRight&&(j-=Object(h.getScrollbarWidth)(s.rootDocument)),j=Math.min(j,Object(h.scrollWidth)(s.wtTable.wtRootElement)),u.width="".concat(j,"px")}else u.width="";var K=Object(h.outerHeight)(n.wtTable.TABLE);s.wtTable.hasDefinedSize()||(K=0),u.height="".concat(K,"px"),n.wtTable.hider.style.width=s.wtTable.hider.style.width,n.wtTable.holder.style.width=u.width,n.wtTable.holder.style.height=u.height,e||(this.areElementSizesAdjusted=!0)}}scrollTo(e,n){var{master:s}=this,u=s.wtTable.holder,p=this.getTableParentOffset(),j=0;if(n&&Object(h.offsetHeight)(u)!==Object(h.clientHeight)(u)&&(j=Object(h.getScrollbarWidth)(s.rootDocument)),n){var K=s.getSetting("fixedRowsBottom"),J=s.getSetting("totalRows");p+=this.sumCellSizes(0,e+1),p-=s.wtViewport.getViewportHeight()-this.sumCellSizes(J-K,J),p+=1}else p+=this.sumCellSizes(s.getSetting("fixedRowsTop"),e);return p+=j,this.setScrollPosition(p)}getTableParentOffset(){return this.mainTableScrollableElement===this.master.rootWindow?this.master.wtTable.holderOffset.top:0}getScrollPosition(){return Object(h.getScrollTop)(this.mainTableScrollableElement,this.master.rootWindow)}redrawSelectionBorders(e){if(e&&e.cellRange&&e.hasSelectionHandle()){var n=e.getSelectionHandle(this.master),s=e.getCorners();n.disappear(),n.appear(s)}}redrawAllSelectionsBorders(){var e=this.master.selections;this.redrawSelectionBorders(e.getCell()),Object(t.arrayEach)(e.getAreas(),n=>{this.redrawSelectionBorders(n)}),this.redrawSelectionBorders(e.getFill()),this.master.wtOverlays.leftOverlay.redrawClone()}redrawClone(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(super.redrawClone(e),!e&&this.master.getSetting("rowHeaders").length===0){var n=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(n)for(var s=0;s<n.length;s++)n[s].style["border-left-width"]=0}}}ie.registerOverlay(ie.CLONE_TOP,ot);class ct extends Te{}Object(l.mixin)(ct,ke),Object(l.mixin)(ct,oe);var At=ct;class wt extends ie{constructor(e){super(e),this.clone=this.makeClone(ie.CLONE_TOP_LEFT_CORNER),this.updateStateOfRendering()}createTable(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return new At(...n)}shouldBeRendered(){var{master:e}=this;return!(!e.getSetting("fixedRowsTop")&&!e.getSetting("columnHeaders").length||!e.getSetting("fixedColumnsLeft")&&!e.getSetting("rowHeaders").length)}adjustElementsPosition(){var{clone:e,master:n}=this;if(n.wtTable.holder.parentNode){var s=e.wtTable.wtRootElement,u=n.getSetting("preventOverflow");if(n.wtTable.trimmingContainer===n.rootWindow){var p=Object(h.getBoundingClientRect)(n.wtTable.hider),j=Math.ceil(p.top),K=Math.ceil(p.left),J=Math.ceil(p.bottom),ne=Math.ceil(p.right),he="0",ue="0";u&&u!=="vertical"||K<0&&ne-Object(h.offsetWidth)(s)>0&&(he="".concat(-K,"px")),u&&u!=="horizontal"||j<0&&J-Object(h.offsetHeight)(s)>0&&(ue="".concat(-j,"px")),Object(h.setOverlayPosition)(s,he,ue)}else Object(h.resetCssTransform)(s)}}adjustElementsSize(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||e){var{clone:n,master:s}=this,u=Object(h.outerHeight)(n.wtTable.TABLE),p=Object(h.outerWidth)(n.wtTable.TABLE),j=n.wtTable.wtRootElement;s.wtTable.hasDefinedSize()||(u=0),j.style.height="".concat(u,"px"),j.style.width="".concat(p,"px")}}}ie.registerOverlay(ie.CLONE_TOP_LEFT_CORNER,wt);var Tt={getFirstRenderedRow(){var r=this.wot.getSetting("totalRows"),e=this.wot.getSetting("fixedRowsBottom"),n=r-e;return r===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){var r=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};Object(l.defineGetter)(Tt,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var mt=Tt;class jt extends Te{}Object(l.mixin)(jt,mt),Object(l.mixin)(jt,$e);var gt=jt;class Bt extends ie{constructor(e){super(e),this.clone=this.makeClone(ie.CLONE_BOTTOM),this.updateStateOfRendering()}createTable(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return new gt(...n)}shouldBeRendered(){return!!this.master.getSetting("fixedRowsBottom")}adjustElementsPosition(){var{master:e}=this,n=e.getSetting("totalRows");if(typeof e.wtViewport.rowsRenderCalculator.startPosition=="number")e.wtTable.spreader.style.top="".concat(e.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(n!==0)throw new Error("Incorrect value of the rowsRenderCalculator");e.wtTable.spreader.style.top="0"}if(e.wtTable.spreader.style.bottom="",this.needFullRender&&(typeof e.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(e.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""),this.needFullRender&&e.wtTable.holder.parentNode){var s=this.clone.wtTable.wtRootElement,u=e.getSetting("preventOverflow");if(s.style.top="",e.wtTable.trimmingContainer!==e.rootWindow||u&&u==="vertical"){Object(h.resetCssTransform)(s);var p=Object(h.getScrollbarWidth)(e.rootDocument);Object(h.clientHeight)(e.wtTable.holder)===Object(h.offsetHeight)(e.wtTable.holder)&&(p=0),s.style.top="",s.style.bottom="".concat(p,"px")}else{var j,K,J=Object(h.getBoundingClientRect)(e.wtTable.hider),ne=Math.ceil(J.bottom),he=Object(h.offsetHeight)(e.rootDocument.body);j=(j=e.wtTable.hider.style.left)===""?0:j,K=ne>he?ne-he:0,K+="px",s.style.top="",s.style.left=j,s.style.bottom=K}}}setScrollPosition(e){var{master:n}=this,s=!1;return this.mainTableScrollableElement===n.rootWindow?(n.rootWindow.scrollTo(Object(h.getWindowScrollLeft)(n.rootWindow),e),s=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,s=!0),s}onScroll(){this.master.getSetting("onScrollHorizontally")}sumCellSizes(e,n){for(var{master:s}=this,u=s.wtSettings.settings.defaultRowHeight,p=e,j=0;p<n;){var K=s.rowUtils.getHeight(p);j+=K===void 0?u:K,p+=1}return j}adjustElementsSize(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||e){var{clone:n,master:s}=this,u=n.wtTable.wtRootElement.style,p=s.getSetting("preventOverflow");if(s.wtTable.trimmingContainer!==s.rootWindow||p==="horizontal"){var j=s.wtViewport.getWorkspaceWidth();s.wtOverlays.hasScrollbarRight&&(j-=Object(h.getScrollbarWidth)(s.rootDocument)),j=Math.min(j,Object(h.scrollWidth)(s.wtTable.wtRootElement)),u.width="".concat(j,"px")}else u.width="";var K=Object(h.outerHeight)(n.wtTable.TABLE);s.wtTable.hasDefinedSize()||(K=0),u.height="".concat(K,"px"),n.wtTable.hider.style.width=this.master.wtTable.hider.style.width,n.wtTable.holder.style.width=u.width,n.wtTable.holder.style.height=u.height,e||(this.areElementSizesAdjusted=!0)}}scrollTo(e,n){var{master:s}=this,u=this.getTableParentOffset(),p=s.wtTable.holder,j=0;n&&Object(h.offsetHeight)(p)!==Object(h.clientHeight)(p)&&(j=Object(h.getScrollbarWidth)(s.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=s.wtViewport.getViewportHeight(),u+=1):u+=this.sumCellSizes(s.getSetting("fixedRowsBottom"),e),u+=j,this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.master.rootWindow?this.master.wtTable.holderOffset.top:0}getScrollPosition(){return Object(h.getScrollTop)(this.mainTableScrollableElement,this.master.rootWindow)}redrawClone(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(super.redrawClone(e),!e&&this.master.getSetting("rowHeaders").length===0){var n=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");n&&(n.style["border-left-width"]=0)}}}ie.registerOverlay(ie.CLONE_BOTTOM,Bt);class Nt extends Te{}Object(l.mixin)(Nt,mt),Object(l.mixin)(Nt,oe);var Ft=Nt;class bt extends ie{constructor(e){super(e),this.clone=this.makeClone(ie.CLONE_BOTTOM_LEFT_CORNER),this.updateStateOfRendering()}createTable(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return new Ft(...n)}shouldBeRendered(){var{master:e}=this;return!(!e.getSetting("fixedRowsBottom")||!e.getSetting("fixedColumnsLeft")&&!e.getSetting("rowHeaders").length)}adjustElementsPosition(){var{clone:e,master:n}=this;if(n.wtTable.holder.parentNode){var s=e.wtTable.wtRootElement;if(s.style.top="",n.wtTable.trimmingContainer===n.rootWindow){var u,p,j=Object(h.getBoundingClientRect)(n.wtTable.hider),K=Math.ceil(j.bottom),J=Math.ceil(j.left),ne=Object(h.offsetHeight)(n.rootDocument.body);u=J<0?-J:0,p=K>ne?K-ne:0,p+="px",u+="px",s.style.top="",s.style.left=u,s.style.bottom=p}else{Object(h.resetCssTransform)(s);var he=Object(h.getScrollbarWidth)(n.rootDocument);Object(h.clientHeight)(n.wtTable.holder)===Object(h.offsetHeight)(n.wtTable.holder)&&(he=0),s.style.top="",s.style.bottom="".concat(he,"px")}}}adjustElementsSize(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.needFullRender||e){var{clone:n,master:s}=this,u=Object(h.outerHeight)(n.wtTable.TABLE),p=Object(h.outerWidth)(n.wtTable.TABLE),j=n.wtTable.wtRootElement;s.wtTable.hasDefinedSize()||(u=0),j.style.height="".concat(u,"px"),j.style.width="".concat(p,"px")}}}ie.registerOverlay(ie.CLONE_BOTTOM_LEFT_CORNER,bt);var Ct=o(57),ht=class{constructor(r,e){e&&(this.eventManager=new Ne.a(r),this.wot=r,this.settings=e,this.mouseDown=!1,this.main=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createElements(e),this.registerListeners())}registerListeners(){var r=this,e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(var n=function(p,j){r.eventManager.addEventListener(r.main.childNodes[p],"mouseenter",K=>r.onMouseEnter(K,r.main.childNodes[p]))},s=0,u=this.main.childNodes.length;s<u;s++)n(s)}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(r,e){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){r.preventDefault(),Object(Ct.stopImmediatePropagation)(r);var n=this,s=this.wot.rootDocument.body,u=Object(h.getBoundingClientRect)(e);e.style.display="none",this.eventManager.addEventListener(s,"mousemove",function p(j){var K;((K=j).clientY<Math.floor(u.top)||K.clientY>Math.ceil(u.top+u.height)||K.clientX<Math.floor(u.left)||K.clientX>Math.ceil(u.left+u.width))&&(n.eventManager.removeEventListener(s,"mousemove",p),e.style.display="block")})}}createElements(r){var{rootDocument:e}=this.wot;this.main=e.createElement("div");var n=this.main.style;n.position="absolute",n.top=0,n.left=0;var s=e.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),(n=s.style).height=this.settings.corner&&this.settings.corner.width?"".concat(this.settings.corner.width,"px"):"".concat(r.border.width,"px"),n.width=this.settings.corner&&this.settings.corner.width?"".concat(this.settings.corner.width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s),this.corner=s,this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(ze.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var{wtTable:u}=this.wot,p=u.selectionHandlesHolder;p||((p=e.createElement("div")).className="htBorders",u.selectionHandlesHolder=p,u.spreader.appendChild(p)),p.appendChild(this.main)}createMultipleSelectorHandles(){var{rootDocument:r}=this.wot;this.selectionHandles={topLeft:r.createElement("DIV"),topLeftHitArea:r.createElement("DIV"),bottomRight:r.createElement("DIV"),bottomRightHitArea:r.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var e={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};Object(l.objectEach)(e,(s,u)=>{this.selectionHandles.styles.bottomRightHitArea[u]=s,this.selectionHandles.styles.topLeftHitArea[u]=s});var n={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#FFFFFF","border-width":"1px","border-style":"solid"};Object(l.objectEach)(n,(s,u)=>{this.selectionHandles.styles.bottomRight[u]=s,this.selectionHandles.styles.topLeft[u]=s}),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}isPartRange(r,e){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||r===n.cellRange.to.row&&e===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(r,e,n,s,u,p){var j=parseInt(this.selectionHandles.styles.topLeft.width,10),K=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10),J=this.settings.corner&&this.settings.corner.color?this.settings.corner.color:this.settings.border.color;this.selectionHandles.styles.topLeft.borderColor=J,this.selectionHandles.styles.bottomRight.borderColor=J,this.selectionHandles.styles.topLeft.top="".concat(parseInt(n-j,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(s-j,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(n-K/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(s-K/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(n+p,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(s+u,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(n+p-K/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(s+u-K/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(r,e)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}appear(r){if(!this.disabled){for(var e,n,s,u,{wtTable:p,rootDocument:j,rootWindow:K}=this.wot,J=p.getRenderedRowsCount(),ne=0;ne<J;ne+=1){var he=p.rowFilter.renderedToSource(ne);if(he>=r[0]&&he<=r[2]){e=he;break}}for(var ue=J-1;ue>=0;ue-=1){var je=p.rowFilter.renderedToSource(ue);if(je>=r[0]&&je<=r[2]){n=je;break}}for(var We=p.getRenderedColumnsCount(),Pe=0;Pe<We;Pe+=1){var Qe=p.columnFilter.renderedToSource(Pe);if(Qe>=r[1]&&Qe<=r[3]){s=Qe;break}}for(var Je=We-1;Je>=0;Je-=1){var Ze=p.columnFilter.renderedToSource(Je);if(Ze>=r[1]&&Ze<=r[3]){u=Ze;break}}if(e!==void 0&&s!==void 0){var qe=p.getCell(new f(e,s)),tt=e!==n||s!==u,nt=tt?p.getCell(new f(n,u)):qe,ut=Object(h.offset)(qe),dt=tt?Object(h.offset)(nt):ut,ft=Object(h.offset)(p.TABLE),Vt=ut.top,Dt=ut.left,Ot=Dt-ft.left-1,Ht=dt.left+Object(h.outerWidth)(nt)-Dt;if(this.isEntireColumnSelected(e,n)){var Wt=this.getDimensionsFromHeader("columns",s,u,ft),Gt=null;Wt&&([Gt,Ot,Ht]=Wt),Gt&&(qe=Gt)}var _t=Vt-ft.top-1,kt=dt.top+Object(h.outerHeight)(nt)-Vt;if(this.isEntireRowSelected(s,u)){var zt=this.getDimensionsFromHeader("rows",e,n,ft),pt=null;zt&&([pt,_t,kt]=zt),pt&&(qe=pt)}var Lt=this.settings.border.cornerVisible;Lt=typeof Lt=="function"?Lt(this.settings.layerLevel):Lt;var Xt=this.wot.getSetting("onModifyGetCellCoords",n,u),[Qt,Ut]=[n,u];if(Xt&&Array.isArray(Xt)&&([,,Qt,Ut]=Xt),Object(ze.isMobileBrowser)()||!Lt||this.isPartRange(Qt,Ut))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(_t+kt-4,"px"),this.cornerStyle.left="".concat(Ot+Ht-4,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.backgroundColor=this.settings.corner&&this.settings.corner.color?this.settings.corner.color:this.settings.border.color,this.cornerStyle.display="none";var Pt=this.wot.overlay?this.wot.overlay.master.wtTable.trimmingContainer:p.trimmingContainer,Zt=Pt===K;if(Zt&&(Pt=j.documentElement),u===this.wot.getSetting("totalColumns")-1){var rr=(Zt?Object(h.getBoundingClientRect)(nt).left:nt.offsetLeft)+Object(h.outerWidth)(nt)+parseInt(this.cornerDefaultStyle.width,10)/2,nr=this.wot.overlay?this.wot.overlay.master.columnUtils:this.wot.columnUtils;rr>=Object(h.innerWidth)(Pt)-nr.scrollbarCompensation&&(this.cornerStyle.left="".concat(Math.floor(Ot+Ht-3-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0)}n===this.wot.getSetting("totalRows")-1&&(Zt?Object(h.getBoundingClientRect)(nt).top:nt.offsetTop)+Object(h.outerHeight)(nt)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(h.innerHeight)(Pt)&&(this.cornerStyle.top="".concat(Math.floor(_t+kt-3-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Object(ze.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(n,u,_t,Ot,Ht,kt)}else this.disappear()}}isEntireColumnSelected(r,e){return r===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(r,e){return r===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(r,e,n,s){var{wtTable:u}=this.wot,p=u.wtRootElement.parentNode,j=null,K=null,J=null,ne=null,he=null,ue=null,je=null,We=null;switch(r){case"rows":j=function(){return u.getRowHeader(...arguments)},K=function(){return Object(h.outerHeight)(...arguments)},J="ht__selection--rows",ue="top";break;case"columns":j=function(){return u.getColumnHeader(...arguments)},K=function(){return Object(h.outerWidth)(...arguments)},J="ht__selection--columns",ue="left"}if(p.className.includes(J)){var Pe=this.wot.getSetting("columnHeaders").length;if(je=j(e,Pe-1),We=j(n,Pe-1),!je||!We)return!1;var Qe=Object(h.offset)(je),Je=Object(h.offset)(We);return je&&We&&(ne=Qe[ue]-s[ue]-1,he=Je[ue]+K(We)-Qe[ue]),[je,ne,he]}return!1}disappear(){this.cornerStyle.display="none",Object(ze.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}},St=class{constructor(r,e){this.settings=r,this.cellRange=e||null,this.instanceSelectionHandles=new Map,this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}hasSelectionHandle(){return this.settings.border&&typeof this.settings.border.cornerVisible=="function"}getSelectionHandle(r){var e=this.getSelectionHandleIfExists(r);if(e)return e;var n=new ht(r,this.settings);return this.instanceSelectionHandles.set(r,n),n}getSelectionHandleIfExists(r){return this.instanceSelectionHandles.get(r)}isEmpty(){return this.cellRange===null}add(r){return this.isEmpty()?this.cellRange=new S(r):this.cellRange.expand(r),this}replace(r,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){return this.cellRange.getCorners()}addClassAtCoords(r,e,n,s){var u=arguments.length>4&&arguments[4]!==void 0&&arguments[4],p=r.getCell(new f(e,n));if(typeof p=="object"){var j=s;u&&(j=this.classNameGenerator(p),this.classNames.includes(j)||this.classNames.push(j)),Object(h.addClass)(p,j)}return this}linearClassNameGenerator(r,e){return function n(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(e===0||u===0)return r;var p=u>=0?u:e,j=r,K=(p-=1)===0?r:"".concat(r,"-").concat(p);if(Object(h.hasClass)(s,K)){var J=p+1;j="".concat(r,"-").concat(J)}else j=n(s,p);return j}}addClassIfElemExists(r,e){r&&Object(h.addClass)(r,e)}draw(r,e,n,s,u,p,j){if(!this.isEmpty()){var K,{wtTable:J}=r,{highlightHeaderClassName:ne,highlightRowClassName:he,highlightColumnClassName:ue}=this.settings,je=this.getCorners(),[We,Pe,Qe,Je]=je,Ze=Math.max(We,s),qe=Math.max(Pe,u),tt=Math.min(Qe,p),nt=Math.min(Je,j),ut={row:Ze,col:qe},dt={row:tt,col:nt},ft=Ze===We,Vt=nt===Je,Dt=tt===Qe,Ot=qe===Pe;if(n&&(ne||ue)){for(var Ht=qe;Ht<=nt;Ht+=1)if(this.addClassIfElemExists(J.getColumnHeader(Ht),[ne,ue]),ue){for(var Wt=0;Wt<e;Wt+=1)if(Wt<Ze||Wt>tt){var Gt=J.rowFilter.renderedToSource(Wt);this.addClassAtCoords(J,Gt,Ht,ue)}}}if(e&&(ne||he)){for(var _t=Ze;_t<=tt;_t+=1)if(this.addClassIfElemExists(J.getRowHeader(_t),[ne,he]),he){for(var kt=0;kt<n;kt+=1)if(kt<qe||kt>nt){var zt=J.columnFilter.renderedToSource(kt);this.addClassAtCoords(J,_t,zt,he)}}}this.settings.border&&Ze<=tt&&qe<=nt&&(K={settings:this.settings,selectionStart:ut,selectionEnd:dt,hasTopEdge:ft,hasRightEdge:Vt,hasBottomEdge:Dt,hasLeftEdge:Ot});for(var pt=Ze;pt<=tt;pt+=1)for(var Lt=qe;Lt<=nt;Lt+=1)if(pt>=Ze&&pt<=tt&&Lt>=qe&&Lt<=nt&&this.settings.className&&this.addClassAtCoords(J,pt,Lt,this.settings.className,this.settings.markIntersections),this.settings.className){var Xt=r.getSetting("onAfterDrawSelection",pt,Lt,je,this.settings.layerLevel);typeof Xt=="string"&&this.addClassAtCoords(J,pt,Lt,Xt)}return r.getSetting("onBeforeDrawBorders",je,this.settings.className),this.hasSelectionHandle()&&this.getSelectionHandle(r).appear(je),K}if(this.hasSelectionHandle()){var Qt=this.getSelectionHandleIfExists(r);Qt&&Qt.disappear()}}destroy(){this.instanceSelectionHandles.forEach(r=>r.destroy())}}},,function(De,d,o){"use strict";o.r(d),o.d(d,"stringify",function(){return R}),o.d(d,"isDefined",function(){return c}),o.d(d,"isUndefined",function(){return X}),o.d(d,"isEmpty",function(){return w}),o.d(d,"isRegExp",function(){return x}),o.d(d,"_injectProductInfo",function(){return _}),o(54);function R(f){var S;switch(typeof f){case"string":case"number":S="".concat(f);break;case"object":S=f===null?"":f.toString();break;case"undefined":S="";break;default:S=f.toString()}return S}function c(f){return f!==void 0}function X(f){return f===void 0}function w(f){return f===null||f===""||X(f)}function x(f){return Object.prototype.toString.call(f)==="[object RegExp]"}function _(f,S){}},,,function(De,d,o){"use strict";o.d(d,"b",function(){return w});var R=o(55),c=o(57),X=0;function w(){return X}d.a=class{constructor(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=x||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(x,_,f){var S=arguments.length>3&&arguments[3]!==void 0&&arguments[3];function C(N){f.call(this,function(h){var E=h.stopImmediatePropagation;return h.stopImmediatePropagation=function(){E.apply(this),Object(c.stopImmediatePropagation)(this)},h}(N))}return typeof S=="boolean"||Object(R.isPassiveEventSupported)()||(S=!1),this.context.eventListeners.push({element:x,event:_,callback:f,callbackProxy:C,options:S,eventManager:this}),x.addEventListener(_,C,S),X+=1,()=>{this.removeEventListener(x,_,f)}}removeEventListener(x,_,f){for(var S,C=arguments.length>3&&arguments[3]!==void 0&&arguments[3],N=this.context.eventListeners.length;N;)if(N-=1,(S=this.context.eventListeners[N]).event===_&&S.element===x){if(f&&f!==S.callback||C&&S.eventManager!==this)continue;this.context.eventListeners.splice(N,1),S.element.removeEventListener(S.event,S.callbackProxy,S.options),X-=1}}clearEvents(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.context)for(var _=this.context.eventListeners.length;_;){_-=1;var f=this.context.eventListeners[_];f&&this.removeEventListener(f.element,f.event,f.callback,x)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(x,_){var f=x.document,S=x;f||(S=(f=x.ownerDocument?x.ownerDocument:x).defaultView);var C,N={bubbles:!0,cancelable:_!=="mousemove",view:S,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};f.createEvent?(C=f.createEvent("MouseEvents")).initMouseEvent(_,N.bubbles,N.cancelable,N.view,N.detail,N.screenX,N.screenY,N.clientX,N.clientY,N.ctrlKey,N.altKey,N.shiftKey,N.metaKey,N.button,N.relatedTarget||f.body.parentNode):C=f.createEventObject(),x.dispatchEvent?x.dispatchEvent(C):x.fireEvent("on".concat(_),C)}}},function(De,d,o){"use strict";function R(x){var _=typeof x;return _=="number"?!isNaN(x)&&isFinite(x):_=="string"?!!x.length&&(x.length==1?/\d/.test(x):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(x)):_=="object"&&!(!x||typeof x.valueOf()!="number"||x instanceof Date)}function c(x,_,f){var S=-1;for(typeof _=="function"?(f=_,_=x):S=x-1;++S<=_&&f(S)!==!1;);}function X(x,_,f){var S=x+1;for(typeof _=="function"&&(f=_,_=0);--S>=_&&f(S)!==!1;);}function w(x,_){return _=parseInt(_.toString().replace("%",""),10),_=parseInt(x*_/100,10)}o.r(d),o.d(d,"isNumeric",function(){return R}),o.d(d,"rangeEach",function(){return c}),o.d(d,"rangeEachReverse",function(){return X}),o.d(d,"valueAccordingPercent",function(){return w})},function(De,d,o){"use strict";o.r(d),o.d(d,"CONTEXT_MENU_ITEMS_NAMESPACE",function(){return R}),o.d(d,"CONTEXTMENU_ITEMS_NO_ITEMS",function(){return c}),o.d(d,"CONTEXTMENU_ITEMS_ROW_ABOVE",function(){return X}),o.d(d,"CONTEXTMENU_ITEMS_ROW_BELOW",function(){return w}),o.d(d,"CONTEXTMENU_ITEMS_INSERT_LEFT",function(){return x}),o.d(d,"CONTEXTMENU_ITEMS_INSERT_RIGHT",function(){return _}),o.d(d,"CONTEXTMENU_ITEMS_REMOVE_ROW",function(){return f}),o.d(d,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",function(){return S}),o.d(d,"CONTEXTMENU_ITEMS_UNDO",function(){return C}),o.d(d,"CONTEXTMENU_ITEMS_REDO",function(){return N}),o.d(d,"CONTEXTMENU_ITEMS_READ_ONLY",function(){return h}),o.d(d,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",function(){return E}),o.d(d,"CONTEXTMENU_ITEMS_COPY",function(){return M}),o.d(d,"CONTEXTMENU_ITEMS_CUT",function(){return y}),o.d(d,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",function(){return z}),o.d(d,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",function(){return U}),o.d(d,"CONTEXTMENU_ITEMS_MERGE_CELLS",function(){return te}),o.d(d,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",function(){return D}),o.d(d,"CONTEXTMENU_ITEMS_ADD_COMMENT",function(){return k}),o.d(d,"CONTEXTMENU_ITEMS_EDIT_COMMENT",function(){return T}),o.d(d,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",function(){return G}),o.d(d,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",function(){return W}),o.d(d,"CONTEXTMENU_ITEMS_ALIGNMENT",function(){return P}),o.d(d,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",function(){return Q}),o.d(d,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",function(){return O}),o.d(d,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",function(){return A}),o.d(d,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",function(){return Z}),o.d(d,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",function(){return ee}),o.d(d,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",function(){return de}),o.d(d,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",function(){return be}),o.d(d,"CONTEXTMENU_ITEMS_BORDERS",function(){return Ne}),o.d(d,"CONTEXTMENU_ITEMS_BORDERS_TOP",function(){return Me}),o.d(d,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",function(){return pe}),o.d(d,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",function(){return Be}),o.d(d,"CONTEXTMENU_ITEMS_BORDERS_LEFT",function(){return Ce}),o.d(d,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",function(){return Oe}),o.d(d,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",function(){return Ae}),o.d(d,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",function(){return Ue}),o.d(d,"CONTEXTMENU_ITEMS_HIDE_COLUMN",function(){return ze}),o.d(d,"CONTEXTMENU_ITEMS_SHOW_COLUMN",function(){return Ge}),o.d(d,"CONTEXTMENU_ITEMS_HIDE_ROW",function(){return I}),o.d(d,"CONTEXTMENU_ITEMS_SHOW_ROW",function(){return ge}),o.d(d,"FILTERS_NAMESPACE",function(){return V}),o.d(d,"FILTERS_CONDITIONS_NAMESPACE",function(){return q}),o.d(d,"FILTERS_CONDITIONS_NONE",function(){return B}),o.d(d,"FILTERS_CONDITIONS_EMPTY",function(){return se}),o.d(d,"FILTERS_CONDITIONS_NOT_EMPTY",function(){return ie}),o.d(d,"FILTERS_CONDITIONS_EQUAL",function(){return Ee}),o.d(d,"FILTERS_CONDITIONS_NOT_EQUAL",function(){return ye}),o.d(d,"FILTERS_CONDITIONS_BEGINS_WITH",function(){return _e}),o.d(d,"FILTERS_CONDITIONS_ENDS_WITH",function(){return st}),o.d(d,"FILTERS_CONDITIONS_CONTAINS",function(){return at}),o.d(d,"FILTERS_CONDITIONS_NOT_CONTAIN",function(){return it}),o.d(d,"FILTERS_CONDITIONS_BY_VALUE",function(){return Xe}),o.d(d,"FILTERS_CONDITIONS_GREATER_THAN",function(){return vt}),o.d(d,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",function(){return lt}),o.d(d,"FILTERS_CONDITIONS_LESS_THAN",function(){return yt}),o.d(d,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",function(){return Rt}),o.d(d,"FILTERS_CONDITIONS_BETWEEN",function(){return Et}),o.d(d,"FILTERS_CONDITIONS_NOT_BETWEEN",function(){return rt}),o.d(d,"FILTERS_CONDITIONS_AFTER",function(){return Mt}),o.d(d,"FILTERS_CONDITIONS_BEFORE",function(){return g}),o.d(d,"FILTERS_CONDITIONS_TODAY",function(){return v}),o.d(d,"FILTERS_CONDITIONS_TOMORROW",function(){return F}),o.d(d,"FILTERS_CONDITIONS_YESTERDAY",function(){return re}),o.d(d,"FILTERS_DIVS_FILTER_BY_CONDITION",function(){return le}),o.d(d,"FILTERS_DIVS_FILTER_BY_VALUE",function(){return fe}),o.d(d,"FILTERS_LABELS_CONJUNCTION",function(){return Se}),o.d(d,"FILTERS_LABELS_DISJUNCTION",function(){return ve}),o.d(d,"FILTERS_VALUES_BLANK_CELLS",function(){return He}),o.d(d,"FILTERS_BUTTONS_SELECT_ALL",function(){return Re}),o.d(d,"FILTERS_BUTTONS_CLEAR",function(){return L}),o.d(d,"FILTERS_BUTTONS_OK",function(){return l}),o.d(d,"FILTERS_BUTTONS_CANCEL",function(){return t}),o.d(d,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",function(){return i}),o.d(d,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",function(){return a}),o.d(d,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",function(){return m});var R="ContextMenu:items",c="".concat(R,".noItems"),X="".concat(R,".insertRowAbove"),w="".concat(R,".insertRowBelow"),x="".concat(R,".insertColumnOnTheLeft"),_="".concat(R,".insertColumnOnTheRight"),f="".concat(R,".removeRow"),S="".concat(R,".removeColumn"),C="".concat(R,".undo"),N="".concat(R,".redo"),h="".concat(R,".readOnly"),E="".concat(R,".clearColumn"),M="".concat(R,".copy"),y="".concat(R,".cut"),z="".concat(R,".freezeColumn"),U="".concat(R,".unfreezeColumn"),te="".concat(R,".mergeCells"),D="".concat(R,".unmergeCells"),k="".concat(R,".addComment"),T="".concat(R,".editComment"),G="".concat(R,".removeComment"),W="".concat(R,".readOnlyComment"),P="".concat(R,".align"),Q="".concat(R,".align.left"),O="".concat(R,".align.center"),A="".concat(R,".align.right"),Z="".concat(R,".align.justify"),ee="".concat(R,".align.top"),de="".concat(R,".align.middle"),be="".concat(R,".align.bottom"),Ne="".concat(R,".borders"),Me="".concat(R,".borders.top"),pe="".concat(R,".borders.right"),Be="".concat(R,".borders.bottom"),Ce="".concat(R,".borders.left"),Oe="".concat(R,".borders.remove"),Ae="".concat(R,".nestedHeaders.insertChildRow"),Ue="".concat(R,".nestedHeaders.detachFromParent"),ze="".concat(R,".hideColumn"),Ge="".concat(R,".showColumn"),I="".concat(R,".hideRow"),ge="".concat(R,".showRow"),V="Filters:",q="".concat(V,"conditions"),B="".concat(q,".none"),se="".concat(q,".isEmpty"),ie="".concat(q,".isNotEmpty"),Ee="".concat(q,".isEqualTo"),ye="".concat(q,".isNotEqualTo"),_e="".concat(q,".beginsWith"),st="".concat(q,".endsWith"),at="".concat(q,".contains"),it="".concat(q,".doesNotContain"),Xe="".concat(q,".byValue"),vt="".concat(q,".greaterThan"),lt="".concat(q,".greaterThanOrEqualTo"),yt="".concat(q,".lessThan"),Rt="".concat(q,".lessThanOrEqualTo"),Et="".concat(q,".isBetween"),rt="".concat(q,".isNotBetween"),Mt="".concat(q,".after"),g="".concat(q,".before"),v="".concat(q,".today"),F="".concat(q,".tomorrow"),re="".concat(q,".yesterday"),le="".concat(V,"labels.filterByCondition"),fe="".concat(V,"labels.filterByValue"),Se="".concat(V,"labels.conjunction"),ve="".concat(V,"labels.disjunction"),He="".concat(V,"values.blankCells"),Re="".concat(V,"buttons.selectAll"),L="".concat(V,"buttons.clear"),l="".concat(V,"buttons.ok"),t="".concat(V,"buttons.cancel"),i="".concat(V,"buttons.placeholder.search"),a="".concat(V,"buttons.placeholder.value"),m="".concat(V,"buttons.placeholder.secondValue")},function(De,d,o){"use strict";o.r(d),o.d(d,"setBrowserMeta",function(){return x}),o.d(d,"setPlatformMeta",function(){return _}),o.d(d,"isChrome",function(){return f}),o.d(d,"isEdge",function(){return S}),o.d(d,"isIE",function(){return C}),o.d(d,"isIE9",function(){return N}),o.d(d,"isMSBrowser",function(){return h}),o.d(d,"isMobileBrowser",function(){return E}),o.d(d,"isSafari",function(){return M}),o.d(d,"isFirefox",function(){return y}),o.d(d,"isWindowsOS",function(){return z}),o.d(d,"isMacOS",function(){return U}),o.d(d,"isLinuxOS",function(){return te});var R=o(32),c=D=>{var k={value:!1,test:(T,G)=>{k.value=D(T,G)}};return k},X={chrome:c((D,k)=>/Chrome/.test(D)&&/Google/.test(k)),edge:c(D=>/Edge/.test(D)),firefox:c(D=>/Firefox/.test(D)),ie:c(D=>/Trident/.test(D)),ie9:c(()=>!!document.documentMode),mobile:c(D=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(D)),safari:c((D,k)=>/Safari/.test(D)&&/Apple Computer/.test(k))},w={mac:c(D=>/^Mac/.test(D)),win:c(D=>/^Win/.test(D)),linux:c(D=>/^Linux/.test(D))};function x(){var{userAgent:D=navigator.userAgent,vendor:k=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object(R.objectEach)(X,T=>{var{test:G}=T;G(D,k)})}function _(){var{platform:D=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object(R.objectEach)(w,k=>{var{test:T}=k;T(D)})}function f(){return X.chrome.value}function S(){return X.edge.value}function C(){return X.ie.value}function N(){return X.ie9.value}function h(){return X.ie.value||X.edge.value}function E(){return X.mobile.value}function M(){return X.safari.value}function y(){return X.firefox.value}function z(){return w.win.value}function U(){return w.mac.value}function te(){return w.linux.value}x(),_()},function(De,d,o){"use strict";o.d(d,"d",function(){return x}),o.d(d,"a",function(){return _}),o.d(d,"c",function(){return f}),o.d(d,"b",function(){return S});var R=o(59),c=o(32),X=o(49),w=new WeakMap;function x(C,N){var h=Object(X.toUpperCaseFirst)(C);R.a.getSingleton().add("construct",function(){w.has(this)||w.set(this,{});var E=w.get(this);E[h]||(E[h]=new N(this))}),R.a.getSingleton().add("afterDestroy",function(){if(w.has(this)){var E=w.get(this);Object(c.objectEach)(E,M=>M.destroy()),w.delete(this)}})}function _(C,N){if(typeof N!="string")throw Error('Only strings can be passed as "plugin" parameter');var h=Object(X.toUpperCaseFirst)(N);if(w.has(C)&&w.get(C)[h])return w.get(C)[h]}function f(C){return w.has(C)?Object.keys(w.get(C)):[]}function S(C,N){var h=null;return w.has(C)&&Object(c.objectEach)(w.get(C),(E,M)=>{E===N&&(h=M)}),h}},,function(De,d,o){"use strict";o.r(d),o.d(d,"toUpperCaseFirst",function(){return c}),o.d(d,"equalsIgnoreCase",function(){return X}),o.d(d,"randomString",function(){return w}),o.d(d,"isPercentValue",function(){return x}),o.d(d,"substitute",function(){return _}),o.d(d,"stripTags",function(){return S});var R=o(40);function c(C){return C[0].toUpperCase()+C.substr(1)}function X(){for(var C=[],N=arguments.length,h=new Array(N),E=0;E<N;E++)h[E]=arguments[E];for(var M=h.length;M;){M-=1;var y=Object(R.stringify)(h[M]).toLowerCase();C.indexOf(y)===-1&&C.push(y)}return C.length===1}function w(){function C(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return C()+C()+C()+C()}function x(C){return/^([0-9][0-9]?%$)|(^100%$)/.test(C)}function _(C){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(C).replace(/(?:\\)?\[([^[\]]+)]/g,(h,E)=>h.charAt(0)==="\\"?h.substr(1,h.length-1):N[E]===void 0?"":N[E])}var f=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi;function S(C){return"".concat(C).replace(f,"")}},,,function(De,d,o){"use strict";o.d(d,"a",function(){return X});var R=o(1),c=o.n(R),X=w=>{var{description:x}=w;return c.a.createElement("p",{className:"toolbar-mobile-menu-item-text"},x)}},function(De,d,o){"use strict";o.d(d,"a",function(){return c});var R=new Map;function c(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";R.has(X)||R.set(X,new Map);var w=R.get(X);function x(N,h){w.set(N,h)}function _(N){return w.get(N)}function f(N){return w.has(N)}function S(){return[...w.keys()]}function C(){return[...w.values()]}return{register:x,getItem:_,hasItem:f,getNames:S,getValues:C}}},function(De,d,o){"use strict";o.d(d,"a",function(){return c});var R=o(33);function c(X){for(var w=arguments.length,x=new Array(w>1?w-1:0),_=1;_<w;_++)x[_-1]=arguments[_];var f=Object(R.arrayReduce)(X,(S,C,N)=>S+C.replace(/\r?\n\s*/g,"")+(x[N]?x[N]:""),"");return f.trim()}},function(De,d,o){"use strict";o.r(d),o.d(d,"requestAnimationFrame",function(){return N}),o.d(d,"isClassListSupported",function(){return h}),o.d(d,"isTextContentSupported",function(){return E}),o.d(d,"isGetComputedStyleSupported",function(){return M}),o.d(d,"cancelAnimationFrame",function(){return y}),o.d(d,"isTouchSupported",function(){return z}),o.d(d,"hasCaptionProblem",function(){return U}),o.d(d,"getComparisonFunction",function(){return te}),o.d(d,"isPassiveEventSupported",function(){return D});for(var R,c,X,w=o(34),x=0,_=["ms","moz","webkit","o"],f=window.requestAnimationFrame,S=window.cancelAnimationFrame,C=0;C<_.length&&!f;++C)f=window["".concat(_[C],"RequestAnimationFrame")],S=window["".concat(_[C],"CancelAnimationFrame")]||window["".concat(_[C],"CancelRequestAnimationFrame")];function N(k){return f.call(window,k)}function h(){return!!document.documentElement.classList}function E(){return!!document.createTextNode("test").textContent}function M(){return!!window.getComputedStyle}function y(k){S.call(window,k)}function z(){return"ontouchstart"in window}function U(){return R===void 0&&function(){var k=document.createElement("TABLE");k.style.borderSpacing="0",k.style.borderWidth="0",k.style.padding="0";var T=document.createElement("TBODY");k.appendChild(T),T.appendChild(document.createElement("TR")),T.firstChild.appendChild(document.createElement("TD")),T.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var G=document.createElement("CAPTION");G.innerHTML="c<br>c<br>c<br>c",G.style.padding="0",G.style.margin="0",k.insertBefore(G,T),document.body.appendChild(k),R=Object(w.offsetHeight)(k)<2*Object(w.offsetHeight)(k.lastChild),document.body.removeChild(k)}(),R}function te(k){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return c||(c=typeof Intl=="object"?new Intl.Collator(k,T).compare:typeof String.prototype.localeCompare=="function"?(G,W)=>"".concat(G).localeCompare(W):(G,W)=>G===W?0:G>W?-1:1)}function D(){if(X!==void 0)return X;try{var k={get passive(){X=!0}};window.addEventListener("test",k,k),window.removeEventListener("test",k,k)}catch(T){X=!1}return X}f||(f=function(k){var T=new Date().getTime(),G=Math.max(0,16-(T-x)),W=window.setTimeout(()=>{k(T+G)},G);return x=T+G,W}),S||(S=function(k){clearTimeout(k)})},function(De,d,o){"use strict";o.d(d,"a",function(){return R});var R=1},function(De,d,o){"use strict";function R(x){x.isImmediatePropagationEnabled=!1,x.cancelBubble=!0}function c(x){return x.isImmediatePropagationEnabled===!1}function X(x){return x.button===2}function w(x){return x.button===0}o.r(d),o.d(d,"stopImmediatePropagation",function(){return R}),o.d(d,"isImmediatePropagationStopped",function(){return c}),o.d(d,"isRightClick",function(){return X}),o.d(d,"isLeftClick",function(){return w})},,function(De,d,o){"use strict";var R=o(33),c=o(32),X=o(49),w=o(60),x=o(54);function _(){var M=function(y,z){return z||(z=y.slice(0)),Object.freeze(Object.defineProperties(y,{raw:{value:Object.freeze(z)}}))}([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to learn about the migration path.`]);return _=function(){return M},M}var f=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand"],S=Object(x.a)(_()),C=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),N=new Map([]);class h{static getSingleton(){return E}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){var y=Object.create(null);return Object(R.arrayEach)(f,z=>y[z]=[]),y}getBucket(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return y?(y.pluginHookBucket||(y.pluginHookBucket=this.createEmptyBucket()),y.pluginHookBucket):this.globalBucket}add(y,z){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(z))Object(R.arrayEach)(z,k=>this.add(y,k,U));else{C.has(y)&&Object(w.b)(Object(X.substitute)(S,{hookName:y,removedInVersion:C.get(y)})),N.has(y)&&Object(w.b)(N.get(y));var te=this.getBucket(U);if(te[y]===void 0&&(this.register(y),te[y]=[]),z.skip=!1,te[y].indexOf(z)===-1){var D=!1;z.initialHook&&Object(R.arrayEach)(te[y],(k,T)=>{if(k.initialHook)return te[y][T]=z,D=!0,!1}),D||te[y].push(z)}}return this}once(y,z){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(z)?Object(R.arrayEach)(z,te=>this.once(y,te,U)):(z.runOnce=!0,this.add(y,z,U))}remove(y,z){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,te=this.getBucket(U);return te[y]!==void 0&&te[y].indexOf(z)>=0&&(z.skip=!0,!0)}has(y){var z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,U=this.getBucket(z);return!(U[y]===void 0||!U[y].length)}run(y,z,U,te,D,k,T,G){var W=this.globalBucket[z],P=W?W.length:0,Q=0;if(P)for(;Q<P;)if(W[Q]&&!W[Q].skip){var O=W[Q].call(y,U,te,D,k,T,G);O!==void 0&&(U=O),W[Q]&&W[Q].runOnce&&this.remove(z,W[Q]),Q+=1}else Q+=1;var A=this.getBucket(y)[z],Z=A?A.length:0,ee=0;if(Z)for(;ee<Z;)if(A[ee]&&!A[ee].skip){var de=A[ee].call(y,U,te,D,k,T,G);de!==void 0&&(U=de),A[ee]&&A[ee].runOnce&&this.remove(z,A[ee],y),ee+=1}else ee+=1;return U}destroy(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Object(c.objectEach)(this.getBucket(y),(z,U,te)=>te[U].length=0)}register(y){this.isRegistered(y)||f.push(y)}deregister(y){this.isRegistered(y)&&f.splice(f.indexOf(y),1)}isDeprecated(y){return N.has(y)||C.has(y)}isRegistered(y){return f.indexOf(y)>=0}getRegistered(){return f}}var E=new h;d.a=h},function(De,d,o){"use strict";o.d(d,"b",function(){return c}),o.d(d,"a",function(){return X});var R=o(40);function c(){Object(R.isDefined)(console)&&console.warn(...arguments)}function X(){Object(R.isDefined)(console)&&console.error(...arguments)}},function(De,d,o){"use strict";o.r(d),o.d(d,"isFunction",function(){return c}),o.d(d,"throttle",function(){return X}),o.d(d,"throttleAfterHits",function(){return w}),o.d(d,"debounce",function(){return x}),o.d(d,"pipe",function(){return _}),o.d(d,"partial",function(){return f}),o.d(d,"curry",function(){return S}),o.d(d,"curryRight",function(){return C});var R=o(33);function c(N){return typeof N=="function"}function X(N){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,E=0,M={lastCallThrottled:!0},y=null;function z(){for(var U=arguments.length,te=new Array(U),D=0;D<U;D++)te[D]=arguments[D];var k=Date.now(),T=!1;M.lastCallThrottled=!0,E||(E=k,T=!0);var G=h-(k-E);return T?(M.lastCallThrottled=!1,N.apply(this,te)):(y&&clearTimeout(y),y=setTimeout(()=>{M.lastCallThrottled=!1,N.apply(this,te),E=0,y=void 0},G)),M}return z}function w(N){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,M=X(N,h),y=E;function z(){y=E}function U(){for(var te=arguments.length,D=new Array(te),k=0;k<te;k++)D[k]=arguments[k];return y?(y-=1,N.apply(this,D)):M.apply(this,D)}return U.clearHits=z,U}function x(N){var h,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,M=null;function y(){for(var z=arguments.length,U=new Array(z),te=0;te<z;te++)U[te]=arguments[te];return M&&clearTimeout(M),M=setTimeout(()=>{h=N.apply(this,U)},E),h}return y}function _(){for(var N=arguments.length,h=new Array(N),E=0;E<N;E++)h[E]=arguments[E];var[M,...y]=h;return function(){for(var z=arguments.length,U=new Array(z),te=0;te<z;te++)U[te]=arguments[te];return Object(R.arrayReduce)(y,(D,k)=>k(D),M.apply(this,U))}}function f(N){for(var h=arguments.length,E=new Array(h>1?h-1:0),M=1;M<h;M++)E[M-1]=arguments[M];return function(){for(var y=arguments.length,z=new Array(y),U=0;U<y;U++)z[U]=arguments[U];return N.apply(this,E.concat(z))}}function S(N){var h=N.length;return function E(M){return function(){for(var y=arguments.length,z=new Array(y),U=0;U<y;U++)z[U]=arguments[U];var te=M.concat(z);return te.length>=h?N.apply(this,te):E(te)}}([])}function C(N){var h=N.length;return function E(M){return function(){for(var y=arguments.length,z=new Array(y),U=0;U<y;U++)z[U]=arguments[U];var te=M.concat(z.reverse());return te.length>=h?N.apply(this,te):E(te)}}([])}},function(De,d,o){"use strict";var R=o(33),c=o(32),X={_localHooks:Object.create(null),addLocalHook(w,x){return this._localHooks[w]||(this._localHooks[w]=[]),this._localHooks[w].push(x),this},runLocalHooks(w){for(var x=arguments.length,_=new Array(x>1?x-1:0),f=1;f<x;f++)_[f-1]=arguments[f];this._localHooks[w]&&Object(R.arrayEach)(this._localHooks[w],S=>S.apply(this,_))},clearLocalHooks(){return this._localHooks={},this}};Object(c.defineGetter)(X,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),d.a=X},function(De,d){},,,function(De,d,o){"use strict";o.d(d,"a",function(){return x});var R=o(1),c=o.n(R),X=o(67),w=_=>{var{state:f,close:S}=_;return c.a.createElement(c.a.Fragment,null,f[X.b]&&c.a.createElement(X.a,{onClose:()=>S(X.b)}))},x=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},[f,S]=Object(R.useState)(()=>_),C=E=>{S(M=>Object.assign(Object.assign({},M),{[E]:!0}))},N=E=>{S(M=>Object.assign(Object.assign({},M),{[E]:!1}))},h=()=>c.a.createElement(w,{state:f,close:N});return{Modals:h,openModal:C,closeModal:N}}},function(De,d,o){"use strict";o.d(d,"b",function(){return _}),o.d(d,"a",function(){return f});var R=o(1),c=o.n(R),X=o(189),w=S=>{var{onClose:C,isMobile:N}=S;return c.a.createElement("svg",Object.assign({viewBox:"0 0 16 16",className:"close-icon-modal",onClick:C,"data-cy":"close-modal"},N?{width:24,height:24}:{width:16,height:16}),c.a.createElement("path",{d:"M12.054 4.95l-.844-.844a.066.066 0 00-.093 0l-3 3a.066.066 0 01-.093 0l-3-3a.066.066 0 00-.093 0l-.838.844a.066.066 0 000 .093l3 3a.066.066 0 010 .093l-3 3a.066.066 0 000 .093l.844.844a.066.066 0 00.093 0l3-3a.066.066 0 01.093 0l3 3a.066.066 0 00.093 0l.844-.844a.066.066 0 000-.093l-3-3a.066.066 0 010-.093l3-3a.066.066 0 00-.006-.093z",fill:"#1d1d1d"}))},x=o(17),_="feedback",f=S=>{var{onClose:C}=S,N=Object(x.b)();return c.a.createElement(X.a,{open:!0,onClose:C,PaperComponent:()=>c.a.createElement("div",{className:"modal modal-feedback","data-cy":"modal-feedback"},c.a.createElement(w,{onClose:C,isMobile:N}),c.a.createElement("p",{className:"modal-title"},"Feedback"),c.a.createElement("p",{className:"modal-description"},"Are you missing a feature?",c.a.createElement("br",null),"Do you think an existing function could be improved?"),c.a.createElement("a",{href:"https://handsoncode.typeform.com/to/LqlEyO8z",target:"_blank",rel:"noopener noreferrer",className:"sv-button ".concat(N?"mobile-feedback-button":"")},"Fill out the feedback form")),classes:{root:"modal-feedback-background"}})}},,function(De,d,o){"use strict";o.d(d,"a",function(){return c});var R=o(1),c=X=>{var[w,x]=Object(R.useState)(void 0);return Object(R.useEffect)(()=>{if(typeof X=="string")return X.indexOf("data:")===0||X.indexOf("blob:"),void x(X);var _=URL.createObjectURL(new Blob([X]));return x(_),()=>URL.revokeObjectURL(_)},[X]),w}},,,function(De,d,o){"use strict";var R;o.d(d,"a",function(){return c});var c=()=>{var X;return R===void 0&&(R="download"in document.createElement("a")&&!((X=window.webkit)===null||X===void 0?void 0:X.messageHandlers)),R}},function(De,d,o){"use strict";(function(R){o(137),o(138),o(139),o(140);var c=o(87),X=o(97),w=o(88),x=o(89),_=o(142),f=o(147),S=o(43),C=o(92),N=o(59),h=o(93),E=o(90),M=o(33),y=o(46),z=o(75),U=o(148),te=o(55),D=o(61),k=o(40),T=o(44),G=o(32),W=o(49),P=o(74),Q=o(34),O=o(57),A=o(150),Z=o(47),ee=o(124),de=o(118),be=o(127),Ne=o(45),Me=o(79);function pe(Oe,Ae){var Ue=new _.a(Oe,Ae||{},de.d);return Ue.init(),Ue}Object(f.a)(pe),pe.Core=function(Oe){var Ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new _.a(Oe,Ae,de.d)},pe.DefaultSettings=Object(ee.c)(),pe.EventManager=S.a,pe._getListenersCounter=S.b,pe._getRegisteredMapsCounter=C.b,pe.packageName="handsontable",pe.buildDate=R.env.HOT_BUILD_DATE,pe.version=R.env.HOT_VERSION,pe.hooks=N.a.getSingleton(),pe.__GhostTable=h.a;var Be=[M,y,z,U,te,D,k,T,G,W,P,E],Ce=[Q,O];pe.helper={},pe.dom={},M.arrayEach(Be,Oe=>{M.arrayEach(Object.getOwnPropertyNames(Oe),Ae=>{Ae.charAt(0)!=="_"&&(pe.helper[Ae]=Oe[Ae])})}),M.arrayEach(Ce,Oe=>{M.arrayEach(Object.getOwnPropertyNames(Oe),Ae=>{Ae.charAt(0)!=="_"&&(pe.dom[Ae]=Oe[Ae])})}),pe.cellTypes={},M.arrayEach(Object(x.b)(),Oe=>{pe.cellTypes[Oe]=Object(x.a)(Oe)}),pe.cellTypes.registerCellType=x.c,pe.cellTypes.getCellType=x.a,pe.editors={},M.arrayEach(Object(c.c)(),Oe=>{pe.editors["".concat(W.toUpperCaseFirst(Oe),"Editor")]=Object(c.a)(Oe)}),pe.editors.registerEditor=c.d,pe.editors.getEditor=c.a,pe.renderers={},M.arrayEach(Object(X.a)(),Oe=>{var Ae=Object(X.b)(Oe);Oe==="base"&&(pe.renderers.cellDecorator=Ae),pe.renderers["".concat(W.toUpperCaseFirst(Oe),"Renderer")]=Ae}),pe.renderers.registerRenderer=X.c,pe.renderers.getRenderer=X.b,pe.validators={},M.arrayEach(Object(w.a)(),Oe=>{pe.validators["".concat(W.toUpperCaseFirst(Oe),"Validator")]=Object(w.b)(Oe)}),pe.validators.registerValidator=w.c,pe.validators.getValidator=w.b,pe.plugins={},M.arrayEach(Object.getOwnPropertyNames(A),Oe=>{var Ae=A[Oe];Oe==="Base"?pe.plugins["".concat(Oe,"Plugin")]=Ae:pe.plugins[Oe]=Ae}),pe.plugins.registerPlugin=Z.d,pe.languages={},pe.languages.dictionaryKeys=Ne,pe.languages.getLanguageDictionary=Me.b,pe.languages.getLanguagesDictionaries=Me.c,pe.languages.registerLanguageDictionary=Me.e,pe.languages.getTranslatedPhrase=function(){return Object(be.a)(...arguments)},d.a=pe}).call(this,o(115))},function(De,d,o){"use strict";o.r(d),o.d(d,"KEY_CODES",function(){return c}),o.d(d,"isPrintableChar",function(){return X}),o.d(d,"isMetaKey",function(){return w}),o.d(d,"isCtrlKey",function(){return x}),o.d(d,"isCtrlMetaKey",function(){return _}),o.d(d,"isKey",function(){return f});var R=o(33),c={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};function X(S){return S===32||S>=48&&S<=57||S>=96&&S<=111||S>=186&&S<=192||S>=219&&S<=222||S>=226||S>=65&&S<=90}function w(S){return[c.ARROW_DOWN,c.ARROW_UP,c.ARROW_LEFT,c.ARROW_RIGHT,c.HOME,c.END,c.DELETE,c.BACKSPACE,c.F1,c.F2,c.F3,c.F4,c.F5,c.F6,c.F7,c.F8,c.F9,c.F10,c.F11,c.F12,c.TAB,c.PAGE_DOWN,c.PAGE_UP,c.ENTER,c.ESCAPE,c.SHIFT,c.CAPS_LOCK,c.ALT].indexOf(S)!==-1}function x(S){var C=[];return navigator.platform.includes("Mac")?C.push(c.COMMAND_LEFT,c.COMMAND_RIGHT,c.COMMAND_FIREFOX):C.push(c.CONTROL),C.includes(S)}function _(S){return[c.CONTROL,c.COMMAND_LEFT,c.COMMAND_RIGHT,c.COMMAND_FIREFOX].includes(S)}function f(S,C){var N=C.split("|"),h=!1;return Object(R.arrayEach)(N,E=>{if(S===c[E])return h=!0,!1}),h}},function(De,d,o){"use strict";o.r(d),o.d(d,"spreadsheetColumnLabel",function(){return w}),o.d(d,"spreadsheetColumnIndex",function(){return x}),o.d(d,"createSpreadsheetData",function(){return _}),o.d(d,"createSpreadsheetObjectData",function(){return f}),o.d(d,"createEmptySpreadsheetData",function(){return S}),o.d(d,"translateRowsToColumns",function(){return C}),o.d(d,"cellMethodLookupFactory",function(){return N}),o.d(d,"dataRowToChangesArray",function(){return h}),o.d(d,"countFirstRowKeys",function(){return E});var R=o(89),c=o(32),X="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;function w(M){for(var y,z=M+1,U="";z>0;)y=(z-1)%X,U=String.fromCharCode(65+y)+U,z=parseInt((z-y)/X,10);return U}function x(M){var y=0;if(M)for(var z=0,U=M.length-1;z<M.length;z+=1,U-=1)y+=ur(X,U)*("ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(M[z])+1);return y-=1}function _(){var M,y,z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,te=[];for(M=0;M<z;M++){var D=[];for(y=0;y<U;y++)D.push(w(y)+(M+1));te.push(D)}return te}function f(){var M,y,z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,te=[];for(M=0;M<z;M++){var D={};for(y=0;y<U;y++)D["prop".concat(y)]=w(y)+(M+1);te.push(D)}return te}function S(M,y){for(var z,U=[],te=0;te<M;te++){z=[];for(var D=0;D<y;D++)z.push("");U.push(z)}return U}function C(M){var y,z,U,te,D=[],k=0;for(y=0,z=M.length;y<z;y++)for(U=0,te=M[y].length;U<te;U++)U===k&&(D.push([]),k+=1),D[U].push(M[y][U]);return D}function N(M,y){var z=y===void 0||y;return function(U,te){return function D(k){if(k){if(Object(c.hasOwnProperty)(k,M)&&k[M]!==void 0)return k[M];if(Object(c.hasOwnProperty)(k,"type")&&k.type){if(typeof k.type!="string")throw new Error('Cell "type" must be a string');var T=Object(R.a)(k.type);if(Object(c.hasOwnProperty)(T,M))return T[M];if(z)return}return D(Object.getPrototypeOf(k))}}(typeof U=="number"?this.getCellMeta(U,te):U)}}function h(M){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,z=M,U=[];return Array.isArray(M)&&Array.isArray(M[0])||(z=[M]),z.forEach((te,D)=>{Array.isArray(te)?te.forEach((k,T)=>{U.push([D+y,T,k])}):Object.keys(te).forEach(k=>{U.push([D+y,k,te[k]])})}),U}function E(M){var y=0;return Array.isArray(M)&&(M[0]&&Array.isArray(M[0])?y=M[0].length:M[0]&&Object(c.isObject)(M[0])&&(y=Object(c.deepObjectSize)(M[0]))),y}},,function(De,d,o){"use strict";o.d(d,"a",function(){return _});var R=o(1),c=o.n(R),X=()=>c.a.createElement("svg",{viewBox:"0 0 24 24"},c.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),c.a.createElement("rect",{className:"svg-icon",width:14,height:2,rx:.095,transform:"translate(5 3)"}),c.a.createElement("path",{className:"svg-icon",d:"M8.116 12h2.789a.1.1 0 01.095.1v8.809a.1.1 0 00.095.1h1.81a.1.1 0 00.095-.1V12.1a.1.1 0 01.095-.1h2.789a.1.1 0 00.067-.163l-3.884-3.874a.1.1 0 00-.134 0l-3.884 3.874a.1.1 0 00.067.163z"})),w=o(52),x=function(f,S,C,N){return new(C||(C=Promise))(function(h,E){function M(U){try{z(N.next(U))}catch(te){E(te)}}function y(U){try{z(N.throw(U))}catch(te){E(te)}}function z(U){var te;U.done?h(U.value):(te=U.value,te instanceof C?te:new C(function(D){D(te)})).then(M,y)}z((N=N.apply(f,S||[])).next())})},_=f=>{var{renderWorkbook:S,mobile:C}=f,N=E=>x(void 0,void 0,void 0,function*(){if(E.length!==0){var M=E.item(0);if(M!==null){var y=yield(z=>new Promise((U,te)=>{z.name&&console.log("RECEIVED FILE: ".concat(z.name));var D=new FileReader;D.readAsArrayBuffer(z),D.addEventListener("load",k=>{var T;((T=k.target)===null||T===void 0?void 0:T.result)instanceof ArrayBuffer?U(k.target.result):te()})}))(M);S({type:"arraybuffer",arrayBuffer:y,fileName:M.name})}}}),h=C?"toolbar-upload-input-mobile":"toolbar-upload-input";return c.a.createElement("label",{htmlFor:h},c.a.createElement("input",{type:"file",onChange:E=>{var M;((M=E.target)===null||M===void 0?void 0:M.files)&&N(E.target.files)},hidden:!0,"data-cy":h,id:h}),c.a.createElement("div",{className:"icon","data-cy":C?"toolbar-upload-button-mobile":"toolbar-upload-button"},c.a.createElement(X,null),C?c.a.createElement(w.a,{description:"Upload"}):c.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},c.a.createElement("span",null,"Upload"))))}},function(De,d,o){"use strict";o.d(d,"a",function(){return _});var R=o(1),c=o.n(R),X=()=>c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},c.a.createElement("path",{className:"svg-icon",d:"M447.46,404.216l0,3.4a2.286,2.286,0,0,1-2.279,2.279l-9.45-.007a1.089,1.089,0,0,0-.77.319l-2.33,2.1a.1.1,0,0,1-.169-.07V401.209a2.321,2.321,0,0,1,2.279-2.319h5.393a.1.1,0,0,0,.07-.029l1.781-1.8a.1.1,0,0,0-.07-.169h-7.174a4.327,4.327,0,0,0-4.279,4.319V414.89a1,1,0,0,0,.62.92.839.839,0,0,0,.38.08,1.007,1.007,0,0,0,.71-.29l3.919-3.688a.1.1,0,0,1,.07-.029l9.119.007a4.185,4.185,0,0,0,4.18-4.18l0-5.3a.1.1,0,0,0-.169-.07l-1.8,1.8A.1.1,0,0,0,447.46,404.216Z",transform:"translate(-427.46 -393.89)"}),c.a.createElement("path",{className:"svg-icon",d:"M466.282,397.81a3.005,3.005,0,0,0-4.249,0l-6.578,6.578a1,1,0,0,0-.293.707v2.835a1,1,0,0,0,1,1H459a1,1,0,0,0,.707-.293l6.578-6.578A3.005,3.005,0,0,0,466.282,397.81Zm-1.414,1.414.006.007a1,1,0,0,1-.006,1.414l0,0-1.421-1.42,0,0A1.008,1.008,0,0,1,464.868,399.224Zm-6.285,7.706h-1.421v-1.421l4.868-4.868,1.421,1.42Z",transform:"translate(-445.162 -394.93)"})),w=o(52),x=o(67),_=c.a.forwardRef((f,S)=>{var{open:C,mobile:N=!1}=f;return c.a.createElement("button",{type:"button",className:"icon",id:"feedback-icon",onClick:()=>C(x.b),"data-cy":N?"toolbar-feedback-button-mobile":"toolbar-feedback-button",ref:S},c.a.createElement(X,null),N?c.a.createElement(w.a,{description:"Feedback"}):c.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},c.a.createElement("span",null,"Feedback")))})},function(De,d,o){"use strict";o.d(d,"e",function(){return h}),o.d(d,"b",function(){return E}),o.d(d,"d",function(){return M}),o.d(d,"c",function(){return y}),o.d(d,"a",function(){return _});var R=o(32),c=o(119),X=o(53),w=o(45),x={languageCode:"en-US",[w.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[w.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[w.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[w.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[w.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[w.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[w.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[w.CONTEXTMENU_ITEMS_UNDO]:"Undo",[w.CONTEXTMENU_ITEMS_REDO]:"Redo",[w.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[w.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[w.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[w.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[w.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[w.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[w.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[w.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[w.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[w.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[w.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[w.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[w.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[w.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[w.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[w.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[w.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[w.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[w.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[w.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[w.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[w.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[w.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[w.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[w.CONTEXTMENU_ITEMS_COPY]:"Copy",[w.CONTEXTMENU_ITEMS_CUT]:"Cut",[w.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[w.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[w.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[w.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[w.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[w.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[w.FILTERS_CONDITIONS_NONE]:"None",[w.FILTERS_CONDITIONS_EMPTY]:"Is empty",[w.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[w.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[w.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[w.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[w.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[w.FILTERS_CONDITIONS_CONTAINS]:"Contains",[w.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[w.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[w.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[w.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[w.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[w.FILTERS_CONDITIONS_BETWEEN]:"Is between",[w.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[w.FILTERS_CONDITIONS_AFTER]:"After",[w.FILTERS_CONDITIONS_BEFORE]:"Before",[w.FILTERS_CONDITIONS_TODAY]:"Today",[w.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[w.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[w.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[w.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[w.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[w.FILTERS_LABELS_CONJUNCTION]:"And",[w.FILTERS_LABELS_DISJUNCTION]:"Or",[w.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[w.FILTERS_BUTTONS_CLEAR]:"Clear",[w.FILTERS_BUTTONS_OK]:"OK",[w.FILTERS_BUTTONS_CANCEL]:"Cancel",[w.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[w.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[w.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value"},_=x.languageCode,{register:f,getItem:S,hasItem:C,getValues:N}=Object(X.a)("languagesDictionaries");function h(z,U){var te=z,D=U;return Object(R.isObject)(z)&&(te=(D=z).languageCode),function(k,T){k!==_&&Object(c.a)(T,S(_))}(te,D),f(te,Object(R.deepClone)(D)),Object(R.deepClone)(D)}function E(z){return M(z)?Object(R.deepClone)(S(z)):null}function M(z){return C(z)}function y(){return N()}h(x)},,function(De,d,o){"use strict";o.d(d,"a",function(){return R}),o.d(d,"b",function(){return c}),new Map([["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.ms-excel","xls"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/x-iwork-numbers-sffnumbers","numbers"],["application/vnd.apple.numbers","numbers"]]);var R=X=>X.fileName!==void 0||X.type==="arraybuffer"?X.fileName:(w=>{if(!w.startsWith("data:")){var x=w.split("/").pop();if(x!==void 0&&x.length!==0)return x}})(X.url),c="Unnamed file"},function(De,d,o){"use strict";var R=o(63);o.o(R,"useModals")&&o.d(d,"useModals",function(){return R.useModals});var c=o(66);o.d(d,"useModals",function(){return c.a})},,,,,function(De,d,o){"use strict";o.d(d,"d",function(){return E}),o.d(d,"a",function(){return h}),o.d(d,"b",function(){return N}),o.d(d,"c",function(){return f});var R=o(53),c=o(59),X=new WeakMap,{register:w,getItem:x,hasItem:_,getNames:f,getValues:S}=Object(R.a)("editors");function C(M){var y={},z=M;this.getConstructor=function(){return M},this.getInstance=function(U){return U.guid in y||(y[U.guid]=new z(U)),y[U.guid]},c.a.getSingleton().add("afterDestroy",function(){y[this.guid]=null})}function N(M,y){var z;if(typeof M=="function")X.get(M)||E(null,M),z=X.get(M);else{if(typeof M!="string")throw Error('Only strings and functions can be passed as "editor" parameter');z=x(M)}if(!z)throw Error('No editor registered under name "'.concat(M,'"'));return z.getInstance(y)}function h(M){if(!_(M))throw Error('No registered editor found under "'.concat(M,'" name'));return x(M).getConstructor()}function E(M,y){var z=new C(y);typeof M=="string"&&w(M,z),X.set(y,z)}},function(De,d,o){"use strict";o.d(d,"c",function(){return c}),o.d(d,"b",function(){return f}),o.d(d,"a",function(){return x});var R=o(53),{register:c,getItem:X,hasItem:w,getNames:x,getValues:_}=Object(R.a)("validators");function f(S){if(typeof S=="function")return S;if(!w(S))throw Error('No registered validator found under "'.concat(S,'" name'));return X(S)}},function(De,d,o){"use strict";o.d(d,"c",function(){return h}),o.d(d,"a",function(){return N}),o.d(d,"b",function(){return S});var R=o(53),c=o(87),X=o(97),w=o(88),{register:x,getItem:_,hasItem:f,getNames:S,getValues:C}=Object(R.a)("cellTypes");function N(E){if(!f(E))throw Error('You declared cell type "'.concat(E,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method`));return _(E)}function h(E,M){var{editor:y,renderer:z,validator:U}=M;y&&Object(c.d)(E,y),z&&Object(X.c)(E,z),U&&Object(w.c)(E,U),x(E,M)}},function(De,d,o){"use strict";o.r(d),o.d(d,"instanceToHTML",function(){return _}),o.d(d,"_dataToHTML",function(){return f}),o.d(d,"htmlToGridSettings",function(){return S});var R=o(34),c=o(40),X={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},w=new RegExp(Object.keys(X).map(C=>"(".concat(C,")")).join("|"),"gi");function x(C){return(C&&C.nodeName||"")==="TABLE"}function _(C){for(var N=C.hasColHeaders(),h=C.hasRowHeaders(),E=[N?-1:0,h?-1:0,C.countRows()-1,C.countCols()-1],M=C.getData(...E),y=M.length,z=y>0?M[0].length:0,U=["<table>","</table>"],te=N?["<thead>","</thead>"]:[],D=["<tbody>","</tbody>"],k=h?1:0,T=N?1:0,G=0;G<y;G+=1){for(var W=N&&G===0,P=[],Q=0;Q<z;Q+=1){var O=!W&&h&&Q===0,A="";if(W)A="<th>".concat(C.getColHeader(Q-k),"</th>");else if(O)A="<th>".concat(C.getRowHeader(G-T),"</th>");else{var Z=M[G][Q],{hidden:ee,rowspan:de,colspan:be}=C.getCellMeta(G-k,Q-T);if(!ee){var Ne=[];if(de&&Ne.push('rowspan="'.concat(de,'"')),be&&Ne.push('colspan="'.concat(be,'"')),Object(c.isEmpty)(Z))A="<td ".concat(Ne.join(" "),"></td>");else{var Me=Z.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");A="<td ".concat(Ne.join(" "),">").concat(Me,"</td>")}}}P.push(A)}var pe=["<tr>",...P,"</tr>"].join("");W?te.splice(1,0,pe):D.splice(-1,0,pe)}return U.splice(1,0,te.join(""),D.join("")),U.join("")}function f(C){for(var N=C.length,h=["<table>"],E=0;E<N;E+=1){var M=C[E],y=M.length,z=[];E===0&&h.push("<tbody>");for(var U=0;U<y;U+=1){var te=M[U],D=Object(c.isEmpty)(te)?"":te.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");z.push("<td>".concat(D,"</td>"))}h.push("<tr>",...z,"</tr>"),E+1===N&&h.push("</tbody>")}return h.push("</table>"),h.join("")}function S(C){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,h={},E=N.createDocumentFragment(),M=N.createElement("div");E.appendChild(M);var y=C;if(typeof y=="string"){var z=y.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,ze=>{var Ge=ze.match(/<td\b[^>]*?>/g)[0],I=ze.substring(Ge.length,ze.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(Ge).concat(I).concat("</td>")});M.insertAdjacentHTML("afterbegin","".concat(z)),y=M.querySelector("table")}if(y&&x(y)){var U=M.querySelector("style"),te=null,D=[];U&&(N.body.appendChild(U),U.disabled=!0,te=U.sheet,D=te?Array.from(te.cssRules):[],N.body.removeChild(U));var k=M.querySelector('meta[name$="enerator"]'),T=y.querySelector("tbody th")!==null,G=Array.from(y.querySelector("tr").cells).reduce((ze,Ge)=>ze+Ge.colSpan,0)-(T?1:0),W=y.tFoot&&Array.from(y.tFoot.rows)||[],P=[],Q=!1,O=0,A=0;if(y.tHead){var Z=Array.from(y.tHead.rows).filter(ze=>{var Ge=ze.querySelector("td")!==null;return Ge&&P.push(ze),!Ge});Q=(O=Z.length)>0,O>1?h.nestedHeaders=Array.from(Z).reduce((ze,Ge)=>{var I=Array.from(Ge.cells).reduce((ge,V,q)=>{if(T&&q===0)return ge;var{colSpan:B,innerHTML:se}=V,ie=B>1?{label:se,colspan:B}:se;return ge.push(ie),ge},[]);return ze.push(I),ze},[]):Q&&(h.colHeaders=Array.from(Z[0].children).reduce((ze,Ge,I)=>(T&&I===0||ze.push(Ge.innerHTML),ze),[]))}P.length&&(h.fixedRowsTop=P.length),W.length&&(h.fixedRowsBottom=W.length);var ee=[...P,...Array.from(y.tBodies).reduce((ze,Ge)=>(ze.push(...Array.from(Ge.rows)),ze),[]),...W];A=ee.length;for(var de=new Array(A),be=0;be<A;be++)de[be]=new Array(G);for(var Ne=[],Me=[],pe=0;pe<A;pe++)for(var Be=ee[pe],Ce=Array.from(Be.cells),Oe=Ce.length,Ae=function(ze){var Ge=Ce[ze],{nodeName:I,innerHTML:ge,rowSpan:V,colSpan:q}=Ge,B=de[pe].findIndex(_e=>_e===void 0);if(I==="TD"){if(V>1||q>1){for(var se=pe;se<pe+V;se++)if(se<A)for(var ie=B;ie<B+q;ie++)de[se][ie]=null;var Ee=Ge.getAttribute("style");Ee&&Ee.includes("mso-ignore:colspan")||Ne.push({col:B,row:pe,rowspan:V,colspan:q})}var ye="";ye=D.reduce((_e,st)=>{if(Object(R.matchesCSSRules)(Ge,st)){var{whiteSpace:at}=st.style;at&&(_e.whiteSpace=at)}return _e},{}).whiteSpace==="nowrap"?ge.replace(/[\r\n][\x20]{0,2}/gim," ").replace(/<br(\s*|\/)>/gim,`\r
`):k&&/excel/gi.test(k.content)?ge.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ge.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),de[pe][B]=ye.replace(w,_e=>X[_e])}else Me.push(ge)},Ue=0;Ue<Oe;Ue++)Ae(Ue);return Ne.length&&(h.mergeCells=Ne),Me.length&&(h.rowHeaders=Me),de.length&&(h.data=de),h}}},function(De,d,o){"use strict";o.d(d,"a",function(){return x});var R=o(57),c=o(38);function X(_){var{isShiftKey:f,isLeftClick:S,isRightClick:C,coords:N,selection:h,controller:E}=_,M=h.isSelected()?h.getSelectedRange().current():null,y=h.isSelectedByCorner(),z=h.isSelectedByRowHeader();if(f&&M)N.row>=0&&N.col>=0&&!E.cells?h.setRangeEnd(N):(y||z)&&N.row>=0&&N.col>=0&&!E.cells?h.setRangeEnd(new c.a(N.row,N.col)):y&&N.row<0&&!E.column?h.setRangeEnd(new c.a(M.to.row,N.col)):z&&N.col<0&&!E.row?h.setRangeEnd(new c.a(N.row,M.to.col)):(!y&&!z&&N.col<0||y&&N.col<0)&&!E.row?h.selectRows(M.from.row,N.row):(!y&&!z&&N.row<0||z&&N.row<0)&&!E.column&&h.selectColumns(M.from.col,N.col);else{var U=new c.a(N.row,N.col);U.row<0&&(U.row=0),U.col<0&&(U.col=0);var te=!h.inInSelection(U),D=S||C&&te;N.row<0&&N.col>=0&&!E.column?D&&h.selectColumns(N.col):N.col<0&&N.row>=0&&!E.row?D&&h.selectRows(N.row):N.col>=0&&N.row>=0&&!E.cells?D&&h.setRangeStart(N):N.col<0&&N.row<0&&h.selectAll()}}var w=new Map([["mousedown",X],["mouseover",function(_){var{isLeftClick:f,coords:S,selection:C,controller:N}=_;if(f){var h=C.isSelectedByRowHeader(),E=C.isSelectedByColumnHeader(),M=C.tableProps.countCols(),y=C.tableProps.countRows();E&&!N.column?C.setRangeEnd(new c.a(y-1,S.col)):h&&!N.row?C.setRangeEnd(new c.a(S.row,M-1)):N.cell||C.setRangeEnd(S)}}],["touchstart",X]]);function x(_,f){var{coords:S,selection:C,controller:N}=f;w.get(_.type)({coords:S,selection:C,controller:N,isShiftKey:_.shiftKey,isLeftClick:Object(R.isLeftClick)(_)||_.type==="touchstart",isRightClick:Object(R.isRightClick)(_)})}},function(De,d,o){"use strict";o.d(d,"b",function(){return _});var R=o(40),c=o(32),X=o(62),w=0;class x{constructor(){this.collection=new Map}register(S,C){this.collection.has(S)===!1&&(this.collection.set(S,C),C.addLocalHook("change",()=>this.runLocalHooks("change",C)),w+=1)}unregister(S){var C=this.collection.get(S);Object(R.isDefined)(C)&&(C.clearLocalHooks(),this.collection.delete(S),this.runLocalHooks("change",C),w-=1)}get(S){return Object(R.isUndefined)(S)?Array.from(this.collection.values()):this.collection.get(S)}getLength(){return this.collection.size}removeFromEvery(S){this.collection.forEach(C=>{C.remove(S)})}insertToEvery(S,C){this.collection.forEach(N=>{N.insert(S,C)})}initEvery(S){this.collection.forEach(C=>{C.init(S)})}}function _(){return w}Object(c.mixin)(x,X.a),d.a=x},function(De,d,o){"use strict";var R=o(34),c=o(33),X=o(56);d.a=class{constructor(w){this.hot=w,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(w,x){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var _={row:w};this.rows.push(_),this.samples=x,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(w)),this.container.container.appendChild(this.table.fragment),_.table=this.table.table}addColumnHeadersRow(w){var x=this.hot.getColHeader(0);if(x!=null){var _={row:-1};this.rows.push(_),this.container=this.createContainer(this.hot.rootElement.className),this.samples=w,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),_.table=this.table.table,Object(R.removeClass)(this.table.tBody,"afterEmptyThead")}else Object(R.addClass)(this.table.tBody,"afterEmptyThead")}addColumn(w,x){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var _={col:w};this.columns.push(_),this.samples=x,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(w)!==null&&this.hot.view.appendColHeader(w,this.table.th),this.table.tBody.appendChild(this.createCol(w)),this.container.container.appendChild(this.table.fragment),_.table=this.table.table}getHeights(w){this.injected||this.injectTable(),Object(c.arrayEach)(this.rows,x=>{w(x.row,Object(R.outerHeight)(x.table)-X.a)})}getWidths(w){this.injected||this.injectTable(),Object(c.arrayEach)(this.columns,x=>{var _=x.table.getBoundingClientRect().width,f=Math.ceil(_);w(x.col,f)})}setSettings(w){this.settings=w}setSetting(w,x){this.settings||(this.settings={}),this.settings[w]=x}getSettings(){return this.settings}getSetting(w){return this.settings?this.settings[w]:null}createColGroupsCol(){var w=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&w.appendChild(this.createColElement(-1)),this.samples.forEach(x=>{Object(c.arrayEach)(x.strings,_=>{w.appendChild(this.createColElement(_.col))})}),w}createRow(w){var{rootDocument:x}=this.hot,_=x.createDocumentFragment(),f=x.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(w,f),_.appendChild(f)),this.samples.forEach(S=>{Object(c.arrayEach)(S.strings,C=>{var N=C.col,h=this.hot.getCellMeta(w,N);h.col=N,h.row=w;var E=this.hot.getCellRenderer(h),M=x.createElement("td");M.setAttribute("ghost-table",1),E(this.hot,M,w,N,this.hot.colToProp(N),C.value,h),_.appendChild(M)})}),_}createColumnHeadersRow(){var{rootDocument:w}=this.hot,x=w.createDocumentFragment();if(this.hot.hasRowHeaders()){var _=w.createElement("th");this.hot.view.appendColHeader(-1,_),x.appendChild(_)}return this.samples.forEach(f=>{Object(c.arrayEach)(f.strings,S=>{var C=S.col,N=w.createElement("th");this.hot.view.appendColHeader(C,N),x.appendChild(N)})}),x}createCol(w){var{rootDocument:x}=this.hot,_=x.createDocumentFragment();return this.samples.forEach(f=>{Object(c.arrayEach)(f.strings,S=>{var C=S.row,N=this.hot.getCellMeta(C,w);N.col=w,N.row=C;var h=this.hot.getCellRenderer(N),E=x.createElement("td"),M=x.createElement("tr");E.setAttribute("ghost-table",1),h(this.hot,E,C,w,this.hot.colToProp(w),S.value,N),M.appendChild(E),_.appendChild(M)})}),_}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((w||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(w){var x=this.hot.rootDocument.createElement("col");return x.style.width="".concat(this.hot.view.wt.columnUtils.getStretchedColumnWidth(w),"px"),x}createTable(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",{rootDocument:x}=this.hot,_=x.createDocumentFragment(),f=x.createElement("table"),S=x.createElement("thead"),C=x.createElement("tbody"),N=x.createElement("colgroup"),h=x.createElement("tr"),E=x.createElement("th");return this.isVertical()&&f.appendChild(N),this.isHorizontal()&&(h.appendChild(E),S.appendChild(h),f.style.tableLayout="auto",f.style.width="auto"),f.appendChild(S),this.isVertical()&&C.appendChild(h),Object(R.addClass)(C,"afterEmptyThead"),f.appendChild(C),Object(R.addClass)(f,w),_.appendChild(f),{fragment:_,table:f,tHead:S,tBody:C,colGroup:N,tr:h,th:E}}createContainer(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",{rootDocument:x}=this.hot,_=x.createDocumentFragment(),f=x.createElement("div"),S="htGhostTable htAutoSize ".concat(w.trim());return Object(R.addClass)(f,S),_.appendChild(f),{fragment:_,container:f}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}}},function(De,d,o){"use strict";o.d(d,"b",function(){return c}),o.d(d,"a",function(){return X}),o.d(d,"c",function(){return w}),o.d(d,"d",function(){return x});var R=0,c=()=>{(R+=1)===1&&delete document.body.dataset.embedsLoaded},X=()=>{(R=Math.max(R-1,0))===0&&setTimeout(()=>{document.body.dataset.embedsLoaded=""},0)},w=()=>{R=0,c()},x=()=>{X()}},function(De,d,o){"use strict";o.d(d,"a",function(){return G}),o.d(d,"b",function(){return M});var R=o(33);function c(W,P,Q){return[...W.slice(0,P),...Q,...W.slice(P)]}function X(W,P){return Object(R.arrayFilter)(W,Q=>P.includes(Q)===!1)}var w=o(44),x=o(32),_=o(61),f=o(62);class S{constructor(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=P}getValues(){return this.indexedValues}getValueAtIndex(P){var Q=this.getValues();if(P<Q.length)return Q[P]}setValues(P){this.indexedValues=P.slice(),this.runLocalHooks("change")}setValueAtIndex(P,Q){return P<this.getLength()&&(this.indexedValues[P]=Q,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Object(_.isFunction)(this.initValueOrFn)?Object(w.rangeEach)(P-1,Q=>this.indexedValues.push(this.initValueOrFn(Q))):Object(w.rangeEach)(P-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(P){return this.setDefaultValues(P),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}}Object(x.mixin)(S,f.a);var C=S;function N(W,P,Q,O){var A=Q[0];return[...W.slice(0,A),...Q.map((Z,ee)=>Object(_.isFunction)(O)?O(Z,ee):O),...W.slice(A)]}function h(W,P){return Object(R.arrayFilter)(W,(Q,O)=>P.includes(O)===!1)}new Map([["indexesSequence",{getListWithInsertedItems:c,getListWithRemovedItems:X}],["physicallyIndexed",{getListWithInsertedItems:N,getListWithRemovedItems:h}]]);var E=class extends C{constructor(){super(W=>W)}insert(W,P){var Q=function(O,A,Z){var ee=Z[0],de=Z.length;return Object(R.arrayMap)(O,be=>be>=ee?be+de:be)}(this.indexedValues,0,P);this.indexedValues=c(Q,W,P),super.insert(W,P)}remove(W){var P=X(this.indexedValues,W);this.indexedValues=function(Q,O){return Object(R.arrayMap)(Q,A=>A-O.filter(Z=>Z<A).length)}(P,W),super.remove(W)}},M=class extends C{insert(W,P){this.indexedValues=N(this.indexedValues,0,P,this.initValueOrFn),super.insert(W,P)}remove(W){this.indexedValues=h(this.indexedValues,W),super.remove(W)}},y=class extends M{constructor(){super(arguments.length>0&&arguments[0]!==void 0&&arguments[0])}getTrimmedIndexes(){return Object(R.arrayReduce)(this.getValues(),(W,P,Q)=>(P&&W.push(Q),W),[])}},z=class extends M{constructor(){super(arguments.length>0&&arguments[0]!==void 0&&arguments[0])}getHiddenIndexes(){return Object(R.arrayReduce)(this.getValues(),(W,P,Q)=>(P&&W.push(Q),W),[])}},U=o(92),te=o(40);class D extends U.a{constructor(P,Q){super(),this.mergedValuesCache=[],this.aggregationFunction=P,this.fallbackValue=Q}getMergedValues(){if((!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var P=Object(R.arrayMap)(this.get(),de=>de.getValues()),Q=[],O=Object(te.isDefined)(P[0])&&P[0].length||0,A=0;A<O;A+=1){for(var Z=[],ee=0;ee<this.getLength();ee+=1)Z.push(P[ee][A]);Q.push(Z)}return Object(R.arrayMap)(Q,this.aggregationFunction)}getMergedValueAtIndex(P,Q){var O=this.getMergedValues(Q)[P];return Object(te.isDefined)(O)?O:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}var k=D;class T{constructor(){this.indexesSequence=new E,this.trimmingMapsCollection=new k(P=>P.some(Q=>Q===!0),!1),this.hidingMapsCollection=new k(P=>P.some(Q=>Q===!0),!1),this.variousMapsCollection=new U.a,this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",P=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",P,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",P=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",P,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",P=>{this.runLocalHooks("change",P,this.variousMapsCollection)})}executeBatchOperations(P){var Q=this.isBatched;this.isBatched=!0,P(),this.isBatched=Q,this.updateCache()}registerMap(P,Q){if(this.trimmingMapsCollection.get(P)||this.hidingMapsCollection.get(P)||this.variousMapsCollection.get(P))throw Error('Map with name "'.concat(P,'" has been already registered.'));Q instanceof y?this.trimmingMapsCollection.register(P,Q):Q instanceof z?this.hidingMapsCollection.register(P,Q):this.variousMapsCollection.register(P,Q);var O=this.getNumberOfIndexes();return O>0&&Q.init(O),Q}unregisterMap(P){this.trimmingMapsCollection.unregister(P),this.hidingMapsCollection.unregister(P),this.variousMapsCollection.unregister(P)}getPhysicalFromVisualIndex(P){var Q=this.notTrimmedIndexesCache[P];return Object(te.isDefined)(Q)?Q:null}getPhysicalFromRenderableIndex(P){var Q=this.renderablePhysicalIndexesCache[P];return Object(te.isDefined)(Q)?Q:null}getVisualFromPhysicalIndex(P){var Q=this.fromPhysicalToVisualIndexesCache.get(P);return Object(te.isDefined)(Q)?Q:null}getVisualFromRenderableIndex(P){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(P))}getRenderableFromVisualIndex(P){var Q=this.fromVisualToRenderableIndexesCache.get(P);return Object(te.isDefined)(Q)?Q:null}getFirstNotHiddenIndex(P,Q){var O=arguments.length>2&&arguments[2]!==void 0&&arguments[2],A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:P-Q,Z=this.getPhysicalFromVisualIndex(P);return Z===null?O===!0&&A!==P-Q?this.getFirstNotHiddenIndex(A,-Q,!1,A):null:this.isHidden(Z)===!1?P:this.getFirstNotHiddenIndex(P+Q,Q,O,A)}initToLength(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(P).keys()],this.notHiddenIndexesCache=[...new Array(P).keys()],this.executeBatchOperations(()=>{this.indexesSequence.init(P),this.trimmingMapsCollection.initEvery(P)}),this.executeBatchOperations(()=>{this.hidingMapsCollection.initEvery(P),this.variousMapsCollection.initEvery(P)}),this.runLocalHooks("init")}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(P){this.indexesSequence.setValues(P)}getNotTrimmedIndexes(){return(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])===!0?this.notTrimmedIndexesCache:Object(R.arrayFilter)(this.getIndexesSequence(),P=>this.isTrimmed(P)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])===!0?this.notHiddenIndexesCache:Object(R.arrayFilter)(this.getIndexesSequence(),P=>this.isHidden(P)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if((!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])===!0)return this.renderablePhysicalIndexesCache;var P=this.getNotTrimmedIndexes(),Q=this.getNotHiddenIndexes();return P.filter(O=>Q.includes(O))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(P,Q){typeof P=="number"&&(P=[P]);var O=Object(R.arrayMap)(P,Ne=>this.getPhysicalFromVisualIndex(Ne)),A=this.getNotTrimmedIndexesLength(),Z=P.length,ee=X(this.getIndexesSequence(),O),de=A-Z;if(Q+Z<A){var be=ee.filter(Ne=>this.isTrimmed(Ne)===!1)[Q];de=ee.indexOf(be)}this.setIndexesSequence(c(ee,de,O))}isTrimmed(P){return this.trimmingMapsCollection.getMergedValueAtIndex(P)}isHidden(P){return this.hidingMapsCollection.getMergedValueAtIndex(P)}insertIndexes(P,Q){var O=this.getNotTrimmedIndexes()[P],A=Object(te.isDefined)(O)?O:this.getNumberOfIndexes(),Z=this.getIndexesSequence().includes(O)?this.getIndexesSequence().indexOf(O):this.getNumberOfIndexes(),ee=Object(R.arrayMap)(new Array(Q).fill(A),(de,be)=>de+be);this.executeBatchOperations(()=>{this.indexesSequence.insert(Z,ee),this.trimmingMapsCollection.insertToEvery(Z,ee),this.hidingMapsCollection.insertToEvery(Z,ee),this.variousMapsCollection.insertToEvery(Z,ee)})}removeIndexes(P){this.executeBatchOperations(()=>{this.indexesSequence.remove(P),this.trimmingMapsCollection.removeFromEvery(P),this.hidingMapsCollection.removeFromEvery(P),this.variousMapsCollection.removeFromEvery(P)})}updateCache(){var P=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Q=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(P===!0||this.isBatched===!1&&Q===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.runLocalHooks("cacheUpdated",this.indexesSequenceChanged,this.trimmedIndexesChanged,this.hiddenIndexesChanged),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){var P=this.notTrimmedIndexesCache,Q=this.getIndexesSequence(),O=Q.length;this.fromPhysicalToVisualIndexesCache.clear();for(var A=0;A<O;A+=1){var Z=Q[A],ee=P.indexOf(Z);ee!==-1&&this.fromPhysicalToVisualIndexesCache.set(Z,ee)}}cacheFromVisualToRenderabIendexes(){var P=this.notTrimmedIndexesCache,Q=P.length,O=P.map(de=>this.isHidden(de));this.fromVisualToRenderableIndexesCache.clear();for(var A=0,Z=0;Z<Q;Z+=1)if(O[Z])A+=1;else{var ee=Z-A;this.fromVisualToRenderableIndexesCache.set(Z,ee)}}}Object(x.mixin)(T,f.a);var G=T},function(De,d,o){"use strict";o.d(d,"c",function(){return U}),o.d(d,"b",function(){return D}),o.d(d,"a",function(){return k});var R=o(1),c=o.n(R),X=()=>c.a.createElement("svg",{viewBox:"0 0 18 18"},c.a.createElement("defs",null,c.a.createElement("linearGradient",{id:"sv_svg__b",x1:"1",x2:"0",y2:"1",gradientUnits:"objectBoundingBox"},c.a.createElement("stop",{offset:"0",stopColor:"#0443c1"}),c.a.createElement("stop",{offset:"1",stopColor:"#c2c8f0"})),c.a.createElement("clipPath",{id:"sv_svg__a"}," ",c.a.createElement("path",{d:"M2 0h14a2 2 0 012 2v14a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2z",fill:"#0f9d58"}))),c.a.createElement("g",{clipPath:"url(#sv_svg__a)"},c.a.createElement("path",{transform:"rotate(90 9 9)",fill:"url(#sv_svg__b)",d:"M0 0h18v18H0z"}),c.a.createElement("path",{d:"M0 0l9-9 6 6-9 9z",fill:"#c2c8f0"}),c.a.createElement("path",{d:"M-9 9l9-9 6 6-9 9z",fill:"#98a5e6"}),c.a.createElement("path",{d:"M6 6l9-9 6 6-9 9z",fill:"#6c82dc"}),c.a.createElement("path",{d:"M-3 15l9-9 6 6-9 9z",fill:"#4767d4"}),c.a.createElement("path",{d:"M12 12l9-9 6 6-9 9z",fill:"#104acc"}),c.a.createElement("path",{d:"M3 21l9-9 6 6-9 9z",fill:"#0443c1"}))),w=o(77),x=()=>c.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24"},c.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),c.a.createElement("rect",{className:"svg-icon",width:14,height:2,rx:.099,transform:"translate(5 19)"}),c.a.createElement("path",{className:"svg-icon",d:"M8.124 12h2.777a.1.1 0 00.1-.1V3.1a.1.1 0 01.1-.1h1.8a.1.1 0 01.1.1v8.8a.1.1 0 00.1.1h2.778a.1.1 0 01.069.168l-3.876 3.866a.1.1 0 01-.139 0l-3.876-3.866A.1.1 0 018.124 12z"})),_=o(69),f=o(52),S=o(72),C=T=>{var{workbookLocation:G,fileName:W,mobile:P}=T,Q=Object(_.a)(G);if(!Object(S.a)())return null;var O=Q?"download-anchor":void 0,A=O&&P?"download-anchor-mobile":O;return c.a.createElement("button",{type:"button",className:"icon",id:"download-icon"},c.a.createElement("a",{href:Q,download:W,"data-cy":A},c.a.createElement(x,null),P&&c.a.createElement(f.a,{description:"Download"})),!P&&c.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},c.a.createElement("span",null,"Download")))},N=o(78),h=T=>c.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24"},T),c.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),c.a.createElement("path",{d:"M14.25 6.007a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007zm0 6.074a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007zm0 6.074a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007z",fill:"#fff"})),E=o(187),M=T=>{var{children:G}=T;return c.a.createElement(E.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{style:{maxHeight:192,width:200}},classes:{paper:"toolbar-mobile-menu-wrapper",list:"toolbar-mobile-menu-list"}},T),G)},y=T=>{var{children:G}=T,[W,P]=c.a.useState(void 0);return c.a.createElement("button",{type:"button",className:"icon icon-mobile","data-cy":"mobile-menu-icon"},c.a.createElement(h,{onClick:Q=>{P(Q.currentTarget)}}),c.a.createElement(M,{anchorEl:W,keepMounted:!0,open:Boolean(W),onClose:()=>{P(void 0)}},G))},z=o(17),U=T=>{var{children:G}=T;return c.a.createElement("div",{className:"toolbar"},G)},te=T=>{var{children:G,fileName:W}=T;return c.a.createElement("div",{className:"toolbar-left-pane"},c.a.createElement("div",{className:"icon",id:"sv-icon"},G),c.a.createElement("p",{className:"file-title"},W))},D=T=>{var{children:G}=T;return c.a.createElement("div",{className:"toolbar-right-pane"},c.a.createElement("div",{className:"icons-wrapper"},G))},k=T=>{var{fileName:G,workbookLocation:W,renderWorkbook:P,openModal:Q}=T,O=Object(z.b)();return c.a.createElement(U,null,c.a.createElement(te,{fileName:G},c.a.createElement(X,null)),c.a.createElement(D,null,O?c.a.createElement(y,null,c.a.createElement(N.a,{open:Q,mobile:!0}),c.a.createElement(w.a,{renderWorkbook:P,mobile:!0}),c.a.createElement(C,{workbookLocation:W,fileName:G,mobile:!0})):c.a.createElement(c.a.Fragment,null,c.a.createElement(w.a,{renderWorkbook:P}),c.a.createElement(C,{workbookLocation:W,fileName:G}),c.a.createElement(N.a,{open:Q}))))}},function(De,d,o){"use strict";o.d(d,"c",function(){return _}),o.d(d,"b",function(){return h}),o.d(d,"a",function(){return C});var R=o(53),c=o(34),X=function(E,M,y,z,U,te,D){var k=[],T=[];D.className&&Object(c.addClass)(M,D.className),D.readOnly&&k.push(D.readOnlyCellClassName),D.valid===!1&&D.invalidCellClassName?k.push(D.invalidCellClassName):T.push(D.invalidCellClassName),D.wordWrap===!1&&D.noWordWrapClassName&&k.push(D.noWordWrapClassName),!te&&D.placeholder&&k.push(D.placeholderCellClassName),Object(c.removeClass)(M,T),Object(c.addClass)(M,k)},w=o(40),x=function(E,M,y,z,U,te,D){h("base").apply(this,[E,M,y,z,U,te,D]);var k=te;if(!k&&D.placeholder&&(k=D.placeholder),k=Object(w.stringify)(k),E.getSettings().trimWhitespace||E.getSettings().wordWrap||(k=k.replace(/ /g,String.fromCharCode(160))),D.rendererTemplate){Object(c.empty)(M);var T=E.rootDocument.createElement("TEMPLATE");T.setAttribute("bind","{{}}"),T.innerHTML=D.rendererTemplate,HTMLTemplateElement.decorate(T),T.model=E.getSourceDataAtRow(y),M.appendChild(T)}else Object(c.fastInnerText)(M,k)},{register:_,getItem:f,hasItem:S,getNames:C,getValues:N}=Object(R.a)("renderers");function h(E){if(typeof E=="function")return E;if(!S(E))throw Error('No registered renderer found under "'.concat(E,'" name'));return f(E)}_("base",X),_("text",x)},,,,,,,,,,,,,,,,,,,,,function(De,d,o){"use strict";o.d(d,"d",function(){return c}),o.d(d,"c",function(){return X}),o.d(d,"a",function(){return w}),o.d(d,"b",function(){return x});var R=new WeakMap,c=Symbol("rootInstance");function X(_){R.set(_,!0)}function w(_){return _===c}function x(_){return R.has(_)}},function(De,d,o){"use strict";o.d(d,"a",function(){return f}),o.d(d,"c",function(){return S}),o.d(d,"b",function(){return C}),o.d(d,"d",function(){return N});var R=o(40),c=o(32),X=o(60),w=o(54),x=o(79);function _(){var h=function(E,M){return M||(M=E.slice(0)),Object.freeze(Object.defineProperties(E,{raw:{value:Object.freeze(M)}}))}(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`]);return _=function(){return h},h}function f(h,E){return Object(c.objectEach)(E,(M,y)=>{Object(R.isUndefined)(h[y])&&(h[y]=M)}),h}function S(h){var E=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(h);return E?"".concat(E[1].toLowerCase(),"-").concat(E[2].toUpperCase()):h}function C(h){var E=S(h);return Object(x.d)(E)||(E=x.a,N(h)),E}function N(h){Object(R.isDefined)(h)&&Object(X.a)(Object(w.a)(_(),h))}},function(De,d,o){"use strict";o.d(d,"a",function(){return S}),o.d(d,"b",function(){return _}),o.d(d,"c",function(){return f});var R=o(43),c=o(74),X=new R.a,w=new Set,x=0;function _(C){x===0&&(X.addEventListener(C,"keydown",N=>{w.has(N.keyCode)||w.add(N.keyCode)}),X.addEventListener(C,"keyup",N=>{w.has(N.keyCode)&&w.delete(N.keyCode)}),X.addEventListener(C,"visibilitychange",()=>{C.hidden&&w.clear()}),X.addEventListener(C.defaultView,"blur",()=>{w.clear()})),x+=1}function f(){x>0&&(x-=1),x===0&&(X.clearEvents(),w.clear(),x=0)}function S(){return Array.from(w.values()).some(C=>Object(c.isCtrlMetaKey)(C))}},function(De,d,o){var R,c,X,w;R=/^(\r\n|\n\r|\r|\n)/,c=/^[^\t\r\n]+/,X=/^\t/,w={parse(x){var _=[[""]];if(x.length===0)return _;for(var f,S=0,C=0;x.length>0&&f!==x.length;)if(f=x.length,x.match(X))x=x.replace(X,""),S+=1,_[C][S]="";else if(x.match(R))x=x.replace(R,""),S=0,_[C+=1]=[""];else{var N="";if(x.startsWith('"')){for(var h=0,E=!0;E;){var M=x.slice(0,1);M==='"'&&(h+=1),N+=M,((x=x.slice(1)).length===0||x.match(/^[\t\r\n]/)&&h%2==0)&&(E=!1)}N=N.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,z=>new Array(Math.floor(z.length/2)).fill('"').join(""))}else{var y=x.match(c);N=y?y[0]:"",x=x.slice(N.length)}_[C][S]=N}return _},stringify(x){var _,f,S,C,N,h="";for(_=0,f=x.length;_<f;_+=1){for(C=x[_].length,S=0;S<C;S+=1)S>0&&(h+="	"),typeof(N=x[_][S])=="string"?N.indexOf(`
`)>-1?h+='"'.concat(N.replace(/"/g,'""'),'"'):h+=N:h+=N==null?"":N;_!==f-1&&(h+=`
`)}return h}},d.parse=w.parse,d.stringify=w.stringify},,function(De,d,o){"use strict";o.d(d,"a",function(){return I}),o.d(d,"b",function(){return Ce}),o.d(d,"c",function(){return Oe});var R=o(53),c=o(38);class X extends c.c{constructor(){super(...arguments),this.visualCellRange=null}add(V){return this.visualCellRange===null?this.visualCellRange=new c.b(V):this.visualCellRange.expand(V),this}clear(){return this.visualCellRange=null,super.clear()}findVisibleCoordsInRange(V,q,B){var se=arguments.length>3&&arguments[3]!==void 0?arguments[3]:B,{row:ie,col:Ee}=V,{row:ye,col:_e}=q,{row:st,col:at}=this.settings.visualToRenderableCoords(V);return ye===ie&&st===null||_e===Ee&&at===null?null:st===null&&at===null?this.findVisibleCoordsInRange(new c.a(ie+B,Ee+se),q,B,se):st===null?this.findVisibleCoordsInRange(new c.a(ie+B,Ee),q,B,se):at===null?this.findVisibleCoordsInRange(new c.a(ie,Ee+se),q,B,se):V}commit(){if(this.visualCellRange===null)return this;var V=this.getRowSearchDirection(this.visualCellRange),q=this.getColumnSearchDirection(this.visualCellRange),B=this.findVisibleCoordsInRange(this.visualCellRange.from,this.visualCellRange.to,V,q),se=this.findVisibleCoordsInRange(this.visualCellRange.to,this.visualCellRange.from,-V,-q);if(B===null)return this.cellRange=null,this;var ie=this.settings.visualToRenderableCoords(B),Ee=this.settings.visualToRenderableCoords(se);return this.cellRange=new c.b(ie,ie,Ee),this}adjustCoordinates(V){if(this.cellRange===null&&V){var q=this.getRowSearchDirection(V),B=this.getColumnSearchDirection(V),se=this.findVisibleCoordsInRange(V.from,V.to,q,B);if(se!==null){var ie=this.settings.visualToRenderableCoords(se);return this.cellRange=new c.b(ie),V.setHighlight(se),this}}return V.setHighlight(V.from),this}getVisualCorners(){var V=this.settings.renderableToVisualCoords(this.cellRange.getTopLeftCorner()),q=this.settings.renderableToVisualCoords(this.cellRange.getBottomRightCorner());return[V.row,V.col,q.row,q.col]}getRowSearchDirection(V){return V.from.row<V.to.row?1:-1}getColumnSearchDirection(V){return V.from.col<V.to.col?1:-1}}var w=X,x=function(ge){var{visualToRenderableCoords:V,renderableToVisualCoords:q,activeHeaderClassName:B}=ge;return new w({visualToRenderableCoords:V,renderableToVisualCoords:q,highlightHeaderClassName:B})},_=function(ge){var{BorderStyle:V,visualToRenderableCoords:q,renderableToVisualCoords:B,layerLevel:se,areaCornerVisible:ie}=ge,Ee=new V;return Ee.cornerVisible=ie,new w({visualToRenderableCoords:q,renderableToVisualCoords:B,className:"area",markIntersections:!0,layerLevel:Math.min(se,7),border:Ee})},f=function(ge){var{BorderStyle:V,visualToRenderableCoords:q,renderableToVisualCoords:B,cellCornerVisible:se}=ge,ie=new V;return ie.cornerVisible=se,new w({visualToRenderableCoords:q,renderableToVisualCoords:B,className:"current",border:ie})};function S(ge,V){var q=Object.keys(ge);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(ge);V&&(B=B.filter(function(se){return Object.getOwnPropertyDescriptor(ge,se).enumerable})),q.push.apply(q,B)}return q}function C(ge,V,q){return V in ge?Object.defineProperty(ge,V,{value:q,enumerable:!0,configurable:!0,writable:!0}):ge[V]=q,ge}var N=function(ge){var{visualToRenderableCoords:V,renderableToVisualCoords:q,border:B,cellRange:se}=ge;return new w(function(ie){for(var Ee=1;Ee<arguments.length;Ee++){var ye=arguments[Ee]!=null?arguments[Ee]:{};Ee%2?S(Object(ye),!0).forEach(function(_e){C(ie,_e,ye[_e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ie,Object.getOwnPropertyDescriptors(ye)):S(Object(ye)).forEach(function(_e){Object.defineProperty(ie,_e,Object.getOwnPropertyDescriptor(ye,_e))})}return ie}({visualToRenderableCoords:V,renderableToVisualCoords:q},B),se)},h=function(ge){var{BorderStyle:V,visualToRenderableCoords:q,renderableToVisualCoords:B}=ge,se=new V;return new w({visualToRenderableCoords:q,renderableToVisualCoords:B,className:"fill",border:se})},E=function(ge){var{visualToRenderableCoords:V,renderableToVisualCoords:q,headerClassName:B,rowClassName:se,columnClassName:ie}=ge;return new w({visualToRenderableCoords:V,renderableToVisualCoords:q,className:"highlight",highlightHeaderClassName:B,highlightRowClassName:se,highlightColumnClassName:ie})},M=new Map,{register:y,getItem:z}=Object(R.a)("highlight/types");function U(ge,V,q){q&&M.set(ge,q),y(ge,V)}function te(ge,V){return z(ge)(V)}U("active-header",x),U("area",_,{width:1,color:"#4b89ff",strokeAlignment:"inside"}),U("cell",f,{width:2,color:"#4b89ff",strokeAlignment:"inside"}),U("custom-selection",N),U("fill",h,{width:1,color:"#ff0000",strokeAlignment:"inside"}),U("header",E);var D=o(33),k=o(32);function T(ge,V){var q=Object.keys(ge);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(ge);V&&(B=B.filter(function(se){return Object.getOwnPropertyDescriptor(ge,se).enumerable})),q.push.apply(q,B)}return q}function G(ge){for(var V=1;V<arguments.length;V++){var q=arguments[V]!=null?arguments[V]:{};V%2?T(Object(q),!0).forEach(function(B){W(ge,B,q[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ge,Object.getOwnPropertyDescriptors(q)):T(Object(q)).forEach(function(B){Object.defineProperty(ge,B,Object.getOwnPropertyDescriptor(q,B))})}return ge}function W(ge,V,q){return V in ge?Object.defineProperty(ge,V,{value:q,enumerable:!0,configurable:!0,writable:!0}):ge[V]=q,ge}var P=class{constructor(ge){this.options=ge,this.layerLevel=0,this.borderStyles=new Map([["cell",this._createBorderStyleClass("cell")],["fill",this._createBorderStyleClass("fill")],["area",this._createBorderStyleClass("area")]]),this.cell=te("cell",G({BorderStyle:this.borderStyles.get("cell")},ge)),this.fill=te("fill",G({BorderStyle:this.borderStyles.get("fill")},ge)),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=new Map}isEnabledFor(ge){var V=ge==="current"?"cell":ge,q=this.options.disableHighlight;return typeof q=="string"&&(q=[q]),q===!1||Array.isArray(q)&&!q.includes(V)}useLayerLevel(){var ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=ge,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){var ge,V=this.layerLevel;return this.areas.has(V)?ge=this.areas.get(V):(ge=te("area",G({BorderStyle:this.borderStyles.get("area"),layerLevel:V},this.options)),this.areas.set(V,ge)),ge}getAreas(){return[...this.areas.values()]}createOrGetHeader(){var ge,V=this.layerLevel;return this.headers.has(V)?ge=this.headers.get(V):(ge=te("header",G({},this.options)),this.headers.set(V,ge)),ge}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){var ge,V=this.layerLevel;return this.activeHeaders.has(V)?ge=this.activeHeaders.get(V):(ge=te("active-header",G({},this.options)),this.activeHeaders.set(V,ge)),ge}getCommonBorderStyle(ge){var V;return(V=this.borderStyles.get(ge))===null||V===void 0?void 0:V.prototype}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(ge,V){this.customSelections.set(ge,te("custom-selection",G(G({},this.options),V)))}clear(){this.cell.clear(),this.fill.clear(),Object(D.arrayEach)(this.areas.values(),ge=>{ge.clear()}),Object(D.arrayEach)(this.headers.values(),ge=>{ge.clear()}),Object(D.arrayEach)(this.activeHeaders.values(),ge=>{ge.clear()})}getAll(){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections.values()]}_createBorderStyleClass(ge){var V,q,B=function(se){return M.get(se)||{}}(ge);if(B)return V=B,q=class{},Object(k.extend)(q.prototype,V),class extends q{}}};class Q{constructor(){this.ranges=[]}isEmpty(){return this.size()===0}set(V){return this.clear(),this.ranges.push(new c.b(V)),this}add(V){return this.ranges.push(new c.b(V)),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(V){return this.ranges.some(q=>q.includes(V))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){var V,q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,B=this.size()+q-1;return B>=0&&(V=this.ranges[B]),V}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var O=Q,A=o(120),Z=o(40),ee=o(62);class de{constructor(V,q){this.range=V,this.options=q}transformStart(V,q,B){var se=new c.a(V,q),ie=this.range.current().highlight,{row:Ee,col:ye}=this.options.visualToRenderableCoords(ie),_e=ie,st=0,at=0;if(this.runLocalHooks("beforeTransformStart",se),Ee!==null&&ye!==null){var it=this.options.countRows(),Xe=this.options.countCols(),vt=this.options.fixedRowsBottom(),lt=this.options.minSpareRows(),yt=this.options.minSpareCols(),Rt=this.options.autoWrapRow(),Et=this.options.autoWrapCol();Ee+V>it-1?B&&lt>0&&!(vt&&Ee>=it-vt-1)?(this.runLocalHooks("insertRowRequire",it),it=this.options.countRows()):Et&&(se.row=1-it,se.col=ye+se.col===Xe-1?1-Xe:1):Et&&Ee+se.row<0&&ye+se.col>=0&&(se.row=it-1,se.col=ye+se.col===0?Xe-1:-1),ye+se.col>Xe-1?B&&yt>0?(this.runLocalHooks("insertColRequire",Xe),Xe=this.options.countCols()):Rt&&(se.row=Ee+se.row===it-1?1-it:1,se.col=1-Xe):Rt&&ye+se.col<0&&Ee+se.row>=0&&(se.row=Ee+se.row===0?it-1:-1,se.col=Xe-1);var rt=new c.a(Ee+se.row,ye+se.col);st=0,at=0,rt.row<0?(st=-1,rt.row=0):rt.row>0&&rt.row>=it&&(st=1,rt.row=it-1),rt.col<0?(at=-1,rt.col=0):rt.col>0&&rt.col>=Xe&&(at=1,rt.col=Xe-1),_e=this.options.renderableToVisualCoords(rt)}return this.runLocalHooks("afterTransformStart",_e,st,at),_e}transformEnd(V,q){var B=new c.a(V,q),se=this.range.current(),ie=se.to,Ee=0,ye=0;this.runLocalHooks("beforeTransformEnd",B);var{row:_e,col:st}=this.options.visualToRenderableCoords(se.highlight);if(_e!==null&&st!==null){var at=this.options.countRows(),it=this.options.countCols(),{row:Xe,col:vt}=this.options.visualToRenderableCoords(se.to),lt=new c.a(Xe+B.row,vt+B.col);Ee=0,ye=0,lt.row<0?(Ee=-1,lt.row=0):lt.row>0&&lt.row>=at&&(Ee=1,lt.row=at-1),lt.col<0?(ye=-1,lt.col=0):lt.col>0&&lt.col>=it&&(ye=1,lt.col=it-1),ie=this.options.renderableToVisualCoords(lt)}return this.runLocalHooks("afterTransformEnd",ie,Ee,ye),ie}}Object(k.mixin)(de,ee.a);var be=de,Ne=[3,2],Me=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],pe=Symbol("root"),Be=Symbol("child");function Ce(ge){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pe;if(V!==pe&&V!==Be)throw new Error("The second argument is used internally only and cannot be overwritten.");var q=Array.isArray(ge),B=V===pe,se=0;if(q){var ie=ge[0];if(ge.length===0)se=1;else if(B&&ie instanceof c.b)se=3;else if(B&&Array.isArray(ie))se=Ce(ie,Be);else if(ge.length>=2&&ge.length<=4){var Ee=!ge.some((ye,_e)=>!Me[_e].includes(typeof ye));Ee&&(se=2)}}return se}function Oe(ge){var{keepDirection:V=!1,propToCol:q}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ne.includes(ge))throw new Error("Unsupported selection ranges schema type was provided.");return function(B){var se=ge===3,ie=se?B.from.row:B[0],Ee=se?B.from.col:B[1],ye=se?B.to.row:B[2],_e=se?B.to.col:B[3];if(typeof q=="function"&&(typeof Ee=="string"&&(Ee=q(Ee)),typeof _e=="string"&&(_e=q(_e))),Object(Z.isUndefined)(ye)&&(ye=ie),Object(Z.isUndefined)(_e)&&(_e=Ee),!V){var st=ie,at=Ee,it=ye,Xe=_e;ie=Math.min(st,it),Ee=Math.min(at,Xe),ye=Math.max(st,it),_e=Math.max(at,Xe)}return[ie,Ee,ye,_e]}}function Ae(ge){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof ge=="number"&&ge>=0&&ge<V}var Ue=o(54);function ze(){var ge=function(V,q){return q||(q=V.slice(0)),Object.freeze(Object.defineProperties(V,{raw:{value:Object.freeze(q)}}))}([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) 
        or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]])\\x20
        or as an array of CellRange objects.`]);return ze=function(){return ge},ge}class Ge{constructor(V,q){var B=this;this.settings=V,this.tableProps=q,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new O,this.highlight=new P({headerClassName:V.currentHeaderClassName,activeHeaderClassName:V.activeHeaderClassName,rowClassName:V.currentRowClassName,columnClassName:V.currentColClassName,disableHighlight:V.disableVisualSelection,cellCornerVisible:function(){return B.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return B.isAreaCornerVisible(...arguments)},visualToRenderableCoords:se=>this.tableProps.visualToRenderableCoords(se),renderableToVisualCoords:se=>this.tableProps.renderableToVisualCoords(se)}),this.transformation=new be(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:se=>this.tableProps.visualToRenderableCoords(se),renderableToVisualCoords:se=>this.tableProps.renderableToVisualCoords(se),fixedRowsBottom:()=>V.fixedRowsBottom,minSpareRows:()=>V.minSpareRows,minSpareCols:()=>V.minSpareCols,autoWrapRow:()=>V.autoWrapRow,autoWrapCol:()=>V.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var se=arguments.length,ie=new Array(se),Ee=0;Ee<se;Ee++)ie[Ee]=arguments[Ee];return B.runLocalHooks("beforeModifyTransformStart",...ie)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var se=arguments.length,ie=new Array(se),Ee=0;Ee<se;Ee++)ie[Ee]=arguments[Ee];return B.runLocalHooks("afterModifyTransformStart",...ie)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var se=arguments.length,ie=new Array(se),Ee=0;Ee<se;Ee++)ie[Ee]=arguments[Ee];return B.runLocalHooks("beforeModifyTransformEnd",...ie)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var se=arguments.length,ie=new Array(se),Ee=0;Ee<se;Ee++)ie[Ee]=arguments[Ee];return B.runLocalHooks("afterModifyTransformEnd",...ie)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var se=arguments.length,ie=new Array(se),Ee=0;Ee<se;Ee++)ie[Ee]=arguments[Ee];return B.runLocalHooks("insertRowRequire",...ie)}),this.transformation.addLocalHook("insertColRequire",function(){for(var se=arguments.length,ie=new Array(se),Ee=0;Ee<se;Ee++)ie[Ee]=arguments[Ee];return B.runLocalHooks("insertColRequire",...ie)})}updateBorderStyle(V){Object(D.arrayEach)(["cell","area","fill"],q=>{var B,se,ie=Object(k.isObject)(V[q])?V[q]:{};B=this.highlight.getCommonBorderStyle(q),(se=ie).borderWidth?B.width=se.borderWidth:B.hasOwnProperty("width")&&delete B.width,se.borderColor?B.color=se.borderColor:B.hasOwnProperty("color")&&delete B.color})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(V,q){var B=arguments.length>2&&arguments[2]!==void 0&&arguments[2],se=this.settings.selectionMode==="multiple",ie=Object(Z.isUndefined)(q)?Object(A.a)():q,Ee=V.row<0,ye=V.col<0,_e=Ee&&ye;Ee&&(V.row=0),ye&&(V.col=0),this.selectedByCorner=_e,this.runLocalHooks("beforeSetRangeStart".concat(B?"Only":""),V),(!se||se&&!ie&&Object(Z.isUndefined)(q))&&this.selectedRange.clear(),this.selectedRange.add(V),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!_e&&ye&&this.selectedByRowHeader.add(this.getLayerLevel()),!_e&&Ee&&this.selectedByColumnHeader.add(this.getLayerLevel()),B||this.setRangeEnd(V)}setRangeStartOnly(V,q){this.setRangeStart(V,q,!0)}setRangeEnd(V){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",V),this.begin();var q=this.selectedRange.current();if(this.settings.selectionMode!=="single"&&q.setTo(new c.a(V.row,V.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor("cell")){var B=this.tableProps.expandCoordsToRangeIncludingSpans(this.selectedRange.current().highlight);this.highlight.getCell().add(B.from).add(B.to).commit().adjustCoordinates(q)}var se=this.getLayerLevel();se<this.highlight.layerLevel&&(Object(D.arrayEach)(this.highlight.getAreas(),_e=>{_e.clear()}),Object(D.arrayEach)(this.highlight.getHeaders(),_e=>{_e.clear()}),Object(D.arrayEach)(this.highlight.getActiveHeaders(),_e=>{_e.clear()})),this.highlight.useLayerLevel(se);var ie=this.highlight.createOrGetArea(),Ee=this.highlight.createOrGetHeader(),ye=this.highlight.createOrGetActiveHeader();ie.clear(),Ee.clear(),ye.clear(),this.highlight.isEnabledFor("area")&&(this.isMultiple()||se>=1)&&(ie.add(q.from).add(q.to).commit(),se===1&&(this.highlight.useLayerLevel(se-1).createOrGetArea().add(this.selectedRange.previous().from).commit(),this.highlight.useLayerLevel(se))),this.highlight.isEnabledFor("header")&&(this.settings.selectionMode==="single"?Ee.add(q.highlight).commit():Ee.add(q.from).add(q.to).commit()),this.isSelectedByRowHeader()&&this.tableProps.countCols()===q.getWidth()&&ye.add(new c.a(q.from.row,-1)).add(new c.a(q.to.row,-1)).commit(),this.isSelectedByColumnHeader()&&this.tableProps.countRows()===q.getHeight()&&ye.add(new c.a(-1,q.from.col)).add(new c.a(-1,q.to.col)).commit(),this.runLocalHooks("afterSetRangeEnd",V)}}isMultiple(){var V=Object(k.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",V),V.value}transformStart(V,q,B){var se=this.transformation.transformStart(V,q,B);this.getSelectedRange().current().highlight!==se&&this.setRangeStart(se)}transformEnd(V,q){this.setRangeEnd(this.transformation.transformEnd(V,q))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return V===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(V)}isSelectedByColumnHeader(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return V===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(V)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)}isSelectedByCorner(){return this.selectedByCorner}inInSelection(V){return this.selectedRange.includes(V)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(V){return(!Number.isInteger(V)||V===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var V=this.tableProps.countRows(),q=this.tableProps.countCols();V!==0&&q!==0&&(this.clear(),this.setRangeStartOnly(new c.a(-1,-1)),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new c.a(V-1,q-1)),this.finish())}selectCells(V){var q=Ce(V);if(q===1)return!1;if(q===0)throw new Error(Object(Ue.a)(ze()));var B=Oe(q,{propToCol:ye=>this.tableProps.propToCol(ye),keepDirection:!0}),se=this.tableProps.countRows(),ie=this.tableProps.countCols(),Ee=!V.some(ye=>{var[_e,st,at,it]=B(ye);return!(Ae(_e,se)&&Ae(st,ie)&&Ae(at,se)&&Ae(it,ie))});return Ee&&(this.clear(),Object(D.arrayEach)(V,ye=>{var[_e,st,at,it]=B(ye);this.setRangeStartOnly(new c.a(_e,st),!1),this.setRangeEnd(new c.a(at,it)),this.finish()})),Ee}selectColumns(V){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:V,B=typeof V=="string"?this.tableProps.propToCol(V):V,se=typeof q=="string"?this.tableProps.propToCol(q):q,ie=this.tableProps.countCols(),Ee=this.tableProps.countRows(),ye=Ee>0&&Ae(B,ie)&&Ae(se,ie);return ye&&(this.setRangeStartOnly(new c.a(-1,B)),this.setRangeEnd(new c.a(Ee-1,se)),this.finish()),ye}selectRows(V){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:V,B=this.tableProps.countRows(),se=this.tableProps.countCols(),ie=Ae(V,B)&&Ae(q,B);return ie&&(this.setRangeStartOnly(new c.a(V,-1)),this.setRangeEnd(new c.a(q,se>0?se-1:0)),this.finish()),ie}refresh(){if(this.isSelected()){var V=this.highlight.getCell(),q=this.getLayerLevel();V.commit().adjustCoordinates(this.selectedRange.current());for(var B=0;B<this.selectedRange.size();B+=1){this.highlight.useLayerLevel(B);var se=this.highlight.createOrGetArea(),ie=this.highlight.createOrGetHeader(),Ee=this.highlight.createOrGetActiveHeader();se.commit(),ie.commit(),Ee.commit()}this.highlight.useLayerLevel(q)}}}Object(k.mixin)(Ge,ee.a);var I=Ge;o(91)},function(De,d,o){"use strict";o.d(d,"a",function(){return N}),o.d(d,"b",function(){return P}),o.d(d,"c",function(){return U});var R=o(121),c=o.n(R),X=o(75),w=o(32),x=o(33),_=o(44),f=o(40),S=Object(X.cellMethodLookupFactory)("copyable",!1);class C{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(O,A,Z){this.instance=O,this.tableMeta=Z,this.dataSource=A,this.duckSchema=this.dataSource&&this.dataSource[0]?Object(w.duckSchema)(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){var O=this.getSchema();if(O===void 0)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var A,Z=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,Z){var ee=0,de=0,be=!1;if(typeof Z=="function"){var Ne=Object(w.deepObjectSize)(O);ee=Ne>0?Ne:this.countFirstRowKeys(),be=!0}else{var Me=this.tableMeta.maxCols;ee=Math.min(Me,Z.length)}for(A=0;A<ee;A++){var pe=be?Z(A):Z[A];if(Object(w.isObject)(pe)){if(pe.data!==void 0){var Be=be?de:A;this.colToPropCache[Be]=pe.data,this.propToColCache.set(pe.data,Be)}de+=1}}}else this.recursiveDuckColumns(O)}countFirstRowKeys(){return Object(X.countFirstRowKeys)(this.dataSource)}recursiveDuckColumns(O,A,Z){var ee,de=A,be=Z;return de===void 0&&(de=0,be=""),typeof O!="object"||Array.isArray(O)||Object(w.objectEach)(O,(Ne,Me)=>{Ne===null?(ee=be+Me,this.colToPropCache.push(ee),this.propToColCache.set(ee,de),de+=1):de=this.recursiveDuckColumns(Ne,de,"".concat(Me,"."))}),de}colToProp(O){if(Number.isInteger(O)===!1)return O;var A=this.instance.toPhysicalColumn(O);return A===null?O:this.colToPropCache&&Object(f.isDefined)(this.colToPropCache[A])?this.colToPropCache[A]:A}propToCol(O){var A=this.propToColCache.get(O);if(Object(f.isDefined)(A))return this.instance.toVisualColumn(A);var Z=this.instance.toVisualColumn(O);return Z===null?O:Z}getSchema(){var O=this.tableMeta.dataSchema;return O?typeof O=="function"?O():O:this.duckSchema}createRow(O){var A=this,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,ee=arguments.length>2?arguments[2]:void 0,de=this.instance.countSourceRows(),be=de,Ne=0,Me=O;if((typeof Me!="number"||Me>=de)&&(Me=de),Me<this.instance.countRows()&&(be=this.instance.toPhysicalRow(Me)),this.instance.runHooks("beforeCreateRow",Me,Z,ee)===!1||be===null)return 0;for(var pe=this.tableMeta.maxRows,Be=this.instance.countCols(),Ce=[],Oe=function(){var Ae=null;A.instance.dataType==="array"?A.tableMeta.dataSchema?Ae=Object(w.deepClone)(A.getSchema()):(Ae=[],Object(_.rangeEach)(Be-1,()=>Ae.push(null))):A.instance.dataType==="function"?Ae=A.tableMeta.dataSchema(Me):(Ae={},Object(w.deepExtend)(Ae,A.getSchema())),Ce.push(Ae),Ne+=1};Ne<Z&&de+Ne<pe;)Oe();return this.instance.rowIndexMapper.insertIndexes(Me,Ne),this.spliceData(be,0,...Ce),this.instance.runHooks("afterCreateRow",Me,Ne,ee),this.instance.forceFullRender=!0,Ne}createCol(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Z=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var ee=this.dataSource,de=this.tableMeta.maxCols,be=O;if((typeof be!="number"||be>=this.instance.countSourceCols())&&(be=this.instance.countSourceCols()),this.instance.runHooks("beforeCreateCol",be,A,Z)===!1)return 0;var Ne=this.instance.countSourceCols();be<this.instance.countCols()&&(Ne=this.instance.toPhysicalColumn(be));for(var Me=this.instance.countSourceRows(),pe=this.instance.countCols(),Be=0,Ce=Ne;Be<A&&pe<de;){if(typeof be!="number"||be>=pe)if(Me>0)for(var Oe=0;Oe<Me;Oe+=1)ee[Oe]===void 0&&(ee[Oe]=[]),ee[Oe].push(null);else ee.push([null]);else for(var Ae=0;Ae<Me;Ae++)ee[Ae].splice(Ce,0,null);Be+=1,Ce+=1,pe+=1}return this.instance.columnIndexMapper.insertIndexes(be,Be),this.instance.runHooks("afterCreateCol",be,Be,Z),this.instance.forceFullRender=!0,Be}removeRow(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Z=arguments.length>2?arguments[2]:void 0,ee=typeof O!="number"?-A:O,de=this.instance.runHooks("modifyRemovedAmount",A,ee),be=this.instance.countSourceRows();ee=(be+ee)%be;var Ne=this.visualRowsToPhysical(ee,de);if(this.instance.runHooks("beforeRemoveRow",ee,de,Ne,Z)===!1)return!1;var Me=this.dataSource,pe=this.filterData(ee,de);if(pe&&(Me.length=0,Array.prototype.push.apply(Me,pe)),ee<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(Ne);var Be=Object(f.isDefined)(this.tableMeta.columns)||Object(f.isDefined)(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&Be===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",ee,de,Ne,Z),this.instance.forceFullRender=!0,!0}removeCol(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Z=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var ee=typeof O!="number"?-A:O;ee=(this.instance.countCols()+ee)%this.instance.countCols();var de=this.visualColumnsToPhysical(ee,A),be=de.slice(0).sort((Ge,I)=>I-Ge);if(this.instance.runHooks("beforeRemoveCol",ee,A,de,Z)===!1)return!1;for(var Ne=!0,Me=be.length,pe=this.dataSource,Be=0;Be<Me;Be++)Ne&&de[0]!==de[Be]-Be&&(Ne=!1);if(Ne)for(var Ce=0,Oe=this.instance.countSourceRows();Ce<Oe;Ce++)pe[Ce].splice(de[0],A);else for(var Ae=0,Ue=this.instance.countSourceRows();Ae<Ue;Ae++)for(var ze=0;ze<Me;ze++)pe[Ae].splice(be[ze],1);return ee<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(de),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",ee,A,de,Z),this.instance.forceFullRender=!0,!0}spliceCol(O,A,Z){for(var ee=this.instance.getDataAtCol(O),de=ee.slice(A,A+Z),be=ee.slice(A+Z),Ne=arguments.length,Me=new Array(Ne>3?Ne-3:0),pe=3;pe<Ne;pe++)Me[pe-3]=arguments[pe];Object(x.extendArray)(Me,be);for(var Be=0;Be<Z;)Me.push(null),Be+=1;return Object(x.to2dArray)(Me),this.instance.populateFromArray(A,O,Me,null,null,"spliceCol"),de}spliceRow(O,A,Z){for(var ee=this.instance.getSourceDataAtRow(O),de=ee.slice(A,A+Z),be=ee.slice(A+Z),Ne=arguments.length,Me=new Array(Ne>3?Ne-3:0),pe=3;pe<Ne;pe++)Me[pe-3]=arguments[pe];Object(x.extendArray)(Me,be);for(var Be=0;Be<Z;)Me.push(null),Be+=1;return this.instance.populateFromArray(O,A,[Me],null,null,"spliceRow"),de}spliceData(O,A){for(var Z=arguments.length,ee=new Array(Z>2?Z-2:0),de=2;de<Z;de++)ee[de-2]=arguments[de];this.instance.runHooks("beforeDataSplice",O,A,ee)!==!1&&this.dataSource.splice(O,A,...ee)}filterData(O,A){var Z=this.visualRowsToPhysical(O,A);if(this.instance.runHooks("beforeDataFilter",O,A,Z)!==!1)return this.dataSource.filter((ee,de)=>Z.indexOf(de)===-1)}get(O,A){var Z=this.instance.toPhysicalRow(O),ee=this.dataSource[Z],de=this.instance.runHooks("modifyRowData",Z),be=null;if((ee=isNaN(de)?de:ee)&&ee.hasOwnProperty&&Object(w.hasOwnProperty)(ee,A))be=ee[A];else if(typeof A=="string"&&A.indexOf(".")>-1){var Ne=A.split("."),Me=ee;if(!Me)return null;for(var pe=0,Be=Ne.length;pe<Be;pe++)if((Me=Me[Ne[pe]])===void 0)return null;be=Me}else typeof A=="function"&&(be=A(this.dataSource.slice(Z,Z+1)[0]));if(this.instance.hasHook("modifyData")){var Ce=Object(w.createObjectPropListener)(be);this.instance.runHooks("modifyData",Z,this.propToCol(A),Ce,"get"),Ce.isTouched()&&(be=Ce.value)}return be}getCopyable(O,A){return S.call(this.instance,O,this.propToCol(A))?this.get(O,A):""}set(O,A,Z){var ee=this.instance.toPhysicalRow(O),de=Z,be=this.dataSource[ee],Ne=this.instance.runHooks("modifyRowData",ee);if(be=isNaN(Ne)?Ne:be,this.instance.hasHook("modifyData")){var Me=Object(w.createObjectPropListener)(de);this.instance.runHooks("modifyData",ee,this.propToCol(A),Me,"set"),Me.isTouched()&&(de=Me.value)}if(be&&be.hasOwnProperty&&Object(w.hasOwnProperty)(be,A))be[A]=de;else if(typeof A=="string"&&A.indexOf(".")>-1){var pe,Be=A.split("."),Ce=be,Oe=0;for(Oe=0,pe=Be.length-1;Oe<pe;Oe++)Ce[Be[Oe]]===void 0&&(Ce[Be[Oe]]={}),Ce=Ce[Be[Oe]];Ce[Be[Oe]]=de}else typeof A=="function"?A(this.dataSource.slice(ee,ee+1)[0],de):be[A]=de}visualRowsToPhysical(O,A){for(var Z,ee=this.instance.countSourceRows(),de=[],be=(ee+O)%ee,Ne=A;be<ee&&Ne;)Z=this.instance.toPhysicalRow(be),de.push(Z),Ne-=1,be+=1;return de}visualColumnsToPhysical(O,A){for(var Z=this.instance.countCols(),ee=[],de=(Z+O)%Z,be=A;de<Z&&be;){var Ne=this.instance.toPhysicalColumn(de);ee.push(Ne),be-=1,de+=1}return ee}clear(){for(var O=0;O<this.instance.countSourceRows();O++)for(var A=0;A<this.instance.countCols();A++)this.set(O,this.colToProp(A),"")}getLength(){var O,A=this.tableMeta.maxRows;O=A<0||A===0?0:A||1/0;var Z=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(Z,O)}getAll(){var O={row:0,col:0},A={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return O.row-A.row!=0||this.instance.countSourceRows()?this.getRange(O,A,C.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(O,A,Z){var ee,de,be,Ne=[],Me=this.tableMeta.maxRows,pe=this.tableMeta.maxCols;if(Me===0||pe===0)return[];var Be=Z===C.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,Ce=Math.min(Math.max(Me-1,0),Math.max(O.row,A.row)),Oe=Math.min(Math.max(pe-1,0),Math.max(O.col,A.col));for(ee=Math.min(O.row,A.row);ee<=Ce;ee++){be=[];var Ae=ee>=0?this.instance.toPhysicalRow(ee):ee;for(de=Math.min(O.col,A.col);de<=Oe&&Ae!==null;de++)be.push(Be.call(this,ee,this.colToProp(de)));Ae!==null&&Ne.push(be)}return Ne}getText(O,A){return c.a.stringify(this.getRange(O,A,C.DESTINATION_RENDERER))}getCopyableText(O,A){return c.a.stringify(this.getRange(O,A,C.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var N=C,h=o(89);function E(Q,O){var A=typeof Q=="string"?Object(h.a)(Q):Q;if(Object(w.isObject)(A)){var Z=Object(w.isObject)(O),ee={};return Object(w.objectEach)(A,(de,be)=>{(!Z||Z&&!Object(w.hasOwnProperty)(O,be))&&(ee[be]=de)}),ee}}function M(Q){return Number.isInteger(Q)&&Q>=0}function y(Q,O){if(!Q())throw new Error("Assertion failed: ".concat(O))}function z(Q){return Q==null}var U=()=>({licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow(Q){var O,A,Z,ee;for(O=0,A=this.countCols();O<A;O++)if((Z=this.getDataAtCell(Q,O))!==""&&Z!==null&&Object(f.isDefined)(Z))return typeof Z=="object"&&(ee=this.getCellMeta(Q,O),Object(w.isObjectEqual)(this.getSchema()[ee.prop],Z));return!0},isEmptyCol(Q){var O,A,Z;for(O=0,A=this.countRows();O<A;O++)if((Z=this.getDataAtCell(O,Q))!==""&&Z!==null&&Object(f.isDefined)(Z))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,skipRowOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,preventWheel:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0,selectionStyle:void 0});class te{constructor(){this.metaCtor=class{},this.meta=this.metaCtor.prototype,Object(w.extend)(this.meta,U())}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(O){Object(w.extend)(this.meta,O),Object(w.extend)(this.meta,E(O.type,O))}}class D{constructor(O){var A=O.getMetaConstructor();this.meta=new A}getMeta(){return this.meta}updateMeta(O){Object(w.extend)(this.meta,O),Object(w.extend)(this.meta,E(O.type,O))}}class k{constructor(O){this.valueFactory=O,this.data=[],this.index=[],this.holes=new Set}obtain(O){y(()=>M(O),"Expecting an unsigned number.");var A,Z=this._getStorageIndexByKey(O);if(Z>=0)(A=this.data[Z])===void 0&&(A=this.valueFactory(O),this.data[Z]=A);else if(A=this.valueFactory(O),this.holes.size>0){var ee=this.holes.values().next().value;this.holes.delete(ee),this.data[ee]=A,this.index[O]=ee}else this.data.push(A),this.index[O]=this.data.length-1;return A}insert(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;y(()=>M(O)||z(O),"Expecting an unsigned number or null/undefined argument.");for(var Z=[],ee=this.data.length,de=0;de<A;de++)Z.push(ee+de),this.data.push(void 0);this.index.splice(z(O)?this.index.length:O,0,...Z)}remove(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;y(()=>M(O)||z(O),"Expecting an unsigned number or null/undefined argument.");for(var Z=this.index.splice(z(O)?this.index.length-A:O,A),ee=0;ee<Z.length;ee++){var de=Z[ee];typeof de=="number"&&this.holes.add(de)}}size(){return this.data.length-this.holes.size}values(){return Object(x.arrayFilter)(this.data,(O,A)=>!this.holes.has(A))[Symbol.iterator]()}entries(){for(var O=[],A=0;A<this.data.length;A++){var Z=this._getKeyByStorageIndex(A);Z!==-1&&O.push([Z,this.data[A]])}var ee=0;return{next:()=>{if(ee<O.length){var de=O[ee];return ee+=1,{value:de,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(O){return this.index.length>O?this.index[O]:-1}_getKeyByStorageIndex(O){return this.index.indexOf(O)}[Symbol.iterator](){return this.entries()}}var T=["data","width"];class G{constructor(O){this.globalMeta=O,this.metas=new k(()=>this._createMeta())}updateMeta(O,A){var Z=this.getMeta(O);Object(w.extend)(Z,A),Object(w.extend)(Z,E(A.type,Z))}createColumn(O,A){this.metas.insert(O,A)}removeColumn(O,A){this.metas.remove(O,A)}getMeta(O){return this.metas.obtain(O)}getMetaConstructor(O){return this.metas.obtain(O).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];class Z extends O{}for(var ee=0;ee<A.length;ee++)Z.prototype[A[ee]]=void 0;return Z}(this.globalMeta.getMetaConstructor(),T).prototype}}class W{constructor(O){this.columnMeta=O,this.metas=new k(()=>this._createRow())}updateMeta(O,A,Z){var ee=this.getMeta(O,A);Object(w.extend)(ee,Z),Object(w.extend)(ee,E(Z.type,ee))}createRow(O,A){this.metas.insert(O,A)}createColumn(O,A){for(var Z=0;Z<this.metas.size();Z++)this.metas.obtain(Z).insert(O,A)}removeRow(O,A){this.metas.remove(O,A)}removeColumn(O,A){for(var Z=0;Z<this.metas.size();Z++)this.metas.obtain(Z).remove(O,A)}getMeta(O,A,Z){var ee=this.metas.obtain(O).obtain(A);return Z===void 0?ee:ee[Z]}setMeta(O,A,Z,ee){this.metas.obtain(O).obtain(A)[Z]=ee}removeMeta(O,A,Z){delete this.metas.obtain(O).obtain(A)[Z]}getMetas(){for(var O=[],A=Array.from(this.metas.values()),Z=0;Z<A.length;Z++)O.push(...A[Z].values());return O}getMetasAtRow(O){y(()=>M(O),"Expecting an unsigned number.");var A=new Map(this.metas);return A.has(O)?Array.from(A.get(O).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new k(O=>this._createMeta(O))}_createMeta(O){return new(this.columnMeta.getMetaConstructor(O))}}class P{constructor(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.globalMeta=new te,this.globalMeta.updateMeta(O),this.tableMeta=new D(this.globalMeta),this.columnMeta=new G(this.globalMeta),this.cellMeta=new W(this.columnMeta)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(O){this.globalMeta.updateMeta(O)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(O){this.tableMeta.updateMeta(O)}getColumnMeta(O){return this.columnMeta.getMeta(O)}updateColumnMeta(O,A){this.columnMeta.updateMeta(O,A)}getCellMeta(O,A,Z){return this.cellMeta.getMeta(O,A,Z)}setCellMeta(O,A,Z,ee){this.cellMeta.setMeta(O,A,Z,ee)}updateCellMeta(O,A,Z){this.cellMeta.updateMeta(O,A,Z)}removeCellMeta(O,A,Z){this.cellMeta.removeMeta(O,A,Z)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(O){return this.cellMeta.getMetasAtRow(O)}createRow(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(O,A)}removeRow(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(O,A)}createColumn(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(O,A),this.columnMeta.createColumn(O,A)}removeColumn(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(O,A),this.columnMeta.removeColumn(O,A)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}},,,function(De,d,o){"use strict";o.d(d,"a",function(){return f});var R=o(33),c=o(79),X=o(53),{register:w,getValues:x}=Object(X.a)("phraseFormatters");w("pluralize",function(S,C){return Array.isArray(S)&&Number.isInteger(C)?S[C]:S});var _=o(40);function f(S,C,N){var h=Object(c.b)(S);if(h===null)return null;var E=h[C];if(Object(_.isUndefined)(E))return null;var M=function(y,z){var U=y;return Object(R.arrayEach)(function(){return x()}(),te=>{U=te(y,z)}),U}(E,N);return Array.isArray(M)?M[0]:M}},function(De,d,o){"use strict";o.d(d,"a",function(){return X});var R=o(1),c=o.n(R),X=()=>c.a.createElement("div",{className:"sv-chart-image-wrapper"},c.a.createElement("div",{className:"sv-chart-image-placeholder"},c.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{fill:"#f5f5f5",d:`M11.094,13.019h7.735c0.057,0,0.105,0.049,0.104,0.106c-0.068,4.946-5.015,
          7.789-9.648,6.554c-2.773-0.739-4.59-2.882-5.139-5.665c-0.433-2.197,0.142-4.497,1.572-6.223c1.379-1.665,
          2.977-2.684,5.142-2.723c0.057-0.001,0.106,0.047,0.106,0.104l0.028,7.748C10.994,12.975,11.039,13.019,
          11.094,13.019z`}),c.a.createElement("path",{fill:"#f5f5f5",d:`M13.009,10.878V3.294c0-0.057,0.048-0.105,0.105-0.104C17.163,3.247,21,6.917,21,
          10.978c0,0.002,0,0.004,0,0.006l-7.891-0.006C13.054,10.978,13.009,10.934,13.009,10.878z`}))))},,,,,,,,,function(De,d,o){},function(De,d,o){},function(De,d,o){},function(De,d,o){},,function(De,d,o){"use strict";(function(R,c){o.d(d,"a",function(){return Me});var X=o(34),w=o(61),x=o(40),_=o(46),f=o(151),S=o(43),C=o(32),N=o(33),h=o(90),E=o(47),M=o(97),y=o(88),z=o(49),U=o(44),te=o(144),D=o(145),k=o(75),T=o(95),G=o(118),W=o(38),P=o(59),Q=o(127),O=o(79),A=o(119),Z=o(120),ee=o(123),de=o(124),be=o(146),Ne=null;function Me(pe,Be){var Ce,Oe,Ae,Ue,ze=arguments.length>2&&arguments[2]!==void 0&&arguments[2],Ge=!1,I=this,ge=new S.a(I),V=!0;Be.language=Object(A.b)(Be.language);var q=new de.b(Be),B=q.getTableMeta(),se=q.getGlobalMeta();Object(G.a)(ze)&&Object(G.c)(this),this.rootElement=pe,this.rootDocument=pe.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Object(Z.b)(this.rootDocument),this.isDestroyed=!1,this.container=this.rootDocument.createElement("div"),this.renderCall=!1,pe.insertBefore(this.container,pe.firstChild),Object(G.b)(this)&&Object(x._injectProductInfo)(Be.licenseKey,pe),this.guid="ht_".concat(Object(z.randomString)()),this.columnIndexMapper=new T.a,this.rowIndexMapper=new T.a,Oe=new D.a(I),this.rootElement.id&&this.rootElement.id.substring(0,3)!=="ht_"||(this.rootElement.id=this.guid);var ie=g=>{var{row:v,col:F}=g;return new W.a(v>=0?I.rowIndexMapper.getRenderableFromVisualIndex(v):v,F>=0?I.columnIndexMapper.getRenderableFromVisualIndex(F):F)},Ee=g=>{var{row:v,col:F}=g;return new W.a(v>=0?I.rowIndexMapper.getVisualFromRenderableIndex(v):v,F>=0?I.columnIndexMapper.getVisualFromRenderableIndex(F):F)},ye=new ee.a(B,{countCols:()=>I.countCols(),countRows:()=>I.countRows(),propToCol:g=>Ce.propToCol(g),isEditorOpened:()=>!!I.getActiveEditor()&&I.getActiveEditor().isOpened(),countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),visualToRenderableCoords:ie,renderableToVisualCoords:Ee,expandCoordsToRangeIncludingSpans:g=>Object(be.a)(I,g)});this.selection=ye;var _e=(g,v,F)=>{F&&this.selection.refresh()};function st(g){var v=Object(A.c)(g);Object(O.d)(v)?(I.runHooks("beforeLanguageChange",v),se.language=v,I.runHooks("afterLanguageChange",v)):Object(A.d)(g)}function at(g,v){var F=g==="className"?I.rootElement:I.table;if(V)Object(X.addClass)(F,v);else{var re=[],le=[];se[g]&&(re=Array.isArray(se[g])?se[g]:Object(N.stringToArray)(se[g])),v&&(le=Array.isArray(v)?v:Object(N.stringToArray)(v));var fe=Object(N.getDifferenceOfArrays)(re,le),Se=Object(N.getDifferenceOfArrays)(le,re);fe.length&&Object(X.removeClass)(F,fe),Se.length&&Object(X.addClass)(F,Se)}se[g]=v}function it(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function Xe(g){var v=g.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):g}function vt(g,v,F){if(g.length){var re=I.getActiveEditor(),le=I.runHooks("beforeChange",g,v||"edit"),fe=!0;if(le!==!1){var Se,ve=new it;ve.onQueueEmpty=a=>{re&&fe&&re.cancelChanges(),F(a)};for(var He=g.length-1;He>=0;He--)if(g[He]===null)g.splice(He,1);else{var[Re,L,,l]=g[He],t=Ce.propToCol(L),i=I.getCellMeta(Re,t);i.type==="numeric"&&typeof l=="string"&&(Se=l).length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(Se)&&(g[He][3]=Xe(l)),I.getCellValidator(i)&&(ve.addValidatorToQueue(),I.validateCell(g[He][3],i,function(a,m){return function(b){if(typeof b!="boolean")throw new Error("Validation error: result is not boolean");if(b===!1&&m.allowInvalid===!1){fe=!1,g.splice(a,1),m.valid=!0;var H=I.getCell(m.visualRow,m.visualCol);H!==null&&Object(X.removeClass)(H,B.invalidCellClassName)}ve.removeValidatorFormQueue()}}(He,i),v))}ve.checkIfQueueIsEmpty()}else re&&re.cancelChanges()}}function lt(g,v){var F=g.length-1;if(!(F<0)){for(;F>=0;F--){var re=!1;if(g[F]!==null){if(g[F][2]!==null&&g[F][2]!==void 0||g[F][3]!==null&&g[F][3]!==void 0){if(B.allowInsertRow)for(;g[F][0]>I.countRows()-1;){var le=Ce.createRow(void 0,void 0,v);if(!(le>=1)){re=!0;break}q.createRow(null,le)}if(I.dataType==="array"&&(!B.columns||B.columns.length===0)&&B.allowInsertColumn)for(;Ce.propToCol(g[F][1])>I.countCols()-1;){var fe=Ce.createCol(void 0,void 0,v);if(!(fe>=1)){re=!0;break}q.createColumn(null,fe)}re||Ce.set(g[F][0],g[F][1],g[F][3])}}else g.splice(F,1)}I.forceFullRender=!0,Ae.adjustRowsAndCols(),I.runHooks("beforeChangeRender",g,v),Ue.lockEditor(),I._refreshBorders(null),Ue.unlockEditor(),I.view.wt.wtOverlays.adjustElementsSizes(),I.runHooks("afterChange",g,v||"edit");var Se=I.getActiveEditor();Se&&Object(x.isDefined)(Se.refreshValue)&&Se.refreshValue()}}function yt(g,v,F){return typeof g=="object"?g:[[g,v,F]]}this.columnIndexMapper.addLocalHook("cacheUpdated",_e),this.rowIndexMapper.addLocalHook("cacheUpdated",_e),this.selection.addLocalHook("beforeSetRangeStart",g=>{this.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",g=>{this.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",g=>{this.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=this.view.wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=this.view.wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",g=>{var v=Object(C.createObjectPropListener)(!1),F=this.selection.getSelectedRange(),{from:re,to:le}=F.current(),fe=F.size()-1;this.runHooks("afterSelection",re.row,re.col,le.row,le.col,v,fe),this.runHooks("afterSelectionByProp",re.row,I.colToProp(re.col),le.row,I.colToProp(le.col),v,fe);var Se=this.selection.isSelectedByAnyHeader(),ve=this.selection.selectedRange.current(),He=!0;Ge&&(He=!1),v.isTouched()&&(He=!v.value);var Re=this.selection.isSelectedByRowHeader(),L=this.selection.isSelectedByColumnHeader();He!==!1&&(Se?Re?this.view.scrollViewportVertically(I.rowIndexMapper.getRenderableFromVisualIndex(g.row)):L&&this.view.scrollViewportHorizontally(I.columnIndexMapper.getRenderableFromVisualIndex(g.col)):ve&&!this.selection.isMultiple()?this.view.scrollViewport(ie(ve.from)):this.view.scrollViewport(ie(g))),Re&&L?Object(X.addClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Re?(Object(X.removeClass)(this.rootElement,"ht__selection--columns"),Object(X.addClass)(this.rootElement,"ht__selection--rows")):L?(Object(X.removeClass)(this.rootElement,"ht__selection--rows"),Object(X.addClass)(this.rootElement,"ht__selection--columns")):Object(X.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",g=>{var v=g.length-1,{from:F,to:re}=g[v];this.runHooks("afterSelectionEnd",F.row,F.col,re.row,re.col,v),this.runHooks("afterSelectionEndByProp",F.row,I.colToProp(F.col),re.row,I.colToProp(re.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{var v=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=v)}),this.selection.addLocalHook("beforeModifyTransformStart",g=>{this.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",(g,v,F)=>{this.runHooks("afterModifyTransformStart",g,v,F)}),this.selection.addLocalHook("beforeModifyTransformEnd",g=>{this.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",(g,v,F)=>{this.runHooks("afterModifyTransformEnd",g,v,F)}),this.selection.addLocalHook("afterDeselect",()=>{Ue.destroyEditor(),this._refreshBorders(),Object(X.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",g=>{this.alter("insert_row",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",g=>{this.alter("insert_col",g,1,"auto")}),Ae={alter(g,v){var F,re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,le=arguments.length>3?arguments[3]:void 0,fe=arguments.length>4?arguments[4]:void 0,Se=Ke=>{if(Ke.length===0)return[];var $e=[...Ke];return $e.sort((et,ae)=>{var[Y]=et,[oe]=ae;return Y===oe?0:Y>oe?1:-1}),Object(N.arrayReduce)($e,(et,ae)=>{var[Y,oe]=ae,ce=et[et.length-1],[we,xe]=ce,Le=we+xe;if(Y<=Le){var ke=Math.max(oe-(Le-Y),0);ce[1]+=ke}else et.push([Y,oe]);return et},[$e[0]])};switch(g){case"insert_row":var ve=I.countSourceRows();if(B.maxRows===ve)return;if(v=Object(x.isDefined)(v)?v:ve,F=Ce.createRow(v,re,le)){q.createRow(I.toPhysicalRow(v),re);var He=ye.selectedRange.current(),Re=He==null?void 0:He.from,L=Re==null?void 0:Re.row;if(Object(x.isDefined)(L)&&L>=v){var{row:l,col:t}=He.to,i=Re.col;ye.isSelectedByRowHeader()&&(i=-1),ye.setRangeStartOnly(new W.a(L+F,i)),ye.setRangeEnd(new W.a(l+F,t))}else I._refreshBorders()}break;case"insert_col":if(F=Ce.createCol(v,re,le)){if(q.createColumn(I.toPhysicalColumn(v),re),Array.isArray(B.colHeaders)){var a=[v,0];a.length+=F,Array.prototype.splice.apply(B.colHeaders,a)}var m=ye.selectedRange.current(),b=m==null?void 0:m.from,H=b==null?void 0:b.col;if(Object(x.isDefined)(H)&&H>=v){var{row:$,col:me}=m.to,Te=b.row;ye.isSelectedByColumnHeader()&&(Te=-1),ye.setRangeStartOnly(new W.a(Te,H+F)),ye.setRangeEnd(new W.a($,me+F))}else I._refreshBorders()}break;case"remove_row":var Ie=Ke=>{var $e=0;Object(N.arrayEach)(Ke,et=>{var[ae,Y]=et,oe=Object(x.isEmpty)(ae)?I.countRows()-1:Math.max(ae-$e,0);if(Number.isInteger(ae)&&(ae=Math.max(ae-$e,0)),Ce.removeRow(ae,Y,le)){q.removeRow(I.toPhysicalRow(oe),Y);var ce=I.countRows(),we=B.fixedRowsTop;we>=oe+1&&(B.fixedRowsTop-=Math.min(Y,we-oe));var xe=B.fixedRowsBottom;xe&&oe>=ce-xe&&(B.fixedRowsBottom-=Math.min(Y,xe)),$e+=Y}})};Array.isArray(v)?Ie(Se(v)):Ie([[v,re]]),Ae.adjustRowsAndCols(),I._refreshBorders();break;case"remove_col":var Fe=Ke=>{var $e=0;Object(N.arrayEach)(Ke,et=>{var[ae,Y]=et,oe=Object(x.isEmpty)(ae)?I.countCols()-1:Math.max(ae-$e,0),ce=I.toPhysicalColumn(oe);if(Number.isInteger(ae)&&(ae=Math.max(ae-$e,0)),Ce.removeCol(ae,Y,le)){q.removeColumn(ce,Y);var we=B.fixedColumnsLeft;we>=oe+1&&(B.fixedColumnsLeft-=Math.min(Y,we-oe)),Array.isArray(B.colHeaders)&&(ce===void 0&&(ce=-1),B.colHeaders.splice(ce,Y)),$e+=Y}})};Array.isArray(v)?Fe(Se(v)):Fe([[v,re]]),Ae.adjustRowsAndCols(),I._refreshBorders();break;default:throw new Error('There is no such action "'.concat(g,'"'))}fe||Ae.adjustRowsAndCols()},adjustRowsAndCols(){if(B.minRows){var g=I.countRows();if(g<B.minRows)for(var v=0,F=B.minRows;v<F-g;v++)Ce.createRow(I.countRows(),1,"auto")}if(B.minSpareRows){var re=I.countEmptyRows(!0);if(re<B.minSpareRows)for(;re<B.minSpareRows&&I.countSourceRows()<B.maxRows;re++)Ce.createRow(I.countRows(),1,"auto")}var le;if((B.minCols||B.minSpareCols)&&(le=I.countEmptyCols(!0)),B.minCols&&!B.columns&&I.countCols()<B.minCols)for(;I.countCols()<B.minCols;le++)Ce.createCol(I.countCols(),1,"auto");if(B.minSpareCols&&!B.columns&&I.dataType==="array"&&le<B.minSpareCols)for(;le<B.minSpareCols&&I.countCols()<B.maxCols;le++)Ce.createCol(I.countCols(),1,"auto");var fe=I.countRows(),Se=I.countCols();fe!==0&&Se!==0||ye.deselect(),ye.isSelected()&&Object(N.arrayEach)(ye.selectedRange,ve=>{var He=!1,Re=ve.from.row,L=ve.from.col,l=ve.to.row,t=ve.to.col;Re>fe-1?(He=!0,l>(Re=fe-1)&&(l=Re)):l>fe-1&&(He=!0,Re>(l=fe-1)&&(Re=l)),L>Se-1?(He=!0,t>(L=Se-1)&&(t=L)):t>Se-1&&(He=!0,L>(t=Se-1)&&(L=t)),He&&I.selectCell(Re,L,l,t)}),I.view&&I.view.wt.wtOverlays.adjustElementsSizes()},populateFromArray(g,v,F,re,le,fe,Se){var ve,He,Re,L,l,t,i,a,m=[],b={};if((He=v.length)===0)return!1;switch(le){case"shift_down":for(l=F?F.col-g.col+1:0,t=F?F.row-g.row+1:0,Re=0,L=(v=Object(k.translateRowsToColumns)(v)).length,i=Math.max(L,l);Re<i;Re++)if(Re<L){for(ve=0,He=v[Re].length;ve<t-He;ve++)v[Re].push(v[Re][ve%He]);v[Re].unshift(g.col+Re,g.row,0),I.spliceCol(...v[Re])}else v[Re%L][0]=g.col+Re,I.spliceCol(...v[Re%L]);break;case"shift_right":for(l=F?F.col-g.col+1:0,t=F?F.row-g.row+1:0,ve=0,He=v.length,a=Math.max(He,t);ve<a;ve++)if(ve<He){for(Re=0,L=v[ve].length;Re<l-L;Re++)v[ve].push(v[ve][Re%L]);v[ve].unshift(g.row+ve,g.col,0),I.spliceRow(...v[ve])}else v[ve%He][0]=g.row+ve,I.spliceRow(...v[ve%He]);break;case"overwrite":default:b.row=g.row,b.col=g.col;var H,$={row:F&&g?F.row-g.row+1:1,col:F&&g?F.col-g.col+1:1},me=0,Te=0,Ie=!0,Fe=function(Ye){var ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ct=v[Ye%v.length];return ot!==null?ct[ot%ct.length]:ct},Ke=v.length,$e=F?F.row-g.row+1:0;for(He=F?$e:Math.max(Ke,$e),ve=0;ve<He&&!(F&&b.row>F.row&&$e>Ke||!B.allowInsertRow&&b.row>I.countRows()-1||b.row>=B.maxRows);ve++){var et=ve-me,ae=Fe(et).length,Y=F?F.col-g.col+1:0;if(L=F?Y:Math.max(ae,Y),b.col=g.col,H=I.getCellMeta(b.row,b.col),re!=="CopyPaste.paste"&&re!=="Autofill.fill"||!H.skipRowOnPaste){for(Te=0,Re=0;Re<L&&!(F&&b.col>F.col&&Y>ae||!B.allowInsertColumn&&b.col>I.countCols()-1||b.col>=B.maxCols);Re++)if(H=I.getCellMeta(b.row,b.col),re!=="CopyPaste.paste"&&re!=="Autofill.fill"||!H.skipColumnOnPaste)if(H.readOnly)b.col+=1;else{var oe=Re-Te,ce=Fe(et,oe),we=I.getDataAtCell(b.row,b.col),xe={row:et,col:oe};if(re==="Autofill.fill"){var Le=I.runHooks("beforeAutofillInsidePopulate",xe,fe,v,Se,{},$);Le&&(ce=Object(x.isUndefined)(Le.value)?ce:Le.value)}if(ce!==null&&typeof ce=="object")if(Array.isArray(ce)&&we===null&&(we=[]),we===null||typeof we!="object")Ie=!1;else{var ke=Object(C.duckSchema)(Array.isArray(we)?we:we[0]||we),Ve=Object(C.duckSchema)(Array.isArray(ce)?ce:ce[0]||ce);Object(C.isObjectEqual)(ke,Ve)?ce=Object(C.deepClone)(ce):Ie=!1}else we!==null&&typeof we=="object"&&(Ie=!1);Ie&&m.push([b.row,b.col,ce]),Ie=!0,b.col+=1}else Te+=1,b.col+=1,L+=1;b.row+=1}else me+=1,b.row+=1,He+=1}I.setDataAtCell(m,null,null,re||"populateFromArray")}}},this.executeBatchOperations=function(g){this.columnIndexMapper.executeBatchOperations(()=>{this.rowIndexMapper.executeBatchOperations(()=>{g()})})},this.init=function(){Oe.setData(B.data),I.runHooks("beforeInit"),Object(_.isMobileBrowser)()&&Object(X.addClass)(I.rootElement,"mobile"),this.updateSettings(B,!0),this.view=new te.a(this),Ue=f.a.getInstance(I,B,ye),I.runHooks("init"),this.forceFullRender=!0,this.view.render(),typeof V=="object"&&(I.runHooks("afterChange",V[0],V[1]),V=!1),I.runHooks("afterInit")},this.validateCell=function(g,v,F,re){var le,fe=I.getCellValidator(v);function Se(ve){var He=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(He&&v.hidden!==!0){var Re=v.visualCol,L=v.visualRow,l=I.getCell(L,Re,!0);l&&l.nodeName!=="TH"&&I.view.wt.wtSettings.settings.cellRenderer(L,Re,l),F(ve)}else F(ve)}Object(x.isRegExp)(fe)&&(le=fe,fe=function(ve,He){He(le.test(ve))}),Object(w.isFunction)(fe)?(g=I.runHooks("beforeValidate",g,v.visualRow,v.prop,re),I._registerImmediate(()=>{fe.call(v,g,ve=>{I&&(ve=I.runHooks("afterValidate",ve,g,v.visualRow,v.prop,re),v.valid=ve,Se(ve),I.runHooks("postAfterValidate",ve,g,v.visualRow,v.prop,re))})})):I._registerImmediate(()=>{v.valid=!0,Se(v.valid,!1)})},this.setDataAtCell=function(g,v,F,re){var le,fe,Se,ve=yt(g,v,F),He=[],Re=re;for(le=0,fe=ve.length;le<fe;le++){if(typeof ve[le]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof ve[le][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Se=ve[le][1]>=this.countCols()?ve[le][1]:Ce.colToProp(ve[le][1]),He.push([ve[le][0],Se,Oe.getAtCell(this.toPhysicalRow(ve[le][0]),ve[le][1]),ve[le][2]])}Re||typeof g!="object"||(Re=v),I.runHooks("afterSetDataAtCell",He,Re),vt(He,Re,()=>{lt(He,Re)})},this.setDataAtRowProp=function(g,v,F,re){var le,fe,Se=yt(g,v,F),ve=[],He=re;for(le=0,fe=Se.length;le<fe;le++)ve.push([Se[le][0],Se[le][1],Oe.getAtCell(this.toPhysicalRow(Se[le][0]),Se[le][1]),Se[le][2]]);He||typeof g!="object"||(He=v),I.runHooks("afterSetDataAtRowProp",ve,He),vt(ve,He,()=>{lt(ve,He)})},this.listen=function(){I&&!I.isListening()&&(Ne=I.guid,I.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Ne=null,I.runHooks("afterUnlisten"))},this.isListening=function(){return Ne===I.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0&&arguments[0],v=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];I._refreshBorders(g,v)},this.populateFromArray=function(g,v,F,re,le,fe,Se,ve,He){if(typeof F!="object"||typeof F[0]!="object")throw new Error("populateFromArray parameter `input` must be an array of arrays");var Re=typeof re=="number"?new W.a(re,le):null;return Ae.populateFromArray(new W.a(g,v),F,Re,fe,Se,ve,He)},this.spliceCol=function(g,v,F){for(var re=arguments.length,le=new Array(re>3?re-3:0),fe=3;fe<re;fe++)le[fe-3]=arguments[fe];return Ce.spliceCol(g,v,F,...le)},this.spliceRow=function(g,v,F){for(var re=arguments.length,le=new Array(re>3?re-3:0),fe=3;fe<re;fe++)le[fe-3]=arguments[fe];return Ce.spliceRow(g,v,F,...le)},this.getSelected=function(){if(ye.isSelected())return Object(N.arrayMap)(ye.getSelectedRange(),g=>{var{from:v,to:F}=g;return[v.row,v.col,F.row,F.col]})},this.getSelectedLast=function(){var g,v=this.getSelected();return v&&v.length>0&&(g=v[v.length-1]),g},this.getSelectedRange=function(){if(ye.isSelected())return Array.from(ye.getSelectedRange())},this.getSelectedRangeLast=function(){var g,v=this.getSelectedRange();return v&&v.length>0&&(g=v[v.length-1]),g},this.emptySelectedCells=function(g){if(ye.isSelected()){var v=[];Object(N.arrayEach)(ye.getSelectedRange(),F=>{var re=F.getTopLeftCorner(),le=F.getBottomRightCorner();Object(U.rangeEach)(re.row,le.row,fe=>{Object(U.rangeEach)(re.col,le.col,Se=>{this.getCellMeta(fe,Se).readOnly||v.push([fe,Se,null])})})}),v.length>0&&this.setDataAtCell(v,g)}},this.render=function(){I.view&&(I.renderCall=!0,I.forceFullRender=!0,Ue.lockEditor(),I._refreshBorders(null),Ue.unlockEditor())},this.refreshDimensions=function(){if(I.view){var{width:g,height:v}=I.view.getLastSize(),{width:F,height:re}=Object(X.getBoundingClientRect)(I.rootElement),le=F!==g||re!==v;I.runHooks("beforeRefreshDimensions",{width:g,height:v},{width:F,height:re},le)===!1||((le||I.view.wt.wtOverlays.scrollableElement===I.rootWindow)&&(I.view.setLastSize(F,re),I.render()),I.runHooks("afterRefreshDimensions",{width:g,height:v},{width:F,height:re},le))}},this.loadData=function(g){if(Array.isArray(B.dataSchema)?I.dataType="array":Object(w.isFunction)(B.dataSchema)?I.dataType="function":I.dataType="object",Ce&&Ce.destroy(),Ce=new de.a(I,g,B),typeof g=="object"&&g!==null)g.push&&g.splice||(g=[g]);else{if(g!==null)throw new Error("loadData only accepts array of objects or array of arrays (".concat(typeof g," given)"));var v,F=Ce.getSchema();g=[];var re,le=0;for(le=0,re=B.startRows;le<re;le++)if(I.dataType!=="object"&&I.dataType!=="function"||!B.dataSchema)if(I.dataType==="array")v=Object(C.deepClone)(F[0]),g.push(v);else{v=[];for(var fe=0,Se=B.startCols;fe<Se;fe++)v.push(null);g.push(v)}else v=Object(C.deepClone)(F),g.push(v)}Array.isArray(g[0])&&(I.dataType="array"),B.data=g,I.runHooks("beforeLoadData",g,V),Ce.dataSource=g,Oe.data=g,Oe.dataType=I.dataType,Oe.colToProp=Ce.colToProp.bind(Ce),Oe.propToCol=Ce.propToCol.bind(Ce),Oe.countCachedColumns=Ce.countCachedColumns.bind(Ce),q.clearCellsCache(),I.initIndexMappers(),Ae.adjustRowsAndCols(),I.runHooks("afterLoadData",g,V),V?V=[null,"loadData"]:(I.runHooks("afterChange",null,"loadData"),I.render())},this.initIndexMappers=function(){var g=B.columns,v=0;if(Array.isArray(g))v=g.length;else if(Object(w.isFunction)(g))if(I.dataType==="array")for(var F=this.countSourceCols(),re=0;re<F;re+=1)g(re)&&(v+=1);else I.dataType!=="object"&&I.dataType!=="function"||(v=Ce.colToPropCache.length);else if(Object(x.isDefined)(B.dataSchema)){var le=Ce.getSchema();v=Array.isArray(le)?le.length:Object(C.deepObjectSize)(le)}else v=this.countSourceCols();this.columnIndexMapper.initToLength(v),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,v,F,re){return Object(x.isUndefined)(g)?Ce.getAll():Ce.getRange(new W.a(g,v),new W.a(F,re),Ce.DESTINATION_RENDERER)},this.getCopyableText=function(g,v,F,re){return Ce.getCopyableText(new W.a(g,v),new W.a(F,re))},this.getCopyableData=function(g,v){return Ce.getCopyable(g,Ce.colToProp(v))},this.getSchema=function(){return Ce.getSchema()},this.updateSettings=function(g){var v,F,re=arguments.length>1&&arguments[1]!==void 0&&arguments[1],le=!1;if(Object(x.isDefined)(g.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(Object(x.isDefined)(g.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(v in g)v!=="data"&&(v!=="language"?v==="className"?at("className",g.className):v==="tableClassName"&&I.table?(at("tableClassName",g.tableClassName),I.view.wt.wtOverlays.syncOverlayTableClassNames()):P.a.getSingleton().isRegistered(v)||P.a.getSingleton().isDeprecated(v)?(Object(w.isFunction)(g[v])||Array.isArray(g[v]))&&(g[v].initialHook=!0,I.addHook(v,g[v])):!re&&Object(C.hasOwnProperty)(g,v)&&(se[v]=g[v]):st(g.language));g.data===void 0&&B.data===void 0?I.loadData(null):g.data!==void 0?I.loadData(g.data):g.columns!==void 0&&(Ce.createMap(),I.initIndexMappers());var fe=I.countCols(),Se=B.columns;if(Se&&Object(w.isFunction)(Se)&&(le=!0),g.cell===void 0&&g.cells===void 0&&g.columns===void 0||q.clearCache(),fe>0)for(v=0,F=0;v<fe;v++){if(Se){var ve=le?Se(v):Se[F];ve&&q.updateColumnMeta(F,ve)}F+=1}Object(x.isDefined)(g.cell)&&Object(C.objectEach)(g.cell,i=>{I.setCellMetaObject(i.row,i.col,i)}),I.runHooks("afterCellMetaReset");var He=I.rootElement.style.height;He!==""&&(He=parseInt(I.rootElement.style.height,10));var Re=g.height;if(Object(w.isFunction)(Re)&&(Re=Re()),re){var L=I.rootElement.getAttribute("style");L&&I.rootElement.setAttribute("data-initialstyle",I.rootElement.getAttribute("style"))}if(Re===null){var l=I.rootElement.getAttribute("data-initialstyle");l&&(l.indexOf("height")>-1||l.indexOf("overflow")>-1)?I.rootElement.setAttribute("style",l):(I.rootElement.style.height="",I.rootElement.style.overflow="")}else Re!==void 0&&(I.rootElement.style.height=isNaN(Re)?"".concat(Re):"".concat(Re,"px"),I.rootElement.style.overflow="hidden");if(g.width!==void 0){var t=g.width;Object(w.isFunction)(t)&&(t=t()),I.rootElement.style.width=isNaN(t)?"".concat(t):"".concat(t,"px")}if(g.selectionStyle!==void 0){if(!Object(C.isObject)(g.selectionStyle))throw new Error("The value of the option `selectionStyle` must be an object. To reset `selectionStyle` to the defaults, provide an empty object as the value.");this.selection.updateBorderStyle(g.selectionStyle)}re||(I.view&&I.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),I.runHooks("afterUpdateSettings",g)),Ae.adjustRowsAndCols(),I.view&&!V&&(I.forceFullRender=!0,Ue.lockEditor(),I._refreshBorders(null),Ue.unlockEditor()),re||!I.view||He!==""&&Re!==""&&Re!==void 0||He===Re||I.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=I.getSelectedLast();if(B.getValue){if(Object(w.isFunction)(B.getValue))return B.getValue.call(I);if(g)return I.getData()[g[0][0]][B.getValue]}else if(g)return I.getDataAtCell(g[0],g[1])},this.getSettings=function(){return B},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,v,F,re,le){Ae.alter(g,v,F,re,le)},this.getCell=function(g,v){var F=arguments.length>2&&arguments[2]!==void 0&&arguments[2],re=v,le=g;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;re=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;le=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return le===null||re===null?null:I.view.getCellAtCoords(new W.a(le,re),F)},this.getCoords=function(g){var v=this.view.wt.wtTable.getCoords(g);if(v===null)return null;var{row:F,col:re}=v,le=F,fe=re;return F>=0&&(le=this.rowIndexMapper.getVisualFromRenderableIndex(F)),re>=0&&(fe=this.columnIndexMapper.getVisualFromRenderableIndex(re)),new W.a(le,fe)},this.colToProp=function(g){return Ce.colToProp(g)},this.propToCol=function(g){return Ce.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,v){return Ce.get(g,Ce.colToProp(v))},this.getDataAtRowProp=function(g,v){return Ce.get(g,v)},this.getDataAtCol=function(g){return[].concat(...Ce.getRange(new W.a(0,g),new W.a(B.data.length-1,g),Ce.DESTINATION_RENDERER))},this.getDataAtProp=function(g){var v=Ce.getRange(new W.a(0,Ce.propToCol(g)),new W.a(B.data.length-1,Ce.propToCol(g)),Ce.DESTINATION_RENDERER);return[].concat(...v)},this.getSourceData=function(g,v,F,re){return g===void 0?Oe.getData():Oe.getByRange(new W.a(g,v),new W.a(F,re))},this.getSourceDataArray=function(g,v,F,re){return g===void 0?Oe.getData(!0):Oe.getByRange(new W.a(g,v),new W.a(F,re),!0)},this.getSourceDataAtCol=function(g){return Oe.getAtColumn(g)},this.setSourceDataAtCell=function(g,v,F,re){var le=yt(g,v,F),fe=[];le.forEach((Se,ve)=>{var[He,Re,L]=Se;fe.push([le[ve][0],le[ve][1],Oe.getAtCell(le[ve][0],le[ve][1]),le[ve][2]]),Oe.setAtCell(He,Re,L)}),this.runHooks("afterSetSourceDataAtCell",fe,re),this.render()},this.getSourceDataAtRow=function(g){return Oe.getAtRow(g)},this.getSourceDataAtCell=function(g,v){return Oe.getAtCell(g,v)},this.getDataAtRow=function(g){return Ce.getRange(new W.a(g,0),new W.a(g,this.countCols()-1),Ce.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,v,F,re){var le=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,v,F,re],[fe,Se]=le,[,,ve,He]=le,Re=null,L=null;ve===void 0&&(ve=fe),He===void 0&&(He=Se);var l="mixed";return Object(U.rangeEach)(Math.max(Math.min(fe,ve),0),Math.max(fe,ve),t=>{var i=!0;return Object(U.rangeEach)(Math.max(Math.min(Se,He),0),Math.max(Se,He),a=>{var m=this.getCellMeta(t,a);return L=m.type,Re?i=Re===L:Re=L,i}),l=i?L:"mixed",i}),l},this.removeCellMeta=function(g,v,F){var[re,le]=[this.toPhysicalRow(g),this.toPhysicalColumn(v)],fe=q.getCellMeta(re,le,F);I.runHooks("beforeRemoveCellMeta",g,v,F,fe)!==!1&&(q.removeCellMeta(re,le,F),I.runHooks("afterRemoveCellMeta",g,v,F,fe)),fe=null},this.spliceCellsMeta=function(g){for(var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=arguments.length,re=new Array(F>2?F-2:0),le=2;le<F;le++)re[le-2]=arguments[le];if(re.length>0&&!Array.isArray(re[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&q.removeRow(this.toPhysicalRow(g),v),re.length>0&&Object(N.arrayEach)(re.reverse(),fe=>{q.createRow(this.toPhysicalRow(g)),Object(N.arrayEach)(fe,(Se,ve)=>this.setCellMetaObject(g,ve,Se))})},this.setCellMetaObject=function(g,v,F){typeof F=="object"&&Object(C.objectEach)(F,(re,le)=>{this.setCellMeta(g,v,le,re)})},this.setCellMeta=function(g,v,F,re){if(I.runHooks("beforeSetCellMeta",g,v,F,re)!==!1){var le=g,fe=v;g<this.countRows()&&(le=this.toPhysicalRow(g)),v<this.countCols()&&(fe=this.toPhysicalColumn(v)),q.setCellMeta(le,fe,F,re),I.runHooks("afterSetCellMeta",g,v,F,re)}},this.getCellsMeta=function(){return q.getCellsMeta()},this.getCellMeta=function(g,v){var F=this.toPhysicalRow(g),re=this.toPhysicalColumn(v);F===null&&(F=g),re===null&&(re=v);var le=Ce.colToProp(v),fe=q.getCellMeta(F,re);if(fe.row=F,fe.col=re,fe.visualRow=g,fe.visualCol=v,fe.prop=le,fe.instance=I,I.runHooks("beforeGetCellMeta",g,v,fe),I.hasHook("beforeGetCellMeta")&&Object(C.hasOwnProperty)(fe,"type")&&q.updateCellMeta(F,re,{type:fe.type}),fe.cells){var Se=fe.cells(F,re,le);Se&&q.updateCellMeta(F,re,Se)}return I.runHooks("afterGetCellMeta",g,v,fe),fe},this.getCellMetaAtRow=function(g){return q.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(I.dataType==="object"||B.columns)};var Rt=Object(k.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(g,v){return Object(M.b)(Rt.call(this,g,v))},this.getCellEditor=Object(k.cellMethodLookupFactory)("editor");var Et=Object(k.cellMethodLookupFactory)("validator");this.getCellValidator=function(g,v){var F=Et.call(this,g,v);return typeof F=="string"&&(F=Object(y.b)(F)),F},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,v){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,g)},this.validateColumns=function(g,v){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,g)},this._validateCells=function(g,v,F){var re=new it;g&&(re.onQueueEmpty=g);for(var le=I.countRows()-1;le>=0;)if(v===void 0||v.indexOf(le)!==-1){for(var fe=I.countCols()-1;fe>=0;)(F===void 0||F.indexOf(fe)!==-1)&&(re.addValidatorToQueue(),I.validateCell(I.getDataAtCell(le,fe),I.getCellMeta(le,fe),Se=>{if(typeof Se!="boolean")throw new Error("Validation error: result is not boolean");Se===!1&&(re.valid=!1),re.removeValidatorFormQueue()},"validateCells")),fe-=1;le-=1}else le-=1;re.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var v=B.rowHeaders,F=g;return F!==void 0&&(F=I.runHooks("modifyRowHeader",F)),F===void 0?(v=[],Object(U.rangeEach)(I.countRows()-1,re=>{v.push(I.getRowHeader(re))})):Array.isArray(v)&&v[F]!==void 0?v=v[F]:Object(w.isFunction)(v)?v=v(F):v&&typeof v!="string"&&typeof v!="number"&&(v=F+1),v},this.hasRowHeaders=function(){return!!B.rowHeaders},this.hasColHeaders=function(){if(B.colHeaders!==void 0&&B.colHeaders!==null)return!!B.colHeaders;for(var g=0,v=I.countCols();g<v;g++)if(I.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var v=I.runHooks("modifyColHeader",g),F=B.colHeaders;if(v===void 0){for(var re=[],le=I.countCols(),fe=0;fe<le;fe++)re.push(I.getColHeader(fe));F=re}else{var Se=I.toPhysicalColumn(v),ve=function(He){for(var Re=[],L=I.countCols(),l=0;l<L;l++)Object(w.isFunction)(B.columns)&&B.columns(l)&&Re.push(l);return Re[He]}(Se);B.colHeaders===!1?F=null:B.columns&&Object(w.isFunction)(B.columns)&&B.columns(ve)&&B.columns(ve).title?F=B.columns(ve).title:B.columns&&B.columns[Se]&&B.columns[Se].title?F=B.columns[Se].title:Array.isArray(B.colHeaders)&&B.colHeaders[Se]!==void 0?F=B.colHeaders[Se]:Object(w.isFunction)(B.colHeaders)?F=B.colHeaders(Se):B.colHeaders&&typeof B.colHeaders!="string"&&typeof B.colHeaders!="number"&&(F=Object(k.spreadsheetColumnLabel)(v))}return F},this._getColWidthFromSettings=function(g){var v;if(g>=0&&(v=I.getCellMeta(0,g).width),v!==void 0&&v!==B.width||(v=B.colWidths),v!=null){switch(typeof v){case"object":v=v[g];break;case"function":v=v(g)}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(g){var v=I._getColWidthFromSettings(g);return(v=I.runHooks("modifyColWidth",v,g))===void 0&&(v=W.d.DEFAULT_WIDTH),v},this._getRowHeightFromSettings=function(g){var v=B.rowHeights;if(v!=null){switch(typeof v){case"object":v=v[g];break;case"function":v=v(g)}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getRowHeight=function(g){var v=I._getRowHeightFromSettings(g);return v=I.runHooks("modifyRowHeight",v,g)},this.countSourceRows=function(){return Oe.countRows()},this.countSourceCols=function(){return Oe.countFirstRowKeys()},this.countRows=function(){return Ce.getLength()},this.countCols=function(){var g=B.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,v)},this.countRenderedRows=function(){return I.view.wt.drawn?I.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return I.view.wt.drawn?I.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return I.view.wt.drawn?I.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return I.view.wt.drawn?I.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0&&arguments[0],v=0;return Object(U.rangeEachReverse)(I.countRows()-1,F=>{if(I.isEmptyRow(F))v+=1;else if(g===!0)return!1}),v},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(I.countRows()<1)return 0;var v=0;return Object(U.rangeEachReverse)(I.countCols()-1,F=>{if(I.isEmptyCol(F))v+=1;else if(g===!0)return!1}),v},this.isEmptyRow=function(g){return B.isEmptyRow.call(I,g)},this.isEmptyCol=function(g){return B.isEmptyCol.call(I,g)},this.selectCell=function(g,v,F,re){var le=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],fe=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];return!Object(x.isUndefined)(g)&&!Object(x.isUndefined)(v)&&this.selectCells([[g,v,F,re]],le,fe)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],F=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];v===!1&&(Ge=!0);var re=ye.selectCells(g);return re&&F&&I.listen(),Ge=!1,re},this.selectColumns=function(g){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return ye.selectColumns(g,v)},this.selectRows=function(g){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return ye.selectRows(g,v)},this.deselectCell=function(){ye.deselect()},this.selectAll=function(){Ge=!0,ye.selectAll(),Ge=!1};var rt=(g,v)=>g.getFirstNotHiddenIndex(v,1,!0);function Mt(g){return()=>{throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(g,v){var F=arguments.length>2&&arguments[2]!==void 0&&arguments[2],re=arguments.length>3&&arguments[3]!==void 0&&arguments[3],le=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],fe=!F,Se=!re,ve=g,He=v;if(le){var Re=Number.isInteger(g),L=Number.isInteger(v),l=Re?rt(this.rowIndexMapper,g):void 0,t=L?rt(this.columnIndexMapper,v):void 0;if(l===null||t===null)return!1;ve=Re?I.rowIndexMapper.getRenderableFromVisualIndex(l):void 0,He=L?I.columnIndexMapper.getRenderableFromVisualIndex(t):void 0}var i=Number.isInteger(ve),a=Number.isInteger(He);return i&&a?I.view.scrollViewport(new W.a(ve,He),fe,re,F,Se):i&&a===!1?I.view.scrollViewportVertically(ve,fe,F):!(!a||i!==!1)&&I.view.scrollViewportHorizontally(He,re,Se)},this.destroy=function(){if(I._clearTimeouts(),I._clearImmediates(),I.view&&I.view.destroy(),Oe&&Oe.destroy(),Oe=null,q.clearCache(),Object(Z.c)(),Object(G.b)(I)){var g=this.rootDocument.querySelector("#hot-display-license-info");g&&g.parentNode.removeChild(g)}Object(X.empty)(I.rootElement),ge.destroy(),Ue&&Ue.destroy(),I.executeBatchOperations(()=>{I.runHooks("afterDestroy")}),P.a.getSingleton().destroy(I),Object(C.objectEach)(I,(v,F,re)=>{Object(w.isFunction)(v)?re[F]=Mt(F):F!=="guid"&&(re[F]=null)}),I.isDestroyed=!0,Ce&&Ce.destroy(),I.rowIndexMapper=null,I.columnIndexMapper=null,Ce=null,Ae=null,ye=null,Ue=null,I=null},this.getActiveEditor=function(){return Ue.getActiveEditor()},this.getPlugin=function(g){return Object(E.a)(this,g)},this.getInstance=function(){return I},this.addHook=function(g,v){P.a.getSingleton().add(g,v,I)},this.hasHook=function(g){return P.a.getSingleton().has(g,I)},this.addHookOnce=function(g,v){P.a.getSingleton().once(g,v,I)},this.removeHook=function(g,v){P.a.getSingleton().remove(g,v,I)},this.runHooks=function(g,v,F,re,le,fe,Se){return P.a.getSingleton().run(I,g,v,F,re,le,fe,Se)},this.getTranslatedPhrase=function(g,v){return Object(Q.a)(B.language,g,v)},this.toHTML=()=>Object(h.instanceToHTML)(this),this.toTableElement=()=>{var g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",Object(h.instanceToHTML)(this)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=g;typeof F=="function"&&(F=setTimeout(F,v)),this.timeouts.push(F)},this._clearTimeouts=function(){Object(N.arrayEach)(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(R(g))},this._clearImmediates=function(){Object(N.arrayEach)(this.immediates,g=>{c(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0&&arguments[0],v=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];Ue.destroyEditor(g),I.view.render(),v&&ye.isSelected()&&Ue.prepareEditor()},P.a.getSingleton().run(I,"construct")}}).call(this,o(116).setImmediate,o(116).clearImmediate)},,function(De,d,o){"use strict";var R=o(34),c=o(43),X=o(57),w=o(38),x=o(91),_=new WeakMap;d.a=class{constructor(f){this.instance=f,this.eventManager=new c.a(f),this.settings=f.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,_.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1}getCellAtCoords(f,S){var C=this.wt.getCell(f,S);return C<0?null:C}scrollViewport(f,S,C,N,h){return this.wt.scrollViewport(f,S,C,N,h)}scrollViewportHorizontally(f,S,C){return this.wt.scrollViewportHorizontally(f,S,C)}scrollViewportVertically(f,S,C){return this.wt.scrollViewportVertically(f,S,C)}createElements(){var f=_.get(this),{rootElement:S,rootDocument:C}=this.instance,N=S.getAttribute("style");N&&S.setAttribute("data-originalstyle",N),Object(R.addClass)(S,"handsontable"),f.table=C.createElement("TABLE"),Object(R.addClass)(f.table,"htCore"),this.instance.getSettings().tableClassName&&Object(R.addClass)(f.table,this.instance.getSettings().tableClassName),this.THEAD=C.createElement("THEAD"),f.table.appendChild(this.THEAD),this.TBODY=C.createElement("TBODY"),f.table.appendChild(this.TBODY),this.instance.table=f.table,this.instance.container.insertBefore(f.table,this.instance.container.firstChild)}registerEvents(){var f=_.get(this),{rootElement:S,rootDocument:C}=this.instance,N=C.documentElement;this.eventManager.addEventListener(S,"mousedown",h=>{if(f.selectionMouseDown=!0,!this.isTextSelectionAllowed(h.target)){var{rootWindow:E}=this.instance;Object(R.clearTextSelection)(E),h.preventDefault(),E.focus()}}),this.eventManager.addEventListener(S,"mouseup",()=>{f.selectionMouseDown=!1}),this.eventManager.addEventListener(S,"mousemove",h=>{f.selectionMouseDown&&!this.isTextSelectionAllowed(h.target)&&(this.settings.fragmentSelection&&Object(R.clearTextSelection)(this.instance.rootWindow),h.preventDefault())}),this.eventManager.addEventListener(N,"keyup",h=>{this.instance.selection.isInProgress()&&!h.shiftKey&&this.instance.selection.finish()}),this.eventManager.addEventListener(N,"mouseup",h=>{this.instance.selection.isInProgress()&&Object(X.isLeftClick)(h)&&this.instance.selection.finish(),f.mouseDown=!1,(Object(R.isOutsideInput)(C.activeElement)||!this.instance.selection.isSelected()&&!Object(X.isRightClick)(h))&&this.instance.unlisten()}),this.eventManager.addEventListener(N,"contextmenu",h=>{this.instance.selection.isInProgress()&&Object(X.isRightClick)(h)&&(this.instance.selection.finish(),f.mouseDown=!1)}),this.eventManager.addEventListener(N,"touchend",()=>{this.instance.selection.isInProgress()&&this.instance.selection.finish(),f.mouseDown=!1}),this.eventManager.addEventListener(N,"mousedown",h=>{var E=h.target,M=h.x||h.clientX,y=h.y||h.clientY,z=h.target;if(!f.mouseDown&&S&&this.instance.view){var{holder:U}=this.instance.view.wt.wtTable;if(z===U){var te=Object(R.getScrollbarWidth)(C);if(C.elementFromPoint(M+te,y)!==U||C.elementFromPoint(M,y+te)!==U)return}else for(;z!==N;){if(z===null){if(h.isTargetWebComponent)break;return}if(z===S)return;z=z.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(E):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(f.table,"selectstart",h=>{this.settings.fragmentSelection||Object(R.isInput)(h.target)||h.preventDefault()})}translateFromRenderableToVisualCoords(f){var{row:S,col:C}=f;return new w.a(...this.translateFromRenderableToVisualIndex(S,C))}translateFromRenderableToVisualIndex(f,S){var C=f>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(f):f,N=S>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(S):S;return C===null&&(C=f),N===null&&(N=S),[C,N]}countRenderableColumns(){return Math.min(this.instance.columnIndexMapper.getRenderableIndexesLength(),this.settings.maxCols)}countRenderableRows(){return Math.min(this.instance.rowIndexMapper.getRenderableIndexesLength(),this.settings.maxRows)}countNotHiddenRowIndexes(f,S){return this.countNotHiddenIndexes(f,S,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(f,S){return this.countNotHiddenIndexes(f,S,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(f,S,C,N){if(isNaN(f)||f<0)return 0;var h=C.getFirstNotHiddenIndex(f,S),E=C.getRenderableFromVisualIndex(h);if(!Number.isInteger(E))return 0;var M=0;return S<0?M=E+1:S>0&&(M=N-E),M}initializeWalkontable(){var f=_.get(this),S={externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:f.table,preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(E,M)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(E,M)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsLeft:()=>{var E=parseInt(this.settings.fixedColumnsLeft,10);return this.countNotHiddenColumnIndexes(E-1,-1)},fixedRowsTop:()=>{var E=parseInt(this.settings.fixedRowsTop,10);return this.countNotHiddenRowIndexes(E-1,-1)},fixedRowsBottom:()=>{var E=parseInt(this.settings.fixedRowsBottom,10);return this.countNotHiddenRowIndexes(this.instance.countRows()-E,1)},minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{var E=[];return this.instance.hasRowHeaders()&&E.push((M,y)=>{var z=M>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(M):M;this.appendRowHeader(z,y)}),this.instance.runHooks("afterGetRowHeaderRenderers",E),E},columnHeaders:()=>{var E=[];return this.instance.hasColHeaders()&&E.push((M,y)=>{var z=M>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(M):M;this.appendColHeader(z,y)}),this.instance.runHooks("afterGetColumnHeaderRenderers",E),E},columnWidth:E=>{var M=this.instance.columnIndexMapper.getVisualFromRenderableIndex(E);return this.instance.getColWidth(M===null?E:M)},rowHeight:E=>{var M=this.instance.rowIndexMapper.getVisualFromRenderableIndex(E);return this.instance.getRowHeight(M===null?E:M)},cellRenderer:(E,M,y)=>{var[z,U]=this.translateFromRenderableToVisualIndex(E,M),te=this.instance.getCellMeta(z,U),D=this.instance.colToProp(U),k=this.instance.getDataAtRowProp(z,D);this.instance.hasHook("beforeValueRender")&&(k=this.instance.runHooks("beforeValueRender",k,te)),this.instance.runHooks("beforeRenderer",y,z,U,D,k,te),this.instance.getCellRenderer(te)(this.instance,y,z,U,D,k,te),this.instance.runHooks("afterRenderer",y,z,U,D,k,te)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(E,M,y,z)=>{var U=this.translateFromRenderableToVisualCoords(M),te={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=z,f.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",E,U,y,te),Object(X.isImmediatePropagationStopped)(E)||(Object(x.a)(E,{coords:U,selection:this.instance.selection,controller:te}),this.instance.runHooks("afterOnCellMouseDown",E,U,y),this.activeWt=this.wt)},onCellContextMenu:(E,M,y,z)=>{var U=this.translateFromRenderableToVisualCoords(M);this.activeWt=z,f.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",E,U,y),Object(X.isImmediatePropagationStopped)(E)||(this.instance.runHooks("afterOnCellContextMenu",E,U,y),this.activeWt=this.wt)},onCellMouseOut:(E,M,y,z)=>{var U=this.translateFromRenderableToVisualCoords(M);this.activeWt=z,this.instance.runHooks("beforeOnCellMouseOut",E,U,y),Object(X.isImmediatePropagationStopped)(E)||(this.instance.runHooks("afterOnCellMouseOut",E,U,y),this.activeWt=this.wt)},onCellMouseOver:(E,M,y,z)=>{var U=this.translateFromRenderableToVisualCoords(M),te={row:!1,column:!1,cell:!1};this.activeWt=z,this.instance.runHooks("beforeOnCellMouseOver",E,U,y,te),Object(X.isImmediatePropagationStopped)(E)||(f.mouseDown&&Object(x.a)(E,{coords:U,selection:this.instance.selection,controller:te}),this.instance.runHooks("afterOnCellMouseOver",E,U,y),this.activeWt=this.wt)},onCellMouseUp:(E,M,y,z)=>{var U=this.translateFromRenderableToVisualCoords(M);this.activeWt=z,this.instance.runHooks("beforeOnCellMouseUp",E,U,y),Object(X.isImmediatePropagationStopped)(E)||(this.instance.runHooks("afterOnCellMouseUp",E,U,y),this.activeWt=this.wt)},onCellCornerMouseDown:E=>{E.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",E)},onCellCornerDblClick:E=>{E.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",E)},beforeDraw:(E,M)=>this.beforeRender(E,M),onDraw:E=>this.onDraw(E),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onAfterDrawSelection:(E,M,y,z)=>{var[U,te]=this.translateFromRenderableToVisualIndex(E,M);return this.instance.runHooks("afterDrawSelection",U,te,y,z)},onBeforeDrawBorders:(E,M)=>{var[y,z,U,te]=E,D=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(y),this.instance.columnIndexMapper.getVisualFromRenderableIndex(z),this.instance.rowIndexMapper.getVisualFromRenderableIndex(U),this.instance.columnIndexMapper.getVisualFromRenderableIndex(te)];return this.instance.runHooks("beforeDrawBorders",D,M)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(E,M)=>{var y=this.instance.columnIndexMapper.getVisualFromRenderableIndex(M);return this.instance.runHooks("beforeStretchingColumnWidth",E,y)},onModifyRowHeaderWidth:E=>this.instance.runHooks("modifyRowHeaderWidth",E),onModifyGetCellCoords:(E,M,y)=>{var z=M>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(M):M,U=E>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(E):E;return this.instance.runHooks("modifyGetCellCoords",U,z,y)},viewportRowCalculatorOverride:E=>{var M=this.settings.viewportRowRenderingOffset;if(M==="auto"&&this.settings.fixedRowsTop&&(M=10),M>0||M==="auto"){var y=this.countRenderableRows();if(typeof M=="number")E.startRow=Math.max(E.startRow-M,0),E.endRow=Math.min(E.endRow+M,y-1);else if(M==="auto"){var z=E.startRow+E.endRow-E.startRow,U=Math.ceil(z/y*12);E.startRow=Math.max(E.startRow-U,0),E.endRow=Math.min(E.endRow+U,y-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",E)},viewportColumnCalculatorOverride:E=>{var M=this.settings.viewportColumnRenderingOffset;if(M==="auto"&&this.settings.fixedColumnsLeft&&(M=10),M>0||M==="auto"){var y=this.countRenderableColumns();if(typeof M=="number"&&(E.startColumn=Math.max(E.startColumn-M,0),E.endColumn=Math.min(E.endColumn+M,y-1)),M==="auto"){var z=E.startColumn+E.endColumn-E.startColumn,U=Math.ceil(z/y*12);E.startRow=Math.max(E.startColumn-U,0),E.endColumn=Math.min(E.endColumn+U,y-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",E)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{var E=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||E}};this.instance.runHooks("beforeInitWalkontable",S),this.wt=new w.e(S),this.activeWt=this.wt;var C=this.wt.wtTable.spreader,{width:N,height:h}=Object(R.getBoundingClientRect)(this.instance.rootElement);this.setLastSize(N,h),this.eventManager.addEventListener(C,"mousedown",E=>{E.target===C&&E.which===3&&E.stopPropagation()}),this.eventManager.addEventListener(C,"contextmenu",E=>{E.target===C&&E.which===3&&E.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this.wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(f){if(Object(R.isInput)(f))return!0;var S=Object(R.isChildOf)(f,this.instance.view.wt.wtTable.spreader);return!(this.settings.fragmentSelection!==!0||!S)||!(this.settings.fragmentSelection!=="cell"||!this.isSelectedOnlyCell()||!S)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}isMouseDown(){return _.get(this).mouseDown}isSelectedOnlyCell(){var[f,S,C,N]=this.instance.getSelectedLast()||[];return f!==void 0&&f===C&&S===N}isCellEdited(){var f=this.instance.getActiveEditor();return f&&f.isOpened()}beforeRender(f,S){f&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,S)}onDraw(f){f&&this.instance.runHooks("afterRender",this.instance.forceFullRender)}appendRowHeader(f,S){if(S.firstChild){var C=S.firstChild;if(!Object(R.hasClass)(C,"relative"))return Object(R.empty)(S),void this.appendRowHeader(f,S);this.updateCellHeader(C.querySelector(".rowHeader"),f,this.instance.getRowHeader)}else{var{rootDocument:N,getRowHeader:h}=this.instance,E=N.createElement("div"),M=N.createElement("span");E.className="relative",M.className="rowHeader",this.updateCellHeader(M,f,h),E.appendChild(M),S.appendChild(E)}this.instance.runHooks("afterGetRowHeader",f,S)}appendColHeader(f,S){if(S.firstChild){var C=S.firstChild;Object(R.hasClass)(C,"relative")?this.updateCellHeader(C.querySelector(".colHeader"),f,this.instance.getColHeader):(Object(R.empty)(S),this.appendColHeader(f,S))}else{var{rootDocument:N}=this.instance,h=N.createElement("div"),E=N.createElement("span");h.className="relative",E.className="colHeader",this.updateCellHeader(E,f,this.instance.getColHeader),h.appendChild(E),S.appendChild(h)}this.instance.runHooks("afterGetColHeader",f,S)}updateCellHeader(f,S,C){var N=S,h=this.wt.wtOverlays.getParentOverlay(f)||this.wt;f.parentNode&&(Object(R.hasClass)(f,"colHeader")?N=h.wtTable.columnFilter.sourceToRendered(S):Object(R.hasClass)(f,"rowHeader")&&(N=h.wtTable.rowFilter.sourceToRendered(S))),N>-1?Object(R.fastInnerHTML)(f,C(S)):(Object(R.fastInnerText)(f,String.fromCharCode(160)),Object(R.addClass)(f,"cornerHeader"))}maximumVisibleElementWidth(f){var S=this.wt.wtViewport.getWorkspaceWidth()-f;return S>0?S:0}maximumVisibleElementHeight(f){var S=this.wt.wtViewport.getWorkspaceHeight()-f;return S>0?S:0}setLastSize(f,S){var C=_.get(this);[C.lastWidth,C.lastHeight]=[f,S]}getLastSize(){var f=_.get(this);return{width:f.lastWidth,height:f.lastHeight}}mainViewIsActive(){return this.wt===this.activeWt}destroy(){this.wt.destroy(),this.eventManager.destroy()}}},function(De,d,o){"use strict";var R=o(32),c=o(75),X=o(33),w=o(44),x=o(61);d.a=class{constructor(_){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=_,this.data=f,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(_){var f;return this.hot.hasHook("modifyRowData")&&(f=this.hot.runHooks("modifyRowData",_)),f===void 0||Number.isInteger(f)?this.data[_]:f}getData(){var _=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this.data&&this.data.length!==0?this.getByRange(null,null,_):this.data}setData(_){this.data=_}getAtColumn(_){var f=[];return Object(X.arrayEach)(this.data,(S,C)=>{var N=this.getAtCell(C,_);f.push(N)}),f}getAtRow(_,f,S){var C=arguments.length>3&&arguments[3]!==void 0&&arguments[3],N=f===void 0&&S===void 0,h=null,E=null;if(h=this.modifyRowData(_),Array.isArray(h))E=[],N?h.forEach((y,z)=>{E[z]=this.getAtPhysicalCell(_,z,h)}):Object(w.rangeEach)(f,S,y=>{E[y-f]=this.getAtPhysicalCell(_,y,h)});else if(Object(R.isObject)(h)||Object(x.isFunction)(h))if(E=C?[]:{},!N||C){var M=this.countFirstRowKeys()-1;Object(w.rangeEach)(0,M,y=>{var z=this.colToProp(y);if(y>=(f||0)&&y<=(S||M)&&!Number.isInteger(z)){var U=this.getAtPhysicalCell(_,z,h);C?E.push(U):Object(R.setProperty)(E,z,U)}})}else Object(R.objectEach)(h,(y,z)=>{Object(R.setProperty)(E,z,this.getAtPhysicalCell(_,z,h))});return E}setAtCell(_,f,S){if(!(_>=this.countRows()||f>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var C=Object(R.createObjectPropListener)(S);this.hot.runHooks("modifySourceData",_,this.propToCol(f),C,"set"),C.isTouched()&&(S=C.value)}Number.isInteger(f)?this.data[_][f]=S:Object(R.setProperty)(this.data[_],f,S)}}getAtPhysicalCell(_,f,S){var C=null;if(S&&(C=typeof f=="string"?Object(R.getProperty)(S,f):typeof f=="function"?f(S):S[f]),this.hot.hasHook("modifySourceData")){var N=Object(R.createObjectPropListener)(C);this.hot.runHooks("modifySourceData",_,this.colToProp(f),N,"get"),N.isTouched()&&(C=N.value)}return C}getAtCell(_,f){var S=this.modifyRowData(_);return this.getAtPhysicalCell(_,this.colToProp(f),S)}getByRange(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,S=arguments.length>2&&arguments[2]!==void 0&&arguments[2],C=!1,N=null,h=null,E=null,M=null;_===null||f===null?(C=!0,N=0,E=this.countRows()-1):(N=Math.min(_.row,f.row),h=Math.min(_.col,f.col),E=Math.max(_.row,f.row),M=Math.max(_.col,f.col));var y=[];return Object(w.rangeEach)(N,E,z=>{y.push(C?this.getAtRow(z,void 0,void 0,S):this.getAtRow(z,h,M,S))}),y}countRows(){if(this.hot.hasHook("modifySourceLength")){var _=this.hot.runHooks("modifySourceLength");if(Number.isInteger(_))return _}return this.data.length}countFirstRowKeys(){return Object(c.countFirstRowKeys)(this.data)}destroy(){this.data=null,this.hot=null}}},function(De,d,o){"use strict";o.d(d,"a",function(){return c});var R=o(38);function c(X,w){var x=new R.b(w),_=X.getCellMeta(w.row,w.col);if(_.rowspan||_.colspan){var f=_.rowspan||1,S=_.colspan||1;x.to=new R.a(w.row+f-1,w.col+S-1)}return x}},function(De,d,o){"use strict";function R(c){var X=typeof window!="undefined"&&window.jQuery;X&&(X.fn.handsontable=function(w){var x,_=this.first(),f=_.data("handsontable");if(typeof w!="string"){var S=w||{};return f?f.updateSettings(S):(f=new c.Core(_[0],S),_.data("handsontable",f),f.init()),_}if(f){if(f[w]===void 0)throw new Error("Handsontable do not provide action: ".concat(w));for(var C=arguments.length,N=new Array(C>1?C-1:0),h=1;h<C;h++)N[h-1]=arguments[h];x=f[w].call(f,...N),w==="destroy"&&_.removeData()}return x})}o.d(d,"a",function(){return R})},function(De,d,o){"use strict";function R(c){var X=new Date(c);return isNaN(new Date("".concat(c,"T00:00")).getDate())?X:new Date(X.getTime()+6e4*X.getTimezoneOffset())}o.r(d),o.d(d,"getNormalizedDate",function(){return R})},,function(De,d,o){"use strict";o.r(d),o.d(d,"AutoColumnSize",function(){return D}),o.d(d,"AutoRowSize",function(){return G}),o.d(d,"Base",function(){return _}),o.d(d,"CopyPaste",function(){return I}),o.d(d,"CustomBorders",function(){return at}),o.d(d,"MergeCells",function(){return He}),o.d(d,"TouchScroll",function(){return L});var R=o(32),c=o(33),X=o(47),w=new WeakMap,x=null,_=class{constructor(l){Object(R.defineGetter)(this,"hot",l,{writable:!1}),w.set(this,{hooks:{}}),x=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=Object(X.b)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),x||(x=Object(X.c)(this.hot)),x.indexOf(this.pluginName)>=0&&x.splice(x.indexOf(this.pluginName),1),x.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(l,t){w.get(this).hooks[l]=w.get(this).hooks[l]||[];var i=w.get(this).hooks[l];this.hot.addHook(l,t),i.push(t),w.get(this).hooks[l]=i}removeHooks(l){Object(c.arrayEach)(w.get(this).hooks[l]||[],t=>{this.hot.removeHook(l,t)})}clearHooks(){var l=w.get(this).hooks;Object(R.objectEach)(l,(t,i)=>this.removeHooks(i)),l.length=0}callOnPluginsReady(l){this.isPluginsReady?l():this.pluginsInitializedCallbacks.push(l)}onAfterPluginsInitialized(){Object(c.arrayEach)(this.pluginsInitializedCallbacks,l=>l()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(R.objectEach)(this,(l,t)=>{t!=="hot"&&(this[t]=null)}),delete this.t,delete this.hot}},f=o(55),S=o(93),C=o(44),N=o(40);class h{static get SAMPLE_COUNT(){return 3}constructor(t){this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:h.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,i){return this.generateSamples("row",i,t)}generateColumnSamples(t,i){return this.generateSamples("col",i,t)}generateSamples(t,i,a){var m=new Map,{from:b,to:H}=typeof a=="number"?{from:a,to:a}:a;return Object(C.rangeEach)(b,H,$=>{var me=this.generateSample(t,i,$);m.set($,me)}),m}generateSample(t,i,a){if(t!=="row"&&t!=="col")throw new Error("Unsupported sample type");var m=new Map,b=t==="row"?"col":"row",H=[];return Object(C.rangeEach)(i.from,i.to,$=>{var me,{value:Te,bundleCountSeed:Ie}=t==="row"?this.dataFactory(a,$):this.dataFactory($,a),Fe=Ie>0;me=Object(R.isObject)(Te)?Object.keys(Te).length:Array.isArray(Te)?Te.length:Object(N.stringify)(Te).length,Fe&&(me+=Ie),m.has(me)||m.set(me,{needed:this.getSampleCount(),strings:[]});var Ke=m.get(me);Ke.needed&&(!(H.indexOf(Te)>-1)||this.allowDuplicates||Fe)&&(Ke.strings.push({value:Te,[b]:$}),H.push(Te),Ke.needed-=1)}),m}}var E=h,M=o(49),y=o(38),z=o(95),U=new WeakMap;class te extends _{static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),U.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new S.a(this.hot),this.samplesGenerator=new E((i,a)=>{var m=this.hot.getCellMeta(i,a),b="";m.spanned||(b=this.hot.getDataAtCell(i,a));var H=0;if(m.label){var{value:$,property:me}=m.label,Te="";if($)Te=typeof $=="function"?$(i,a,this.hot.colToProp(a),b):$;else if(me){var Ie=this.hot.getDataAtRowProp(i,me);Te=Ie!==null?Ie:""}H=Te.length}return{value:b,bundleCountSeed:H}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new z.b,this.addHook("beforeColumnResize",(i,a,m)=>this.onBeforeColumnResize(i,a,m)),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap)}isEnabled(){return this.hot.getSettings().autoColumnSize!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){if(!this.enabled){var t=this.hot.getSettings().autoColumnSize;t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",()=>this.onAfterLoadData()),this.addHook("beforeChange",i=>this.onBeforeChange(i)),this.addHook("beforeRender",i=>this.onBeforeRender(i)),this.addHook("modifyColWidth",(i,a)=>this.getColumnWidth(a,i)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}}updatePlugin(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&this.clearCache(t),super.updatePlugin()}calculateColumnsWidth(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],m=typeof t=="number"?{from:t,to:t}:t,b=typeof i=="number"?{from:i,to:i}:i;Object(C.rangeEach)(m.from,m.to,H=>{var $=this.hot.toPhysicalColumn(H);if($===null&&($=H),a||this.columnWidthsMap.getValueAtIndex($)===null&&!this.hot._getColWidthFromSettings($)){var me=this.samplesGenerator.generateColumnSamples(H,b);Object(c.arrayEach)(me,Te=>{var[Ie,Fe]=Te;return this.ghostTable.addColumn(Ie,Fe)})}}),this.ghostTable.columns.length&&(this.hot.executeBatchOperations(()=>{this.ghostTable.getWidths((H,$)=>{var me=this.hot.toPhysicalColumn(H);this.columnWidthsMap.setValueAtIndex(me,$)})}),this.measuredColumns=m.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=0,a=this.hot.countCols()-1,m=null;this.inProgress=!0;var b=()=>{if(!this.hot)return Object(f.cancelAnimationFrame)(m),void(this.inProgress=!1);this.calculateColumnsWidth({from:i,to:Math.min(i+te.CALCULATION_STEP,a)},t),(i=i+te.CALCULATION_STEP+1)<a?m=Object(f.requestAnimationFrame)(b):(Object(f.cancelAnimationFrame)(m),this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSizes())},H=this.getSyncCalculationLimit();this.firstCalculation&&H>=0&&(this.calculateColumnsWidth({from:0,to:H},t),this.firstCalculation=!1,i=H+1),i<a?b():this.inProgress=!1}setSamplingOptions(){var t=this.hot.getSettings().autoColumnSize,i=t&&Object(R.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,a=t&&Object(R.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){var t=te.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return Object(R.isObject)(this.hot.getSettings().autoColumnSize)&&(t=this.hot.getSettings().autoColumnSize.syncLimit,Object(M.isPercentValue)(t)?t=Object(C.valueAccordingPercent)(i,t):t>>=0),Math.min(t,i)}getColumnWidth(t){var i=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;return a===void 0&&(a=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),i&&typeof a=="number"&&(a=Math.max(a,y.d.DEFAULT_WIDTH))),a}getFirstVisibleColumn(){var t=this.hot.view.wt;if(t.wtViewport.columnsVisibleCalculator){var i=t.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(t.wtViewport.columnsRenderCalculator){var a=t.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}getLastVisibleColumn(){var t=this.hot.view.wt;if(t.wtViewport.columnsVisibleCalculator){var i=t.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(t.wtViewport.columnsRenderCalculator){var a=t.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}findColumnsWhereHeaderWasChanged(){var t=this.hot.getColHeader(),{cachedColumnHeaders:i}=U.get(this);return Object(c.arrayReduce)(t,(a,m,b)=>{var H=i.length;return(H-1<b||i[b]!==m)&&a.push(b),H-1<b?i.push(m):i[b]=m,a},[])}clearCache(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.length?this.hot.executeBatchOperations(()=>{Object(c.arrayEach)(t,i=>{this.columnWidthsMap.setValueAtIndex(i,null)})}):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Object(c.arrayFilter)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),t=>t===null).length}onBeforeRender(){var t=this.hot.renderCall,i=this.hot.countRows(),a=this.getFirstVisibleColumn(),m=this.getLastVisibleColumn();a!==-1&&m!==-1&&i&&(this.calculateColumnsWidth({from:a,to:m},void 0,t),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(t){var i=Object(c.arrayMap)(t,a=>{var[,m]=a;return this.hot.toPhysicalColumn(this.hot.propToCol(m))});this.clearCache(Array.from(new Set(i)))}onBeforeColumnResize(t,i,a){var m=t;return a&&(this.calculateColumnsWidth(i,void 0,!0),m=this.getColumnWidth(i,void 0,!1)),m}onAfterInit(){U.get(this).cachedColumnHeaders=this.hot.getColHeader()}disablePlugin(){super.disablePlugin()}destroy(){this.hot.columnIndexMapper.unregisterMap("autoColumnSize"),this.ghostTable.clean(),super.destroy()}}Object(X.d)("autoColumnSize",te);var D=te,k=o(34);class T extends _{static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new S.a(this.hot),this.samplesGenerator=new E((i,a)=>{var m;return i>=0?m=this.hot.getDataAtCell(i,a):i===-1&&(m=this.hot.getColHeader(a)),{value:m}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.addHook("beforeRowResize",(i,a,m)=>this.onBeforeRowResize(i,a,m)),this.rowHeightsMap=new z.b,this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap)}isEnabled(){return this.hot.getSettings().autoRowSize===!0||Object(R.isObject)(this.hot.getSettings().autoRowSize)}enablePlugin(){this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",()=>this.onAfterLoadData()),this.addHook("beforeChange",t=>this.onBeforeChange(t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeRender",t=>this.onBeforeRender(t)),this.addHook("modifyRowHeight",(t,i)=>this.getRowHeight(i,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin()}calculateRowsHeight(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],m=typeof t=="number"?{from:t,to:t}:t,b=typeof i=="number"?{from:i,to:i}:i;if(this.hot.getColHeader(0)!==null){var H=this.samplesGenerator.generateRowSamples(-1,b);this.ghostTable.addColumnHeadersRow(H.get(-1))}Object(C.rangeEach)(m.from,m.to,$=>{if(a||this.rowHeightsMap.getValueAtIndex($)===null){var me=this.samplesGenerator.generateRowSamples($,b);Object(c.arrayEach)(me,Te=>{var[Ie,Fe]=Te;return this.ghostTable.addRow(Ie,Fe)})}}),this.ghostTable.rows.length&&(this.hot.executeBatchOperations(()=>{this.ghostTable.getHeights(($,me)=>{$<0?this.headerHeight=me:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow($),me)})}),this.measuredRows=m.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=0,a=this.hot.countRows()-1,m=null;this.inProgress=!0;var b=()=>{if(!this.hot)return Object(f.cancelAnimationFrame)(m),void(this.inProgress=!1);this.calculateRowsHeight({from:i,to:Math.min(i+T.CALCULATION_STEP,a)},t),(i=i+T.CALCULATION_STEP+1)<a?m=Object(f.requestAnimationFrame)(b):(Object(f.cancelAnimationFrame)(m),this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSizes(!0),this.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&this.hot.view.wt.wtOverlays.leftOverlay.clone.drawClone())},H=this.getSyncCalculationLimit();this.firstCalculation&&H>=0&&(this.calculateRowsHeight({from:0,to:H},t),this.firstCalculation=!1,i=H+1),i<a?b():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSizes(!1))}setSamplingOptions(){var t=this.hot.getSettings().autoRowSize,i=t&&Object(R.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,a=t&&Object(R.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}recalculateAllRowsHeight(){Object(k.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){var t=T.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return Object(R.isObject)(this.hot.getSettings().autoRowSize)&&(t=this.hot.getSettings().autoRowSize.syncLimit,Object(M.isPercentValue)(t)?t=Object(C.valueAccordingPercent)(i,t):t>>=0),Math.min(t,i)}getRowHeight(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t)),m=i;return a!==null&&a>(i||0)&&(m=a),m}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){var{from:i,to:a}=typeof t=="number"?{from:t,to:t}:t;this.hot.executeBatchOperations(()=>{Object(C.rangeEach)(Math.min(i,a),Math.max(i,a),m=>{this.rowHeightsMap.setValueAtIndex(m,null)})})}isNeedRecalculate(){return!!Object(c.arrayFilter)(this.rowHeightsMap.getValues().slice(0,this.measuredRows),t=>t===null).length}onBeforeRender(){var t=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),m=this.getLastVisibleRow();if(a!==-1&&m!==-1){if(this.calculateRowsHeight({from:a,to:m},void 0,t),i){var b=this.hot.countRows()-1;this.calculateRowsHeight({from:b-i,to:b})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(t,i){this.clearCacheByRange({from:t,to:i}),this.calculateAllRowsHeight()}onBeforeRowResize(t,i,a){var m=t;return a&&(this.calculateRowsHeight(i,void 0,!0),m=this.getRowHeight(i)),m}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()},0)}onBeforeChange(t){var i=null;t.length===1?i=t[0][0]:t.length>1&&(i={from:t[0][0],to:t[t.length-1][0]}),i!==null&&this.clearCacheByRange(i)}destroy(){this.hot.rowIndexMapper.unregisterMap("autoRowSize"),this.ghostTable.clean(),super.destroy()}}Object(X.d)("autoRowSize",T);var G=T,W=o(59),P=o(121),Q=o.n(P),O=o(45);class A{constructor(){this.data={}}setData(t,i){this.data[t]=i}getData(t){return this.data[t]||void 0}}class Z{constructor(){this.clipboardData=new A}}var ee=o(43),de=o(62),be=o(46);class Ne{constructor(t){this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new ee.a(this),this.listenersCount=new WeakSet,this.container=t}useSecondaryElement(){var t=function(i){var a=Ce.get(i);if(a)return a.parentElement||i.appendChild(a),a;var m=(i.defaultView?i:i.ownerDocument).createElement("textarea");return Ce.set(i,m),m.setAttribute("data-hot-input",""),m.className="HandsontableCopyPaste",m.tabIndex=-1,m.autocomplete="off",m.wrap="hard",m.value=" ",i.appendChild(m),m}(this.container);this.listenersCount.has(t)||(this.listenersCount.add(t),Be(this.eventManager,t,this)),this.mainElement=t}setFocusableElement(t){this.listenersCount.has(t)||(this.listenersCount.add(t),Be(this.eventManager,t,this)),this.mainElement=t}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",Object(be.isMobileBrowser)()||Object(k.selectElementIfAllowed)(this.mainElement)}}Object(R.mixin)(Ne,de.a);var Me=new WeakMap,pe=(l,t)=>i=>t.runLocalHooks(l,i);function Be(l,t,i){l.addEventListener(t,"copy",pe("copy",i)),l.addEventListener(t,"cut",pe("cut",i)),l.addEventListener(t,"paste",pe("paste",i))}var Ce=new WeakMap;function Oe(l){if(l instanceof Ne){var t=Me.get(l.container);if((t=isNaN(t)?0:t)>0&&(t-=1),function(a){a.eventManager.clear()}(l),t<=0){t=0;var i=Ce.get(l.container);i&&i.parentNode&&(i.parentNode.removeChild(i),Ce.delete(l.container)),l.mainElement=null}Me.set(l.container,t)}}var Ae=o(90);W.a.getSingleton().register("afterCopyLimit"),W.a.getSingleton().register("modifyCopyableRange"),W.a.getSingleton().register("beforeCut"),W.a.getSingleton().register("afterCut"),W.a.getSingleton().register("beforePaste"),W.a.getSingleton().register("afterPaste"),W.a.getSingleton().register("beforeCopy"),W.a.getSingleton().register("afterCopy");var Ue=new WeakMap,ze=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");class Ge extends _{constructor(t){super(t),this.columnsLimit=1e3,this.copyableRanges=[],this.focusableElement=void 0,this.pasteMode="overwrite",this.rowsLimit=1e3,this.uiContainer=this.hot.rootDocument.body,Ue.set(this,{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1})}isEnabled(){return!!this.hot.getSettings().copyPaste}enablePlugin(){if(!this.enabled){var t,i,a,{copyPaste:m,fragmentSelection:b}=this.hot.getSettings();Ue.get(this).isFragmentSelectionEnabled=!!b,typeof m=="object"&&(this.pasteMode=m.pasteMode||this.pasteMode,this.rowsLimit=isNaN(m.rowsLimit)?this.rowsLimit:m.rowsLimit,this.columnsLimit=isNaN(m.columnsLimit)?this.columnsLimit:m.columnsLimit,this.uiContainer=m.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",H=>this.onAfterContextMenuDefaultOptions(H)),this.addHook("afterOnCellMouseUp",()=>this.onAfterOnCellMouseUp()),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.addHook("beforeKeyDown",()=>this.onBeforeKeyDown()),this.focusableElement=(t=this.uiContainer,i=new Ne(t),a=Me.get(t),a=isNaN(a)?0:a,Me.set(t,a+1),i),this.focusableElement.addLocalHook("copy",H=>this.onCopy(H)).addLocalHook("cut",H=>this.onCut(H)).addLocalHook("paste",H=>this.onPaste(H)),super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&Oe(this.focusableElement),super.disablePlugin()}copy(){Ue.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}cut(){Ue.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(t){var i=[],a=[],m=[];return Object(c.arrayEach)(t,b=>{Object(C.rangeEach)(b.startRow,b.endRow,H=>{a.indexOf(H)===-1&&a.push(H)}),Object(C.rangeEach)(b.startCol,b.endCol,H=>{m.indexOf(H)===-1&&m.push(H)})}),Object(c.arrayEach)(a,b=>{var H=[];Object(c.arrayEach)(m,$=>{H.push(this.hot.getCopyableData(b,$))}),i.push(H)}),Q.a.stringify(i)}getRangedData(t){var i=[],a=[],m=[];return Object(c.arrayEach)(t,b=>{Object(C.rangeEach)(b.startRow,b.endRow,H=>{a.indexOf(H)===-1&&a.push(H)}),Object(C.rangeEach)(b.startCol,b.endCol,H=>{m.indexOf(H)===-1&&m.push(H)})}),Object(c.arrayEach)(a,b=>{var H=[];Object(c.arrayEach)(m,$=>{H.push(this.hot.getCopyableData(b,$))}),i.push(H)}),i}paste(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;if(t||i){var a=new Z;t&&a.clipboardData.setData("text/plain",t),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}setCopyableText(){var t=this.hot.getSelectedRangeLast();if(t){var i=t.getTopLeftCorner(),a=t.getBottomRightCorner(),m=i.row,b=i.col,H=a.row,$=a.col,me=Math.min(H,m+this.rowsLimit-1),Te=Math.min($,b+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:m,startCol:b,endRow:me,endCol:Te}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),H===me&&$===Te||this.hot.runHooks("afterCopyLimit",H-m+1,$-b+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var t=this.hot.getActiveEditor(),i=t?t.TEXTAREA:void 0;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}isEditorOpened(){var t=this.hot.getActiveEditor();return t&&t.isOpened()}populateValues(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedLast();if(t.length){for(var a=t.length-1,m=t[0].length-1,b=Math.min(i[0],i[2]),H=Math.max(i[0],i[2],a+b),$=Math.min(i[1],i[3]),me=Math.max(i[1],i[3],m+$),Te=[],Ie=b,Fe=0;Ie<=H;Ie+=1){for(var Ke=[],$e=$,et=0;$e<=me;$e+=1)Ke.push(t[Fe][et]),et=et===m?0:et+=1;Te.push(Ke),Fe=Fe===a?0:Fe+=1}return this.hot.populateFromArray(b,$,Te,void 0,void 0,"CopyPaste.paste",this.pasteMode),[b,$,H,me]}}onCopy(t){var i=Ue.get(this);if((this.hot.isListening()||i.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),i.isTriggeredByCopy=!1;var a=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",a,this.copyableRanges)){var m=Q.a.stringify(a);if(t&&t.clipboardData){var b=Object(Ae._dataToHTML)(a,this.hot.rootDocument);t.clipboardData.setData("text/plain",m),t.clipboardData.setData("text/html",[ze,b].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",m);this.hot.runHooks("afterCopy",a,this.copyableRanges)}t.preventDefault()}}onCut(t){var i=Ue.get(this);if((this.hot.isListening()||i.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),i.isTriggeredByCut=!1;var a=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",a,this.copyableRanges)){var m=Q.a.stringify(a);if(t&&t.clipboardData){var b=Object(Ae._dataToHTML)(a,this.hot.rootDocument);t.clipboardData.setData("text/plain",m),t.clipboardData.setData("text/html",[ze,b].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",m);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}t.preventDefault()}}onPaste(t){if(this.hot.isListening()&&!this.isEditorOpened()){var i;if(t&&t.preventDefault&&t.preventDefault(),t&&t.clipboardData!==void 0){var a=t.clipboardData.getData("text/html");a&&/(<table)|(<TABLE)/g.test(a)?i=Object(Ae.htmlToGridSettings)(a,this.hot.rootDocument).data:i=t.clipboardData.getData("text/plain")}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData!==void 0&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=Q.a.parse(i)),(!i||i.length!==0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var[m,b,H,$]=this.populateValues(i);this.hot.selectCell(m,b,Math.min(this.hot.countRows()-1,H),Math.min(this.hot.countCols()-1,$)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}onAfterContextMenuDefaultOptions(t){var i;t.items.push({name:"---------"},(i=this,{key:"copy",name(){return this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_COPY)},callback(){i.copy()},disabled(){var a=this.getSelected();return!a||a.length>1},hidden:!1}),function(a){return{key:"cut",name(){return this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_CUT)},callback(){a.cut()},disabled(){var m=this.getSelected();return!m||m.length>1},hidden:!1}}(this))}onAfterOnCellMouseUp(){this.hot.isListening()&&!this.isEditorOpened()&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){var{isFragmentSelectionEnabled:t}=Ue.get(this);this.isEditorOpened()||(this.getOrCreateFocusableElement(),t&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(k.getSelectionText)()||(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(this.hot.isListening()&&!this.isEditorOpened()){var t=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||t!==this.focusableElement.getFocusableElement()&&t!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}destroy(){this.focusableElement&&(Oe(this.focusableElement),this.focusableElement=null),super.destroy()}}Object(X.d)("CopyPaste",Ge);var I=Ge;function ge(l,t){return"border_row".concat(l,"col").concat(t)}function V(l,t){return{id:ge(l,t),border:{width:1,color:"#000",cornerVisible:!1},row:l,col:t,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}}function q(l,t){var i=!1;return Object(c.arrayEach)(l.getSelectedRange(),a=>{a.forAll((m,b)=>{var H=l.getCellMeta(m,b).borders;if(H&&(!t||!Object(R.hasOwnProperty)(H[t],"hide")||H[t].hide===!1))return i=!0,!1})}),i}function B(l){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(l)}function se(l){return{key:"borders:bottom",name(){var t=this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return q(this,"bottom")&&(t=B(t)),t},callback(t,i){var a=q(this,"bottom");l.prepareBorder(i,"bottom",a),l.render()}}}function ie(l){return{key:"borders:left",name(){var t=this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_BORDERS_LEFT);return q(this,"left")&&(t=B(t)),t},callback(t,i){var a=q(this,"left");l.prepareBorder(i,"left",a),l.render()}}}function Ee(l){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(t,i){l.prepareBorder(i,"noBorders"),l.render()},disabled(){return!q(this)}}}function ye(l){return{key:"borders:right",name(){var t=this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return q(this,"right")&&(t=B(t)),t},callback(t,i){var a=q(this,"right");l.prepareBorder(i,"right",a),l.render()}}}var _e=o(123);class st extends _{constructor(t){super(t),this.savedBorders=[],this.savedBordersById=new Map}isEnabled(){return!!this.hot.getSettings().customBorders}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>this.onAfterContextMenuDefaultOptions(t)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),this.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,i){var a=this,m=i?Object.keys(i):["top","right","bottom","left"],b=Object(_e.b)(t),H=Object(_e.c)(b);Object(c.arrayEach)(t,$=>{for(var[me,Te,Ie,Fe]=H($),Ke=function(et){for(var ae=function(oe){Object(c.arrayEach)(m,ce=>{a.prepareBorderFromCustomAdded(et,oe,i,ce)})},Y=Te;Y<=Fe;Y+=1)ae(Y)},$e=me;$e<=Ie;$e+=1)Ke($e)}),this.render()}render(){this.hot.view.render()}getBorders(t){var i=this;if(!Array.isArray(t))return this.savedBorders;var a=Object(_e.b)(t),m=Object(_e.c)(a),b=[];return Object(c.arrayEach)(t,H=>{for(var[$,me,Te,Ie]=m(H),Fe=function($e){for(var et=function(Y){Object(c.arrayEach)(i.savedBorders,oe=>{oe.row===$e&&oe.col===Y&&b.push(oe)})},ae=me;ae<=Ie;ae+=1)et(ae)},Ke=$;Ke<=Te;Ke+=1)Fe(Ke)}),b}clearBorders(t){t?this.setBorders(t):(Object(c.arrayEach)(this.savedBorders,i=>{this.clearBordersFromSelectionSettings(i.id),this.hot.removeCellMeta(i.row,i.col,"borders")}),this.savedBorders.length=0,this.savedBordersById.clear()),this.render()}insertBorderIntoSettings(t){var i=this.savedBordersById.get(t.id);if(i){var a=this.savedBorders.indexOf(i);this.savedBorders[a]=t}else this.savedBorders.push(t);this.savedBordersById.set(t.id,t);var m={row:t.row,col:t.col},b=new y.b(m,m,m);this.checkCustomSelections(t,b)||this.hot.selection.highlight.addCustomSelection(t.id,{border:t,cellRange:b})}prepareBorderFromCustomAdded(t,i,a,m){var b,H,$=V(t,i);if(a){b=$,H=a,Object(R.hasOwnProperty)(H,"border")&&(b.border=H.border),Object(R.hasOwnProperty)(H,"top")&&(H.top?(Object(R.isObject)(H.top)||(H.top={width:1,color:"#000"}),b.top=H.top):(H.top={hide:!0},b.top=H.top)),Object(R.hasOwnProperty)(H,"right")&&(H.right?(Object(R.isObject)(H.right)||(H.right={width:1,color:"#000"}),b.right=H.right):(H.right={hide:!0},b.right=H.right)),Object(R.hasOwnProperty)(H,"bottom")&&(H.bottom?(Object(R.isObject)(H.bottom)||(H.bottom={width:1,color:"#000"}),b.bottom=H.bottom):(H.bottom={hide:!0},b.bottom=H.bottom)),Object(R.hasOwnProperty)(H,"left")&&(H.left?(Object(R.isObject)(H.left)||(H.left={width:1,color:"#000"}),b.left=H.left):(H.left={hide:!0},b.left=H.left)),$=b;var me=this.hot.selection.highlight.customSelections.get($.id);me&&(Object.assign(me.settings,a),$=me.settings)}this.hot.setCellMeta(t,i,"borders",$),this.insertBorderIntoSettings($,m)}prepareBorderFromCustomAddedRange(t){var i=t.range;Object(C.rangeEach)(i.from.row,i.to.row,a=>{Object(C.rangeEach)(i.from.col,i.to.col,m=>{var b=V(a,m),H=0;a===i.from.row&&Object(R.hasOwnProperty)(t,"top")&&(H+=1,b.top=t.top),a===i.to.row&&Object(R.hasOwnProperty)(t,"bottom")&&(H+=1,b.bottom=t.bottom),m===i.from.col&&Object(R.hasOwnProperty)(t,"left")&&(H+=1,b.left=t.left),m===i.to.col&&Object(R.hasOwnProperty)(t,"right")&&(H+=1,b.right=t.right),H>0&&(this.hot.setCellMeta(a,m,"borders",b),this.insertBorderIntoSettings(b))})})}removeAllBorders(t,i){var a=ge(t,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.hot.removeCellMeta(t,i,"borders")}setBorder(t,i,a,m){var b=this.hot.getCellMeta(t,i).borders;b&&b.border!==void 0||(b=V(t,i)),m?(b[a]={hide:!0},this.areAllEdgesDisabled(b)?this.removeAllBorders(t,i):(this.checkCustomSelectionsFromContextMenu(b,a,m)||this.insertBorderIntoSettings(b),this.hot.setCellMeta(t,i,"borders",b))):(b[a]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(b,a,m)||this.insertBorderIntoSettings(b),this.hot.setCellMeta(t,i,"borders",b))}prepareBorder(t,i,a){Object(c.arrayEach)(t,m=>{var{start:b,end:H}=m;if(b.row===H.row&&b.col===H.col)i==="noBorders"?this.removeAllBorders(b.row,b.col):this.setBorder(b.row,b.col,i,a);else switch(i){case"noBorders":Object(C.rangeEach)(b.col,H.col,$=>{Object(C.rangeEach)(b.row,H.row,me=>{this.removeAllBorders(me,$)})});break;case"top":Object(C.rangeEach)(b.col,H.col,$=>{this.setBorder(b.row,$,i,a)});break;case"right":Object(C.rangeEach)(b.row,H.row,$=>{this.setBorder($,H.col,i,a)});break;case"bottom":Object(C.rangeEach)(b.col,H.col,$=>{this.setBorder(H.row,$,i,a)});break;case"left":Object(C.rangeEach)(b.row,H.row,$=>{this.setBorder($,b.col,i,a)})}})}createCustomBorders(t){Object(c.arrayEach)(t,i=>{i.range?this.prepareBorderFromCustomAddedRange(i):this.prepareBorderFromCustomAdded(i.row,i.col,i)})}areAllEdgesDisabled(t){return!this.isEdgeEnabled(t.left)&&!this.isEdgeEnabled(t.right)&&!this.isEdgeEnabled(t.top)&&!this.isEdgeEnabled(t.bottom)}isEdgeEnabled(t){return t===void 0||t.hide===void 0||!t.hide}clearBordersFromSelectionSettings(t){var i=this.hot.selection.highlight.customSelections.get(t);i&&(i.clear(),this.hot.selection.highlight.customSelections.delete(i.settings.id))}hideBorders(){Object(c.arrayEach)(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id)})}spliceBorder(t){var i=this.savedBordersById.get(t);if(i){var a=this.savedBorders.indexOf(i);this.savedBorders.splice(a,1),this.savedBordersById.delete(t)}}checkCustomSelectionsFromContextMenu(t){return this.hot.selection.highlight.customSelections.has(t.id)}checkCustomSelections(t,i){if(this.areAllEdgesDisabled(t))return this.removeAllBorders(t.row,t.col),!0;var a=this.hot.selection.highlight.customSelections.get(t.id);return!!a&&(a.cellRange=i,!0)}changeBorderSettings(){var t=this.hot.getSettings().customBorders;Array.isArray(t)?(t.length||(this.savedBorders=t),this.createCustomBorders(t)):t!==void 0&&this.createCustomBorders(this.savedBorders)}onAfterContextMenuDefaultOptions(t){var i;this.hot.getSettings().customBorders&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_BORDERS)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[(i=this,{key:"borders:top",name(){var a=this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_BORDERS_TOP);return q(this,"top")&&(a=B(a)),a},callback(a,m){var b=q(this,"top");i.prepareBorder(m,"top",b),i.render()}}),ye(this),se(this),ie(this),Ee(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}Object(X.d)("customBorders",st);var at=st,it=o(57),Xe=o(54);function vt(){var l=Et(["The merged cell declared at [",", ",`] has "rowspan" or "colspan" declared as 
      "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan" or "colspan" declared as\\x20
      "0", which is not supported. It cannot be added to the collection.`]);return vt=function(){return l},l}function lt(){var l=Et(["The merged cell declared at [",", ",`] has both "rowspan" 
     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`]);return lt=function(){return l},l}function yt(){var l=Et(["The merged cell declared at [",", ",`] is positioned (or positioned partially) 
       outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned (or positioned partially)\\x20
       outside of the table range. It was not added to the table, please fix your setup.`]);return yt=function(){return l},l}function Rt(){var l=Et(["The merged cell declared with {row: ",", col: ",`, rowspan: 
    `,", colspan: ",`} contains negative values, which is not supported. It 
    will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`, rowspan:\\x20
    `,", colspan: ",`} contains negative values, which is not supported. It\\x20
    will not be added to the collection.`]);return Rt=function(){return l},l}function Et(l,t){return t||(t=l.slice(0)),Object.freeze(Object.defineProperties(l,{raw:{value:Object.freeze(t)}}))}var rt=class{constructor(l,t,i,a){this.row=l,this.col=t,this.rowspan=i,this.colspan=a,this.removed=!1}static NEGATIVE_VALUES_WARNING(l){return Object(Xe.a)(Rt(),l.row,l.col,l.rowspan,l.colspan)}static IS_OUT_OF_BOUNDS_WARNING(l){return Object(Xe.a)(yt(),l.row,l.col)}static IS_SINGLE_CELL(l){return Object(Xe.a)(lt(),l.row,l.col)}static ZERO_SPAN_WARNING(l){return Object(Xe.a)(vt(),l.row,l.col)}static containsNegativeValues(l){return l.row<0||l.col<0||l.rowspan<0||l.colspan<0}static isSingleCell(l){return l.colspan===1&&l.rowspan===1}static containsZeroSpan(l){return l.colspan===0||l.rowspan===0}static isOutOfBounds(l,t,i){return l.row<0||l.col<0||l.row>=t||l.row+l.rowspan-1>=t||l.col>=i||l.col+l.colspan-1>=i}normalize(l){var t=l.countRows(),i=l.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}includes(l,t){return this.row<=l&&this.col<=t&&this.row+this.rowspan-1>=l&&this.col+this.colspan-1>=t}includesHorizontally(l){return this.col<=l&&this.col+this.colspan-1>=l}includesVertically(l){return this.row<=l&&this.row+this.rowspan-1>=l}shift(l,t){var i=l[0]||l[1],a=t+Math.abs(l[0]||l[1])-1,m=l[0]?"colspan":"rowspan",b=l[0]?"col":"row",H=Math.min(t,a),$=Math.max(t,a),me=this[b],Te=this[b]+this[m]-1;if(me>=t&&(this[b]+=i),i>0)t<=Te&&t>me&&(this[m]+=i);else if(i<0){if(H<=me&&$>=Te)return this.removed=!0,!1;if(me>=H&&me<=$){var Ie=$-me+1,Fe=Math.abs(i)-Ie;this[b]-=Fe+i,this[m]-=Ie}else if(me<=H&&Te>=$)this[m]+=i;else if(me<=H&&Te>=H&&Te<$){var Ke=Te-H+1;this[m]-=Ke}}return!0}isFarther(l,t){return!l||(t==="down"?l.row+l.rowspan-1<this.row+this.rowspan-1:t==="up"?l.row>this.row:t==="right"?l.col+l.colspan-1<this.col+this.colspan-1:t==="left"?l.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return new y.b(new y.a(this.row,this.col),new y.a(this.row,this.col),new y.a(this.getLastRow(),this.getLastColumn()))}},Mt=o(60);function g(l,t,i,a){t?t.row===i&&t.col===a?(l.setAttribute("rowspan",t.rowspan.toString()),l.setAttribute("colspan",t.colspan.toString())):(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="none"):(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")}function v(){var l=function(t,i){return i||(i=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(i)}}))}(["The merged cell declared at [",", ",`], overlaps with the other declared merged 
    cell. The overlapping merged cell was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`], overlaps with the other declared merged\\x20
    cell. The overlapping merged cell was not added to the table, please fix your setup.`]);return v=function(){return l},l}class F{constructor(t){this.plugin=t,this.mergedCells=[],this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return Object(Xe.a)(v(),t.row,t.col)}get(t,i){var a=this.mergedCells,m=!1;return Object(c.arrayEach)(a,b=>!(b.row<=t&&b.row+b.rowspan-1>=t&&b.col<=i&&b.col+b.colspan-1>=i)||(m=b,!1)),m}getByRange(t){var i=this.mergedCells,a=!1;return Object(c.arrayEach)(i,m=>!(m.row<=t.from.row&&m.row+m.rowspan-1>=t.to.row&&m.col<=t.from.col&&m.col+m.colspan-1>=t.to.col)||(a=m)),a}getWithinRange(t){var i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=this.mergedCells,m=[],b=t;if(!b.includesRange){var H=new y.a(b.from.row,b.from.col),$=new y.a(b.to.row,b.to.col);b=new y.b(H,H,$)}return Object(c.arrayEach)(a,me=>{var Te=new y.a(me.row,me.col),Ie=new y.a(me.row+me.rowspan-1,me.col+me.colspan-1),Fe=new y.b(Te,Te,Ie);i?b.overlaps(Fe)&&m.push(me):b.includesRange(Fe)&&m.push(me)}),!!m.length&&m}add(t){var i=this.mergedCells,a=t.row,m=t.col,b=t.rowspan,H=t.colspan,$=new rt(a,m,b,H),me=this.get(a,m),Te=this.isOverlapping($);return me||Te?(Object(Mt.b)(F.IS_OVERLAPPING_WARNING($)),!1):(this.hot&&$.normalize(this.hot),i.push($),$)}remove(t,i){var a=this.mergedCells,m=this.get(t,i),b=m?this.mergedCells.indexOf(m):null;return!(!m||b===!1)&&(a.splice(b,1),m)}clear(){var t=this.mergedCells,i=[],a=[];Object(c.arrayEach)(t,m=>{var b=this.hot.getCell(m.row,m.col);b&&i.push([b,this.get(m.row,m.col),m.row,m.col])}),this.mergedCells.length=0,Object(c.arrayEach)(i,(m,b)=>{Object(C.rangeEach)(0,m.rowspan-1,H=>{Object(C.rangeEach)(0,m.colspan-1,$=>{if($!==0||H!==0){var me=this.hot.getCell(m.row+H,m.col+$);me&&a.push([me,null,null,null])}})}),i[b][1]=null}),Object(c.arrayEach)(i,m=>{g(...m)}),Object(c.arrayEach)(a,m=>{g(...m)})}isOverlapping(t){var i=new y.b(null,new y.a(t.row,t.col),new y.a(t.row+t.rowspan-1,t.col+t.colspan-1)),a=!1;return Object(c.arrayEach)(this.mergedCells,m=>!new y.b(null,new y.a(m.row,m.col),new y.a(m.row+m.rowspan-1,m.col+m.colspan-1)).overlaps(i)||(a=!0,!1)),a}isMergedParent(t,i){var a=this.mergedCells,m=!1;return Object(c.arrayEach)(a,b=>b.row!==t||b.col!==i||(m=!0,!1)),m}shiftCollections(t,i,a){var m=[0,0];switch(t){case"right":m[0]+=a;break;case"left":m[0]-=a;break;case"down":m[1]+=a;break;case"up":m[1]-=a}Object(c.arrayEach)(this.mergedCells,b=>{b.shift(m,i)}),Object(C.rangeEachReverse)(this.mergedCells.length-1,0,b=>{var H=this.mergedCells[b];H&&H.removed&&this.mergedCells.splice(this.mergedCells.indexOf(H),1)})}}var re=F,le=class{constructor(l){this.plugin=l,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(l){if(l[0]===l[2]&&l[1]===l[3]){var t=this.mergedCellsCollection.get(l[0],l[1]);t&&(l[2]=l[0]+t.rowspan-1,l[3]=l[1]+t.colspan-1)}}getDirection(l,t){return t[0]===l[0]&&t[1]===l[1]&&t[3]===l[3]?"down":t[2]===l[2]&&t[1]===l[1]&&t[3]===l[3]?"up":t[1]===l[1]&&t[2]===l[2]?"right":"left"}snapDragArea(l,t,i,a){var m=t.slice(0),b=this.getAutofillSize(l,t,i),[H,$,me,Te]=l,Ie=["up","down"].indexOf(i)>-1?me-H+1:Te-$+1,Fe=b-Math.floor(b/Ie)*Ie,Ke=this.getFarthestCollection(l,t,i,a);if(Ke){if(i==="down"){var $e=Ke.row+Ke.rowspan-H-Fe;m[2]+$e>=this.plugin.hot.countRows()?m[2]-=Fe:m[2]+=Fe?$e:0}else if(i==="right"){var et=Ke.col+Ke.colspan-$-Fe;m[3]+et>=this.plugin.hot.countCols()?m[3]-=Fe:m[3]+=Fe?et:0}else if(i==="up"){var ae=me-Fe-Ke.row+1;m[0]+ae<0?m[0]+=Fe:m[0]-=Fe?ae:0}else if(i==="left"){var Y=Te-Fe-Ke.col+1;m[1]+Y<0?m[1]+=Fe:m[1]-=Fe?Y:0}}return this.updateCurrentFillCache({baseArea:l,dragDirection:i,foundMergedCells:a,fillSize:b,dragArea:m,cycleLength:Ie}),m}updateCurrentFillCache(l){this.currentFillData||(this.currentFillData={}),Object(R.extend)(this.currentFillData,l)}getAutofillSize(l,t,i){var[a,m,b,H]=l,[$,me,Te,Ie]=t;switch(i){case"up":return a-$;case"down":return Te-b;case"left":return m-me;case"right":return Ie-H;default:return null}}getDragArea(l,t,i){var[a,m,b,H]=l,[$,me,Te,Ie]=t;switch(i){case"up":return[$,me,a-1,H];case"down":return[b+1,m,Te,H];case"left":return[$,me,b,m-1];case"right":return[a,H+1,Te,Ie];default:return null}}getFarthestCollection(l,t,i,a){var[m,b,H,$]=l,me=["up","down"].indexOf(i)>-1,Te=me?H:$,Ie=me?m:b,Fe=this.getAutofillSize(l,t,i),Ke=me?H-m+1:$-b+1,$e=Fe-Math.floor(Fe/Ke)*Ke,et=null,ae=null,Y=null;switch(i){case"up":et="includesVertically",Y=Te-$e+1;break;case"left":et="includesHorizontally",Y=Te-$e+1;break;case"down":et="includesVertically",Y=Ie+$e-1;break;case"right":et="includesHorizontally",Y=Ie+$e-1}return Object(c.arrayEach)(a,oe=>{oe[et](Y)&&oe.isFarther(ae,i)&&(ae=oe)}),ae}recreateAfterDataPopulation(l){if(this.currentFillData){var t=this.getRangeFromChanges(l),i=this.currentFillData.foundMergedCells,a=this.currentFillData.dragDirection,m=(Te,Ie)=>{switch(a){case"up":return Te.row-Ie>=t.from.row;case"down":return Te.row+Te.rowspan-1+Ie<=t.to.row;case"left":return Te.col-Ie>=t.from.column;case"right":return Te.col+Te.colspan-1+Ie<=t.to.column;default:return null}},b=0,H=null,$=1;do for(var me=0;me<i.length;me+=1){if(m(H=i[me],b=$*this.currentFillData.cycleLength))switch(a){case"up":this.plugin.mergedCellsCollection.add({row:H.row-b,rowspan:H.rowspan,col:H.col,colspan:H.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:H.row+b,rowspan:H.rowspan,col:H.col,colspan:H.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:H.row,rowspan:H.rowspan,col:H.col-b,colspan:H.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:H.row,rowspan:H.rowspan,col:H.col+b,colspan:H.colspan})}me===i.length-1&&($+=1)}while(m(H,b));this.currentFillData=null,this.plugin.hot.render()}}getRangeFromChanges(l){var t={min:null,max:null},i={min:null,max:null};return Object(c.arrayEach)(l,a=>{var m=a[0],b=this.plugin.hot.propToCol(a[1]);(t.min===null||m<t.min)&&(t.min=m),(t.max===null||m>t.max)&&(t.max=m),(i.min===null||b<i.min)&&(i.min=b),(i.max===null||b>i.max)&&(i.max=b)}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}dragAreaOverlapsCollections(l,t,i){var a=this.getDragArea(l,t,i),[m,b,H,$]=a,me=new y.a(m,b),Te=new y.a(H,$),Ie=new y.b(me,me,Te);return!!this.mergedCellsCollection.getWithinRange(Ie,!0)}},fe=class{constructor(l){this.plugin=l,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(l,t,i){var a=t.to,m=a.row+l.row,b=a.col+l.col;l.row?this.jumpOverMergedCell(l,i,m):l.col&&this.jumpOverMergedCell(l,i,b)}jumpOverMergedCell(l,t,i){var a=l.row||l.col,m=null,b=null,H=null;l.row?(m=t.includesVertically(i),b=t.row,H=t.getLastRow()):l.col&&(m=t.includesHorizontally(i),b=t.col,H=t.getLastColumn()),a!==0&&(a>0?m&&i!==b&&(a+=H-i+1):m&&i!==H&&(a-=i-b+1),l.row?l.row=a:l.col&&(l.col=a))}getUpdatedSelectionRange(l,t){return new y.b(l.highlight,l.from,new y.a(l.to.row+t.row,l.to.col+t.col))}getSelectedMergedCellClassName(l,t,i,a){var[m,b,H,$]=i;if(a!==void 0&&l>=m&&l<=H&&t>=b&&t<=$){if(!this.plugin.mergedCellsCollection.isMergedParent(l,t))return;var me=this.plugin.mergedCellsCollection.get(l,t);if(!me)return;if(me.row+me.rowspan-1<=H&&me.col+me.colspan-1<=$)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(a);if(this.plugin.selectionCalculations.isMergeCellFullySelected(me,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}isMergeCellFullySelected(l,t){var i=[];if(!t||!l)return!1;for(var a=0;a<l.rowspan;a+=1)for(var m=0;m<l.colspan;m+=1)i.push(new y.a(l.row+a,l.col+m));for(var b=0;b<i.length;b+=1){for(var H=[],$=0;$<t.length;$+=1)H[$]=t[$].includes(i[b]);if(!H.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){for(var l=[],t=0;t<=7;t+=1)l.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(t));return l.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),l}};W.a.getSingleton().register("beforeMergeCells"),W.a.getSingleton().register("afterMergeCells"),W.a.getSingleton().register("beforeUnmergeCells"),W.a.getSingleton().register("afterUnmergeCells");var Se=new WeakMap;class ve extends _{constructor(t){super(t),Se.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings().mergeCells}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new re(this),this.autofillCalculations=new le(this),this.selectionCalculations=new fe(this),this.addHook("afterInit",function(){return t.onAfterInit(...arguments)}),this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown(...arguments)}),this.addHook("modifyTransformStart",function(){return t.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return t.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return t.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return t.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return t.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return t.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return t.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return t.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return t.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return t.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return t.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return t.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return t.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return t.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return t.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return t.onBeforeRemoveCellClassNames(...arguments)}),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.hot.render(),super.disablePlugin()}updatePlugin(){var t=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}validateSetting(t){var i=!0;return!!t&&(rt.containsNegativeValues(t)?(Object(Mt.b)(rt.NEGATIVE_VALUES_WARNING(t)),i=!1):rt.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Object(Mt.b)(rt.IS_OUT_OF_BOUNDS_WARNING(t)),i=!1):rt.isSingleCell(t)?(Object(Mt.b)(rt.IS_SINGLE_CELL(t)),i=!1):rt.containsZeroSpan(t)&&(Object(Mt.b)(rt.ZERO_SPAN_WARNING(t)),i=!1),i)}generateFromSettings(t){if(Array.isArray(t)){var i=[];Object(c.arrayEach)(t,m=>{if(this.validateSetting(m)){var b=new y.a(m.row,m.col),H=new y.a(m.row+m.rowspan-1,m.col+m.colspan-1),$=new y.b(b,b,H);i.push(this.mergeRange($,!0,!0))}}),i=i.filter(m=>m!==!0);var a=this.getBulkCollectionData(i);this.hot.populateFromArray(...a)}}getBulkCollectionData(t){var i=this.getBulkCollectionDataRange(t),a=this.hot.getData(...i).splice(0);return Object(c.arrayEach)(t,m=>{var[b,H,$]=m;Object(c.arrayEach)($,(me,Te)=>{Object(c.arrayEach)(me,(Ie,Fe)=>{a[b-i[0]+Te][H-i[1]+Fe]=Ie})})}),[i[0],i[1],a]}getBulkCollectionDataRange(t){var i=[0,0],a=[0,0],m=null,b=null,H=null;return Object(c.arrayEach)(t,$=>{m=$[0],b=$[1],H=$[2],i[0]=Math.min(m,i[0]),i[1]=Math.min(b,i[1]),a[0]=Math.max(m+H.length-1,a[0]),a[1]=Math.max(b+H[0].length-1,a[1])}),[...i,...a]}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){return!!(arguments.length>1&&arguments[1]!==void 0&&arguments[1])||this.validateSetting(t)}toggleMergeOnSelection(){var t=this.hot.getSelectedRangeLast();if(t){t.setDirection("NW-SE");var{from:i,to:a}=t;this.toggleMerge(t),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}mergeSelection(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(t){t.setDirection("NW-SE");var{from:i,to:a}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}unmergeSelection(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(t){var{from:i,to:a}=t;this.unmergeRange(t,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}mergeRange(t){var i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],m=t.getTopLeftCorner(),b=t.getBottomRightCorner(),H={row:m.row,col:m.col,rowspan:b.row-m.row+1,colspan:b.col-m.col+1},$=[],me=null;return!!this.canMergeRange(H,i)&&(this.hot.runHooks("beforeMergeCells",t,i),Object(C.rangeEach)(0,H.rowspan-1,Te=>{Object(C.rangeEach)(0,H.colspan-1,Ie=>{var Fe=null;$[Te]||($[Te]=[]),Te===0&&Ie===0?Fe=this.hot.getDataAtCell(H.row,H.col):this.hot.setCellMeta(H.row+Te,H.col+Ie,"hidden",!0),$[Te][Ie]=Fe})}),this.hot.setCellMeta(H.row,H.col,"spanned",!0),!this.mergedCellsCollection.add(H)||(a?me=[H.row,H.col,$]:this.hot.populateFromArray(H.row,H.col,$,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",t,H,i),me))}unmergeRange(t){var i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=this.mergedCellsCollection.getWithinRange(t);a&&(this.hot.runHooks("beforeUnmergeCells",t,i),Object(c.arrayEach)(a,m=>{this.mergedCellsCollection.remove(m.row,m.col),Object(C.rangeEach)(0,m.rowspan-1,b=>{Object(C.rangeEach)(0,m.colspan-1,H=>{this.hot.removeCellMeta(m.row+b,m.col+H,"hidden")})}),this.hot.removeCellMeta(m.row,m.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",t,i),this.hot.render())}toggleMerge(t){var i=this.mergedCellsCollection.get(t.from.row,t.from.col);i.row===t.from.row&&i.col===t.from.col&&i.row+i.rowspan-1===t.to.row&&i.col+i.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}merge(t,i,a,m){var b=new y.a(t,i),H=new y.a(a,m);this.mergeRange(new y.b(b,b,H))}unmerge(t,i,a,m){var b=new y.a(t,i),H=new y.a(a,m);this.unmergeRange(new y.b(b,b,H))}onAfterInit(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}onBeforeKeyDown(t){(t.ctrlKey||t.metaKey)&&!t.altKey&&t.keyCode===77&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),Object(it.stopImmediatePropagation)(t))}onAfterIsMultipleSelection(t){if(t){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),m=0;m<i.length;m+=1)if(a.highlight.row===i[m].row&&a.highlight.col===i[m].col&&a.to.row===i[m].row+i[m].rowspan-1&&a.to.col===i[m].col+i[m].colspan-1)return!1}return t}onModifyTransformStart(t){var i,a=Se.get(this),m=this.hot.getSelectedRangeLast(),b={row:t.row,col:t.col},H=new y.a(m.highlight.row,m.highlight.col),$=this.mergedCellsCollection.get(H.row,H.col);if(a.lastDesiredCoords||(a.lastDesiredCoords=new y.a(null,null)),$){var me=new y.a($.row,$.col),Te=new y.a($.row+$.rowspan-1,$.col+$.colspan-1);new y.b(me,me,Te).includes(a.lastDesiredCoords)||(a.lastDesiredCoords=new y.a(null,null)),b.row=a.lastDesiredCoords.row?a.lastDesiredCoords.row-H.row:b.row,b.col=a.lastDesiredCoords.col?a.lastDesiredCoords.col-H.col:b.col,t.row>0?b.row=$.row+$.rowspan-1-H.row+t.row:t.row<0&&(b.row=H.row-$.row+t.row),t.col>0?b.col=$.col+$.colspan-1-H.col+t.col:t.col<0&&(b.col=H.col-$.col+t.col)}i=new y.a(m.highlight.row+b.row,m.highlight.col+b.col);var Ie=this.mergedCellsCollection.get(i.row,i.col);Ie&&(a.lastDesiredCoords=i,b={row:Ie.row-H.row,col:Ie.col-H.col}),b.row!==0&&(t.row=b.row),b.col!==0&&(t.col=b.col)}onModifyTransformEnd(t){var i=this.hot.getSelectedRangeLast(),a=Object(R.clone)(t),m=this.selectionCalculations.getUpdatedSelectionRange(i,t),b=Object(R.clone)(a),H=this.mergedCellsCollection.getWithinRange(m,!0);do b=Object(R.clone)(a),this.selectionCalculations.getUpdatedSelectionRange(i,a),Object(c.arrayEach)(H,$=>{this.selectionCalculations.snapDelta(a,i,$)});while(a.row!==b.row||a.col!==b.col);t.row=a.row,t.col=a.col}onModifyGetCellCoords(t,i){if(!(t<0||i<0)){var a=this.mergedCellsCollection.get(t,i);if(a){var{row:m,col:b,colspan:H,rowspan:$}=a;return[...this.translateMergedCellToRenderable(m,0,b,0),...this.translateMergedCellToRenderable(m,$,b,H)]}}}addMergeActionsToContextMenu(t){var i;t.items.push({name:"---------"},(i=this,{key:"mergeCells",name(){var a=this.getSelectedLast();if(a){var m=i.mergedCellsCollection.get(a[0],a[1]);if(m.row===a[0]&&m.col===a[1]&&m.row+m.rowspan-1===a[2]&&m.col+m.colspan-1===a[3])return this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(O.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){i.toggleMergeOnSelection()},disabled(){var a=this.getSelectedLast();return!a||rt.isSingleCell({row:a[0],col:a[1],rowspan:a[2]-a[0]+1,colspan:a[3]-a[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}onAfterRenderer(t,i,a){var m=this.mergedCellsCollection.get(i,a),b=Object(R.isObject)(m)?Object(R.clone)(m):void 0;if(Object(R.isObject)(b)){var{rowIndexMapper:H,columnIndexMapper:$}=this.hot,{row:me,col:Te,colspan:Ie,rowspan:Fe}=b,[Ke,$e]=this.translateMergedCellToRenderable(me,Fe,Te,Ie),et=Ke-H.getRenderableFromVisualIndex(i)+1,ae=$e-$.getRenderableFromVisualIndex(a)+1;b.row=H.getFirstNotHiddenIndex(b.row,1),b.col=$.getFirstNotHiddenIndex(b.col,1),b.rowspan=Math.min(b.rowspan,et),b.colspan=Math.min(b.colspan,ae)}g(t,b,i,a)}onBeforeSetRangeEnd(t){var i=this.hot.getSelectedRangeLast();i.highlight=new y.a(i.highlight.row,i.highlight.col),i.to=t;var a=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{a=!1;for(var m=0;m<this.mergedCellsCollection.mergedCells.length;m+=1){var b=this.mergedCellsCollection.mergedCells[m].getRange();i.expandByRange(b)&&(t.row=i.to.row,t.col=i.to.col,a=!0)}}while(a)}onAfterGetCellMeta(t,i,a){var m=this.mergedCellsCollection.get(t,i);m&&(m.row!==t||m.col!==i?a.copyable=!1:(a.rowspan=m.rowspan,a.colspan=m.colspan))}onAfterViewportRowCalculatorOverride(t){var i=this.hot.countCols();this.modifyViewportRowStart(t,i),this.modifyViewportRowEnd(t,i)}modifyViewportRowStart(t,i){for(var a=this.hot.rowIndexMapper,m=a.getVisualFromRenderableIndex(t.startRow),b=0;b<i;b+=1){var H=this.mergedCellsCollection.get(m,b);if(Object(R.isObject)(H)){var $=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(H.row,1));if($<t.startRow)return t.startRow=$,void this.modifyViewportRowStart(t,i)}}}modifyViewportRowEnd(t,i){for(var a=this.hot.rowIndexMapper,m=a.getVisualFromRenderableIndex(t.endRow),b=0;b<i;b+=1){var H=this.mergedCellsCollection.get(m,b);if(Object(R.isObject)(H)){var $=H.row+H.rowspan-1,me=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex($,-1));if(me>t.endRow)return t.endRow=me,void this.modifyViewportRowEnd(t,i)}}}onAfterViewportColumnCalculatorOverride(t){var i=this.hot.countRows();this.modifyViewportColumnStart(t,i),this.modifyViewportColumnEnd(t,i)}modifyViewportColumnStart(t,i){for(var a=this.hot.columnIndexMapper,m=a.getVisualFromRenderableIndex(t.startColumn),b=0;b<i;b+=1){var H=this.mergedCellsCollection.get(b,m);if(Object(R.isObject)(H)){var $=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(H.col,1));if($<t.startColumn)return t.startColumn=$,void this.modifyViewportColumnStart(t,i)}}}modifyViewportColumnEnd(t,i){for(var a=this.hot.columnIndexMapper,m=a.getVisualFromRenderableIndex(t.endColumn),b=0;b<i;b+=1){var H=this.mergedCellsCollection.get(b,m);if(Object(R.isObject)(H)){var $=H.col+H.colspan-1,me=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex($,-1));if(me>t.endColumn)return t.endColumn=me,void this.modifyViewportColumnEnd(t,i)}}}translateMergedCellToRenderable(t,i,a,m){var b,H,{rowIndexMapper:$,columnIndexMapper:me}=this.hot;return b=i===0?$.getFirstNotHiddenIndex(t,1):$.getFirstNotHiddenIndex(t+i-1,-1),H=m===0?me.getFirstNotHiddenIndex(a,1):me.getFirstNotHiddenIndex(a+m-1,-1),[t>=0?$.getRenderableFromVisualIndex(b):t,a>=0?me.getRenderableFromVisualIndex(H):a]}onModifyAutofillRange(t,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,t),m=t;if(this.autofillCalculations.dragAreaOverlapsCollections(i,m,a))return m=i;var b=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return b?m=this.autofillCalculations.snapDragArea(i,m,a,b):m}onAfterCreateCol(t,i){this.mergedCellsCollection.shiftCollections("right",t,i)}onAfterRemoveCol(t,i){this.mergedCellsCollection.shiftCollections("left",t,i)}onAfterCreateRow(t,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,i)}onAfterRemoveRow(t,i){this.mergedCellsCollection.shiftCollections("up",t,i)}onAfterChange(t,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}onBeforeDrawAreaBorders(t,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),m=this.mergedCellsCollection.getWithinRange(a);Object(c.arrayEach)(m,b=>{a.getBottomRightCorner().row===b.getLastRow()&&a.getBottomRightCorner().col===b.getLastColumn()&&(t[2]=b.row,t[3]=b.col)})}}onAfterModifyTransformStart(t,i,a){if(this.enabled){var m=this.mergedCellsCollection.get(t.row,t.col);if(m){var b=i>0,H=i<0,$=a<0,me=a>0,Te=m.row+m.rowspan-1==this.hot.countRows()-1,Ie=m.row===0,Fe=m.col+m.colspan-1==this.hot.countCols()-1,Ke=m.col===0;(b&&Te||H&&Ie||me&&Fe||$&&Ke)&&(t.row=m.row,t.col=m.col)}}}onAfterDrawSelection(t,i,a,m){return this.selectionCalculations.getSelectedMergedCellClassName(t,i,a,m)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}Object(X.d)("mergeCells",ve);var He=ve;class Re extends _{constructor(t){super(t),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return Object(f.isTouchSupported)()}enablePlugin(){this.enabled||(this.addHook("afterRender",()=>this.onAfterRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterRender(){if(!this.lockedCollection){var{topOverlay:t,bottomOverlay:i,leftOverlay:a,topLeftCornerOverlay:m,bottomLeftCornerOverlay:b}=this.hot.view.wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),i.clone&&this.scrollbars.push(i),this.scrollbars.push(a),m&&this.scrollbars.push(m),b&&b.clone&&this.scrollbars.push(b),this.clones.length=0,t.needFullRender&&this.clones.push(t.clone.wtTable.wtRootElement),i.needFullRender&&this.clones.push(i.clone.wtTable.wtRootElement),a.needFullRender&&this.clones.push(a.clone.wtTable.wtRootElement),m&&this.clones.push(m.clone.wtTable.wtRootElement),b&&b.clone&&this.clones.push(b.clone.wtTable.wtRootElement)}}onBeforeTouchScroll(){this.freezeOverlays=!0,Object(c.arrayEach)(this.clones,t=>{Object(k.addClass)(t,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,Object(c.arrayEach)(this.clones,t=>{Object(k.removeClass)(t,"hide-tween"),Object(k.addClass)(t,"show-tween")}),setTimeout(()=>{Object(c.arrayEach)(this.clones,t=>{Object(k.removeClass)(t,"show-tween")})},400),Object(c.arrayEach)(this.scrollbars,t=>{t.redrawClone(),t.adjustElementsPosition()}),this.hot.view.wt.wtOverlays.propagateMasterScrollPositionsToClones()}}Object(X.d)("touchScroll",Re);var L=Re},function(De,d,o){"use strict";var R=o(38),c=o(74),X=o(57),w=o(87),x=o(43),_=o(40),f=o(32),S=o(33),C={_hooksStorage:Object.create(null),addHook(k,T){return this._hooksStorage[k]||(this._hooksStorage[k]=[]),this.hot.addHook(k,T),this._hooksStorage[k].push(T),this},removeHooksByKey(k){Object(S.arrayEach)(this._hooksStorage[k]||[],T=>{this.hot.removeHook(k,T)})},clearHooks(){Object(f.objectEach)(this._hooksStorage,(k,T)=>this.removeHooksByKey(T)),this._hooksStorage={}}};Object(f.defineGetter)(C,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var N=C,h="STATE_VIRGIN",E="STATE_EDITING",M="STATE_WAITING",y="STATE_FINISHED";class z{constructor(T){this.hot=T,this.instance=T,this.state=h,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(T){this._closeCallback&&(this._closeCallback(T),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(T,G,W,P,Q,O){this.TD=P,this.row=T,this.col=G,this.prop=W,this.originalValue=Q,this.cellProperties=O,this.state=h}extend(){return class extends this.constructor{}}saveValue(T,G){var W,P;G?((W=this.hot.getSelectedLast())[0]>W[2]&&(P=W[0],W[0]=W[2],W[2]=P),W[1]>W[3]&&(P=W[1],W[1]=W[3],W[3]=P)):W=[this.row,this.col,null,null],this.hot.populateFromArray(W[0],W[1],T,W[2],W[3],"edit")}beginEditing(T,G){if(this.state===h){if(this.hot.view.scrollViewport(new R.a(this.row,this.col)),this.state=E,this.isInFullEditMode()){var W=typeof T=="string"?T:Object(_.stringify)(this.originalValue);this.setValue(W)}this.open(G),this._opened=!0,this.focus(),this.hot.view.render(),this.hot.runHooks("afterBeginEditing",this.row,this.col)}}finishEditing(T,G,W){var P;if(W){var Q=this._closeCallback;this._closeCallback=A=>{Q&&Q(A),W(A),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==h){if(this.state===E){if(T)return this.cancelChanges(),void this.hot.view.render();var O=this.getValue();P=this.hot.getSettings().trimWhitespace?[[typeof O=="string"?String.prototype.trim.call(O||""):O]]:[[O]],this.state=M,this.saveValue(P,G),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",A=>{this.state=y,this.discardEditor(A)}):(this.state=y,this.discardEditor(!0))}}else this.hot._registerTimeout(()=>{this._fireCallbacks(!0)})}cancelChanges(){this.state=y,this.discardEditor()}discardEditor(T){this.state===y&&(T===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=E,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=h,this._fireCallbacks(!0)))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===M}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){var T=this.hot.countRows(),G="";return this.row<this.hot.getSettings().fixedRowsTop?G=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=T-this.hot.getSettings().fixedRowsBottom?G=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(G="left"),G}}Object(f.mixin)(z,N);var U=o(34);class te{constructor(T,G,W){this.instance=T,this.tableMeta=G,this.selection=W,this.eventManager=new x.a(T),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",Q=>this.onAfterDocumentKeyDown(Q));for(var P=this.instance.rootWindow;P;)this.eventManager.addEventListener(P.document.documentElement,"keydown",Q=>{this.destroyed||this.instance.runHooks("afterDocumentKeyDown",Q)}),P=Object(U.getParentWindow)(P);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",Q=>{!this.destroyed&&this.activeEditor&&!this.activeEditor.isOpened()&&this.instance.isListening()&&this.openEditor("",Q)}),this.instance.view.wt.update("onCellDblClick",(Q,O,A)=>this.onCellDblClick(Q,O,A))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(T){this.lock||this.closeEditor(T)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,Z=>{Z&&this.prepareEditor()});else{var{row:T,col:G}=this.instance.selection.selectedRange.current().highlight;this.cellProperties=this.instance.getCellMeta(T,G);var{activeElement:W}=this.instance.rootDocument;if(W&&W.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var P=this.instance.getCellEditor(this.cellProperties),Q=this.instance.getCell(T,G,!0);if(P&&Q){var O=this.instance.colToProp(G),A=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(T),G);this.activeEditor=Object(w.b)(P,this.instance),this.activeEditor.prepare(T,G,O,Q,A,this.cellProperties)}else this.clearActiveEditor()}}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(T,G){this.activeEditor&&this.activeEditor.beginEditing(T,G)}closeEditor(T,G,W){this.activeEditor?this.activeEditor.finishEditing(T,G,W):W&&W(!1)}closeEditorAndSaveChanges(T){this.closeEditor(!1,T)}closeEditorAndRestoreOriginalValue(T){this.closeEditor(!0,T)}clearActiveEditor(){this.activeEditor=void 0}moveSelectionAfterEnter(T){var G=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;T?this.selection.transformStart(-G.row,-G.col):this.selection.transformStart(G.row,G.col,!0)}moveSelectionUp(T){T?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}moveSelectionDown(T){T?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}moveSelectionRight(T){T?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}moveSelectionLeft(T){T?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}onAfterDocumentKeyDown(T){if(this.instance.isListening()&&(this.instance.runHooks("beforeKeyDown",T),!this.destroyed&&T.keyCode!==229&&!Object(X.isImmediatePropagationStopped)(T)&&(this.lastKeyCode=T.keyCode,this.selection.isSelected()))){var G=(T.ctrlKey||T.metaKey)&&!T.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||Object(c.isMetaKey)(T.keyCode)||Object(c.isCtrlMetaKey)(T.keyCode)||G||this.isEditorOpened()){var W,P=T.shiftKey,Q=P?this.selection.setRangeEnd:this.selection.setRangeStart;switch(T.keyCode){case c.KEY_CODES.A:!this.isEditorOpened()&&G&&(this.instance.selectAll(),T.preventDefault(),T.stopPropagation());break;case c.KEY_CODES.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(G),this.moveSelectionUp(P),T.preventDefault(),T.stopPropagation();break;case c.KEY_CODES.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(G),this.moveSelectionDown(P),T.preventDefault(),T.stopPropagation();break;case c.KEY_CODES.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(G),this.moveSelectionRight(P),T.preventDefault(),T.stopPropagation();break;case c.KEY_CODES.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(G),this.moveSelectionLeft(P),T.preventDefault(),T.stopPropagation();break;case c.KEY_CODES.TAB:W=typeof this.tableMeta.tabMoves=="function"?this.tableMeta.tabMoves(T):this.tableMeta.tabMoves,P?this.selection.transformStart(-W.row,-W.col):this.selection.transformStart(W.row,W.col,!0),T.preventDefault(),T.stopPropagation();break;case c.KEY_CODES.BACKSPACE:case c.KEY_CODES.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),T.preventDefault();break;case c.KEY_CODES.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,T),T.preventDefault();break;case c.KEY_CODES.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==M&&this.closeEditorAndSaveChanges(G),this.moveSelectionAfterEnter(P)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,T)):this.moveSelectionAfterEnter(P),T.preventDefault(),Object(X.stopImmediatePropagation)(T);break;case c.KEY_CODES.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(G),this.activeEditor.focus()),T.preventDefault();break;case c.KEY_CODES.HOME:T.ctrlKey||T.metaKey?Q.call(this.selection,new R.a(0,this.selection.selectedRange.current().from.col)):Q.call(this.selection,new R.a(this.selection.selectedRange.current().from.row,0)),T.preventDefault(),T.stopPropagation();break;case c.KEY_CODES.END:T.ctrlKey||T.metaKey?Q.call(this.selection,new R.a(this.instance.countRows()-1,this.selection.selectedRange.current().from.col)):Q.call(this.selection,new R.a(this.selection.selectedRange.current().from.row,this.instance.countCols()-1)),T.preventDefault(),T.stopPropagation();break;case c.KEY_CODES.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),T.preventDefault(),T.stopPropagation();break;case c.KEY_CODES.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),T.preventDefault(),T.stopPropagation()}}else this.openEditor("",T)}}onCellDblClick(T,G,W){W.nodeName==="TD"&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,T))}destroy(){this.destroyed=!0,this.eventManager.destroy()}}var D=new WeakMap;te.getInstance=function(k,T,G){var W=D.get(k);return W||(W=new te(k,T,G),D.set(k,W)),W},d.a=te},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(De,d,o){"use strict";o.r(d);var R=o(1),c=o.n(R),X=()=>c.a.createElement("div",{className:"developer-screen"},c.a.createElement("h1",{className:"developer-screen--title"},"Handsontable Spreadsheet Viewer"),c.a.createElement("p",null,"Hello, developer!"),c.a.createElement("p",null,"This app is intended to be run:"),c.a.createElement("ul",null,c.a.createElement("li",null,"with URL parameters, as explained in"," ",c.a.createElement("a",{href:"https://github.com/handsontable/spreadsheet-viewer/wiki/Query-String-API",target:"_blank",rel:"noopener noreferrer"},"Query String API")),c.a.createElement("li",null,"or, in an iframe driven by asynchronous messages, as explained in"," ",c.a.createElement("a",{href:"https://github.com/handsontable/spreadsheet-viewer/wiki/JavaScript-API",target:"_blank",rel:"noopener noreferrer"},"JavaScript API")))),w=o(14),x=o(82),_=o(136),f=o(3),S=o(7),C=o(15),N=o(8),h=o(73);class E extends h.a.plugins.BasePlugin{constructor(Y){super(Y),this.floatingBoxSettings=[],this.floatingBoxMeta=new WeakMap,this.isFirstRender=!0,this.floatingBoxSettings=[],this.floatingBoxMeta=new WeakMap,this.resetState()}resetState(){this.floatingBoxSettings=[],this.floatingBoxMeta=new WeakMap}getExtendedHotSettings(){return this.hot.getSettings()}isEnabled(){return!!this.getExtendedHotSettings().floatingBox}enablePlugin(){this.enabled||(this.addHook("afterLoadData",this.afterLoadData.bind(this)),this.addHook("afterUpdateSettings",this.afterUpdateSettings.bind(this)),this.addHook("afterRenderer",this.afterRenderer.bind(this)),this.addHook("beforeRender",this.beforeRender.bind(this)),this.addHook("afterRender",this.afterRender.bind(this)),super.enablePlugin())}disablePlugin(){this.resetState(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}afterLoadData(){this.afterUpdateSettings()}afterRenderer(Y,oe,ce){this.floatingBoxSettings.forEach(we=>{var xe,Le,ke,Ve,Ye=this.floatingBoxMeta.get(we);if(Ye&&we.topLeftRow<=oe&&we.topLeftColumn<=ce&&we.bottomRightRow>=oe&&we.bottomRightColumn>=ce){var ot=((Ve=(ke=(Le=(xe=Y.parentElement)===null||xe===void 0?void 0:xe.parentElement)===null||Le===void 0?void 0:Le.parentElement)===null||ke===void 0?void 0:ke.parentElement)===null||Ve===void 0?void 0:Ve.parentElement)||void 0;ot&&!Ye.containerParents.has(ot)&&Ye.containerParents.add(ot)}})}beforeRender(){this.floatingBoxSettings.forEach(Y=>{var oe=this.floatingBoxMeta.get(Y);oe||(oe={top:void 0,left:void 0,width:void 0,height:void 0,containerParents:new Set,containers:new Map},this.floatingBoxMeta.set(Y,oe))})}afterRender(){this.isFirstRender&&(this.isFirstRender=!1,this.getExtendedHotSettings().mergeCells.length>0)||this.floatingBoxSettings.length!==0&&(this.floatingBoxSettings.forEach(Y=>{var oe=this.floatingBoxMeta.get(Y);if(oe&&oe.containerParents.size>0&&oe.width===void 0){var ce=this.hot.view.wt,we=-ce.getSetting("columnHeaders").length,xe=-ce.getSetting("rowHeaders").length;oe.left=-1+Y.topLeftOffsetX+ce.wtOverlays.leftOverlay.sumCellSizes(we,Y.topLeftColumn),oe.top=3+Y.topLeftOffsetY+ce.wtOverlays.topOverlay.sumCellSizes(xe,Y.topLeftRow);var Le=ce.wtOverlays.leftOverlay.sumCellSizes(Y.topLeftColumn,Y.bottomRightColumn+1);oe.width=-1+Y.bottomRightOffsetX-Y.topLeftOffsetX+Le;var ke=ce.wtOverlays.topOverlay.sumCellSizes(Y.topLeftRow,Y.bottomRightRow+1);oe.height=-1+Y.bottomRightOffsetY-Y.topLeftOffsetY+ke}}),this.floatingBoxSettings.forEach(Y=>{var oe=this.floatingBoxMeta.get(Y);oe&&oe.containerParents.size>oe.containers.size&&oe.containerParents.forEach(ce=>{if(!oe.containers.has(ce)){var we=function(xe,Le,ke){var Ve=document.createElement("div");if(Ve.classList.add("sv-handsontable-floating-box"),Ve.style.left="".concat(Le.left,"px"),Ve.style.top="".concat(Le.top,"px"),Ve.style.width="".concat(Le.width,"px"),Ve.style.height="".concat(Le.height,"px"),ke.appendChild(Ve),Le.width===void 0||Le.height===void 0)throw new Error("Could not retrieve sizes of the floating box");return xe.renderer(Ve,Le.width,Le.height),Ve}(Y,oe,ce);oe.containers.set(ce,we)}})}))}afterUpdateSettings(){var Y=this.getExtendedHotSettings();Array.isArray(Y.floatingBox)?this.floatingBoxSettings=Y.floatingBox:this.floatingBoxSettings=[]}destroy(){super.destroy()}}h.a.plugins.registerPlugin("FloatingBoxPlugin",E);var M=o(4),y=o(149),z=o.n(y),U=o(10),te={Arial:"Liberation Sans","Times New Roman":"Liberation Serif","Courier New":"Liberation Mono",Calibri:"Carlito",Cambria:"Caladea"},D={"Liberation Serif":"serif","Liberation Mono":"monospace","Liberation Sans":"sans-serif",Carlito:"sans-serif",Caladea:"sans-serif"},k=new Map,T=1,G,W;function P(ae){var Y=document.createElement("span");Y.innerHTML=Array(100).join("wi"),Y.style.position="absolute",Y.style.fontSize="128px",Y.style.left="-99999px",Y.style.fontFamily=ae,document.body.appendChild(Y);var oe=Y.clientWidth;if(document.body.removeChild(Y),oe<1)throw new Error("Could not measure the text size. Maybe you called too early?");return oe}var Q=new Map,O=()=>{(T-=1)===0&&(document.body.dataset.webfontsLoaded="")};function A(ae,Y,oe){var ce=[],we=Object(U.b)(te,ae,void 0);if(function(ke){if(G===void 0&&(G=P("sans-serif")),W===void 0&&(W=P("serif")),Q.has(ke))return Q.get(ke);var Ve=P("".concat(ke,", sans-serif")),Ye=P("".concat(ke,", serif")),ot=!(G===Ve&&W===Ye);return Q.set(ke,ot),ot}(ae))ce.push('"'.concat(ae,'"'));else if(we){ce.push('"'.concat(we,'"')),ce.push('"'.concat((ke=>Object(U.b)(D,ke,"sans-serif"))(we),'"'));var xe="".concat(we," ").concat(Y," ").concat(oe);if(!k.has(xe)){(T+=1)===1&&delete document.body.dataset.webfontsLoaded;var Le=function(ke,Ve,Ye){return new z.a(ke,{weight:Ve,style:Ye}).load(null,1e4)}(we,Y,oe).then(()=>{console.log("Font loaded",we,Y,oe),O()}).catch(()=>{console.log("Font failed to load",we,Y,oe),O()});k.set(xe,Le)}}else ce.push('"'.concat("Arial",'"')),ce.push('"'.concat("sans-serif",'"'));return ce.join(", ")}O();var Z,ee=o(16),de=o(94),be=function(ae,Y,oe,ce){return new(oe||(oe=Promise))(function(we,xe){function Le(Ye){try{Ve(ce.next(Ye))}catch(ot){xe(ot)}}function ke(Ye){try{Ve(ce.throw(Ye))}catch(ot){xe(ot)}}function Ve(Ye){var ot;Ye.done?we(Ye.value):(ot=Ye.value,ot instanceof oe?ot:new oe(function(ct){ct(ot)})).then(Le,ke)}Ve((ce=ce.apply(ae,Y||[])).next())})},Ne=(ae,Y)=>function(oe,ce,we){Object(de.b)(),(()=>{be(this,void 0,void 0,function*(){(yield Promise.all([o.e(6),o.e(3)]).then(o.bind(null,184))).getChartRenderer(ae,Y)(oe,ce,we)})})()};(function(ae){ae.CHART="chart",ae.IMAGE="image"})(Z||(Z={}));var Me,pe=o(128),Be=o(20),Ce=(ae,Y)=>ae.type===Z.IMAGE?(oe=>function(ce,we,xe){ce.classList.add("sv-handsontable-image"),Object(ee.render)(R.createElement("img",{src:oe.imageData,alt:"",style:{width:we,height:xe}}),ce)})(ae):Object(Be.a)()?Ne(ae,Y):function(oe,ce,we){oe.classList.add("sv-handsontable-chart"),Object(ee.render)(c.a.createElement(pe.a,null),oe)},Oe=ae=>ae===null,Ae=o(17),Ue=["$","\u20BF","\xA3","\xA4","\xA5","\u20B1","\u20AD","\u20A6","\u20AE","\u20AC","\u0E3F","\u20A1","\u20B2","\u20AA","\u20B9","\u20BA","Ar","B/.","Br","Bs.","Bs.S.","BTC","C$","CHF","EC$","HK$","kr","Ksh","L","MOP","Nfk","NT$","P","Q","R","R$","RF","RM","Rp","Rs","Rs.","S","S/","US$","XBT","XDR","\u0930\u0942","\u0DBB\u0DD4","\u1265\u122D","AED","ADP","AFA","AFN","ALL","AMD","ANG","AOA","ARS","ATS","AUD","AWG","AZM","AZN","BAM","BBD","BDT","BEF","BGN","BGL","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTC","BTN","BWP","BYB","BYR","BYN","BZD","CAD","CDF","CHE","CHW","CLF","CLN","CLP","CNY","COP","COU","CSD","CRC","CUC","CUP","CVE","CYP","CZK","DJF","DEM","DKK","DOP","DZD","ECS","ECV","EEK","ESP","EGP","ERN","ETB","ETH","EUR","FJD","FIM","FKP","FRF","GBP","GEL","GGP","GHC","GHS","GIP","GMD","GNF","GTQ","GYD","GRD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","IEP","IMP","INR","IQD","IRR","ILS","IQD","ISK","ITL","JEP","JMD","JOD","JPY","KAF","KES","KGS","KHR","KMF","KPW","KRW","KPW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LTC","LTL","LVL","LYD","MAD","MDL","MGA","MGF","MKD","MMK","MNT","MOP","MRO","MRU","MUR","MVR","MWK","MXN","MYR","MZN","MZM","NAD","NGN","NIO","NOK","NLG","NPR","NTD","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","PTE","QAR","RMB","RON","ROL","RSD","RUB","RUR","RWF","SAR","SBD","SCR","SDD","SDP","SDG","SEK","SGD","SHP","SLL","SKK","SIT","SOS","SRD","SSP","SPL","STD","STN","SVC","SYP","SZL","THB","TJS","TJR","TMT","TND","TMM","TOP","TRL","TRY","TTD","TVD","TWD","TZS","UAH","UGX","USD","USN","USS","UYU","UYI","UZS","VEB","VEF","VES","VND","VUV","WST","XAF","XAG","XBT","XAU","XCD","XOF","XB5","XBA","XBB","XBC","XBD","XDR","XFO","XFU","XPD","XPF","XPT","XTS","XXX","YER","YUM","ZAR","ZWD","ZWL","ZWN","ZWR"],ze={viewportRowRenderingOffset:1e4,viewportColumnRenderingOffset:256},Ge=ae=>ae/9525,I=(ae,Y)=>ae/9525-Y,ge=(ae,Y)=>{var oe=ae/9525-Y;return-Math.round(Math.abs(oe))};function V(){Object(f.c)(f.a.presentationHotRendering)}function q(){this.getSettings().showGrid||this.rootElement.classList.add("sv-hide-gridlines")}(function(ae){ae.General="general",ae.Accounting="accounting",ae.Currency="currency"})(Me||(Me={}));var B=["color","fontSize","lineHeight","textDecoration","textShadow","overflow","textAlign","verticalAlign","direction","wordBreak","whiteSpace","display"],se=ae=>{var Y,oe,ce=ae.patternType==="solid",we=Object.assign({backgroundColor:ce&&ae.fgColor?"#".concat(ae.fgColor.rgb):"",fontFamily:(Y=ae.fontFamily)!==null&&Y!==void 0?Y:"",fontStyle:(oe=ae.fontStyle)!==null&&oe!==void 0?oe:"",borderRightColor:ce&&!Oe(ae.border)?"transparent":"",borderBottomColor:ce&&!Oe(ae.border)?"transparent":""},ae.fontFamily?(()=>{var xe,Le=function(Ve){if(typeof Ve=="number")return Ve;if(Ve===void 0)return 400;var Ye=parseInt(Ve,10);return Ye||(Ve==="bold"?700:400)}(ae.fontWeight||400),ke=(xe=ae.fontStyle)!==null&&xe!==void 0?xe:"normal";return{fontWeight:Le,fontStyle:ke,fontFamily:A(ae.fontFamily,Le,ke)}})():{});return B.forEach(xe=>{ae[xe]&&(we[xe]=ae[xe])}),we},ie=ae=>{var{s:Y,e:oe}=ae,ce=oe.r-Y.r,we=oe.c-Y.c;return ce>=0&&(ce+=1),we>=0&&(we+=1),{row:Y.r,col:Y.c,rowspan:ce,colspan:we,mergedColumn:ce>1e4,mergedRow:we>256}};function Ee(ae,Y,oe,ce,we,xe,Le){Y.firstElementChild||(ht=>{var St=document.createElement("div"),r=document.createElement("div");r.className="sv-cell-text-wrapper__currency";var e=document.createElement("div");e.className="sv-cell-text-wrapper__value",St.appendChild(r),St.appendChild(e),ht.appendChild(St)})(Y);var ke=Y.firstElementChild,Ve=ke==null?void 0:ke.firstElementChild,Ye=ke==null?void 0:ke.lastElementChild;ke.removeAttribute("style"),ke.className="sv-cell-text-wrapper";var ot=Xe(oe,ce);if(!Le.svMultiRowCells.has(ot)&&Array.isArray(Le.rowHeights)){var ct=Le.rowHeights[oe],At=Number(ct)-1,{styleMap:wt}=Le.horizontalOverlap;if(ke.style.maxHeight="".concat(At,"px"),Le.cellClassName){var Tt=wt[Le.cellClassName],{lineHeight:mt}=Tt;if(mt){var jt=parseInt(mt,10);ke.style.lineHeight="".concat(Math.min(At,jt),"px ")}}}var gt=Le.horizontalOverlap.obscuredNonText.get(ot),{numberFormat:Bt}=Le;(function(ht){return(ht==null?void 0:ht.format)===Me.Accounting&&ht.currencySymbol&&ht.currencyValue})(Le.numberFormat)&&!gt?(ke.classList.add("sv-cell-text-wrapper--accounting"),h.a.dom.fastInnerText(Ve," ".concat(Bt.currencySymbol," ")),h.a.dom.fastInnerText(Ye,Bt.currencyValue)):h.a.dom.fastInnerText(Ye,gt||xe||"");var Nt=Le.rowClassNames.get(oe);Nt&&Y.classList.add(Nt);var Ft=Le.columnClassNames.get(ce);Ft&&Y.classList.add(Ft),Le.cellClassName&&Y.classList.add(Le.cellClassName);var{horizontalOverlap:bt}=Le,Ct=bt.overlapStartCells.get(ot);return Ct&&(ke.classList.add("sv-handsontable-horizontal-overlay"),Object.assign(ke.style,Ct)),bt.hideRightGridlineTds.has(ot)&&Y.classList.add("sv-handsontable-hide-right-gridline"),Y}var ye,_e=(ae,Y,oe)=>{var ce={row:Y,col:oe};return["left","right","bottom","top"].forEach(we=>{var xe,Le=ae[we];(Le==null?void 0:Le.width)&&(ce[we]={width:(xe=Le.width,xe==="thin"?1:xe==="medium"?2:xe==="thick"?3:1),color:"#".concat(Le.color||"000")})}),ce},st=(ae,Y,oe)=>{if(!ae||Y==="General")return Me.General;var ce=ae.trim()!==ae;return oe==="n"&&ce?Me.Accounting:oe!=="n"||ce?Me.General:Me.Currency},at=(ae,Y)=>{if(Y===Me.Accounting&&ae){var oe,ce,we=ae.search(/[-\\(0-9]/);if(we>0){var[xe,Le]=(ce=we,[(oe=ae).substring(0,ce),oe.substring(ce)]),ke=xe.trim();if(Ue.includes(ke))return{currencySymbol:ke,currencyValue:Le}}}},it=(ae,Y,oe)=>Math.min(oe,Math.max(Y,ae)),Xe=(ae,Y)=>"".concat(ae,",").concat(Y),vt=new Map,lt=new Map,yt=()=>{vt.clear(),lt.clear(),ye=function(ae){if(document.getElementById(ae))throw new Error("measuringContainer already exists");var Y=document.createElement("div");return Y.setAttribute("id",ae),document.body.appendChild(Y),Y}("sv-handsontable-horizontal-overlay-measuring")},Rt=function(ae,Y){var oe="".concat(ae,"|").concat(Y),ce=lt.get(oe);if(ce!==void 0)return ce;var we=vt.get(Y);we||(we=(ke=>{var Ve=document.createElement("canvas");if(ye===void 0)throw new Error("measuringContainer doesn't exist");ye.appendChild(Ve);var Ye=Ve.getContext("2d");if(Ye===null)throw new Error("Failed to obtain CanvasRenderingContext2D");return Ye.font=ke,Ye})(Y),vt.set(Y,we));var xe=we.measureText(ae),{width:Le}=xe;return lt.set(oe,Le),Le};class Et extends h.a.plugins.BasePlugin{resetState(){this.measureAllCells()}getExtendedHotSettings(){return this.hot.getSettings()}isEnabled(){return!!this.getExtendedHotSettings().horizontalOverlap}enablePlugin(){this.enabled||(this.addHook("init",this.onInit.bind(this)),super.enablePlugin())}disablePlugin(){this.resetState(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}onInit(){this.resetState()}createCustomBordersMap(Y){for(var oe=new Map,ce=0;ce<Y.length;ce++){var{row:we,col:xe}=Y[ce],Le=Xe(we,xe);oe.set(Le,Y[ce])}return oe}measureAllCells(){var Y,{customBorders:oe,horizontalOverlap:ce}=this.getExtendedHotSettings(),we=this.createCustomBordersMap(oe),xe=this.hot.getData(),Le=xe[0].length;yt(),ce.startCells.forEach(ke=>{var[Ve,Ye]=ke.split(",").map(ct=>parseInt(ct,10)),ot=xe[Ve];this.performTextOverlapping(Ve,Ye,Le,ot,we)}),(Y=ye==null?void 0:ye.parentElement)===null||Y===void 0||Y.removeChild(ye)}hideBorderLeftEdge(Y,oe,ce){var we=Xe(oe,ce),xe=Y.get(we);xe&&this.hideBorderEdge(xe.left)}hideBorderRightEdge(Y,oe,ce){var we=Xe(oe,ce),xe=Y.get(we);xe&&this.hideBorderEdge(xe.right)}hideBorderEdge(Y){Y&&!Y.hide&&(Y.hide=!0)}obscureString(Y){return Array(Y.length).fill("#").join("")}performTextOverlapping(Y,oe,ce,we,xe){var Le="left",ke=!1,Ve=0,Ye=this.getCellProperties(Y,oe),{columns:ot,colWidths:ct,rowHeights:At,horizontalOverlap:wt}=this.getExtendedHotSettings(),Tt=wt.stopCells.has(Xe(Y,oe-1)),mt=wt.stopCells.has(Xe(Y,oe+1));if(!(Ye.isTextContent&&Tt&&mt)){var jt=Ye.cellClassName||"",gt=wt.styleMap[jt];if(gt&&(gt.textAlign&&(Le=gt.textAlign),gt.indent&&(Ve=9*gt.indent),gt.wordBreak==="break-word"&&(ke=!0)),Ye.isTextContent){if(ke)return;if(Le==="right"){if(oe===0||Tt)return}else if(mt)return}var Bt=Xe(Y,oe);if(!Array.isArray(ct))throw new Error("colWidths must be an Array");if(!Array.isArray(At))throw new Error("rowHeights must be an Array");var Nt=ct[oe],Ft=gt?"".concat(gt.fontStyle||""," ").concat(gt.fontWeight||""," ").concat(gt.fontStretch||""," ").concat(gt.fontSize," ").concat(gt.fontFamily):"",bt=we[oe];if(bt===null)throw new Error("rowData[".concat(oe,"] must be a string"));var Ct=Rt(bt,Ft)+Ve;if(Ct){var ht=Ct+5;if(ht>Nt){if(!Ye.isTextContent)return void wt.obscuredNonText.set(Bt,this.obscureString(bt));var St=0,r=Nt,e=!1;Le==="right"&&(e=!0);for(var n=oe-1,s=oe+1;r<ht;){if(e){if(n<0||wt.stopCells.has(Xe(Y,n)))break;var u=ct[n];r+=Number(u),St-=Number(u),wt.hideRightGridlineTds.add(Xe(Y,n)),this.hideBorderLeftEdge(xe,Y,n+1),this.hideBorderRightEdge(xe,Y,n),n-=1}else{if(s===ce){ot.length===ce&&(ot.length=ce+1,ct[ce]=0,this.hot.initIndexMappers());var p=ht-r+4;ct[ce]<p&&(ct[ce]=p)}if(wt.stopCells.has(Xe(Y,s)))break;var j=ct[s];r+=Number(j),wt.hideRightGridlineTds.add(Xe(Y,s-1)),this.hideBorderLeftEdge(xe,Y,s),this.hideBorderRightEdge(xe,Y,s-1),s+=1}Le==="center"&&(e=!e)}var K=Number(At[Y])-1;wt.overlapStartCells.set(Bt,{left:"".concat(St,"px"),width:"".concat(r-4-1,"px"),height:"".concat(K,"px")})}}}}getCellProperties(Y,oe){return this.hot.getCellMeta(Y,oe)}destroy(){super.destroy()}}h.a.plugins.registerPlugin("HorizontalOverlapPlugin",Et);var rt=o(2),Mt=ae=>{var{children:Y,holdDownChildRenderPromise:oe}=ae,[ce,we]=Object(R.useState)();return Object(R.useEffect)(()=>{var xe=!0;return oe?oe.then(()=>{xe&&we(Y)}):we(Y),()=>{xe=!1}},[Y,oe]),c.a.createElement(c.a.Fragment,null,ce)},g=ae=>(Y,oe,ce,we)=>{Object(S.c)(ae,[Y,oe,ce,we])};class v extends R.PureComponent{componentDidCatch(Y){throw new rt.k(Y==null?void 0:Y.message)}render(){var{children:Y}=this.props;return Y}}var F=ae=>{var{parsedData:Y,sheet:oe,shouldSimulateHandsontableError:ce,shouldSimulateInterpreterError:we,requestMessageOnError:xe,fullPage:Le,svId:ke}=ae,Ve=Object(R.useRef)(),Ye=Object(Ae.b)();Object(C.a)(N.f,N.c,xe,mt=>{var jt,{range:gt}=mt;(jt=Ve.current)===null||jt===void 0||jt.selectCells([gt])});var ot=mt=>{Ve.current=mt==null?void 0:mt.hotInstance},{cssText:ct,tableProps:At,fontsLoadedPromise:wt}=Object(R.useMemo)(()=>{Object(de.c)();try{if(Object(f.c)(f.a.interpreter),we)throw new Error("This is a simulation of an error in the interpreter");Object(f.c)(f.a.interpreterStyleClone);var mt=JSON.parse(JSON.stringify(Y.styleMap));Object(f.b)(f.a.interpreterStyleClone),Object(f.c)(f.a.interpreterCss);var jt=(Ft=mt,Object.entries(Ft).map(bt=>{var[Ct,ht]=bt,St=document.createElement("style");document.head.appendChild(St);var r=St.sheet,e=Ct.includes("cell")?4:3,n=new Array(e).fill(".".concat(Ct)).join("");r.insertRule("".concat(n," {}"),0);var s=r.cssRules[0],u=se(ht);Object.assign(s.style,u),Object.assign(ht,u);var p=s.cssText;if(document.head.removeChild(St),ht.indent&&ht.indent>0){var{indent:j}=ht,K=9*Number(j),J=ht.textAlign==="left"?"padding-left":"padding-right";p+=`
        .handsontable td.`.concat(Ct,` .sv-cell-text-wrapper {
          `).concat(J,": ").concat(K,`px;
         }
        `)}return p+=((ne,he)=>{switch(ne.textAlign){case"right":return`
      .handsontable td.`.concat(he,` .sv-cell-text-wrapper {
        margin-right: `).concat(4,`px;
        justify-content: flex-end;
        }
    `);case"center":return`
      .handsontable td.`.concat(he,` .sv-cell-text-wrapper {
        justify-content: center;
        min-width: 100%;
        }
    `);default:return`
    .handsontable td.`.concat(he,` .sv-cell-text-wrapper {
      margin-left: `).concat(4,`px;
      justify-content: flex-start;
      }
  `)}})(ht,Ct),ht.wordBreak==="break-word"?p+=((ne,he)=>{var ue="";switch(ne.verticalAlign){case"top":ue=`
        position: absolute;
        top: 0;
        align-items: flex-start;
      `;break;case"bottom":ue=`
        position: absolute;
        bottom: 0;
        align-items: flex-end;
      `;break;default:ue=`
        position: relative;
        align-items: center;
      `}return`
    .handsontable td.`.concat(he,` {
      position: relative;
    }
    .handsontable td.`).concat(he,` .sv-cell-text-wrapper {
      display: flex;
      white-space: pre-wrap;
      `).concat(ue,`
    }
  `)})(ht,Ct):p+=((ne,he)=>{var ue="";switch(ne.verticalAlign){case"top":ue=`
        align-items: flex-start;
      `;break;case"bottom":ue=`
        align-items: flex-end;
      `;break;default:ue=`
        align-items: center;
      `}return`
    .handsontable td.`.concat(he,` .sv-handsontable-horizontal-overlay {
      `).concat(ue,`
    }
  `)})(ht,Ct),p}).join(" "));Object(f.b)(f.a.interpreterCss),Object(f.c)(f.a.interpreterHotConfig);var gt=Object.values(Y.sheetsData)[oe];if(!gt)throw new Error("Could not retrieve parsed data for the given sheet number (".concat(oe,")"));var Bt=gt.data;if(!Bt)throw new Error("Could not retrieve parsed data for the given sheet (".concat(gt.title,")"));var{tableProps:Nt}=((bt,Ct)=>{var ht,St;if(!bt||bt.hidden)return{};var r=new Map,e={data:[],cell:[],afterLoadData:V,afterInit:q,readOnly:!0,colHeaders:!0,rowHeaders:!0,licenseKey:"non-commercial-and-evaluation",showGrid:!0,cells:()=>({renderer:Ee}),beforePaste:()=>!1,columns:[],mergeCells:[],colWidths:[],rowHeights:[],fixedRowsTop:0,fixedColumnsLeft:0,fillHandle:!1,customBorders:new Array,floatingBox:[],selectionMode:"range",selectionStyle:{cell:{borderWidth:2,borderColor:"rgb(16, 74, 204)"},area:{borderWidth:1,borderColor:"rgb(16, 74, 204)"}},horizontalOverlap:{startCells:new Set,stopCells:new Set,styleMap:Ct,overlapStartCells:new Map,hideRightGridlineTds:new Set,obscuredNonText:new Map},svMultiRowCells:new Set,rowClassNames:new Map,columnClassNames:new Map,beforeInitWalkontable:xt=>{xt.externalRowCalculator=!0}},n=bt[M.b],s=n.columns.wpx,u=n.rows.hpx,p=-1,j=-1;for(var[K,J]of Object.entries(bt))switch(K){case M.c:J.forEach(xt=>{var{s:Jt,e:It}=xt,Yt=ie({s:Jt,e:It});e.mergeCells.push(Yt);var Kt=Yt.mergedColumn||Yt.mergedRow,qt=Jt.c,er=Jt.r,tr=Math.min(255,It.c),$t=Math.min(9999,It.r);if(tr>p&&!Kt&&(p=tr),$t>j&&!Kt&&(j=$t),er<$t){var mr=Xe(er,qt);e.svMultiRowCells.add(mr)}for(var or=er;or<=$t;or++)for(var ir=qt;ir<=tr;ir++){var hr=Xe(or,ir);e.horizontalOverlap.stopCells.add(hr),e.horizontalOverlap.startCells.delete(hr)}});break;case M.a:var ne=J;ne.length>256&&(ne.length=256);for(var he=0;he<ne.length;he++){var ue=ne[he];e.colWidths[he]=(ue==null?void 0:ue.wpx)||s,(ue==null?void 0:ue.svStyleId)&&e.columnClassNames.set(he,ue.svStyleId),(ue==null?void 0:ue.hidden)&&e.fixedColumnsLeft&&e.fixedColumnsLeft>0&&he<e.fixedColumnsLeft&&(console.log("This sheet contains an unsupported hidden column inside a frozen pane. To avoid potentially incorrect rendering, we have disabled the frozen pane on the left."),e.fixedColumnsLeft=0)}break;case M.e:var je=J;je.length>1e4&&(je.length=1e4);for(var We=0;We<je.length;We++){var Pe=je[We],Qe=Pe==null?void 0:Pe.hpx;e.rowHeights[We]=Qe||u,(Pe==null?void 0:Pe.svStyleId)&&e.rowClassNames.set(We,Pe.svStyleId),(Pe==null?void 0:Pe.hidden)&&e.fixedRowsTop&&e.fixedRowsTop>0&&We<e.fixedRowsTop&&(console.log("This sheet contains an unsupported hidden row inside a frozen pane. To avoid potentially incorrect rendering, we have disabled the frozen pane on top."),e.fixedRowsTop=0)}break;case M.h:Object(Ae.b)()||(e.fixedColumnsLeft=parseInt(J,10));break;case M.i:Object(Ae.b)()||(e.fixedRowsTop=parseInt(J,10));break;case M.f:J!==!1&&J!==0||(e.showGrid=!1);break;case M.d:J.forEach(xt=>{if(xt&&xt.anchor&&xt.type){var Jt,{anchor:It}=xt,Yt=typeof It.dxL=="number",Kt=parseInt(It.colR,10),qt=parseInt(It.rwB,10),er=e.colWidths[Kt]===void 0?s:e.colWidths[Kt],tr=e.rowHeights[qt]===void 0?u:e.rowHeights[qt],$t={topLeftRow:parseInt(It.rwT,10),topLeftColumn:parseInt(It.colL,10),bottomRightColumn:Kt,bottomRightRow:qt,topLeftOffsetX:Yt?0:(Jt=parseInt(It.dxL,10),Jt/9525),topLeftOffsetY:Yt?0:Ge(parseInt(It.dyT,10)),bottomRightOffsetX:Yt?0:I(parseInt(It.dxR,10),er),bottomRightOffsetY:Yt?0:ge(parseInt(It.dyB,10),tr),renderer:Ce(xt,bt)};e.floatingBox.push($t),Kt>p&&(p=Kt),qt>j&&(j=qt)}else console.warn("Skipping an embedded object of an unsupported type")});break;default:if(!J)break;var Je=K.match(/^([a-zA-Z]+)([0-9]+)/);if(!Je||!Je[1]||!Je[2]||Number(Je[2])>1e4)break;var Ze=Number(Je[2])-1,qe=h.a.helper.spreadsheetColumnIndex(Je[1]);if(qe+1>256)break;var tt=J,nt=e.data&&e.data[Ze]?e.data[Ze]:[],ut=!1,dt=!1;if(tt.svStyleId){var{border:ft,wordBreak:Vt}=Ct[tt.svStyleId];if(ft){ut=!0;var Dt=_e(ft,Ze,qe);e.customBorders.push(Dt)}dt=Vt===void 0}var Ot=tt.w||tt.v||"";dt&&typeof Ot=="string"&&(Ot=Ot.replace(/[\r\n]+/gm,""));var Ht=!!Ot;if((Ht||ut)&&(nt[qe]=Ot,e.data&&(e.data[Ze]=nt),qe>p&&(p=qe),Ze>j&&(j=Ze),Ht)){var Wt=Xe(Ze,qe);e.horizontalOverlap.stopCells.add(Wt),e.horizontalOverlap.startCells.add(Wt)}var Gt=st(tt.w,tt.z,tt.t),_t=at(tt.w,Gt),kt={row:Ze,col:qe,cellClassName:tt.svStyleId,isTextContent:tt.isTextContent,numberFormat:Object.assign({format:Gt},_t&&Object.assign({},_t))};r.set(Xe(Ze,qe),tt),(ht=e.cell)===null||ht===void 0||ht.push(kt)}var zt=it(p+1,6,256),pt=it(j+1,20,1e4);if(e.mergeCells=e.mergeCells.map(xt=>Object.assign(Object.assign({},xt),{rowspan:Math.min(pt-xt.row,xt.rowspan),colspan:Math.min(zt-xt.col,xt.colspan)})),e.data){if(e.data.length>pt)e.data.splice(pt);else if(e.data.length<pt){var Lt=e.data.length;e.data.length=pt,e.data.fill([],Lt,pt)}}if(e.rowHeights.length<pt){var Xt=e.rowHeights.length;e.rowHeights.length=pt,e.rowHeights.fill(u,Xt,pt)}if(e.colWidths.length<zt){var Qt=e.colWidths.length;e.colWidths.length=zt,e.colWidths.fill(s,Qt,zt)}for(var Ut=0;Ut<pt;Ut++)for(var Pt=0;Pt<zt;Pt++){var Zt=(St=e.data)===null||St===void 0?void 0:St[Ut],rr=Zt&&Zt[Pt],nr=r.get(Xe(Ut,Pt));if(rr===void 0&&!nr){var sr=e.columnClassNames.get(Pt);if(sr){var ar=Ct[sr];if(ar.border){var dr=_e(ar.border,Ut,Pt);e.customBorders.push(dr)}}var lr=e.rowClassNames.get(Ut);if(lr){var cr=Ct[lr];if(cr.border){var gr=_e(cr.border,Ut,Pt);e.customBorders.push(gr)}}}}return e.columns.length=zt,{tableProps:e}})(Bt,mt);if(!(Nt=Le?Object.assign(Object.assign({},Nt),ze):Object.assign(Object.assign({},Nt),{width:"100%",height:"100%"})))throw new Error("Could not create a `tableProps` object for the given sheet");return{cssText:jt,tableProps:Nt,fontsLoadedPromise:Promise.all(Array.from(k.values()))}}catch(bt){throw console.error("interpreter:",bt),new rt.f(bt==null?void 0:bt.message)}finally{Object(f.b)(f.a.interpreterHotConfig),Object(f.b)(f.a.interpreter)}var Ft},[Y,oe,we,Le]),Tt=Object(R.useMemo)(()=>{var mt=Math.random().toString(32).substring(2);return c.a.createElement(_.a,{settings:At,afterSelection:(jt,gt,Bt,Nt,Ft)=>{Ye&&(Ft.value=!0)},afterSelectionEnd:g(ke),afterRender:()=>{if(Object(f.b)(f.a.presentationHotRendering),Object(f.b)(f.a.presentation),Object(de.d)(),ce)throw new Error("This is a simulation of an error in rendering of Handsontable")},copyPaste:!Ye||{uiContainer:document.createElement("div")},ref:ot,key:mt})},[ce,At,Ye,ke]);return c.a.createElement("div",{className:"sv-hottable-wrapper",role:"tabpanel"},c.a.createElement(Mt,{holdDownChildRenderPromise:wt},c.a.createElement("style",null,ct),Le&&c.a.createElement("style",null,`
.sv-hottable-wrapper {
  width: initial;
  height: initial;
  margin-bottom: initial;
  margin-top: initial;
  position: static;
}
.handsontable {
  transform: none !important; /*disable row and column headings fixing to the viewport edge*/
}
`),c.a.createElement(v,null,Tt)))},re=o(192),le=o(181),fe=o(183),Se=o(41),ve=o(186),He=ae=>R.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 16 16",preserveAspectRatio:"none"},ae),R.createElement("path",{d:"M11.201 11.999V4.085a.074.074 0 00-.123-.066l-6.33 3.958a.074.074 0 000 .131l6.329 3.957a.074.074 0 00.123-.066z"})),Re=ae=>R.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 16 16",preserveAspectRatio:"none"},ae),R.createElement("path",{d:"M5 4.082v7.92a.082.082 0 00.126.07l6.335-3.96a.082.082 0 000-.14L5.126 4.011A.083.083 0 005 4.082z"})),L=function(ae,Y){var oe={};for(var ce in ae)Object.prototype.hasOwnProperty.call(ae,ce)&&Y.indexOf(ce)<0&&(oe[ce]=ae[ce]);if(ae!=null&&typeof Object.getOwnPropertySymbols=="function"){var we=0;for(ce=Object.getOwnPropertySymbols(ae);we<ce.length;we++)Y.indexOf(ce[we])<0&&Object.prototype.propertyIsEnumerable.call(ae,ce[we])&&(oe[ce[we]]=ae[ce[we]])}return oe},l=ae=>Object.entries(ae).filter(Y=>Y[1]).map(Y=>Y[0]).join(" "),t=R.forwardRef((ae,Y)=>{var{classes:oe,className:ce,direction:we,orientation:xe,disabled:Le}=ae,ke=L(ae,["classes","className","direction","orientation","disabled"]);return R.createElement(ve.a,Object.assign({component:"div",className:l({[oe.root||""]:!0,[oe.vertical||""]:xe==="vertical","sv-tab-scroll-button-disabled":Boolean(Le),[ce||""]:!0,"sv-tab-scroll-button":!0}),ref:Y},ke),we==="left"?R.createElement(He,{"data-cy":"tabbar-left-caret"}):R.createElement(Re,{"data-cy":"tabbar-right-caret"}))}),i=Object(Se.a)({root:{width:40,flexShrink:0},disabled:{}})(t),a=o(190),m=ae=>{var{isActive:Y}=ae;return c.a.createElement(c.a.Fragment,null,c.a.createElement("svg",{height:"16",width:"16",viewBox:"5 4 16 16",className:Y?"active":"inactive"},c.a.createElement("path",{className:"sv-hamburger-icon",d:"M19.922 11H4.078a.09.09 0 00-.078.1v1.8a.089.089 0 00.078.1h15.844a.089.089 0 00.078-.1v-1.8a.09.09 0 00-.078-.1zM19.922 6H4.078A.09.09 0 004 6.1v1.8a.089.089 0 00.078.1h15.844A.089.089 0 0020 7.9V6.1a.09.09 0 00-.078-.1zM19.922 16H4.078a.09.09 0 00-.078.1v1.8a.089.089 0 00.078.1h15.844a.089.089 0 00.078-.1v-1.8a.09.09 0 00-.078-.1z"})),c.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},c.a.createElement("span",null,"More sheets")))},b=ae=>{var{isActive:Y}=ae;return c.a.createElement(c.a.Fragment,null,c.a.createElement("svg",{height:"24",width:"24",viewBox:"0 0 24 24",className:Y?"active":"inactive"},c.a.createElement("g",{transform:"translate(-679.64 -429.029)"},c.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 433.029)"}),c.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 440.029)"}),c.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 447.029)"}))))},H=ae=>{var{onClick:Y,isClicked:oe,isMobile:ce}=ae;return c.a.createElement("div",{className:"sv-dropup-menu-button",role:"button",tabIndex:0,onClick:Y,"data-cy":"dropup-menu-button"},ce?c.a.createElement(b,{isActive:oe}):c.a.createElement(m,{isActive:oe}))},$=o(187),me=ae=>{var{anchorEl:Y,handleCloseMenu:oe,children:ce,isMobile:we}=ae;return c.a.createElement($.a,{anchorEl:Y,keepMounted:!0,open:Boolean(Y),onClose:oe,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{style:we?{maxHeight:232,width:232}:{maxHeight:267,width:152}},classes:{paper:"sv-dropup-menu-container",list:"sv-dropup-menu-list"}},ce)},Te=ae=>{var{currentTabIndex:Y,onTabChange:oe,titles:ce}=ae,[we,xe]=Object(R.useState)(void 0),Le=Object(Ae.b)();return c.a.createElement(c.a.Fragment,null,c.a.createElement(H,{onClick:ke=>{xe(ke.currentTarget)},isClicked:!!we,isMobile:Le}),c.a.createElement(me,{anchorEl:we,handleCloseMenu:()=>{xe(void 0)},isMobile:Le},ce.map((ke,Ve)=>{var Ye=Y===Ve?"active":"";return c.a.createElement(a.a,{key:Ve,selected:Boolean(Ye),classes:{root:"sv-dropup-menu-item",selected:Ye},onMouseDown:()=>oe(Ve),disableRipple:!0,"data-cy":"dropup-menu-item-".concat(Ve)},c.a.createElement("div",null,ke))})))},Ie=ae=>{var{currentTabIndex:Y,onTabChange:oe,titles:ce}=ae;Object(R.useMemo)(()=>Object(f.c)(f.a.presentationTabsRendering),[]),Object(R.useLayoutEffect)(()=>Object(f.b)(f.a.presentationTabsRendering),[]),Object(f.c)(f.a.presentationTabsParsing);var we=c.a.createElement(le.a,{position:"static",color:"default",className:"sv-tabbar"},c.a.createElement(Te,{onTabChange:oe,currentTabIndex:Y,titles:ce}),c.a.createElement(fe.a,{value:Y,onChange:(xe,Le)=>oe(Number(Le)),textColor:"primary",variant:"scrollable",scrollButtons:"auto",ScrollButtonComponent:i,"aria-label":"scrollable auto tabs example",classes:{indicator:"sv-tab-indicator",scrollable:"sv-tabs-scrollable"},className:"sv-tabs","data-cy":"tabbar"},ce.map((xe,Le)=>((ke,Ve,Ye)=>c.a.createElement(re.a,{label:ke,key:Ve,className:"sv-tab","data-cy":"tabbar-workbook-tab",disableRipple:!0,onMouseDown:ot=>{ot.preventDefault(),Ye()}}))(xe,Le,()=>oe(Le)))));return Object(f.b)(f.a.presentationTabsParsing),we},Fe=o(96),Ke=o(6),$e=o(81),et=ae=>{ae.preventDefault()};d.default=ae=>{var{onSheetChange:Y,simulateError:oe,loadWorkbook:ce,workbookState:we,latestLoadedSheet:xe,requestMessageOnError:Le,svId:ke}=ae,{Modals:Ve,openModal:Ye}=Object(x.useModals)(),ot=(ct=>{var[At,wt]=Object(R.useState)(!1);return Object(R.useEffect)(()=>{var Tt=setTimeout(()=>wt(!0),ct);return()=>clearTimeout(Tt)},[ct]),At})(1e3);return Object(R.useEffect)(()=>{if(oe===rt.l.REACT_INITIALIZATION_ERROR)throw new Error(rt.l.REACT_INITIALIZATION_ERROR)},[oe]),(()=>{var ct;if(we===void 0)return ot?c.a.createElement(X,null):c.a.createElement(w.a,null);if(we.type==="initialising")return null;var{latestSheet:At}=we.sheetHistory,wt=xe===void 0?void 0:we.sheets.get(xe),Tt=Object(Be.b)();Object(Ke.a)(Tt,we.sheetNames.length);var mt=we.input;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"sv-app-container",onContextMenu:et},c.a.createElement(Ve,null),!Tt&&c.a.createElement(Fe.a,{fileName:(ct=Object($e.a)(mt))!==null&&ct!==void 0?ct:$e.b,workbookLocation:mt.type==="url"?mt.url:mt.arrayBuffer,renderWorkbook:ce,openModal:Ye}),xe!==void 0&&(wt==null?void 0:wt.type)==="ready"&&c.a.createElement(F,{shouldSimulateHandsontableError:oe===rt.l.RENDER_ERROR,shouldSimulateInterpreterError:oe===rt.l.INTERPRETER_ERROR,parsedData:wt.parsedData,sheet:xe,requestMessageOnError:Le,fullPage:Tt,svId:ke}),!Tt&&c.a.createElement(Ie,{currentTabIndex:At,onTabChange:Y,titles:we.sheetNames})))})()||c.a.createElement(w.a,null)}}])]);
