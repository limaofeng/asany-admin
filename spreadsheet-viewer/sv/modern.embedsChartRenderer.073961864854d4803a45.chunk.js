/*!
 * Spreadsheet Viewer
 * 
 * Version: 1.0.1
 * Code version: 06577ad
 * Build date: Thu, October 21, 2021, 12:29 PM GMT+2
 */(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{184:function(Q,T,f){"use strict";f.r(T),f.d(T,"getChartRenderer",function(){return V});var E,P=f(16),k=f(1),i=f.n(k),K=f(76),b=f.n(K),u=f(65),g={appear:{animation:"fadeIn",easing:"easeQuadIn",delay:0,duration:0}},F=(t,o)=>{var r,d=(r=t==null?void 0:t.label)===null||r===void 0?void 0:r.value;return d||"Series".concat(o+1)},O=t=>{var o,r={},d=(n=>{var e=new Set,l=JSON.parse(JSON.stringify(n));return l.forEach((a,v)=>{var c=F(a,v);e.has(c)&&(c=F(void 0,v)),e.add(c),a.label&&(a.label.value=c)}),l})(t),s={values:((o=d[0].values.values)===null||o===void 0?void 0:o.slice())||[]};d.forEach((n,e)=>{var l,a=F(n,e);n.categories||(n.categories=s),(l=n.categories.values)===null||l===void 0||l.forEach((v,c)=>{r[v]=r[v]||{},r[v][a]=(()=>{var p,m=(p=n.values.values)===null||p===void 0?void 0:p[c];if(m==null)return 0;var y=Number(m);return Number.isNaN(y)?0:y})()})});var h=[];return{data:Object.entries(r).map(n=>{var[e,l]=n;return h=[...h,...Object.keys(l)],Object.assign(Object.assign({},l),{key:e})}),series:[...new Set(h)]}},x={1:{back:{shape:"square"},front:{shape:"hollowSquare"}},2:{back:{shape:"diamond"},front:{shape:"hollowDiamond"}},3:{back:{shape:"triangle"},front:{shape:"hollowTriangle"}},4:{front:{shape:"cross"},back:{shape:"square"}},5:{front:{shape:"hexagon"},back:{shape:"square"}},6:{front:{shape:"hyphen"},back:{shape:"hyphen"}},7:{front:{shape:"hyphen"},back:{shape:"hyphen"}},8:{back:{shape:"circle"},front:{shape:"hollowCircle"}},9:{front:{shape:"plus"},back:{shape:"square"}}},C=(t,o)=>{var r;return(r=t.find(d=>{var s;return((s=d.label)===null||s===void 0?void 0:s.value)===o}))===null||r===void 0?void 0:r.markerFormat};(function(t){t.MARKER_COMPONENT_FRONT="fNotShowBrd",t.MARKER_COMPONENT_BACK="fNotShowInt"})(E||(E={}));var w,N;(function(t){t.FIELD_FRONT="front",t.FIELD_BACK="back"})(w||(w={})),function(t){t.FIELD_FRONT="rgbFore",t.FIELD_BACK="rgbBack"}(N||(N={}));var S,R=t=>{var{chartSeries:o,componentFlag:r,adjust:d,imkComponent:s,colorField:h}=t;return((n,e)=>{try{return n.find(l=>{try{return!(l.markerFormat.imk<=0)&&!l.markerFormat[e]}catch(a){return!1}})}catch(l){return!1}})(o,r)?i.a.createElement(u.Geom,{type:"point",position:"key*value",adjust:d,color:["type",n=>{var e=C(o,n);return typeof(e==null?void 0:e.imk)=="number"&&e.imk<=0||(e==null?void 0:e[r])?"transparent":(e==null?void 0:e[h])||"transparent"}],shape:["type",n=>{var e,l=C(o,n);return l===void 0?"":(e=l.imk)>0&&e<10?x[l.imk][s].shape:""}],size:["type",n=>{var e=C(o,n);return(e==null?void 0:e.size)||0}],style:{fill:"transparent"},animate:g}):null},j=t=>{var{chartSeries:o,chartOptions:r,name:d,width:s,height:h}=t,n=O(o),e=new b.a.View().source(n.data);e.transform({type:"fold",fields:n.series,key:"type",value:"value"}),r.flags.f100&&e.transform({type:"percent",dimension:"type",field:"value",groupBy:["key"],as:"value"});var l=r.flags.fStacked?"stack":"",a=o.map(c=>{var p,m;return(m=(p=c.format)===null||p===void 0?void 0:p.line)===null||m===void 0?void 0:m.rgb}).filter(c=>typeof c=="string"),v=a.length>0?["type",a]:["type",void 0];return i.a.createElement(u.Chart,{height:h,width:s,data:e,padding:"auto",animate:!1},i.a.createElement("span",{className:"sv-chart-title"},d),i.a.createElement(u.Tooltip,{crosshairs:!0,"g2-tooltip":{display:"inline-flex"}}),i.a.createElement(u.Axis,null),i.a.createElement(u.Legend,null),i.a.createElement(u.Geom,{type:"line",adjust:l,position:"key*value",color:v,shape:"smooth",size:2,animate:g}),i.a.createElement(R,{chartSeries:o,componentFlag:E.MARKER_COMPONENT_FRONT,imkComponent:w.FIELD_FRONT,adjust:l,colorField:N.FIELD_FRONT}),i.a.createElement(R,{chartSeries:o,componentFlag:E.MARKER_COMPONENT_BACK,imkComponent:w.FIELD_BACK,adjust:l,colorField:N.FIELD_BACK}))},D=t=>{var{chartSeries:o,chartOptions:r,name:d,width:s,height:h}=t,n=O(o),e=new b.a.View().source(n.data);e.transform({type:"fold",fields:n.series,key:"type",value:"value"}),r.flags.f100&&e.transform({type:"percent",dimension:"type",field:"value",groupBy:["key"],as:"value"});var l=r.flags.fStacked?"stack":"",a=o.map(c=>{var p,m;return(m=(p=c.format)===null||p===void 0?void 0:p.area)===null||m===void 0?void 0:m.rgbFore}).filter(c=>typeof c=="string"),v=a.length>0?["type",a]:["type",void 0];return i.a.createElement(u.Chart,{height:h,width:s,data:e,padding:"auto"},i.a.createElement("span",{className:"sv-chart-title"},d),i.a.createElement(u.Tooltip,{crosshairs:!0}),i.a.createElement(u.Axis,null),i.a.createElement(u.Legend,null),i.a.createElement(u.Geom,{type:"area",adjust:l,position:"key*value",color:v,shape:"smooth",size:2,animate:g}))},_=t=>{var{chartSeries:o,chartOptions:r,name:d,width:s,height:h}=t,n=O(o),e=new b.a.View().source(n.data);e.transform({type:"fold",fields:n.series,key:"type",value:"value"}),r.flags.f100&&e.transform({type:"percent",dimension:"type",field:"value",groupBy:["key"],as:"value"});var l=r.flags.fStacked?"intervalStack":"interval",a=r.flags.fTranspose?i.a.createElement(u.Coord,{transpose:!0,scale:[1,-1]}):i.a.createElement(u.Coord,{scale:[1,1]}),v=o.map(p=>{var m,y;return(y=(m=p.format)===null||m===void 0?void 0:m.area)===null||y===void 0?void 0:y.rgbFore}).filter(p=>typeof p=="string"),c=v.length>0?["type",v]:["type",void 0];return i.a.createElement(u.Chart,{height:h,width:s,data:e,padding:"auto"},i.a.createElement("span",{className:"sv-chart-title"},d),i.a.createElement(u.Tooltip,{crosshairs:!0}),a,i.a.createElement(u.Axis,null),i.a.createElement(u.Legend,null),i.a.createElement(u.Geom,{type:l,position:"key*value",color:c,shape:"smooth",adjust:[{type:"dodge",marginRatio:4/32}],animate:g}))},B=t=>{var{chartSeries:o,name:r,width:d,height:s}=t,h=O(o),n=new b.a.View().source(h.data);n.transform({type:"fold",fields:h.series,key:"type",value:"value"}),n.transform({type:"percent",dimension:"type",field:"value",groupBy:["key"],as:"value"});var e="type",l=Object.keys(h.data[0])[0];return n.transform({type:"filter",callback:a=>a.type===l}),e="key",i.a.createElement(u.Chart,{height:s,width:d,data:n,padding:"auto"},i.a.createElement("span",{className:"sv-chart-title"},r),i.a.createElement(u.Tooltip,{crosshairs:!0}),i.a.createElement(u.Axis,null),i.a.createElement(u.Legend,null),i.a.createElement(u.Coord,{type:"theta",radius:.65}),i.a.createElement(u.Geom,{type:"intervalStack",position:"value",color:e,shape:"smooth",tooltip:["key*value*type",(a,v,c)=>({name:"".concat(c,":").concat(a),value:"".concat((1e4*v|0)/100,"%")})],animate:g}))},G={Line:j,Bar:_,Bar3D:_,Line3D:j,Area:D,Area3D:D,Stock:void 0,Surface3D:void 0,Radar:void 0,Pie:B,OfPie:void 0,Pie3D:B,Doughnut:void 0,Scatter:void 0,Bubble:void 0,treemap:void 0,sunburst:void 0,regionMap:void 0,clusteredColumn:void 0,boxWhisker:void 0,waterfall:void 0,funnel:void 0};(function(t){t.RANGE="PtgArea3d",t.POINT="PtgRef3d"})(S||(S={}));var J=f(6),q=f(128),L=f(94),M=(t,o)=>{var r=Object(J.c)(t.c),d=t.r+1,s=o["".concat(r).concat(d)];return s?s.v:null},A=(t,o)=>t&&Array.isArray(t)?t.map(r=>{if(r[0]===S.POINT){var d=r[1][2];return M(d,o)}if(r[0]===S.RANGE)return((s,h)=>{for(var n=[],e=Math.min(s.s.r,s.e.r),l=Math.max(s.s.r,s.e.r),a=Math.min(s.s.c,s.e.c),v=Math.min(s.s.c,s.e.c),c=e;c<=l;c++)for(var p=a;p<=v;p++){var m=M({r:c,c:p},h);n.push(m)}return n})(r[1][2],o)}).reduce((r,d)=>r.concat(d),[]):[];class z extends k.Component{componentDidMount(){setTimeout(()=>{Object(L.a)()},0)}render(){var{children:o}=this.props;return o}}var V=(t,o)=>{var{chartSeries:r,chartOptions:d,chartType:s}=t,{chartTitle:h}=t;h||(h="");var n=((e,l)=>e&&Array.isArray(e)?e.map(a=>{var v,c,p,m;a=JSON.parse(JSON.stringify(a));try{!a.values.values&&a.values.formula&&(a.values.values=A(a.values.formula,l),delete a.values.formula)}catch(I){}try{if(!((v=a.label)===null||v===void 0?void 0:v.value)&&((c=a.label)===null||c===void 0?void 0:c.formula)){var[y]=A(a.label.formula,l);a.label.value=y,delete a.label.formula}}catch(I){}try{!((p=a.categories)===null||p===void 0?void 0:p.values)&&((m=a.categories)===null||m===void 0?void 0:m.formula)&&(a.categories.values=A(a.categories.formula,l),delete a.categories.formula)}catch(I){}return a}):e)(r,o);return function(e,l,a){e.classList.add("sv-handsontable-chart");var v=G[s]||q.a;typeof v=="function"?Object(P.render)(k.createElement(z,null,k.createElement(v,{width:l,height:a,chartSeries:n,chartOptions:d,name:h||""})),e):Object(L.a)()}}}}]);
