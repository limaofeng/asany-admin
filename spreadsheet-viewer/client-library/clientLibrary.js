var h=this&&this.__extends||function(){var r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var a in o)o.hasOwnProperty(a)&&(t[a]=o[a])},r(e,n)};return function(e,n){r(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}();export var ACTIVE_SHEET_CHANGED="activeSheetChanged",CELL_SELECTION_CHANGED="cellSelectionChanged",READY_FOR_MESSAGES="readyForMessages",VIEW_ACTIVATED="viewActivated",KEY_DOWN="keydown",KEY_UP="keyup",DROP="drop",DRAG_OVER="dragover",DRAG_LEAVE="dragleave",initTimeout=3e4;var s=function(r){h(e,r);function e(n){var t=r.call(this,n)||this;return t.name=t.constructor.name,t}return e}(Error);export{s as SpreadsheetViewerError};var f=function(r){var e=Math.random().toString(36).substring(2);return e.length<r?e+f(r-e.length):e.substring(0,r)},d=function(r,e){var n=r.lastIndexOf("?")+1;return r.substring(n).split("&").some(function(t){var o=t.split("=")[0];return o===e})},m=function(r,e,n){if(d(n,r))throw new s("url cannot contain a parameter that already exists ("+r+")");var t=n.indexOf("?")!==-1;return n+(t?"&":"?")+encodeURIComponent(r)+"="+encodeURIComponent(e)},E="Initialization timeout",w=function(r){return function(e){r.postMessage(e,"*")}};function v(r){var e=document.createElement("iframe");return e.className="spreadsheet-viewer-iframe",e.style.borderWidth="0",e.style.width="100%",e.style.height="100%",e.setAttribute("src",r),e}function b(r,e,n){if(typeof window.CustomEvent=="function"){var t=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});r.dispatchEvent(t)}else{var o=document.createEvent("CustomEvent");o.initCustomEvent(e,!0,!0,n)}}function u(r,e){return Object.prototype.hasOwnProperty.call(r,e)}var g=function(r){return function(e,n,t){if(typeof e!="string"&&!(e instanceof ArrayBuffer))throw new TypeError("Expected argument `workbook` to be either a string or an instance of ArrayBuffer, got "+typeof e);if(typeof n!="number")throw new TypeError("Expected argument `sheet` to be a number, got "+typeof n);if(t!==void 0&&typeof t!="string")throw new TypeError("Expected argument `fileName` to be either undefined or a string, got "+typeof t);if(e instanceof ArrayBuffer){if(t===void 0)throw new TypeError("Expected argument `fileName` to be present when `workbook` is an ArrayBuffer");r({name:"loadWorkbook",workbook:e,sheet:n,fileName:t})}else r({name:"loadWorkbook",workbook:e,sheet:n,fileName:t})}};function T(r){return r.every(function(e){return typeof e=="number"})}function _(r){return T(r)&&r.length===4}var x=function(r){return function(e){if(!Array.isArray(e))throw new TypeError("Expected `range` to be an array");if(!_(e))throw new TypeError("Expected `range` to be a range [number, number, number, number], got "+e);r({name:"selectCells",range:e})}},S=function(r){return function(e){if(typeof e!="object")throw new TypeError("Expected argument `config` to be an object, got "+typeof e);if(e===null)throw new TypeError("Expected argument `config` to not be null");var n=function(){if(!!u(e,"themeStylesheet")){if(typeof e.themeStylesheet!="string"||e.themeStylesheet!=="dark"&&e.themeStylesheet!=="light")throw new TypeError('config.themeStylesheet must either be undefined or "light" or "dark"');return e.themeStylesheet}}(),t=function(){if(!!u(e,"licenseKey")){if(typeof e.licenseKey!="string")throw new TypeError("config.licenseKey must either be undefined or string");return e.licenseKey}}();r({name:"configure",themeStylesheet:n,licenseKey:t})}},A=function(r){if(r===null)throw new s("Attempted to initialize the library before the contentWindow was ready.");var e=w(r);return{loadWorkbook:g(e),selectCells:x(e),configure:S(e)}};export var SpreadsheetViewer=function(r){if(typeof r!="object")throw new TypeError("`options` should be an object, got "+typeof r);if(r===null)throw new TypeError("`options` cannot be null");if(!u(r,"assetsUrl"))throw new TypeError("`options.assetsUrl` property must be present");if(typeof r.assetsUrl!="string")throw new TypeError("`assetsUrl` property should be of type `string`, got "+typeof r.assetsUrl);var e=r.assetsUrl;if(!u(r,"container"))throw new TypeError("`options.container` property must be present");if(!(r.container instanceof HTMLElement))throw new TypeError("`container` property should be an instance of HTMLElement");var n=r.container,t=f(32),o=m("svId",t,e);return new Promise(function(a,p){var l=setTimeout(function(){p(new s(E))},initTimeout),c=v(o);window.addEventListener("message",function(i){var y=i.data.id;if(y===t)switch(i.data.name){case ACTIVE_SHEET_CHANGED:case VIEW_ACTIVATED:case CELL_SELECTION_CHANGED:case KEY_DOWN:case KEY_UP:case DROP:case DRAG_OVER:case DRAG_LEAVE:b(n,i.data.name,i.data);break;case READY_FOR_MESSAGES:{clearTimeout(l),a(A(c.contentWindow));break}default:break}}),n.appendChild(c)})};
