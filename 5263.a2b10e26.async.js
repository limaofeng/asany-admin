(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[5263],{33442:function(ee,K,a){"use strict";var W=a(11849),b=a(3182),y=a(94043),O=a.n(y),h=a(67294),l=a(53704),F=a(25496);function H(R,k){var B=(0,h.useRef)(!1),G=(0,h.useCallback)((0,b.Z)(O().mark(function V(){var Z,S;return O().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return Z=R.width,v.next=3,l.u_.confirm((0,W.Z)((0,W.Z)({},R),{},{width:Z,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!B.current},preConfirm:function(){var w=(0,b.Z)(O().mark(function Q(){var n,e,z;return O().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return B.current=!0,g.prev=1,n=document.querySelector(".swal2-confirm"),n.textContent="\u5220\u9664\u4E2D...",e=document.createElement("span"),e.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),n.appendChild(e),g.next=9,(0,F.gw)(k(),350);case 9:z=g.sent,console.log(z);case 11:return g.prev=11,B.current=!1,g.finish(11);case 14:case"end":return g.stop()}},Q,null,[[1,,11,14]])}));function $(){return w.apply(this,arguments)}return $}()}));case 3:if(S=v.sent,S.isConfirmed){v.next=6;break}return v.abrupt("return",!1);case 6:return l.FN.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),v.abrupt("return",!0);case 8:case"end":return v.stop()}},V)})),[k,R]);return[G]}K.Z=H},45263:function(ee,K,a){"use strict";a.r(K);var W=a(93224),b=a(3182),y=a(2824),O=a(94043),h=a.n(O),l=a(67294),F=a(28865),H=a(94184),R=a.n(H),k=a(19755),B=a.n(k),G=a(30381),V=a.n(G),Z=a(80129),S=a.n(Z),D=a(73727),v=a(43219),w=a(8845),$=a(33442),Q=a(75468),n=a(53704),e=a(85893);window._MoreshowOrhide=function(c){return B()(c).parent().siblings().show(),B()(c).parent().remove(),!1};function z(c){var u=c.selectedRows,C=c.refetch,d=(0,w.nT)(),M=(0,y.Z)(d,1),N=M[0],T=(0,$.Z)({title:(0,e.jsxs)(e.Fragment,{children:["\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9",u.length>1&&(0,e.jsxs)(e.Fragment,{children:["\u201C",(0,e.jsx)("strong",{children:u.length}),"\u201C`"]}),"\u7BC7\u6587\u7AE0\u5417\uFF1F"]}),content:u.length>1?'\u60A8\u5373\u5C06\u5220\u9664\u4EE5\u4E0B\u6587\u7AE0:<ul className="py-2">'.concat(u.map(function(o,p){return"<li ".concat(p>=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 mb-1 fs-6"><span className="bullet bullet-dot me-2"></span><strong>').concat(o.title,"</strong></li>")}).join(""),`
              <li `).concat(u.length<=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 fs-6"><a href="javascript:void(0)" onClick="_MoreshowOrhide(this)">\u66F4\u591A</a></li></ul> '):(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:u[0].title}),"\u201D\u3002",(0,e.jsx)("br",{}),"\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})},(0,b.Z)(h().mark(function o(){return h().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,N({variables:{ids:u.map(function(E){return E.id})}});case 2:case"end":return r.stop()}},o)}))),_=(0,y.Z)(T,1),x=_[0],j=(0,l.useCallback)((0,b.Z)(h().mark(function o(){return h().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x();case 2:return r.next=4,C();case 4:case"end":return r.stop()}},o)})),[x,C]);return(0,e.jsx)(n.zx,{color:"danger",onClick:j,variant:!1,size:"sm",className:"px-4 py-2",children:"\u6279\u91CF\u5220\u9664"})}function J(c){var u=c.data,C=c.refetch,d=c.baseUrl,M=(0,l.useState)(!1),N=(0,y.Z)(M,2),T=N[0],_=N[1],x=(0,w.eU)(),j=(0,y.Z)(x,1),o=j[0],p=(0,$.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",content:(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:u.title}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})},(0,b.Z)(h().mark(function A(){return h().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,o({variables:{id:u.id}});case 2:case"end":return m.stop()}},A)}))),r=(0,y.Z)(p,1),E=r[0],I=(0,l.useCallback)((0,b.Z)(h().mark(function A(){return h().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,E();case 2:return m.next=4,C();case 4:case"end":return m.stop()}},A)})),[E,C]),Y=(0,l.useCallback)(function(A){var L=A.key;L=="edit"?v.m8.push("".concat(d,"/articles/").concat(u.id)):L=="delete"&&(_(!1),I())},[]);return(0,e.jsx)(n.Lt,{overlay:(0,e.jsxs)(n.v2,{onClick:Y,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(n.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(n.v2.Item,{className:"px-3",children:"\u53D1\u5E03"},"publish"),(0,e.jsx)(n.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:_,visible:T,children:(0,e.jsxs)(n.zx,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(F.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function g(c){var u,C,d=c.match.params.cid,M=c.location.state,N=M.rootCategoryId,T=M.categories,_=M.baseUrl,x=(0,l.useMemo)(function(){var s=c.location.query,i=s.q,t=(0,W.Z)(s,["q"]);return t.filter||(t.filter={}),i&&(t.filter={name_contains:i}),t.filter.category={id:d,subColumns:!0},t},[c.location,d]),j=(0,w.gk)({variables:x,fetchPolicy:"cache-and-network"}),o=j.data,p=j.refetch,r=j.loading,E=j.previousData,I=(0,l.useMemo)(function(){return r?(E==null?void 0:E.articles)||{edges:[],total:0,current:1}:(o==null?void 0:o.articles)||{edges:[],total:0,current:1}},[o==null?void 0:o.articles,r,E==null?void 0:E.articles]),Y=(0,l.useMemo)(function(){return I.edges.map(function(s){return s.node})},[I.edges]),A=(0,l.useCallback)(function(s){console.log(s)},[]),L=(0,l.useCallback)(function(s,i,t){var P,f={};if((P=x.filter)!==null&&P!==void 0&&P.name_contains){var U;f.q=(U=x.filter)===null||U===void 0?void 0:U.name_contains}t&&(f.orderBy=t.field+"_"+(t.order=="ascend"?"asc":"desc")),f.page=s.current,v.m8.replace(location.pathname+"?"+S().stringify(f))},[(u=x.filter)===null||u===void 0?void 0:u.name_contains]),m=(0,l.useState)([]),X=(0,y.Z)(m,2),ae=X[0],q=X[1],ne=(0,l.useCallback)(function(s,i){q(i)},[q]),te=(0,l.useMemo)(function(){return function(s,i){return(0,e.jsx)(z,{selectedRows:i,refetch:p})}},[p]);return(0,e.jsx)(Q.v,{loading:r,header:{title:(C=T.find(function(s){return s.id==d}))===null||C===void 0?void 0:C.name},children:(0,e.jsx)("div",{className:"tab-content",children:(0,e.jsxs)(n.Zb,{flush:!0,headerClassName:"mt-5",children:[(0,e.jsxs)(n.Zb.Header,{className:"pt-8",children:[(0,e.jsx)(n.Zb.Title,{className:"flex-column",children:(0,e.jsx)(n.II.Search,{solid:!0,className:"w-250px",placeholder:"\u641C\u7D22\u6587\u7AE0",onSearch:A})}),(0,e.jsx)(n.Zb.Toolbar,{children:(0,e.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,e.jsx)(n.Lt,{overlay:(0,e.jsxs)(n.v2,{className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(n.v2.Item,{className:"px-3",children:"\u6700\u65B0"},"edit"),(0,e.jsx)(n.v2.Item,{className:"px-3",children:"\u6700\u665A"},"publish"),(0,e.jsx)(n.v2.Item,{className:"px-3 actions-delete",children:"\u6700\u8FD1\u66F4\u65B0\u7684"},"delete"),(0,e.jsx)(n.v2.Item,{className:"px-3 actions-delete",children:"\u70B9\u51FB\u91CF"},"delete")]}),placement:"bottomLeft",children:(0,e.jsx)(n.zx,{variant:"white",className:"me-3",children:"\u6392\u5E8F: \u6700\u65B0"})}),(0,e.jsx)(n.zx,{as:D.Link,variant:"primary",className:"me-3",icon:(0,e.jsx)(F.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),to:"".concat(_,"/cms/categories/").concat(d,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]}),(0,e.jsx)(n.Zb.Body,{className:"pt-0",children:I.total?(0,e.jsx)(n.iA,{rowKey:"id",rowSelection:{type:"checkbox",onChange:ne,selectedRowKeys:(ae||[]).map(function(s){return s.id}),renderTitle:function(i){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:i}),"\u7BC7\u6587\u7AE0"]})},toolbar:te},pagination:I,dataSource:Y,onChange:L,rowHeight:136,columns:[{title:"\u6807\u9898",dataIndex:"title",key:"title",render:function(i,t){var P;return(0,e.jsxs)("div",{className:"d-flex flex-row tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"d-flex flex-column align-items-start tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"meta-container no-selecto-drag",children:[(0,e.jsx)(D.Link,{to:"/xx/12",className:"user-message",children:"\u6797\u66AE\u6625"}),(0,e.jsx)("span",{className:"created-at",children:V()(t.createdAt).fromNow()}),(0,e.jsx)("div",{className:"category_list",children:t.categories.filter(function(f){return f.id!==N}).map(function(f){return(0,e.jsx)(D.Link,{to:"".concat(_,"/cms/categories/").concat(f.id,"/articles"),className:"tag",children:f.name},f.id)})})]}),(0,e.jsx)(D.Link,{onClick:function(U){return U.stopPropagation()},to:"".concat(_,"/cms/categories/").concat(d,"/articles/").concat(t.id),className:"mt-2 mb-2 text-gray-800 no-selecto-drag fs-4 text-hover-primary mb-1",children:i}),(0,e.jsx)("div",{className:R()("summary mb-2 w-100 tw-text-ellipsis tw-truncate w-100",{"pe-8":!t.image}),children:(0,e.jsx)("span",{className:"text-muted fs-base no-selecto-drag",children:t.summary||"\u6CA1\u6709\u4EFB\u4F55\u5185\u5BB9..."})}),(0,e.jsxs)("div",{className:"fs-base",children:[(0,e.jsxs)(D.Link,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(_,"/cms/categories/").concat(d,"/articles/").concat(t.id),children:[(0,e.jsx)(F.ZP,{className:"svg-icon-4 me-2",name:"Bootstrap/eye"}),"41W"]}),(0,e.jsxs)(D.Link,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(_,"/cms/categories/").concat(d,"/articles/").concat(t.id,"#comments"),children:[(0,e.jsx)(F.ZP,{className:"svg-icon-6 me-2",name:"Bootstrap/chat"}),"41W"]})]})]}),t.image&&(0,e.jsx)("div",{className:"px-8 d-flex align-items-end",children:(0,e.jsx)(n.mN,{className:"article-image",src:"//47.103.119.188:8000"+"/preview/".concat((P=t.image)===null||P===void 0?void 0:P.id)})})]})}},{title:"\u72B6\u6001",dataIndex:"status",width:120,render:function(i){var t={DRAFT:{title:"\u8349\u7A3F",lightStyle:"danger"},PUBLISHED:{title:"\u5DF2\u53D1\u5E03"},SCHEDULED:{title:"\u8BA1\u5212",lightStyle:"primary"}};return(0,e.jsx)(n.Ct,{lightStyle:t[i].lightStyle,children:t[i].title})}},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(i,t){return(0,e.jsx)(J,{baseUrl:"".concat(_,"/cms/categories/").concat(d),data:t,refetch:p})}}]}):(0,e.jsxs)(n.HY,{title:"\u65B0\u589E\u6587\u7AE0",description:"\u8BE5\u680F\u76EE\u8FD8\u662F\u7A7A\u7684\uFF0C\u6CA1\u6709\u4EFB\u4F55\u6587\u7AE0",image:"/assets/media/illustrations/sigma-1/4.png",children:[(0,e.jsx)(n.zx,{as:D.Link,className:"me-2",variant:"light",to:"".concat(_,"/settings"),children:"\u67E5\u770B\u680F\u76EE\u4FE1\u606F"}),(0,e.jsx)(n.zx,{as:D.Link,variant:"primary",to:"".concat(_,"/cms/categories/").concat(d,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]})})})}K.default=g}}]);
