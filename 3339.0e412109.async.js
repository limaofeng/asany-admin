(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[3339],{83339:function(z,x,s){"use strict";s.r(x);var d=s(11849),D=s(3182),v=s(2824),A=s(94043),m=s.n(A),j=s(67294),b=s(81303),k=s(75468),a=s(11974),e=s(85893);function N(y){var p,l=y.match,n=y.history,T=(0,b.sc)({fetchPolicy:"cache-and-network"}),w=(0,v.Z)(T,2),C=w[0],M=w[1],g=M.data,O=M.loading,Z=(0,b.Yh)({}),F=(0,v.Z)(Z,2),L=F[0],R=F[1].loading,U=(0,b.M0)({}),B=(0,v.Z)(U,2),I=B[0],K=B[1].loading,t=l.params.id=="new",o=a.l0.useForm(),W=(0,j.useCallback)((0,D.Z)(m().mark(function c(){var u;return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.validateFields();case 2:if(u=r.sent,!t){r.next=8;break}return r.next=6,L({variables:{input:(0,d.Z)({},u)}});case 6:r.next=10;break;case 8:return r.next=10,I({variables:{id:l.params.id,input:(0,d.Z)({},u)}});case 10:a.FN.success("\u6D77\u62A5 \u201C".concat(u.name,"\u201D ").concat(t?"\u65B0\u589E":"\u4FEE\u6539","\u6210\u529F"),2e3,{placement:"bottom-start",progressBar:!0}),n.length?n.goBack():n.replace("/website/landing/posters");case 12:case"end":return r.stop()}},c)})),[L,l.params.id,o,n,t,I]);return(0,j.useEffect)(function(){if(l.params.id!="new"){var c=new AbortController;return C({variables:{id:l.params.id},context:{fetchOptions:{signal:c.signal}}}).then(function(){var u=(0,D.Z)(m().mark(function E(r){var f,P,h,_;return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(h=r.data,_=h==null?void 0:h.poster,_){i.next=7;break}return i.next=5,a.u_.error({content:"\u6D77\u62A5\u4E0D\u5B58\u5728,\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5220\u9664\u4E86",timer:3e3,timerProgressBar:!0});case 5:return n.length?n.goBack():n.replace("/website/landing/posters"),i.abrupt("return");case 7:o.setFieldsValue((0,d.Z)((0,d.Z)({},_),{},{music:(f=_.music)===null||f===void 0?void 0:f.id,background:(P=_.background)===null||P===void 0?void 0:P.id}));case 8:case"end":return i.stop()}},E)}));return function(E){return u.apply(this,arguments)}}()),function(){c.abort()}}},[o,C,n,l.params.id]),(0,e.jsx)(k.v,{header:t?{title:"\u65B0\u589E\u6D77\u62A5"}:void 0,footer:!1,children:(0,e.jsxs)(a.Zb,{className:"mb-5 mb-xl-10",children:[(0,e.jsx)(a.Zb.Header,{children:(0,e.jsx)(a.Zb.Title,{children:t?"\u65B0\u589E\u6D77\u62A5":g==null||(p=g.poster)===null||p===void 0?void 0:p.name})}),(0,e.jsxs)(a.Zb.Body,{children:[(0,e.jsx)(a.bH,{overlayClassName:"bg-white bg-opacity-25",loading:O,children:(0,e.jsxs)(a.l0,{form:o,className:"w-800px row d-flex flex-shrink-0 flex-column-reverse flex-md-row",children:[(0,e.jsxs)("div",{className:"col-12 col-md-8",children:[(0,e.jsx)(a.l0.Item,{className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(a.II,{solid:!0,className:"w-400px"})}),(0,e.jsx)(a.l0.Item,{className:"my-5",name:"music",label:"\u80CC\u666F\u97F3\u4E50",children:(0,e.jsx)(a.gq,{solid:!0,accept:".aif, .cda, .mid, .mp3, .mpa, .ogg, .wav, .wma, .wpl",space:"orX8kLOV",className:"w-400px"})}),(0,e.jsx)(a.l0.Item,{className:"my-5",name:"description",label:"\u63CF\u8FF0",help:"\u8BF7\u7528\u5C11\u4E8E250\u5B57\u7B26\u63CF\u8FF0",children:(0,e.jsx)(a.II.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:8},showCount:!0,maxLength:250,className:"w-400px"})})]}),(0,e.jsx)("div",{className:"col-12 col-md-4",children:(0,e.jsx)(a.l0.Item,{className:"mb-5",name:"background",label:"\u6D77\u62A5\u56FE\u7247",children:(0,e.jsx)(a.gq.Image,{width:375,height:812,space:"orX8kLOV",crop:!1})})})]})}),(0,e.jsx)(a.zx,{loading:O||R||K,onClick:W,children:t?(0,e.jsx)(e.Fragment,{children:"\u6DFB\u52A0\u6D77\u62A5"}):(0,e.jsx)(e.Fragment,{children:"\u4FEE\u6539\u6D77\u62A5\u4FE1\u606F"})})]})]})})}x.default=N}}]);
