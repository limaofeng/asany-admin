"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[948],{14336:function(ue,U,n){var H=n(15009),B=n.n(H),V=n(99289),I=n.n(V),z=n(97857),T=n.n(z),Q=n(5574),P=n.n(Q),s=n(62435),g=n(2721),f=n(12708);function l(t,e){return t.replace(/{(\w+)}/g,function(o,v){return e[v]!==void 0?e[v]:o})}function i(t,e){var o=t(T()({fetchPolicy:"network-only"},(e==null?void 0:e.mutation)||{})),v=P()(o,1),E=v[0],M=(0,s.useRef)(!1),r=(0,s.useRef)(null),S=(0,s.useCallback)(function(){var W=I()(B()().mark(function L(_,F){var K,re,X,b,u,d,y,k,x;return B()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return K=(F==null?void 0:F.dialog)||(e==null?void 0:e.dialog)||{},re=(F==null?void 0:F.mutation)||(e==null?void 0:e.mutation)||{},X=(F==null?void 0:F.onDeleted)||(e==null?void 0:e.onDeleted),b=K.width,u=K.title,d=K.content,y=!1,Array.isArray(_)?(y=!0,typeof u=="function"&&(u=u(_,{batch:!0})),typeof d=="function"&&(d=d(_,{batch:!0}))):_&&(typeof u=="string"&&(u=l(u,_)),typeof d=="string"&&(d=l(d,_)),typeof u=="function"&&(u=u(_,{batch:!1})),typeof d=="function"&&(d=d(_,{batch:!1}))),k=function(){var j=I()(B()().mark(function R(){return B()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,E(T()(T()({fetchPolicy:"network-only"},re),{},{variables:{where:{id_in:y?_:[_==null?void 0:_.id]}}}));case 2:case"end":return D.stop()}},R)}));return function(){return j.apply(this,arguments)}}(),a.next=10,g.Modal.confirm(T()(T()({},K),{},{title:u,content:d,width:b,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!M.current},preConfirm:function(){var j=I()(B()().mark(function N(){var D,A,$;return B()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return M.current=!0,r.current=null,c.prev=2,D=document.querySelector(".swal2-confirm"),D.textContent="\u5220\u9664\u4E2D...",A=document.createElement("span"),A.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),D.appendChild(A),c.next=10,(0,f.gw)(k(),350);case 10:$=c.sent,X&&X(_,$),c.next=17;break;case 14:c.prev=14,c.t0=c.catch(2),r.current=c.t0;case 17:return c.prev=17,M.current=!1,c.finish(17);case 20:case"end":return c.stop()}},N,null,[[2,14,17,20]])}));function R(){return j.apply(this,arguments)}return R}()}));case 10:if(x=a.sent,!r.current){a.next=14;break}return g.Toast.error("\u5220\u9664\u5931\u8D25:"+r.current.message,2e3,{placement:"top-center",progressBar:!0}),a.abrupt("return",!1);case 14:if(x.isConfirmed){a.next=16;break}return a.abrupt("return",!1);case 16:return g.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),a.abrupt("return",!0);case 18:case"end":return a.stop()}},L)}));return function(L,_){return W.apply(this,arguments)}}(),[]),ne=(0,s.useCallback)(function(W,L){return S(W,L)},[e,E]),ae=(0,s.useCallback)(function(W,L){return S(W,L)},[]);return{delete:ne,deleteMany:ae}}U.Z=i},58301:function(ue,U,n){n.d(U,{Oh:function(){return Q},bp:function(){return P}});var H=n(97857),B=n.n(H),V=n(62435);function I(s,g){var f,l,i=s(B()({fetchPolicy:"network-only"},g)),t=i.data,e=i.loading,o=i.previousData,v=i.refetch,E=i.error,M=(0,V.useMemo)(function(){return e?o==null?void 0:o.result.pageInfo:t==null?void 0:t.result.pageInfo},[t==null||(f=t.result)===null||f===void 0?void 0:f.pageInfo.total,e,o==null||(l=o.result)===null||l===void 0?void 0:l.pageInfo.total]),r=(0,V.useMemo)(function(){return t!=null&&t.result?t.result.edges.map(function(S){return S.node}):e&&o!==null&&o!==void 0&&o.result?o.result.edges.map(function(S){return S.node}):[]},[e,t==null?void 0:t.result,o==null?void 0:o.result]);return[r,{loading:e,pageInfo:M,error:E,variables:{},refetch:v}]}function z(s,g){return g.split(".").reduce(function(f,l){return f&&f[l]!==void 0?f[l]:void 0},s)}function T(s,g,f){for(var l=g.split("."),i=s;l.length>1;){var t=l.shift();i[t]||(i[t]={}),i=i[t]}i[l[0]]=f}function Q(s,g){var f=g.map(function(l){var i=l.source,t=l.target,e=l.transform,o=l.skip,v=z(s,i);if(v==null||o&&o(v))return"";var E=e?e(v):String(v);return"".concat(encodeURIComponent(t||i),"=").concat(encodeURIComponent(E))});return f.filter(function(l){return l}).join("&")}function P(s,g){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=f;return g.forEach(function(i){var t=i.source,e=i.target,o=i.transform,v=i.skip,E=s.get(t);if(!(!E||E.trim()==="")){var M=o?o(E):E;v&&v(M)||(e?T(l,e,M):l[t]=M)}}),l}U.ZP=I},40948:function(ue,U,n){n.r(U),n.d(U,{default:function(){return X}});var H=n(97857),B=n.n(H),V=n(15009),I=n.n(V),z=n(99289),T=n.n(z),Q=n(5574),P=n.n(Q),s=n(62435),g=n(39711),f=n(96974),l=n(46027),i=n(58301),t=n(73588),e=n(2721),o=n(12708),v=n(13769),E=n.n(v),M=n(60551),r=n(86074),S=["id"];function ne(b){var u=b.form,d=b.mode;return(0,r.jsxs)(e.Form,{form:u,children:[(0,r.jsx)(e.Form.Item,{className:"d-flex flex-column mb-7",name:"id",label:"\u7F16\u7801",rules:[{required:!0}],children:(0,r.jsx)(e.Input,{solid:!0,readOnly:d==="edit"})}),(0,r.jsx)(e.Form.Item,{className:"d-flex flex-column mb-7",name:"name",label:"\u540D\u79F0",rules:[{required:!0}],children:(0,r.jsx)(e.Input,{solid:!0})}),(0,r.jsx)(e.Form.Item,{className:"d-flex flex-column mb-7",name:"description",label:"\u63CF\u8FF0",children:(0,r.jsx)(e.Input.TextArea,{solid:!0})})]})}var ae=function(u){var d=(0,s.useState)(!1),y=P()(d,2),k=y[0],x=y[1],C=u.visible,a=u.data,j=u.refetch,R=(0,M.X9)(),N=P()(R,1),D=N[0],A=(0,M.f0)(),$=P()(A,1),Z=$[0],c=e.Form.useForm(),G=(0,s.useCallback)(function(){u.setVisible(!1)},[]),J=(0,s.useCallback)(T()(I()().mark(function te(){var Y,q,p;return I()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,c.validateFields();case 2:if(Y=m.sent,q=Y.id,p=E()(Y,S),x(!0),m.prev=6,!(a!=null&&a.id)){m.next=12;break}return m.next=10,Z({variables:{id:q,input:p}});case 10:m.next=14;break;case 12:return m.next=14,D({variables:{input:B()({id:q},p)}});case 14:u.setVisible(!1);case 15:return m.prev=15,x(!1),j(),m.finish(15);case 19:case"end":return m.stop()}},te,null,[[6,,15,19]])})),[j,a]);return(0,s.useEffect)(function(){C?a&&c.setFieldsValue({id:a.id,name:a.name,description:a.description}):c.resetFields()},[C,a]),(0,r.jsxs)(e.Modal,{width:640,centered:!0,onOk:J,confirmLoading:k,okText:"\u4FDD\u5B58",visible:C,onCancel:G,children:[(0,r.jsx)(e.Modal.Header,{closable:!0,className:"ms-5 border-0",children:(0,r.jsx)("h1",{className:"modal-title pt-6 pb-4",children:"\u6DFB\u52A0\u54C1\u724C"})}),(0,r.jsx)(e.Modal.Body,{children:(0,r.jsx)(ne,{form:c,mode:a!=null&&a.id?"edit":"create"})})]})},W=n(14336),L=n(86235);function _(b){var u=(0,W.Z)(L.rD,{onDeleted:function(){b&&b()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(x,C){var a;if(C.batch){var j=x;a="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(j.length," \u4E2A\u54C1\u724C\u5417\uFF1F")}else a=(0,r.jsxs)(r.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,r.jsx)("strong",{children:x.name})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"tip-confirm",children:a}),(0,r.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),d=u.delete,y=u.deleteMany;return{delete:d,deleteMany:y}}var F=_;function K(b){var u=b.data,d=b.refetch,y=b.onEdit,k=(0,s.useState)(!1),x=P()(k,2),C=x[0],a=x[1],j=F(function(){return d()}),R=j.delete,N=(0,s.useCallback)(function(D){var A=D.key;A==="edit"?y():A==="delete"&&R({name:u.name,id:u.id})},[y]);return(0,r.jsx)(e.Dropdown,{overlay:(0,r.jsxs)(e.Menu,{onClick:N,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,r.jsx)(e.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,r.jsx)(e.Menu.Item,{className:"px-3",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:a,visible:C,children:(0,r.jsxs)(e.Button,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,r.jsx)(l.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function re(){var b=(0,s.useState)({visible:!1}),u=P()(b,2),d=u[0],y=u[1],k=(0,g.lr)(),x=P()(k,1),C=x[0],a=(0,f.s0)(),j=(0,s.useMemo)(function(){return(0,i.bp)(C,[{source:"q",target:"keywords"}])},[C.get("q")]),R=(0,s.useCallback)(function(p,h,m){var w=(0,i.Oh)({searchForm:j,pagination:p,filters:h,sorter:m},[{source:"searchForm.keywords",target:"q",skip:function(O){return!O}},{source:"pagination.current",target:"page",skip:function(O){return O===1}},{source:"pagination.pageSize",target:"per_page",skip:function(O){return O===15}},{source:"sorter.field",target:"sort",transform:function(O){return"".concat(O,":").concat(m.order==="ascend"?"asc":"desc")}}]);a(location.pathname+"?"+w,{replace:!0})},[j]),N=(0,s.useMemo)(function(){return(0,i.bp)(C,[{source:"q",target:"where.name_contains"},{source:"sex",target:"where.sex"},{source:"page",transform:function(h){return parseInt(h)}},{source:"per_page",transform:function(h){return parseInt(h)}},{source:"sort",target:"orderBy",transform:function(h){var m=h.split(":"),w=P()(m,2),ee=w[0],O=w[1];return"".concat(ee,"_").concat(O)}}])},[C.toString()]),D=(0,i.ZP)(M.ac,{variables:N}),A=P()(D,2),$=A[0],Z=A[1],c=Z.loading,G=Z.pageInfo,J=Z.refetch,te=F(function(){return J()}),Y=te.deleteMany,q=(0,s.useCallback)(function(p){return T()(I()().mark(function h(){return I()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:Y(p);case 1:case"end":return w.stop()}},h)}))},[]);return(0,r.jsxs)(t.vs,{header:{title:"\u54C1\u724C\u5217\u8868"},children:[(0,r.jsx)(ae,{visible:d.visible,setVisible:function(h){return y(B()(B()({},d),{},{visible:h}))},refetch:J,data:d.data}),!(G!=null&&G.total)&&!c?(0,r.jsx)(e.Card,{className:"mb-5 mb-xl-10",children:(0,r.jsx)(e.Empty,{title:"\u8FD8\u6CA1\u6709\u54C1\u724C",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u54C1\u724C\u5427\uFF01",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,r.jsx)(e.Button,{variant:"primary",children:"\u6DFB\u52A0\u54C1\u724C"})})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(e.Card,{className:"mb-5 mb-xl-10",children:[(0,r.jsxs)(e.Card.Header,{className:"pt-8",children:[(0,r.jsx)(e.Card.Title,{className:"flex-column"}),(0,r.jsx)(e.Card.Toolbar,{children:(0,r.jsx)("div",{className:"d-flex justify-content-end",children:(0,r.jsx)(e.Button,{variant:"primary",className:"me-3",icon:(0,r.jsx)(l.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),onClick:function(){return y({visible:!0})},children:"\u6DFB\u52A0\u54C1\u724C"})})})]}),(0,r.jsx)(e.Card.Body,{children:(0,r.jsx)(e.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:c,children:(0,r.jsx)(e.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(h){return(0,r.jsxs)(r.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,r.jsx)("span",{className:"mx-2",children:h}),"\u4E2A\u54C1\u724C"]})},toolbar:function(h){return(0,r.jsx)("div",{children:(0,r.jsx)(e.Button,{color:"success",onClick:q(h),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},noRowsRenderer:function(){return(0,r.jsx)(e.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"id",title:"\u7F16\u7801",sorter:!0,sortOrder:(0,o.PE)(C,"id"),width:120},{key:"name",title:"\u54C1\u724C\u540D\u79F0",sorter:!0,width:180,sortOrder:(0,o.PE)(C,"name")},{key:"description",title:"\u63CF\u8FF0"},{key:"createdAt",title:"\u521B\u5EFA\u65F6\u95F4",width:120},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(h,m){return(0,r.jsx)(K,{data:m,onEdit:function(){y({visible:!0,data:m})},refetch:J})}}],pagination:G,onChange:R,dataSource:$})})})]})})]})}var X=re}}]);
