(self.webpackChunk=self.webpackChunk||[]).push([[3733],{78277:function(pe,Y,t){"use strict";t.d(Y,{Z:function(){return K}});var q=t(62435),f=t(12845),B=t(75981),j=t(90875);function z(){var E=(0,f.useModel)("tenant"),o=E.state,n=E.reload,s=(0,f.useApp)(),C=(0,j.Z)(),g=C.data;return(0,q.useEffect)(function(){o||(s&&s.type===B.vQ.Native?(console.log("useCurrentTenant By Native"),n(s.clientId)):g&&s.type===B.vQ.SaaS&&(console.log("useCurrentTenant By SaaS"),n(s.clientId)))},[s,g]),{tenant:o,loading:!1,error:""}}var R=z;function W(E){var o=R(),n=o.tenant,s=n==null?void 0:n.modules.find(function(C){return C.key===E});return[s]}var K=W},14336:function(pe,Y,t){"use strict";var q=t(15009),f=t.n(q),B=t(99289),j=t.n(B),z=t(97857),R=t.n(z),W=t(5574),K=t.n(W),E=t(62435),o=t(79817),n=t(12708);function s(g,_){return g.replace(/{(\w+)}/g,function(d,D){return _[D]!==void 0?_[D]:d})}function C(g,_){var d=g(R()({fetchPolicy:"network-only"},(_==null?void 0:_.mutation)||{})),D=K()(d,1),F=D[0],G=(0,E.useRef)(!1),Z=(0,E.useCallback)(function(){var I=j()(f()().mark(function S(c,v){var k,L,e,H,T,P,V,ee,re;return f()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return k=(v==null?void 0:v.dialog)||(_==null?void 0:_.dialog)||{},L=(v==null?void 0:v.mutation)||(_==null?void 0:_.mutation)||{},e=(v==null?void 0:v.onDeleted)||(_==null?void 0:_.onDeleted),H=k.width,T=k.title,P=k.content,V=!1,Array.isArray(c)?(V=!0,typeof T=="function"&&(T=T(c,{batch:!0})),typeof P=="function"&&(P=P(c,{batch:!0}))):c&&(typeof T=="string"&&(T=s(T,c)),typeof P=="string"&&(P=s(P,c)),typeof T=="function"&&(T=T(c,{batch:!1})),typeof P=="function"&&(P=P(c,{batch:!1}))),ee=function(){var h=j()(f()().mark(function u(){return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,F(R()(R()({fetchPolicy:"network-only"},L),{},{variables:{where:{id_in:V?c:[c==null?void 0:c.id]}}}));case 2:case"end":return y.stop()}},u)}));return function(){return h.apply(this,arguments)}}(),U.next=10,o.Modal.confirm(R()(R()({},k),{},{title:T,content:P,width:H,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!G.current},preConfirm:function(){var h=j()(f()().mark(function x(){var y,$,X;return f()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return G.current=!0,w.prev=1,y=document.querySelector(".swal2-confirm"),y.textContent="\u5220\u9664\u4E2D...",$=document.createElement("span"),$.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),y.appendChild($),w.next=9,(0,n.gw)(ee(),350);case 9:X=w.sent,e&&e(X);case 11:return w.prev=11,G.current=!1,w.finish(11);case 14:case"end":return w.stop()}},x,null,[[1,,11,14]])}));function u(){return h.apply(this,arguments)}return u}()}));case 10:if(re=U.sent,re.isConfirmed){U.next=13;break}return U.abrupt("return",!1);case 13:return o.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),U.abrupt("return",!0);case 15:case"end":return U.stop()}},S)}));return function(S,c){return I.apply(this,arguments)}}(),[]),J=(0,E.useCallback)(function(){var I=j()(f()().mark(function S(c,v){return f()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.abrupt("return",Z(c,v));case 1:case"end":return L.stop()}},S)}));return function(S,c){return I.apply(this,arguments)}}(),[_,F]),r=(0,E.useCallback)(function(I,S){return Z(I,S)},[]);return{delete:J,deleteMany:r}}Y.Z=C},55811:function(pe,Y,t){"use strict";var q=t(97857),f=t.n(q),B=t(52677),j=t.n(B),z=t(61227),R=t.n(z),W=t(62435),K=t(32512),E=t(93162),o=t.n(E),n=t(84105),s=function(d){var D=d.split(`
`);return D.map(function(F){return F.split(",")})},C=function(d,D){var F=R()(d),G=F[0],Z=F.slice(1);return Z.map(function(J){for(var r={},I=0,S=Object.keys(D.fields);I<S.length;I++){var c=S[I],v=D.fields[c];typeof v=="number"?r[c]=J[v]:typeof v=="string"?r[c]=J[G.indexOf(v)]:j()(v)==="object"&&(r[c]=typeof v.index=="string"?J[G.indexOf(v.index)]:J[v.index],v.formatter&&(r[c]=v.formatter(r[c])))}return r})};function g(_,d){var D=(0,W.useCallback)(function(c){var v=c[0];if(v){var k=new FileReader;k.onload=function(L){var e=v.name.split(".").pop().toLowerCase();if(e==="csv"){var H=L.target.result,T=s(H);console.log("Parsed CSV Data:",T)}else if(e==="xls"||e==="xlsx"){var P=L.target.result,V=n.ij(P,{type:"binary"}),ee=V.SheetNames[0],re=V.Sheets[ee],oe=n.P6.sheet_to_json(re,{header:d.header||1,raw:!1,dateNF:"yyyy-mm-dd hh:mm:ss"}),U=C(oe,d);console.log("Formatted JSON Data:",U),_(U)}else console.error("Unsupported file type")},v.type==="text/csv"||v.name.endsWith(".csv")?k.readAsText(v):k.readAsBinaryString(v)}},[_]),F=(0,K.uI)({onDrop:D,accept:{"text/csv":[".csv"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},maxFiles:1}),G=F.getRootProps,Z=F.getInputProps,J=G(),r=J.onClick,I=(0,W.useCallback)(function(c){console.log("handleImportExcel"),r&&r(c)},[r]),S=(0,W.useCallback)(function(){var c,v,k=Object.keys(d.fields).map(function(u){var x=d.fields[u];return j()(x)==="object"&&x.name||u}),L=Object.keys(d.fields).map(function(u){var x=d.fields[u];return j()(x)==="object"&&x.example||""}),e=[k,L],H=n.P6.aoa_to_sheet(e);(c=d.template)!==null&&c!==void 0&&c.cols&&(H["!cols"]=d.template.cols);for(var T=0,P=1;P<T;P++)for(var V=0;V<k.length;V++){var ee=n.P6.encode_cell({r:P,c:V});H[ee]||(H[ee]={v:null});var re=d.fields[k[V]];if(j()(re)==="object"){switch(re.type){case"date":H[ee].t="d";break}re.format&&(H[ee].z=re.format)}}var oe=n.P6.book_new();n.P6.book_append_sheet(oe,H,"Sheet1");var U=n.cW(oe,{bookType:"xlsx",type:"array"}),h=new Blob([U],{type:"application/octet-stream"});o()(h,((v=d.template)===null||v===void 0?void 0:v.filename)||"template.xlsx")},[d]);return[(0,W.createElement)("input",f()(f()({},Z()),{},{key:"file-input",value:""})),I,S,{data:{},error:"",handleImportExcel:I}]}Y.Z=g},58301:function(pe,Y,t){"use strict";t.d(Y,{Oh:function(){return W},bp:function(){return K}});var q=t(97857),f=t.n(q),B=t(62435);function j(E,o){var n,s,C=E(f()({fetchPolicy:"network-only"},o)),g=C.data,_=C.loading,d=C.previousData,D=C.refetch,F=C.error;console.log("=====>",g,o);var G=(0,B.useMemo)(function(){return _?d==null?void 0:d.result.pageInfo:g==null?void 0:g.result.pageInfo},[g==null||(n=g.result)===null||n===void 0?void 0:n.pageInfo.total,_,d==null||(s=d.result)===null||s===void 0?void 0:s.pageInfo.total]),Z=(g==null?void 0:g.result.edges.map(function(J){return J.node}))||[];return[Z,{loading:_,pageInfo:G,error:F,variables:{},refetch:D}]}function z(E,o){return o.split(".").reduce(function(n,s){return n&&n[s]!==void 0?n[s]:void 0},E)}function R(E,o,n){for(var s=o.split("."),C=E;s.length>1;){var g=s.shift();C[g]||(C[g]={}),C=C[g]}C[s[0]]=n}function W(E,o){var n=o.map(function(s){var C=s.source,g=s.target,_=s.transform,d=s.skip,D=z(E,C);if(D==null||d&&d(D))return"";var F=_?_(D):String(D);return"".concat(encodeURIComponent(g||C),"=").concat(encodeURIComponent(F))});return n.filter(function(s){return s}).join("&")}function K(E,o){var n={};return o.forEach(function(s){var C=s.source,g=s.target,_=s.transform,d=s.skip,D=E.get(C);if(!(!D||D.trim()==="")){var F=_?_(D):D;d&&d(F)||(g?R(n,g,F):n[C]=F)}}),n}Y.ZP=j},80537:function(pe,Y,t){"use strict";var q=t(14336),f=t(96944),B=t(86074);function j(z){var R=(0,q.Z)(f.nT,{onDeleted:function(){z&&z()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(o,n){var s;if(n.batch){var C=o;s="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(C.length," \u7BC7\u6587\u7AE0\u5417\uFF1F")}else s=(0,B.jsxs)(B.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,B.jsx)("strong",{children:o.title})]});return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("p",{className:"tip-confirm",children:s}),(0,B.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),W=R.delete,K=R.deleteMany;return{delete:W,deleteMany:K}}Y.Z=j},34773:function(pe,Y,t){"use strict";t.r(Y),t.d(Y,{default:function(){return U}});var q=t(97857),f=t.n(q),B=t(15009),j=t.n(B),z=t(64599),R=t.n(z),W=t(99289),K=t.n(W),E=t(5574),o=t.n(E),n=t(62435),s=t(96974),C=t(39711),g=t(46027),_=t(30381),d=t.n(_),D=t(78277),F=t(14336),G=t(55811),Z=t(58301),J=t(73588),r=t(79817),I=t(42646),S=t(75981),c=t(12708),v=t(5618),k=t(80537),L=t(96944),e=t(86074);function H(h,u){var x=r.Form.useForm(),y=(0,n.useState)(!1),$=o()(y,2),X=$[0],N=$[1],w=u||{},b=w.messages,ue=w.onSubmitted,ne=ue===void 0?function(){}:ue,ie=w.transform,de=ie===void 0?function(te){return te}:ie,_e=(0,L.uw)({fetchPolicy:"no-cache",refetchQueries:u==null?void 0:u.refetchQueries}),ge=o()(_e,1),ce=ge[0],Ce=(0,L.Mq)({fetchPolicy:"no-cache",refetchQueries:u==null?void 0:u.refetchQueries}),ye=o()(Ce,1),he=ye[0],De=(0,n.useMemo)(function(){return h!=null&&h.id?K()(j()().mark(function te(){var se,ae,me;return j()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return N(!0),i.prev=1,i.t0=de,i.next=5,x.validateFields();case 5:return i.t1=i.sent,se=(0,i.t0)(i.t1),i.next=9,r.Toast.promise((0,c.gw)(he({variables:{id:h.id,input:f()({},se)}}),350),{pending:(b==null?void 0:b.pending)||"\u4FDD\u5B58\u4E2D...",success:{render:function(){return(0,e.jsxs)(e.Fragment,{children:["\u8DEF\u7531 ",(0,e.jsx)("strong",{children:se.name})," \u4FDD\u5B58\u6210\u529F"]})}},error:(b==null?void 0:b.error)||"\u4FDD\u5B58\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 9:ae=i.sent,me=ae.data,ne(me.updateArticle),N(!1),i.next=18;break;case 15:i.prev=15,i.t2=i.catch(1),N(!1);case 18:case"end":return i.stop()}},te,null,[[1,15]])})):K()(j()().mark(function te(){var se,ae,me;return j()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return N(!0),i.prev=1,i.t0=de,i.next=5,x.validateFields();case 5:return i.t1=i.sent,se=(0,i.t0)(i.t1),i.next=9,r.Toast.promise((0,c.gw)(ce({variables:{input:f()({},se)}}),350),{pending:(b==null?void 0:b.pending)||"\u63D0\u4EA4\u4E2D...",success:{render:(b==null?void 0:b.pending)||"\u63D0\u4EA4\u6210\u529F"},error:(b==null?void 0:b.error)||"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 9:ae=i.sent,me=ae.data,ne(me.createArticle),N(!1),i.next=18;break;case 15:i.prev=15,i.t2=i.catch(1),N(!1);case 18:case"end":return i.stop()}},te,null,[[1,15]])}))},[ce,h==null?void 0:h.id,x,ne,he]);return[De,{form:x,submitting:X}]}var T=H;function P(h){var u=h.form;return(0,n.useEffect)(function(){var x,y=h.data;y.id||u.resetFields(),u.setFieldsValue(f()(f()({},y),{},{tags:(y.tags||[]).map(function($){return $.name}),content:(x=y.content)===null||x===void 0?void 0:x.rawUrl.replace("storage://","").split("/").pop()}))},[u,h.data]),(0,e.jsxs)(r.Form,{form:u,children:[(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"title",className:"d-flex flex-column mb-7",required:!0,label:"CMMF CODE",rules:[{required:!0,message:"CMMF CODE\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.Input,{solid:!0})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"tags",className:"d-flex flex-column mb-7",required:!0,label:"WMF CODE",children:(0,e.jsx)(v.ZP,{className:"form-control form-control-solid"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"content",className:"d-flex flex-column mb-7",required:!0,label:"\u6587\u4EF6\u8DEF\u5F84",rules:[{required:!0,message:"\u6587\u4EF6\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.Input.TextArea,{solid:!0,autoSize:{minRows:2,maxRows:2}})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"scheduledAt",className:"d-flex flex-column mb-7",label:"\u53D1\u5E03\u65F6\u95F4",rules:[{required:!0,message:"\u53D1\u5E03\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.DatePicker,{solid:!0,className:"w-100"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{name:"expirationAt",className:"d-flex flex-column mb-7",label:"\u8FC7\u671F\u65F6\u95F4",rules:[{required:!0,message:"\u8FC7\u671F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(r.DatePicker,{solid:!0,className:"w-100"})})})}),(0,e.jsx)(r.Row,{children:(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Form.Item,{className:"d-flex flex-column mb-7",name:"summary",label:"\u5907\u6CE8",children:(0,e.jsx)(r.Input.TextArea,{solid:!0,autoSize:{minRows:4,maxRows:6}})})})})]})}function V(h){var u=h.data,x=h.visible,y=h.onClose,$=h.onSuccess,X=h.onDeleteSuccess,N=(0,D.Z)("drive"),w=o()(N,1),b=w[0],ue=b==null?void 0:b.values.space,ne=T(u,{transform:function(te){return f()(f()({},te),{},{content:{type:"PDF",url:"storage://".concat(ue,"/").concat(te.content)},category:"conformity"})},onSubmitted:$}),ie=o()(ne,2),de=ie[0],_e=ie[1],ge=_e.form,ce=_e.submitting,Ce=(0,n.useMemo)(function(){return u?f()({},u):{}},[u]),ye=(0,k.Z)(function(){return X(u)}),he=ye.delete;return(0,e.jsx)(r.Drawer,{title:u!=null&&u.id?"\u7F16\u8F91":"\u65B0\u589E",placement:"right",width:640,mask:!0,closable:!0,onClose:y,visible:x,footer:(0,e.jsxs)(r.Row,{children:[(0,e.jsx)(r.Col,{span:6,children:(0,e.jsx)(r.Button,{style:{letterSpacing:"1rem"},className:"w-100",loading:ce,onClick:de,children:"\u4FDD\u5B58"})}),(0,e.jsx)(r.Col,{span:6,children:(u==null?void 0:u.id)&&(0,e.jsx)(r.Button,{style:{letterSpacing:"1rem"},className:"w-100",variant:"light-danger",onClick:function(){return he(u)},children:"\u5220\u9664"})})]}),children:u&&(0,e.jsx)(P,{submitting:ce,data:Ce,form:ge,submit:de,onDeleteSuccess:X})})}var ee=V;function re(h){var u=h.data,x=h.delete,y=h.onEdit,$=(0,n.useState)(!1),X=o()($,2),N=X[0],w=X[1],b=(0,n.useCallback)(function(ue){var ne=ue.key;ne==="edit"?y(u):ne==="delete"&&x({name:u.title,id:u.id})},[]);return(0,e.jsx)(r.Dropdown,{overlay:(0,e.jsxs)(r.Menu,{onClick:b,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-2",children:[(0,e.jsx)(r.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(r.Menu.Item,{className:"actions-delete px-3",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:w,visible:N,children:(0,e.jsxs)(r.Button,{variant:"clean",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(g.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function oe(){var h=(0,s.s0)(),u=(0,C.lr)(),x=o()(u,1),y=x[0],$=(0,D.Z)("drive"),X=o()($,1),N=X[0],w=N==null?void 0:N.values.space,b=(0,n.useMemo)(function(){return(0,Z.bp)(y,[{source:"q",target:"keywords"}])},[y.get("q")]);(0,n.useState)({keywords:y.get("q")||""});var ue=(0,n.useMemo)(function(){return(0,Z.bp)(y,[{source:"q",target:"where.name_contains"},{source:"sex",target:"where.sex"},{source:"page",transform:function(a){return parseInt(a)}},{source:"per_page",transform:function(a){return parseInt(a)}},{source:"sort",target:"orderBy",transform:function(a){var M=a.split(":"),l=o()(M,2),O=l[0],A=l[1];return"".concat(O,"_").concat(A)}}])},[y.toString()]),ne=(0,I.Y9)({fetchPolicy:"network-only"}),ie=o()(ne,1),de=ie[0],_e=(0,I.uw)(),ge=o()(_e,1),ce=ge[0],Ce=(0,I.Mq)(),ye=o()(Ce,1),he=ye[0],De=(0,Z.ZP)(I.gk,{variables:ue}),te=o()(De,2),se=te[0],ae=te[1],me=ae.loading,je=ae.pageInfo,i=ae.refetch,Pe=(0,n.useCallback)(function(m,a,M){var l=(0,Z.Oh)({searchForm:b,pagination:m,filters:a,sorter:M},[{source:"searchForm.keywords",target:"q",skip:function(A){return!A}},{source:"pagination.current",target:"page",skip:function(A){return A===1}},{source:"pagination.pageSize",target:"per_page",skip:function(A){return A===15}},{source:"sorter.field",target:"sort",transform:function(A){return"".concat(A,":").concat(M.order==="ascend"?"asc":"desc")}}]);h(location.pathname+"?"+l,{replace:!0})},[b]),Le=(0,n.useCallback)(function(m){h(location.pathname+(m?"?q="+m:""),{replace:!0})},[]),Ue=(0,n.useCallback)(function(){var m=K()(j()().mark(function a(M){var l,O,A,ve,Te,Q,Me,Ae,Oe,le,Fe,Re,Ee,ke,be;return j()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:l={totalRecords:0,insertCount:0,updateCount:0,failureCount:0,failedRecords:[],startTime:null,endTime:null},l.totalRecords=M.length,O=r.Toast.loading("\u5F00\u59CB\u5BFC\u5165\u6587\u4EF6",{placement:"top-center"}),l.startTime=new Date,A=0,ve=R()(M),p.prev=6,ve.s();case 8:if((Te=ve.n()).done){p.next=49;break}return Q=Te.value,A++,p.prev=11,p.next=14,de({variables:{where:{title:Q.title}}});case 14:if(Oe=p.sent,le=Oe.data,Fe={title:Q.title,summary:Q.summary,tags:Q.tag?[Q.tag]:[],scheduledAt:Q.scheduledAt,expirationAt:Q.expirationAt,category:"conformity",content:{type:"PDF",url:"storage://".concat(w,"/")+Q.file}},(le==null||(Me=le.result)===null||Me===void 0?void 0:Me.pageInfo.total)!==1){p.next=28;break}return O.update("\u66F4\u65B0 ".concat(Q.title," - ").concat(A,"/").concat(l.totalRecords),{icon:"loading"}),p.next=21,he({variables:{id:le.result.edges[0].node.id,input:Fe}});case 21:if(Re=p.sent,Ee=Re.errors,!(Ee!=null&&Ee.length)){p.next=25;break}throw new Error(Ee[0].message);case 25:l.updateCount++,p.next=40;break;case 28:if((le==null||(Ae=le.result)===null||Ae===void 0?void 0:Ae.pageInfo.total)!==0){p.next=39;break}return O.update("\u65B0\u589E ".concat(Q.title," - ").concat(A,"/").concat(l.totalRecords),{icon:"loading"}),p.next=32,ce({variables:{input:Fe}});case 32:if(ke=p.sent,be=ke.errors,!(be!=null&&be.length)){p.next=36;break}throw new Error(be[0].message);case 36:l.insertCount++,p.next=40;break;case 39:l.failureCount++;case 40:p.next=47;break;case 42:p.prev=42,p.t0=p.catch(11),O.update("\u5931\u8D25 ".concat(Q.title," - ").concat(A,"/").concat(l.totalRecords),{icon:"error"}),l.failureCount++,l.failedRecords.push({record:Q,error:p.t0});case 47:p.next=8;break;case 49:p.next=54;break;case 51:p.prev=51,p.t1=p.catch(6),ve.e(p.t1);case 54:return p.prev=54,ve.f(),p.finish(54);case 57:l.endTime=new Date,console.log("Import Summary:",l),O.close(),i(),r.Modal.success({title:"\u64CD\u4F5C\u6210\u529F",width:600,content:(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:["\u5BFC\u5165\u5B8C\u6210, \u5171 ",l.totalRecords," \u6761\u8BB0\u5F55, \u6210\u529F"," ",l.insertCount," \u6761, \u66F4\u65B0 ",l.updateCount," \u6761, \u5931\u8D25 ",l.failureCount," \u6761"]}),(0,e.jsxs)("p",{children:["\u8017\u65F6:"," ",d()(l.endTime).diff(l.startTime,"seconds")," ","\u79D2"]}),(0,e.jsxs)("p",{children:["\u603B\u8BB0\u5F55\u6570: ",l.totalRecords]}),(0,e.jsxs)("p",{children:["\u63D2\u5165\u6570\u91CF: ",l.insertCount]}),(0,e.jsxs)("p",{children:["\u66F4\u65B0\u6570\u91CF: ",l.updateCount]}),(0,e.jsxs)("p",{children:["\u5931\u8D25\u6570\u91CF: ",l.failureCount]})]}),allowOutsideClick:!1});case 62:case"end":return p.stop()}},a,null,[[6,51,54,57],[11,42]])}));return function(a){return m.apply(this,arguments)}}(),[i,w]),Ne=(0,G.Z)(Ue,{header:1,fields:{title:{index:0,name:"CMMF CODE",example:"W22L1",formatter:function(a){return String(a).trim()}},tag:{index:1,name:"WMF CODE",example:"YS22ED",formatter:function(a){return String(a).trim()}},scheduledAt:{index:2,name:"\u53D1\u5E03\u65F6\u95F4",example:"2024/8/22 0:00",formatter:function(a){return String(a).trim()&&d()(a).format("YYYY-MM-DD HH:mm")}},expirationAt:{index:3,name:"\u7ED3\u675F\u65F6\u95F4",example:"2024/8/31 0:00",formatter:function(a){return String(a).trim()&&d()(a).format("YYYY-MM-DD HH:mm")}},file:{index:4,name:"\u6587\u4EF6\u4F4D\u7F6E",example:"3201000159 1873596030 \u7092\u9505\u94F2.pdf.pdf",formatter:function(a){return String(a).trim()}},summary:{index:5,name:"\u5907\u6CE8",example:"",formatter:function(a){return String(a).trim()}}},template:{filename:"\u7B26\u5408\u6027\u89C4\u8303\u6279\u91CF\u4E0A\u4F20.xlsx",cols:[{wch:20},{wch:20},{wch:20},{wch:20},{wch:50},{wch:30}]}}),xe=o()(Ne,3),We=xe[0],Ke=xe[1],$e=xe[2],we=(0,F.Z)(I.nT,{onDeleted:function(){return i()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(a,M){var l;if(M.batch){var O=a;l="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(O.length," \u4E2A\u6587\u4EF6\u5417\uFF1F")}else l=(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:a.name})]});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:l}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),Ye=we.delete,Be=we.deleteMany,Ze=(0,n.useCallback)(function(m){return K()(j()().mark(function a(){return j()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:Be(m);case 1:case"end":return l.stop()}},a)}))},[Be]),He=(0,n.useState)({visible:!1}),Ie=o()(He,2),Se=Ie[0],fe=Ie[1],Ve=(0,n.useCallback)(function(){fe(function(m){return f()(f()({},m),{},{visible:!1})})},[]),Qe=(0,n.useCallback)(function(m){fe(function(a){return f()(f()({},a),{},{route:m})}),i()},[fe]),ze=(0,n.useCallback)(function(m){fe(function(a){var M;return((M=a.data)===null||M===void 0?void 0:M.id)!==m.id?a:f()(f()({},a),{},{visible:!1,menu:void 0})}),i()},[fe]),Ge=(0,n.useCallback)(function(){fe(function(m){return f()(f()({},m),{},{visible:!0,data:{}})})},[]),Je=(0,n.useCallback)(function(m){fe(function(a){return f()(f()({},a),{},{visible:!0,data:m})})},[]);return(0,e.jsxs)(J.vs,{header:{title:"\u7B26\u5408\u6027\u7533\u660E\u7BA1\u7406"},children:[(0,e.jsx)(ee,{data:Se.data,onClose:Ve,onSuccess:Qe,onDeleteSuccess:ze,visible:Se.visible}),(0,e.jsxs)(r.Card,{className:"mb-5 mb-xl-10",children:[(0,e.jsxs)(r.Card.Header,{className:"pt-8",children:[(0,e.jsx)(r.Card.Title,{className:"flex-column",children:(0,e.jsx)(r.Input.Search,{solid:!0,defaultValue:b.keywords,className:"w-250px",placeholder:"\u5173\u952E\u8BCD\u641C\u7D22",onSearch:Le})}),(0,e.jsx)(r.Card.Toolbar,{children:(0,e.jsxs)("div",{children:[(0,e.jsx)(r.Button,{onClick:Ge,className:"me-4 my-1",children:"\u65B0\u5EFA"}),We,(0,e.jsx)(r.Button,{className:"me-4 my-1",onClick:Ke,children:"\u6A21\u677F\u6570\u636E\u5BFC\u5165"}),(0,e.jsx)(r.Button,{variant:"light",className:"me-4 my-1",onClick:$e,children:"\u7B26\u5408\u6027\u58F0\u660E\u6A21\u677F\u4E0B\u8F7D"})]})})]}),(0,e.jsx)(r.Card.Body,{children:(0,e.jsx)(r.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:me,children:(0,e.jsx)(r.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(a){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:a}),"\u4E2A"]})},toolbar:function(a){return(0,e.jsx)("div",{children:(0,e.jsx)(r.Button,{color:"danger",onClick:Ze(a),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},noRowsRenderer:function(){return(0,e.jsx)(r.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"title",title:"CMMF CODE",width:130,sorter:!0,sortOrder:(0,c.PE)(y,"title")},{key:"tags",title:"WMF CODE",width:130,render:function(a,M){return!!M.tags.length&&M.tags[0].name}},{key:"content",title:"\u89C4\u8303\u6587\u4EF6",render:function(a,M){var l,O,A=M.content,ve=new RegExp("^storage://[^/]+/");return(0,e.jsxs)("div",{children:[A==null||(l=A.rawUrl)===null||l===void 0?void 0:l.replace(ve,""),(A==null||(O=A.url)===null||O===void 0?void 0:O.startsWith("storage://"))&&(0,e.jsx)(r.Badge,{className:"ms-2",color:"dark",children:"\u672A\u4E0A\u4F20"})]})}},{key:"status",title:"\u72B6\u6001",width:200,sorter:!0,sortOrder:(0,c.PE)(y,"status"),render:function(a,M){switch(a){case S.af.Draft:return(0,e.jsx)(r.Badge,{light:!0,color:"secondary",children:"\u8349\u7A3F"});case S.af.Published:return(0,e.jsx)(r.Badge,{light:!0,color:"primary",children:"\u5DF2\u53D1\u5E03"});case S.af.Scheduled:return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(r.Badge,{light:!0,color:"info",children:["\u5C06\u4E8E"," ",d()(M.scheduledAt).format("YYYY-MM-DD HH:mm")," ","\u53D1\u5E03"]})});case S.af.Expired:return(0,e.jsx)(r.Badge,{color:"dark",children:"\u5DF2\u8FC7\u671F"});default:return(0,e.jsx)("span",{className:"badge badge-light-dark",children:"\u672A\u77E5"})}}},{key:"expirationAt",title:"\u7ED3\u675F\u65F6\u95F4",sorter:!0,sortOrder:(0,c.PE)(y,"expirationAt"),width:160,render:function(a){return(0,e.jsx)("div",{className:"text-gray-700",children:a&&d()(a).format("YYYY-MM-DD HH:mm")})}},{title:"\u64CD\u4F5C",key:"action",width:120,render:function(a,M){return(0,e.jsx)(re,{data:M,delete:Ye,onEdit:Je})}}],pagination:je,onChange:Pe,dataSource:se})})})]})]})}var U=oe},20067:function(){}}]);
