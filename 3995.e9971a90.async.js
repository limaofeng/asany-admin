"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3995],{96708:function(V,N,r){var R=r(46027),T=r(84048),m=r(86074);function w(P){var b=P.layout,L=P.children,_=P.onLayout;return(0,m.jsxs)("div",{className:"d-flex flex-wrap my-1",children:[b&&(0,m.jsxs)("ul",{className:"nav nav-pills me-6 mb-2 mb-sm-0",children:[(0,m.jsx)("li",{className:"nav-item m-0 me-3",children:(0,m.jsx)(T.Z,{variant:"light",color:"muted",active:b==="card",activeColor:"primary",onClick:_==null?void 0:_.bind(null,"card"),icon:(0,m.jsx)(R.ZP,{name:"Duotune/gen024",className:"svg-icon-1"})})}),(0,m.jsx)("li",{className:"nav-item m-0",children:(0,m.jsx)(T.Z,{variant:"light",color:"muted",active:b==="table",onClick:_==null?void 0:_.bind(null,"table"),activeColor:"primary",className:"me-3",icon:(0,m.jsx)(R.ZP,{name:"Duotune/abs015",className:"svg-icon-1"})})})]}),L]})}N.Z=w},13995:function(V,N,r){r.r(N);var R=r(19632),T=r.n(R),m=r(13769),w=r.n(m),P=r(5574),b=r.n(P),L=r(15009),_=r.n(L),H=r(99289),I=r.n(H),o=r(62435),Q=r(46027),j=r(12845),X=r(84059),U=r(38018),Y=r(96708),q=r(73588),l=r(79817),W=r(19975),e=r(86074),ee=["q"];function ae(f){var E=f.data,D=f.navigate,v=f.onDelete,M=f.onShowQRCode,F=f.baseUrl,B=(0,o.useCallback)(function(){var C=I()(_()().mark(function k(A){var c,O;return _()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return c="\u786E\u5B9A\u5220\u9664\u6D3B\u52A8 \u201C".concat(A.name,"\u201D \u5417\uFF1F"),h.next=3,l.Modal.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:c}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(O=h.sent,O.isConfirmed){h.next=6;break}return h.abrupt("return");case 6:return h.next=8,v(A.id);case 8:l.Toast.success("\u6D3B\u52A8 \u201C".concat(A.name,"\u201D \u5220\u9664\u6210\u529F"),2e3,{placement:"bottom-left",progressBar:!0});case 9:case"end":return h.stop()}},k)}));return function(k){return C.apply(this,arguments)}}(),[v]),y=(0,o.useCallback)(function(C){C.key==="view"?D("".concat(F,"/").concat(E.id)):C.key==="delete"?B(E):C.key==="preview"&&M(location.protocol+j.APP_CONFIG.MOBILE_URL+"/lps/"+E.id)},[F,E,B,history,M]);return(0,e.jsx)(l.Dropdown,{overlay:(0,e.jsxs)(l.Menu,{onClick:y,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold fs-8 w-125px py-4",children:[(0,e.jsx)(l.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"view"),(0,e.jsx)(l.Menu.Separator,{className:"my-1"}),(0,e.jsx)(l.Menu.Item,{className:"px-3",children:"\u9884\u89C8"},"preview"),(0,e.jsx)(l.Menu.Separator,{className:"my-1"}),(0,e.jsx)(l.Menu.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",children:(0,e.jsxs)(l.Button,{className:"fs-8",variant:"light",activeColor:"light-primary",children:["\u64CD\u4F5C",(0,e.jsx)(Q.JO,{className:"svg-icon-5 ms-2 me-n1",name:"Duotune/arr072"})]})})}function ne(){var f,E,D=(0,j.useNavigate)(),v=(0,j.useLocation)(),M=v.pathname,F=(0,o.useState)(),B=b()(F,2),y=B[0],C=B[1],k=(0,o.useCallback)(function(n){C(n)},[]),A=(0,o.useCallback)(function(){C(void 0)},[]),c=(0,o.useMemo)(function(){var n=U.parse(v.search),a=n.q,s=w()(n,ee);return a&&(s.filter={name_contains:a}),s},[v]),O=(0,o.useMemo)(function(){if(!c.orderBy)return{order:"descend",field:"createdAt"};var n=c.orderBy.split("_"),a=b()(n,2),s=a[0],d=a[1];return{order:d==="desc"?"descend":"ascend",field:s}},[c.orderBy]),$=(0,W.hD)({refetchQueries:[W.MZ]}),h=b()($,1),Z=h[0],K=(0,W.gr)({fetchPolicy:"cache-and-network",variables:c}),u=K.data,p=K.loading,t=K.previousData,G=(0,o.useMemo)(function(){return p?(t==null?void 0:t.total.totalCount)||0:(u==null?void 0:u.total.totalCount)||0},[u==null?void 0:u.total.totalCount,p,t==null?void 0:t.total]),re=(0,o.useMemo)(function(){return p?(t==null?void 0:t.landingPages)||{total:0,current:1}:(u==null?void 0:u.landingPages)||{total:0,current:1}},[u==null?void 0:u.landingPages,p,t==null?void 0:t.landingPages]),se=(0,o.useMemo)(function(){var n;if(p){var a;return((t==null||(a=t.landingPages)===null||a===void 0?void 0:a.edges)||[]).map(function(s){return s.node})}return((u==null||(n=u.landingPages)===null||n===void 0?void 0:n.edges)||[]).map(function(s){return s.node})},[u==null?void 0:u.landingPages,p,t==null?void 0:t.landingPages]),le=(0,o.useCallback)(function(n){D(v.pathname+"?"+U.stringify({q:n}),{replace:!0})},[D,v.pathname]),ue=(0,o.useCallback)(function(n,a,s){var d,g={};if((d=c.filter)!==null&&d!==void 0&&d.name_contains){var i;g.q=(i=c.filter)===null||i===void 0?void 0:i.name_contains}s&&(g.orderBy=s.field+"_"+(s.order==="ascend"?"asc":"desc")),g.page=n.current,D(v.pathname+"?"+U.stringify(g),{replace:!0})},[D,v.pathname,(f=c.filter)===null||f===void 0?void 0:f.name_contains]),S=(0,o.useCallback)(I()(_()().mark(function n(){var a,s,d,g,i,z=arguments;return _()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:for(a=z.length,s=new Array(a),d=0;d<a;d++)s[d]=z[d];return x.next=3,Z({variables:{ids:s}});case 3:return g=x.sent,i=g.data,x.abrupt("return",(i==null?void 0:i.deleteLandingPage)||0);case 6:case"end":return x.stop()}},n)})),[Z]),J=(0,o.useCallback)(function(n){return I()(_()().mark(function a(){var s,d;return _()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return s="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(n.length," \u4E2A\u6D3B\u52A8\u5417\uFF1F"),i.next=3,l.Modal.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:s}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(d=i.sent,d.isConfirmed){i.next=6;break}return i.abrupt("return");case 6:return i.next=8,S.apply(void 0,T()(n));case 8:l.Toast.success("\u6D3B\u52A8\u6279\u91CF\u5220\u9664\u6210\u529F",2e3,{placement:"bottom-left",progressBar:!0});case 9:case"end":return i.stop()}},a)}))},[S]),te=(0,o.useMemo)(function(){return function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(l.Button,{color:"success",onClick:J(n),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},[J]);return console.log("qrCode",y,c),(0,e.jsxs)(q.vs,{footer:!1,children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap flex-stack pb-7",children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,e.jsxs)("h3",{className:"fw-bolder me-5",children:["\u6D3B\u52A8 (",G,")"]}),(0,e.jsx)(l.Input.Search,{onSearch:le,defaultValue:(E=c.filter)===null||E===void 0?void 0:E.name_contains,placeholder:"\u641C\u7D22",className:"border-body bg-body w-250px"})]}),(0,e.jsx)(Y.Z,{children:(0,e.jsx)("div",{className:"d-flex my-0"})})]}),!G&&!p?(0,e.jsx)(l.Card,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(l.Empty,{title:"\u8FD8\u6CA1\u6709\u6D3B\u52A8",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u6D3B\u52A8\u8BD5\u8BD5",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(l.Button,{as:j.Link,variant:"primary",to:"${baseUrl}/new",children:"\u65B0\u5EFA\u6D3B\u52A8"})})}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.Card,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(l.Card.Body,{children:(0,e.jsx)(l.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:p,children:(0,e.jsx)(l.Table,{hover:!0,rowKey:"id",noRowsRenderer:function(){return(0,e.jsx)(l.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},rowSelection:{type:"checkbox",renderTitle:function(a){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:a}),"\u4E2A\u6D3B\u52A8"]})},toolbar:te},columns:[{key:"name",title:"\u540D\u79F0",sorter:!0,sortOrder:O.field==="name"?O.order:void 0,render:function(a,s){return(0,e.jsx)("div",{className:"ps-2",children:(0,e.jsx)(j.Link,{className:"text-gray-700",to:"".concat(M,"/").concat(s.id),children:a})})}},{key:"stores",title:"\u95E8\u5E97",render:function(a){return(0,e.jsxs)("div",{className:"d-flex tw-truncate overflow-hidden pe-2",children:[(0,e.jsx)("span",{className:"tw-text-ellipsis tw-truncate overflow-hidden",children:a.map(function(s){return s.name}).join(",")}),(0,e.jsxs)("span",{children:["\u5171 ",a.length," \u5BB6\u95E8\u5E97"]})]})}},{key:"poster",title:"\u6D77\u62A5",width:80,render:function(a){return a!=null&&a.background?(0,e.jsx)("div",{className:"d-flex w-30px justify-content-center",children:(0,e.jsx)("img",{src:j.APP_CONFIG.STORAGE_URL+"/preview/".concat(a.background.id),className:"h-30px w-20px"})}):(0,e.jsx)(Q.JO,{className:"svg-icon-2qx text-muted",name:"Bootstrap/file-image"})}},{key:"actions",title:"\u64CD\u4F5C",width:100,render:function(a,s){return(0,e.jsx)(ae,{baseUrl:M,onDelete:S,onShowQRCode:k,navigate:D,data:s})}}],pagination:re,onChange:ue,dataSource:se})})})}),(0,e.jsxs)(l.Modal,{title:"\u9884\u89C8\u4E8C\u7EF4\u7801",dialogClassName:"w-250px",onCancel:A,visible:!!y,okButtonProps:{style:{display:"none"}},children:[(0,e.jsx)("div",{className:"d-inline-block",children:!!y&&(0,e.jsx)(X.Qd,{size:200,value:y})}),(0,e.jsx)("span",{children:"\u4F7F\u7528\u624B\u673A\u626B\u7801\u4E8C\u7EF4\u7801\u9884\u89C8"})]})]})]})}N.default=ne}}]);
