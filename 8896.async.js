"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8896],{88896:function(Nr,Te,f){f.d(Te,{Z:function(){return rr}});var Me=f(13769),Se=f.n(Me),Ae=f(15009),x=f.n(Ae),Re=f(99289),A=f.n(Re),$e=f(5574),T=f.n($e),Ie=f(97857),re=f.n(Ie),Ze=f(19632),Ce=f.n(Ze),r=f(62435),Oe=f(32512),ze=f(96974),D=f(46027),ae=f(12845),Le=f(93967),J=f.n(Le),n=f(79817),Ne=f(32115),we=f(1861),Z=f(82471),e=f(86074);function Ve(){return(0,e.jsx)(e.Fragment,{children:"\u65E5\u5FD7"})}function We(i){var s=(0,r.useState)(i.file),a=T()(s,2),g=a[0],h=a[1],d=(0,Z.lK)({fetchPolicy:"cache-and-network",variables:{id:i.file.id}}),v=d.data,B=d.loading;return(0,r.useEffect)(function(){v!=null&&v.file&&h(v==null?void 0:v.file)},[v==null?void 0:v.file]),(0,e.jsxs)(n.BlockUI,{overlayClassName:"bg-white bg-opacity-25",className:"pt-5",loading:B,children:[!g.isDirectory&&(0,e.jsx)("div",{className:"file-preview mb-6",children:(0,e.jsx)(n.Symbol,{src:"https://api.asany.cn"+"/thumbnail/".concat(g.id,"?size=120x120")})}),!1,(0,e.jsx)("div",{className:"fs-6 text-gray-800 mb-4",children:"\u7CFB\u7EDF\u5C5E\u6027"}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u7C7B\u578B"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:g.isDirectory?"\u6587\u4EF6\u5939":g.mimeType})})]}),!g.isDirectory&&(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u5927\u5C0F"}),(0,e.jsx)("div",{className:"col-lg-9 fv-row",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:(0,Ne.jb)(g.size)})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u4F4D\u7F6E"}),(0,e.jsxs)("div",{className:"col-lg-9 d-flex align-items-center flex-wrap",children:[(0,e.jsx)(ae.Link,{className:"tw-truncate mw-90px",to:"/drive/my-drive",children:"\u5168\u90E8\u6587\u4EF6"}),(g.parents||[]).map(function(k){return(0,e.jsxs)(r.Fragment,{children:[(0,e.jsx)(D.ZP,{name:"Duotune/arr071",className:J()("svg-icon-5 svg-icon-primary")}),(0,e.jsx)(ae.Link,{className:"tw-truncate mw-90px",to:"/drive/folders/".concat(k.id),children:k.name})]},k.id)})]})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u4FEE\u6539\u65F6\u95F4"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:g.lastModified})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u521B\u5EFA\u65F6\u95F4"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:g.createdAt})})]}),(0,e.jsxs)("div",{className:"row mb-4",children:[(0,e.jsx)("label",{className:"col-lg-3 fw-bold text-muted",children:"\u8BF4\u660E"}),(0,e.jsx)("div",{className:"col-lg-9",children:(0,e.jsx)("span",{className:"fs-7 text-gray-800",children:g.description})})]})]})}function He(i){var s=i.file;return(0,e.jsxs)(n.Tabs,{className:"nav-line-tabs-2x",children:[(0,e.jsx)(n.Tabs.TabPane,{tab:"\u6587\u4EF6\u8BE6\u60C5",children:(0,e.jsx)(we.E,{className:"flex-column-fluid custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(We,{file:s})})},"file-details"),(0,e.jsx)(n.Tabs.TabPane,{tab:"\u64CD\u4F5C\u8BB0\u5F55",children:(0,e.jsx)(we.E,{className:"flex-column-fluid custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:(0,e.jsx)(Ve,{})})},"action-records")]})}function Ke(i){var s=i.files,a=i.currentFolder,g=(0,r.useMemo)(function(){return s.length===1?"file_details":s.length>1?"many_file_details":"current_folder"},[s]),h=(0,r.useMemo)(function(){return g==="file_details"?s[0].name:g==="many_file_details"?"\u591A\u4E2A\u6587\u4EF6":a!=null&&a.isRootFolder?"\u8BF7\u9009\u62E9\u4E00\u4E2A\u6587\u4EF6":(a==null?void 0:a.name)||""},[a==null?void 0:a.isRootFolder,a==null?void 0:a.name,s,g]),d=(0,r.useMemo)(function(){var $=h.lastIndexOf(".");return $===-1?[h,void 0]:[h.substring(0,$),h.substring($+1)]},[h]),v=T()(d,2),B=v[0],k=v[1];return(0,e.jsxs)("div",{className:"preview-container",children:[(0,e.jsx)("div",{className:"preview-header",children:(0,e.jsx)("h4",{className:J()({"tw-truncate":!k,"d-flex":k}),children:k?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"file-title shrink tw-truncate",children:B}),(0,e.jsxs)("span",{className:"file-suffix",children:[".",k]})]}):B})}),(0,e.jsx)("div",{className:"preview-body",children:g==="file_details"&&(0,e.jsx)(He,{file:s[0]})})]})}var Ue=Ke,de=f(12708);function Ge(i){var s=i.data,a=i.editable,g=i.onClick,h=i.onCancelRename,d=i.onSuccess,v=(0,r.useRef)(null),B=(0,r.useState)(!1),k=T()(B,2),$=k[0],j=k[1],se=(0,r.useState)(s.name),V=T()(se,2),M=V[0],W=V[1],Y=(0,Z.Ep)(),ne=T()(Y,1),N=ne[0],le=(0,r.useCallback)(function(c){W(c.target.value)},[]),H=(0,r.useCallback)(function(){var c=A()(x()().mark(function I(y){var ve,ie,w;return x()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return y.stopPropagation(),P.prev=1,j(!0),P.next=5,(0,de.gw)(N({variables:{id:s.id,name:M}}),350);case 5:return ve=P.sent,ie=ve.data,d(ie.file),P.next=10,(0,de._v)(350);case 10:j(!1),h(),P.next=22;break;case 14:return P.prev=14,P.t0=P.catch(1),j(!1),P.next=19,n.Toast.error(P.t0.message,2e5,{progressBar:!0,placement:"top-center"});case 19:return P.next=21,(0,de._v)(300);case 21:(w=v.current)===null||w===void 0||w.select();case 22:case"end":return P.stop()}},I,null,[[1,14]])}));return function(I){return c.apply(this,arguments)}}(),[s.id,M,h,d,N]),O=(0,r.useCallback)(function(c){c.preventDefault(),H(c)},[H]),te=(0,r.useCallback)(function(c){c.stopPropagation(),c.preventDefault(),h()},[h]),S=(0,r.useCallback)(function(c){g(s),c.preventDefault(),c.stopPropagation()},[s,g]);(0,r.useEffect)(function(){var c;W(function(){return s.name}),a&&((c=v.current)===null||c===void 0||c.select(0,s.name.length-(s.extension?s.extension.length+1:0)))},[s.extension,s.name,a]);var K=(0,r.useCallback)(function(c){a&&(c.stopPropagation(),c.preventDefault())},[a]),z=(0,r.useMemo)(function(){var c,I;return((c=s.mimeType)===null||c===void 0?void 0:c.startsWith("image/"))||((I=s.mimeType)===null||I===void 0?void 0:I.startsWith("video/"))},[s.mimeType]);return(0,e.jsxs)("div",{onClick:K,className:J()("d-flex align-items-center",{"no-selecto-drag":a}),children:[(0,e.jsxs)("div",{className:"title-icon-container position-relative me-1 d-flex align-items-center justify-content-center",children:[z?(0,e.jsx)(n.Symbol,{alt:(0,e.jsx)(D.ZP,{name:"Duotune/".concat(s.isDirectory?"fil012":"fil003"),className:"svg-icon-2x svg-icon-primary"}),src:"https://api.asany.cn"+"/thumbnail/".concat(s.id,"?size=120x120")}):(0,e.jsx)(D.ZP,{name:"Duotune/".concat(s.isDirectory?"fil012":"fil003"),className:"svg-icon-2x svg-icon-primary"}),s.starred&&(0,e.jsx)(D.ZP,{name:"Bootstrap/star-fill",className:"position-absolute starred-flag"})]}),a?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.Input,{ref:v,value:M,onChange:le,onPressEnter:O,placeholder:"\u8F93\u5165\u65B0\u6587\u4EF6\u5939\u540D\u79F0",size:"sm",className:"mw-250px me-3"}),(0,e.jsx)(n.Button,{as:"button",loading:$,variant:"light-primary",size:"sm",icon:(0,e.jsx)(D.ZP,{name:"Duotune/arr085",className:"svg-icon-1"}),className:"me-3",onClick:H}),(0,e.jsx)(n.Button,{as:"button",size:"sm",variant:"light-danger",icon:(0,e.jsx)(D.ZP,{name:"Duotune/arr088",className:"svg-icon-1"}),className:"svg-icon-1",onClick:te})]}):(0,e.jsx)("a",{className:"text-gray-800 text-ellipsis text-hover-primary no-selecto-drag",onClick:S,href:s.isDirectory?"/drive/folders/".concat(s.id):"/preview/".concat(s.id),children:s.name})]})}var Qe=Ge;function Xe(i){var s=i.visible,a=i.onCancel,g=i.onSuccess,h=i.parentFolder,d=(0,r.useState)("\u672A\u547D\u540D\u6587\u4EF6\u5939"),v=T()(d,2),B=v[0],k=v[1],$=(0,r.useState)(!1),j=T()($,2),se=j[0],V=j[1],M=(0,Z.we)(),W=T()(M,2),Y=W[0],ne=W[1].loading,N=(0,r.useRef)(null),le=(0,r.useCallback)(function(){a()},[a]),H=(0,r.useCallback)(function(S){k(S.target.value),V(!S.target.value)},[]),O=(0,r.useCallback)(A()(x()().mark(function S(){var K,z,c;return x()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(B){y.next=2;break}return y.abrupt("return");case 2:return y.prev=2,y.next=5,Y({variables:{name:B,parentFolder:h}});case 5:K=y.sent,z=K.data,a&&a(),z!=null&&z.folder&&g(z.folder),n.Toast.success("\u6587\u4EF6\u5939\u65B0\u589E\u6210\u529F",2e3,{progressBar:!0,placement:"bottom-start"}),y.next=19;break;case 12:return y.prev=12,y.t0=y.catch(2),y.next=16,n.Toast.error(y.t0.message,2e3,{progressBar:!0});case 16:return y.next=18,(0,de._v)(300);case 18:(c=N.current)===null||c===void 0||c.select();case 19:case"end":return y.stop()}},S,null,[[2,12]])})),[Y,a,g,h,B]),te=(0,r.useCallback)(function(){O()},[O]);return(0,r.useEffect)(function(){if(s){var S;(S=N.current)===null||S===void 0||S.select()}else k("\u672A\u547D\u540D\u6587\u4EF6\u5939"),V(!1)},[s]),(0,e.jsx)(n.Modal,{centered:!0,visible:s,dialogClassName:"modal-dialog-small w-400px",onCancel:le,onOk:O,title:"\u65B0\u5EFA\u6587\u4EF6\u5939",closable:!1,okButtonProps:{loading:ne,className:J()({disabled:se})},headerClassName:"border-bottom-0",bodyClassName:"py-2",footerClassName:"border-top-0",children:(0,e.jsx)(n.Input,{ref:N,onPressEnter:te,onChange:H,value:B})})}var Je=Xe;function Ye(i){var s=i.paths,a=i.onClick;console.log("FolderPath",s);var g=(0,r.useCallback)(function(h){return function(d){d.preventDefault(),d.stopPropagation(),a(h)}},[a]);return(0,e.jsx)("div",{className:"folder-path badge badge-lg badge-white",children:(0,e.jsx)("div",{className:"d-flex align-items-center flex-wrap",children:s.map(function(h,d){var v=d===0,B=d===s.length-1;return(0,e.jsxs)(r.Fragment,{children:[!v&&(0,e.jsx)(D.ZP,{name:v?"Duotune/abs039":"Duotune/arr071",className:J()("svg-icon-2 svg-icon-primary",{"mx-1":!v,"me-3":v})}),B?h.name:(0,e.jsx)("a",{href:d===0?"/drive/my-drive":"/drive/folders/".concat(h.id),onClick:g(h),children:h.name})]},h.id)})})})}var qe=Ye,_e=["role","tabIndex","onClick"];function ye(i,s){var a=i?[{id:i.id,name:i.name,isDirectory:!0,isRootFolder:!0,path:"/"}]:[];return s&&s.id!==(i==null?void 0:i.id)&&(s.parents&&a.push.apply(a,Ce()(s.parents)),s.isRootFolder||a.push(re()({},s))),a}function er(i){var s=i.folder,a=i.rootFolder,g=i.where,h=i.toolbar,d=h===void 0?"default":h,v=(0,ze.s0)(),B=(0,ae.useModel)("cloud-drive.index",function(l){var o=l.state;return o.cloudDrive}),k=(0,ae.useModel)("cloud-drive.index",function(l){return l.upload}),$=(0,ae.useModel)("cloud-drive.index",function(l){return l.download}),j=(0,r.useRef)({sorter:i.orderBy||{field:"name",order:"ascend"},rootFolder:a,newFolderVisible:!1,currentFolder:i.currentFolder}),se=(0,r.useReducer)(function(l){return l+1},0),V=T()(se,2),M=V[1],W=(0,r.useCallback)(function(){j.current.newFolderVisible=!0,M()},[]),Y=(0,r.useCallback)(function(){j.current.newFolderVisible=!1,M()},[]),ne=(0,Z.rn)({fetchPolicy:"cache-and-network",variables:{folder:s}}),N=ne.data,le=(0,Z.tz)(),H=T()(le,1),O=H[0],te=(0,Z._D)(),S=T()(te,1),K=S[0],z=(0,Z.HD)(),c=T()(z,1),I=c[0],y=(0,Z.fX)(),ve=T()(y,1),ie=ve[0],w=j.current.sorter,De=(0,r.useMemo)(function(){return w?"isDirectory_desc,"+w.field+"_"+(w.order==="ascend"?"asc":"desc"):"isDirectory_desc,name_asc"},[w]),P=(0,Z.Eo)(a==null?void 0:a.id,g,De),me=T()(P,4),U=me[0],fe=me[1],ke=me[2],ue=me[3],G=ue.loadedCount,Q=ue.allItems,he=ue.refetch,oe=ue.refetchForObjects,q=ue.refetchWithRemoveForObjects,_=(0,r.useMemo)(function(){return{loadedCount:G,rowCount:U.totalCount,get items(){return Q()},useItem:ke}},[Q,G,U.totalCount,ke]),ar=(0,r.useState)([]),Ee=T()(ar,2),b=Ee[0],X=Ee[1],ee=(0,r.useMemo)(function(){return i.currentFolder&&N!==null&&N!==void 0&&N.currentFolder&&i.currentFolder.id!==N.currentFolder.id&&i.currentFolder.path.startsWith(N.currentFolder.path)?j.current.currentFolder=i.currentFolder:N!=null&&N.currentFolder?j.current.currentFolder=N==null?void 0:N.currentFolder:j.current.currentFolder},[N==null?void 0:N.currentFolder,i.currentFolder]),sr=(0,r.useCallback)(function(l){X(l)},[X]),nr=(0,r.useCallback)(function(){var l=A()(x()().mark(function o(t){return x()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,oe([t],function(F,m){return F.id===m.id});case 2:case"end":return p.stop()}},o)}));return function(o){return l.apply(this,arguments)}}(),[oe]),E=(0,r.useMemo)(function(){if(b.length===1)return Q().find(function(l){return l&&l.id===b[0]})},[Q,b]),lr=(0,r.useCallback)(function(){j.current.renameFile=void 0,M()},[]),tr=(0,r.useMemo)(function(){return ye(a,ee)},[a,ee]),Be=(0,r.useCallback)(function(){var l=A()(x()().mark(function o(t){var u,p,F;return x()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(d!=="trash"){C.next=4;break}return C.next=3,n.Modal.confirm({title:(0,e.jsxs)(e.Fragment,{children:["\u6B64\u6587\u4EF6",t.isDirectory&&"\u5939","\u4F4D\u4E8E\u60A8\u7684\u56DE\u6536\u7AD9\u4E2D"]}),content:(0,e.jsxs)(e.Fragment,{children:["\u8981\u67E5\u770B\u8BE5\u6587\u4EF6",t.isDirectory&&"\u5939","\uFF0C\u60A8\u9700\u8981\u5C06\u5176\u4ECE\u56DE\u6536\u7AD9\u8FD8\u539F\u3002"]}),okText:"\u8FD8\u539F"});case 3:return C.abrupt("return");case 4:if(!t.isDirectory){C.next=9;break}return u=re()({},t),t.isRootFolder||(p=[].concat(Ce()(ye(j.current.rootFolder,j.current.currentFolder)),[u]),u.parents=p.slice(1,p.length-1),F=u.parents.findIndex(function(R){return R.path===t.path}),F!==-1&&(u.parents=u.parents.slice(0,F))),t.isRootFolder?v("/drive/my-drive",{state:{rootFolder:a,currentFolder:u,orderBy:j.current.sorter}}):v("/drive/folders/".concat(t.id),{state:{rootFolder:a,currentFolder:u,orderBy:j.current.sorter}}),C.abrupt("return");case 9:case"end":return C.stop()}},o)}));return function(o){return l.apply(this,arguments)}}(),[d,v,a]),ir=(0,r.useCallback)(function(){return(0,e.jsxs)("div",{className:"clouddrive-listfiles-no-rows d-flex flex-column flex-center",children:[(0,e.jsx)("img",{src:"/assets/media/illustrations/sketchy-1/5.png",className:"mw-200px"}),(0,e.jsx)("div",{className:"fs-1 fw-bolder text-dark mb-4",children:"\u5C06\u6587\u4EF6\u62D6\u62FD\u5230\u6B64\u5904"}),(0,e.jsxs)("div",{className:"fs-6",children:["\u6216\u70B9\u51FB \u201C",(0,e.jsx)("span",{className:"text-success",children:"\u4E0A\u4F20"}),"\u201D \u6309\u94AE"]})]})},[]),ur=(0,r.useCallback)(function(){return U.totalCount===G&&G===0?fe?(0,e.jsx)(e.Fragment,{children:"\u52A0\u8F7D\u4E2D...."}):(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(e.Fragment,{children:[U.totalCount===G?(0,e.jsx)(e.Fragment,{children:"\u5DF2\u5168\u90E8\u52A0\u8F7D"}):(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u52A0\u8F7D ",G," \u4E2A"]}),"\uFF0C\u5171 ",U.totalCount," \u4E2A"]})},[G,fe,U.totalCount]),pe=Q().filter(function(l){return b.includes(l.id)}).every(function(l){return l.starred}),or=(0,r.useCallback)(function(l,o,t){j.current.sorter=t,M()},[]),cr=(0,r.useMemo)(function(){return _.items.filter(function(l){return b.some(function(o){return o===l.id})})},[_,b]),dr=(0,r.useCallback)(function(){var l=A()(x()().mark(function o(t){var u;return x()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,he(1);case 2:u=Q(),u.some(function(m){return m&&m.id===t.id})&&X([t.id]);case 4:case"end":return F.stop()}},o)}));return function(o){return l.apply(this,arguments)}}(),[he,Q]),ge=(ee==null?void 0:ee.id)||(a==null?void 0:a.id);(0,r.useEffect)(function(){X([])},[ge,a==null?void 0:a.name]);var vr=(0,r.useCallback)(function(l){k(l,{space:B.space,folder:ge})},[B,ge,k]),xe=(0,Oe.uI)({onDrop:vr}),mr=xe.getRootProps,fr=xe.getInputProps,hr=xe.isDragActive;console.log("isDragActive",hr);var Fe=mr(),wr=Fe.role,yr=Fe.tabIndex,je=Fe.onClick,gr=Se()(Fe,_e),Fr=(0,r.useCallback)(function(l){je&&je(l)},[je]),pr=(0,r.useCallback)(A()(x()().mark(function l(){var o,t,u;return x()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:o=_.items,t=o.filter(function(m){return b.includes(m.id)}),u=t.length===1?t[0].name:"\u3010\u6279\u91CF\u4E0B\u8F7D\u3011".concat(t[0].name," \u7B49 (").concat(t.length,").zip"),$(t,u);case 4:case"end":return F.stop()}},l)})),[_,$,b]),xr=(0,r.useCallback)(A()(x()().mark(function l(){var o,t,u,p;return x()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return o=E?E!=null&&E.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":b.length+" \u9879\u5185\u5BB9",m.next=3,n.Modal.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:"\u786E\u5B9A\u5220\u9664\u6240\u9009\u7684\u6587\u4EF6\u5417\uFF1F"}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u6587\u4EF6\u53EF\u5728 10\u5929 \u5185\u901A\u8FC7\u56DE\u6536\u7AD9\u8FD8\u539F"})]}),icon:"info",okText:"\u5220\u9664"});case 3:if(t=m.sent,t.isConfirmed){m.next=6;break}return m.abrupt("return");case 6:return m.next=8,K({variables:{ids:b}});case 8:u=m.sent,p=u.data,X([]),q(p==null?void 0:p.files,function(C,R){return C.id===R.id}),n.Toast.success(o+" \u5DF2\u79FB\u81F3\u56DE\u6536\u7AD9",2e3,{placement:"bottom-left",progressBar:!0});case 13:case"end":return m.stop()}},l)})),[K,q,E,b]),jr=(0,r.useCallback)(A()(x()().mark(function l(){var o;return x()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,n.Modal.confirm({title:"\u6E05\u7A7A\u56DE\u6536\u7AD9",content:"\u7CFB\u7EDF\u5C06\u6C38\u4E45\u5220\u9664\u56DE\u6536\u7AD9\u4E2D\u7684\u5185\u5BB9\uFF0C\u6B64\u64CD\u4F5C\u65E0\u6CD5\u6062\u590D \uFF1F"});case 2:if(o=u.sent,o.isConfirmed){u.next=5;break}return u.abrupt("return");case 5:return u.next=7,I({variables:{folder:s}});case 7:he(1),n.Toast.success("\u56DE\u6536\u7AD9\u5DF2\u88AB\u6E05\u7A7A",2e3,{placement:"bottom-left",progressBar:!0});case 9:case"end":return u.stop()}},l)})),[I,s,he]),Pe=(0,r.useCallback)(A()(x()().mark(function l(){var o,t,u,p;return x()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return o=E?E!=null&&E.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":b.length+" \u9879\u5185\u5BB9",m.next=3,n.Modal.confirm({title:"\u786E\u5B9A\u8FD8\u539F",content:"\u786E\u8BA4\u8FD8\u539F\u9009\u4E2D\u7684 "+o+" \uFF1F"});case 3:if(t=m.sent,t.isConfirmed){m.next=6;break}return m.abrupt("return");case 6:return m.next=8,ie({variables:{ids:b}});case 8:u=m.sent,p=u.data,X([]),q(p==null?void 0:p.files,function(C,R){return C.id===R.id}),n.Toast.success(o+" \u8FD8\u539F\u6210\u529F",2e3,{placement:"bottom-left",progressBar:!0});case 13:case"end":return m.stop()}},l)})),[q,ie,E,b]),be=(0,r.useCallback)(A()(x()().mark(function l(){var o,t,u,p,F;return x()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(o=E?E!=null&&E.isDirectory?"\u6587\u4EF6\u5939":"\u6587\u4EF6":b.length+" \u9879\u5185\u5BB9",!pe){C.next=10;break}return C.next=4,O({variables:{ids:b,mode:"REMOVE"}});case 4:t=C.sent,u=t.data,oe(u==null?void 0:u.files,function(R,ce){return R.id===ce.id}),n.Toast.success(o+"\u5DF2\u4ECE\u6536\u85CF\u4E2D\u79FB\u9664",2e3,{placement:"bottom-left",progressBar:!0}),C.next=16;break;case 10:return C.next=12,O({variables:{ids:b,mode:"ADD"}});case 12:p=C.sent,F=p.data,d==="starred"?(X([]),q(F==null?void 0:F.files,function(R,ce){return R.id===ce.id})):oe(F==null?void 0:F.files,function(R,ce){return R.id===ce.id}),n.Toast.success(o+" \u5DF2\u6DFB\u52A0\u5230\u6536\u85CF",2e3,{placement:"bottom-left",progressBar:!0});case 16:M();case 17:case"end":return C.stop()}},l)})),[oe,q,E,b,O,pe,d]),br=(0,r.useCallback)(A()(x()().mark(function l(){return x()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:j.current.renameFile=E,M();case 2:case"end":return t.stop()}},l)})),[E]),L=(0,r.useMemo)(function(){return b.length?b.length===1?"row":"multi-row":"no_rows"},[b.length]),Cr=(0,r.useMemo)(function(){if(d==="starred")return function(){return(0,e.jsx)("div",{children:(0,e.jsx)(n.Button,{color:"success",variant:!1,className:"trash-restore",onClick:be,icon:(0,e.jsx)(D.ZP,{name:"Duotune/arr029",className:"svg-icon-4 svg-icon-success"}),children:"\u53D6\u6D88\u6536\u85CF"})})};if(d==="trash")return function(){return(0,e.jsx)("div",{children:(0,e.jsx)(n.Button,{color:"success",variant:!1,className:"trash-restore",onClick:Pe,icon:(0,e.jsx)(D.ZP,{name:"Duotune/arr029",className:"svg-icon-4 svg-icon-success"}),children:"\u8FD8\u539F"})})}},[Pe,be,d]);return(0,e.jsxs)(n.Card,{className:"list-files",flush:!0,children:[d==="default"&&(0,e.jsxs)(n.Card.Header,{className:"pt-8 flex-row-reverse",children:[(0,e.jsx)(n.Card.Title,{children:(0,e.jsx)(n.Input.Search,{size:"lg",solid:!0,className:"rounded-2 w-300px",placeholder:"\u641C\u7D22 \u6587\u4EF6 & \u6587\u4EF6\u5939"})}),(0,e.jsx)(n.Card.Toolbar,{children:(0,e.jsxs)("div",{className:J()("d-flex justify-content-end",{"file-action-group gap-2":["row","multi-row"].includes(L)}),children:[L==="no_rows"&&(0,e.jsxs)(e.Fragment,{children:[d==="default"&&(0,e.jsx)(n.Button,{variant:"primary",className:"rounded-2 me-3",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/fil018"}),onClick:Fr,children:"\u4E0A\u4F20\u6587\u4EF6"}),d==="default"&&(a==null?void 0:a.isRootFolder)&&(0,e.jsx)(n.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/fil013"}),onClick:W,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"})]}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/arr095"}),children:"\u5206\u4EAB"}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",style:{transform:"rotateZ(90deg)"},name:"Duotune/arr076"}),onClick:pr,children:"\u4E0B\u8F7D"}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/gen027"}),onClick:xr,children:"\u5220\u9664"}),L==="row"&&(0,e.jsx)(n.Button,{as:"button",variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/gen055"}),onClick:br,children:"\u91CD\u547D\u540D"}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/arr033"}),children:"\u79FB\u52A8"}),["row","multi-row"].includes(L)&&(0,e.jsx)(n.Button,{variant:"light-primary",className:"rounded-2",icon:(0,e.jsx)(D.ZP,{className:"svg-icon-2",name:"Duotune/abs024"}),onClick:be,children:pe?"\u53D6\u6D88\u6536\u85CF":"\u6536\u85CF"})]})})]}),(0,e.jsxs)(n.Card.Body,{className:"d-flex flex-row",children:[(0,e.jsxs)("div",re()(re()({className:"flex-row-fluid"},gr),{},{children:[(0,e.jsxs)("div",{className:"d-flex flex-stack",children:[(0,e.jsx)(qe,{onClick:Be,paths:tr}),(0,e.jsx)(n.Badge,{size:"lg",color:"white",children:ur()})]}),d==="trash"&&!!_.rowCount&&(0,e.jsx)(n.Alert,{theme:"Light",type:"primary",action:(0,e.jsx)(n.Button,{onClick:jr,variant:"light-primary",className:"me-3 ls-1",children:"\u6E05\u7A7A\u56DE\u6536\u7AD9"}),message:"\u5185\u5BB9\u79FB\u81F3\u56DE\u6536\u7AD9\u540E\u4F1A\u5728 10 \u5929\u540E\u88AB\u6C38\u4E45\u5220\u9664"}),(0,e.jsx)("input",re()({},fr())),(0,e.jsx)(n.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:fe,children:!U.totalCount&&!fe?ir():(0,e.jsx)(n.Table,{rowKey:"id",hover:!0,rowSelection:{type:"checkbox",selectedRowKeys:b,renderTitle:function(o){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:o}),"\u4E2A\u6587\u4EF6/\u6587\u4EF6\u5939"]})},toolbar:Cr,onChange:sr},rowHeight:50,columns:[{key:"name",title:(0,e.jsx)("span",{className:"ps-2",children:"\u6587\u4EF6\u540D"}),className:"min-w-250px",sorter:!0,sortOrder:(w==null?void 0:w.field)==="name"?w.order:void 0,render:function(o,t){var u;return(0,e.jsx)(Qe,{onClick:Be,onSuccess:nr,onCancelRename:lr,data:t,editable:t.id===((u=j.current.renameFile)===null||u===void 0?void 0:u.id)})}},{key:"lastModified",title:"\u66F4\u65B0\u65F6\u95F4",sorter:!0,width:160,sortOrder:(w==null?void 0:w.field)==="lastModified"?w.order:void 0},{key:"size",title:"\u6587\u4EF6\u5927\u5C0F",sorter:!0,width:100,sortOrder:(w==null?void 0:w.field)==="size"?w.order:void 0,render:function(o,t){return t.isDirectory?"-":(0,Ne.jb)(o)}}],dataSource:_,onChange:or})})]})),(0,e.jsx)("div",{className:"file-details-quick-preview pb-7",children:(0,e.jsx)(Ue,{files:cr,currentFolder:ee})}),(0,e.jsx)(Je,{onCancel:Y,visible:j.current.newFolderVisible,parentFolder:ge,onSuccess:dr})]})]})}var rr=er}}]);
