(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[5263],{33442:function(q,U,n){"use strict";var F=n(39428),h=n(11849),b=n(3182),C=n(67294),l=n(51186),O=n(25496);function z(R,K){var B=(0,C.useRef)(!1),H=(0,C.useCallback)((0,b.Z)((0,F.Z)().mark(function G(){var W,k;return(0,F.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return W=R.width,v.next=3,l.u_.confirm((0,h.Z)((0,h.Z)({},R),{},{width:W,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!B.current},preConfirm:function(){var w=(0,b.Z)((0,F.Z)().mark(function V(){var a,e,$;return(0,F.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return B.current=!0,g.prev=1,a=document.querySelector(".swal2-confirm"),a.textContent="\u5220\u9664\u4E2D...",e=document.createElement("span"),e.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),a.appendChild(e),g.next=9,(0,O.gw)(K(),350);case 9:$=g.sent,console.log($);case 11:return g.prev=11,B.current=!1,g.finish(11);case 14:case"end":return g.stop()}},V,null,[[1,,11,14]])}));function S(){return w.apply(this,arguments)}return S}()}));case 3:if(k=v.sent,k.isConfirmed){v.next=6;break}return v.abrupt("return",!1);case 6:return l.FN.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),v.abrupt("return",!0);case 8:case"end":return v.stop()}},G)})),[K,R]);return[H]}U.Z=z},45263:function(q,U,n){"use strict";n.r(U);var F=n(93224),h=n(39428),b=n(3182),C=n(2824),l=n(67294),O=n(28865),z=n(94184),R=n.n(z),K=n(19755),B=n.n(K),H=n(30381),G=n.n(H),W=n(80129),k=n.n(W),D=n(73727),v=n(7020),w=n(8845),S=n(33442),V=n(18071),a=n(51186),e=n(85893),$=["q"];window._MoreshowOrhide=function(c){return B()(c).parent().siblings().show(),B()(c).parent().remove(),!1};function Y(c){var i=c.selectedRows,x=c.refetch,d=(0,w.nT)(),M=(0,C.Z)(d,1),N=M[0],Z=(0,S.Z)({title:(0,e.jsxs)(e.Fragment,{children:["\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9",i.length>1&&(0,e.jsxs)(e.Fragment,{children:["\u201C",(0,e.jsx)("strong",{children:i.length}),"\u201C`"]}),"\u7BC7\u6587\u7AE0\u5417\uFF1F"]}),content:i.length>1?'\u60A8\u5373\u5C06\u5220\u9664\u4EE5\u4E0B\u6587\u7AE0:<ul className="py-2">'.concat(i.map(function(o,j){return"<li ".concat(j>=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 mb-1 fs-6"><span className="bullet bullet-dot me-2"></span><strong>').concat(o.title,"</strong></li>")}).join(""),`
              <li `).concat(i.length<=4?'style="display: none !important;"':"",' className="d-flex align-items-center text-gray-800 fs-6"><a href="javascript:void(0)" onClick="_MoreshowOrhide(this)">\u66F4\u591A</a></li></ul> '):(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:i[0].title}),"\u201D\u3002",(0,e.jsx)("br",{}),"\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})},(0,b.Z)((0,h.Z)().mark(function o(){return(0,h.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,N({variables:{ids:i.map(function(E){return E.id})}});case 2:case"end":return r.stop()}},o)}))),m=(0,C.Z)(Z,1),p=m[0],y=(0,l.useCallback)((0,b.Z)((0,h.Z)().mark(function o(){return(0,h.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p();case 2:return r.next=4,x();case 4:case"end":return r.stop()}},o)})),[p,x]);return(0,e.jsx)(a.zx,{color:"danger",onClick:y,variant:!1,size:"sm",className:"px-4 py-2",children:"\u6279\u91CF\u5220\u9664"})}function g(c){var i=c.data,x=c.refetch,d=c.baseUrl,M=(0,l.useState)(!1),N=(0,C.Z)(M,2),Z=N[0],m=N[1],p=(0,w.eU)(),y=(0,C.Z)(p,1),o=y[0],j=(0,S.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",content:(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:i.title}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})},(0,b.Z)((0,h.Z)().mark(function A(){return(0,h.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,o({variables:{id:i.id}});case 2:case"end":return _.stop()}},A)}))),r=(0,C.Z)(j,1),E=r[0],I=(0,l.useCallback)((0,b.Z)((0,h.Z)().mark(function A(){return(0,h.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,E();case 2:return _.next=4,x();case 4:case"end":return _.stop()}},A)})),[E,x]),Q=(0,l.useCallback)(function(A){var L=A.key;L=="edit"?v.m8.push("".concat(d,"/articles/").concat(i.id)):L=="delete"&&(m(!1),I())},[]);return(0,e.jsx)(a.Lt,{overlay:(0,e.jsxs)(a.v2,{onClick:Q,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(a.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(a.v2.Item,{className:"px-3",children:"\u53D1\u5E03"},"publish"),(0,e.jsx)(a.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",onVisibleChange:m,visible:Z,children:(0,e.jsxs)(a.zx,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(O.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})}function ee(c){var i,x,d=c.match.params.cid,M=c.location.state,N=M.rootCategoryId,Z=M.categories,m=M.baseUrl,p=(0,l.useMemo)(function(){var s=c.location.query,u=s.q,t=(0,F.Z)(s,$);return t.filter||(t.filter={}),u&&(t.filter={name_contains:u}),t.filter.category={id:d,subColumns:!0},t},[c.location,d]),y=(0,w.gk)({variables:p,fetchPolicy:"cache-and-network"}),o=y.data,j=y.refetch,r=y.loading,E=y.previousData,I=(0,l.useMemo)(function(){return r?(E==null?void 0:E.articles)||{edges:[],total:0,current:1}:(o==null?void 0:o.articles)||{edges:[],total:0,current:1}},[o==null?void 0:o.articles,r,E==null?void 0:E.articles]),Q=(0,l.useMemo)(function(){return I.edges.map(function(s){return s.node})},[I.edges]),A=(0,l.useCallback)(function(s){console.log(s)},[]),L=(0,l.useCallback)(function(s,u,t){var P,f={};if((P=p.filter)!==null&&P!==void 0&&P.name_contains){var T;f.q=(T=p.filter)===null||T===void 0?void 0:T.name_contains}t&&(f.orderBy=t.field+"_"+(t.order=="ascend"?"asc":"desc")),f.page=s.current,v.m8.replace(location.pathname+"?"+k().stringify(f))},[(i=p.filter)===null||i===void 0?void 0:i.name_contains]),_=(0,l.useState)([]),J=(0,C.Z)(_,2),ae=J[0],X=J[1],ne=(0,l.useCallback)(function(s,u){X(u)},[X]),te=(0,l.useMemo)(function(){return function(s,u){return(0,e.jsx)(Y,{selectedRows:u,refetch:j})}},[j]);return(0,e.jsx)(V.v,{loading:r,header:{title:(x=Z.find(function(s){return s.id==d}))===null||x===void 0?void 0:x.name},children:(0,e.jsx)("div",{className:"tab-content",children:(0,e.jsxs)(a.Zb,{flush:!0,headerClassName:"mt-5",children:[(0,e.jsxs)(a.Zb.Header,{className:"pt-8",children:[(0,e.jsx)(a.Zb.Title,{className:"flex-column",children:(0,e.jsx)(a.II.Search,{solid:!0,className:"w-250px",placeholder:"\u641C\u7D22\u6587\u7AE0",onSearch:A})}),(0,e.jsx)(a.Zb.Toolbar,{children:(0,e.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,e.jsx)(a.Lt,{overlay:(0,e.jsxs)(a.v2,{className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(a.v2.Item,{className:"px-3",children:"\u6700\u65B0"},"edit"),(0,e.jsx)(a.v2.Item,{className:"px-3",children:"\u6700\u665A"},"publish"),(0,e.jsx)(a.v2.Item,{className:"px-3 actions-delete",children:"\u6700\u8FD1\u66F4\u65B0\u7684"},"delete"),(0,e.jsx)(a.v2.Item,{className:"px-3 actions-delete",children:"\u70B9\u51FB\u91CF"},"delete")]}),placement:"bottomLeft",children:(0,e.jsx)(a.zx,{variant:"white",className:"me-3",children:"\u6392\u5E8F: \u6700\u65B0"})}),(0,e.jsx)(a.zx,{as:D.Link,variant:"primary",className:"me-3",icon:(0,e.jsx)(O.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),to:"".concat(m,"/cms/categories/").concat(d,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]}),(0,e.jsx)(a.Zb.Body,{className:"pt-0",children:I.total?(0,e.jsx)(a.iA,{rowKey:"id",rowSelection:{type:"checkbox",onChange:ne,selectedRowKeys:(ae||[]).map(function(s){return s.id}),renderTitle:function(u){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:u}),"\u7BC7\u6587\u7AE0"]})},toolbar:te},pagination:I,dataSource:Q,onChange:L,rowHeight:136,columns:[{title:"\u6807\u9898",dataIndex:"title",key:"title",render:function(u,t){var P;return(0,e.jsxs)("div",{className:"d-flex flex-row tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"d-flex flex-column align-items-start tw-truncate overflow-hidden",children:[(0,e.jsxs)("div",{className:"meta-container no-selecto-drag",children:[(0,e.jsx)(D.Link,{to:"/xx/12",className:"user-message",children:"\u6797\u66AE\u6625"}),(0,e.jsx)("span",{className:"created-at",children:G()(t.createdAt).fromNow()}),(0,e.jsx)("div",{className:"category_list",children:t.categories.filter(function(f){return f.id!==N}).map(function(f){return(0,e.jsx)(D.Link,{to:"".concat(m,"/cms/categories/").concat(f.id,"/articles"),className:"tag",children:f.name},f.id)})})]}),(0,e.jsx)(D.Link,{onClick:function(T){return T.stopPropagation()},to:"".concat(m,"/cms/categories/").concat(d,"/articles/").concat(t.id),className:"mt-2 mb-2 text-gray-800 no-selecto-drag fs-4 text-hover-primary mb-1",children:u}),(0,e.jsx)("div",{className:R()("summary mb-2 w-100 tw-text-ellipsis tw-truncate w-100",{"pe-8":!t.image}),children:(0,e.jsx)("span",{className:"text-muted fs-base no-selecto-drag",children:t.summary||"\u6CA1\u6709\u4EFB\u4F55\u5185\u5BB9..."})}),(0,e.jsxs)("div",{className:"fs-base",children:[(0,e.jsxs)(D.Link,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(m,"/cms/categories/").concat(d,"/articles/").concat(t.id),children:[(0,e.jsx)(O.ZP,{className:"svg-icon-4 me-2",name:"Bootstrap/eye"}),"41W"]}),(0,e.jsxs)(D.Link,{className:"text-muted no-selecto-drag text-hover-primary me-8",to:"".concat(m,"/cms/categories/").concat(d,"/articles/").concat(t.id,"#comments"),children:[(0,e.jsx)(O.ZP,{className:"svg-icon-6 me-2",name:"Bootstrap/chat"}),"41W"]})]})]}),t.image&&(0,e.jsx)("div",{className:"px-8 d-flex align-items-end",children:(0,e.jsx)(a.mN,{className:"article-image",src:"//api.asany.cn/graphql"+"/preview/".concat((P=t.image)===null||P===void 0?void 0:P.id)})})]})}},{title:"\u72B6\u6001",dataIndex:"status",width:120,render:function(u){var t={DRAFT:{title:"\u8349\u7A3F",lightStyle:"danger"},PUBLISHED:{title:"\u5DF2\u53D1\u5E03"},SCHEDULED:{title:"\u8BA1\u5212",lightStyle:"primary"}};return(0,e.jsx)(a.Ct,{lightStyle:t[u].lightStyle,children:t[u].title})}},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(u,t){return(0,e.jsx)(g,{baseUrl:"".concat(m,"/cms/categories/").concat(d),data:t,refetch:j})}}]}):(0,e.jsxs)(a.HY,{title:"\u65B0\u589E\u6587\u7AE0",description:"\u8BE5\u680F\u76EE\u8FD8\u662F\u7A7A\u7684\uFF0C\u6CA1\u6709\u4EFB\u4F55\u6587\u7AE0",image:"/assets/media/illustrations/sigma-1/4.png",children:[(0,e.jsx)(a.zx,{as:D.Link,className:"me-2",variant:"light",to:"".concat(m,"/settings"),children:"\u67E5\u770B\u680F\u76EE\u4FE1\u606F"}),(0,e.jsx)(a.zx,{as:D.Link,variant:"primary",to:"".concat(m,"/cms/categories/").concat(d,"/articles/new"),children:"\u65B0\u5EFA\u6587\u7AE0"})]})})]})})})}U.default=ee}}]);
