(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[7131],{19273:function(I,f,n){"use strict";n.d(f,{Z:function(){return a}});function a(i){if(i==null)throw new TypeError("Cannot destructure undefined")}},64043:function(I,f,n){"use strict";n.d(f,{ZO:function(){return a.ZO},Yw:function(){return a.Yw},KX:function(){return a.KX},I1:function(){return a.I1},Pw:function(){return a.Pw},aA:function(){return a.aA},Af:function(){return a.Af},G$:function(){return a.G$},_c:function(){return a._c},c9:function(){return a.c9},P6:function(){return a.P6},oM:function(){return a.oM},WF:function(){return a.WF},ot:function(){return a.ot},au:function(){return a.au},Nq:function(){return a.Nq},wp:function(){return a.wp},w4:function(){return a.w4},ko:function(){return a.ko},AQ:function(){return a.AQ}});var a=n(23798)},87131:function(I,f,n){"use strict";n.r(f);var a=n(11849),i=n(39428),B=n(3182),N=n(19273),v=n(2824),o=n(67294),k=n(94184),T=n.n(k),R=n(18071),u=n(17818),g=n(64043),e=n(85893);function U(E){var c=E.visible,l=E.onCancel,s=E.data,x=(0,o.useState)(!0),D=(0,v.Z)(x,2),M=D[0],y=D[1],Z=(0,g.G$)(),F=(0,v.Z)(Z,2),m=F[0];(0,N.Z)(F[1]);var b=(0,o.useCallback)(function(p,j){y(j.verify!=(s==null?void 0:s.name))},[s==null?void 0:s.name]),w=(0,o.useCallback)((0,B.Z)((0,i.Z)().mark(function p(){return(0,i.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,m({variables:{id:s.id}});case 2:u.FN.success("\u6A21\u5757 \u201C".concat(s.name,"\u201D \u5220\u9664\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0});case 3:case"end":return h.stop()}},p)})),[s.id,s.name,m]);return(0,e.jsxs)(u.u_,{dialogClassName:T()("asany-confirm-modal w-450px"),visible:c,onCancel:l,title:"\u786E\u5B9A\u5220\u9664\u6A21\u5757\u5417\uFF1F",footer:!1,bodyClassName:"p-0",children:[(0,e.jsx)(u.bZ,{type:"danger",message:"\u8BF7\u4ED4\u7EC6\u9605\u8BFB\u4EE5\u4E0B\u4E8B\u9879"}),(0,e.jsxs)("div",{className:"inner-body p-7",children:[(0,e.jsxs)("p",{className:"fs-7",children:["\u60A8\u5373\u5C06\u5220\u9664 ",(0,e.jsx)("b",{children:s==null?void 0:s.name}),"\uFF0C\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\u548C\u6062\u590D\u3002"]}),(0,e.jsx)(u.Z0,{className:"my-5"}),(0,e.jsx)(u.l0,{onValuesChange:b,children:(0,e.jsx)(u.l0.Item,{className:"mb-5",name:"verify",label:(0,e.jsxs)(e.Fragment,{children:["\u8F93\u5165\u201C",(0,e.jsx)("i",{children:s==null?void 0:s.name}),"\u201D\uFF0C\u5DF2\u5B8C\u6210\u9A8C\u8BC1"]}),children:(0,e.jsx)(u.II,{solid:!0})})}),(0,e.jsx)(u.zx,{onClick:w,className:"asany-confirm-modal-button",disabled:M,variant:"light-danger",children:"\u5220\u9664\u6B64\u6A21\u5757"})]})]})}function K(E){var c=u.l0.useForm(),l=E.location.state.module,s=(0,o.useState)(!1),x=(0,v.Z)(s,2),D=x[0],M=x[1],y=(0,g.ot)(),Z=(0,v.Z)(y,1),F=Z[0],m=(0,o.useRef)(new AbortController),b="cn.asany",w=(0,g.AQ)(),p=(0,v.Z)(w,2),j=p[0],h=p[1].loading,L=(0,o.useCallback)((0,B.Z)((0,i.Z)().mark(function C(){var r;return(0,i.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,c.validateFields();case 2:return r=d.sent,d.next=5,j({variables:{id:l.id,input:(0,a.Z)((0,a.Z)({},r),{},{code:b+"."+r.code})}});case 5:u.FN.success("\u6A21\u5757 \u201C".concat(r.name,"\u201D \u66F4\u65B0\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0});case 6:case"end":return d.stop()}},C)})),[c,l.id,j]),W=(0,o.useCallback)(function(){M(!1)},[]),S=(0,o.useCallback)(function(){M(!0)},[]);return(0,o.useEffect)(function(){var C,r;c.setFieldsValue((0,a.Z)((0,a.Z)({},l),{},{code:(C=l.code)===null||C===void 0?void 0:C.replaceAll(b+".",""),picture:(r=l.picture)===null||r===void 0?void 0:r.id}))},[c,l]),(0,e.jsxs)(R.JH,{children:[(0,e.jsxs)(u.Zb,{className:"mb-5 mb-xl-10",children:[(0,e.jsx)(u.Zb.Header,{children:(0,e.jsx)(u.Zb.Title,{children:"\u6A21\u5757\u4FE1\u606F"})}),(0,e.jsxs)(u.Zb.Body,{children:[(0,e.jsxs)(u.l0,{form:c,className:"mw-800px row d-flex flex-shrink-0 flex-column-reverse flex-md-row",children:[(0,e.jsx)("div",{className:"mw-500px col-12 col-md-8",children:(0,e.jsxs)("div",{className:"mw-400px",children:[(0,e.jsx)(u.l0.Item,{required:!1,className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(u.II,{solid:!0})}),(0,e.jsx)(u.l0.Item,{required:!1,className:"my-5",name:"code",label:"\u7F16\u7801",hasFeedback:!0,help:"\u8BF7\u53C2\u8003\u7F16\u7A0B\u4E2D\u547D\u540D\u7A7A\u95F4\u7684\u5199\u6CD5",rules:[{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{validator:function(r,A){return(0,B.Z)((0,i.Z)().mark(function d(){var P,O,_;return(0,i.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(A){t.next=2;break}return t.abrupt("return");case 2:if(P=b+"."+A,m.current&&m.current.abort(),P!=l.code){t.next=6;break}return t.abrupt("return");case 6:return m.current=new AbortController,t.next=9,F({variables:{filter:{code:P},limit:1},fetchPolicy:"network-only",context:{fetchOptions:{signal:m.current.signal}}});case 9:if(O=t.sent,_=O.data,console.log("validator",r,A,_==null?void 0:_.modules),!(_!=null&&_.modules.length)){t.next=14;break}throw new Error(r.message);case 14:case"end":return t.stop()}},d)}))()},message:"\u7F16\u7801\u4E0D\u80FD\u91CD\u590D"}],children:(0,e.jsx)(u.II,{solid:!0,addonBefore:b+".",placeholder:"\u4F8B\u5982: module.text"})}),(0,e.jsx)(u.l0.Item,{className:"my-5",name:"description",label:"\u63CF\u8FF0",requiredMark:"optional",children:(0,e.jsx)(u.II.TextArea,{solid:!0,autoSize:{maxRows:4,minRows:2}})})]})}),(0,e.jsx)("div",{className:"col-12 col-md-4",children:(0,e.jsx)("div",{className:"row",children:(0,e.jsx)(u.l0.Item,{className:"mb-5",name:"picture",label:"\u6A21\u5757\u56FE\u7247",help:"\u5141\u8BB8\u7684\u6587\u4EF6\u7C7B\u578B:png, jpg, jpeg\u3002",children:(0,e.jsx)(u.gq.Image,{width:148,height:148,space:"7VE4SSrk",crop:{height:300,zoomable:!1,aspectRatio:1},accept:".png, .jpg, .jpeg",background:(0,e.jsx)(u.mN,{autoColor:!1,labelClassName:"bg-dark text-inverse-info fs-3tx",alt:l.name})})})})})]}),(0,e.jsx)(u.zx,{loading:h,onClick:L,children:"\u66F4\u65B0\u6A21\u5757\u4FE1\u606F"})]})]}),(0,e.jsxs)(u.Zb,{className:"mb-5 mb-xl-10",children:[(0,e.jsx)(u.Zb.Header,{children:(0,e.jsx)(u.Zb.Title,{className:"text-danger",children:"\u5220\u9664\u6A21\u5757"})}),(0,e.jsxs)(u.Zb.Body,{children:[(0,e.jsxs)("div",{className:"fs-7 gap-2 d-flex flex-column mb-3",children:[(0,e.jsx)("p",{className:"mb-0",children:"\u5220\u9664\u64CD\u4F5C\u5C06\u4F1A\u6E05\u9664\u6389\u6A21\u5757\u4E2D\u7684\u6240\u6709\u5185\u5BB9\uFF0C\u5305\u62EC\uFF1A\u6A21\u578B/\u6570\u636E\u7B49"}),(0,e.jsx)("p",{className:"mb-0",children:"\u5E10\u6237\u5220\u9664\u540E\uFF0C\u5C06\u65E0\u6CD5\u6062\u590D\u3002\u8BF7\u8C28\u614E\u64CD\u4F5C\u3002"})]}),(0,e.jsx)(u.zx,{variant:"danger",onClick:S,children:"\u5220\u9664\u6A21\u5757"}),(0,e.jsx)(U,{data:l,visible:D,onCancel:W})]})]})]})}f.default=K}}]);
