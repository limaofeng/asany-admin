"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3673,267],{51253:function(ne,k,n){n.d(k,{GP:function(){return D.Z},Hk:function(){return o},xx:function(){return R.x}});var re=n(74958),D=n(5166),R=n(19260),U=n(68400),c=n.n(U),y=n(62435),d=n(93967),h=n.n(d),w=n(94589),$=n(97857),l=n.n($),K=n(46027),M=n(10582),W=n(42687),H=n(79817),V=n(5574),J=n.n(V),Q=n(96486),j=n(86074),T={aside:{minimize:!1,width:280}},e=y.createContext({state:T,dispatch:function(){}}),z=function(r){return r.AsideToggle="ASIDE_TOGGLE",r.AsideWidth="ASIDE_WIDTH",r}({});function Y(r,i){switch(i.type){case"ASIDE_TOGGLE":return r.aside.minimize=!r.aside.minimize,l()({},r);case"ASIDE_WIDTH":return r.aside.width=i.payload,l()({},r);default:throw new Error}}var X=function(i){var v=(0,y.useReducer)(Y,(0,Q.cloneDeep)(T)),t=J()(v,2),f=t[0],g=t[1];return(0,j.jsx)(e.Provider,{value:{state:f,dispatch:g},children:i.children})},S=function(){return(0,y.useContext)(e)},q=n(65495);function G(r){var i=S(),v=i.dispatch,t=i.state.aside.minimize,f=(0,y.useCallback)(function(){v({type:z.AsideToggle})},[v]);return(0,j.jsx)(H.Button,{style:l()({marginBottom:"1.35rem",zIndex:105},r.style),onClick:f,activeColor:"primary",className:h()("micro-app-aside-toggle","btn-icon bg-body btn-color-gray-700 rounded-2 position-absolute translate-middle bottom-0 shadow-sm d-none d-lg-flex",r.className,{active:t}),children:(0,j.jsx)(K.JO,{name:"Duotune/arr063",className:"svg-icon-2 rotate-180"})})}var _={"drawer drawer-start":{maxWidth:992}};function L(r){var i=r.className,v=r.header,t=r.children,f=r.collapsible,g=f===void 0?!0:f,p=r.width,N=p===void 0?280:p,u=(0,W.$Y)(),x=S(),C=x.dispatch;(0,y.useEffect)(function(){u.aside.width(N+100),C({type:z.AsideWidth,payload:N})},[u.aside,C,N]);var A=(0,M.CN)(_),P=(0,W.BK)(function(s){return s.aside.drawer});return(0,j.jsxs)("div",{className:h()("app-aside aside",i,A,{"drawer-on":P}),children:[(0,j.jsx)(q.Z,{children:(0,j.jsx)(D.Z,{header:v,resizeable:!0,className:"app-sidebar",children:t})}),g&&(0,j.jsx)(G,{className:"start-100 end-0"})]})}L.Toggle=G;var ee=L,O,ae=w.ZP.div(O||(O=c()([`
  --root-aside-width: `,`;
  --met-aside-width: `,`;
`])),function(r){return r.minimize?"100px":"".concat(r.width,"px")},function(r){return r.minimize?"100px":"".concat(r.width,"px")});function m(r){var i=r.children,v=r.className,t=S(),f=t.state.aside,g=f.minimize,p=f.width,N=(0,y.useCallback)(function(u){u.preventDefault()},[]);return(0,j.jsx)(ae,{minimize:g,width:p,className:h()("micro-app-container page-full-content",v,{"aside-minimize":g}),onContextMenu:N,children:i})}function a(r){var i=r.children,v=r.className;return(0,j.jsx)(X,{children:(0,j.jsx)(m,{className:v,children:i})})}a.Sidebar=ee;var o=a},7343:function(ne,k,n){n.r(k),n.d(k,{default:function(){return ae}});var re=n(64599),D=n.n(re),R=n(19632),U=n.n(R),c=n(62435),y=n(96974),d=n(46027),h=n(12845),w=n(1861),$=n(51253),l=n(79817),K=n(15009),M=n.n(K),W=n(99289),H=n.n(W),V=n(5574),J=n.n(V),Q=n(93967),j=n.n(Q),T=n(32115),e=n(86074);function z(m){return["zip"].includes(m.extension)?(0,e.jsx)(d.ZP,{name:"Bootstrap/file-zip-fill",className:"svg-icon-2x"}):m.mimeType.startsWith("image/")?(0,e.jsx)(d.ZP,{name:"Bootstrap/file-image-fill",className:"svg-icon-2x"}):m.mimeType.startsWith("video/")?(0,e.jsx)(d.ZP,{name:"Bootstrap/file-play-fill",className:"svg-icon-2x"}):(0,e.jsx)(d.ZP,{name:"Bootstrap/file-post-fill",className:"svg-icon-2x"})}function Y(m){var a=m.file,o=(0,y.s0)(),r=(0,h.useModel)("cloud-drive.index",function(u){return u.api.base}),i=(0,h.useModel)("cloud-drive.index",function(u){return u.api.upload}),v=(0,c.useCallback)(function(){i.cancel(a.id)},[i,a.id]),t=(0,c.useCallback)(function(){r.closeTransfers(),o("/drive/folders/".concat(a.result.parentFolder.id))},[r,a.result,history]),f=(0,c.useCallback)(function(){i.start(a.id)},[i,a.id]),g=(0,c.useCallback)(function(){i.restore(a.id)},[i,a.id]),p=(0,c.useCallback)(function(){i.pause(a.id)},[i,a.id]),N=(0,c.useCallback)(function(){i.delete(a.id)},[i,a.id]);return(0,e.jsxs)("li",{className:j()("file-item",{"file-item-uploaded":["completed","error"].includes(a.state)}),children:[(0,e.jsx)("div",{className:"file-icon",children:z(a)}),(0,e.jsxs)("div",{className:"file-details",children:[(0,e.jsx)("div",{className:"file-title",children:a.name}),(0,e.jsx)("div",{className:j()("file-transfer-progress progress",{"opacity-0":a.state==="completed"}),children:(0,e.jsx)(l.Progress,{color:"success",percent:a.progress})}),(0,e.jsxs)("div",{className:"file-status",children:[(0,e.jsx)("div",{className:"file-size",children:(0,T.jb)(a.size)}),a.state==="error"&&(0,e.jsx)("div",{className:"upload-error text-danger",children:"\u4E0A\u4F20\u51FA\u73B0\u9519\u8BEF!"}),!["completed","error"].includes(a.state)&&(0,e.jsx)("div",{className:"file-transfer-rate",children:a.progress===100?"\u7B49\u5F85\u5B8C\u6210...":!!a.uploadSpeed&&a.uploadSpeed+"/s"})]})]}),(0,e.jsxs)("div",{className:"file-actions",children:[a.state==="waiting"&&(0,e.jsx)(l.Button,{icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/clock",className:"svg-icon-4"})}),a.state==="uploading"&&(0,e.jsx)(l.Button,{onClick:p,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/pause",className:"svg-icon-4"})}),a.state==="paused"&&(0,e.jsx)(l.Button,{onClick:f,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/arrow-up-short",className:"svg-icon-4"})}),["canceled","error"].includes(a.state)&&(0,e.jsx)(l.Button,{onClick:g,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/arrow-counterclockwise",className:"svg-icon-4"})}),a.state==="completed"&&(0,e.jsx)(l.Button,{onClick:t,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/folder2",className:"svg-icon-6"})}),!["completed","canceled","error"].includes(a.state)&&(0,e.jsx)(l.Button,{onClick:v,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/x",className:"svg-icon-4"})}),["completed","canceled","error"].includes(a.state)&&(0,e.jsx)(l.Button,{onClick:N,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/eraser",className:"svg-icon-6"})})]})]},a.id)}function X(){var m=(0,h.useModel)("cloud-drive.index",function(a){var o=a.state;return o.uploadFiles});return(0,e.jsx)(w.E,{className:j()("custom-scrollbar"),options:{scrollbars:{autoHide:"scroll"}},children:m.length?(0,e.jsx)("ul",{className:"transfer-file-list",children:m.map(function(a){return(0,e.jsx)(Y,{file:a},a.id)})}):(0,e.jsxs)("div",{className:"transfer-list-empty",children:[(0,e.jsx)("img",{src:"/assets/media/illustrations/dozzy-1/4.png"}),(0,e.jsx)("span",{className:"empty-title",children:"\u6CA1\u6709\u4E0A\u4F20\u4EFB\u52A1"})]})})}function S(m){var a=m.file,o=(0,h.useModel)("cloud-drive.index",function(p){return p.api.download}),r=(0,c.useCallback)(function(){o.cancel(a.id)},[o,a.id]),i=(0,c.useCallback)(function(){o.save(a.id),console.log("\u672C\u5730\u4E0B\u8F7D")},[o,a.id]),v=(0,c.useCallback)(function(){o.start(a.id)},[o,a.id]),t=(0,c.useCallback)(function(){o.restore(a.id)},[o,a.id]),f=(0,c.useCallback)(function(){o.pause(a.id)},[o,a.id]),g=(0,c.useCallback)(function(){o.delete(a.id)},[o,a.id]);return(0,e.jsxs)("li",{className:j()("file-item",{"file-item-download":["completed","error"].includes(a.state)}),children:[(0,e.jsx)("div",{className:"file-icon",children:z(a)}),(0,e.jsxs)("div",{className:"file-details",children:[(0,e.jsx)("div",{className:"file-title",children:a.name}),(0,e.jsx)("div",{className:j()("file-transfer-progress progress",{"opacity-0":a.state==="completed"}),children:(0,e.jsx)(l.Progress,{color:"primary",percent:a.progress})}),(0,e.jsxs)("div",{className:"file-status",children:[(0,e.jsx)("div",{className:"file-size",children:!!a.size&&(0,T.jb)(a.size)}),a.state==="error"&&(0,e.jsx)("div",{className:"upload-error text-danger",children:"\u4E0B\u8F7D\u51FA\u73B0\u9519\u8BEF!"}),!["completed","error"].includes(a.state)&&(0,e.jsx)("div",{className:"file-transfer-rate",children:a.progress===0||!a.size?"\u7B49\u5F85\u8D44\u6E90...":!!a.downloadSpeed&&a.downloadSpeed+"/s"})]})]}),(0,e.jsxs)("div",{className:"file-actions",children:[a.state==="waiting"&&(0,e.jsx)(l.Button,{icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/clock",className:"svg-icon-4"})}),a.state==="downloading"&&(0,e.jsx)(l.Button,{onClick:f,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/pause",className:"svg-icon-4"})}),a.state==="paused"&&(0,e.jsx)(l.Button,{onClick:v,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/arrow-down-short",className:"svg-icon-4"})}),["canceled","error"].includes(a.state)&&(0,e.jsx)(l.Button,{onClick:t,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/arrow-counterclockwise",className:"svg-icon-4"})}),a.state==="completed"&&(0,e.jsx)(l.Button,{onClick:i,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/download",className:"svg-icon-6"})}),!["completed","canceled","error"].includes(a.state)&&(0,e.jsx)(l.Button,{onClick:r,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/x",className:"svg-icon-4"})}),["completed","canceled","error"].includes(a.state)&&(0,e.jsx)(l.Button,{onClick:g,icon:(0,e.jsx)(d.ZP,{name:"Bootstrap/eraser",className:"svg-icon-6"})})]})]},a.id)}function q(){var m=(0,h.useModel)("cloud-drive.index",function(a){var o=a.state;return o.downloadFiles});return(0,e.jsx)(w.E,{className:j()("custom-scrollbar"),options:{scrollbars:{autoHide:"scroll"}},children:m.length?(0,e.jsx)("ul",{className:"transfer-file-list",children:m.map(function(a){return(0,e.jsx)(S,{file:a},a.id)})}):(0,e.jsxs)("div",{className:"transfer-list-empty",children:[(0,e.jsx)("img",{src:"/assets/media/illustrations/dozzy-1/4.png"}),(0,e.jsx)("span",{className:"empty-title",children:"\u6CA1\u6709\u4E0B\u8F7D\u4EFB\u52A1"})]})})}function G(){var m=(0,c.useState)("upload"),a=J()(m,2),o=a[0],r=a[1],i=(0,c.useCallback)(function(u){r(u)},[]),v=(0,h.useModel)("cloud-drive.index",function(u){return{deleteUploadFile:u.api.upload.delete,deleteDownloadFile:u.api.download.delete}}),t=(0,h.useModel)("cloud-drive.index",function(u){var x=u.state;return x.uploadFiles.filter(function(C){return C.state==="completed"})}),f=(0,h.useModel)("cloud-drive.index",function(u){var x=u.state;return x.downloadFiles.filter(function(C){return C.state==="completed"})}),g=(0,c.useCallback)(H()(M()().mark(function u(){var x,C,A;return M()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:x=D()(t),s.prev=1,x.s();case 3:if((C=x.n()).done){s.next=9;break}return A=C.value,s.next=7,v.deleteUploadFile(A.id);case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),x.e(s.t0);case 14:return s.prev=14,x.f(),s.finish(14);case 17:case"end":return s.stop()}},u,null,[[1,11,14,17]])})),[v,t]),p=(0,c.useCallback)(H()(M()().mark(function u(){var x,C,A;return M()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:x=D()(f),s.prev=1,x.s();case 3:if((C=x.n()).done){s.next=9;break}return A=C.value,s.next=7,v.deleteDownloadFile(A.id);case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),x.e(s.t0);case 14:return s.prev=14,x.f(),s.finish(14);case 17:case"end":return s.stop()}},u,null,[[1,11,14,17]])})),[v,f]),N=(0,c.useMemo)(function(){return!!t.length&&o==="upload"||!!f.length&&o==="download"},[o,t.length,f.length]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"popover-header",children:[(0,e.jsx)("span",{className:"popover-title",children:"\u4F20\u8F93\u5217\u8868"}),(0,e.jsx)("div",{className:"popover-toolbar",children:N&&(0,e.jsx)("a",{className:"cursor-pointer",onClick:o==="upload"?g:p,children:"\u6E05\u7A7A\u5DF2\u5B8C\u6210"})})]}),(0,e.jsxs)(l.Tabs,{tabBarClassName:"border-0",activeKey:o,onChange:i,tabPosition:"left",children:[(0,e.jsx)(l.Tabs.TabPane,{tab:"\u6587\u4EF6\u4E0A\u4F20",children:(0,e.jsx)(X,{})},"upload"),(0,e.jsx)(l.Tabs.TabPane,{tab:"\u6587\u4EF6\u4E0B\u8F7D",children:(0,e.jsx)(q,{})},"download")]})]})}var _=G,L=n(82471);function ee(m){var a=m.drives,o=m.onAction,r=(0,h.useModel)("cloud-drive.index",function(t){var f=t.state;return f.driveId}),i=(0,c.useCallback)(function(t){if(t.startsWith("drive-"))console.log(t);else return o(t),!1;return!0},[o]),v=(0,c.useMemo)(function(){return[].concat(U()(a.map(function(t){return{value:"drive-".concat(t.id),label:t.name}})),[{type:"separator"},{value:"preferences",label:"\u504F\u597D\u8BBE\u7F6E"}])},[a]);return(0,e.jsx)("div",{className:"app-sidebar-footer",children:(0,e.jsx)(l.Select,{onChange:i,placement:"topCenter",value:r?"drive-".concat(r):void 0,options:v})})}function O(){var m=(0,h.useModel)("cloud-drive.index",function(s){var b=s.state;return b.driveId}),a=(0,h.useModel)("cloud-drive.index",function(s){var b=s.state;return b.visibleTransfers}),o=(0,h.useModel)("cloud-drive.index",function(s){return s.api.base}),r=(0,y.bS)("/drive/:type"),i=(0,y.bS)("/drive/:type/:value"),v=(0,L.dH)({fetchPolicy:"cache-and-network"}),t=v.data,f=(0,h.useModel)("cloud-drive.index",function(s){var b=s.state;return b.driveId}),g=(0,h.useModel)("cloud-drive.index",function(s){return s.setCloudDrive});(0,c.useEffect)(function(){if(t!=null&&t.cloudDrives){var s=t==null?void 0:t.cloudDrives;s.some(function(b){return b.id===f})||g(s[0])}},[t==null?void 0:t.cloudDrives,g,f]);var p=(0,c.useMemo)(function(){if(!(!(t!=null&&t.cloudDrives)||!m))return t.cloudDrives.find(function(s){return s.id===m})},[t==null?void 0:t.cloudDrives,m]),N=(0,c.useMemo)(function(){return(r==null?void 0:r.params.type)||(i==null?void 0:i.params.type)},[r,i]),u=(0,c.useMemo)(function(){return i==null?void 0:i.params.value},[i]),x=(0,c.useCallback)(function(s){s?o.openTransfers():o.closeTransfers()},[o]),C=(0,c.useMemo)(function(){return u?N==="folders"?["my-drive"]:N==="mime-types"?[u]:[N]:[N]},[N,u]),A=(0,h.useModel)("cloud-drive.index",function(s){var b=s.state,Z=0,E=0,F=D()(b.uploadFiles),I;try{for(F.s();!(I=F.n()).done;){var B=I.value;Z+=B.size,E+=B.size*(B.progress/100)}}catch(se){F.e(se)}finally{F.f()}return Math.max(E/Z*100<<0,b.uploadFiles.length?1:0)}),P=(0,h.useModel)("cloud-drive.index",function(s){var b=s.state,Z=0,E=0,F=D()(b.downloadFiles),I;try{for(F.s();!(I=F.n()).done;){var B=I.value;Z+=B.size,E+=B.size*(B.progress/100)}}catch(se){F.e(se)}finally{F.f()}return Math.max(E/Z*100<<0,b.downloadFiles.length?1:0)});return(0,e.jsxs)($.GP,{collapsible:!1,width:280,className:"app-sidebar app-drive-sidebar",children:[(0,e.jsxs)("div",{className:"relative mt-5 px-5 pt-5 d-flex",children:[(0,e.jsx)("h1",{className:"text-gray-800 flex-row-fluid fw-bold mb-6 mx-5",children:"\u4E91\u76D8"}),(0,e.jsx)(l.Popover,{visible:a,onVisibleChange:x,overlayClassName:"dialog-transfers",content:(0,e.jsx)(_,{}),children:(0,e.jsxs)("div",{className:"file-transfer-icon",children:[(0,e.jsx)(l.CircleProgress,{className:"download-all-progress position-absolute top-50 start-50 translate-middle",width:34,percent:P,strokeWidth:6,success:{strokeColor:"#04c8c8"}}),(0,e.jsx)(l.CircleProgress,{className:"upload-all-progress position-absolute top-50 start-50 translate-middle",width:26,percent:A,strokeWidth:7.5,success:{strokeColor:"#009ef7"}}),(0,e.jsx)(l.Pulse,{size:"sm",pause:!P&&!A,children:(0,e.jsx)(d.ZP,{className:"svg-icon-6",name:"Duotune/arr032"})})]})})]}),(0,e.jsxs)(w.E,{className:"app-sidebar-body flex-column-fluid d-flex flex-column px-8 custom-scrollbar",options:{scrollbars:{autoHide:"scroll"}},children:[(0,e.jsxs)(l.Menu,{className:"menu-title-gray-600 menu-icon-gray-400 menu-state-bg menu-state-primary menu-state-icon-primary menu-state-bullet-primary",accordion:!1,rounded:!0,selectable:"AllMenu",openKeys:["my-drive"],selectedKeys:C,children:[(0,e.jsxs)(l.Menu.SubMenu,{url:"/drive/my-drive",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/abs040"}),title:"\u6211\u7684\u6587\u4EF6",children:[(0,e.jsx)(l.Menu.Item,{className:"mb-2 mt-2",url:"/drive/mime-types/image",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/gen006"}),children:"\u56FE\u7247"},"image"),(0,e.jsx)(l.Menu.Item,{className:"mb-2",url:"/drive/mime-types/document",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/fil003"}),children:"\u6587\u6863"},"document"),(0,e.jsx)(l.Menu.Item,{className:"mb-2",url:"/drive/mime-types/video",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/arr027"}),children:"\u89C6\u9891"},"video"),(0,e.jsx)(l.Menu.Item,{className:"mb-2",url:"/drive/mime-types/audio",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/elc008"}),children:"\u97F3\u9891"},"audio"),(0,e.jsx)(l.Menu.Item,{url:"/drive/mime-types/other",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/gen052"}),children:"\u5176\u4ED6"},"other")]},"my-drive"),(0,e.jsx)(l.Menu.Separator,{className:"my-1"}),(0,e.jsx)(l.Menu.Item,{className:"mb-2",url:"/drive/starred",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/abs024"}),children:"\u6536\u85CF\u5939"},"starred"),(0,e.jsx)(l.Menu.Item,{url:"/drive/trash",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/gen027"}),children:"\u56DE\u6536\u7AD9"},"trash"),(0,e.jsx)(l.Menu.Separator,{className:"my-1"}),(0,e.jsx)(l.Menu.Item,{url:"/drive/quota",titleClassName:"fw-bolder",icon:(0,e.jsx)(d.ZP,{className:"svg-icon-2 me-3",name:"Duotune/fil020"}),children:"\u5B58\u50A8\u7A7A\u95F4"},"quota")]}),(0,e.jsxs)("div",{className:"drive-quota d-flex align-items-center flex-column mb-10",children:[(0,e.jsx)("div",{className:"h-5px mx-3 w-100 bg-light mb-2",children:(0,e.jsx)("div",{className:"bg-success rounded h-5px",role:"progressbar",style:{width:"".concat((p==null?void 0:p.quota.usage)/(p==null?void 0:p.quota.size)*100,"%")}})}),(0,e.jsxs)("div",{className:"d-flex justify-content-between w-100 mt-auto mb-2",children:[(0,e.jsxs)("span",{className:"fw-bold fs-7 text-gray-400",children:["\u5DF2\u4F7F\u7528\xA0",p==null?void 0:p.quota.usageStr,", \xA0\u5171\xA0",p==null?void 0:p.quota.sizeStr]}),(0,e.jsx)("a",{className:"fw-bolder fs-7 text-success",children:"\u6269\u5BB9"})]})]})]}),(0,e.jsx)(ee,{drives:(t==null?void 0:t.cloudDrives)||[],onAction:function(){}})]})}var ae=O}}]);
