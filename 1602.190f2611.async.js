(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[1602],{64043:function(D,j,u){"use strict";u.d(j,{ZO:function(){return a.ZO},Yw:function(){return a.Yw},KX:function(){return a.KX},I1:function(){return a.I1},Pw:function(){return a.Pw},aA:function(){return a.aA},Af:function(){return a.Af},G$:function(){return a.G$},_c:function(){return a._c},c9:function(){return a.c9},P6:function(){return a.P6},oM:function(){return a.oM},WF:function(){return a.WF},ot:function(){return a.ot},au:function(){return a.au},Nq:function(){return a.Nq},wp:function(){return a.wp},w4:function(){return a.w4},ko:function(){return a.ko},AQ:function(){return a.AQ}});var a=u(23798)},51602:function(D,j,u){"use strict";u.r(j),u.d(j,{default:function(){return Q}});var a=u(2824),d=u(67294),I=u(7020),S=u(73727),O=u(28865),b=u(39428),B=u(11849),E=u(3182),g=u(64043),n=u(17818),e=u(85893);function P(v){var N=v.visible,y=v.onClose,h=v.onSuccess,r=n.l0.useForm(),o=(0,g.ot)(),F=(0,a.Z)(o,1),m=F[0],A=(0,g.aA)(),p=(0,a.Z)(A,2),C=p[0],w=p[1].loading,c=(0,d.useRef)(new AbortController),l="cn.asany",x=(0,d.useCallback)((0,E.Z)((0,b.Z)().mark(function k(){var i,f,M;return(0,b.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.validateFields();case 2:return i=s.sent,s.next=5,C({variables:{input:(0,B.Z)((0,B.Z)({},i),{},{code:l+"."+i.code})}});case 5:f=s.sent,M=f.data,n.FN.success("\u6A21\u5757 \u201C".concat(i.name,"\u201D \u65B0\u589E\u6210\u529F"),2e3,{placement:"bottom-end",progressBar:!0}),h(M.createModule);case 9:case"end":return s.stop()}},k)})),[C,r,h]);return(0,e.jsxs)(n.u_,{confirmLoading:w,maskClosable:!w,width:592,centered:!0,visible:N,closable:!1,onCancel:y,onOk:x,children:[(0,e.jsx)(n.u_.Header,{children:(0,e.jsx)("h4",{children:"\u65B0\u6A21\u5757"})}),(0,e.jsx)(n.u_.Body,{children:(0,e.jsxs)(n.l0,{form:r,children:[(0,e.jsx)(n.l0.Item,{required:!1,className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(n.II,{solid:!0})}),(0,e.jsx)(n.l0.Item,{required:!1,className:"mb-5",name:"code",label:"\u7F16\u7801",hasFeedback:!0,help:"\u8BF7\u53C2\u8003\u7F16\u7A0B\u4E2D\u547D\u540D\u7A7A\u95F4\u7684\u5199\u6CD5",rules:[{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{validator:function(i,f){return(0,E.Z)((0,b.Z)().mark(function M(){var Z,s;return(0,b.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(f){t.next=2;break}return t.abrupt("return");case 2:return c.current&&c.current.abort(),c.current=new AbortController,t.next=6,m({variables:{filter:{code:l+"."+f},limit:1},fetchPolicy:"network-only",context:{fetchOptions:{signal:c.current.signal}}});case 6:if(Z=t.sent,s=Z.data,console.log("validator",i,f,s==null?void 0:s.modules),!(s!=null&&s.modules.length)){t.next=11;break}throw new Error(i.message);case 11:case"end":return t.stop()}},M)}))()},message:"\u7F16\u7801\u4E0D\u80FD\u91CD\u590D"}],children:(0,e.jsx)(n.II,{solid:!0,addonBefore:l+".",placeholder:"\u4F8B\u5982: module.text"})}),(0,e.jsx)(n.l0.Item,{className:"mt-5",name:"description",label:"\u63CF\u8FF0",requiredMark:"optional",children:(0,e.jsx)(n.II.TextArea,{solid:!0,autoSize:{maxRows:4,minRows:2}})})]})})]})}var L=P,$=u(18071);function X(){var v=(0,d.useState)(!1),N=(0,a.Z)(v,2),y=N[0],h=N[1],r=(0,g.au)({fetchPolicy:"cache-and-network"}),o=r.data,F=r.loading,m=r.previousData,A=r.refetch,p=(0,d.useCallback)(function(){h(!1)},[]),C=(0,d.useCallback)(function(){h(!0)},[]),w=(0,d.useCallback)(function(l){A(),I.m8.push("/modules/".concat(l.id))},[A]),c=(0,d.useMemo)(function(){return(o==null?void 0:o.modules)||(m==null?void 0:m.modules)||[]},[o==null?void 0:o.modules,m]);return(0,e.jsxs)($.JH,{loading:F,className:"module-list",children:[(0,e.jsxs)("div",{className:"my-modules",children:[(0,e.jsxs)("h1",{className:"anchor fw-bold mb-5",children:["\u6211\u7684\u6A21\u5757(",c.length,")"]}),(0,e.jsx)(n.X2,{className:"py-2",cols:{md:2,xl:5},gutter:{default:5,xl:9},children:c.map(function(l){var x;return(0,e.jsx)(n.JX,{md:4,children:(0,e.jsxs)(n.Zb,{as:S.Link,to:"/modules/".concat(l.id),className:"module-card card-p-0",children:[(0,e.jsx)(n.Zb.Body,{children:(0,e.jsx)(n.mN,{autoColor:!1,labelClassName:"bg-dark text-inverse-info fs-5tx",src:(x=l.picture)===null||x===void 0?void 0:x.url,alt:l.name})}),(0,e.jsx)(n.Zb.Footer,{className:"p-4",children:(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("h3",{children:l.name}),(0,e.jsx)("span",{className:"tw-text-ellipsis overflow-hidden",children:l.description})]})})]})},l.id)})})]}),(0,e.jsxs)("div",{className:"create-new-module",children:[(0,e.jsxs)("div",{className:"d-flex flex-column",children:[(0,e.jsx)("h1",{className:"anchor fw-bold mb-5",children:"\u521B\u5EFA\u4E00\u4E2A\u65B0\u6A21\u5757"}),(0,e.jsx)("span",{className:"tw-text-ellipsis overflow-hidden",children:"\u521B\u5EFA\u4E00\u4E2A\u7A7A\u767D\u6A21\u5757\u6216\u4ECE\u6A21\u677F\u5F00\u59CB\u3002"})]}),(0,e.jsx)(n.X2,{className:"module-templates",cols:{md:2,xl:4},gutter:{default:5,xl:9},children:(0,e.jsx)(n.JX,{md:4,children:(0,e.jsx)(n.Zb,{as:"a",onClick:C,className:"module-card create-module-card card-p-0",children:(0,e.jsx)(n.Zb.Body,{children:(0,e.jsxs)("div",{className:"create-module-card-inner",children:[(0,e.jsx)("div",{className:"create-module-card__blank_icon",children:(0,e.jsx)(O.JO,{name:"Bootstrap/plus"})}),(0,e.jsx)("span",{className:"create-module-card__blank_name text-gray-700",children:"\u7A7A\u767D"})]})})})})}),(0,e.jsx)(L,{visible:y,onSuccess:w,onClose:p})]})]})}var Q=X}}]);
