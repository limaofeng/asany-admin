"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6805],{14336:function(te,z,r){var J=r(15009),m=r.n(J),X=r(97857),G=r.n(X),Y=r(99289),S=r.n(Y),g=r(62435),D=r(79817),q=r(12708);function C(w,O){return w.replace(/{(\w+)}/g,function(a,R){return O[R]!==void 0?O[R]:a})}function o(w,O){var a=(0,g.useRef)(!1),R=(0,g.useCallback)(function(){var T=S()(m()().mark(function e(s){var $,l,k,V;return m()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return $=w.width,l=w.title,k=w.content,s&&(typeof l=="string"&&(l=C(l,s)),typeof k=="string"&&(k=C(k,s)),typeof l=="function"&&(l=l(s)),typeof k=="function"&&(k=k(s))),j.next=5,D.Modal.confirm(G()(G()({},w),{},{title:l,content:k,width:$,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!a.current},preConfirm:function(){var Q=S()(m()().mark(function ee(){var c,E,I;return m()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a.current=!0,i.prev=1,c=document.querySelector(".swal2-confirm"),c.textContent="\u5220\u9664\u4E2D...",E=document.createElement("span"),E.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),c.appendChild(E),i.next=9,(0,q.gw)(O(s),350);case 9:I=i.sent,console.log(I);case 11:return i.prev=11,a.current=!1,i.finish(11);case 14:case"end":return i.stop()}},ee,null,[[1,,11,14]])}));function Z(){return Q.apply(this,arguments)}return Z}()}));case 5:if(V=j.sent,V.isConfirmed){j.next=8;break}return j.abrupt("return",!1);case 8:return D.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),j.abrupt("return",!0);case 10:case"end":return j.stop()}},e)}));return function(e){return T.apply(this,arguments)}}(),[O,w]);return[R]}z.Z=o},97294:function(te,z,r){var J=r(97857),m=r.n(J),X=r(5574),G=r.n(X),Y=r(52677),S=r.n(Y),g=r(62435),D=r(59197),q=r(93967),C=r.n(q),o=r(79817),w=r(8606),O=r(12708),a=r(86074),R=function(s){return s!=null&&s.url?s.url:S()(s==null?void 0:s.image)==="object"?"https://storage-api.asany.cn"+"/preview/".concat(s.image.id):typeof(s==null?void 0:s.image)=="string"?"https://storage-api.asany.cn"+"/preview/".concat(s.image):""};function T(e){var s=e.value,$=e.onChange,l=(0,g.useRef)({value:[],visible:!1}),k=(0,g.useReducer)(function(n){return n+1},0),V=G()(k,2),H=V[1];(0,O.KW)(function(){console.log("value",s),l.current.value=(s||[]).map(function(n){return{id:n.id,title:n.title,description:n.description,image:n.image,url:n.url,data_state:"edit"}}),H()},[s]);var j=(0,g.useCallback)(function(n){console.log("handleChange",n),$&&$(n)},[]),Q=(0,g.useCallback)(function(n){l.current.value=n.map(function(h){return{id:h.id,title:h.title,description:h.description,image:h.image,url:h.url,data_state:h.data_state}}),j(l.current.value)},[]),Z=(0,g.useCallback)(function(n){l.current.visible=n,H()},[]),ee=(0,g.useCallback)(function(n){n.preventDefault(),n.stopPropagation(),Z(!0)},[]),c=(0,g.useCallback)(function(n){l.current.value.push({id:(0,w.uuid)(),title:"",description:"",data_state:"new",image:n}),j(l.current.value)},[s]),E=(0,g.useCallback)(function(n){l.current.externalLink=n.target.value,H()},[]),I=(0,g.useCallback)(function(){l.current.value.push({id:(0,w.uuid)(),title:"",description:"",data_state:"new",image:void 0,url:l.current.externalLink}),j(l.current.value),Z(!1)},[s]),v=(0,g.useCallback)(function(){Z(!1)},[]),i=(0,g.useCallback)(function(n){return function(){l.current.value=l.current.value.filter(function(h){return h.id!==n}),j(l.current.value)}},[]),f=l.current.visible,y=l.current.value,A=l.current.externalLink;return(0,a.jsxs)("div",{className:"article-content-image",children:[(0,a.jsx)(o.Modal,{centered:!0,visible:f,dialogClassName:"modal-dialog-small w-500px",onCancel:v,onOk:I,title:"\u8BBE\u7F6E\u94FE\u63A5\u5F15\u7528",closable:!1,headerClassName:"border-bottom-0",bodyClassName:"py-2",footerClassName:"border-top-0",children:(0,a.jsx)(o.Input.TextArea,{value:A,autoSize:{minRows:3,maxRows:5},onChange:E})}),(0,a.jsx)("div",{className:"fv-row mb-6",children:(0,a.jsx)(o.SignleUpload,{accept:{"image/*":[".png",".jpg",".jpeg",".gif",".svg"]},title:(0,a.jsxs)(a.Fragment,{children:["\u5C06\u6587\u4EF6\u62D6\u62FD\u81F3\u6B64\u5904\u3001\u70B9\u51FB\u4E0A\u4F20\uFF0C\u6216",(0,a.jsx)("a",{onClick:ee,className:"",children:"\u8BBE\u7F6E"}),"\u94FE\u63A5\u5F15\u7528\u3002"]}),description:"\u652F\u6301\u7684\u683C\u5F0F\uFF1Apng, jpg, jpeg, gif, svg",onChange:c})}),(0,a.jsx)(D.ZP,{direction:"horizontal",layout:"grid",onChange:Q,tag:"div",className:"ps-0",draggable:!0,items:y,rerender:!1,itemRender:function(h,N){var M=h,t=M.data,L=M.drag,B=M.style;return(0,a.jsx)(o.Symbol.Image,{ref:L(N),labelClassName:"fs-2",size:150,style:m()({width:150,height:150},B),src:R(t),className:C()("shadow shadow-sm p-2 mb-6 me-6",{}),badge:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(o.Button,{as:"label",type:"circle",variant:!1,onClick:i(t.id),"data-kt-image-input-action":"change",className:"symbol-badge start-100 btn-icon btn-active-color-primary w-25px h-25px bg-body shadow",children:(0,a.jsx)("i",{className:"bi bi-x fs-2"})})})},t.id)},preview:{render:(0,D.HG)(function(n){var h=n,N=h.data;return(0,a.jsx)(o.Symbol.Image,{style:{width:150,height:150},labelClassName:"fs-2",size:150,src:R(N),className:C()("shadow shadow-sm p-2",{})})},{})}})]})}z.Z=T},96805:function(te,z,r){r.r(z),r.d(z,{default:function(){return ee}});var J=r(15009),m=r.n(J),X=r(52677),G=r.n(X),Y=r(97857),S=r.n(Y),g=r(99289),D=r.n(g),q=r(5574),C=r.n(q),o=r(62435),w=r(96974),O=r(73588),a=r(79817),R=r(42646),T=r(91726),e=r(86074),s={"product-maintenance-video":"videos","product-maintenance-manual":"tutorials","product-manual":"notebook","product-knowledge-base":"knowledgebase"};function $(c){var E=c.articles,I=E===void 0?[]:E,v=c.categoryId,i=c.productId,f=c.refetch,y=(0,T.LF)(),A=C()(y,1),n=A[0],h=(0,T.hb)(),N=C()(h,1),M=N[0],t=(0,R.vz)({fetchPolicy:"network-only",variables:{offset:0,limit:100,where:{category:{id:v}}}}),L=t.data,B=(L==null?void 0:L.articles)||[],ae=(0,o.useCallback)(function(b){return I.some(function(u){return u.id===b})},[I]),x=(0,o.useCallback)(function(b){return D()(m()().mark(function u(){return m()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,n({variables:{articleIds:[b],linkageType:s[v],productId:i}});case 2:a.Toast.success("\u5173\u8054\u6210\u529F",2e3,{placement:"bottom-left",progressBar:!0}),f();case 4:case"end":return _.stop()}},u)}))},[i,v,f]),U=(0,o.useCallback)(function(b){return D()(m()().mark(function u(){return m()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,M({variables:{articleIds:[b],linkageType:s[v],productId:i}});case 2:a.Toast.success("\u53D6\u6D88\u5173\u8054\u6210\u529F",2e3,{placement:"bottom-left",progressBar:!0}),f();case 4:case"end":return _.stop()}},u)}))},[i,v,f]),re=(0,o.useCallback)(function(b){return D()(m()().mark(function u(){return m()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,n({variables:{articleIds:b,linkageType:s[v],productId:i}});case 2:a.Toast.success("\u5173\u8054\u6210\u529F",2e3,{placement:"bottom-left",progressBar:!0}),f();case 4:case"end":return _.stop()}},u)}))},[v,i,f]),F=(0,o.useCallback)(function(b){return D()(m()().mark(function u(){return m()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,M({variables:{articleIds:b,linkageType:s[v],productId:i}});case 2:a.Toast.success("\u53D6\u6D88\u5173\u8054\u6210\u529F",2e3,{placement:"bottom-left",progressBar:!0}),f();case 4:case"end":return _.stop()}},u)}))},[v,i,f]);return(0,e.jsx)("div",{children:(0,e.jsx)(a.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(u){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:u}),"\u4E2A\u4EA7\u54C1\u6587\u7AE0"]})},toolbar:function(u){return(0,e.jsxs)("div",{children:[(0,e.jsx)(a.Button,{color:"success",onClick:re(u),variant:!1,children:"\u6279\u91CF\u5173\u8054"}),(0,e.jsx)(a.Button,{onClick:F(u),color:"danger",variant:!1,children:"\u6279\u91CF\u53D6\u6D88\u5173\u8054"})]})}},noRowsRenderer:function(){return(0,e.jsx)(a.Empty,{description:"\u6587\u7AE0\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"title",title:"\u6807\u9898"},{key:"createdAt",title:"\u521B\u5EFA\u65F6\u95F4",width:180},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(u,W){return(0,e.jsx)("div",{children:ae(W.id)?(0,e.jsx)("a",{href:"#",onClick:U(W.id),children:"\u53D6\u6D88\u5173\u8054"}):(0,e.jsx)("a",{href:"#",onClick:x(W.id),children:"\u5173\u8054"})})}}],dataSource:B})})}var l=$,k=r(97294),V=r(46027),H=r(14336);function j(c){var E=c.productId,I=c.warrantyPolicies,v=I===void 0?[]:I,i=c.refetch,f=a.Form.useForm(),y=(0,o.useRef)({mode:"create",visible:!1,submitting:!1}),A=(0,o.useReducer)(function(d){return d+1},0),n=C()(A,2),h=n[1],N=(0,T.xL)(),M=C()(N,1),t=M[0],L=(0,T.bR)(),B=C()(L,1),ae=B[0],x=(0,T.U1)(),U=C()(x,1),re=U[0],F=(0,o.useCallback)(function(d){y.current.visible=d,h()},[]),b=(0,o.useCallback)(function(){y.current.mode="create",f.resetFields(),F(!0)},[]),u=(0,o.useCallback)(function(d){y.current.mode="update",f.setFieldsValue({name:d.name,duration:d.duration}),F(!0)},[]),W=(0,H.Z)({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(p){return(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:p.name}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]})}},function(){var d=D()(m()().mark(function p(K){return m()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,re({variables:{where:{id_in:K==null?void 0:K.ids}}});case 2:i();case 3:case"end":return P.stop()}},p)}));return function(p){return d.apply(this,arguments)}}()),_=C()(W,1),ne=_[0],se=(0,o.useCallback)(function(d){return function(p){p.key==="edit"?u(d):p.key==="delete"&&ne({name:d.name,ids:[d.id]})}},[ne]),le=(0,o.useCallback)(function(d){return function(){ne({name:"\u9009\u4E2D\u7684\u62A5\u4FEE\u7B56\u7565",ids:d})}},[]),ue=(0,o.useCallback)(D()(m()().mark(function d(){var p,K;return m()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,f.validateFields();case 2:if(p=P.sent,y.current.mode!=="create"){P.next=11;break}return P.next=6,t({variables:{input:S()({productId:E},p)}});case 6:a.Toast.success("\u65B0\u5EFA\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),i(),F(!1),P.next=16;break;case 11:return P.next=13,ae({variables:{id:(K=y.current.data)===null||K===void 0?void 0:K.id,input:p}});case 13:a.Toast.success("\u7F16\u8F91\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),i(),F(!1);case 16:case"end":return P.stop()}},d)})),[i]),ie=y.current.submitting,oe=y.current.visible,de=y.current.mode;return(0,e.jsxs)("div",{children:[(0,e.jsxs)(a.Modal,{width:640,centered:!0,onOk:ue,confirmLoading:ie,okText:"\u4FDD\u5B58",visible:oe,onCancel:function(){return F(!1)},children:[(0,e.jsx)(a.Modal.Header,{closable:!0,className:"ms-5 border-0",children:(0,e.jsx)("h1",{className:"modal-title pt-6 pb-4",children:de?"\u65B0\u5EFA\u62A5\u4FEE\u7B56\u7565":"\u7F16\u8F91\u62A5\u4FEE\u7B56\u7565"})}),(0,e.jsx)(a.Modal.Body,{children:(0,e.jsxs)(a.Form,{form:f,children:[(0,e.jsx)(a.Form.Item,{className:"d-flex flex-column mb-7",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}],children:(0,e.jsx)(a.Input,{solid:!0})}),(0,e.jsx)(a.Form.Item,{className:"d-flex flex-column mb-7",name:"duration",label:"\u4FDD\u4FEE\u65F6\u957F",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4FDD\u4FEE\u65F6\u957F"},{pattern:/^[1-9]\d*$/,message:"\u8BF7\u8F93\u5165\u6B63\u6574\u6570"}],help:"\u4FDD\u4FEE\u65F6\u957F\u5355\u4F4D\u4E3A\u6708",children:(0,e.jsx)(a.Input,{solid:!0})})]})})]}),(0,e.jsxs)("div",{className:"mt-5 card-header",children:[(0,e.jsx)("div",{className:"card-title flex-column"}),(0,e.jsx)("div",{className:"card-toolbar",children:(0,e.jsx)("div",{className:"d-flex justify-content-end",children:(0,e.jsx)(a.Button,{variant:"primary",className:"me-3",icon:(0,e.jsx)(V.ZP,{className:"svg-icon-2",name:"Duotune/arr075"}),onClick:b,children:"\u65B0\u5EFA\u62A5\u4FEE\u7B56\u7565"})})})]}),(0,e.jsx)(a.Table,{hover:!0,rowKey:"id",rowSelection:{type:"checkbox",renderTitle:function(p){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:p}),"\u4E2A\u4EA7\u54C1"]})},toolbar:function(p){return(0,e.jsx)("div",{children:(0,e.jsx)(a.Button,{color:"success",onClick:le(p),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},noRowsRenderer:function(){return(0,e.jsx)(a.Empty,{description:"\u62A5\u4FEE\u7B56\u7565\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},columns:[{key:"name",title:"\u4FDD\u4FEE\u7B56\u7565\u540D\u79F0"},{key:"duration",title:"\u4FDD\u4FEE\u65F6\u957F",width:180,render:function(p){return"".concat(p,"\u6708")}},{key:"createdAt",title:"\u521B\u5EFA\u65F6\u95F4",width:180},{title:"\u64CD\u4F5C",key:"action",width:140,render:function(p,K){return(0,e.jsx)("div",{children:(0,e.jsx)(a.Dropdown,{overlay:(0,e.jsxs)(a.Menu,{onClick:se(K),className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold w-125px py-4",children:[(0,e.jsx)(a.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"edit"),(0,e.jsx)(a.Menu.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",children:(0,e.jsxs)(a.Button,{variant:"light",activeColor:"light-primary",children:["\u64CD \u4F5C",(0,e.jsx)(V.ZP,{className:"ms-2 svg-icon-5 m-0",name:"Duotune/arr072"})]})})})}}],dataSource:v})]})}var Q=j;function Z(){var c=(0,w.UO)(),E=a.Form.useForm(),I=(0,T.ac)({variables:{pageSize:1e3},fetchPolicy:"network-only"}),v=I.data,i=(0,T.FA)({variables:{id:c.id}}),f=i.loading,y=i.data,A=i.refetch,n=(0,T.wE)(),h=C()(n,1),N=h[0],M=v==null?void 0:v.result.edges.map(function(x){return x.node}),t=y==null?void 0:y.result,L=t==null?void 0:t.warrantyPolicies,B={knowledgebase:t==null?void 0:t.knowledgebase,videos:t==null?void 0:t.videos,tutorials:t==null?void 0:t.tutorials,notebook:t==null?void 0:t.notebook};(0,o.useEffect)(function(){var x;t&&E.setFieldsValue({brandId:t==null||(x=t.brand)===null||x===void 0?void 0:x.id,name:t.name,images:t.images})},[t]);var ae=(0,o.useCallback)(D()(m()().mark(function x(){var U;return m()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,E.validateFields();case 2:return U=F.sent,console.log("values",U),U.images=U.images.map(function(b){var u=S()({},b);return u.hasOwnProperty("__typename")&&delete u.__typename,u.data_state==="new"&&delete u.id,delete u.data_state,u.hasOwnProperty("image")&&u.image&&(G()(u.image)==="object"&&(u.image=u.image.id),delete u.url),u}),F.next=7,N({variables:{id:c.id,input:U}});case 7:a.Toast.success("\u4FDD\u5B58\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),A();case 9:case"end":return F.stop()}},x)})),[t,A]);return(0,e.jsx)(O.vs,{loading:f,header:{title:"\u7F16\u8F91\u4EA7\u54C1"},children:(0,e.jsxs)(a.Card,{className:"mb-5 mb-xl-10",children:[(0,e.jsx)(a.Card.Header,{title:"\u4EA7\u54C1\u4FE1\u606F"}),(0,e.jsx)(a.Card.Body,{children:(0,e.jsx)(a.BlockUI,{overlayClassName:"bg-white bg-opacity-25",loading:f,children:(0,e.jsxs)(a.Tabs,{type:"line-tabs",defaultActiveKey:"general",contentContainer:!1,className:"border-0 fs-4 fw-bold mb-n2 nav-line-tabs-2x",children:[(0,e.jsx)(a.Tabs.TabPane,{tab:"\u57FA\u672C\u4FE1\u606F",forceRender:!0,children:(0,e.jsx)("div",{className:"py-4",children:(0,e.jsxs)(a.Form,{form:E,className:"form d-flex flex-column",children:[(0,e.jsxs)(a.Row,{className:"mt-5",children:[(0,e.jsxs)(a.Col,{span:6,children:[(0,e.jsx)(a.Form.Item,{className:"mb-5",name:"brandId",label:"\u54C1\u724C",rules:[{required:!0,message:"\u54C1\u724C\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(a.Select,{className:"w-400px",options:(M==null?void 0:M.map(function(x){return{label:x.name,value:x.id}}))||[]})}),(0,e.jsx)(a.Form.Item,{className:"mb-5",name:"name",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,e.jsx)(a.Input,{solid:!0,className:"w-400px"})})]}),(0,e.jsx)(a.Col,{span:6,children:(0,e.jsx)(a.Form.Item,{className:"mb-5",name:"images",label:"\u4EA7\u54C1\u56FE\u7247",noStyle:!0,children:(0,e.jsx)(k.Z,{})})})]}),(0,e.jsx)(a.Button,{className:"w-100px",onClick:ae,children:"\u4FDD\u5B58"})]})})},"general"),(0,e.jsx)(a.Tabs.TabPane,{tab:"\u4FDD\u4FEE\u7B56\u7565",children:(0,e.jsx)("div",{className:"py-4",children:(0,e.jsx)(Q,{productId:c.id,warrantyPolicies:L,refetch:A})})},"bx"),(0,e.jsx)(a.Tabs.TabPane,{tab:"\u7EF4\u62A4\u89C6\u9891",children:(0,e.jsx)("div",{className:"py-4",children:(0,e.jsx)(l,{productId:c.id,refetch:A,categoryId:"product-maintenance-video",articles:B.videos})})},"product-maintenance-video"),(0,e.jsx)(a.Tabs.TabPane,{tab:"\u77E5\u8BC6\u5E93",children:(0,e.jsx)("div",{className:"py-4",children:(0,e.jsx)(l,{productId:c.id,refetch:A,categoryId:"product-knowledge-base",articles:B.knowledgebase})})},"product-knowledge-base"),(0,e.jsx)(a.Tabs.TabPane,{tab:"\u4EA7\u54C1\u624B\u518C",children:(0,e.jsx)("div",{className:"py-4",children:(0,e.jsx)(l,{productId:c.id,refetch:A,categoryId:"product-manual",articles:B.notebook})})},"product-manual"),(0,e.jsx)(a.Tabs.TabPane,{tab:"\u7EF4\u62A4\u624B\u518C",children:(0,e.jsx)("div",{className:"py-4",children:(0,e.jsx)(l,{productId:c.id,refetch:A,categoryId:"product-maintenance-manual",articles:B.tutorials})})},"product-maintenance-manual")]})})})]})})}var ee=Z}}]);
