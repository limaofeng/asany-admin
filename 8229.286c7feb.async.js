"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8229],{96708:function(G,I,n){var T=n(46027),i=n(84048),P=n(85893);function y(B){var b=B.layout,D=B.children,A=B.onLayout;return(0,P.jsxs)("div",{className:"d-flex flex-wrap my-1",children:[b&&(0,P.jsxs)("ul",{className:"nav nav-pills me-6 mb-2 mb-sm-0",children:[(0,P.jsx)("li",{className:"nav-item m-0 me-3",children:(0,P.jsx)(i.Z,{variant:"light",color:"muted",active:b==="card",activeColor:"primary",onClick:A==null?void 0:A.bind(null,"card"),icon:(0,P.jsx)(T.ZP,{name:"Duotune/gen024",className:"svg-icon-1"})})}),(0,P.jsx)("li",{className:"nav-item m-0",children:(0,P.jsx)(i.Z,{variant:"light",color:"muted",active:b==="table",onClick:A==null?void 0:A.bind(null,"table"),activeColor:"primary",className:"me-3",icon:(0,P.jsx)(T.ZP,{name:"Duotune/abs015",className:"svg-icon-1"})})})]}),D]})}I.Z=y},14336:function(G,I,n){var T=n(15009),i=n.n(T),P=n(99289),y=n.n(P),B=n(97857),b=n.n(B),D=n(5574),A=n.n(D),f=n(67294),v=n(89717),p=n(12708);function t(r,a){return r.replace(/{(\w+)}/g,function(l,M){return a[M]!==void 0?a[M]:l})}function s(r,a){var l=r(b()({fetchPolicy:"network-only"},(a==null?void 0:a.mutation)||{})),M=A()(l,1),e=M[0],x=(0,f.useRef)(!1),U=(0,f.useRef)(null),w=(0,f.useCallback)(function(){var h=y()(i()().mark(function c(d,u){var o,L,S,O,m,j,F,$,Q;return i()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return o=(u==null?void 0:u.dialog)||(a==null?void 0:a.dialog)||{},L=(u==null?void 0:u.mutation)||(a==null?void 0:a.mutation)||{},S=(u==null?void 0:u.onDeleted)||(a==null?void 0:a.onDeleted),O=o.width,m=o.title,j=o.content,F=!1,Array.isArray(d)?(F=!0,typeof m=="function"&&(m=m(d,{batch:!0})),typeof j=="function"&&(j=j(d,{batch:!0}))):d&&(typeof m=="string"&&(m=t(m,d)),typeof j=="string"&&(j=t(j,d)),typeof m=="function"&&(m=m(d,{batch:!1})),typeof j=="function"&&(j=j(d,{batch:!1}))),$=function(){var z=y()(i()().mark(function Z(){return i()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,e(b()(b()({fetchPolicy:"network-only"},L),{},{variables:{where:{id_in:F?d:[d==null?void 0:d.id]}}}));case 2:case"end":return N.stop()}},Z)}));return function(){return z.apply(this,arguments)}}(),_.next=10,v.Modal.confirm(b()(b()({},o),{},{title:m,content:j,width:O,okText:"\u5220 \u9664",okClassName:"btn-danger",allowOutsideClick:function(){return!x.current},preConfirm:function(){var z=y()(i()().mark(function q(){var N,V,H;return i()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return x.current=!0,U.current=null,C.prev=2,N=document.querySelector(".swal2-confirm"),N.textContent="\u5220\u9664\u4E2D...",V=document.createElement("span"),V.classList.add("spinner-border-sm","ms-2","spinner-border","align-middle"),N.appendChild(V),C.next=10,(0,p.gw)($(),350);case 10:H=C.sent,S&&S(d,H),C.next=17;break;case 14:C.prev=14,C.t0=C.catch(2),U.current=C.t0;case 17:return C.prev=17,x.current=!1,C.finish(17);case 20:case"end":return C.stop()}},q,null,[[2,14,17,20]])}));function Z(){return z.apply(this,arguments)}return Z}()}));case 10:if(Q=_.sent,!U.current){_.next=14;break}return v.Toast.error("\u5220\u9664\u5931\u8D25:"+U.current.message,2e3,{placement:"top-center",progressBar:!0}),_.abrupt("return",!1);case 14:if(Q.isConfirmed){_.next=16;break}return _.abrupt("return",!1);case 16:return v.Toast.success("\u5220\u9664\u6210\u529F",2e3,{placement:"top-center",progressBar:!0}),_.abrupt("return",!0);case 18:case"end":return _.stop()}},c)}));return function(c,d){return h.apply(this,arguments)}}(),[]),Y=(0,f.useCallback)(function(h,c){return w(h,c)},[a,e]),J=(0,f.useCallback)(function(h,c){return w(h,c)},[]);return{delete:Y,deleteMany:J}}I.Z=s},58301:function(G,I,n){n.d(I,{Oh:function(){return D},bp:function(){return A}});var T=n(97857),i=n.n(T),P=n(67294);function y(f,v){var p,t,s=f(i()({fetchPolicy:"network-only"},v)),r=s.data,a=s.loading,l=s.previousData,M=s.refetch,e=s.error,x=(0,P.useMemo)(function(){return a?l==null?void 0:l.result.pageInfo:r==null?void 0:r.result.pageInfo},[r==null||(p=r.result)===null||p===void 0?void 0:p.pageInfo.total,a,l==null||(t=l.result)===null||t===void 0?void 0:t.pageInfo.total]),U=(0,P.useMemo)(function(){return r!=null&&r.result?r.result.edges.map(function(w){return w.node}):a&&l!==null&&l!==void 0&&l.result?l.result.edges.map(function(w){return w.node}):[]},[a,r==null?void 0:r.result,l==null?void 0:l.result]);return[U,{loading:a,pageInfo:x,error:e,variables:{},refetch:M}]}function B(f,v){return v.split(".").reduce(function(p,t){return p&&p[t]!==void 0?p[t]:void 0},f)}function b(f,v,p){for(var t=v.split("."),s=f;t.length>1;){var r=t.shift();s[r]||(s[r]={}),s=s[r]}s[t[0]]=p}function D(f,v){var p=v.map(function(t){var s=t.source,r=t.target,a=t.transform,l=t.skip,M=B(f,s);if(M==null||l&&l(M))return"";var e=a?a(M):String(M);return"".concat(encodeURIComponent(r||s),"=").concat(encodeURIComponent(e))});return p.filter(function(t){return t}).join("&")}function A(f,v){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=p;return v.forEach(function(s){var r=s.source,a=s.target,l=s.transform,M=s.skip,e=f.get(r);if(!(!e||e.trim()==="")){var x=l?l(e):e;M&&M(x)||(a?b(t,a,x):t[r]=x)}}),t}I.ZP=y},54278:function(G,I,n){n.d(I,{Nk:function(){return d},SP:function(){return l},sW:function(){return U}});var T=n(97857),i=n.n(T),P=n(68400),y=n.n(P),B=n(75063),b=n(37887),D=n(50319),A,f,v,p,t,s={},r=(0,B.Ps)(A||(A=y()([`
    fragment ProcessModelPart on ProcessModel {
  id
  key
  name
  description
  version
  createdBy
  created
  lastUpdated
  lastUpdatedBy
}
    `]))),a=(0,B.Ps)(f||(f=y()([`
    query processModels($where: ProcessModelWhereInput, $page: Int, $pageSize: Int, $orderBy: OrderBy) {
  result: processModels(
    where: $where
    page: $page
    pageSize: $pageSize
    orderBy: $orderBy
  ) {
    pageInfo {
      total
      totalPages
      current
      pageSize
    }
    edges {
      cursor
      node {
        ...ProcessModelPart
      }
    }
  }
}
    `,""])),r);function l(u){var o=i()(i()({},s),u);return b.a(a,o)}function M(u){var o=_objectSpread(_objectSpread({},s),u);return Apollo.useLazyQuery(a,o)}function e(u){var o=_objectSpread(_objectSpread({},s),u);return Apollo.useSuspenseQuery(a,o)}var x=(0,B.Ps)(v||(v=y()([`
    query processModel($id: ID!) {
  processModel(id: $id) {
    ...ProcessModelPart
    editorJson
  }
}
    `,""])),r);function U(u){var o=i()(i()({},s),u);return b.a(x,o)}function w(u){var o=_objectSpread(_objectSpread({},s),u);return Apollo.useLazyQuery(x,o)}function Y(u){var o=_objectSpread(_objectSpread({},s),u);return Apollo.useSuspenseQuery(x,o)}var J=(0,B.Ps)(p||(p=y()([`
    mutation importProcessModel($file: Upload!) {
  importProcessModel(file: $file) {
    ...ProcessModelPart
  }
}
    `,""])),r);function h(u){var o=_objectSpread(_objectSpread({},s),u);return Apollo.useMutation(J,o)}var c=(0,B.Ps)(t||(t=y()([`
    mutation deleteProcessModel($id: ID!) {
  deleteProcessModel(id: $id)
}
    `])));function d(u){var o=i()(i()({},s),u);return D.D(c,o)}},36473:function(G,I,n){n.d(I,{SP:function(){return T.SP},sW:function(){return T.sW}});var T=n(54278)},88229:function(G,I,n){n.r(I),n.d(I,{default:function(){return J}});var T=n(5574),i=n.n(T),P=n(15009),y=n.n(P),B=n(99289),b=n.n(B),D=n(67294),A=n(39711),f=n(46027),v=n(12845),p=n(96708),t=n(58301),s=n(73588),r=n(89717),a=n(36473),l=n(14336),M=n(54278),e=n(85893);function x(h){var c=(0,l.Z)(M.Nk,{onDeleted:function(){h&&h()},dialog:{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",content:function(L,S){var O;if(S.batch){var m=L;O="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(m.length," \u4E2A\u5BA2\u6237\u5417\uFF1F")}else O=(0,e.jsxs)(e.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,e.jsx)("strong",{children:L.name})]});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:O}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]})}}}),d=c.delete,u=c.deleteMany;return{delete:d,deleteMany:u}}var U=x;function w(h){var c=h.data,d=h.navigate,u=h.onDelete,o=h.onDesign,L=h.baseUrl,S=(0,D.useCallback)(function(){var m=b()(y()().mark(function j(F){var $,Q;return y()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return $="\u786E\u5B9A\u5220\u9664\u6D3B\u52A8 \u201C".concat(F.name,"\u201D \u5417\uFF1F"),_.next=3,r.Modal.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:$}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(Q=_.sent,Q.isConfirmed){_.next=6;break}return _.abrupt("return");case 6:return _.next=8,u(F);case 8:r.Toast.success("\u6D3B\u52A8 \u201C".concat(F.name,"\u201D \u5220\u9664\u6210\u529F"),2e3,{placement:"bottom-left",progressBar:!0});case 9:case"end":return _.stop()}},j)}));return function(j){return m.apply(this,arguments)}}(),[u]),O=(0,D.useCallback)(function(m){m.key==="view"?d("".concat(L,"/").concat(c.id)):m.key==="delete"?S(c):m.key==="design"&&o(c.id)},[L,c,S,history,o]);return(0,e.jsx)(r.Dropdown,{overlay:(0,e.jsxs)(r.Menu,{onClick:O,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold fs-8 w-125px py-4",children:[(0,e.jsx)(r.Menu.Item,{className:"px-3",children:"\u7F16\u8F91"},"view"),(0,e.jsx)(r.Menu.Separator,{className:"my-1"}),(0,e.jsx)(r.Menu.Item,{className:"px-3",children:"\u8BBE\u8BA1"},"design"),(0,e.jsx)(r.Menu.Separator,{className:"my-1"}),(0,e.jsx)(r.Menu.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",children:(0,e.jsxs)(r.Button,{className:"fs-8",variant:"light",activeColor:"light-primary",children:["\u64CD\u4F5C",(0,e.jsx)(f.JO,{className:"svg-icon-5 ms-2 me-n1",name:"Duotune/arr072"})]})})}function Y(){var h,c=(0,v.useNavigate)(),d=(0,A.lr)(),u=i()(d,1),o=u[0],L=location.pathname,S=(0,D.useMemo)(function(){return(0,t.bp)(o,[{source:"q",target:"keywords"}])},[o.get("q")]),O=(0,D.useMemo)(function(){return(0,t.bp)(o,[{source:"q",target:"where.name_contains"},{source:"sex",target:"where.sex"},{source:"page",transform:function(E){return parseInt(E)}},{source:"per_page",transform:function(E){return parseInt(E)}},{source:"sort",target:"orderBy",transform:function(E){var R=E.split(":"),k=i()(R,2),X=k[0],K=k[1];return"".concat(X,"_").concat(K)}}])},[o.toString()]),m=(0,t.ZP)(a.SP,{variables:O}),j=i()(m,2),F=j[0],$=j[1],Q=$.loading,W=$.pageInfo,_=$.refetch,z=(0,D.useCallback)(function(g){c("/workflow/models/".concat(g,"/design"))},[history]),Z=(0,D.useMemo)(function(){if(!O.orderBy)return{order:"descend",field:"createdAt"};var g=O.orderBy.split("_"),E=i()(g,2),R=E[0],k=E[1];return{order:k==="desc"?"descend":"ascend",field:R}},[O.orderBy]),q=(0,D.useCallback)(function(g,E,R){var k=(0,t.Oh)({searchForm:S,pagination:g,filters:E,sorter:R},[{source:"searchForm.keywords",target:"q",skip:function(K){return!K}},{source:"pagination.current",target:"page",skip:function(K){return K===1}},{source:"pagination.pageSize",target:"per_page",skip:function(K){return K===15}},{source:"sorter.field",target:"sort",transform:function(K){return"".concat(K,":").concat(R.order==="ascend"?"asc":"desc")}}]);c(location.pathname+"?"+k,{replace:!0})},[S]),N=(0,D.useCallback)(function(g){c(location.pathname+(g?"?q="+g:""),{replace:!0})},[]),V=U(_),H=V.deleteMany,ee=V.delete,C=(0,D.useCallback)(function(g){return b()(y()().mark(function E(){return y()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,H(g);case 2:case"end":return k.stop()}},E)}))},[H]),ne=(0,D.useMemo)(function(){return function(g){return(0,e.jsx)("div",{children:(0,e.jsx)(r.Button,{color:"success",onClick:C(g),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},[C]);return(0,e.jsxs)(s.vs,{loading:Q,footer:!1,children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap flex-stack pb-7",children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,e.jsxs)("h3",{className:"fw-bolder me-5",children:["\u6D41\u7A0B\u6A21\u578B (",W==null?void 0:W.total,")"]}),(0,e.jsx)(r.Input.Search,{onSearch:N,defaultValue:(h=O.filter)===null||h===void 0?void 0:h.name_contains,placeholder:"\u641C\u7D22",className:"border-body bg-body w-250px"})]}),(0,e.jsx)(p.Z,{children:(0,e.jsx)("div",{className:"d-flex my-0"})})]}),!(W!=null&&W.total)&&!Q?(0,e.jsx)(r.Card,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(r.Empty,{title:"\u8FD8\u6CA1\u6709\u6D3B\u52A8",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u6D3B\u52A8\u8BD5\u8BD5",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(r.Button,{as:v.Link,variant:"primary",to:"${baseUrl}/new",children:"\u65B0\u5EFA\u6D41\u7A0B\u6A21\u578B"})})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(r.Card,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(r.Card.Body,{children:(0,e.jsx)(r.Table,{hover:!0,rowKey:"id",noRowsRenderer:function(){return(0,e.jsx)(r.Empty,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},rowSelection:{type:"checkbox",renderTitle:function(E){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:E}),"\u4E2A\u6D3B\u52A8"]})},toolbar:ne},columns:[{key:"name",title:"\u540D\u79F0",sorter:!0,sortOrder:Z.field==="name"?Z.order:void 0,render:function(E,R){return(0,e.jsx)("div",{className:"ps-2",children:(0,e.jsx)(v.Link,{className:"text-gray-700",to:"".concat(L,"/").concat(R.id),children:E})})}},{key:"actions",title:"\u64CD\u4F5C",width:100,render:function(E,R){return(0,e.jsx)(w,{baseUrl:L,onDelete:ee,onDesign:z,navigate:c,data:R})}}],pagination:W,onChange:q,dataSource:F})})})})]})}var J=Y}}]);
