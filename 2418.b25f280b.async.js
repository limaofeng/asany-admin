(self.webpackChunkasany_admin=self.webpackChunkasany_admin||[]).push([[2418],{50480:function(z,M,l){"use strict";var O=l(28865),N=l(51248),c=l(85893);function f(y){var u=y.layout,F=y.children,g=y.onLayout;return(0,c.jsxs)("div",{className:"d-flex flex-wrap my-1",children:[u&&(0,c.jsxs)("ul",{className:"nav nav-pills me-6 mb-2 mb-sm-0",children:[(0,c.jsx)("li",{className:"nav-item m-0 me-3",children:(0,c.jsx)(N.Z,{variant:"light",color:"muted",active:u=="card",activeColor:"primary",onClick:g==null?void 0:g.bind(null,"card"),icon:(0,c.jsx)(O.ZP,{name:"Duotune/gen024",className:"svg-icon-1"})})}),(0,c.jsx)("li",{className:"nav-item m-0",children:(0,c.jsx)(N.Z,{variant:"light",color:"muted",active:u=="table",onClick:g==null?void 0:g.bind(null,"table"),activeColor:"primary",className:"me-3",icon:(0,c.jsx)(O.ZP,{name:"Duotune/abs015",className:"svg-icon-1"})})})]}),F]})}M.Z=f},92418:function(z,M,l){"use strict";l.r(M);var O=l(86582),N=l(93224),c=l(2824),f=l(39428),y=l(3182),u=l(67294),F=l(28865),g=l(84059),H=l(80129),Z=l.n(H),W=l(73727),L=l(250),J=l(50480),Y=l(18071),s=l(17818),e=l(85893),G=["q"];function V(_){var C=_.data,b=_.history,D=_.onDelete,x=_.onShowQRCode,P=_.baseUrl,w=(0,u.useCallback)(function(){var v=(0,y.Z)((0,f.Z)().mark(function B(A){var R,m;return(0,f.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return R="\u786E\u5B9A\u5220\u9664\u6D3B\u52A8 \u201C".concat(A.name,"\u201D \u5417\uFF1F"),h.next=3,s.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:R}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(m=h.sent,m.isConfirmed){h.next=6;break}return h.abrupt("return");case 6:return h.next=8,D(A.id);case 8:s.FN.success("\u6D3B\u52A8 \u201C".concat(A.name,"\u201D \u5220\u9664\u6210\u529F"),2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return h.stop()}},B)}));return function(B){return v.apply(this,arguments)}}(),[D]),k=(0,u.useCallback)(function(v){v.key=="view"?b.push("".concat(P,"/").concat(C.id)):v.key=="delete"?w(C):v.key=="preview"&&x(location.protocol+"http://wap.asany.cn/lps/"+C.id)},[P,C,w,b,x]);return(0,e.jsx)(s.Lt,{overlay:(0,e.jsxs)(s.v2,{onClick:k,className:"menu-sub menu-sub-dropdown menu-gray-600 menu-state-bg-light-primary fw-bold fs-8 w-125px py-4",children:[(0,e.jsx)(s.v2.Item,{className:"px-3",children:"\u7F16\u8F91"},"view"),(0,e.jsx)(s.v2.Separator,{className:"my-1"}),(0,e.jsx)(s.v2.Item,{className:"px-3",children:"\u9884\u89C8"},"preview"),(0,e.jsx)(s.v2.Separator,{className:"my-1"}),(0,e.jsx)(s.v2.Item,{className:"px-3 actions-delete",children:"\u5220\u9664"},"delete")]}),placement:"bottomRight",children:(0,e.jsxs)(s.zx,{className:"fs-8",variant:"light",activeColor:"light-primary",children:["\u64CD\u4F5C",(0,e.jsx)(F.JO,{className:"svg-icon-5 ms-2 me-n1",name:"Duotune/arr072"})]})})}function X(_){var C,b,D=_.history,x=_.location,P=x.pathname,w=(0,u.useState)(),k=(0,c.Z)(w,2),v=k[0],B=k[1],A=(0,u.useCallback)(function(n){B(n)},[]),R=(0,u.useCallback)(function(){B(void 0)},[]),m=(0,u.useMemo)(function(){var n=_.location.query,a=n.q,r=(0,N.Z)(n,G);return a&&(r.filter={name_contains:a}),r},[_.location]),T=(0,u.useMemo)(function(){if(!m.orderBy)return{order:"descend",field:"createdAt"};var n=m.orderBy.split("_"),a=(0,c.Z)(n,2),r=a[0],d=a[1];return{order:d=="desc"?"descend":"ascend",field:r}},[m.orderBy]),h=(0,L.hD)({refetchQueries:[L.MZ]}),q=(0,c.Z)(h,1),K=q[0],I=(0,L.gr)({fetchPolicy:"cache-and-network",variables:m}),i=I.data,E=I.loading,t=I.previousData,S=(0,u.useMemo)(function(){return E?(t==null?void 0:t.total.totalCount)||0:(i==null?void 0:i.total.totalCount)||0},[i==null?void 0:i.total.totalCount,E,t==null?void 0:t.total]),ee=(0,u.useMemo)(function(){return E?(t==null?void 0:t.landingPages)||{total:0,current:1}:(i==null?void 0:i.landingPages)||{total:0,current:1}},[i==null?void 0:i.landingPages,E,t==null?void 0:t.landingPages]),ae=(0,u.useMemo)(function(){var n;if(E){var a;return((t==null||(a=t.landingPages)===null||a===void 0?void 0:a.edges)||[]).map(function(r){return r.node})}return((i==null||(n=i.landingPages)===null||n===void 0?void 0:n.edges)||[]).map(function(r){return r.node})},[i==null?void 0:i.landingPages,E,t==null?void 0:t.landingPages]),ne=(0,u.useCallback)(function(n){D.replace(x.pathname+"?"+Z().stringify({q:n}))},[D,x.pathname]),re=(0,u.useCallback)(function(n,a,r){var d,p={};if((d=m.filter)!==null&&d!==void 0&&d.name_contains){var o;p.q=(o=m.filter)===null||o===void 0?void 0:o.name_contains}r&&(p.orderBy=r.field+"_"+(r.order=="ascend"?"asc":"desc")),p.page=n.current,D.replace(x.pathname+"?"+Z().stringify(p))},[D,x.pathname,(C=m.filter)===null||C===void 0?void 0:C.name_contains]),U=(0,u.useCallback)((0,y.Z)((0,f.Z)().mark(function n(){var a,r,d,p,o,$=arguments;return(0,f.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:for(a=$.length,r=new Array(a),d=0;d<a;d++)r[d]=$[d];return j.next=3,K({variables:{ids:r}});case 3:return p=j.sent,o=p.data,j.abrupt("return",(o==null?void 0:o.deleteLandingPage)||0);case 6:case"end":return j.stop()}},n)})),[K]),Q=(0,u.useCallback)(function(n){return(0,y.Z)((0,f.Z)().mark(function a(){var r,d;return(0,f.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return r="\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684, \u5171 ".concat(n.length," \u4E2A\u6D3B\u52A8\u5417\uFF1F"),o.next=3,s.u_.confirm({title:"\u786E\u5B9A\u5220\u9664",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"tip-confirm",children:r}),(0,e.jsx)("p",{children:"\u5220\u9664\u7684\u64CD\u4F5C\u4E0D\u53EF\u9006,\u8BF7\u8C28\u614E\u64CD\u4F5C"})]}),okClassName:"btn-danger",okText:"\u5220\u9664"});case 3:if(d=o.sent,d.isConfirmed){o.next=6;break}return o.abrupt("return");case 6:return o.next=8,U.apply(void 0,(0,O.Z)(n));case 8:s.FN.success("\u6D3B\u52A8\u6279\u91CF\u5220\u9664\u6210\u529F",2e3,{placement:"bottom-start",progressBar:!0});case 9:case"end":return o.stop()}},a)}))},[U]),se=(0,u.useMemo)(function(){return function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(s.zx,{color:"success",onClick:Q(n),variant:!1,children:"\u6279\u91CF\u5220\u9664"})})}},[Q]);return console.log("qrCode",v,m),(0,e.jsxs)(Y.vs,{footer:!1,children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap flex-stack pb-7",children:[(0,e.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,e.jsxs)("h3",{className:"fw-bolder me-5",children:["\u6D3B\u52A8 (",S,")"]}),(0,e.jsx)(s.II.Search,{onSearch:ne,defaultValue:(b=m.filter)===null||b===void 0?void 0:b.name_contains,placeholder:"\u641C\u7D22",className:"border-body bg-body w-250px"})]}),(0,e.jsx)(J.Z,{children:(0,e.jsx)("div",{className:"d-flex my-0"})})]}),!S&&!E?(0,e.jsx)(s.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(s.HY,{title:"\u8FD8\u6CA1\u6709\u6D3B\u52A8",description:"\u9A6C\u4E0A\u6DFB\u52A0\u4E00\u4E2A\u6D3B\u52A8\u8BD5\u8BD5",image:"/assets/media/illustrations/sigma-1/4.png",children:(0,e.jsx)(s.zx,{as:W.Link,variant:"primary",to:"${baseUrl}/new",children:"\u65B0\u5EFA\u6D3B\u52A8"})})}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.Zb,{className:"mb-5 mb-xl-10",children:(0,e.jsx)(s.Zb.Body,{children:(0,e.jsx)(s.bH,{overlayClassName:"bg-white bg-opacity-25",loading:E,children:(0,e.jsx)(s.iA,{hover:!0,rowKey:"id",noRowsRenderer:function(){return(0,e.jsx)(s.HY,{description:"\u5217\u8868\u6570\u636E\u4E3A\u7A7A",image:"/assets/media/illustrations/sigma-1/5.png"})},rowSelection:{type:"checkbox",renderTitle:function(a){return(0,e.jsxs)(e.Fragment,{children:["\u5DF2\u9009\u4E2D",(0,e.jsx)("span",{className:"mx-2",children:a}),"\u4E2A\u6D3B\u52A8"]})},toolbar:se},columns:[{key:"name",title:"\u540D\u79F0",sorter:!0,sortOrder:T.field=="name"?T.order:void 0,render:function(a,r){return(0,e.jsx)("div",{className:"ps-2",children:(0,e.jsx)(W.Link,{className:"text-gray-700",to:"".concat(P,"/").concat(r.id),children:a})})}},{key:"stores",title:"\u95E8\u5E97",render:function(a){return(0,e.jsxs)("div",{className:"d-flex tw-truncate overflow-hidden pe-2",children:[(0,e.jsx)("span",{className:"tw-text-ellipsis tw-truncate overflow-hidden",children:a.map(function(r){return r.name}).join(",")}),(0,e.jsxs)("span",{children:["\u5171 ",a.length," \u5BB6\u95E8\u5E97"]})]})}},{key:"poster",title:"\u6D77\u62A5",width:80,render:function(a){return a!=null&&a.background?(0,e.jsx)("div",{className:"d-flex w-30px justify-content-center",children:(0,e.jsx)("img",{src:"https://api.asany.cn/graphql"+"/preview/".concat(a.background.id),className:"h-30px w-20px"})}):(0,e.jsx)(F.JO,{className:"svg-icon-2qx text-muted",name:"Bootstrap/file-image"})}},{key:"actions",title:"\u64CD\u4F5C",width:100,render:function(a,r){return(0,e.jsx)(V,{baseUrl:P,onDelete:U,onShowQRCode:A,history:_.history,data:r})}}],pagination:ee,onChange:re,dataSource:ae})})})}),(0,e.jsxs)(s.u_,{title:"\u9884\u89C8\u4E8C\u7EF4\u7801",dialogClassName:"w-250px",onCancel:R,visible:!!v,okButtonProps:{style:{display:"none"}},children:[(0,e.jsx)("div",{className:"d-inline-block",children:!!v&&(0,e.jsx)(g.Qd,{size:200,value:v})}),(0,e.jsx)("span",{children:"\u4F7F\u7528\u624B\u673A\u626B\u7801\u4E8C\u7EF4\u7801\u9884\u89C8"})]})]})]})}M.default=X}}]);
