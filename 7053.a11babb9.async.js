"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7053],{27053:function(K,j,n){n.r(j);var a=n(97857),g=n.n(a),m=n(5574),A=n.n(m),M=n(15009),T=n.n(M),C=n(99289),y=n.n(C),c=n(67294),i=n(35090),B=n(12845),L=n(89717),F=n(85947),D=n(85893);function O(f){var e=f.data,s=f.loading,u=f.save,d=(0,c.useCallback)(function(){B.history.goBack()},[]),_=(0,c.useCallback)(function(){var p=y()(T()().mark(function h(v){var l,t;return T()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return l=v.template,t=v.blocks,E.next=3,u({variables:{id:v.id,input:{template:l,blocks:t}}});case 3:L.Toast.success("\u4FDD\u5B58\u6210\u529F");case 4:case"end":return E.stop()}},h)}));return function(h){return p.apply(this,arguments)}}(),[u]),o={id:e.id,template:e.template,blocks:e.blocks};return(0,D.jsx)(i.I$,{id:e.id,name:(e==null?void 0:e.name)||"",onSave:_,onBack:d,loading:s,viewport:{size:[1280,2160]},data:o})}function I(f){var e=f.match.params.id,s=(0,F.bo)({variables:{id:e},fetchPolicy:"cache-and-network"}),u=s.data,d=s.loading,_=(0,F.r3)(),o=A()(_,1),p=o[0];return(0,D.jsx)(O,{save:p,data:g()({id:e},u==null?void 0:u.component),loading:d})}j.default=I},85947:function(K,j,n){n.d(j,{u7:function(){return a.u7},pM:function(){return a.pM},dP:function(){return a.dP},zR:function(){return a.zR},bo:function(){return a.bo},CF:function(){return a.CF},hT:function(){return a.hT},X4:function(){return a.X4},rq:function(){return a.rq},qb:function(){return a.qb},a$:function(){return a.a$},mp:function(){return a.mp},WE:function(){return a.WE},HC:function(){return a.HC},cT:function(){return L},Hr:function(){return f},r3:function(){return a.r3},bI:function(){return a.bI},A6:function(){return a.A6},LV:function(){return a.LV}});var a=n(10557),g=n(15009),m=n.n(g),A=n(99289),M=n.n(A),T=n(5574),C=n.n(T),y=n(67294),c=n(89717),i=n(85893);function B(e,s){var u,d=(0,a.rz)({variables:{id:e==null?void 0:e.id},refetchQueries:[{query:a.dP,variables:{id:e==null||(u=e.application)===null||u===void 0?void 0:u.id}}]}),_=C()(d,1),o=_[0],p=(0,y.useCallback)(M()(m()().mark(function h(){var v;return m()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.Modal.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u8DEF\u7531\u5417\uFF1F",content:(0,i.jsxs)(i.Fragment,{children:["\u60A8\u5373\u5C06\u5220\u9664\u201C",(0,i.jsx)("strong",{children:e.name}),"\u201D\u3002\u5220\u9664\u64CD\u4F5C\u4E0D\u53EF\u9006\u8F6C\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF0C\u60A8\u786E\u5B9A\u5220\u9664\u5417\uFF1F"]}),okText:"\u5220 \u9664",okClassName:"btn-danger"});case 2:if(v=t.sent,!v.isConfirmed){t.next=8;break}return t.next=6,o();case 6:c.Toast.success("\u5220\u9664\u6210\u529F"),s(e);case 8:case"end":return t.stop()}},h)})),[o,e,s]);return[p]}var L=B,F=n(97857),D=n.n(F),O=n(12708);function I(e,s){var u,d,_,o=c.Form.useForm(),p=(0,y.useState)(!1),h=C()(p,2),v=h[0],l=h[1],t=(0,a.X4)({fetchPolicy:"no-cache",refetchQueries:[{query:a.dP,variables:{id:e==null||(u=e.application)===null||u===void 0?void 0:u.id}}]}),W=C()(t,1),E=W[0],S=(0,a.LV)({fetchPolicy:"no-cache",refetchQueries:[{query:a.dP,variables:{id:e==null||(d=e.application)===null||d===void 0?void 0:d.id}}]}),k=C()(S,1),$=k[0],z=(0,y.useMemo)(function(){return e!=null&&e.id?M()(m()().mark(function U(){var b,P,R;return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l(!0),r.prev=1,r.next=4,o.validateFields();case 4:return b=r.sent,r.next=7,c.Toast.promise((0,O.gw)($({variables:{id:e.id,input:D()({},b)}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,i.jsxs)(i.Fragment,{children:["\u8DEF\u7531 ",(0,i.jsx)("strong",{children:b.name})," \u4FDD\u5B58\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:P=r.sent,R=P.data,s(R.updateRoute),l(!1),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(1),l(!1);case 16:case"end":return r.stop()}},U,null,[[1,13]])})):M()(m()().mark(function U(){var b,P,R;return m()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l(!0),r.prev=1,r.next=4,o.validateFields();case 4:return b=r.sent,r.next=7,c.Toast.promise((0,O.gw)(E({variables:{input:D()(D()({},b),{},{application:e.application.id})}}),350),{pending:"\u63D0\u4EA4\u4E2D...",success:{render:function(){return(0,i.jsxs)(i.Fragment,{children:["\u8DEF\u7531 ",(0,i.jsx)("strong",{children:b.name})," \u65B0\u589E\u6210\u529F"]})}},error:"\u63D0\u4EA4\u51FA\u9519"},{duration:2e3,placement:"top-center"});case 7:P=r.sent,R=P.data,s(R.createRoute),l(!1),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(1),l(!1);case 16:case"end":return r.stop()}},U,null,[[1,13]])}))},[E,e==null||(_=e.application)===null||_===void 0?void 0:_.id,e==null?void 0:e.id,o,s,$]);return[z,{form:o,submitting:v}]}var f=I}}]);
